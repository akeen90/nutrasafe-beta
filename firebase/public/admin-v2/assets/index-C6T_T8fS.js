var tb=e=>{throw TypeError(e)};var Nv=(e,t,s)=>t.has(e)||tb("Cannot "+s);var Ce=(e,t,s)=>(Nv(e,t,"read from private field"),s?s.call(e):t.get(e)),kt=(e,t,s)=>t.has(e)?tb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),ft=(e,t,s,i)=>(Nv(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),oi=(e,t,s)=>(Nv(e,t,"access private method"),s);var Bp=(e,t,s,i)=>({set _(r){ft(e,t,r,s)},get _(){return Ce(e,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();var mk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var VT={exports:{}},pm={},BT={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ap=Symbol.for("react.element"),vk=Symbol.for("react.portal"),Ck=Symbol.for("react.fragment"),yk=Symbol.for("react.strict_mode"),wk=Symbol.for("react.profiler"),Sk=Symbol.for("react.provider"),xk=Symbol.for("react.context"),bk=Symbol.for("react.forward_ref"),Ek=Symbol.for("react.suspense"),Rk=Symbol.for("react.memo"),Tk=Symbol.for("react.lazy"),sb=Symbol.iterator;function Dk(e){return e===null||typeof e!="object"?null:(e=sb&&e[sb]||e["@@iterator"],typeof e=="function"?e:null)}var HT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jT=Object.assign,WT={};function yu(e,t,s){this.props=e,this.context=t,this.refs=WT,this.updater=s||HT}yu.prototype.isReactComponent={};yu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function zT(){}zT.prototype=yu.prototype;function Zw(e,t,s){this.props=e,this.context=t,this.refs=WT,this.updater=s||HT}var Jw=Zw.prototype=new zT;Jw.constructor=Zw;jT(Jw,yu.prototype);Jw.isPureReactComponent=!0;var ib=Array.isArray,UT=Object.prototype.hasOwnProperty,Xw={current:null},$T={key:!0,ref:!0,__self:!0,__source:!0};function KT(e,t,s){var i,r={},n=null,o=null;if(t!=null)for(i in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(n=""+t.key),t)UT.call(t,i)&&!$T.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(a===1)r.children=s;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:ap,type:e,key:n,ref:o,props:r,_owner:Xw.current}}function Pk(e,t){return{$$typeof:ap,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function eS(e){return typeof e=="object"&&e!==null&&e.$$typeof===ap}function Ak(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var rb=/\/+/g;function Iv(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ak(""+e.key):t.toString(36)}function fg(e,t,s,i,r){var n=typeof e;(n==="undefined"||n==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(n){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ap:case vk:o=!0}}if(o)return o=e,r=r(o),e=i===""?"."+Iv(o,0):i,ib(r)?(s="",e!=null&&(s=e.replace(rb,"$&/")+"/"),fg(r,t,s,"",function(u){return u})):r!=null&&(eS(r)&&(r=Pk(r,s+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(rb,"$&/")+"/")+e)),t.push(r)),1;if(o=0,i=i===""?".":i+":",ib(e))for(var a=0;a<e.length;a++){n=e[a];var l=i+Iv(n,a);o+=fg(n,t,s,l,r)}else if(l=Dk(e),typeof l=="function")for(e=l.call(e),a=0;!(n=e.next()).done;)n=n.value,l=i+Iv(n,a++),o+=fg(n,t,s,l,r);else if(n==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Hp(e,t,s){if(e==null)return e;var i=[],r=0;return fg(e,i,"","",function(n){return t.call(s,n,r++)}),i}function Fk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pi={current:null},mg={transition:null},Nk={ReactCurrentDispatcher:Pi,ReactCurrentBatchConfig:mg,ReactCurrentOwner:Xw};function YT(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:Hp,forEach:function(e,t,s){Hp(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return Hp(e,function(){t++}),t},toArray:function(e){return Hp(e,function(t){return t})||[]},only:function(e){if(!eS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};It.Component=yu;It.Fragment=Ck;It.Profiler=wk;It.PureComponent=Zw;It.StrictMode=yk;It.Suspense=Ek;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nk;It.act=YT;It.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=jT({},e.props),r=e.key,n=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(n=t.ref,o=Xw.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)UT.call(t,l)&&!$T.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=s;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:ap,type:e.type,key:r,ref:n,props:i,_owner:o}};It.createContext=function(e){return e={$$typeof:xk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Sk,_context:e},e.Consumer=e};It.createElement=KT;It.createFactory=function(e){var t=KT.bind(null,e);return t.type=e,t};It.createRef=function(){return{current:null}};It.forwardRef=function(e){return{$$typeof:bk,render:e}};It.isValidElement=eS;It.lazy=function(e){return{$$typeof:Tk,_payload:{_status:-1,_result:e},_init:Fk}};It.memo=function(e,t){return{$$typeof:Rk,type:e,compare:t===void 0?null:t}};It.startTransition=function(e){var t=mg.transition;mg.transition={};try{e()}finally{mg.transition=t}};It.unstable_act=YT;It.useCallback=function(e,t){return Pi.current.useCallback(e,t)};It.useContext=function(e){return Pi.current.useContext(e)};It.useDebugValue=function(){};It.useDeferredValue=function(e){return Pi.current.useDeferredValue(e)};It.useEffect=function(e,t){return Pi.current.useEffect(e,t)};It.useId=function(){return Pi.current.useId()};It.useImperativeHandle=function(e,t,s){return Pi.current.useImperativeHandle(e,t,s)};It.useInsertionEffect=function(e,t){return Pi.current.useInsertionEffect(e,t)};It.useLayoutEffect=function(e,t){return Pi.current.useLayoutEffect(e,t)};It.useMemo=function(e,t){return Pi.current.useMemo(e,t)};It.useReducer=function(e,t,s){return Pi.current.useReducer(e,t,s)};It.useRef=function(e){return Pi.current.useRef(e)};It.useState=function(e){return Pi.current.useState(e)};It.useSyncExternalStore=function(e,t,s){return Pi.current.useSyncExternalStore(e,t,s)};It.useTransition=function(){return Pi.current.useTransition()};It.version="18.3.1";BT.exports=It;var b=BT.exports;const Pe=hm(b);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ik=b,_k=Symbol.for("react.element"),kk=Symbol.for("react.fragment"),Mk=Object.prototype.hasOwnProperty,Lk=Ik.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ok={key:!0,ref:!0,__self:!0,__source:!0};function qT(e,t,s){var i,r={},n=null,o=null;s!==void 0&&(n=""+s),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(o=t.ref);for(i in t)Mk.call(t,i)&&!Ok.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:_k,type:e,key:n,ref:o,props:r,_owner:Lk.current}}pm.Fragment=kk;pm.jsx=qT;pm.jsxs=qT;VT.exports=pm;var c=VT.exports,UC={},QT={exports:{}},vr={},ZT={exports:{}},JT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(pe,ye){var Ae=pe.length;pe.push(ye);e:for(;0<Ae;){var te=Ae-1>>>1,ce=pe[te];if(0<r(ce,ye))pe[te]=ye,pe[Ae]=ce,Ae=te;else break e}}function s(pe){return pe.length===0?null:pe[0]}function i(pe){if(pe.length===0)return null;var ye=pe[0],Ae=pe.pop();if(Ae!==ye){pe[0]=Ae;e:for(var te=0,ce=pe.length,be=ce>>>1;te<be;){var Ze=2*(te+1)-1,he=pe[Ze],et=Ze+1,We=pe[et];if(0>r(he,Ae))et<ce&&0>r(We,he)?(pe[te]=We,pe[et]=Ae,te=et):(pe[te]=he,pe[Ze]=Ae,te=Ze);else if(et<ce&&0>r(We,Ae))pe[te]=We,pe[et]=Ae,te=et;else break e}}return ye}function r(pe,ye){var Ae=pe.sortIndex-ye.sortIndex;return Ae!==0?Ae:pe.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;e.unstable_now=function(){return n.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,p=null,g=3,m=!1,C=!1,y=!1,R=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(pe){for(var ye=s(u);ye!==null;){if(ye.callback===null)i(u);else if(ye.startTime<=pe)i(u),ye.sortIndex=ye.expirationTime,t(l,ye);else break;ye=s(u)}}function I(pe){if(y=!1,T(pe),!C)if(s(l)!==null)C=!0,fe(V);else{var ye=s(u);ye!==null&&me(I,ye.startTime-pe)}}function V(pe,ye){C=!1,y&&(y=!1,x(N),N=-1),m=!0;var Ae=g;try{for(T(ye),p=s(l);p!==null&&(!(p.expirationTime>ye)||pe&&!M());){var te=p.callback;if(typeof te=="function"){p.callback=null,g=p.priorityLevel;var ce=te(p.expirationTime<=ye);ye=e.unstable_now(),typeof ce=="function"?p.callback=ce:p===s(l)&&i(l),T(ye)}else i(l);p=s(l)}if(p!==null)var be=!0;else{var Ze=s(u);Ze!==null&&me(I,Ze.startTime-ye),be=!1}return be}finally{p=null,g=Ae,m=!1}}var j=!1,P=null,N=-1,_=5,L=-1;function M(){return!(e.unstable_now()-L<_)}function E(){if(P!==null){var pe=e.unstable_now();L=pe;var ye=!0;try{ye=P(!0,pe)}finally{ye?F():(j=!1,P=null)}}else j=!1}var F;if(typeof S=="function")F=function(){S(E)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,Y=J.port2;J.port1.onmessage=E,F=function(){Y.postMessage(null)}}else F=function(){R(E,0)};function fe(pe){P=pe,j||(j=!0,F())}function me(pe,ye){N=R(function(){pe(e.unstable_now())},ye)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(pe){pe.callback=null},e.unstable_continueExecution=function(){C||m||(C=!0,fe(V))},e.unstable_forceFrameRate=function(pe){0>pe||125<pe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<pe?Math.floor(1e3/pe):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return s(l)},e.unstable_next=function(pe){switch(g){case 1:case 2:case 3:var ye=3;break;default:ye=g}var Ae=g;g=ye;try{return pe()}finally{g=Ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(pe,ye){switch(pe){case 1:case 2:case 3:case 4:case 5:break;default:pe=3}var Ae=g;g=pe;try{return ye()}finally{g=Ae}},e.unstable_scheduleCallback=function(pe,ye,Ae){var te=e.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?te+Ae:te):Ae=te,pe){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=Ae+ce,pe={id:h++,callback:ye,priorityLevel:pe,startTime:Ae,expirationTime:ce,sortIndex:-1},Ae>te?(pe.sortIndex=Ae,t(u,pe),s(l)===null&&pe===s(u)&&(y?(x(N),N=-1):y=!0,me(I,Ae-te))):(pe.sortIndex=ce,t(l,pe),C||m||(C=!0,fe(V))),pe},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(pe){var ye=g;return function(){var Ae=g;g=ye;try{return pe.apply(this,arguments)}finally{g=Ae}}}})(JT);ZT.exports=JT;var Gk=ZT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vk=b,gr=Gk;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var XT=new Set,Wd={};function Vl(e,t){zc(e,t),zc(e+"Capture",t)}function zc(e,t){for(Wd[e]=t,e=0;e<t.length;e++)XT.add(t[e])}var no=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$C=Object.prototype.hasOwnProperty,Bk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nb={},ob={};function Hk(e){return $C.call(ob,e)?!0:$C.call(nb,e)?!1:Bk.test(e)?ob[e]=!0:(nb[e]=!0,!1)}function jk(e,t,s,i){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Wk(e,t,s,i){if(t===null||typeof t>"u"||jk(e,t,s,i))return!0;if(i)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ai(e,t,s,i,r,n,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=o}var ti={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ti[e]=new Ai(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ti[t]=new Ai(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ti[e]=new Ai(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ti[e]=new Ai(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ti[e]=new Ai(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ti[e]=new Ai(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ti[e]=new Ai(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ti[e]=new Ai(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ti[e]=new Ai(e,5,!1,e.toLowerCase(),null,!1,!1)});var tS=/[\-:]([a-z])/g;function sS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(tS,sS);ti[t]=new Ai(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(tS,sS);ti[t]=new Ai(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(tS,sS);ti[t]=new Ai(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ti[e]=new Ai(e,1,!1,e.toLowerCase(),null,!1,!1)});ti.xlinkHref=new Ai("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ti[e]=new Ai(e,1,!1,e.toLowerCase(),null,!0,!0)});function iS(e,t,s,i){var r=ti.hasOwnProperty(t)?ti[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Wk(t,s,r,i)&&(s=null),i||r===null?Hk(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):r.mustUseProperty?e[r.propertyName]=s===null?r.type===3?!1:"":s:(t=r.attributeName,i=r.attributeNamespace,s===null?e.removeAttribute(t):(r=r.type,s=r===3||r===4&&s===!0?"":""+s,i?e.setAttributeNS(i,t,s):e.setAttribute(t,s))))}var vo=Vk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jp=Symbol.for("react.element"),uc=Symbol.for("react.portal"),dc=Symbol.for("react.fragment"),rS=Symbol.for("react.strict_mode"),KC=Symbol.for("react.profiler"),eD=Symbol.for("react.provider"),tD=Symbol.for("react.context"),nS=Symbol.for("react.forward_ref"),YC=Symbol.for("react.suspense"),qC=Symbol.for("react.suspense_list"),oS=Symbol.for("react.memo"),Lo=Symbol.for("react.lazy"),sD=Symbol.for("react.offscreen"),ab=Symbol.iterator;function Zu(e){return e===null||typeof e!="object"?null:(e=ab&&e[ab]||e["@@iterator"],typeof e=="function"?e:null)}var Cs=Object.assign,_v;function ud(e){if(_v===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);_v=t&&t[1]||""}return`
`+_v+e}var kv=!1;function Mv(e,t){if(!e||kv)return"";kv=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var i=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){i=u}e.call(t.prototype)}else{try{throw Error()}catch(u){i=u}e()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),n=i.stack.split(`
`),o=r.length-1,a=n.length-1;1<=o&&0<=a&&r[o]!==n[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==n[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==n[a]){var l=`
`+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{kv=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?ud(e):""}function zk(e){switch(e.tag){case 5:return ud(e.type);case 16:return ud("Lazy");case 13:return ud("Suspense");case 19:return ud("SuspenseList");case 0:case 2:case 15:return e=Mv(e.type,!1),e;case 11:return e=Mv(e.type.render,!1),e;case 1:return e=Mv(e.type,!0),e;default:return""}}function QC(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case dc:return"Fragment";case uc:return"Portal";case KC:return"Profiler";case rS:return"StrictMode";case YC:return"Suspense";case qC:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case tD:return(e.displayName||"Context")+".Consumer";case eD:return(e._context.displayName||"Context")+".Provider";case nS:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case oS:return t=e.displayName||null,t!==null?t:QC(e.type)||"Memo";case Lo:t=e._payload,e=e._init;try{return QC(e(t))}catch{}}return null}function Uk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return QC(t);case 8:return t===rS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ua(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function iD(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $k(e){var t=iD(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var r=s.get,n=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,n.call(this,o)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Wp(e){e._valueTracker||(e._valueTracker=$k(e))}function rD(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),i="";return e&&(i=iD(e)?e.checked?"true":"false":e.value),e=i,e!==s?(t.setValue(e),!0):!1}function Kg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ZC(e,t){var s=t.checked;return Cs({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function lb(e,t){var s=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;s=ua(t.value!=null?t.value:s),e._wrapperState={initialChecked:i,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function nD(e,t){t=t.checked,t!=null&&iS(e,"checked",t,!1)}function JC(e,t){nD(e,t);var s=ua(t.value),i=t.type;if(s!=null)i==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?XC(e,t.type,s):t.hasOwnProperty("defaultValue")&&XC(e,t.type,ua(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function cb(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function XC(e,t,s){(t!=="number"||Kg(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var dd=Array.isArray;function Rc(e,t,s,i){if(e=e.options,t){t={};for(var r=0;r<s.length;r++)t["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=t.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&i&&(e[s].defaultSelected=!0)}else{for(s=""+ua(s),t=null,r=0;r<e.length;r++){if(e[r].value===s){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function ey(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return Cs({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ub(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(ke(92));if(dd(s)){if(1<s.length)throw Error(ke(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:ua(s)}}function oD(e,t){var s=ua(t.value),i=ua(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),i!=null&&(e.defaultValue=""+i)}function db(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function aD(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ty(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?aD(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var zp,lD=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,i,r){MSApp.execUnsafeLocalFunction(function(){return e(t,s,i,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(zp=zp||document.createElement("div"),zp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=zp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function zd(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var Pd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kk=["Webkit","ms","Moz","O"];Object.keys(Pd).forEach(function(e){Kk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Pd[t]=Pd[e]})});function cD(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||Pd.hasOwnProperty(e)&&Pd[e]?(""+t).trim():t+"px"}function uD(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var i=s.indexOf("--")===0,r=cD(s,t[s],i);s==="float"&&(s="cssFloat"),i?e.setProperty(s,r):e[s]=r}}var Yk=Cs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sy(e,t){if(t){if(Yk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function iy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ry=null;function aS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ny=null,Tc=null,Dc=null;function hb(e){if(e=up(e)){if(typeof ny!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=Cm(t),ny(e.stateNode,e.type,t))}}function dD(e){Tc?Dc?Dc.push(e):Dc=[e]:Tc=e}function hD(){if(Tc){var e=Tc,t=Dc;if(Dc=Tc=null,hb(e),t)for(e=0;e<t.length;e++)hb(t[e])}}function pD(e,t){return e(t)}function gD(){}var Lv=!1;function fD(e,t,s){if(Lv)return e(t,s);Lv=!0;try{return pD(e,t,s)}finally{Lv=!1,(Tc!==null||Dc!==null)&&(gD(),hD())}}function Ud(e,t){var s=e.stateNode;if(s===null)return null;var i=Cm(s);if(i===null)return null;s=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(ke(231,t,typeof s));return s}var oy=!1;if(no)try{var Ju={};Object.defineProperty(Ju,"passive",{get:function(){oy=!0}}),window.addEventListener("test",Ju,Ju),window.removeEventListener("test",Ju,Ju)}catch{oy=!1}function qk(e,t,s,i,r,n,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(s,u)}catch(h){this.onError(h)}}var Ad=!1,Yg=null,qg=!1,ay=null,Qk={onError:function(e){Ad=!0,Yg=e}};function Zk(e,t,s,i,r,n,o,a,l){Ad=!1,Yg=null,qk.apply(Qk,arguments)}function Jk(e,t,s,i,r,n,o,a,l){if(Zk.apply(this,arguments),Ad){if(Ad){var u=Yg;Ad=!1,Yg=null}else throw Error(ke(198));qg||(qg=!0,ay=u)}}function Bl(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function mD(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function pb(e){if(Bl(e)!==e)throw Error(ke(188))}function Xk(e){var t=e.alternate;if(!t){if(t=Bl(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var s=e,i=t;;){var r=s.return;if(r===null)break;var n=r.alternate;if(n===null){if(i=r.return,i!==null){s=i;continue}break}if(r.child===n.child){for(n=r.child;n;){if(n===s)return pb(r),e;if(n===i)return pb(r),t;n=n.sibling}throw Error(ke(188))}if(s.return!==i.return)s=r,i=n;else{for(var o=!1,a=r.child;a;){if(a===s){o=!0,s=r,i=n;break}if(a===i){o=!0,i=r,s=n;break}a=a.sibling}if(!o){for(a=n.child;a;){if(a===s){o=!0,s=n,i=r;break}if(a===i){o=!0,i=n,s=r;break}a=a.sibling}if(!o)throw Error(ke(189))}}if(s.alternate!==i)throw Error(ke(190))}if(s.tag!==3)throw Error(ke(188));return s.stateNode.current===s?e:t}function vD(e){return e=Xk(e),e!==null?CD(e):null}function CD(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=CD(e);if(t!==null)return t;e=e.sibling}return null}var yD=gr.unstable_scheduleCallback,gb=gr.unstable_cancelCallback,eM=gr.unstable_shouldYield,tM=gr.unstable_requestPaint,Ts=gr.unstable_now,sM=gr.unstable_getCurrentPriorityLevel,lS=gr.unstable_ImmediatePriority,wD=gr.unstable_UserBlockingPriority,Qg=gr.unstable_NormalPriority,iM=gr.unstable_LowPriority,SD=gr.unstable_IdlePriority,gm=null,_n=null;function rM(e){if(_n&&typeof _n.onCommitFiberRoot=="function")try{_n.onCommitFiberRoot(gm,e,void 0,(e.current.flags&128)===128)}catch{}}var ln=Math.clz32?Math.clz32:aM,nM=Math.log,oM=Math.LN2;function aM(e){return e>>>=0,e===0?32:31-(nM(e)/oM|0)|0}var Up=64,$p=4194304;function hd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zg(e,t){var s=e.pendingLanes;if(s===0)return 0;var i=0,r=e.suspendedLanes,n=e.pingedLanes,o=s&268435455;if(o!==0){var a=o&~r;a!==0?i=hd(a):(n&=o,n!==0&&(i=hd(n)))}else o=s&~r,o!==0?i=hd(o):n!==0&&(i=hd(n));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,n=t&-t,r>=n||r===16&&(n&4194240)!==0))return t;if(i&4&&(i|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)s=31-ln(t),r=1<<s,i|=e[s],t&=~r;return i}function lM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cM(e,t){for(var s=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,n=e.pendingLanes;0<n;){var o=31-ln(n),a=1<<o,l=r[o];l===-1?(!(a&s)||a&i)&&(r[o]=lM(a,t)):l<=t&&(e.expiredLanes|=a),n&=~a}}function ly(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xD(){var e=Up;return Up<<=1,!(Up&4194240)&&(Up=64),e}function Ov(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function lp(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ln(t),e[t]=s}function uM(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-ln(s),n=1<<r;t[r]=0,i[r]=-1,e[r]=-1,s&=~n}}function cS(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var i=31-ln(s),r=1<<i;r&t|e[i]&t&&(e[i]|=t),s&=~r}}var Yt=0;function bD(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ED,uS,RD,TD,DD,cy=!1,Kp=[],Zo=null,Jo=null,Xo=null,$d=new Map,Kd=new Map,Go=[],dM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fb(e,t){switch(e){case"focusin":case"focusout":Zo=null;break;case"dragenter":case"dragleave":Jo=null;break;case"mouseover":case"mouseout":Xo=null;break;case"pointerover":case"pointerout":$d.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kd.delete(t.pointerId)}}function Xu(e,t,s,i,r,n){return e===null||e.nativeEvent!==n?(e={blockedOn:t,domEventName:s,eventSystemFlags:i,nativeEvent:n,targetContainers:[r]},t!==null&&(t=up(t),t!==null&&uS(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function hM(e,t,s,i,r){switch(t){case"focusin":return Zo=Xu(Zo,e,t,s,i,r),!0;case"dragenter":return Jo=Xu(Jo,e,t,s,i,r),!0;case"mouseover":return Xo=Xu(Xo,e,t,s,i,r),!0;case"pointerover":var n=r.pointerId;return $d.set(n,Xu($d.get(n)||null,e,t,s,i,r)),!0;case"gotpointercapture":return n=r.pointerId,Kd.set(n,Xu(Kd.get(n)||null,e,t,s,i,r)),!0}return!1}function PD(e){var t=Ja(e.target);if(t!==null){var s=Bl(t);if(s!==null){if(t=s.tag,t===13){if(t=mD(s),t!==null){e.blockedOn=t,DD(e.priority,function(){RD(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=uy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var i=new s.constructor(s.type,s);ry=i,s.target.dispatchEvent(i),ry=null}else return t=up(s),t!==null&&uS(t),e.blockedOn=s,!1;t.shift()}return!0}function mb(e,t,s){vg(e)&&s.delete(t)}function pM(){cy=!1,Zo!==null&&vg(Zo)&&(Zo=null),Jo!==null&&vg(Jo)&&(Jo=null),Xo!==null&&vg(Xo)&&(Xo=null),$d.forEach(mb),Kd.forEach(mb)}function ed(e,t){e.blockedOn===t&&(e.blockedOn=null,cy||(cy=!0,gr.unstable_scheduleCallback(gr.unstable_NormalPriority,pM)))}function Yd(e){function t(r){return ed(r,e)}if(0<Kp.length){ed(Kp[0],e);for(var s=1;s<Kp.length;s++){var i=Kp[s];i.blockedOn===e&&(i.blockedOn=null)}}for(Zo!==null&&ed(Zo,e),Jo!==null&&ed(Jo,e),Xo!==null&&ed(Xo,e),$d.forEach(t),Kd.forEach(t),s=0;s<Go.length;s++)i=Go[s],i.blockedOn===e&&(i.blockedOn=null);for(;0<Go.length&&(s=Go[0],s.blockedOn===null);)PD(s),s.blockedOn===null&&Go.shift()}var Pc=vo.ReactCurrentBatchConfig,Jg=!0;function gM(e,t,s,i){var r=Yt,n=Pc.transition;Pc.transition=null;try{Yt=1,dS(e,t,s,i)}finally{Yt=r,Pc.transition=n}}function fM(e,t,s,i){var r=Yt,n=Pc.transition;Pc.transition=null;try{Yt=4,dS(e,t,s,i)}finally{Yt=r,Pc.transition=n}}function dS(e,t,s,i){if(Jg){var r=uy(e,t,s,i);if(r===null)Kv(e,t,i,Xg,s),fb(e,i);else if(hM(r,e,t,s,i))i.stopPropagation();else if(fb(e,i),t&4&&-1<dM.indexOf(e)){for(;r!==null;){var n=up(r);if(n!==null&&ED(n),n=uy(e,t,s,i),n===null&&Kv(e,t,i,Xg,s),n===r)break;r=n}r!==null&&i.stopPropagation()}else Kv(e,t,i,null,s)}}var Xg=null;function uy(e,t,s,i){if(Xg=null,e=aS(i),e=Ja(e),e!==null)if(t=Bl(e),t===null)e=null;else if(s=t.tag,s===13){if(e=mD(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xg=e,null}function AD(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sM()){case lS:return 1;case wD:return 4;case Qg:case iM:return 16;case SD:return 536870912;default:return 16}default:return 16}}var Ko=null,hS=null,Cg=null;function FD(){if(Cg)return Cg;var e,t=hS,s=t.length,i,r="value"in Ko?Ko.value:Ko.textContent,n=r.length;for(e=0;e<s&&t[e]===r[e];e++);var o=s-e;for(i=1;i<=o&&t[s-i]===r[n-i];i++);return Cg=r.slice(e,1<i?1-i:void 0)}function yg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yp(){return!0}function vb(){return!1}function Cr(e){function t(s,i,r,n,o){this._reactName=s,this._targetInst=r,this.type=i,this.nativeEvent=n,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(s=e[a],this[a]=s?s(n):n[a]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?Yp:vb,this.isPropagationStopped=vb,this}return Cs(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Yp)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Yp)},persist:function(){},isPersistent:Yp}),t}var wu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pS=Cr(wu),cp=Cs({},wu,{view:0,detail:0}),mM=Cr(cp),Gv,Vv,td,fm=Cs({},cp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gS,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==td&&(td&&e.type==="mousemove"?(Gv=e.screenX-td.screenX,Vv=e.screenY-td.screenY):Vv=Gv=0,td=e),Gv)},movementY:function(e){return"movementY"in e?e.movementY:Vv}}),Cb=Cr(fm),vM=Cs({},fm,{dataTransfer:0}),CM=Cr(vM),yM=Cs({},cp,{relatedTarget:0}),Bv=Cr(yM),wM=Cs({},wu,{animationName:0,elapsedTime:0,pseudoElement:0}),SM=Cr(wM),xM=Cs({},wu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bM=Cr(xM),EM=Cs({},wu,{data:0}),yb=Cr(EM),RM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function PM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=DM[e])?!!t[e]:!1}function gS(){return PM}var AM=Cs({},cp,{key:function(e){if(e.key){var t=RM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?TM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gS,charCode:function(e){return e.type==="keypress"?yg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),FM=Cr(AM),NM=Cs({},fm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wb=Cr(NM),IM=Cs({},cp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gS}),_M=Cr(IM),kM=Cs({},wu,{propertyName:0,elapsedTime:0,pseudoElement:0}),MM=Cr(kM),LM=Cs({},fm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),OM=Cr(LM),GM=[9,13,27,32],fS=no&&"CompositionEvent"in window,Fd=null;no&&"documentMode"in document&&(Fd=document.documentMode);var VM=no&&"TextEvent"in window&&!Fd,ND=no&&(!fS||Fd&&8<Fd&&11>=Fd),Sb=" ",xb=!1;function ID(e,t){switch(e){case"keyup":return GM.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _D(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hc=!1;function BM(e,t){switch(e){case"compositionend":return _D(t);case"keypress":return t.which!==32?null:(xb=!0,Sb);case"textInput":return e=t.data,e===Sb&&xb?null:e;default:return null}}function HM(e,t){if(hc)return e==="compositionend"||!fS&&ID(e,t)?(e=FD(),Cg=hS=Ko=null,hc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ND&&t.locale!=="ko"?null:t.data;default:return null}}var jM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!jM[e.type]:t==="textarea"}function kD(e,t,s,i){dD(i),t=ef(t,"onChange"),0<t.length&&(s=new pS("onChange","change",null,s,i),e.push({event:s,listeners:t}))}var Nd=null,qd=null;function WM(e){UD(e,0)}function mm(e){var t=fc(e);if(rD(t))return e}function zM(e,t){if(e==="change")return t}var MD=!1;if(no){var Hv;if(no){var jv="oninput"in document;if(!jv){var Eb=document.createElement("div");Eb.setAttribute("oninput","return;"),jv=typeof Eb.oninput=="function"}Hv=jv}else Hv=!1;MD=Hv&&(!document.documentMode||9<document.documentMode)}function Rb(){Nd&&(Nd.detachEvent("onpropertychange",LD),qd=Nd=null)}function LD(e){if(e.propertyName==="value"&&mm(qd)){var t=[];kD(t,qd,e,aS(e)),fD(WM,t)}}function UM(e,t,s){e==="focusin"?(Rb(),Nd=t,qd=s,Nd.attachEvent("onpropertychange",LD)):e==="focusout"&&Rb()}function $M(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return mm(qd)}function KM(e,t){if(e==="click")return mm(t)}function YM(e,t){if(e==="input"||e==="change")return mm(t)}function qM(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hn=typeof Object.is=="function"?Object.is:qM;function Qd(e,t){if(hn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(i=0;i<s.length;i++){var r=s[i];if(!$C.call(t,r)||!hn(e[r],t[r]))return!1}return!0}function Tb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Db(e,t){var s=Tb(e);e=0;for(var i;s;){if(s.nodeType===3){if(i=e+s.textContent.length,e<=t&&i>=t)return{node:s,offset:t-e};e=i}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Tb(s)}}function OD(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?OD(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function GD(){for(var e=window,t=Kg();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=Kg(e.document)}return t}function mS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function QM(e){var t=GD(),s=e.focusedElem,i=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&OD(s.ownerDocument.documentElement,s)){if(i!==null&&mS(s)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=s.textContent.length,n=Math.min(i.start,r);i=i.end===void 0?n:Math.min(i.end,r),!e.extend&&n>i&&(r=i,i=n,n=r),r=Db(s,n);var o=Db(s,i);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),n>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ZM=no&&"documentMode"in document&&11>=document.documentMode,pc=null,dy=null,Id=null,hy=!1;function Pb(e,t,s){var i=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;hy||pc==null||pc!==Kg(i)||(i=pc,"selectionStart"in i&&mS(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Id&&Qd(Id,i)||(Id=i,i=ef(dy,"onSelect"),0<i.length&&(t=new pS("onSelect","select",null,t,s),e.push({event:t,listeners:i}),t.target=pc)))}function qp(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var gc={animationend:qp("Animation","AnimationEnd"),animationiteration:qp("Animation","AnimationIteration"),animationstart:qp("Animation","AnimationStart"),transitionend:qp("Transition","TransitionEnd")},Wv={},VD={};no&&(VD=document.createElement("div").style,"AnimationEvent"in window||(delete gc.animationend.animation,delete gc.animationiteration.animation,delete gc.animationstart.animation),"TransitionEvent"in window||delete gc.transitionend.transition);function vm(e){if(Wv[e])return Wv[e];if(!gc[e])return e;var t=gc[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in VD)return Wv[e]=t[s];return e}var BD=vm("animationend"),HD=vm("animationiteration"),jD=vm("animationstart"),WD=vm("transitionend"),zD=new Map,Ab="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wa(e,t){zD.set(e,t),Vl(t,[e])}for(var zv=0;zv<Ab.length;zv++){var Uv=Ab[zv],JM=Uv.toLowerCase(),XM=Uv[0].toUpperCase()+Uv.slice(1);wa(JM,"on"+XM)}wa(BD,"onAnimationEnd");wa(HD,"onAnimationIteration");wa(jD,"onAnimationStart");wa("dblclick","onDoubleClick");wa("focusin","onFocus");wa("focusout","onBlur");wa(WD,"onTransitionEnd");zc("onMouseEnter",["mouseout","mouseover"]);zc("onMouseLeave",["mouseout","mouseover"]);zc("onPointerEnter",["pointerout","pointerover"]);zc("onPointerLeave",["pointerout","pointerover"]);Vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eL=new Set("cancel close invalid load scroll toggle".split(" ").concat(pd));function Fb(e,t,s){var i=e.type||"unknown-event";e.currentTarget=s,Jk(i,t,void 0,e),e.currentTarget=null}function UD(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var i=e[s],r=i.event;i=i.listeners;e:{var n=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==n&&r.isPropagationStopped())break e;Fb(r,a,u),n=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==n&&r.isPropagationStopped())break e;Fb(r,a,u),n=l}}}if(qg)throw e=ay,qg=!1,ay=null,e}function os(e,t){var s=t[vy];s===void 0&&(s=t[vy]=new Set);var i=e+"__bubble";s.has(i)||($D(t,e,2,!1),s.add(i))}function $v(e,t,s){var i=0;t&&(i|=4),$D(s,e,i,t)}var Qp="_reactListening"+Math.random().toString(36).slice(2);function Zd(e){if(!e[Qp]){e[Qp]=!0,XT.forEach(function(s){s!=="selectionchange"&&(eL.has(s)||$v(s,!1,e),$v(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qp]||(t[Qp]=!0,$v("selectionchange",!1,t))}}function $D(e,t,s,i){switch(AD(t)){case 1:var r=gM;break;case 4:r=fM;break;default:r=dS}s=r.bind(null,t,s,e),r=void 0,!oy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,s,{capture:!0,passive:r}):e.addEventListener(t,s,!0):r!==void 0?e.addEventListener(t,s,{passive:r}):e.addEventListener(t,s,!1)}function Kv(e,t,s,i,r){var n=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Ja(a),o===null)return;if(l=o.tag,l===5||l===6){i=n=o;continue e}a=a.parentNode}}i=i.return}fD(function(){var u=n,h=aS(s),p=[];e:{var g=zD.get(e);if(g!==void 0){var m=pS,C=e;switch(e){case"keypress":if(yg(s)===0)break e;case"keydown":case"keyup":m=FM;break;case"focusin":C="focus",m=Bv;break;case"focusout":C="blur",m=Bv;break;case"beforeblur":case"afterblur":m=Bv;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Cb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=CM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=_M;break;case BD:case HD:case jD:m=SM;break;case WD:m=MM;break;case"scroll":m=mM;break;case"wheel":m=OM;break;case"copy":case"cut":case"paste":m=bM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=wb}var y=(t&4)!==0,R=!y&&e==="scroll",x=y?g!==null?g+"Capture":null:g;y=[];for(var S=u,T;S!==null;){T=S;var I=T.stateNode;if(T.tag===5&&I!==null&&(T=I,x!==null&&(I=Ud(S,x),I!=null&&y.push(Jd(S,I,T)))),R)break;S=S.return}0<y.length&&(g=new m(g,C,null,s,h),p.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",g&&s!==ry&&(C=s.relatedTarget||s.fromElement)&&(Ja(C)||C[oo]))break e;if((m||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,m?(C=s.relatedTarget||s.toElement,m=u,C=C?Ja(C):null,C!==null&&(R=Bl(C),C!==R||C.tag!==5&&C.tag!==6)&&(C=null)):(m=null,C=u),m!==C)){if(y=Cb,I="onMouseLeave",x="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(y=wb,I="onPointerLeave",x="onPointerEnter",S="pointer"),R=m==null?g:fc(m),T=C==null?g:fc(C),g=new y(I,S+"leave",m,s,h),g.target=R,g.relatedTarget=T,I=null,Ja(h)===u&&(y=new y(x,S+"enter",C,s,h),y.target=T,y.relatedTarget=R,I=y),R=I,m&&C)t:{for(y=m,x=C,S=0,T=y;T;T=ic(T))S++;for(T=0,I=x;I;I=ic(I))T++;for(;0<S-T;)y=ic(y),S--;for(;0<T-S;)x=ic(x),T--;for(;S--;){if(y===x||x!==null&&y===x.alternate)break t;y=ic(y),x=ic(x)}y=null}else y=null;m!==null&&Nb(p,g,m,y,!1),C!==null&&R!==null&&Nb(p,R,C,y,!0)}}e:{if(g=u?fc(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var V=zM;else if(bb(g))if(MD)V=YM;else{V=$M;var j=UM}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(V=KM);if(V&&(V=V(e,u))){kD(p,V,s,h);break e}j&&j(e,g,u),e==="focusout"&&(j=g._wrapperState)&&j.controlled&&g.type==="number"&&XC(g,"number",g.value)}switch(j=u?fc(u):window,e){case"focusin":(bb(j)||j.contentEditable==="true")&&(pc=j,dy=u,Id=null);break;case"focusout":Id=dy=pc=null;break;case"mousedown":hy=!0;break;case"contextmenu":case"mouseup":case"dragend":hy=!1,Pb(p,s,h);break;case"selectionchange":if(ZM)break;case"keydown":case"keyup":Pb(p,s,h)}var P;if(fS)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else hc?ID(e,s)&&(N="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(N="onCompositionStart");N&&(ND&&s.locale!=="ko"&&(hc||N!=="onCompositionStart"?N==="onCompositionEnd"&&hc&&(P=FD()):(Ko=h,hS="value"in Ko?Ko.value:Ko.textContent,hc=!0)),j=ef(u,N),0<j.length&&(N=new yb(N,e,null,s,h),p.push({event:N,listeners:j}),P?N.data=P:(P=_D(s),P!==null&&(N.data=P)))),(P=VM?BM(e,s):HM(e,s))&&(u=ef(u,"onBeforeInput"),0<u.length&&(h=new yb("onBeforeInput","beforeinput",null,s,h),p.push({event:h,listeners:u}),h.data=P))}UD(p,t)})}function Jd(e,t,s){return{instance:e,listener:t,currentTarget:s}}function ef(e,t){for(var s=t+"Capture",i=[];e!==null;){var r=e,n=r.stateNode;r.tag===5&&n!==null&&(r=n,n=Ud(e,s),n!=null&&i.unshift(Jd(e,n,r)),n=Ud(e,t),n!=null&&i.push(Jd(e,n,r))),e=e.return}return i}function ic(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Nb(e,t,s,i,r){for(var n=t._reactName,o=[];s!==null&&s!==i;){var a=s,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Ud(s,n),l!=null&&o.unshift(Jd(s,l,a))):r||(l=Ud(s,n),l!=null&&o.push(Jd(s,l,a)))),s=s.return}o.length!==0&&e.push({event:t,listeners:o})}var tL=/\r\n?/g,sL=/\u0000|\uFFFD/g;function Ib(e){return(typeof e=="string"?e:""+e).replace(tL,`
`).replace(sL,"")}function Zp(e,t,s){if(t=Ib(t),Ib(e)!==t&&s)throw Error(ke(425))}function tf(){}var py=null,gy=null;function fy(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var my=typeof setTimeout=="function"?setTimeout:void 0,iL=typeof clearTimeout=="function"?clearTimeout:void 0,_b=typeof Promise=="function"?Promise:void 0,rL=typeof queueMicrotask=="function"?queueMicrotask:typeof _b<"u"?function(e){return _b.resolve(null).then(e).catch(nL)}:my;function nL(e){setTimeout(function(){throw e})}function Yv(e,t){var s=t,i=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(i===0){e.removeChild(r),Yd(t);return}i--}else s!=="$"&&s!=="$?"&&s!=="$!"||i++;s=r}while(s);Yd(t)}function ea(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kb(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Su=Math.random().toString(36).slice(2),An="__reactFiber$"+Su,Xd="__reactProps$"+Su,oo="__reactContainer$"+Su,vy="__reactEvents$"+Su,oL="__reactListeners$"+Su,aL="__reactHandles$"+Su;function Ja(e){var t=e[An];if(t)return t;for(var s=e.parentNode;s;){if(t=s[oo]||s[An]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=kb(e);e!==null;){if(s=e[An])return s;e=kb(e)}return t}e=s,s=e.parentNode}return null}function up(e){return e=e[An]||e[oo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function fc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function Cm(e){return e[Xd]||null}var Cy=[],mc=-1;function Sa(e){return{current:e}}function ls(e){0>mc||(e.current=Cy[mc],Cy[mc]=null,mc--)}function is(e,t){mc++,Cy[mc]=e.current,e.current=t}var da={},di=Sa(da),Yi=Sa(!1),Sl=da;function Uc(e,t){var s=e.type.contextTypes;if(!s)return da;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},n;for(n in s)r[n]=t[n];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function qi(e){return e=e.childContextTypes,e!=null}function sf(){ls(Yi),ls(di)}function Mb(e,t,s){if(di.current!==da)throw Error(ke(168));is(di,t),is(Yi,s)}function KD(e,t,s){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return s;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(ke(108,Uk(e)||"Unknown",r));return Cs({},s,i)}function rf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||da,Sl=di.current,is(di,e),is(Yi,Yi.current),!0}function Lb(e,t,s){var i=e.stateNode;if(!i)throw Error(ke(169));s?(e=KD(e,t,Sl),i.__reactInternalMemoizedMergedChildContext=e,ls(Yi),ls(di),is(di,e)):ls(Yi),is(Yi,s)}var Zn=null,ym=!1,qv=!1;function YD(e){Zn===null?Zn=[e]:Zn.push(e)}function lL(e){ym=!0,YD(e)}function xa(){if(!qv&&Zn!==null){qv=!0;var e=0,t=Yt;try{var s=Zn;for(Yt=1;e<s.length;e++){var i=s[e];do i=i(!0);while(i!==null)}Zn=null,ym=!1}catch(r){throw Zn!==null&&(Zn=Zn.slice(e+1)),yD(lS,xa),r}finally{Yt=t,qv=!1}}return null}var vc=[],Cc=0,nf=null,of=0,Tr=[],Dr=0,xl=null,to=1,so="";function Ha(e,t){vc[Cc++]=of,vc[Cc++]=nf,nf=e,of=t}function qD(e,t,s){Tr[Dr++]=to,Tr[Dr++]=so,Tr[Dr++]=xl,xl=e;var i=to;e=so;var r=32-ln(i)-1;i&=~(1<<r),s+=1;var n=32-ln(t)+r;if(30<n){var o=r-r%5;n=(i&(1<<o)-1).toString(32),i>>=o,r-=o,to=1<<32-ln(t)+r|s<<r|i,so=n+e}else to=1<<n|s<<r|i,so=e}function vS(e){e.return!==null&&(Ha(e,1),qD(e,1,0))}function CS(e){for(;e===nf;)nf=vc[--Cc],vc[Cc]=null,of=vc[--Cc],vc[Cc]=null;for(;e===xl;)xl=Tr[--Dr],Tr[Dr]=null,so=Tr[--Dr],Tr[Dr]=null,to=Tr[--Dr],Tr[Dr]=null}var hr=null,dr=null,gs=!1,sn=null;function QD(e,t){var s=Ar(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Ob(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,hr=e,dr=ea(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,hr=e,dr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=xl!==null?{id:to,overflow:so}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=Ar(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,hr=e,dr=null,!0):!1;default:return!1}}function yy(e){return(e.mode&1)!==0&&(e.flags&128)===0}function wy(e){if(gs){var t=dr;if(t){var s=t;if(!Ob(e,t)){if(yy(e))throw Error(ke(418));t=ea(s.nextSibling);var i=hr;t&&Ob(e,t)?QD(i,s):(e.flags=e.flags&-4097|2,gs=!1,hr=e)}}else{if(yy(e))throw Error(ke(418));e.flags=e.flags&-4097|2,gs=!1,hr=e}}}function Gb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;hr=e}function Jp(e){if(e!==hr)return!1;if(!gs)return Gb(e),gs=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fy(e.type,e.memoizedProps)),t&&(t=dr)){if(yy(e))throw ZD(),Error(ke(418));for(;t;)QD(e,t),t=ea(t.nextSibling)}if(Gb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){dr=ea(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}dr=null}}else dr=hr?ea(e.stateNode.nextSibling):null;return!0}function ZD(){for(var e=dr;e;)e=ea(e.nextSibling)}function $c(){dr=hr=null,gs=!1}function yS(e){sn===null?sn=[e]:sn.push(e)}var cL=vo.ReactCurrentBatchConfig;function sd(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ke(309));var i=s.stateNode}if(!i)throw Error(ke(147,e));var r=i,n=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===n?t.ref:(t=function(o){var a=r.refs;o===null?delete a[n]:a[n]=o},t._stringRef=n,t)}if(typeof e!="string")throw Error(ke(284));if(!s._owner)throw Error(ke(290,e))}return e}function Xp(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vb(e){var t=e._init;return t(e._payload)}function JD(e){function t(x,S){if(e){var T=x.deletions;T===null?(x.deletions=[S],x.flags|=16):T.push(S)}}function s(x,S){if(!e)return null;for(;S!==null;)t(x,S),S=S.sibling;return null}function i(x,S){for(x=new Map;S!==null;)S.key!==null?x.set(S.key,S):x.set(S.index,S),S=S.sibling;return x}function r(x,S){return x=ra(x,S),x.index=0,x.sibling=null,x}function n(x,S,T){return x.index=T,e?(T=x.alternate,T!==null?(T=T.index,T<S?(x.flags|=2,S):T):(x.flags|=2,S)):(x.flags|=1048576,S)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,S,T,I){return S===null||S.tag!==6?(S=sC(T,x.mode,I),S.return=x,S):(S=r(S,T),S.return=x,S)}function l(x,S,T,I){var V=T.type;return V===dc?h(x,S,T.props.children,I,T.key):S!==null&&(S.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Lo&&Vb(V)===S.type)?(I=r(S,T.props),I.ref=sd(x,S,T),I.return=x,I):(I=Tg(T.type,T.key,T.props,null,x.mode,I),I.ref=sd(x,S,T),I.return=x,I)}function u(x,S,T,I){return S===null||S.tag!==4||S.stateNode.containerInfo!==T.containerInfo||S.stateNode.implementation!==T.implementation?(S=iC(T,x.mode,I),S.return=x,S):(S=r(S,T.children||[]),S.return=x,S)}function h(x,S,T,I,V){return S===null||S.tag!==7?(S=hl(T,x.mode,I,V),S.return=x,S):(S=r(S,T),S.return=x,S)}function p(x,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return S=sC(""+S,x.mode,T),S.return=x,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case jp:return T=Tg(S.type,S.key,S.props,null,x.mode,T),T.ref=sd(x,null,S),T.return=x,T;case uc:return S=iC(S,x.mode,T),S.return=x,S;case Lo:var I=S._init;return p(x,I(S._payload),T)}if(dd(S)||Zu(S))return S=hl(S,x.mode,T,null),S.return=x,S;Xp(x,S)}return null}function g(x,S,T,I){var V=S!==null?S.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return V!==null?null:a(x,S,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case jp:return T.key===V?l(x,S,T,I):null;case uc:return T.key===V?u(x,S,T,I):null;case Lo:return V=T._init,g(x,S,V(T._payload),I)}if(dd(T)||Zu(T))return V!==null?null:h(x,S,T,I,null);Xp(x,T)}return null}function m(x,S,T,I,V){if(typeof I=="string"&&I!==""||typeof I=="number")return x=x.get(T)||null,a(S,x,""+I,V);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case jp:return x=x.get(I.key===null?T:I.key)||null,l(S,x,I,V);case uc:return x=x.get(I.key===null?T:I.key)||null,u(S,x,I,V);case Lo:var j=I._init;return m(x,S,T,j(I._payload),V)}if(dd(I)||Zu(I))return x=x.get(T)||null,h(S,x,I,V,null);Xp(S,I)}return null}function C(x,S,T,I){for(var V=null,j=null,P=S,N=S=0,_=null;P!==null&&N<T.length;N++){P.index>N?(_=P,P=null):_=P.sibling;var L=g(x,P,T[N],I);if(L===null){P===null&&(P=_);break}e&&P&&L.alternate===null&&t(x,P),S=n(L,S,N),j===null?V=L:j.sibling=L,j=L,P=_}if(N===T.length)return s(x,P),gs&&Ha(x,N),V;if(P===null){for(;N<T.length;N++)P=p(x,T[N],I),P!==null&&(S=n(P,S,N),j===null?V=P:j.sibling=P,j=P);return gs&&Ha(x,N),V}for(P=i(x,P);N<T.length;N++)_=m(P,x,N,T[N],I),_!==null&&(e&&_.alternate!==null&&P.delete(_.key===null?N:_.key),S=n(_,S,N),j===null?V=_:j.sibling=_,j=_);return e&&P.forEach(function(M){return t(x,M)}),gs&&Ha(x,N),V}function y(x,S,T,I){var V=Zu(T);if(typeof V!="function")throw Error(ke(150));if(T=V.call(T),T==null)throw Error(ke(151));for(var j=V=null,P=S,N=S=0,_=null,L=T.next();P!==null&&!L.done;N++,L=T.next()){P.index>N?(_=P,P=null):_=P.sibling;var M=g(x,P,L.value,I);if(M===null){P===null&&(P=_);break}e&&P&&M.alternate===null&&t(x,P),S=n(M,S,N),j===null?V=M:j.sibling=M,j=M,P=_}if(L.done)return s(x,P),gs&&Ha(x,N),V;if(P===null){for(;!L.done;N++,L=T.next())L=p(x,L.value,I),L!==null&&(S=n(L,S,N),j===null?V=L:j.sibling=L,j=L);return gs&&Ha(x,N),V}for(P=i(x,P);!L.done;N++,L=T.next())L=m(P,x,N,L.value,I),L!==null&&(e&&L.alternate!==null&&P.delete(L.key===null?N:L.key),S=n(L,S,N),j===null?V=L:j.sibling=L,j=L);return e&&P.forEach(function(E){return t(x,E)}),gs&&Ha(x,N),V}function R(x,S,T,I){if(typeof T=="object"&&T!==null&&T.type===dc&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case jp:e:{for(var V=T.key,j=S;j!==null;){if(j.key===V){if(V=T.type,V===dc){if(j.tag===7){s(x,j.sibling),S=r(j,T.props.children),S.return=x,x=S;break e}}else if(j.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Lo&&Vb(V)===j.type){s(x,j.sibling),S=r(j,T.props),S.ref=sd(x,j,T),S.return=x,x=S;break e}s(x,j);break}else t(x,j);j=j.sibling}T.type===dc?(S=hl(T.props.children,x.mode,I,T.key),S.return=x,x=S):(I=Tg(T.type,T.key,T.props,null,x.mode,I),I.ref=sd(x,S,T),I.return=x,x=I)}return o(x);case uc:e:{for(j=T.key;S!==null;){if(S.key===j)if(S.tag===4&&S.stateNode.containerInfo===T.containerInfo&&S.stateNode.implementation===T.implementation){s(x,S.sibling),S=r(S,T.children||[]),S.return=x,x=S;break e}else{s(x,S);break}else t(x,S);S=S.sibling}S=iC(T,x.mode,I),S.return=x,x=S}return o(x);case Lo:return j=T._init,R(x,S,j(T._payload),I)}if(dd(T))return C(x,S,T,I);if(Zu(T))return y(x,S,T,I);Xp(x,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,S!==null&&S.tag===6?(s(x,S.sibling),S=r(S,T),S.return=x,x=S):(s(x,S),S=sC(T,x.mode,I),S.return=x,x=S),o(x)):s(x,S)}return R}var Kc=JD(!0),XD=JD(!1),af=Sa(null),lf=null,yc=null,wS=null;function SS(){wS=yc=lf=null}function xS(e){var t=af.current;ls(af),e._currentValue=t}function Sy(e,t,s){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===s)break;e=e.return}}function Ac(e,t){lf=e,wS=yc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wi=!0),e.firstContext=null)}function Mr(e){var t=e._currentValue;if(wS!==e)if(e={context:e,memoizedValue:t,next:null},yc===null){if(lf===null)throw Error(ke(308));yc=e,lf.dependencies={lanes:0,firstContext:e}}else yc=yc.next=e;return t}var Xa=null;function bS(e){Xa===null?Xa=[e]:Xa.push(e)}function eP(e,t,s,i){var r=t.interleaved;return r===null?(s.next=s,bS(t)):(s.next=r.next,r.next=s),t.interleaved=s,ao(e,i)}function ao(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Oo=!1;function ES(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function io(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ta(e,t,s){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Ht&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,ao(e,s)}return r=i.interleaved,r===null?(t.next=t,bS(i)):(t.next=r.next,r.next=t),i.interleaved=t,ao(e,s)}function wg(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,s|=i,t.lanes=s,cS(e,s)}}function Bb(e,t){var s=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,s===i)){var r=null,n=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};n===null?r=n=o:n=n.next=o,s=s.next}while(s!==null);n===null?r=n=t:n=n.next=t}else r=n=t;s={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:n,shared:i.shared,effects:i.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function cf(e,t,s,i){var r=e.updateQueue;Oo=!1;var n=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?n=u:o.next=u,o=l;var h=e.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(n!==null){var p=r.baseState;o=0,h=u=l=null,a=n;do{var g=a.lane,m=a.eventTime;if((i&g)===g){h!==null&&(h=h.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var C=e,y=a;switch(g=t,m=s,y.tag){case 1:if(C=y.payload,typeof C=="function"){p=C.call(m,p,g);break e}p=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=y.payload,g=typeof C=="function"?C.call(m,p,g):C,g==null)break e;p=Cs({},p,g);break e;case 2:Oo=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,g=r.effects,g===null?r.effects=[a]:g.push(a))}else m={eventTime:m,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=m,l=p):h=h.next=m,o|=g;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;g=a,a=g.next,g.next=null,r.lastBaseUpdate=g,r.shared.pending=null}}while(!0);if(h===null&&(l=p),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=h,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else n===null&&(r.shared.lanes=0);El|=o,e.lanes=o,e.memoizedState=p}}function Hb(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(r!==null){if(i.callback=null,i=s,typeof r!="function")throw Error(ke(191,r));r.call(i)}}}var dp={},kn=Sa(dp),eh=Sa(dp),th=Sa(dp);function el(e){if(e===dp)throw Error(ke(174));return e}function RS(e,t){switch(is(th,t),is(eh,e),is(kn,dp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ty(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ty(t,e)}ls(kn),is(kn,t)}function Yc(){ls(kn),ls(eh),ls(th)}function sP(e){el(th.current);var t=el(kn.current),s=ty(t,e.type);t!==s&&(is(eh,e),is(kn,s))}function TS(e){eh.current===e&&(ls(kn),ls(eh))}var ms=Sa(0);function uf(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qv=[];function DS(){for(var e=0;e<Qv.length;e++)Qv[e]._workInProgressVersionPrimary=null;Qv.length=0}var Sg=vo.ReactCurrentDispatcher,Zv=vo.ReactCurrentBatchConfig,bl=0,vs=null,Ms=null,js=null,df=!1,_d=!1,sh=0,uL=0;function ai(){throw Error(ke(321))}function PS(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!hn(e[s],t[s]))return!1;return!0}function AS(e,t,s,i,r,n){if(bl=n,vs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Sg.current=e===null||e.memoizedState===null?gL:fL,e=s(i,r),_d){n=0;do{if(_d=!1,sh=0,25<=n)throw Error(ke(301));n+=1,js=Ms=null,t.updateQueue=null,Sg.current=mL,e=s(i,r)}while(_d)}if(Sg.current=hf,t=Ms!==null&&Ms.next!==null,bl=0,js=Ms=vs=null,df=!1,t)throw Error(ke(300));return e}function FS(){var e=sh!==0;return sh=0,e}function Rn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return js===null?vs.memoizedState=js=e:js=js.next=e,js}function Lr(){if(Ms===null){var e=vs.alternate;e=e!==null?e.memoizedState:null}else e=Ms.next;var t=js===null?vs.memoizedState:js.next;if(t!==null)js=t,Ms=e;else{if(e===null)throw Error(ke(310));Ms=e,e={memoizedState:Ms.memoizedState,baseState:Ms.baseState,baseQueue:Ms.baseQueue,queue:Ms.queue,next:null},js===null?vs.memoizedState=js=e:js=js.next=e}return js}function ih(e,t){return typeof t=="function"?t(e):t}function Jv(e){var t=Lr(),s=t.queue;if(s===null)throw Error(ke(311));s.lastRenderedReducer=e;var i=Ms,r=i.baseQueue,n=s.pending;if(n!==null){if(r!==null){var o=r.next;r.next=n.next,n.next=o}i.baseQueue=r=n,s.pending=null}if(r!==null){n=r.next,i=i.baseState;var a=o=null,l=null,u=n;do{var h=u.lane;if((bl&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=i):l=l.next=p,vs.lanes|=h,El|=h}u=u.next}while(u!==null&&u!==n);l===null?o=i:l.next=a,hn(i,t.memoizedState)||(Wi=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=l,s.lastRenderedState=i}if(e=s.interleaved,e!==null){r=e;do n=r.lane,vs.lanes|=n,El|=n,r=r.next;while(r!==e)}else r===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function Xv(e){var t=Lr(),s=t.queue;if(s===null)throw Error(ke(311));s.lastRenderedReducer=e;var i=s.dispatch,r=s.pending,n=t.memoizedState;if(r!==null){s.pending=null;var o=r=r.next;do n=e(n,o.action),o=o.next;while(o!==r);hn(n,t.memoizedState)||(Wi=!0),t.memoizedState=n,t.baseQueue===null&&(t.baseState=n),s.lastRenderedState=n}return[n,i]}function iP(){}function rP(e,t){var s=vs,i=Lr(),r=t(),n=!hn(i.memoizedState,r);if(n&&(i.memoizedState=r,Wi=!0),i=i.queue,NS(aP.bind(null,s,i,e),[e]),i.getSnapshot!==t||n||js!==null&&js.memoizedState.tag&1){if(s.flags|=2048,rh(9,oP.bind(null,s,i,r,t),void 0,null),zs===null)throw Error(ke(349));bl&30||nP(s,t,r)}return r}function nP(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=vs.updateQueue,t===null?(t={lastEffect:null,stores:null},vs.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function oP(e,t,s,i){t.value=s,t.getSnapshot=i,lP(t)&&cP(e)}function aP(e,t,s){return s(function(){lP(t)&&cP(e)})}function lP(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!hn(e,s)}catch{return!0}}function cP(e){var t=ao(e,1);t!==null&&cn(t,e,1,-1)}function jb(e){var t=Rn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ih,lastRenderedState:e},t.queue=e,e=e.dispatch=pL.bind(null,vs,e),[t.memoizedState,e]}function rh(e,t,s,i){return e={tag:e,create:t,destroy:s,deps:i,next:null},t=vs.updateQueue,t===null?(t={lastEffect:null,stores:null},vs.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(i=s.next,s.next=e,e.next=i,t.lastEffect=e)),e}function uP(){return Lr().memoizedState}function xg(e,t,s,i){var r=Rn();vs.flags|=e,r.memoizedState=rh(1|t,s,void 0,i===void 0?null:i)}function wm(e,t,s,i){var r=Lr();i=i===void 0?null:i;var n=void 0;if(Ms!==null){var o=Ms.memoizedState;if(n=o.destroy,i!==null&&PS(i,o.deps)){r.memoizedState=rh(t,s,n,i);return}}vs.flags|=e,r.memoizedState=rh(1|t,s,n,i)}function Wb(e,t){return xg(8390656,8,e,t)}function NS(e,t){return wm(2048,8,e,t)}function dP(e,t){return wm(4,2,e,t)}function hP(e,t){return wm(4,4,e,t)}function pP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gP(e,t,s){return s=s!=null?s.concat([e]):null,wm(4,4,pP.bind(null,t,e),s)}function IS(){}function fP(e,t){var s=Lr();t=t===void 0?null:t;var i=s.memoizedState;return i!==null&&t!==null&&PS(t,i[1])?i[0]:(s.memoizedState=[e,t],e)}function mP(e,t){var s=Lr();t=t===void 0?null:t;var i=s.memoizedState;return i!==null&&t!==null&&PS(t,i[1])?i[0]:(e=e(),s.memoizedState=[e,t],e)}function vP(e,t,s){return bl&21?(hn(s,t)||(s=xD(),vs.lanes|=s,El|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wi=!0),e.memoizedState=s)}function dL(e,t){var s=Yt;Yt=s!==0&&4>s?s:4,e(!0);var i=Zv.transition;Zv.transition={};try{e(!1),t()}finally{Yt=s,Zv.transition=i}}function CP(){return Lr().memoizedState}function hL(e,t,s){var i=ia(e);if(s={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null},yP(e))wP(t,s);else if(s=eP(e,t,s,i),s!==null){var r=bi();cn(s,e,i,r),SP(s,t,i)}}function pL(e,t,s){var i=ia(e),r={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null};if(yP(e))wP(t,r);else{var n=e.alternate;if(e.lanes===0&&(n===null||n.lanes===0)&&(n=t.lastRenderedReducer,n!==null))try{var o=t.lastRenderedState,a=n(o,s);if(r.hasEagerState=!0,r.eagerState=a,hn(a,o)){var l=t.interleaved;l===null?(r.next=r,bS(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}s=eP(e,t,r,i),s!==null&&(r=bi(),cn(s,e,i,r),SP(s,t,i))}}function yP(e){var t=e.alternate;return e===vs||t!==null&&t===vs}function wP(e,t){_d=df=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function SP(e,t,s){if(s&4194240){var i=t.lanes;i&=e.pendingLanes,s|=i,t.lanes=s,cS(e,s)}}var hf={readContext:Mr,useCallback:ai,useContext:ai,useEffect:ai,useImperativeHandle:ai,useInsertionEffect:ai,useLayoutEffect:ai,useMemo:ai,useReducer:ai,useRef:ai,useState:ai,useDebugValue:ai,useDeferredValue:ai,useTransition:ai,useMutableSource:ai,useSyncExternalStore:ai,useId:ai,unstable_isNewReconciler:!1},gL={readContext:Mr,useCallback:function(e,t){return Rn().memoizedState=[e,t===void 0?null:t],e},useContext:Mr,useEffect:Wb,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,xg(4194308,4,pP.bind(null,t,e),s)},useLayoutEffect:function(e,t){return xg(4194308,4,e,t)},useInsertionEffect:function(e,t){return xg(4,2,e,t)},useMemo:function(e,t){var s=Rn();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var i=Rn();return t=s!==void 0?s(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=hL.bind(null,vs,e),[i.memoizedState,e]},useRef:function(e){var t=Rn();return e={current:e},t.memoizedState=e},useState:jb,useDebugValue:IS,useDeferredValue:function(e){return Rn().memoizedState=e},useTransition:function(){var e=jb(!1),t=e[0];return e=dL.bind(null,e[1]),Rn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var i=vs,r=Rn();if(gs){if(s===void 0)throw Error(ke(407));s=s()}else{if(s=t(),zs===null)throw Error(ke(349));bl&30||nP(i,t,s)}r.memoizedState=s;var n={value:s,getSnapshot:t};return r.queue=n,Wb(aP.bind(null,i,n,e),[e]),i.flags|=2048,rh(9,oP.bind(null,i,n,s,t),void 0,null),s},useId:function(){var e=Rn(),t=zs.identifierPrefix;if(gs){var s=so,i=to;s=(i&~(1<<32-ln(i)-1)).toString(32)+s,t=":"+t+"R"+s,s=sh++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=uL++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},fL={readContext:Mr,useCallback:fP,useContext:Mr,useEffect:NS,useImperativeHandle:gP,useInsertionEffect:dP,useLayoutEffect:hP,useMemo:mP,useReducer:Jv,useRef:uP,useState:function(){return Jv(ih)},useDebugValue:IS,useDeferredValue:function(e){var t=Lr();return vP(t,Ms.memoizedState,e)},useTransition:function(){var e=Jv(ih)[0],t=Lr().memoizedState;return[e,t]},useMutableSource:iP,useSyncExternalStore:rP,useId:CP,unstable_isNewReconciler:!1},mL={readContext:Mr,useCallback:fP,useContext:Mr,useEffect:NS,useImperativeHandle:gP,useInsertionEffect:dP,useLayoutEffect:hP,useMemo:mP,useReducer:Xv,useRef:uP,useState:function(){return Xv(ih)},useDebugValue:IS,useDeferredValue:function(e){var t=Lr();return Ms===null?t.memoizedState=e:vP(t,Ms.memoizedState,e)},useTransition:function(){var e=Xv(ih)[0],t=Lr().memoizedState;return[e,t]},useMutableSource:iP,useSyncExternalStore:rP,useId:CP,unstable_isNewReconciler:!1};function qr(e,t){if(e&&e.defaultProps){t=Cs({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function xy(e,t,s,i){t=e.memoizedState,s=s(i,t),s=s==null?t:Cs({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Sm={isMounted:function(e){return(e=e._reactInternals)?Bl(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var i=bi(),r=ia(e),n=io(i,r);n.payload=t,s!=null&&(n.callback=s),t=ta(e,n,r),t!==null&&(cn(t,e,r,i),wg(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var i=bi(),r=ia(e),n=io(i,r);n.tag=1,n.payload=t,s!=null&&(n.callback=s),t=ta(e,n,r),t!==null&&(cn(t,e,r,i),wg(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=bi(),i=ia(e),r=io(s,i);r.tag=2,t!=null&&(r.callback=t),t=ta(e,r,i),t!==null&&(cn(t,e,i,s),wg(t,e,i))}};function zb(e,t,s,i,r,n,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,n,o):t.prototype&&t.prototype.isPureReactComponent?!Qd(s,i)||!Qd(r,n):!0}function xP(e,t,s){var i=!1,r=da,n=t.contextType;return typeof n=="object"&&n!==null?n=Mr(n):(r=qi(t)?Sl:di.current,i=t.contextTypes,n=(i=i!=null)?Uc(e,r):da),t=new t(s,n),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Sm,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=n),t}function Ub(e,t,s,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,i),t.state!==e&&Sm.enqueueReplaceState(t,t.state,null)}function by(e,t,s,i){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},ES(e);var n=t.contextType;typeof n=="object"&&n!==null?r.context=Mr(n):(n=qi(t)?Sl:di.current,r.context=Uc(e,n)),r.state=e.memoizedState,n=t.getDerivedStateFromProps,typeof n=="function"&&(xy(e,t,n,s),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&Sm.enqueueReplaceState(r,r.state,null),cf(e,s,r,i),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function qc(e,t){try{var s="",i=t;do s+=zk(i),i=i.return;while(i);var r=s}catch(n){r=`
Error generating stack: `+n.message+`
`+n.stack}return{value:e,source:t,stack:r,digest:null}}function eC(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function Ey(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var vL=typeof WeakMap=="function"?WeakMap:Map;function bP(e,t,s){s=io(-1,s),s.tag=3,s.payload={element:null};var i=t.value;return s.callback=function(){gf||(gf=!0,ky=i),Ey(e,t)},s}function EP(e,t,s){s=io(-1,s),s.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;s.payload=function(){return i(r)},s.callback=function(){Ey(e,t)}}var n=e.stateNode;return n!==null&&typeof n.componentDidCatch=="function"&&(s.callback=function(){Ey(e,t),typeof i!="function"&&(sa===null?sa=new Set([this]):sa.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),s}function $b(e,t,s){var i=e.pingCache;if(i===null){i=e.pingCache=new vL;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(s)||(r.add(s),e=NL.bind(null,e,t,s),t.then(e,e))}function Kb(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Yb(e,t,s,i,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=io(-1,1),t.tag=2,ta(s,t,1))),s.lanes|=1),e)}var CL=vo.ReactCurrentOwner,Wi=!1;function Ci(e,t,s,i){t.child=e===null?XD(t,null,s,i):Kc(t,e.child,s,i)}function qb(e,t,s,i,r){s=s.render;var n=t.ref;return Ac(t,r),i=AS(e,t,s,i,n,r),s=FS(),e!==null&&!Wi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,lo(e,t,r)):(gs&&s&&vS(t),t.flags|=1,Ci(e,t,i,r),t.child)}function Qb(e,t,s,i,r){if(e===null){var n=s.type;return typeof n=="function"&&!BS(n)&&n.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=n,RP(e,t,n,i,r)):(e=Tg(s.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(n=e.child,!(e.lanes&r)){var o=n.memoizedProps;if(s=s.compare,s=s!==null?s:Qd,s(o,i)&&e.ref===t.ref)return lo(e,t,r)}return t.flags|=1,e=ra(n,i),e.ref=t.ref,e.return=t,t.child=e}function RP(e,t,s,i,r){if(e!==null){var n=e.memoizedProps;if(Qd(n,i)&&e.ref===t.ref)if(Wi=!1,t.pendingProps=i=n,(e.lanes&r)!==0)e.flags&131072&&(Wi=!0);else return t.lanes=e.lanes,lo(e,t,r)}return Ry(e,t,s,i,r)}function TP(e,t,s){var i=t.pendingProps,r=i.children,n=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},is(Sc,nr),nr|=s;else{if(!(s&1073741824))return e=n!==null?n.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,is(Sc,nr),nr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=n!==null?n.baseLanes:s,is(Sc,nr),nr|=i}else n!==null?(i=n.baseLanes|s,t.memoizedState=null):i=s,is(Sc,nr),nr|=i;return Ci(e,t,r,s),t.child}function DP(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Ry(e,t,s,i,r){var n=qi(s)?Sl:di.current;return n=Uc(t,n),Ac(t,r),s=AS(e,t,s,i,n,r),i=FS(),e!==null&&!Wi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,lo(e,t,r)):(gs&&i&&vS(t),t.flags|=1,Ci(e,t,s,r),t.child)}function Zb(e,t,s,i,r){if(qi(s)){var n=!0;rf(t)}else n=!1;if(Ac(t,r),t.stateNode===null)bg(e,t),xP(t,s,i),by(t,s,i,r),i=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=s.contextType;typeof u=="object"&&u!==null?u=Mr(u):(u=qi(s)?Sl:di.current,u=Uc(t,u));var h=s.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&Ub(t,o,i,u),Oo=!1;var g=t.memoizedState;o.state=g,cf(t,i,o,r),l=t.memoizedState,a!==i||g!==l||Yi.current||Oo?(typeof h=="function"&&(xy(t,s,h,i),l=t.memoizedState),(a=Oo||zb(t,s,a,i,g,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,tP(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:qr(t.type,a),o.props=u,p=t.pendingProps,g=o.context,l=s.contextType,typeof l=="object"&&l!==null?l=Mr(l):(l=qi(s)?Sl:di.current,l=Uc(t,l));var m=s.getDerivedStateFromProps;(h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||g!==l)&&Ub(t,o,i,l),Oo=!1,g=t.memoizedState,o.state=g,cf(t,i,o,r);var C=t.memoizedState;a!==p||g!==C||Yi.current||Oo?(typeof m=="function"&&(xy(t,s,m,i),C=t.memoizedState),(u=Oo||zb(t,s,u,i,g,C,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,C,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,C,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=C),o.props=i,o.state=C,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),i=!1)}return Ty(e,t,s,i,n,r)}function Ty(e,t,s,i,r,n){DP(e,t);var o=(t.flags&128)!==0;if(!i&&!o)return r&&Lb(t,s,!1),lo(e,t,n);i=t.stateNode,CL.current=t;var a=o&&typeof s.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&o?(t.child=Kc(t,e.child,null,n),t.child=Kc(t,null,a,n)):Ci(e,t,a,n),t.memoizedState=i.state,r&&Lb(t,s,!0),t.child}function PP(e){var t=e.stateNode;t.pendingContext?Mb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Mb(e,t.context,!1),RS(e,t.containerInfo)}function Jb(e,t,s,i,r){return $c(),yS(r),t.flags|=256,Ci(e,t,s,i),t.child}var Dy={dehydrated:null,treeContext:null,retryLane:0};function Py(e){return{baseLanes:e,cachePool:null,transitions:null}}function AP(e,t,s){var i=t.pendingProps,r=ms.current,n=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(n=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),is(ms,r&1),e===null)return wy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=i.children,e=i.fallback,n?(i=t.mode,n=t.child,o={mode:"hidden",children:o},!(i&1)&&n!==null?(n.childLanes=0,n.pendingProps=o):n=Em(o,i,0,null),e=hl(e,i,s,null),n.return=t,e.return=t,n.sibling=e,t.child=n,t.child.memoizedState=Py(s),t.memoizedState=Dy,e):_S(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return yL(e,t,o,i,a,r,s);if(n){n=i.fallback,o=t.mode,r=e.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=ra(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?n=ra(a,n):(n=hl(n,o,s,null),n.flags|=2),n.return=t,i.return=t,i.sibling=n,t.child=i,i=n,n=t.child,o=e.child.memoizedState,o=o===null?Py(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},n.memoizedState=o,n.childLanes=e.childLanes&~s,t.memoizedState=Dy,i}return n=e.child,e=n.sibling,i=ra(n,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=s),i.return=t,i.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=i,t.memoizedState=null,i}function _S(e,t){return t=Em({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function eg(e,t,s,i){return i!==null&&yS(i),Kc(t,e.child,null,s),e=_S(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function yL(e,t,s,i,r,n,o){if(s)return t.flags&256?(t.flags&=-257,i=eC(Error(ke(422))),eg(e,t,o,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(n=i.fallback,r=t.mode,i=Em({mode:"visible",children:i.children},r,0,null),n=hl(n,r,o,null),n.flags|=2,i.return=t,n.return=t,i.sibling=n,t.child=i,t.mode&1&&Kc(t,e.child,null,o),t.child.memoizedState=Py(o),t.memoizedState=Dy,n);if(!(t.mode&1))return eg(e,t,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,n=Error(ke(419)),i=eC(n,i,void 0),eg(e,t,o,i)}if(a=(o&e.childLanes)!==0,Wi||a){if(i=zs,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==n.retryLane&&(n.retryLane=r,ao(e,r),cn(i,e,r,-1))}return VS(),i=eC(Error(ke(421))),eg(e,t,o,i)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=IL.bind(null,e),r._reactRetry=t,null):(e=n.treeContext,dr=ea(r.nextSibling),hr=t,gs=!0,sn=null,e!==null&&(Tr[Dr++]=to,Tr[Dr++]=so,Tr[Dr++]=xl,to=e.id,so=e.overflow,xl=t),t=_S(t,i.children),t.flags|=4096,t)}function Xb(e,t,s){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Sy(e.return,t,s)}function tC(e,t,s,i,r){var n=e.memoizedState;n===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:s,tailMode:r}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=i,n.tail=s,n.tailMode=r)}function FP(e,t,s){var i=t.pendingProps,r=i.revealOrder,n=i.tail;if(Ci(e,t,i.children,s),i=ms.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xb(e,s,t);else if(e.tag===19)Xb(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(is(ms,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(s=t.child,r=null;s!==null;)e=s.alternate,e!==null&&uf(e)===null&&(r=s),s=s.sibling;s=r,s===null?(r=t.child,t.child=null):(r=s.sibling,s.sibling=null),tC(t,!1,r,s,n);break;case"backwards":for(s=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&uf(e)===null){t.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}tC(t,!0,s,null,n);break;case"together":tC(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bg(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function lo(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),El|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,s=ra(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=ra(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function wL(e,t,s){switch(t.tag){case 3:PP(t),$c();break;case 5:sP(t);break;case 1:qi(t.type)&&rf(t);break;case 4:RS(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;is(af,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(is(ms,ms.current&1),t.flags|=128,null):s&t.child.childLanes?AP(e,t,s):(is(ms,ms.current&1),e=lo(e,t,s),e!==null?e.sibling:null);is(ms,ms.current&1);break;case 19:if(i=(s&t.childLanes)!==0,e.flags&128){if(i)return FP(e,t,s);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),is(ms,ms.current),i)break;return null;case 22:case 23:return t.lanes=0,TP(e,t,s)}return lo(e,t,s)}var NP,Ay,IP,_P;NP=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Ay=function(){};IP=function(e,t,s,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,el(kn.current);var n=null;switch(s){case"input":r=ZC(e,r),i=ZC(e,i),n=[];break;case"select":r=Cs({},r,{value:void 0}),i=Cs({},i,{value:void 0}),n=[];break;case"textarea":r=ey(e,r),i=ey(e,i),n=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=tf)}sy(s,i);var o;s=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Wd.hasOwnProperty(u)?n||(n=[]):(n=n||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(s||(s={}),s[o]=l[o])}else s||(n||(n=[]),n.push(u,s)),s=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(n=n||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(n=n||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Wd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&os("scroll",e),n||a===l||(n=[])):(n=n||[]).push(u,l))}s&&(n=n||[]).push("style",s);var u=n;(t.updateQueue=u)&&(t.flags|=4)}};_P=function(e,t,s,i){s!==i&&(t.flags|=4)};function id(e,t){if(!gs)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var i=null;s!==null;)s.alternate!==null&&(i=s),s=s.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function li(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,i=0;if(t)for(var r=e.child;r!==null;)s|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)s|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=s,t}function SL(e,t,s){var i=t.pendingProps;switch(CS(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return li(t),null;case 1:return qi(t.type)&&sf(),li(t),null;case 3:return i=t.stateNode,Yc(),ls(Yi),ls(di),DS(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Jp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,sn!==null&&(Oy(sn),sn=null))),Ay(e,t),li(t),null;case 5:TS(t);var r=el(th.current);if(s=t.type,e!==null&&t.stateNode!=null)IP(e,t,s,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(ke(166));return li(t),null}if(e=el(kn.current),Jp(t)){i=t.stateNode,s=t.type;var n=t.memoizedProps;switch(i[An]=t,i[Xd]=n,e=(t.mode&1)!==0,s){case"dialog":os("cancel",i),os("close",i);break;case"iframe":case"object":case"embed":os("load",i);break;case"video":case"audio":for(r=0;r<pd.length;r++)os(pd[r],i);break;case"source":os("error",i);break;case"img":case"image":case"link":os("error",i),os("load",i);break;case"details":os("toggle",i);break;case"input":lb(i,n),os("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!n.multiple},os("invalid",i);break;case"textarea":ub(i,n),os("invalid",i)}sy(s,n),r=null;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];o==="children"?typeof a=="string"?i.textContent!==a&&(n.suppressHydrationWarning!==!0&&Zp(i.textContent,a,e),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(n.suppressHydrationWarning!==!0&&Zp(i.textContent,a,e),r=["children",""+a]):Wd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&os("scroll",i)}switch(s){case"input":Wp(i),cb(i,n,!0);break;case"textarea":Wp(i),db(i);break;case"select":case"option":break;default:typeof n.onClick=="function"&&(i.onclick=tf)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=aD(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=o.createElement(s,{is:i.is}):(e=o.createElement(s),s==="select"&&(o=e,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):e=o.createElementNS(e,s),e[An]=t,e[Xd]=i,NP(e,t,!1,!1),t.stateNode=e;e:{switch(o=iy(s,i),s){case"dialog":os("cancel",e),os("close",e),r=i;break;case"iframe":case"object":case"embed":os("load",e),r=i;break;case"video":case"audio":for(r=0;r<pd.length;r++)os(pd[r],e);r=i;break;case"source":os("error",e),r=i;break;case"img":case"image":case"link":os("error",e),os("load",e),r=i;break;case"details":os("toggle",e),r=i;break;case"input":lb(e,i),r=ZC(e,i),os("invalid",e);break;case"option":r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=Cs({},i,{value:void 0}),os("invalid",e);break;case"textarea":ub(e,i),r=ey(e,i),os("invalid",e);break;default:r=i}sy(s,r),a=r;for(n in a)if(a.hasOwnProperty(n)){var l=a[n];n==="style"?uD(e,l):n==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&lD(e,l)):n==="children"?typeof l=="string"?(s!=="textarea"||l!=="")&&zd(e,l):typeof l=="number"&&zd(e,""+l):n!=="suppressContentEditableWarning"&&n!=="suppressHydrationWarning"&&n!=="autoFocus"&&(Wd.hasOwnProperty(n)?l!=null&&n==="onScroll"&&os("scroll",e):l!=null&&iS(e,n,l,o))}switch(s){case"input":Wp(e),cb(e,i,!1);break;case"textarea":Wp(e),db(e);break;case"option":i.value!=null&&e.setAttribute("value",""+ua(i.value));break;case"select":e.multiple=!!i.multiple,n=i.value,n!=null?Rc(e,!!i.multiple,n,!1):i.defaultValue!=null&&Rc(e,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=tf)}switch(s){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return li(t),null;case 6:if(e&&t.stateNode!=null)_P(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(ke(166));if(s=el(th.current),el(kn.current),Jp(t)){if(i=t.stateNode,s=t.memoizedProps,i[An]=t,(n=i.nodeValue!==s)&&(e=hr,e!==null))switch(e.tag){case 3:Zp(i.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Zp(i.nodeValue,s,(e.mode&1)!==0)}n&&(t.flags|=4)}else i=(s.nodeType===9?s:s.ownerDocument).createTextNode(i),i[An]=t,t.stateNode=i}return li(t),null;case 13:if(ls(ms),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(gs&&dr!==null&&t.mode&1&&!(t.flags&128))ZD(),$c(),t.flags|=98560,n=!1;else if(n=Jp(t),i!==null&&i.dehydrated!==null){if(e===null){if(!n)throw Error(ke(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ke(317));n[An]=t}else $c(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;li(t),n=!1}else sn!==null&&(Oy(sn),sn=null),n=!0;if(!n)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||ms.current&1?Os===0&&(Os=3):VS())),t.updateQueue!==null&&(t.flags|=4),li(t),null);case 4:return Yc(),Ay(e,t),e===null&&Zd(t.stateNode.containerInfo),li(t),null;case 10:return xS(t.type._context),li(t),null;case 17:return qi(t.type)&&sf(),li(t),null;case 19:if(ls(ms),n=t.memoizedState,n===null)return li(t),null;if(i=(t.flags&128)!==0,o=n.rendering,o===null)if(i)id(n,!1);else{if(Os!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=uf(e),o!==null){for(t.flags|=128,id(n,!1),i=o.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=s,s=t.child;s!==null;)n=s,e=i,n.flags&=14680066,o=n.alternate,o===null?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,e=o.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return is(ms,ms.current&1|2),t.child}e=e.sibling}n.tail!==null&&Ts()>Qc&&(t.flags|=128,i=!0,id(n,!1),t.lanes=4194304)}else{if(!i)if(e=uf(o),e!==null){if(t.flags|=128,i=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),id(n,!0),n.tail===null&&n.tailMode==="hidden"&&!o.alternate&&!gs)return li(t),null}else 2*Ts()-n.renderingStartTime>Qc&&s!==1073741824&&(t.flags|=128,i=!0,id(n,!1),t.lanes=4194304);n.isBackwards?(o.sibling=t.child,t.child=o):(s=n.last,s!==null?s.sibling=o:t.child=o,n.last=o)}return n.tail!==null?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=Ts(),t.sibling=null,s=ms.current,is(ms,i?s&1|2:s&1),t):(li(t),null);case 22:case 23:return GS(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?nr&1073741824&&(li(t),t.subtreeFlags&6&&(t.flags|=8192)):li(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function xL(e,t){switch(CS(t),t.tag){case 1:return qi(t.type)&&sf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Yc(),ls(Yi),ls(di),DS(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return TS(t),null;case 13:if(ls(ms),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));$c()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ls(ms),null;case 4:return Yc(),null;case 10:return xS(t.type._context),null;case 22:case 23:return GS(),null;case 24:return null;default:return null}}var tg=!1,ci=!1,bL=typeof WeakSet=="function"?WeakSet:Set,Je=null;function wc(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(i){Ss(e,t,i)}else s.current=null}function Fy(e,t,s){try{s()}catch(i){Ss(e,t,i)}}var eE=!1;function EL(e,t){if(py=Jg,e=GD(),mS(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var i=s.getSelection&&s.getSelection();if(i&&i.rangeCount!==0){s=i.anchorNode;var r=i.anchorOffset,n=i.focusNode;i=i.focusOffset;try{s.nodeType,n.nodeType}catch{s=null;break e}var o=0,a=-1,l=-1,u=0,h=0,p=e,g=null;t:for(;;){for(var m;p!==s||r!==0&&p.nodeType!==3||(a=o+r),p!==n||i!==0&&p.nodeType!==3||(l=o+i),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===e)break t;if(g===s&&++u===r&&(a=o),g===n&&++h===i&&(l=o),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}s=a===-1||l===-1?null:{start:a,end:l}}else s=null}s=s||{start:0,end:0}}else s=null;for(gy={focusedElem:e,selectionRange:s},Jg=!1,Je=t;Je!==null;)if(t=Je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Je=e;else for(;Je!==null;){t=Je;try{var C=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var y=C.memoizedProps,R=C.memoizedState,x=t.stateNode,S=x.getSnapshotBeforeUpdate(t.elementType===t.type?y:qr(t.type,y),R);x.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var T=t.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(I){Ss(t,t.return,I)}if(e=t.sibling,e!==null){e.return=t.return,Je=e;break}Je=t.return}return C=eE,eE=!1,C}function kd(e,t,s){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&e)===e){var n=r.destroy;r.destroy=void 0,n!==void 0&&Fy(t,s,n)}r=r.next}while(r!==i)}}function xm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var i=s.create;s.destroy=i()}s=s.next}while(s!==t)}}function Ny(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function kP(e){var t=e.alternate;t!==null&&(e.alternate=null,kP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[An],delete t[Xd],delete t[vy],delete t[oL],delete t[aL])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function MP(e){return e.tag===5||e.tag===3||e.tag===4}function tE(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||MP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Iy(e,t,s){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=tf));else if(i!==4&&(e=e.child,e!==null))for(Iy(e,t,s),e=e.sibling;e!==null;)Iy(e,t,s),e=e.sibling}function _y(e,t,s){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(_y(e,t,s),e=e.sibling;e!==null;)_y(e,t,s),e=e.sibling}var Zs=null,Xr=!1;function Ao(e,t,s){for(s=s.child;s!==null;)LP(e,t,s),s=s.sibling}function LP(e,t,s){if(_n&&typeof _n.onCommitFiberUnmount=="function")try{_n.onCommitFiberUnmount(gm,s)}catch{}switch(s.tag){case 5:ci||wc(s,t);case 6:var i=Zs,r=Xr;Zs=null,Ao(e,t,s),Zs=i,Xr=r,Zs!==null&&(Xr?(e=Zs,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Zs.removeChild(s.stateNode));break;case 18:Zs!==null&&(Xr?(e=Zs,s=s.stateNode,e.nodeType===8?Yv(e.parentNode,s):e.nodeType===1&&Yv(e,s),Yd(e)):Yv(Zs,s.stateNode));break;case 4:i=Zs,r=Xr,Zs=s.stateNode.containerInfo,Xr=!0,Ao(e,t,s),Zs=i,Xr=r;break;case 0:case 11:case 14:case 15:if(!ci&&(i=s.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var n=r,o=n.destroy;n=n.tag,o!==void 0&&(n&2||n&4)&&Fy(s,t,o),r=r.next}while(r!==i)}Ao(e,t,s);break;case 1:if(!ci&&(wc(s,t),i=s.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=s.memoizedProps,i.state=s.memoizedState,i.componentWillUnmount()}catch(a){Ss(s,t,a)}Ao(e,t,s);break;case 21:Ao(e,t,s);break;case 22:s.mode&1?(ci=(i=ci)||s.memoizedState!==null,Ao(e,t,s),ci=i):Ao(e,t,s);break;default:Ao(e,t,s)}}function sE(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new bL),t.forEach(function(i){var r=_L.bind(null,e,i);s.has(i)||(s.add(i),i.then(r,r))})}}function Kr(e,t){var s=t.deletions;if(s!==null)for(var i=0;i<s.length;i++){var r=s[i];try{var n=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Zs=a.stateNode,Xr=!1;break e;case 3:Zs=a.stateNode.containerInfo,Xr=!0;break e;case 4:Zs=a.stateNode.containerInfo,Xr=!0;break e}a=a.return}if(Zs===null)throw Error(ke(160));LP(n,o,r),Zs=null,Xr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Ss(r,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)OP(t,e),t=t.sibling}function OP(e,t){var s=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Kr(t,e),yn(e),i&4){try{kd(3,e,e.return),xm(3,e)}catch(y){Ss(e,e.return,y)}try{kd(5,e,e.return)}catch(y){Ss(e,e.return,y)}}break;case 1:Kr(t,e),yn(e),i&512&&s!==null&&wc(s,s.return);break;case 5:if(Kr(t,e),yn(e),i&512&&s!==null&&wc(s,s.return),e.flags&32){var r=e.stateNode;try{zd(r,"")}catch(y){Ss(e,e.return,y)}}if(i&4&&(r=e.stateNode,r!=null)){var n=e.memoizedProps,o=s!==null?s.memoizedProps:n,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&n.type==="radio"&&n.name!=null&&nD(r,n),iy(a,o);var u=iy(a,n);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?uD(r,p):h==="dangerouslySetInnerHTML"?lD(r,p):h==="children"?zd(r,p):iS(r,h,p,u)}switch(a){case"input":JC(r,n);break;case"textarea":oD(r,n);break;case"select":var g=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!n.multiple;var m=n.value;m!=null?Rc(r,!!n.multiple,m,!1):g!==!!n.multiple&&(n.defaultValue!=null?Rc(r,!!n.multiple,n.defaultValue,!0):Rc(r,!!n.multiple,n.multiple?[]:"",!1))}r[Xd]=n}catch(y){Ss(e,e.return,y)}}break;case 6:if(Kr(t,e),yn(e),i&4){if(e.stateNode===null)throw Error(ke(162));r=e.stateNode,n=e.memoizedProps;try{r.nodeValue=n}catch(y){Ss(e,e.return,y)}}break;case 3:if(Kr(t,e),yn(e),i&4&&s!==null&&s.memoizedState.isDehydrated)try{Yd(t.containerInfo)}catch(y){Ss(e,e.return,y)}break;case 4:Kr(t,e),yn(e);break;case 13:Kr(t,e),yn(e),r=e.child,r.flags&8192&&(n=r.memoizedState!==null,r.stateNode.isHidden=n,!n||r.alternate!==null&&r.alternate.memoizedState!==null||(LS=Ts())),i&4&&sE(e);break;case 22:if(h=s!==null&&s.memoizedState!==null,e.mode&1?(ci=(u=ci)||h,Kr(t,e),ci=u):Kr(t,e),yn(e),i&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(Je=e,h=e.child;h!==null;){for(p=Je=h;Je!==null;){switch(g=Je,m=g.child,g.tag){case 0:case 11:case 14:case 15:kd(4,g,g.return);break;case 1:wc(g,g.return);var C=g.stateNode;if(typeof C.componentWillUnmount=="function"){i=g,s=g.return;try{t=i,C.props=t.memoizedProps,C.state=t.memoizedState,C.componentWillUnmount()}catch(y){Ss(i,s,y)}}break;case 5:wc(g,g.return);break;case 22:if(g.memoizedState!==null){rE(p);continue}}m!==null?(m.return=g,Je=m):rE(p)}h=h.sibling}e:for(h=null,p=e;;){if(p.tag===5){if(h===null){h=p;try{r=p.stateNode,u?(n=r.style,typeof n.setProperty=="function"?n.setProperty("display","none","important"):n.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=cD("display",o))}catch(y){Ss(e,e.return,y)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(y){Ss(e,e.return,y)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Kr(t,e),yn(e),i&4&&sE(e);break;case 21:break;default:Kr(t,e),yn(e)}}function yn(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(MP(s)){var i=s;break e}s=s.return}throw Error(ke(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(zd(r,""),i.flags&=-33);var n=tE(e);_y(e,n,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=tE(e);Iy(e,a,o);break;default:throw Error(ke(161))}}catch(l){Ss(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function RL(e,t,s){Je=e,GP(e)}function GP(e,t,s){for(var i=(e.mode&1)!==0;Je!==null;){var r=Je,n=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||tg;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||ci;a=tg;var u=ci;if(tg=o,(ci=l)&&!u)for(Je=r;Je!==null;)o=Je,l=o.child,o.tag===22&&o.memoizedState!==null?nE(r):l!==null?(l.return=o,Je=l):nE(r);for(;n!==null;)Je=n,GP(n),n=n.sibling;Je=r,tg=a,ci=u}iE(e)}else r.subtreeFlags&8772&&n!==null?(n.return=r,Je=n):iE(e)}}function iE(e){for(;Je!==null;){var t=Je;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ci||xm(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!ci)if(s===null)i.componentDidMount();else{var r=t.elementType===t.type?s.memoizedProps:qr(t.type,s.memoizedProps);i.componentDidUpdate(r,s.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var n=t.updateQueue;n!==null&&Hb(t,n,i);break;case 3:var o=t.updateQueue;if(o!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}Hb(t,o,s)}break;case 5:var a=t.stateNode;if(s===null&&t.flags&4){s=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&s.focus();break;case"img":l.src&&(s.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Yd(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}ci||t.flags&512&&Ny(t)}catch(g){Ss(t,t.return,g)}}if(t===e){Je=null;break}if(s=t.sibling,s!==null){s.return=t.return,Je=s;break}Je=t.return}}function rE(e){for(;Je!==null;){var t=Je;if(t===e){Je=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Je=s;break}Je=t.return}}function nE(e){for(;Je!==null;){var t=Je;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{xm(4,t)}catch(l){Ss(t,s,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(l){Ss(t,r,l)}}var n=t.return;try{Ny(t)}catch(l){Ss(t,n,l)}break;case 5:var o=t.return;try{Ny(t)}catch(l){Ss(t,o,l)}}}catch(l){Ss(t,t.return,l)}if(t===e){Je=null;break}var a=t.sibling;if(a!==null){a.return=t.return,Je=a;break}Je=t.return}}var TL=Math.ceil,pf=vo.ReactCurrentDispatcher,kS=vo.ReactCurrentOwner,Ir=vo.ReactCurrentBatchConfig,Ht=0,zs=null,Is=null,Xs=0,nr=0,Sc=Sa(0),Os=0,nh=null,El=0,bm=0,MS=0,Md=null,Bi=null,LS=0,Qc=1/0,Qn=null,gf=!1,ky=null,sa=null,sg=!1,Yo=null,ff=0,Ld=0,My=null,Eg=-1,Rg=0;function bi(){return Ht&6?Ts():Eg!==-1?Eg:Eg=Ts()}function ia(e){return e.mode&1?Ht&2&&Xs!==0?Xs&-Xs:cL.transition!==null?(Rg===0&&(Rg=xD()),Rg):(e=Yt,e!==0||(e=window.event,e=e===void 0?16:AD(e.type)),e):1}function cn(e,t,s,i){if(50<Ld)throw Ld=0,My=null,Error(ke(185));lp(e,s,i),(!(Ht&2)||e!==zs)&&(e===zs&&(!(Ht&2)&&(bm|=s),Os===4&&Vo(e,Xs)),Qi(e,i),s===1&&Ht===0&&!(t.mode&1)&&(Qc=Ts()+500,ym&&xa()))}function Qi(e,t){var s=e.callbackNode;cM(e,t);var i=Zg(e,e===zs?Xs:0);if(i===0)s!==null&&gb(s),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(s!=null&&gb(s),t===1)e.tag===0?lL(oE.bind(null,e)):YD(oE.bind(null,e)),rL(function(){!(Ht&6)&&xa()}),s=null;else{switch(bD(i)){case 1:s=lS;break;case 4:s=wD;break;case 16:s=Qg;break;case 536870912:s=SD;break;default:s=Qg}s=$P(s,VP.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function VP(e,t){if(Eg=-1,Rg=0,Ht&6)throw Error(ke(327));var s=e.callbackNode;if(Fc()&&e.callbackNode!==s)return null;var i=Zg(e,e===zs?Xs:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=mf(e,i);else{t=i;var r=Ht;Ht|=2;var n=HP();(zs!==e||Xs!==t)&&(Qn=null,Qc=Ts()+500,dl(e,t));do try{AL();break}catch(a){BP(e,a)}while(!0);SS(),pf.current=n,Ht=r,Is!==null?t=0:(zs=null,Xs=0,t=Os)}if(t!==0){if(t===2&&(r=ly(e),r!==0&&(i=r,t=Ly(e,r))),t===1)throw s=nh,dl(e,0),Vo(e,i),Qi(e,Ts()),s;if(t===6)Vo(e,i);else{if(r=e.current.alternate,!(i&30)&&!DL(r)&&(t=mf(e,i),t===2&&(n=ly(e),n!==0&&(i=n,t=Ly(e,n))),t===1))throw s=nh,dl(e,0),Vo(e,i),Qi(e,Ts()),s;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(ke(345));case 2:ja(e,Bi,Qn);break;case 3:if(Vo(e,i),(i&130023424)===i&&(t=LS+500-Ts(),10<t)){if(Zg(e,0)!==0)break;if(r=e.suspendedLanes,(r&i)!==i){bi(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=my(ja.bind(null,e,Bi,Qn),t);break}ja(e,Bi,Qn);break;case 4:if(Vo(e,i),(i&4194240)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-ln(i);n=1<<o,o=t[o],o>r&&(r=o),i&=~n}if(i=r,i=Ts()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*TL(i/1960))-i,10<i){e.timeoutHandle=my(ja.bind(null,e,Bi,Qn),i);break}ja(e,Bi,Qn);break;case 5:ja(e,Bi,Qn);break;default:throw Error(ke(329))}}}return Qi(e,Ts()),e.callbackNode===s?VP.bind(null,e):null}function Ly(e,t){var s=Md;return e.current.memoizedState.isDehydrated&&(dl(e,t).flags|=256),e=mf(e,t),e!==2&&(t=Bi,Bi=s,t!==null&&Oy(t)),e}function Oy(e){Bi===null?Bi=e:Bi.push.apply(Bi,e)}function DL(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var i=0;i<s.length;i++){var r=s[i],n=r.getSnapshot;r=r.value;try{if(!hn(n(),r))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vo(e,t){for(t&=~MS,t&=~bm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-ln(t),i=1<<s;e[s]=-1,t&=~i}}function oE(e){if(Ht&6)throw Error(ke(327));Fc();var t=Zg(e,0);if(!(t&1))return Qi(e,Ts()),null;var s=mf(e,t);if(e.tag!==0&&s===2){var i=ly(e);i!==0&&(t=i,s=Ly(e,i))}if(s===1)throw s=nh,dl(e,0),Vo(e,t),Qi(e,Ts()),s;if(s===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ja(e,Bi,Qn),Qi(e,Ts()),null}function OS(e,t){var s=Ht;Ht|=1;try{return e(t)}finally{Ht=s,Ht===0&&(Qc=Ts()+500,ym&&xa())}}function Rl(e){Yo!==null&&Yo.tag===0&&!(Ht&6)&&Fc();var t=Ht;Ht|=1;var s=Ir.transition,i=Yt;try{if(Ir.transition=null,Yt=1,e)return e()}finally{Yt=i,Ir.transition=s,Ht=t,!(Ht&6)&&xa()}}function GS(){nr=Sc.current,ls(Sc)}function dl(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,iL(s)),Is!==null)for(s=Is.return;s!==null;){var i=s;switch(CS(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&sf();break;case 3:Yc(),ls(Yi),ls(di),DS();break;case 5:TS(i);break;case 4:Yc();break;case 13:ls(ms);break;case 19:ls(ms);break;case 10:xS(i.type._context);break;case 22:case 23:GS()}s=s.return}if(zs=e,Is=e=ra(e.current,null),Xs=nr=t,Os=0,nh=null,MS=bm=El=0,Bi=Md=null,Xa!==null){for(t=0;t<Xa.length;t++)if(s=Xa[t],i=s.interleaved,i!==null){s.interleaved=null;var r=i.next,n=s.pending;if(n!==null){var o=n.next;n.next=r,i.next=o}s.pending=i}Xa=null}return e}function BP(e,t){do{var s=Is;try{if(SS(),Sg.current=hf,df){for(var i=vs.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}df=!1}if(bl=0,js=Ms=vs=null,_d=!1,sh=0,kS.current=null,s===null||s.return===null){Os=1,nh=t,Is=null;break}e:{var n=e,o=s.return,a=s,l=t;if(t=Xs,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Kb(o);if(m!==null){m.flags&=-257,Yb(m,o,a,n,t),m.mode&1&&$b(n,u,t),t=m,l=u;var C=t.updateQueue;if(C===null){var y=new Set;y.add(l),t.updateQueue=y}else C.add(l);break e}else{if(!(t&1)){$b(n,u,t),VS();break e}l=Error(ke(426))}}else if(gs&&a.mode&1){var R=Kb(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),Yb(R,o,a,n,t),yS(qc(l,a));break e}}n=l=qc(l,a),Os!==4&&(Os=2),Md===null?Md=[n]:Md.push(n),n=o;do{switch(n.tag){case 3:n.flags|=65536,t&=-t,n.lanes|=t;var x=bP(n,l,t);Bb(n,x);break e;case 1:a=l;var S=n.type,T=n.stateNode;if(!(n.flags&128)&&(typeof S.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(sa===null||!sa.has(T)))){n.flags|=65536,t&=-t,n.lanes|=t;var I=EP(n,a,t);Bb(n,I);break e}}n=n.return}while(n!==null)}WP(s)}catch(V){t=V,Is===s&&s!==null&&(Is=s=s.return);continue}break}while(!0)}function HP(){var e=pf.current;return pf.current=hf,e===null?hf:e}function VS(){(Os===0||Os===3||Os===2)&&(Os=4),zs===null||!(El&268435455)&&!(bm&268435455)||Vo(zs,Xs)}function mf(e,t){var s=Ht;Ht|=2;var i=HP();(zs!==e||Xs!==t)&&(Qn=null,dl(e,t));do try{PL();break}catch(r){BP(e,r)}while(!0);if(SS(),Ht=s,pf.current=i,Is!==null)throw Error(ke(261));return zs=null,Xs=0,Os}function PL(){for(;Is!==null;)jP(Is)}function AL(){for(;Is!==null&&!eM();)jP(Is)}function jP(e){var t=UP(e.alternate,e,nr);e.memoizedProps=e.pendingProps,t===null?WP(e):Is=t,kS.current=null}function WP(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=xL(s,t),s!==null){s.flags&=32767,Is=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Os=6,Is=null;return}}else if(s=SL(s,t,nr),s!==null){Is=s;return}if(t=t.sibling,t!==null){Is=t;return}Is=t=e}while(t!==null);Os===0&&(Os=5)}function ja(e,t,s){var i=Yt,r=Ir.transition;try{Ir.transition=null,Yt=1,FL(e,t,s,i)}finally{Ir.transition=r,Yt=i}return null}function FL(e,t,s,i){do Fc();while(Yo!==null);if(Ht&6)throw Error(ke(327));s=e.finishedWork;var r=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var n=s.lanes|s.childLanes;if(uM(e,n),e===zs&&(Is=zs=null,Xs=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||sg||(sg=!0,$P(Qg,function(){return Fc(),null})),n=(s.flags&15990)!==0,s.subtreeFlags&15990||n){n=Ir.transition,Ir.transition=null;var o=Yt;Yt=1;var a=Ht;Ht|=4,kS.current=null,EL(e,s),OP(s,e),QM(gy),Jg=!!py,gy=py=null,e.current=s,RL(s),tM(),Ht=a,Yt=o,Ir.transition=n}else e.current=s;if(sg&&(sg=!1,Yo=e,ff=r),n=e.pendingLanes,n===0&&(sa=null),rM(s.stateNode),Qi(e,Ts()),t!==null)for(i=e.onRecoverableError,s=0;s<t.length;s++)r=t[s],i(r.value,{componentStack:r.stack,digest:r.digest});if(gf)throw gf=!1,e=ky,ky=null,e;return ff&1&&e.tag!==0&&Fc(),n=e.pendingLanes,n&1?e===My?Ld++:(Ld=0,My=e):Ld=0,xa(),null}function Fc(){if(Yo!==null){var e=bD(ff),t=Ir.transition,s=Yt;try{if(Ir.transition=null,Yt=16>e?16:e,Yo===null)var i=!1;else{if(e=Yo,Yo=null,ff=0,Ht&6)throw Error(ke(331));var r=Ht;for(Ht|=4,Je=e.current;Je!==null;){var n=Je,o=n.child;if(Je.flags&16){var a=n.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Je=u;Je!==null;){var h=Je;switch(h.tag){case 0:case 11:case 15:kd(8,h,n)}var p=h.child;if(p!==null)p.return=h,Je=p;else for(;Je!==null;){h=Je;var g=h.sibling,m=h.return;if(kP(h),h===u){Je=null;break}if(g!==null){g.return=m,Je=g;break}Je=m}}}var C=n.alternate;if(C!==null){var y=C.child;if(y!==null){C.child=null;do{var R=y.sibling;y.sibling=null,y=R}while(y!==null)}}Je=n}}if(n.subtreeFlags&2064&&o!==null)o.return=n,Je=o;else e:for(;Je!==null;){if(n=Je,n.flags&2048)switch(n.tag){case 0:case 11:case 15:kd(9,n,n.return)}var x=n.sibling;if(x!==null){x.return=n.return,Je=x;break e}Je=n.return}}var S=e.current;for(Je=S;Je!==null;){o=Je;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,Je=T;else e:for(o=S;Je!==null;){if(a=Je,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:xm(9,a)}}catch(V){Ss(a,a.return,V)}if(a===o){Je=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,Je=I;break e}Je=a.return}}if(Ht=r,xa(),_n&&typeof _n.onPostCommitFiberRoot=="function")try{_n.onPostCommitFiberRoot(gm,e)}catch{}i=!0}return i}finally{Yt=s,Ir.transition=t}}return!1}function aE(e,t,s){t=qc(s,t),t=bP(e,t,1),e=ta(e,t,1),t=bi(),e!==null&&(lp(e,1,t),Qi(e,t))}function Ss(e,t,s){if(e.tag===3)aE(e,e,s);else for(;t!==null;){if(t.tag===3){aE(t,e,s);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(sa===null||!sa.has(i))){e=qc(s,e),e=EP(t,e,1),t=ta(t,e,1),e=bi(),t!==null&&(lp(t,1,e),Qi(t,e));break}}t=t.return}}function NL(e,t,s){var i=e.pingCache;i!==null&&i.delete(t),t=bi(),e.pingedLanes|=e.suspendedLanes&s,zs===e&&(Xs&s)===s&&(Os===4||Os===3&&(Xs&130023424)===Xs&&500>Ts()-LS?dl(e,0):MS|=s),Qi(e,t)}function zP(e,t){t===0&&(e.mode&1?(t=$p,$p<<=1,!($p&130023424)&&($p=4194304)):t=1);var s=bi();e=ao(e,t),e!==null&&(lp(e,t,s),Qi(e,s))}function IL(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),zP(e,s)}function _L(e,t){var s=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(s=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(ke(314))}i!==null&&i.delete(t),zP(e,s)}var UP;UP=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yi.current)Wi=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return Wi=!1,wL(e,t,s);Wi=!!(e.flags&131072)}else Wi=!1,gs&&t.flags&1048576&&qD(t,of,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;bg(e,t),e=t.pendingProps;var r=Uc(t,di.current);Ac(t,s),r=AS(null,t,i,e,r,s);var n=FS();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,qi(i)?(n=!0,rf(t)):n=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,ES(t),r.updater=Sm,t.stateNode=r,r._reactInternals=t,by(t,i,e,s),t=Ty(null,t,i,!0,n,s)):(t.tag=0,gs&&n&&vS(t),Ci(null,t,r,s),t=t.child),t;case 16:i=t.elementType;e:{switch(bg(e,t),e=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=ML(i),e=qr(i,e),r){case 0:t=Ry(null,t,i,e,s);break e;case 1:t=Zb(null,t,i,e,s);break e;case 11:t=qb(null,t,i,e,s);break e;case 14:t=Qb(null,t,i,qr(i.type,e),s);break e}throw Error(ke(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:qr(i,r),Ry(e,t,i,r,s);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:qr(i,r),Zb(e,t,i,r,s);case 3:e:{if(PP(t),e===null)throw Error(ke(387));i=t.pendingProps,n=t.memoizedState,r=n.element,tP(e,t),cf(t,i,null,s);var o=t.memoizedState;if(i=o.element,n.isDehydrated)if(n={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=n,t.memoizedState=n,t.flags&256){r=qc(Error(ke(423)),t),t=Jb(e,t,i,s,r);break e}else if(i!==r){r=qc(Error(ke(424)),t),t=Jb(e,t,i,s,r);break e}else for(dr=ea(t.stateNode.containerInfo.firstChild),hr=t,gs=!0,sn=null,s=XD(t,null,i,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if($c(),i===r){t=lo(e,t,s);break e}Ci(e,t,i,s)}t=t.child}return t;case 5:return sP(t),e===null&&wy(t),i=t.type,r=t.pendingProps,n=e!==null?e.memoizedProps:null,o=r.children,fy(i,r)?o=null:n!==null&&fy(i,n)&&(t.flags|=32),DP(e,t),Ci(e,t,o,s),t.child;case 6:return e===null&&wy(t),null;case 13:return AP(e,t,s);case 4:return RS(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Kc(t,null,i,s):Ci(e,t,i,s),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:qr(i,r),qb(e,t,i,r,s);case 7:return Ci(e,t,t.pendingProps,s),t.child;case 8:return Ci(e,t,t.pendingProps.children,s),t.child;case 12:return Ci(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,n=t.memoizedProps,o=r.value,is(af,i._currentValue),i._currentValue=o,n!==null)if(hn(n.value,o)){if(n.children===r.children&&!Yi.current){t=lo(e,t,s);break e}}else for(n=t.child,n!==null&&(n.return=t);n!==null;){var a=n.dependencies;if(a!==null){o=n.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(n.tag===1){l=io(-1,s&-s),l.tag=2;var u=n.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}n.lanes|=s,l=n.alternate,l!==null&&(l.lanes|=s),Sy(n.return,s,t),a.lanes|=s;break}l=l.next}}else if(n.tag===10)o=n.type===t.type?null:n.child;else if(n.tag===18){if(o=n.return,o===null)throw Error(ke(341));o.lanes|=s,a=o.alternate,a!==null&&(a.lanes|=s),Sy(o,s,t),o=n.sibling}else o=n.child;if(o!==null)o.return=n;else for(o=n;o!==null;){if(o===t){o=null;break}if(n=o.sibling,n!==null){n.return=o.return,o=n;break}o=o.return}n=o}Ci(e,t,r.children,s),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ac(t,s),r=Mr(r),i=i(r),t.flags|=1,Ci(e,t,i,s),t.child;case 14:return i=t.type,r=qr(i,t.pendingProps),r=qr(i.type,r),Qb(e,t,i,r,s);case 15:return RP(e,t,t.type,t.pendingProps,s);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:qr(i,r),bg(e,t),t.tag=1,qi(i)?(e=!0,rf(t)):e=!1,Ac(t,s),xP(t,i,r),by(t,i,r,s),Ty(null,t,i,!0,e,s);case 19:return FP(e,t,s);case 22:return TP(e,t,s)}throw Error(ke(156,t.tag))};function $P(e,t){return yD(e,t)}function kL(e,t,s,i){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ar(e,t,s,i){return new kL(e,t,s,i)}function BS(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ML(e){if(typeof e=="function")return BS(e)?1:0;if(e!=null){if(e=e.$$typeof,e===nS)return 11;if(e===oS)return 14}return 2}function ra(e,t){var s=e.alternate;return s===null?(s=Ar(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Tg(e,t,s,i,r,n){var o=2;if(i=e,typeof e=="function")BS(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case dc:return hl(s.children,r,n,t);case rS:o=8,r|=8;break;case KC:return e=Ar(12,s,t,r|2),e.elementType=KC,e.lanes=n,e;case YC:return e=Ar(13,s,t,r),e.elementType=YC,e.lanes=n,e;case qC:return e=Ar(19,s,t,r),e.elementType=qC,e.lanes=n,e;case sD:return Em(s,r,n,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case eD:o=10;break e;case tD:o=9;break e;case nS:o=11;break e;case oS:o=14;break e;case Lo:o=16,i=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=Ar(o,s,t,r),t.elementType=e,t.type=i,t.lanes=n,t}function hl(e,t,s,i){return e=Ar(7,e,i,t),e.lanes=s,e}function Em(e,t,s,i){return e=Ar(22,e,i,t),e.elementType=sD,e.lanes=s,e.stateNode={isHidden:!1},e}function sC(e,t,s){return e=Ar(6,e,null,t),e.lanes=s,e}function iC(e,t,s){return t=Ar(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function LL(e,t,s,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ov(0),this.expirationTimes=Ov(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ov(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function HS(e,t,s,i,r,n,o,a,l){return e=new LL(e,t,s,a,l),t===1?(t=1,n===!0&&(t|=8)):t=0,n=Ar(3,null,null,t),e.current=n,n.stateNode=e,n.memoizedState={element:i,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},ES(n),e}function OL(e,t,s){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:uc,key:i==null?null:""+i,children:e,containerInfo:t,implementation:s}}function KP(e){if(!e)return da;e=e._reactInternals;e:{if(Bl(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(qi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var s=e.type;if(qi(s))return KD(e,s,t)}return t}function YP(e,t,s,i,r,n,o,a,l){return e=HS(s,i,!0,e,r,n,o,a,l),e.context=KP(null),s=e.current,i=bi(),r=ia(s),n=io(i,r),n.callback=t??null,ta(s,n,r),e.current.lanes=r,lp(e,r,i),Qi(e,i),e}function Rm(e,t,s,i){var r=t.current,n=bi(),o=ia(r);return s=KP(s),t.context===null?t.context=s:t.pendingContext=s,t=io(n,o),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=ta(r,t,o),e!==null&&(cn(e,r,o,n),wg(e,r,o)),o}function vf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function lE(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function jS(e,t){lE(e,t),(e=e.alternate)&&lE(e,t)}function GL(){return null}var qP=typeof reportError=="function"?reportError:function(e){console.error(e)};function WS(e){this._internalRoot=e}Tm.prototype.render=WS.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));Rm(e,t,null,null)};Tm.prototype.unmount=WS.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Rl(function(){Rm(null,e,null,null)}),t[oo]=null}};function Tm(e){this._internalRoot=e}Tm.prototype.unstable_scheduleHydration=function(e){if(e){var t=TD();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Go.length&&t!==0&&t<Go[s].priority;s++);Go.splice(s,0,e),s===0&&PD(e)}};function zS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Dm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cE(){}function VL(e,t,s,i,r){if(r){if(typeof i=="function"){var n=i;i=function(){var u=vf(o);n.call(u)}}var o=YP(t,i,e,0,null,!1,!1,"",cE);return e._reactRootContainer=o,e[oo]=o.current,Zd(e.nodeType===8?e.parentNode:e),Rl(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=vf(l);a.call(u)}}var l=HS(e,0,!1,null,null,!1,!1,"",cE);return e._reactRootContainer=l,e[oo]=l.current,Zd(e.nodeType===8?e.parentNode:e),Rl(function(){Rm(t,l,s,i)}),l}function Pm(e,t,s,i,r){var n=s._reactRootContainer;if(n){var o=n;if(typeof r=="function"){var a=r;r=function(){var l=vf(o);a.call(l)}}Rm(t,o,e,r)}else o=VL(s,t,e,r,i);return vf(o)}ED=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=hd(t.pendingLanes);s!==0&&(cS(t,s|1),Qi(t,Ts()),!(Ht&6)&&(Qc=Ts()+500,xa()))}break;case 13:Rl(function(){var i=ao(e,1);if(i!==null){var r=bi();cn(i,e,1,r)}}),jS(e,1)}};uS=function(e){if(e.tag===13){var t=ao(e,134217728);if(t!==null){var s=bi();cn(t,e,134217728,s)}jS(e,134217728)}};RD=function(e){if(e.tag===13){var t=ia(e),s=ao(e,t);if(s!==null){var i=bi();cn(s,e,t,i)}jS(e,t)}};TD=function(){return Yt};DD=function(e,t){var s=Yt;try{return Yt=e,t()}finally{Yt=s}};ny=function(e,t,s){switch(t){case"input":if(JC(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var i=s[t];if(i!==e&&i.form===e.form){var r=Cm(i);if(!r)throw Error(ke(90));rD(i),JC(i,r)}}}break;case"textarea":oD(e,s);break;case"select":t=s.value,t!=null&&Rc(e,!!s.multiple,t,!1)}};pD=OS;gD=Rl;var BL={usingClientEntryPoint:!1,Events:[up,fc,Cm,dD,hD,OS]},rd={findFiberByHostInstance:Ja,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HL={bundleType:rd.bundleType,version:rd.version,rendererPackageName:rd.rendererPackageName,rendererConfig:rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vD(e),e===null?null:e.stateNode},findFiberByHostInstance:rd.findFiberByHostInstance||GL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ig=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ig.isDisabled&&ig.supportsFiber)try{gm=ig.inject(HL),_n=ig}catch{}}vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BL;vr.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zS(t))throw Error(ke(200));return OL(e,t,null,s)};vr.createRoot=function(e,t){if(!zS(e))throw Error(ke(299));var s=!1,i="",r=qP;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=HS(e,1,!1,null,null,s,!1,i,r),e[oo]=t.current,Zd(e.nodeType===8?e.parentNode:e),new WS(t)};vr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=vD(t),e=e===null?null:e.stateNode,e};vr.flushSync=function(e){return Rl(e)};vr.hydrate=function(e,t,s){if(!Dm(t))throw Error(ke(200));return Pm(null,e,t,!0,s)};vr.hydrateRoot=function(e,t,s){if(!zS(e))throw Error(ke(405));var i=s!=null&&s.hydratedSources||null,r=!1,n="",o=qP;if(s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(n=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),t=YP(t,null,e,1,s??null,r,!1,n,o),e[oo]=t.current,Zd(e),i)for(e=0;e<i.length;e++)s=i[e],r=s._getVersion,r=r(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,r]:t.mutableSourceEagerHydrationData.push(s,r);return new Tm(t)};vr.render=function(e,t,s){if(!Dm(t))throw Error(ke(200));return Pm(null,e,t,!1,s)};vr.unmountComponentAtNode=function(e){if(!Dm(e))throw Error(ke(40));return e._reactRootContainer?(Rl(function(){Pm(null,null,e,!1,function(){e._reactRootContainer=null,e[oo]=null})}),!0):!1};vr.unstable_batchedUpdates=OS;vr.unstable_renderSubtreeIntoContainer=function(e,t,s,i){if(!Dm(s))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return Pm(e,t,s,!1,i)};vr.version="18.3.1-next-f1338f8080-20240426";function QP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(QP)}catch(e){console.error(e)}}QP(),QT.exports=vr;var Am=QT.exports;const Gy=hm(Am);var uE=Am;UC.createRoot=uE.createRoot,UC.hydrateRoot=uE.hydrateRoot;var Fm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},jL={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Ho,Qw,FT,WL=(FT=class{constructor(){kt(this,Ho,jL);kt(this,Qw,!1)}setTimeoutProvider(e){ft(this,Ho,e)}setTimeout(e,t){return Ce(this,Ho).setTimeout(e,t)}clearTimeout(e){Ce(this,Ho).clearTimeout(e)}setInterval(e,t){return Ce(this,Ho).setInterval(e,t)}clearInterval(e){Ce(this,Ho).clearInterval(e)}},Ho=new WeakMap,Qw=new WeakMap,FT),Vy=new WL;function zL(e){setTimeout(e,0)}var Nm=typeof window>"u"||"Deno"in globalThis;function Qr(){}function UL(e,t){return typeof e=="function"?e(t):e}function $L(e){return typeof e=="number"&&e>=0&&e!==1/0}function KL(e,t){return Math.max(e+(t||0)-Date.now(),0)}function By(e,t){return typeof e=="function"?e(t):e}function YL(e,t){return typeof e=="function"?e(t):e}function dE(e,t){const{type:s="all",exact:i,fetchStatus:r,predicate:n,queryKey:o,stale:a}=e;if(o){if(i){if(t.queryHash!==US(o,t.options))return!1}else if(!ah(t.queryKey,o))return!1}if(s!=="all"){const l=t.isActive();if(s==="active"&&!l||s==="inactive"&&l)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||r&&r!==t.state.fetchStatus||n&&!n(t))}function hE(e,t){const{exact:s,status:i,predicate:r,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(s){if(oh(t.options.mutationKey)!==oh(n))return!1}else if(!ah(t.options.mutationKey,n))return!1}return!(i&&t.state.status!==i||r&&!r(t))}function US(e,t){return((t==null?void 0:t.queryKeyHashFn)||oh)(e)}function oh(e){return JSON.stringify(e,(t,s)=>Hy(s)?Object.keys(s).sort().reduce((i,r)=>(i[r]=s[r],i),{}):s)}function ah(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(s=>ah(e[s],t[s])):!1}var qL=Object.prototype.hasOwnProperty;function ZP(e,t,s=0){if(e===t)return e;if(s>500)return t;const i=pE(e)&&pE(t);if(!i&&!(Hy(e)&&Hy(t)))return t;const n=(i?e:Object.keys(e)).length,o=i?t:Object.keys(t),a=o.length,l=i?new Array(a):{};let u=0;for(let h=0;h<a;h++){const p=i?h:o[h],g=e[p],m=t[p];if(g===m){l[p]=g,(i?h<n:qL.call(e,p))&&u++;continue}if(g===null||m===null||typeof g!="object"||typeof m!="object"){l[p]=m;continue}const C=ZP(g,m,s+1);l[p]=C,C===g&&u++}return n===a&&u===n?e:l}function pE(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Hy(e){if(!gE(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!gE(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function gE(e){return Object.prototype.toString.call(e)==="[object Object]"}function QL(e){return new Promise(t=>{Vy.setTimeout(t,e)})}function ZL(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?ZP(e,t):t}function JL(e,t,s=0){const i=[...e,t];return s&&i.length>s?i.slice(1):i}function XL(e,t,s=0){const i=[t,...e];return s&&i.length>s?i.slice(0,-1):i}var $S=Symbol();function JP(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===$S?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function e1(e,t,s){let i=!1,r;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(r??(r=t()),i||(i=!0,r.aborted?s():r.addEventListener("abort",s,{once:!0})),r)}),e}var nl,jo,Lc,NT,t1=(NT=class extends Fm{constructor(){super();kt(this,nl);kt(this,jo);kt(this,Lc);ft(this,Lc,t=>{if(!Nm&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){Ce(this,jo)||this.setEventListener(Ce(this,Lc))}onUnsubscribe(){var t;this.hasListeners()||((t=Ce(this,jo))==null||t.call(this),ft(this,jo,void 0))}setEventListener(t){var s;ft(this,Lc,t),(s=Ce(this,jo))==null||s.call(this),ft(this,jo,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){Ce(this,nl)!==t&&(ft(this,nl,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof Ce(this,nl)=="boolean"?Ce(this,nl):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},nl=new WeakMap,jo=new WeakMap,Lc=new WeakMap,NT),XP=new t1;function s1(){let e,t;const s=new Promise((r,n)=>{e=r,t=n});s.status="pending",s.catch(()=>{});function i(r){Object.assign(s,r),delete s.resolve,delete s.reject}return s.resolve=r=>{i({status:"fulfilled",value:r}),e(r)},s.reject=r=>{i({status:"rejected",reason:r}),t(r)},s}var i1=zL;function r1(){let e=[],t=0,s=a=>{a()},i=a=>{a()},r=i1;const n=a=>{t?e.push(a):r(()=>{s(a)})},o=()=>{const a=e;e=[],a.length&&r(()=>{i(()=>{a.forEach(l=>{s(l)})})})};return{batch:a=>{let l;t++;try{l=a()}finally{t--,t||o()}return l},batchCalls:a=>(...l)=>{n(()=>{a(...l)})},schedule:n,setNotifyFunction:a=>{s=a},setBatchNotifyFunction:a=>{i=a},setScheduler:a=>{r=a}}}var wi=r1(),Oc,Wo,Gc,IT,n1=(IT=class extends Fm{constructor(){super();kt(this,Oc,!0);kt(this,Wo);kt(this,Gc);ft(this,Gc,t=>{if(!Nm&&window.addEventListener){const s=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",i)}}})}onSubscribe(){Ce(this,Wo)||this.setEventListener(Ce(this,Gc))}onUnsubscribe(){var t;this.hasListeners()||((t=Ce(this,Wo))==null||t.call(this),ft(this,Wo,void 0))}setEventListener(t){var s;ft(this,Gc,t),(s=Ce(this,Wo))==null||s.call(this),ft(this,Wo,t(this.setOnline.bind(this)))}setOnline(t){Ce(this,Oc)!==t&&(ft(this,Oc,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return Ce(this,Oc)}},Oc=new WeakMap,Wo=new WeakMap,Gc=new WeakMap,IT),Cf=new n1;function o1(e){return Math.min(1e3*2**e,3e4)}function eA(e){return(e??"online")==="online"?Cf.isOnline():!0}var jy=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function tA(e){let t=!1,s=0,i;const r=s1(),n=()=>r.status!=="pending",o=y=>{var R;if(!n()){const x=new jy(y);g(x),(R=e.onCancel)==null||R.call(e,x)}},a=()=>{t=!0},l=()=>{t=!1},u=()=>XP.isFocused()&&(e.networkMode==="always"||Cf.isOnline())&&e.canRun(),h=()=>eA(e.networkMode)&&e.canRun(),p=y=>{n()||(i==null||i(),r.resolve(y))},g=y=>{n()||(i==null||i(),r.reject(y))},m=()=>new Promise(y=>{var R;i=x=>{(n()||u())&&y(x)},(R=e.onPause)==null||R.call(e)}).then(()=>{var y;i=void 0,n()||(y=e.onContinue)==null||y.call(e)}),C=()=>{if(n())return;let y;const R=s===0?e.initialPromise:void 0;try{y=R??e.fn()}catch(x){y=Promise.reject(x)}Promise.resolve(y).then(p).catch(x=>{var j;if(n())return;const S=e.retry??(Nm?0:3),T=e.retryDelay??o1,I=typeof T=="function"?T(s,x):T,V=S===!0||typeof S=="number"&&s<S||typeof S=="function"&&S(s,x);if(t||!V){g(x);return}s++,(j=e.onFail)==null||j.call(e,s,x),QL(I).then(()=>u()?void 0:m()).then(()=>{t?g(x):C()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(i==null||i(),r),cancelRetry:a,continueRetry:l,canStart:h,start:()=>(h()?C():m().then(C),r)}}var ol,_T,sA=(_T=class{constructor(){kt(this,ol)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),$L(this.gcTime)&&ft(this,ol,Vy.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Nm?1/0:5*60*1e3))}clearGcTimeout(){Ce(this,ol)&&(Vy.clearTimeout(Ce(this,ol)),ft(this,ol,void 0))}},ol=new WeakMap,_T),al,Vc,Rr,ll,Hs,rp,cl,Zr,Yn,kT,a1=(kT=class extends sA{constructor(t){super();kt(this,Zr);kt(this,al);kt(this,Vc);kt(this,Rr);kt(this,ll);kt(this,Hs);kt(this,rp);kt(this,cl);ft(this,cl,!1),ft(this,rp,t.defaultOptions),this.setOptions(t.options),this.observers=[],ft(this,ll,t.client),ft(this,Rr,Ce(this,ll).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ft(this,al,mE(this.options)),this.state=t.state??Ce(this,al),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Ce(this,Hs))==null?void 0:t.promise}setOptions(t){if(this.options={...Ce(this,rp),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=mE(this.options);s.data!==void 0&&(this.setState(fE(s.data,s.dataUpdatedAt)),ft(this,al,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Ce(this,Rr).remove(this)}setData(t,s){const i=ZL(this.state.data,t,this.options);return oi(this,Zr,Yn).call(this,{data:i,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),i}setState(t,s){oi(this,Zr,Yn).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var i,r;const s=(i=Ce(this,Hs))==null?void 0:i.promise;return(r=Ce(this,Hs))==null||r.cancel(t),s?s.then(Qr).catch(Qr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ce(this,al))}isActive(){return this.observers.some(t=>YL(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===$S||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>By(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!KL(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=Ce(this,Hs))==null||s.continue()}onOnline(){var s;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=Ce(this,Hs))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Ce(this,Rr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(Ce(this,Hs)&&(Ce(this,cl)?Ce(this,Hs).cancel({revert:!0}):Ce(this,Hs).cancelRetry()),this.scheduleGc()),Ce(this,Rr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||oi(this,Zr,Yn).call(this,{type:"invalidate"})}async fetch(t,s){var l,u,h,p,g,m,C,y,R,x,S,T;if(this.state.fetchStatus!=="idle"&&((l=Ce(this,Hs))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(Ce(this,Hs))return Ce(this,Hs).continueRetry(),Ce(this,Hs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const I=this.observers.find(V=>V.options.queryFn);I&&this.setOptions(I.options)}const i=new AbortController,r=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(ft(this,cl,!0),i.signal)})},n=()=>{const I=JP(this.options,s),j=(()=>{const P={client:Ce(this,ll),queryKey:this.queryKey,meta:this.meta};return r(P),P})();return ft(this,cl,!1),this.options.persister?this.options.persister(I,j,this):I(j)},a=(()=>{const I={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:Ce(this,ll),state:this.state,fetchFn:n};return r(I),I})();(u=this.options.behavior)==null||u.onFetch(a,this),ft(this,Vc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=a.fetchOptions)==null?void 0:h.meta))&&oi(this,Zr,Yn).call(this,{type:"fetch",meta:(p=a.fetchOptions)==null?void 0:p.meta}),ft(this,Hs,tA({initialPromise:s==null?void 0:s.initialPromise,fn:a.fetchFn,onCancel:I=>{I instanceof jy&&I.revert&&this.setState({...Ce(this,Vc),fetchStatus:"idle"}),i.abort()},onFail:(I,V)=>{oi(this,Zr,Yn).call(this,{type:"failed",failureCount:I,error:V})},onPause:()=>{oi(this,Zr,Yn).call(this,{type:"pause"})},onContinue:()=>{oi(this,Zr,Yn).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const I=await Ce(this,Hs).start();if(I===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(I),(m=(g=Ce(this,Rr).config).onSuccess)==null||m.call(g,I,this),(y=(C=Ce(this,Rr).config).onSettled)==null||y.call(C,I,this.state.error,this),I}catch(I){if(I instanceof jy){if(I.silent)return Ce(this,Hs).promise;if(I.revert){if(this.state.data===void 0)throw I;return this.state.data}}throw oi(this,Zr,Yn).call(this,{type:"error",error:I}),(x=(R=Ce(this,Rr).config).onError)==null||x.call(R,I,this),(T=(S=Ce(this,Rr).config).onSettled)==null||T.call(S,this.state.data,I,this),I}finally{this.scheduleGc()}}},al=new WeakMap,Vc=new WeakMap,Rr=new WeakMap,ll=new WeakMap,Hs=new WeakMap,rp=new WeakMap,cl=new WeakMap,Zr=new WeakSet,Yn=function(t){const s=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...l1(i.data,this.options),fetchMeta:t.meta??null};case"success":const r={...i,...fE(t.data,t.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ft(this,Vc,t.manual?r:void 0),r;case"error":const n=t.error;return{...i,error:n,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=s(this.state),wi.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),Ce(this,Rr).notify({query:this,type:"updated",action:t})})},kT);function l1(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:eA(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function fE(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function mE(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,i=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}function vE(e){return{onFetch:(t,s)=>{var h,p,g,m,C;const i=t.options,r=(g=(p=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:p.fetchMore)==null?void 0:g.direction,n=((m=t.state.data)==null?void 0:m.pages)||[],o=((C=t.state.data)==null?void 0:C.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const u=async()=>{let y=!1;const R=T=>{e1(T,()=>t.signal,()=>y=!0)},x=JP(t.options,t.fetchOptions),S=async(T,I,V)=>{if(y)return Promise.reject();if(I==null&&T.pages.length)return Promise.resolve(T);const P=(()=>{const M={client:t.client,queryKey:t.queryKey,pageParam:I,direction:V?"backward":"forward",meta:t.options.meta};return R(M),M})(),N=await x(P),{maxPages:_}=t.options,L=V?XL:JL;return{pages:L(T.pages,N,_),pageParams:L(T.pageParams,I,_)}};if(r&&n.length){const T=r==="backward",I=T?c1:CE,V={pages:n,pageParams:o},j=I(i,V);a=await S(V,j,T)}else{const T=e??n.length;do{const I=l===0?o[0]??i.initialPageParam:CE(i,a);if(l>0&&I==null)break;a=await S(a,I),l++}while(l<T)}return a};t.options.persister?t.fetchFn=()=>{var y,R;return(R=(y=t.options).persister)==null?void 0:R.call(y,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=u}}}function CE(e,{pages:t,pageParams:s}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,s[i],s):void 0}function c1(e,{pages:t,pageParams:s}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,s[0],s):void 0}var np,Tn,vi,ul,Dn,Io,MT,u1=(MT=class extends sA{constructor(t){super();kt(this,Dn);kt(this,np);kt(this,Tn);kt(this,vi);kt(this,ul);ft(this,np,t.client),this.mutationId=t.mutationId,ft(this,vi,t.mutationCache),ft(this,Tn,[]),this.state=t.state||d1(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Ce(this,Tn).includes(t)||(Ce(this,Tn).push(t),this.clearGcTimeout(),Ce(this,vi).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ft(this,Tn,Ce(this,Tn).filter(s=>s!==t)),this.scheduleGc(),Ce(this,vi).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Ce(this,Tn).length||(this.state.status==="pending"?this.scheduleGc():Ce(this,vi).remove(this))}continue(){var t;return((t=Ce(this,ul))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,a,l,u,h,p,g,m,C,y,R,x,S,T,I,V,j,P,N,_;const s=()=>{oi(this,Dn,Io).call(this,{type:"continue"})},i={client:Ce(this,np),meta:this.options.meta,mutationKey:this.options.mutationKey};ft(this,ul,tA({fn:()=>this.options.mutationFn?this.options.mutationFn(t,i):Promise.reject(new Error("No mutationFn found")),onFail:(L,M)=>{oi(this,Dn,Io).call(this,{type:"failed",failureCount:L,error:M})},onPause:()=>{oi(this,Dn,Io).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ce(this,vi).canRun(this)}));const r=this.state.status==="pending",n=!Ce(this,ul).canStart();try{if(r)s();else{oi(this,Dn,Io).call(this,{type:"pending",variables:t,isPaused:n}),await((a=(o=Ce(this,vi).config).onMutate)==null?void 0:a.call(o,t,this,i));const M=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,t,i));M!==this.state.context&&oi(this,Dn,Io).call(this,{type:"pending",context:M,variables:t,isPaused:n})}const L=await Ce(this,ul).start();return await((p=(h=Ce(this,vi).config).onSuccess)==null?void 0:p.call(h,L,t,this.state.context,this,i)),await((m=(g=this.options).onSuccess)==null?void 0:m.call(g,L,t,this.state.context,i)),await((y=(C=Ce(this,vi).config).onSettled)==null?void 0:y.call(C,L,null,this.state.variables,this.state.context,this,i)),await((x=(R=this.options).onSettled)==null?void 0:x.call(R,L,null,t,this.state.context,i)),oi(this,Dn,Io).call(this,{type:"success",data:L}),L}catch(L){try{await((T=(S=Ce(this,vi).config).onError)==null?void 0:T.call(S,L,t,this.state.context,this,i))}catch(M){Promise.reject(M)}try{await((V=(I=this.options).onError)==null?void 0:V.call(I,L,t,this.state.context,i))}catch(M){Promise.reject(M)}try{await((P=(j=Ce(this,vi).config).onSettled)==null?void 0:P.call(j,void 0,L,this.state.variables,this.state.context,this,i))}catch(M){Promise.reject(M)}try{await((_=(N=this.options).onSettled)==null?void 0:_.call(N,void 0,L,t,this.state.context,i))}catch(M){Promise.reject(M)}throw oi(this,Dn,Io).call(this,{type:"error",error:L}),L}finally{Ce(this,vi).runNext(this)}}},np=new WeakMap,Tn=new WeakMap,vi=new WeakMap,ul=new WeakMap,Dn=new WeakSet,Io=function(t){const s=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),wi.batch(()=>{Ce(this,Tn).forEach(i=>{i.onMutationUpdate(t)}),Ce(this,vi).notify({mutation:this,type:"updated",action:t})})},MT);function d1(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var eo,Jr,op,LT,h1=(LT=class extends Fm{constructor(t={}){super();kt(this,eo);kt(this,Jr);kt(this,op);this.config=t,ft(this,eo,new Set),ft(this,Jr,new Map),ft(this,op,0)}build(t,s,i){const r=new u1({client:t,mutationCache:this,mutationId:++Bp(this,op)._,options:t.defaultMutationOptions(s),state:i});return this.add(r),r}add(t){Ce(this,eo).add(t);const s=rg(t);if(typeof s=="string"){const i=Ce(this,Jr).get(s);i?i.push(t):Ce(this,Jr).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Ce(this,eo).delete(t)){const s=rg(t);if(typeof s=="string"){const i=Ce(this,Jr).get(s);if(i)if(i.length>1){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}else i[0]===t&&Ce(this,Jr).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=rg(t);if(typeof s=="string"){const i=Ce(this,Jr).get(s),r=i==null?void 0:i.find(n=>n.state.status==="pending");return!r||r===t}else return!0}runNext(t){var i;const s=rg(t);if(typeof s=="string"){const r=(i=Ce(this,Jr).get(s))==null?void 0:i.find(n=>n!==t&&n.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){wi.batch(()=>{Ce(this,eo).forEach(t=>{this.notify({type:"removed",mutation:t})}),Ce(this,eo).clear(),Ce(this,Jr).clear()})}getAll(){return Array.from(Ce(this,eo))}find(t){const s={exact:!0,...t};return this.getAll().find(i=>hE(s,i))}findAll(t={}){return this.getAll().filter(s=>hE(t,s))}notify(t){wi.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return wi.batch(()=>Promise.all(t.map(s=>s.continue().catch(Qr))))}},eo=new WeakMap,Jr=new WeakMap,op=new WeakMap,LT);function rg(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Pn,OT,p1=(OT=class extends Fm{constructor(t={}){super();kt(this,Pn);this.config=t,ft(this,Pn,new Map)}build(t,s,i){const r=s.queryKey,n=s.queryHash??US(r,s);let o=this.get(n);return o||(o=new a1({client:t,queryKey:r,queryHash:n,options:t.defaultQueryOptions(s),state:i,defaultOptions:t.getQueryDefaults(r)}),this.add(o)),o}add(t){Ce(this,Pn).has(t.queryHash)||(Ce(this,Pn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=Ce(this,Pn).get(t.queryHash);s&&(t.destroy(),s===t&&Ce(this,Pn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){wi.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Ce(this,Pn).get(t)}getAll(){return[...Ce(this,Pn).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(i=>dE(s,i))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(i=>dE(t,i)):s}notify(t){wi.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){wi.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){wi.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Pn=new WeakMap,OT),ws,zo,Uo,Bc,Hc,$o,jc,Wc,GT,g1=(GT=class{constructor(e={}){kt(this,ws);kt(this,zo);kt(this,Uo);kt(this,Bc);kt(this,Hc);kt(this,$o);kt(this,jc);kt(this,Wc);ft(this,ws,e.queryCache||new p1),ft(this,zo,e.mutationCache||new h1),ft(this,Uo,e.defaultOptions||{}),ft(this,Bc,new Map),ft(this,Hc,new Map),ft(this,$o,0)}mount(){Bp(this,$o)._++,Ce(this,$o)===1&&(ft(this,jc,XP.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ce(this,ws).onFocus())})),ft(this,Wc,Cf.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ce(this,ws).onOnline())})))}unmount(){var e,t;Bp(this,$o)._--,Ce(this,$o)===0&&((e=Ce(this,jc))==null||e.call(this),ft(this,jc,void 0),(t=Ce(this,Wc))==null||t.call(this),ft(this,Wc,void 0))}isFetching(e){return Ce(this,ws).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ce(this,zo).findAll({...e,status:"pending"}).length}getQueryData(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=Ce(this,ws).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=Ce(this,ws).build(this,t),i=s.state.data;return i===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(By(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return Ce(this,ws).findAll(e).map(({queryKey:t,state:s})=>{const i=s.data;return[t,i]})}setQueryData(e,t,s){const i=this.defaultQueryOptions({queryKey:e}),r=Ce(this,ws).get(i.queryHash),n=r==null?void 0:r.state.data,o=UL(t,n);if(o!==void 0)return Ce(this,ws).build(this,i).setData(o,{...s,manual:!0})}setQueriesData(e,t,s){return wi.batch(()=>Ce(this,ws).findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,t,s)]))}getQueryState(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=Ce(this,ws).get(t.queryHash))==null?void 0:s.state}removeQueries(e){const t=Ce(this,ws);wi.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=Ce(this,ws);return wi.batch(()=>(s.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},i=wi.batch(()=>Ce(this,ws).findAll(e).map(r=>r.cancel(s)));return Promise.all(i).then(Qr).catch(Qr)}invalidateQueries(e,t={}){return wi.batch(()=>(Ce(this,ws).findAll(e).forEach(s=>{s.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},i=wi.batch(()=>Ce(this,ws).findAll(e).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let n=r.fetch(void 0,s);return s.throwOnError||(n=n.catch(Qr)),r.state.fetchStatus==="paused"?Promise.resolve():n}));return Promise.all(i).then(Qr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=Ce(this,ws).build(this,t);return s.isStaleByTime(By(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Qr).catch(Qr)}fetchInfiniteQuery(e){return e.behavior=vE(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Qr).catch(Qr)}ensureInfiniteQueryData(e){return e.behavior=vE(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Cf.isOnline()?Ce(this,zo).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ce(this,ws)}getMutationCache(){return Ce(this,zo)}getDefaultOptions(){return Ce(this,Uo)}setDefaultOptions(e){ft(this,Uo,e)}setQueryDefaults(e,t){Ce(this,Bc).set(oh(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Ce(this,Bc).values()],s={};return t.forEach(i=>{ah(e,i.queryKey)&&Object.assign(s,i.defaultOptions)}),s}setMutationDefaults(e,t){Ce(this,Hc).set(oh(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Ce(this,Hc).values()],s={};return t.forEach(i=>{ah(e,i.mutationKey)&&Object.assign(s,i.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Ce(this,Uo).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=US(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===$S&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Ce(this,Uo).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ce(this,ws).clear(),Ce(this,zo).clear()}},ws=new WeakMap,zo=new WeakMap,Uo=new WeakMap,Bc=new WeakMap,Hc=new WeakMap,$o=new WeakMap,jc=new WeakMap,Wc=new WeakMap,GT),f1=b.createContext(void 0),m1=({client:e,children:t})=>(b.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(f1.Provider,{value:e,children:t})),KS=Object.defineProperty,v1=Object.defineProperties,C1=Object.getOwnPropertyDescriptor,y1=Object.getOwnPropertyDescriptors,yf=Object.getOwnPropertySymbols,iA=Object.prototype.hasOwnProperty,rA=Object.prototype.propertyIsEnumerable,yE=(e,t,s)=>t in e?KS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Xe=(e,t)=>{for(var s in t||(t={}))iA.call(t,s)&&yE(e,s,t[s]);if(yf)for(var s of yf(t))rA.call(t,s)&&yE(e,s,t[s]);return e},rs=(e,t)=>v1(e,y1(t)),w1=(e,t)=>{var s={};for(var i in e)iA.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&yf)for(var i of yf(e))t.indexOf(i)<0&&rA.call(e,i)&&(s[i]=e[i]);return s},$s=(e,t)=>{for(var s in t)KS(e,s,{get:t[s],enumerable:!0})},f=(e,t,s,i)=>{for(var r=i>1?void 0:i?C1(t,s):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(i?o(t,s,r):o(r))||r);return i&&r&&KS(t,s,r),r},rn=(e,t)=>(s,i)=>t(s,i,e),nA={};$s(nA,{attrToBoolean:()=>wf,attrToNumber:()=>na,attrToString:()=>S1,defaultComparator:()=>x1,exists:()=>ve,jsonEquals:()=>Wy,makeNull:()=>Mn,missing:()=>ot,missingOrEmpty:()=>Pr,toStringOrNull:()=>lh,values:()=>pl});function Mn(e){return e==null||e===""?null:e}function ve(e,t=!1){return e!=null&&(e!==""||t)}function ot(e){return!ve(e)}function Pr(e){return e==null||e.length===0}function lh(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function na(e){if(e===void 0)return;if(e===null||e==="")return null;if(typeof e=="number")return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function wf(e){if(e!==void 0)return e===null||e===""?!1:typeof e=="boolean"?e:/true/i.test(e)}function S1(e){if(!(e==null||e===""))return e}function Wy(e,t){const s=e?JSON.stringify(e):null,i=t?JSON.stringify(t):null;return s===i}function x1(e,t,s=!1){const i=e==null,r=t==null;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),i&&r)return 0;if(i)return-1;if(r)return 1;function n(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!s)return n(e,t);try{return e.localeCompare(t)}catch{return n(e,t)}}function pl(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach(s=>t.push(s)),t}return Object.values(e)}var b1=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=lh(e);let s=0;for(;;){let i;if(e?(i=e,s!==0&&(i+="_"+s)):t?(i=t,s!==0&&(i+="_"+s)):i=s,!this.existingKeys[i])return this.existingKeys[i]=!0,String(i);s++}}},oA={};$s(oA,{SKIP_JS_BUILTINS:()=>Im,cloneObject:()=>YS,deepCloneDefinition:()=>Sf,getAllValuesInObject:()=>ha,getValueUsingField:()=>Nc,isNonNullObject:()=>xf,iterateObject:()=>ui,mergeDeep:()=>zi,removeAllReferences:()=>aA});var Im=new Set(["__proto__","constructor","prototype"]);function ui(e,t){if(e!=null){if(Array.isArray(e)){for(let s=0;s<e.length;s++)t(s.toString(),e[s]);return}for(const[s,i]of Object.entries(e))t(s,i)}}function YS(e){const t={},s=Object.keys(e);for(let i=0;i<s.length;i++){if(Im.has(s[i]))continue;const r=s[i],n=e[r];t[r]=n}return t}function Sf(e,t){if(!e)return;const s=e,i={};return Object.keys(s).forEach(r=>{if(t&&t.indexOf(r)>=0||Im.has(r))return;const n=s[r];xf(n)&&n.constructor===Object?i[r]=Sf(n):i[r]=n}),i}function ha(e){if(!e)return[];const t=Object;if(typeof t.values=="function")return t.values(e);const s=[];for(const i in e)e.hasOwnProperty(i)&&e.propertyIsEnumerable(i)&&s.push(e[i]);return s}function zi(e,t,s=!0,i=!1){ve(t)&&ui(t,(r,n)=>{if(Im.has(r))return;let o=e[r];o!==n&&(i&&o==null&&n!=null&&typeof n=="object"&&n.constructor===Object&&(o={},e[r]=o),xf(n)&&xf(o)&&!Array.isArray(o)?zi(o,n,s,i):(s||n!==void 0)&&(e[r]=n))})}function Nc(e,t,s){if(!t||!e)return;if(!s)return e[t];const i=t.split(".");let r=e;for(let n=0;n<i.length;n++){if(r==null)return;r=r[i[n]]}return r}function aA(e,t=[],s){Object.keys(e).forEach(o=>{typeof e[o]=="object"&&!t.includes(o)&&(e[o]=void 0)});const i=Object.getPrototypeOf(e),r={},n=o=>`AG Grid: Grid API function ${o}() cannot be called as the grid has been destroyed.
    It is recommended to remove local references to the grid api. Alternatively, check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
    To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${s}`;Object.getOwnPropertyNames(i).forEach(o=>{if(typeof i[o]=="function"&&!t.includes(o)){const l=()=>{console.warn(n(o))};r[o]={value:l,writable:!0}}}),Object.defineProperties(e,r)}function xf(e){return typeof e=="object"&&e!==null}var lA={};$s(lA,{compose:()=>E1,debounce:()=>xi,doOnce:()=>Zc,errorOnce:()=>tl,executeAfter:()=>uA,executeInAWhile:()=>cA,executeNextVMTurn:()=>zy,getFunctionName:()=>_m,isFunction:()=>km,noop:()=>R1,throttle:()=>Uy,waitUntil:()=>qS,warnOnce:()=>tt});var wE={};function Zc(e,t){wE[t]||(e(),wE[t]=!0)}function tt(e){Zc(()=>console.warn("AG Grid: "+e),e)}function tl(e){Zc(()=>console.error("AG Grid: "+e),e)}function _m(e){if(e.name)return e.name;const t=/function\s+([^\(]+)/.exec(e.toString());return t&&t.length===2?t[1].trim():null}function km(e){return!!(e&&e.constructor&&e.call&&e.apply)}function cA(e){uA(e,400)}var rC=[],nC=!1;function zy(e){rC.push(e),!nC&&(nC=!0,window.setTimeout(()=>{const t=rC.slice();rC.length=0,nC=!1,t.forEach(s=>s())},0))}function uA(e,t=0){e.length>0&&window.setTimeout(()=>e.forEach(s=>s()),t)}function xi(e,t){let s;return function(...i){const r=this;window.clearTimeout(s),s=window.setTimeout(function(){e.apply(r,i)},t)}}function Uy(e,t){let s=0;return function(...i){const r=this,n=new Date().getTime();n-s<t||(s=n,e.apply(r,i))}}function qS(e,t,s=100,i){const r=new Date().getTime();let n=null,o=!1;const a=()=>{const l=new Date().getTime()-r>s;(e()||l)&&(t(),o=!0,n!=null&&(window.clearInterval(n),n=null),l&&i&&console.warn(i))};a(),o||(n=window.setInterval(a,10))}function E1(...e){return t=>e.reduce((s,i)=>i(s),t)}var R1=()=>{},dA=(e=>(e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue",e))(dA||{}),Mm=class Ut{static register(t){Ut.__register(t,!0,void 0)}static registerModules(t){Ut.__registerModules(t,!0,void 0)}static __register(t,s,i){Ut.runVersionChecks(t),i!==void 0?(Ut.areGridScopedModules=!0,Ut.gridModulesMap[i]===void 0&&(Ut.gridModulesMap[i]={}),Ut.gridModulesMap[i][t.moduleName]=t):Ut.globalModulesMap[t.moduleName]=t,Ut.setModuleBased(s)}static __unRegisterGridModules(t){delete Ut.gridModulesMap[t]}static __registerModules(t,s,i){Ut.setModuleBased(s),t&&t.forEach(r=>Ut.__register(r,s,i))}static isValidModuleVersion(t){const[s,i]=t.version.split(".")||[],[r,n]=Ut.currentModuleVersion.split(".")||[];return s===r&&i===n}static runVersionChecks(t){if(Ut.currentModuleVersion||(Ut.currentModuleVersion=t.version),t.version?Ut.isValidModuleVersion(t)||console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is version ${t.version} but the other modules are version ${this.currentModuleVersion}. Please update all modules to the same version.`):console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is incompatible. Please update all modules to the same version.`),t.validate){const s=t.validate();s.isValid||console.error(`AG Grid: ${s.message}`)}}static setModuleBased(t){Ut.moduleBased===void 0?Ut.moduleBased=t:Ut.moduleBased!==t&&Zc(()=>{console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information.")},"ModulePackageCheck")}static __setIsBundled(){Ut.isBundled=!0}static __assertRegistered(t,s,i){var r;if(this.__isRegistered(t,i))return!0;const n=s+t;let o;if(Ut.isBundled)o=`AG Grid: unable to use ${s} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:
        
        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>
        
For more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(Ut.moduleBased||Ut.moduleBased===void 0){let a=(r=Object.entries(dA).find(([l,u])=>u===t))==null?void 0:r[0];o=`AG Grid: unable to use ${s} as the ${a} is not registered${Ut.areGridScopedModules?` for gridId: ${i}`:""}. Check if you have registered the module:
           
    import { ModuleRegistry } from '@ag-grid-community/core';
    import { ${a} } from '${t}';
    
    ModuleRegistry.registerModules([ ${a} ]);

For more info see: https://www.ag-grid.com/javascript-grid/modules/`}else o=`AG Grid: unable to use ${s} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:
            
    import 'ag-grid-enterprise';`;return Zc(()=>{console.warn(o)},n),!1}static __isRegistered(t,s){var i;return!!Ut.globalModulesMap[t]||!!((i=Ut.gridModulesMap[s])!=null&&i[t])}static __getRegisteredModules(t){return[...pl(Ut.globalModulesMap),...pl(Ut.gridModulesMap[t]||{})]}static __getGridRegisteredModules(t){var s;return pl((s=Ut.gridModulesMap[t])!=null?s:{})||[]}static __isPackageBased(){return!Ut.moduleBased}};Mm.globalModulesMap={};Mm.gridModulesMap={};Mm.areGridScopedModules=!1;var Vt=Mm,T1=class{constructor(e,t){if(this.beanWrappers={},this.destroyed=!1,!e||!e.beanClasses)return;this.contextParams=e,this.logger=t,this.logger.log(">> creating ag-Application Context"),this.createBeans();const s=this.getBeanInstances();this.wireBeans(s),this.logger.log(">> ag-Application Context ready - component is alive")}getBeanInstances(){return pl(this.beanWrappers).map(e=>e.beanInstance)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.wireBeans([e],t),e}wireBeans(e,t){this.autoWireBeans(e),this.methodWireBeans(e),this.callLifeCycleMethods(e,"preConstructMethods"),ve(t)&&e.forEach(t),this.callLifeCycleMethods(e,"postConstructMethods")}createBeans(){this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),ui(this.beanWrappers,(t,s)=>{let i;s.bean.__agBeanMetaData&&s.bean.__agBeanMetaData.autowireMethods&&s.bean.__agBeanMetaData.autowireMethods.agConstructor&&(i=s.bean.__agBeanMetaData.autowireMethods.agConstructor);const r=this.getBeansForParameters(i,s.bean.name),n=new(s.bean.bind.apply(s.bean,[null,...r]));s.beanInstance=n});const e=Object.keys(this.beanWrappers).join(", ");this.logger.log(`created beans: ${e}`)}createBeanWrapper(e){const t=e.__agBeanMetaData;if(!t){let i;e.prototype.constructor?i=_m(e.prototype.constructor):i=""+e,console.error(`Context item ${i} is not a bean`);return}const s={bean:e,beanInstance:null,beanName:t.beanName};this.beanWrappers[t.beanName]=s}autoWireBeans(e){e.forEach(t=>{this.forEachMetaDataInHierarchy(t,(s,i)=>{const r=s.agClassAttributes;r&&r.forEach(n=>{const o=this.lookupBeanInstance(i,n.beanName,n.optional);t[n.attributeName]=o})})})}methodWireBeans(e){e.forEach(t=>{this.forEachMetaDataInHierarchy(t,(s,i)=>{ui(s.autowireMethods,(r,n)=>{if(r==="agConstructor")return;const o=this.getBeansForParameters(n,i);t[r].apply(t,o)})})})}forEachMetaDataInHierarchy(e,t){let s=Object.getPrototypeOf(e);for(;s!=null;){const i=s.constructor;if(i.hasOwnProperty("__agBeanMetaData")){const r=i.__agBeanMetaData,n=this.getBeanName(i);t(r,n)}s=Object.getPrototypeOf(s)}}getBeanName(e){if(e.__agBeanMetaData&&e.__agBeanMetaData.beanName)return e.__agBeanMetaData.beanName;const t=e.toString();return t.substring(9,t.indexOf("("))}getBeansForParameters(e,t){const s=[];return e&&ui(e,(i,r)=>{const n=this.lookupBeanInstance(t,r);s[Number(i)]=n}),s}lookupBeanInstance(e,t,s=!1){if(this.destroyed)return this.logger.log(`AG Grid: bean reference ${t} is used after the grid is destroyed!`),null;if(t==="context")return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(t))return this.contextParams.providedBeanInstances[t];const i=this.beanWrappers[t];return i?i.beanInstance:(s||console.error(`AG Grid: unable to find bean reference ${t} while initialising ${e}`),null)}callLifeCycleMethods(e,t){e.forEach(s=>this.callLifeCycleMethodsOnBean(s,t))}callLifeCycleMethodsOnBean(e,t,s){const i={};this.forEachMetaDataInHierarchy(e,n=>{const o=n[t];o&&o.forEach(a=>{a!=s&&(i[a]=!0)})}),Object.keys(i).forEach(n=>e[n]())}getBean(e){return this.lookupBeanInstance("getBean",e,!0)}destroy(){if(this.destroyed)return;this.destroyed=!0,this.logger.log(">> Shutting down ag-Application Context");const e=this.getBeanInstances();this.destroyBeans(e),this.contextParams.providedBeanInstances=null,Vt.__unRegisterGridModules(this.contextParams.gridId),this.logger.log(">> ag-Application Context shut down - component is dead")}destroyBean(e){e&&this.destroyBeans([e])}destroyBeans(e){return e?(e.forEach(t=>{this.callLifeCycleMethodsOnBean(t,"preDestroyMethods","destroy");const s=t;typeof s.destroy=="function"&&s.destroy()}),[]):[]}isDestroyed(){return this.destroyed}getGridId(){return this.contextParams.gridId}};function hA(e,t,s){const i=Tl(e.constructor);i.preConstructMethods||(i.preConstructMethods=[]),i.preConstructMethods.push(t)}function xe(e,t,s){const i=Tl(e.constructor);i.postConstructMethods||(i.postConstructMethods=[]),i.postConstructMethods.push(t)}function Fi(e,t,s){const i=Tl(e.constructor);i.preDestroyMethods||(i.preDestroyMethods=[]),i.preDestroyMethods.push(t)}function Le(e){return t=>{const s=Tl(t);s.beanName=e}}function A(e){return(t,s,i)=>{pA(t,e,!1,t,s)}}function zt(e){return(t,s,i)=>{pA(t,e,!0,t,s)}}function pA(e,t,s,i,r,n){if(t===null){console.error("AG Grid: Autowired name should not be null");return}const o=Tl(e.constructor);o.agClassAttributes||(o.agClassAttributes=[]),o.agClassAttributes.push({attributeName:r,beanName:t,optional:s})}function Fr(e){return(t,s,i)=>{const r=typeof t=="function"?t:t.constructor;let n;if(typeof i=="number"){let o;s?(n=Tl(r),o=s):(n=Tl(r),o="agConstructor"),n.autowireMethods||(n.autowireMethods={}),n.autowireMethods[o]||(n.autowireMethods[o]={}),n.autowireMethods[o][i]=e}}}function Tl(e){return e.hasOwnProperty("__agBeanMetaData")||(e.__agBeanMetaData={}),e.__agBeanMetaData}var pn=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setBeans(e,t,s=null,i=null){if(this.frameworkOverrides=t,this.gos=e,s){const r=e.useAsyncEvents();this.addGlobalListener(s,r)}i&&this.addGlobalListener(i,!1)}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,s){const i=t?this.allAsyncListeners:this.allSyncListeners;let r=i.get(e);return!r&&s&&(r=new Set,i.set(e,r)),r}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,s=!1){this.getListeners(e,s,!0).add(t)}removeEventListener(e,t,s=!1){const i=this.getListeners(e,s,!1);i&&(i.delete(t),i.size===0&&(s?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){let t=e;this.gos&&this.gos.addGridCommonParams(t),this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){var s;const i=e.type;if(t&&"event"in e){const l=e.event;l instanceof Event&&(e.eventPath=l.composedPath())}const r=(l,u)=>l.forEach(h=>{if(!u.has(h))return;const p=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>h(e)):()=>h(e);t?this.dispatchAsync(p):p()}),n=(s=this.getListeners(i,t,!1))!=null?s:new Set,o=new Set(n);o.size>0&&r(o,n),new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(l=>{const u=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>l(i,e)):()=>l(i,e);t?this.dispatchAsync(u):u()})}dispatchAsync(e){this.asyncFunctionsQueue.push(e),this.scheduled||(this.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)}),this.scheduled=!0)}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(t=>t())}};f([rn(0,Fr("gridOptionsService")),rn(1,Fr("frameworkOverrides")),rn(2,Fr("globalEventListener")),rn(3,Fr("globalSyncEventListener"))],pn.prototype,"setBeans",1);pn=f([Le("eventService")],pn);var QS=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=s=>{this.frameworkOverrides.wrapOutgoing(()=>e(s))},this.wrappedListeners.set(e,t)),t}wrapGlobal(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=(s,i)=>{this.frameworkOverrides.wrapOutgoing(()=>e(s,i))},this.wrappedGlobalListeners.set(e,t)),t}unwrap(e){var t;return(t=this.wrappedListeners.get(e))!=null?t:e}unwrapGlobal(e){var t;return(t=this.wrappedGlobalListeners.get(e))!=null?t:e}},D1={resizable:!0,sortable:!0},P1=0;function gA(){return P1++}var As=class fA{constructor(t,s,i,r){this.instanceId=gA(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.eventService=new pn,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=t,this.userProvidedColDef=s,this.colId=i,this.primary=r,this.setState(t)}getInstanceId(){return this.instanceId}setState(t){t.sort!==void 0?(t.sort==="asc"||t.sort==="desc")&&(this.sort=t.sort):(t.initialSort==="asc"||t.initialSort==="desc")&&(this.sort=t.initialSort);const s=t.sortIndex,i=t.initialSortIndex;s!==void 0?s!==null&&(this.sortIndex=s):i!==null&&(this.sortIndex=i);const r=t.hide,n=t.initialHide;r!==void 0?this.visible=!r:this.visible=!n,t.pinned!==void 0?this.setPinned(t.pinned):this.setPinned(t.initialPinned);const o=t.flex,a=t.initialFlex;o!==void 0?this.flex=o:a!==void 0&&(this.flex=a)}setColDef(t,s,i){this.colDef=t,this.userProvidedColDef=s,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged",i))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(t){this.parent=t}getParent(){return this.parent}setOriginalParent(t){this.originalParent=t}getOriginalParent(){return this.originalParent}initialise(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const t=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=ve(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!t,this.tooltipFieldContainsDots=ve(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!t}initMinAndMaxWidths(){var t,s;const i=this.colDef;this.minWidth=(t=i.minWidth)!=null?t:this.environment.getMinColWidth(),this.maxWidth=(s=i.maxWidth)!=null?s:Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=ve(this.colDef.tooltipField)||ve(this.colDef.tooltipValueGetter)||ve(this.colDef.tooltipComponent)}resetActualWidth(t){const s=this.calculateColInitialWidth(this.colDef);this.setActualWidth(s,t,!0)}calculateColInitialWidth(t){var s,i;const r=(s=t.minWidth)!=null?s:this.environment.getMinColWidth(),n=(i=t.maxWidth)!=null?i:Number.MAX_SAFE_INTEGER;let o;const a=na(t.width),l=na(t.initialWidth);return a!=null?o=a:l!=null?o=l:o=200,Math.max(Math.min(o,n),r)}isEmptyGroup(){return!1}isRowGroupDisplayed(t){if(ot(this.colDef)||ot(this.colDef.showRowGroup))return!1;const s=this.colDef.showRowGroup===!0,i=this.colDef.showRowGroup===t;return s||i}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}addEventListener(t,s){var i,r;this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new QS(this.frameworkOverrides));const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.wrap(s))!=null?r:s;this.eventService.addEventListener(t,n)}removeEventListener(t,s){var i,r;const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.unwrap(s))!=null?r:s;this.eventService.removeEventListener(t,n)}createColumnFunctionCallbackParams(t){return this.gos.addGridCommonParams({node:t,data:t.data,column:this,colDef:this.colDef})}isSuppressNavigable(t){if(typeof this.colDef.suppressNavigable=="boolean")return this.colDef.suppressNavigable;if(typeof this.colDef.suppressNavigable=="function"){const s=this.createColumnFunctionCallbackParams(t),i=this.colDef.suppressNavigable;return i(s)}return!1}isCellEditable(t){return t.group&&!this.gos.get("enableGroupEdit")?!1:this.isColumnFunc(t,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(t){return this.isColumnFunc(t,this.colDef.rowDrag)}isDndSource(t){return this.isColumnFunc(t,this.colDef.dndSource)}isCellCheckboxSelection(t){return this.isColumnFunc(t,this.colDef.checkboxSelection)}isSuppressPaste(t){return this.isColumnFunc(t,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(t){var s;return(s=this.colDef[t])!=null?s:D1[t]}isColumnFunc(t,s){if(typeof s=="boolean")return s;if(typeof s=="function"){const i=this.createColumnFunctionCallbackParams(t);return s(i)}return!1}setMoving(t,s){this.moving=t,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",s))}createColumnEvent(t,s){return this.gos.addGridCommonParams({type:t,column:this,columns:[this],source:s})}isMoving(){return this.moving}getSort(){return this.sort}setSort(t,s){this.sort!==t&&(this.sort=t,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",s))),this.dispatchStateUpdatedEvent("sort")}setMenuVisible(t,s){this.menuVisible!==t&&(this.menuVisible=t,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",s)))}isMenuVisible(){return this.menuVisible}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return ot(this.sort)}isSorting(){return ve(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(t){this.sortIndex=t,this.dispatchStateUpdatedEvent("sortIndex")}setAggFunc(t){this.aggFunc=t,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(t,s){this.oldLeft=this.left,this.left!==t&&(this.left=t,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",s)))}isFilterActive(){return this.filterActive}setFilterActive(t,s,i){this.filterActive!==t&&(this.filterActive=t,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",s)));const r=this.createColumnEvent("filterChanged",s);i&&zi(r,i),this.eventService.dispatchEvent(r)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(t){t===!0||t==="left"?this.pinned="left":t==="right"?this.pinned="right":this.pinned=null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(t,s){this.firstRightPinned!==t&&(this.firstRightPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",s)))}setLastLeftPinned(t,s){this.lastLeftPinned!==t&&(this.lastLeftPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",s)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(t,s){const i=t===!0;this.visible!==i&&(this.visible=i,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",s))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const t=this.getColDef();return!t.suppressSpanHeaderHeight&&!t.autoHeaderHeight}getColumnGroupPaddingInfo(){let t=this.getParent();if(!t||!t.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const s=t.getPaddingLevel()+1;let i=!0;for(;t;){if(!t.isPadding()){i=!1;break}t=t.getParent()}return{numberOfParents:s,isSpanningTotal:i}}getColDef(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getDefinition(){return this.colDef}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(t){const s=t!==this.autoHeaderHeight;return this.autoHeaderHeight=t,s}createBaseColDefParams(t){return this.gos.addGridCommonParams({node:t,data:t.data,colDef:this.colDef,column:this})}getColSpan(t){if(ot(this.colDef.colSpan))return 1;const s=this.createBaseColDefParams(t),i=this.colDef.colSpan(s);return Math.max(i,1)}getRowSpan(t){if(ot(this.colDef.rowSpan))return 1;const s=this.createBaseColDefParams(t),i=this.colDef.rowSpan(s);return Math.max(i,1)}setActualWidth(t,s,i=!1){this.minWidth!=null&&(t=Math.max(t,this.minWidth)),this.maxWidth!=null&&(t=Math.min(t,this.maxWidth)),this.actualWidth!==t&&(this.actualWidth=t,this.flex&&s!=="flex"&&s!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(s)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(t){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",t))}isGreaterThanMax(t){return this.maxWidth!=null?t>this.maxWidth:!1}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(t){this.flex!==t&&(this.flex=t),this.dispatchStateUpdatedEvent("flex")}setMinimum(t){ve(this.minWidth)&&this.setActualWidth(this.minWidth,t)}setRowGroupActive(t,s){this.rowGroupActive!==t&&(this.rowGroupActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",s))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(t,s){this.pivotActive!==t&&(this.pivotActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",s))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(t,s){this.aggregationActive!==t&&(this.aggregationActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",s)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}getMenuTabs(t){tt("As of v31.1, 'getMenuTabs' is deprecated. Use 'getColDef().menuTabs ?? defaultValues' instead.");let s=this.getColDef().menuTabs;return s==null&&(s=t),s}dispatchStateUpdatedEvent(t){this.eventService.dispatchEvent({type:fA.EVENT_STATE_UPDATED,key:t})}};As.EVENT_MOVING_CHANGED="movingChanged";As.EVENT_LEFT_CHANGED="leftChanged";As.EVENT_WIDTH_CHANGED="widthChanged";As.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged";As.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged";As.EVENT_VISIBLE_CHANGED="visibleChanged";As.EVENT_FILTER_CHANGED="filterChanged";As.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged";As.EVENT_SORT_CHANGED="sortChanged";As.EVENT_COL_DEF_CHANGED="colDefChanged";As.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged";As.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged";As.EVENT_PIVOT_CHANGED="columnPivotChanged";As.EVENT_VALUE_CHANGED="columnValueChanged";As.EVENT_STATE_UPDATED="columnStateUpdated";f([A("gridOptionsService")],As.prototype,"gos",2);f([A("environment")],As.prototype,"environment",2);f([A("columnHoverService")],As.prototype,"columnHoverService",2);f([A("frameworkOverrides")],As.prototype,"frameworkOverrides",2);f([xe],As.prototype,"initialise",1);var Kt=As,Lm=class gd{constructor(t,s,i,r){this.localEventService=new pn,this.expandable=!1,this.instanceId=gA(),this.expandableListenerRemoveCallback=null,this.colGroupDef=t,this.groupId=s,this.expanded=!!t&&!!t.openByDefault,this.padding=i,this.level=r}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}reset(t,s){this.colGroupDef=t,this.level=s,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(t){this.originalParent=t}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(t=>t.isVisible()):!1}isPadding(){return this.padding}setExpanded(t){this.expanded=t===void 0?!1:t;const s={type:gd.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(s)}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(t){this.children=t}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const t=[];return this.addLeafColumns(t),t}addLeafColumns(t){this.children&&this.children.forEach(s=>{s instanceof Kt?t.push(s):s instanceof gd&&s.addLeafColumns(t)})}getColumnGroupShow(){const t=this.colGroupDef;if(t)return t.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const t=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(s=>s.addEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(s=>s.removeEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let t=!1,s=!1,i=!1;const r=this.findChildrenRemovingPadding();for(let o=0,a=r.length;o<a;o++){const l=r[o];if(!l.isVisible())continue;const u=l.getColumnGroupShow();u==="open"?(t=!0,i=!0):u==="closed"?(s=!0,i=!0):(t=!0,s=!0)}const n=t&&s&&i;if(this.expandable!==n){this.expandable=n;const o={type:gd.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(o)}}findChildrenRemovingPadding(){const t=[],s=i=>{i.forEach(r=>{r instanceof gd&&r.isPadding()?s(r.children):t.push(r)})};return s(this.children),t}onColumnVisibilityChanged(){this.setExpandable()}addEventListener(t,s){this.localEventService.addEventListener(t,s)}removeEventListener(t,s){this.localEventService.removeEventListener(t,s)}};Lm.EVENT_EXPANDED_CHANGED="expandedChanged";Lm.EVENT_EXPANDABLE_CHANGED="expandableChanged";f([Fi],Lm.prototype,"destroy",1);var Rs=Lm,A1={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},mA={};$s(mA,{addSafePassiveEventListener:()=>TA,createEventPath:()=>EA,getCtrlForEventTarget:()=>bf,getEventPath:()=>RA,isElementInEventPath:()=>Ef,isEventSupported:()=>JS,isStopPropagationForAgGrid:()=>un,stopPropagationForAgGrid:()=>gn});var vA={};$s(vA,{areEqual:()=>Fn,existsAndNotEmpty:()=>CA,flatten:()=>xA,forEachReverse:()=>_1,includes:()=>pr,insertArrayIntoArray:()=>$y,insertIntoArray:()=>ch,last:()=>Mt,moveInArray:()=>Ky,pushAll:()=>Yy,removeAllFromArray:()=>SA,removeAllFromUnorderedArray:()=>wA,removeFromArray:()=>Vi,removeFromUnorderedArray:()=>ZS,removeRepeatsFromArray:()=>N1,shallowCompare:()=>F1,sortNumerically:()=>yA,toStrings:()=>I1});function CA(e){return e!=null&&e.length>0}function Mt(e){if(!(!e||!e.length))return e[e.length-1]}function Fn(e,t,s){return e==null&&t==null?!0:e!=null&&t!=null&&e.length===t.length&&e.every((i,r)=>s?s(i,t[r]):t[r]===i)}function F1(e,t){return Fn(e,t)}function yA(e){return e.sort((t,s)=>t-s)}function N1(e,t){if(e)for(let s=e.length-2;s>=0;s--){const i=e[s]===t,r=e[s+1]===t;i&&r&&e.splice(s+1,1)}}function ZS(e,t){const s=e.indexOf(t);s>=0&&(e[s]=e[e.length-1],e.pop())}function Vi(e,t){const s=e.indexOf(t);s>=0&&e.splice(s,1)}function wA(e,t){for(let s=0;s<t.length;s++)ZS(e,t[s])}function SA(e,t){for(let s=0;s<t.length;s++)Vi(e,t[s])}function ch(e,t,s){e.splice(s,0,t)}function $y(e,t,s){if(!(e==null||t==null))for(let i=t.length-1;i>=0;i--){const r=t[i];ch(e,r,s)}}function Ky(e,t,s){SA(e,t),t.slice().reverse().forEach(i=>ch(e,i,s))}function pr(e,t){return e.indexOf(t)>-1}function xA(e){return[].concat.apply([],e)}function Yy(e,t){t==null||e==null||t.forEach(s=>e.push(s))}function I1(e){return e.map(lh)}function _1(e,t){if(e!=null)for(let s=e.length-1;s>=0;s--)t(e[s],s)}var bA="__ag_Grid_Stop_Propagation",k1=["touchstart","touchend","touchmove","touchcancel","scroll"],oC={};function gn(e){e[bA]=!0}function un(e){return e[bA]===!0}var JS=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return s=>{if(typeof oC[s]=="boolean")return oC[s];const i=document.createElement(e[s]||"div");return s="on"+s,oC[s]=s in i}})();function bf(e,t,s){let i=t;for(;i;){const r=e.getDomData(i,s);if(r)return r;i=i.parentElement}return null}function Ef(e,t){return!t||!e?!1:RA(t).indexOf(e)>=0}function EA(e){const t=[];let s=e.target;for(;s;)t.push(s),s=s.parentElement;return t}function RA(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():EA(t)}function TA(e,t,s,i){const n=pr(k1,s)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,s,i,n)}var Co=class DA{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.lastChangeSetIdLookup={},this.propertyListenerId=0,this.isAlive=()=>!this.destroyed}getFrameworkOverrides(){return this.frameworkOverrides}getContext(){return this.context}destroy(){for(let t=0;t<this.destroyFunctions.length;t++)this.destroyFunctions[t]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:DA.EVENT_DESTROYED})}addEventListener(t,s){this.localEventService||(this.localEventService=new pn),this.localEventService.addEventListener(t,s)}removeEventListener(t,s){this.localEventService&&this.localEventService.removeEventListener(t,s)}dispatchEvent(t){this.localEventService&&this.localEventService.dispatchEvent(t)}addManagedListener(t,s,i){if(this.destroyed)return;t instanceof HTMLElement?TA(this.getFrameworkOverrides(),t,s,i):t.addEventListener(s,i);const r=()=>(t.removeEventListener(s,i),null);return this.destroyFunctions.push(r),()=>(r(),this.destroyFunctions=this.destroyFunctions.filter(n=>n!==r),null)}setupGridOptionListener(t,s){this.gos.addEventListener(t,s);const i=()=>(this.gos.removeEventListener(t,s),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==i),null)}addManagedPropertyListener(t,s){return this.destroyed?()=>null:this.setupGridOptionListener(t,s)}addManagedPropertyListeners(t,s){if(this.destroyed)return;const i=t.join("-")+this.propertyListenerId++,r=n=>{if(n.changeSet){if(n.changeSet&&n.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=n.changeSet.id}const o={type:"gridPropertyChanged",changeSet:n.changeSet,source:n.source};s(o)};t.forEach(n=>this.setupGridOptionListener(n,r))}addDestroyFunc(t){this.isAlive()?this.destroyFunctions.push(t):t()}createManagedBean(t,s){const i=this.createBean(t,s);return this.addDestroyFunc(this.destroyBean.bind(this,t,s)),i}createBean(t,s,i){return(s||this.getContext()).createBean(t,i)}destroyBean(t,s){return(s||this.getContext()).destroyBean(t)}destroyBeans(t,s){if(t)for(let i=0;i<t.length;i++)this.destroyBean(t[i],s);return[]}};Co.EVENT_DESTROYED="destroyed";f([A("frameworkOverrides")],Co.prototype,"frameworkOverrides",2);f([A("context")],Co.prototype,"context",2);f([A("eventService")],Co.prototype,"eventService",2);f([A("gridOptionsService")],Co.prototype,"gos",2);f([A("localeService")],Co.prototype,"localeService",2);f([A("environment")],Co.prototype,"environment",2);f([Fi],Co.prototype,"destroy",1);var Se=Co,uh=class extends Se{setBeans(e){this.logger=e.create("ColumnFactory")}createColumnTree(e,t,s,i){const r=new b1,{existingCols:n,existingGroups:o,existingColKeys:a}=this.extractExistingTreeData(s);r.addExistingKeys(a);const l=this.recursivelyCreateColumns(e,0,t,n,r,o,i),u=this.findMaxDept(l,0);this.logger.log("Number of levels for grouped columns is "+u);const h=this.balanceColumnTree(l,0,u,r);return Jn(null,h,(g,m)=>{g instanceof Rs&&g.setupExpandable(),g.setOriginalParent(m)}),{columnTree:h,treeDept:u}}extractExistingTreeData(e){const t=[],s=[],i=[];return e&&Jn(null,e,r=>{if(r instanceof Rs){const n=r;s.push(n)}else{const n=r;i.push(n.getId()),t.push(n)}}),{existingCols:t,existingGroups:s,existingColKeys:i}}createForAutoGroups(e,t){return e.map(s=>this.createAutoGroupTreeItem(t,s))}createAutoGroupTreeItem(e,t){const s=this.findDepth(e);let i=t;for(let r=s-1;r>=0;r--){const n=new Rs(null,`FAKE_PATH_${t.getId()}}_${r}`,!0,r);this.createBean(n),n.setChildren([i]),i.setOriginalParent(n),i=n}return s===0&&t.setOriginalParent(null),i}findDepth(e){let t=0,s=e;for(;s&&s[0]&&s[0]instanceof Rs;)t++,s=s[0].getChildren();return t}balanceColumnTree(e,t,s,i){const r=[];for(let n=0;n<e.length;n++){const o=e[n];if(o instanceof Rs){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,s,i);a.setChildren(l),r.push(a)}else{let a,l;for(let u=s-1;u>=t;u--){const h=i.getUniqueKey(null,null),p=this.createMergedColGroupDef(null),g=new Rs(p,h,!0,t);this.createBean(g),l&&l.setChildren([g]),l=g,a||(a=l)}if(a&&l)if(r.push(a),e.some(h=>h instanceof Rs)){l.setChildren([o]);continue}else{l.setChildren(e);break}r.push(o)}}return r}findMaxDept(e,t){let s=t;for(let i=0;i<e.length;i++){const r=e[i];if(r instanceof Rs){const n=r,o=this.findMaxDept(n.getChildren(),t+1);s<o&&(s=o)}}return s}recursivelyCreateColumns(e,t,s,i,r,n,o){if(!e)return[];const a=new Array(e.length);for(let l=0;l<a.length;l++){const u=e[l];this.isColumnGroup(u)?a[l]=this.createColumnGroup(s,u,t,i,r,n,o):a[l]=this.createColumn(s,u,i,r,o)}return a}createColumnGroup(e,t,s,i,r,n,o){const a=this.createMergedColGroupDef(t),l=r.getUniqueKey(a.groupId||null,null),u=new Rs(a,l,!1,s);this.createBean(u);const h=this.findExistingGroup(t,n);h&&n.splice(h.idx,1);let p=h==null?void 0:h.group;p&&u.setExpanded(p.isExpanded());const g=this.recursivelyCreateColumns(a.children,s+1,e,i,r,n,o);return u.setChildren(g),u}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gos.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(e,t,s,i,r){const n=this.findExistingColumn(t,s);n&&(s==null||s.splice(n.idx,1));let o=n==null?void 0:n.column;if(o){const a=this.addColumnDefaultAndTypes(t,o.getColId());o.setColDef(a,t,r),this.applyColumnState(o,a,r)}else{const a=i.getUniqueKey(t.colId,t.field),l=this.addColumnDefaultAndTypes(t,a);o=new Kt(l,t,a,e),this.context.createBean(o)}return this.dataTypeService.addColumnListeners(o),o}applyColumnState(e,t,s){const i=na(t.flex);if(i!==void 0&&e.setFlex(i),e.getFlex()<=0){const a=na(t.width);if(a!=null)e.setActualWidth(a,s);else{const l=e.getActualWidth();e.setActualWidth(l,s)}}t.sort!==void 0&&(t.sort=="asc"||t.sort=="desc"?e.setSort(t.sort,s):e.setSort(void 0,s));const n=na(t.sortIndex);n!==void 0&&e.setSortIndex(n);const o=wf(t.hide);o!==void 0&&e.setVisible(!o,s),t.pinned!==void 0&&e.setPinned(t.pinned)}findExistingColumn(e,t){if(t)for(let s=0;s<t.length;s++){const i=t[s].getUserProvidedColDef();if(!i)continue;if(e.colId!=null){if(t[s].getId()===e.colId)return{idx:s,column:t[s]};continue}if(e.field!=null){if(i.field===e.field)return{idx:s,column:t[s]};continue}if(i===e)return{idx:s,column:t[s]}}}findExistingGroup(e,t){if(e.groupId!=null)for(let i=0;i<t.length;i++){const r=t[i];if(r.getColGroupDef()&&r.getId()===e.groupId)return{idx:i,group:r}}}addColumnDefaultAndTypes(e,t){const s={},i=this.gos.get("defaultColDef");zi(s,i,!1,!0);const r=this.dataTypeService.updateColDefAndGetColumnType(s,e,t);r&&this.assignColumnTypes(r,s),zi(s,e,!1,!0);const n=this.gos.get("autoGroupColumnDef"),o=this.gos.isColumnsSortingCoupledToGroup();return e.rowGroup&&n&&o&&zi(s,{sort:n.sort,initialSort:n.initialSort},!1,!0),this.dataTypeService.validateColDef(s),s}assignColumnTypes(e,t){if(!e.length)return;const s=Object.assign({},A1),i=this.gos.get("columnTypes")||{};ui(i,(r,n)=>{r in s?console.warn(`AG Grid: the column type '${r}' is a default column type and cannot be overridden.`):(n.type&&tt("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),s[r]=n)}),e.forEach(r=>{const n=s[r.trim()];n?zi(t,n,!1,!0):console.warn("AG Grid: colDef.type '"+r+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(e){return e.children!==void 0}};f([A("dataTypeService")],uh.prototype,"dataTypeService",2);f([rn(0,Fr("loggerFactory"))],uh.prototype,"setBeans",1);uh=f([Le("columnFactory")],uh);function Jn(e,t,s){if(t)for(let i=0;i<t.length;i++){const r=t[i];r instanceof Rs&&Jn(r,r.getChildren(),s),s(r,e)}}var Om=class wn{constructor(t,s,i,r){this.displayedChildren=[],this.localEventService=new pn,this.groupId=s,this.partId=i,this.providedColumnGroup=t,this.pinned=r}static createUniqueId(t,s){return t+"_"+s}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(t){this.parent=t}getUniqueId(){return wn.createUniqueId(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const t=this.getProvidedColumnGroup().getLeafColumns();return!t||t.length===0?!1:t.every(s=>s.isMoving())}checkLeft(){if(this.displayedChildren.forEach(t=>{t instanceof wn&&t.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const s=Mt(this.displayedChildren).getLeft();this.setLeft(s)}else{const t=this.displayedChildren[0].getLeft();this.setLeft(t)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(t){this.oldLeft=this.left,this.left!==t&&(this.left=t,this.localEventService.dispatchEvent(this.createAgEvent(wn.EVENT_LEFT_CHANGED)))}getPinned(){return this.pinned}createAgEvent(t){return{type:t}}addEventListener(t,s){this.localEventService.addEventListener(t,s)}removeEventListener(t,s){this.localEventService.removeEventListener(t,s)}getGroupId(){return this.groupId}getPartId(){return this.partId}isChildInThisGroupDeepSearch(t){let s=!1;return this.children.forEach(i=>{t===i&&(s=!0),i instanceof wn&&i.isChildInThisGroupDeepSearch(t)&&(s=!0)}),s}getActualWidth(){let t=0;return this.displayedChildren&&this.displayedChildren.forEach(s=>{t+=s.getActualWidth()}),t}isResizable(){if(!this.displayedChildren)return!1;let t=!1;return this.displayedChildren.forEach(s=>{s.isResizable()&&(t=!0)}),t}getMinWidth(){let t=0;return this.displayedChildren.forEach(s=>{t+=s.getMinWidth()||0}),t}addChild(t){this.children||(this.children=[]),this.children.push(t)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const t=[];return this.addLeafColumns(t),t}getDisplayedLeafColumns(){const t=[];return this.addDisplayedLeafColumns(t),t}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(t){this.providedColumnGroup.setExpanded(t)}addDisplayedLeafColumns(t){this.displayedChildren.forEach(s=>{s instanceof Kt?t.push(s):s instanceof wn&&s.addDisplayedLeafColumns(t)})}addLeafColumns(t){this.children.forEach(s=>{s instanceof Kt?t.push(s):s instanceof wn&&s.addLeafColumns(t)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const t=this.getParent();return!this.isPadding()||!t||!t.isPadding()?0:1+t.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let t=this;for(;t!=null&&t.isPadding();)t=t.getParent();if(!(t?t.providedColumnGroup.isExpandable():!1)){this.displayedChildren=this.children,this.localEventService.dispatchEvent(this.createAgEvent(wn.EVENT_DISPLAYED_CHILDREN_CHANGED));return}this.children.forEach(i=>{if(i instanceof wn&&(!i.displayedChildren||!i.displayedChildren.length))return;switch(i.getColumnGroupShow()){case"open":t.providedColumnGroup.isExpanded()&&this.displayedChildren.push(i);break;case"closed":t.providedColumnGroup.isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}),this.localEventService.dispatchEvent(this.createAgEvent(wn.EVENT_DISPLAYED_CHILDREN_CHANGED))}};Om.EVENT_LEFT_CHANGED="leftChanged";Om.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged";f([A("gridOptionsService")],Om.prototype,"gos",2);var Ls=Om,w=class{};w.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged";w.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded";w.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged";w.EVENT_PIVOT_MAX_COLUMNS_EXCEEDED="pivotMaxColumnsExceeded";w.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged";w.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll";w.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged";w.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged";w.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged";w.EVENT_COLUMN_MOVED="columnMoved";w.EVENT_COLUMN_VISIBLE="columnVisible";w.EVENT_COLUMN_PINNED="columnPinned";w.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened";w.EVENT_COLUMN_RESIZED="columnResized";w.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged";w.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED="suppressMovableColumns";w.EVENT_SUPPRESS_MENU_HIDE_CHANGED="suppressMenuHide";w.EVENT_SUPPRESS_FIELD_DOT_NOTATION="suppressFieldDotNotation";w.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged";w.EVENT_COLUMN_HEADER_MOUSE_OVER="columnHeaderMouseOver";w.EVENT_COLUMN_HEADER_MOUSE_LEAVE="columnHeaderMouseLeave";w.EVENT_COLUMN_HEADER_CLICKED="columnHeaderClicked";w.EVENT_COLUMN_HEADER_CONTEXT_MENU="columnHeaderContextMenu";w.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed";w.EVENT_ROW_GROUP_OPENED="rowGroupOpened";w.EVENT_ROW_DATA_UPDATED="rowDataUpdated";w.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged";w.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged";w.EVENT_CHART_CREATED="chartCreated";w.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged";w.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged";w.EVENT_CHART_DESTROYED="chartDestroyed";w.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged";w.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged";w.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart";w.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd";w.EVENT_MODEL_UPDATED="modelUpdated";w.EVENT_CUT_START="cutStart";w.EVENT_CUT_END="cutEnd";w.EVENT_PASTE_START="pasteStart";w.EVENT_PASTE_END="pasteEnd";w.EVENT_FILL_START="fillStart";w.EVENT_FILL_END="fillEnd";w.EVENT_RANGE_DELETE_START="rangeDeleteStart";w.EVENT_RANGE_DELETE_END="rangeDeleteEnd";w.EVENT_UNDO_STARTED="undoStarted";w.EVENT_UNDO_ENDED="undoEnded";w.EVENT_REDO_STARTED="redoStarted";w.EVENT_REDO_ENDED="redoEnded";w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart";w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd";w.EVENT_CELL_CLICKED="cellClicked";w.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked";w.EVENT_CELL_MOUSE_DOWN="cellMouseDown";w.EVENT_CELL_CONTEXT_MENU="cellContextMenu";w.EVENT_CELL_VALUE_CHANGED="cellValueChanged";w.EVENT_CELL_EDIT_REQUEST="cellEditRequest";w.EVENT_ROW_VALUE_CHANGED="rowValueChanged";w.EVENT_CELL_FOCUSED="cellFocused";w.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared";w.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused";w.EVENT_ROW_SELECTED="rowSelected";w.EVENT_SELECTION_CHANGED="selectionChanged";w.EVENT_TOOLTIP_SHOW="tooltipShow";w.EVENT_TOOLTIP_HIDE="tooltipHide";w.EVENT_CELL_KEY_DOWN="cellKeyDown";w.EVENT_CELL_MOUSE_OVER="cellMouseOver";w.EVENT_CELL_MOUSE_OUT="cellMouseOut";w.EVENT_FILTER_CHANGED="filterChanged";w.EVENT_FILTER_MODIFIED="filterModified";w.EVENT_FILTER_OPENED="filterOpened";w.EVENT_ADVANCED_FILTER_BUILDER_VISIBLE_CHANGED="advancedFilterBuilderVisibleChanged";w.EVENT_SORT_CHANGED="sortChanged";w.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved";w.EVENT_ROW_CLICKED="rowClicked";w.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked";w.EVENT_GRID_READY="gridReady";w.EVENT_GRID_PRE_DESTROYED="gridPreDestroyed";w.EVENT_GRID_SIZE_CHANGED="gridSizeChanged";w.EVENT_VIEWPORT_CHANGED="viewportChanged";w.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged";w.EVENT_FIRST_DATA_RENDERED="firstDataRendered";w.EVENT_DRAG_STARTED="dragStarted";w.EVENT_DRAG_STOPPED="dragStopped";w.EVENT_CHECKBOX_CHANGED="checkboxChanged";w.EVENT_ROW_EDITING_STARTED="rowEditingStarted";w.EVENT_ROW_EDITING_STOPPED="rowEditingStopped";w.EVENT_CELL_EDITING_STARTED="cellEditingStarted";w.EVENT_CELL_EDITING_STOPPED="cellEditingStopped";w.EVENT_BODY_SCROLL="bodyScroll";w.EVENT_BODY_SCROLL_END="bodyScrollEnd";w.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged";w.EVENT_PAGINATION_CHANGED="paginationChanged";w.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged";w.EVENT_STORE_REFRESHED="storeRefreshed";w.EVENT_STATE_UPDATED="stateUpdated";w.EVENT_COLUMN_MENU_VISIBLE_CHANGED="columnMenuVisibleChanged";w.EVENT_CONTEXT_MENU_VISIBLE_CHANGED="contextMenuVisibleChanged";w.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged";w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED="columnContainerWidthChanged";w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged";w.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged";w.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged";w.EVENT_FLASH_CELLS="flashCells";w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged";w.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged";w.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged";w.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged";w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged";w.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged";w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged";w.EVENT_ROW_DRAG_ENTER="rowDragEnter";w.EVENT_ROW_DRAG_MOVE="rowDragMove";w.EVENT_ROW_DRAG_LEAVE="rowDragLeave";w.EVENT_ROW_DRAG_END="rowDragEnd";w.EVENT_GRID_STYLES_CHANGED="gridStylesChanged";w.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest";w.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest";w.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest";w.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest";w.EVENT_STORE_UPDATED="storeUpdated";w.EVENT_FILTER_DESTROYED="filterDestroyed";w.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted";w.EVENT_ROW_COUNT_READY="rowCountReady";w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED="advancedFilterEnabledChanged";w.EVENT_DATA_TYPES_INFERRED="dataTypesInferred";w.EVENT_FIELD_VALUE_CHANGED="fieldValueChanged";w.EVENT_FIELD_PICKER_VALUE_SELECTED="fieldPickerValueSelected";w.EVENT_SIDE_BAR_UPDATED="sideBarUpdated";var Dg=new Set([w.EVENT_GRID_PRE_DESTROYED,w.EVENT_FILL_START]),PA=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let s;return typeof t!="number"?s=0:s=t+1,this.existingIds[e]=s,s}},Jc="ag-Grid-AutoColumn",dh=class extends Se{createAutoGroupColumns(e){const t=[],s=this.gos.get("treeData");let i=this.gos.isGroupMultiAutoColumn();return s&&i&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),i=!1),i?e.forEach((r,n)=>{t.push(this.createOneAutoGroupColumn(r,n))}):t.push(this.createOneAutoGroupColumn()),t}updateAutoGroupColumns(e,t){e.forEach((s,i)=>this.updateOneAutoGroupColumn(s,i,t))}createOneAutoGroupColumn(e,t){let s;e?s=`${Jc}-${e.getId()}`:s=Jc;const i=this.createAutoGroupColDef(s,e,t);i.colId=s;const r=new Kt(i,null,s,!0);return this.context.createBean(r),r}updateOneAutoGroupColumn(e,t,s){const i=e.getColDef(),r=typeof i.showRowGroup=="string"?i.showRowGroup:void 0,n=r!=null?this.columnModel.getPrimaryColumn(r):void 0,o=this.createAutoGroupColDef(e.getId(),n??void 0,t);e.setColDef(o,null,s),this.columnFactory.applyColumnState(e,o,s)}createAutoGroupColDef(e,t,s){let i=this.createBaseColDef(t);const r=this.gos.get("autoGroupColumnDef");zi(i,r),i=this.columnFactory.addColumnDefaultAndTypes(i,e),this.gos.get("treeData")||ot(i.field)&&ot(i.valueGetter)&&ot(i.filterValueGetter)&&i.filter!=="agGroupColumnFilter"&&(i.filter=!1),s&&s>0&&(i.headerCheckboxSelection=!1);const n=this.gos.isColumnsSortingCoupledToGroup(),o=i.valueGetter||i.field!=null;return n&&!o&&(i.sortIndex=void 0,i.initialSort=void 0),i}createBaseColDef(e){const t=this.gos.get("autoGroupColumnDef"),i={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(t&&(t.cellRenderer||t.cellRendererSelector)||(i.cellRenderer="agGroupCellRenderer"),e){const n=e.getColDef();Object.assign(i,{headerName:this.columnModel.getDisplayNameForColumn(e,"header"),headerValueGetter:n.headerValueGetter}),n.cellRenderer&&Object.assign(i,{cellRendererParams:{innerRenderer:n.cellRenderer,innerRendererParams:n.cellRendererParams}}),i.showRowGroup=e.getColId()}else i.showRowGroup=!0;return i}};f([A("columnModel")],dh.prototype,"columnModel",2);f([A("columnFactory")],dh.prototype,"columnFactory",2);dh=f([Le("autoGroupColService")],dh);var AA={};$s(AA,{camelCaseToHumanText:()=>FA,camelCaseToHyphenated:()=>NA,capitalise:()=>G1,escapeString:()=>Ds,utf8_encode:()=>O1});var M1=/[&<>"']/g,L1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function O1(e){const t=String.fromCharCode;function s(p){const g=[];if(!p)return[];const m=p.length;let C=0,y,R;for(;C<m;)y=p.charCodeAt(C++),y>=55296&&y<=56319&&C<m?(R=p.charCodeAt(C++),(R&64512)==56320?g.push(((y&1023)<<10)+(R&1023)+65536):(g.push(y),C--)):g.push(y);return g}function i(p){if(p>=55296&&p<=57343)throw Error("Lone surrogate U+"+p.toString(16).toUpperCase()+" is not a scalar value")}function r(p,g){return t(p>>g&63|128)}function n(p){if(p>=0&&p<=31&&p!==10)return`_x${p.toString(16).toUpperCase().padStart(4,"0")}_`;if(!(p&4294967168))return t(p);let g="";return p&4294965248?p&4294901760?p&4292870144||(g=t(p>>18&7|240),g+=r(p,12),g+=r(p,6)):(i(p),g=t(p>>12&15|224),g+=r(p,6)):g=t(p>>6&31|192),g+=t(p&63|128),g}const o=s(e),a=o.length;let l=-1,u,h="";for(;++l<a;)u=o[l],h+=n(u);return h}function G1(e){return e[0].toUpperCase()+e.substring(1).toLowerCase()}function Ds(e,t){if(e==null)return null;const s=e.toString().toString();return t?s:s.replace(M1,i=>L1[i])}function FA(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,s=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(s,"$1 $2$3").replace(/\./g," ").split(" ").map(r=>r.substring(0,1).toUpperCase()+(r.length>1?r.substring(1,r.length):"")).join(" ")}function NA(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}var IA={};$s(IA,{convertToMap:()=>Bo,keys:()=>B1,mapById:()=>V1});function Bo(e){const t=new Map;return e.forEach(s=>t.set(s[0],s[1])),t}function V1(e,t){const s=new Map;return e.forEach(i=>s.set(t(i),i)),s}function B1(e){const t=[];return e.forEach((s,i)=>t.push(i)),t}var Us=class extends Se{constructor(){super(...arguments),this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.gridHeaderRowCount=0,this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.displayedColumnsAndGroupsMap={},this.viewportColumns=[],this.viewportColumnsHash="",this.headerViewportColumns=[],this.viewportColumnsCenter=[],this.headerViewportColumnsCenter=[],this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.autoHeightActiveAtLeastOnce=!1,this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.changeEventsDispatching=!1,this.autoGroupsNeedBuilding=!1,this.forceRecreateAutoGroups=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}init(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation");const e=this.gos.get("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],t=>this.buildAutoGroupColumns(xc(t.source))),this.addManagedPropertyListener("autoGroupColumnDef",t=>this.onAutoGroupColumnDefChanged(xc(t.source))),this.addManagedPropertyListeners(["defaultColDef","columnTypes","suppressFieldDotNotation"],t=>this.onSharedColDefChanged(xc(t.source))),this.addManagedPropertyListener("pivotMode",t=>this.setPivotMode(this.gos.get("pivotMode"),xc(t.source))),this.addManagedListener(this.eventService,w.EVENT_FIRST_DATA_RENDERED,()=>this.onFirstDataRendered())}buildAutoGroupColumns(e){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns(e))}onAutoGroupColumnDefChanged(e){this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,e)}onSharedColDefChanged(e){this.gridColumns&&(this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,e),this.createColumnsFromColumnDefs(!0,e))}setColumnDefs(e,t){const s=!!this.columnDefs;this.columnDefs=e,this.createColumnsFromColumnDefs(s,t)}recreateColumnDefs(e){this.onSharedColDefChanged(e)}destroyOldColumns(e,t){const s={};if(!e)return;Jn(null,e,r=>{s[r.getInstanceId()]=r}),t&&Jn(null,t,r=>{s[r.getInstanceId()]=null});const i=Object.values(s).filter(r=>r!=null);this.destroyBeans(i)}destroyColumns(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}createColumnsFromColumnDefs(e,t){const s=e?this.compareColumnStatesAndDispatchEvents(t):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;const i=this.primaryColumns,r=this.primaryColumnTree,n=this.columnFactory.createColumnTree(this.columnDefs,!0,r,t);this.destroyOldColumns(this.primaryColumnTree,n.columnTree),this.primaryColumnTree=n.columnTree,this.primaryHeaderRowCount=n.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(l=>this.primaryColumnsMap[l.getId()]=l),this.extractRowGroupColumns(t,i),this.extractPivotColumns(t,i),this.extractValueColumns(t,i),this.ready=!0;const o=this.gridColsArePrimary===void 0;(this.gridColsArePrimary||o||this.autoGroupsNeedBuilding)&&(this.updateGridColumns(),e&&this.gridColsArePrimary&&!this.gos.get("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(t),this.checkViewportColumns()),this.dispatchEverythingChanged(t),this.changeEventsDispatching=!0,s&&s(),this.changeEventsDispatching=!1,this.dispatchNewColumnsLoaded(t)}shouldRowModelIgnoreRefresh(){return this.changeEventsDispatching}dispatchNewColumnsLoaded(e){const t={type:w.EVENT_NEW_COLUMNS_LOADED,source:e};this.eventService.dispatchEvent(t),e==="gridInitializing"&&this.onColumnsReady()}dispatchEverythingChanged(e){const t={type:w.EVENT_COLUMN_EVERYTHING_CHANGED,source:e};this.eventService.dispatchEvent(t)}orderGridColumnsLikePrimary(){const e=this.primaryColumns;if(!e)return;const t=e.filter(i=>this.gridColumns.indexOf(i)>=0),s=this.gridColumns.filter(i=>t.indexOf(i)<0);this.gridColumns=[...s,...t],this.gridColumns=this.placeLockedColumns(this.gridColumns)}getAllDisplayedAutoHeightCols(){return this.displayedAutoHeightCols}setViewport(){this.gos.get("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}checkViewportColumns(e=!1){if(this.displayedColumnsCenter==null||!this.extractViewport())return;const s={type:w.EVENT_VIRTUAL_COLUMNS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(s)}setViewportPosition(e,t,s=!1){(e!==this.scrollWidth||t!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=e,this.scrollPosition=t,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns(s))}isPivotMode(){return this.pivotMode}isPivotSettingAllowed(e){return e&&this.gos.get("treeData")?(tt("Pivot mode not available with treeData."),!1):!0}setPivotMode(e,t){if(e===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode)||(this.pivotMode=e,!this.gridColumns))return;this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(t);const s={type:w.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(s)}getSecondaryPivotColumn(e,t){if(ot(this.secondaryColumns))return null;const s=this.getPrimaryColumn(t);let i=null;return this.secondaryColumns.forEach(r=>{const n=r.getColDef().pivotKeys,o=r.getColDef().pivotValueColumn;Fn(n,e)&&o===s&&(i=r)}),i}setBeans(e){this.logger=e.create("columnModel")}setFirstRightAndLastLeftPinned(e){let t,s;this.gos.get("enableRtl")?(t=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,s=this.displayedColumnsRight?Mt(this.displayedColumnsRight):null):(t=this.displayedColumnsLeft?Mt(this.displayedColumnsLeft):null,s=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(i=>{i.setLastLeftPinned(i===t,e),i.setFirstRightPinned(i===s,e)})}autoSizeColumns(e){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeColumns(e));return}const{columns:t,skipHeader:s,skipHeaderGroups:i,stopAtGroup:r,source:n="api"}=e;this.animationFrameService.flushAllFrames();const o=[];let a=-1;const l=s??this.gos.get("skipHeaderOnAutoSize"),u=i??l;for(;a!==0;)a=0,this.actionOnGridColumns(t,h=>{if(o.indexOf(h)>=0)return!1;const p=this.autoWidthCalculator.getPreferredWidthForColumn(h,l);if(p>0){const g=this.normaliseColumnWidth(h,p);h.setActualWidth(g,n),o.push(h),a++}return!0},n);u||this.autoSizeColumnGroupsByColumns(t,n,r),this.dispatchColumnResizedEvent(o,!0,"autosizeColumns")}dispatchColumnResizedEvent(e,t,s,i=null){if(e&&e.length){const r={type:w.EVENT_COLUMN_RESIZED,columns:e,column:e.length===1?e[0]:null,flexColumns:i,finished:t,source:s};this.eventService.dispatchEvent(r)}}dispatchColumnChangedEvent(e,t,s){const i={type:e,columns:t,column:t&&t.length==1?t[0]:null,source:s};this.eventService.dispatchEvent(i)}dispatchColumnMovedEvent(e){const{movedColumns:t,source:s,toIndex:i,finished:r}=e,n={type:w.EVENT_COLUMN_MOVED,columns:t,column:t&&t.length===1?t[0]:null,toIndex:i,finished:r,source:s};this.eventService.dispatchEvent(n)}dispatchColumnPinnedEvent(e,t){if(!e.length)return;const s=e.length===1?e[0]:null,i=this.getCommonValue(e,n=>n.getPinned()),r={type:w.EVENT_COLUMN_PINNED,pinned:i??null,columns:e,column:s,source:t};this.eventService.dispatchEvent(r)}dispatchColumnVisibleEvent(e,t){if(!e.length)return;const s=e.length===1?e[0]:null,i=this.getCommonValue(e,n=>n.isVisible()),r={type:w.EVENT_COLUMN_VISIBLE,visible:i,columns:e,column:s,source:t};this.eventService.dispatchEvent(r)}autoSizeColumn(e,t,s){e&&this.autoSizeColumns({columns:[e],skipHeader:s,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,s){const i=new Set;this.getGridColumns(e).forEach(a=>{let l=a.getParent();for(;l&&l!=s;)l.isPadding()||i.add(l),l=l.getParent()});let n;const o=[];for(const a of i){for(const l of this.ctrlsService.getHeaderRowContainerCtrls())if(n=l.getHeaderCtrlForColumn(a),n)break;n&&n.resizeLeafColumnsToFit(t)}return o}autoSizeAllColumns(e,t){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeAllColumns(e,t));return}const s=this.getAllDisplayedColumns();this.autoSizeColumns({columns:s,skipHeader:t,source:e})}getColumnsFromTree(e){const t=[],s=i=>{for(let r=0;r<i.length;r++){const n=i[r];n instanceof Kt?t.push(n):n instanceof Rs&&s(n.getChildren())}};return s(e),t}getAllDisplayedTrees(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}getPrimaryColumnTree(){return this.primaryColumnTree}getHeaderRowCount(){return this.gridHeaderRowCount}getDisplayedTreeLeft(){return this.displayedTreeLeft}getDisplayedTreeRight(){return this.displayedTreeRight}getDisplayedTreeCentre(){return this.displayedTreeCentre}isColumnDisplayed(e){return this.getAllDisplayedColumns().indexOf(e)>=0}getAllDisplayedColumns(){return this.displayedColumns}getViewportColumns(){return this.viewportColumns}getDisplayedLeftColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsLeft):this.displayedColumnsLeft}getDisplayedRightColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsRight):this.displayedColumnsRight}isColSpanActive(){return this.colSpanActive}getDisplayedColumnsForRow(e,t,s,i){const r=[];let n=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,u=Math.min(a.getColSpan(e),l),h=[a];if(u>1){const g=u-1;for(let m=1;m<=g;m++)h.push(t[o+m]);o+=g}let p;s?(p=!1,h.forEach(g=>{s(g)&&(p=!0)})):p=!0,p&&(r.length===0&&n&&(i&&i(a))&&r.push(n),r.push(a)),n=a}return r}getViewportCenterColumnsForRow(e){if(!this.colSpanActive)return this.viewportColumnsCenter;const t=i=>{const r=i.getLeft();return ve(r)&&r>this.viewportLeft},s=this.isColumnVirtualisationSuppressed()?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedColumnsCenter,s,t)}isColumnAtEdge(e,t){const s=this.getAllDisplayedColumns();if(!s.length)return!1;const i=t==="first";let r;if(e instanceof Ls){const n=e.getDisplayedLeafColumns();if(!n.length)return!1;r=i?n[0]:Mt(n)}else r=e;return(i?s[0]:Mt(s))===r}getAriaColumnIndex(e){let t;return e instanceof Ls?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,s=t+e.getActualWidth(),i=this.viewportLeft-200,r=this.viewportRight+200,n=t<i&&s<i,o=t>r&&s>r;return!n&&!o}getDisplayedColumnsLeftWidth(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}getDisplayedColumnsRightWidth(){return this.getWidthOfColsInList(this.displayedColumnsRight)}updatePrimaryColumnList(e,t,s,i,r,n){if(!e||Pr(e))return;let o=!1;if(e.forEach(l=>{if(!l)return;const u=this.getPrimaryColumn(l);if(u){if(s){if(t.indexOf(u)>=0)return;t.push(u)}else{if(t.indexOf(u)<0)return;Vi(t,u)}i(u),o=!0}}),!o)return;this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(n);const a={type:r,columns:t,column:t.length===1?t[0]:null,source:n};this.eventService.dispatchEvent(a)}setRowGroupColumns(e,t){this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,w.EVENT_COLUMN_ROW_GROUP_CHANGED,!0,this.setRowGroupActive.bind(this),t)}setRowGroupActive(e,t,s){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,s),e&&!this.gos.get("suppressRowGroupHidesColumns")&&this.setColumnsVisible([t],!1,s),!e&&!this.gos.get("suppressMakeColumnVisibleAfterUnGroup")&&this.setColumnsVisible([t],!0,s))}addRowGroupColumns(e,t){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),w.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}removeRowGroupColumns(e,t){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),w.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}addPivotColumns(e,t){this.updatePrimaryColumnList(e,this.pivotColumns,!0,s=>s.setPivotActive(!0,t),w.EVENT_COLUMN_PIVOT_CHANGED,t)}setPivotColumns(e,t){this.setPrimaryColumnList(e,this.pivotColumns,w.EVENT_COLUMN_PIVOT_CHANGED,!0,(s,i)=>{i.setPivotActive(s,t)},t)}removePivotColumns(e,t){this.updatePrimaryColumnList(e,this.pivotColumns,!1,s=>s.setPivotActive(!1,t),w.EVENT_COLUMN_PIVOT_CHANGED,t)}setPrimaryColumnList(e,t,s,i,r,n){if(!this.gridColumns)return;const o=new Map;t.forEach((a,l)=>o.set(a,l)),t.length=0,ve(e)&&e.forEach(a=>{const l=this.getPrimaryColumn(a);l&&t.push(l)}),t.forEach((a,l)=>{const u=o.get(a);if(u===void 0){o.set(a,0);return}i&&u!==l||o.delete(a)}),(this.primaryColumns||[]).forEach(a=>{const l=t.indexOf(a)>=0;r(l,a)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(n),this.dispatchColumnChangedEvent(s,[...o.keys()],n)}setValueColumns(e,t){this.setPrimaryColumnList(e,this.valueColumns,w.EVENT_COLUMN_VALUE_CHANGED,!1,this.setValueActive.bind(this),t)}setValueActive(e,t,s){if(e!==t.isValueActive()&&(t.setValueActive(e,s),e&&!t.getAggFunc()&&this.aggFuncService)){const i=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(i)}}addValueColumns(e,t){this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),w.EVENT_COLUMN_VALUE_CHANGED,t)}removeValueColumns(e,t){this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),w.EVENT_COLUMN_VALUE_CHANGED,t)}normaliseColumnWidth(e,t){const s=e.getMinWidth();ve(s)&&t<s&&(t=s);const i=e.getMaxWidth();return ve(i)&&e.isGreaterThanMax(t)&&(t=i),t}getPrimaryOrGridColumn(e){return this.getPrimaryColumn(e)||this.getGridColumn(e)}setColumnWidths(e,t,s,i){const r=[];e.forEach(n=>{const o=this.getPrimaryOrGridColumn(n.key);if(!o)return;if(r.push({width:n.newWidth,ratios:[1],columns:[o]}),this.gos.get("colResizeDefault")==="shift"&&(t=!t),t){const l=this.getDisplayedColAfter(o);if(!l)return;const u=o.getActualWidth()-n.newWidth,h=l.getActualWidth()+u;r.push({width:h,ratios:[1],columns:[l]})}}),r.length!==0&&this.resizeColumnSets({resizeSets:r,finished:s,source:i})}checkMinAndMaxWidthsForSet(e){const{columns:t,width:s}=e;let i=0,r=0,n=!0;t.forEach(l=>{const u=l.getMinWidth();i+=u||0;const h=l.getMaxWidth();ve(h)&&h>0?r+=h:n=!1});const o=s>=i,a=!n||s<=r;return o&&a}resizeColumnSets(e){const{resizeSets:t,finished:s,source:i}=e;if(!(!t||t.every(h=>this.checkMinAndMaxWidthsForSet(h)))){if(s){const h=t&&t.length>0?t[0].columns:null;this.dispatchColumnResizedEvent(h,s,i)}return}const n=[],o=[];t.forEach(h=>{const{width:p,columns:g,ratios:m}=h,C={},y={};g.forEach(S=>o.push(S));let R=!0,x=0;for(;R;){if(x++,x>1e3){console.error("AG Grid: infinite loop in resizeColumnSets");break}R=!1;const S=[];let T=0,I=p;g.forEach((j,P)=>{if(y[j.getId()])I-=C[j.getId()];else{S.push(j);const _=m[P];T+=_}});const V=1/T;S.forEach((j,P)=>{const N=P===S.length-1;let _;N?_=I:(_=Math.round(m[P]*p*V),I-=_);const L=j.getMinWidth(),M=j.getMaxWidth();ve(L)&&_<L?(_=L,y[j.getId()]=!0,R=!0):ve(M)&&M>0&&_>M&&(_=M,y[j.getId()]=!0,R=!0),C[j.getId()]=_})}g.forEach(S=>{const T=C[S.getId()];S.getActualWidth()!==T&&(S.setActualWidth(T,i),n.push(S))})});const a=n.length>0;let l=[];a&&(l=this.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}),this.setLeftValues(i),this.updateBodyWidths(),this.checkViewportColumns());const u=o.concat(l);(a||s)&&this.dispatchColumnResizedEvent(u,s,i,l)}setColumnAggFunc(e,t,s){if(!e)return;const i=this.getPrimaryColumn(e);i&&(i.setAggFunc(t),this.dispatchColumnChangedEvent(w.EVENT_COLUMN_VALUE_CHANGED,[i],s))}moveRowGroupColumn(e,t,s){if(this.isRowGroupEmpty())return;const i=this.rowGroupColumns[e],r=this.rowGroupColumns.slice(e,t);this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(t,0,i);const n={type:w.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:r,column:r.length===1?r[0]:null,source:s};this.eventService.dispatchEvent(n)}moveColumns(e,t,s,i=!0){if(!this.gridColumns)return;if(this.columnAnimationService.start(),t>this.gridColumns.length-e.length){console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+t),console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");return}const r=this.getGridColumns(e);this.doesMovePassRules(r,t)&&(Ky(this.gridColumns,r,t),this.updateDisplayedColumns(s),this.dispatchColumnMovedEvent({movedColumns:r,source:s,toIndex:t,finished:i}),this.columnAnimationService.finish())}doesMovePassRules(e,t){const s=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(s)}doesOrderPassRules(e){return!(!this.doesMovePassMarryChildren(e)||!this.doesMovePassLockedPositions(e))}getProposedColumnOrder(e,t){const s=this.gridColumns.slice();return Ky(s,e,t),s}sortColumnsLikeGridColumns(e){!e||e.length<=1||e.filter(s=>this.gridColumns.indexOf(s)<0).length>0||e.sort((s,i)=>{const r=this.gridColumns.indexOf(s),n=this.gridColumns.indexOf(i);return r-n})}doesMovePassLockedPositions(e){let t=0,s=!0;const i=r=>r?r===!0||r==="left"?0:2:1;return e.forEach(r=>{const n=i(r.getColDef().lockPosition);n<t&&(s=!1),t=n}),s}doesMovePassMarryChildren(e){let t=!0;return Jn(null,this.gridBalancedTree,s=>{if(!(s instanceof Rs))return;const i=s,r=i.getColGroupDef();if(!(r&&r.marryChildren))return;const o=[];i.getLeafColumns().forEach(p=>{const g=e.indexOf(p);o.push(g)});const a=Math.max.apply(Math,o),l=Math.min.apply(Math,o),u=a-l,h=i.getLeafColumns().length-1;u>h&&(t=!1)}),t}moveColumnByIndex(e,t,s){if(!this.gridColumns)return;const i=this.gridColumns[e];this.moveColumns([i],t,s)}getColumnDefs(){if(!this.primaryColumns)return;const e=this.primaryColumns.slice();return this.gridColsArePrimary?e.sort((t,s)=>this.gridColumns.indexOf(t)-this.gridColumns.indexOf(s)):this.lastPrimaryOrder&&e.sort((t,s)=>this.lastPrimaryOrder.indexOf(t)-this.lastPrimaryOrder.indexOf(s)),this.columnDefFactory.buildColumnDefs(e,this.rowGroupColumns,this.pivotColumns)}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}updateBodyWidths(){const e=this.getWidthOfColsInList(this.displayedColumnsCenter),t=this.getWidthOfColsInList(this.displayedColumnsLeft),s=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==e,this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==s){this.bodyWidth=e,this.leftWidth=t,this.rightWidth=s;const r={type:w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED};this.eventService.dispatchEvent(r);const n={type:w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(n)}}getValueColumns(){return this.valueColumns?this.valueColumns:[]}getPivotColumns(){return this.pivotColumns?this.pivotColumns:[]}isPivotActive(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}getRowGroupColumns(){return this.rowGroupColumns?this.rowGroupColumns:[]}getDisplayedCenterColumns(){return this.displayedColumnsCenter}getDisplayedLeftColumns(){return this.displayedColumnsLeft}getDisplayedRightColumns(){return this.displayedColumnsRight}getAllPrimaryColumns(){return this.primaryColumns?this.primaryColumns:null}getSecondaryColumns(){return this.secondaryColumns?this.secondaryColumns:null}getAllColumnsForQuickFilter(){return this.columnsForQuickFilter}getAllGridColumns(){var e;return(e=this.gridColumns)!=null?e:[]}isRowGroupEmpty(){return Pr(this.rowGroupColumns)}setColumnsVisible(e,t=!1,s){this.applyColumnState({state:e.map(i=>({colId:typeof i=="string"?i:i.getColId(),hide:!t}))},s)}setColumnsPinned(e,t,s){if(!this.gridColumns)return;if(this.gos.isDomLayout("print")){console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");return}this.columnAnimationService.start();let i;t===!0||t==="left"?i="left":t==="right"?i="right":i=null,this.actionOnGridColumns(e,r=>r.getPinned()!==i?(r.setPinned(i),!0):!1,s,()=>({type:w.EVENT_COLUMN_PINNED,pinned:i,column:null,columns:null,source:s})),this.columnAnimationService.finish()}actionOnGridColumns(e,t,s,i){if(Pr(e))return;const r=[];if(e.forEach(n=>{if(!n)return;const o=this.getGridColumn(n);if(!o)return;t(o)!==!1&&r.push(o)}),!!r.length&&(this.updateDisplayedColumns(s),ve(i)&&i)){const n=i();n.columns=r,n.column=r.length===1?r[0]:null,this.eventService.dispatchEvent(n)}}getDisplayedColBefore(e){const t=this.getAllDisplayedColumns(),s=t.indexOf(e);return s>0?t[s-1]:null}getDisplayedColAfter(e){const t=this.getAllDisplayedColumns(),s=t.indexOf(e);return s<t.length-1?t[s+1]:null}getDisplayedGroupAtDirection(e,t){const s=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),i=e.getDisplayedLeafColumns(),r=t==="After"?Mt(i):i[0],n=`getDisplayedCol${t}`;for(;;){const o=this[n](r);if(!o)return null;const a=this.getColumnGroupAtLevel(o,s);if(a!==e)return a}}getColumnGroupAtLevel(e,t){let s=e.getParent(),i,r;for(;i=s.getProvidedColumnGroup().getLevel(),r=s.getPaddingLevel(),!(i+r<=t);)s=s.getParent();return s}isPinningLeft(){return this.displayedColumnsLeft.length>0}isPinningRight(){return this.displayedColumnsRight.length>0}getPrimaryAndSecondaryAndAutoColumns(){return[].concat(this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[])}createStateItemFromColumn(e){const t=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,s=e.isPivotActive()?this.pivotColumns.indexOf(e):null,i=e.isValueActive()?e.getAggFunc():null,r=e.getSort()!=null?e.getSort():null,n=e.getSortIndex()!=null?e.getSortIndex():null,o=e.getFlex()!=null&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:r,sortIndex:n,aggFunc:i,rowGroup:e.isRowGroupActive(),rowGroupIndex:t,pivot:e.isPivotActive(),pivotIndex:s,flex:o}}getColumnState(){if(ot(this.primaryColumns)||!this.isAlive())return[];const t=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(t),t}orderColumnStateList(e){const t=Bo(this.gridColumns.map((s,i)=>[s.getColId(),i]));e.sort((s,i)=>{const r=t.has(s.colId)?t.get(s.colId):-1,n=t.has(i.colId)?t.get(i.colId):-1;return r-n})}resetColumnState(e){if(Pr(this.primaryColumns))return;const t=this.getColumnsFromTree(this.primaryColumnTree),s=[];let i=1e3,r=1e3,n=[];this.groupAutoColumns&&(n=n.concat(this.groupAutoColumns)),t&&(n=n.concat(t)),n.forEach(o=>{const a=this.getColumnStateFromColDef(o);ot(a.rowGroupIndex)&&a.rowGroup&&(a.rowGroupIndex=i++),ot(a.pivotIndex)&&a.pivot&&(a.pivotIndex=r++),s.push(a)}),this.applyColumnState({state:s,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(C,y)=>C??y??null,s=e.getColDef(),i=t(s.sort,s.initialSort),r=t(s.sortIndex,s.initialSortIndex),n=t(s.hide,s.initialHide),o=t(s.pinned,s.initialPinned),a=t(s.width,s.initialWidth),l=t(s.flex,s.initialFlex);let u=t(s.rowGroupIndex,s.initialRowGroupIndex),h=t(s.rowGroup,s.initialRowGroup);u==null&&(h==null||h==!1)&&(u=null,h=null);let p=t(s.pivotIndex,s.initialPivotIndex),g=t(s.pivot,s.initialPivot);p==null&&(g==null||g==!1)&&(p=null,g=null);const m=t(s.aggFunc,s.initialAggFunc);return{colId:e.getColId(),sort:i,sortIndex:r,hide:n,pinned:o,width:a,flex:l,rowGroup:h,rowGroupIndex:u,pivot:g,pivotIndex:p,aggFunc:m}}applyColumnState(e,t){if(Pr(this.primaryColumns))return!1;if(e&&e.state&&!e.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const s=(n,o,a)=>{const l=this.compareColumnStatesAndDispatchEvents(t);this.autoGroupsNeedBuilding=!0;const u=o.slice(),h={},p={},g=[],m=[];let C=0;const y=this.rowGroupColumns.slice(),R=this.pivotColumns.slice();n.forEach(I=>{const V=I.colId||"";if(V.startsWith(Jc)){g.push(I),m.push(I);return}const P=a(V);P?(this.syncColumnWithStateItem(P,I,e.defaultState,h,p,!1,t),Vi(u,P)):(m.push(I),C+=1)});const x=I=>this.syncColumnWithStateItem(I,null,e.defaultState,h,p,!1,t);u.forEach(x);const S=(I,V,j,P)=>{const N=I[j.getId()],_=I[P.getId()],L=N!=null,M=_!=null;if(L&&M)return N-_;if(L)return-1;if(M)return 1;const E=V.indexOf(j),F=V.indexOf(P),J=E>=0,Y=F>=0;return J&&Y?E-F:J?-1:1};this.rowGroupColumns.sort(S.bind(this,h,y)),this.pivotColumns.sort(S.bind(this,p,R)),this.updateGridColumns();const T=this.groupAutoColumns?this.groupAutoColumns.slice():[];return g.forEach(I=>{const V=this.getAutoColumn(I.colId);Vi(T,V),this.syncColumnWithStateItem(V,I,e.defaultState,null,null,!0,t)}),T.forEach(x),this.applyOrderAfterApplyState(e),this.updateDisplayedColumns(t),this.dispatchEverythingChanged(t),l(),{unmatchedAndAutoStates:m,unmatchedCount:C}};this.columnAnimationService.start();let{unmatchedAndAutoStates:i,unmatchedCount:r}=s(e.state||[],this.primaryColumns||[],n=>this.getPrimaryColumn(n));return(i.length>0||ve(e.defaultState))&&(r=s(i,this.secondaryColumns||[],n=>this.getSecondaryColumn(n)).unmatchedCount),this.columnAnimationService.finish(),r===0}applyOrderAfterApplyState(e){if(!e.applyOrder||!e.state)return;let t=[];const s={};e.state.forEach(r=>{if(!r.colId||s[r.colId])return;const n=this.gridColumnsMap[r.colId];n&&(t.push(n),s[r.colId]=!0)});let i=0;if(this.gridColumns.forEach(r=>{const n=r.getColId();if(s[n]!=null)return;n.startsWith(Jc)?ch(t,r,i++):t.push(r)}),t=this.placeLockedColumns(t),!this.doesMovePassMarryChildren(t)){console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.");return}this.gridColumns=t}compareColumnStatesAndDispatchEvents(e){const t={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},s=this.getColumnState(),i={};return s.forEach(r=>{i[r.colId]=r}),()=>{const r=this.getPrimaryAndSecondaryAndAutoColumns(),n=(y,R,x,S)=>{const T=R.map(S),I=x.map(S);if(Fn(T,I))return;const j=new Set(R);x.forEach(_=>{j.delete(_)||j.add(_)});const P=[...j],N={type:y,columns:P,column:P.length===1?P[0]:null,source:e};this.eventService.dispatchEvent(N)},o=y=>{const R=[];return r.forEach(x=>{const S=i[x.getColId()];S&&y(S,x)&&R.push(x)}),R},a=y=>y.getColId();n(w.EVENT_COLUMN_ROW_GROUP_CHANGED,t.rowGroupColumns,this.rowGroupColumns,a),n(w.EVENT_COLUMN_PIVOT_CHANGED,t.pivotColumns,this.pivotColumns,a);const u=o((y,R)=>{const x=y.aggFunc!=null,S=x!=R.isValueActive(),T=x&&y.aggFunc!=R.getAggFunc();return S||T});u.length>0&&this.dispatchColumnChangedEvent(w.EVENT_COLUMN_VALUE_CHANGED,u,e);const h=(y,R)=>y.width!=R.getActualWidth();this.dispatchColumnResizedEvent(o(h),!0,e);const p=(y,R)=>y.pinned!=R.getPinned();this.dispatchColumnPinnedEvent(o(p),e);const g=(y,R)=>y.hide==R.isVisible();this.dispatchColumnVisibleEvent(o(g),e);const C=o((y,R)=>y.sort!=R.getSort()||y.sortIndex!=R.getSortIndex());C.length>0&&this.sortController.dispatchSortChangedEvents(e,C),this.normaliseColumnMovedEventForColumnState(s,e)}}getCommonValue(e,t){if(!e||e.length==0)return;const s=t(e[0]);for(let i=1;i<e.length;i++)if(s!==t(e[i]))return;return s}normaliseColumnMovedEventForColumnState(e,t){const s=this.getColumnState(),i={};s.forEach(l=>i[l.colId]=l);const r={};e.forEach(l=>{i[l.colId]&&(r[l.colId]=!0)});const n=e.filter(l=>r[l.colId]),o=s.filter(l=>r[l.colId]),a=[];o.forEach((l,u)=>{const h=n&&n[u];if(h&&h.colId!==l.colId){const p=this.getGridColumn(h.colId);p&&a.push(p)}}),a.length&&this.dispatchColumnMovedEvent({movedColumns:a,source:t,finished:!0})}syncColumnWithStateItem(e,t,s,i,r,n,o){var a;if(!e)return;const l=(I,V)=>{const j={value1:void 0,value2:void 0};let P=!1;return t&&(t[I]!==void 0&&(j.value1=t[I],P=!0),ve(V)&&t[V]!==void 0&&(j.value2=t[V],P=!0)),!P&&s&&(s[I]!==void 0&&(j.value1=s[I]),ve(V)&&s[V]!==void 0&&(j.value2=s[V])),j},u=l("hide").value1;u!==void 0&&e.setVisible(!u,o);const h=l("pinned").value1;h!==void 0&&e.setPinned(h);const p=(a=e.getColDef().minWidth)!=null?a:this.environment.getMinColWidth(),g=l("flex").value1;if(g!==void 0&&e.setFlex(g),g==null){const I=l("width").value1;I!=null&&p!=null&&I>=p&&e.setActualWidth(I,o)}const m=l("sort").value1;m!==void 0&&(m==="desc"||m==="asc"?e.setSort(m,o):e.setSort(void 0,o));const C=l("sortIndex").value1;if(C!==void 0&&e.setSortIndex(C),n||!e.isPrimary())return;const y=l("aggFunc").value1;y!==void 0&&(typeof y=="string"?(e.setAggFunc(y),e.isValueActive()||(e.setValueActive(!0,o),this.valueColumns.push(e))):(ve(y)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,o),Vi(this.valueColumns,e))));const{value1:R,value2:x}=l("rowGroup","rowGroupIndex");(R!==void 0||x!==void 0)&&(typeof x=="number"||R?(e.isRowGroupActive()||(e.setRowGroupActive(!0,o),this.rowGroupColumns.push(e)),i&&typeof x=="number"&&(i[e.getId()]=x)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,o),Vi(this.rowGroupColumns,e)));const{value1:S,value2:T}=l("pivot","pivotIndex");(S!==void 0||T!==void 0)&&(typeof T=="number"||S?(e.isPivotActive()||(e.setPivotActive(!0,o),this.pivotColumns.push(e)),r&&typeof T=="number"&&(r[e.getId()]=T)):e.isPivotActive()&&(e.setPivotActive(!1,o),Vi(this.pivotColumns,e)))}getGridColumns(e){return this.getColumns(e,this.getGridColumn.bind(this))}getColumns(e,t){const s=[];return e&&e.forEach(i=>{const r=t(i);r&&s.push(r)}),s}getColumnWithValidation(e){if(e==null)return null;const t=this.getGridColumn(e);return t||console.warn("AG Grid: could not find column "+e),t}getPrimaryColumn(e){return this.primaryColumns?this.getColumn(e,this.primaryColumns,this.primaryColumnsMap):null}getGridColumn(e){return this.getColumn(e,this.gridColumns,this.gridColumnsMap)}lookupGridColumn(e){return this.gridColumnsMap[e]}getSecondaryColumn(e){return this.secondaryColumns?this.getColumn(e,this.secondaryColumns,this.secondaryColumnsMap):null}getColumn(e,t,s){if(!e||!s)return null;if(typeof e=="string"&&s[e])return s[e];for(let i=0;i<t.length;i++)if(this.columnsMatch(t[i],e))return t[i];return this.getAutoColumn(e)}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(t===!0)return this.rowGroupColumns.slice(0);const s=this.getPrimaryColumn(t);return s?[s]:null}getAutoColumn(e){return!this.groupAutoColumns||!ve(this.groupAutoColumns)||ot(this.groupAutoColumns)?null:this.groupAutoColumns.find(t=>this.columnsMatch(t,e))||null}columnsMatch(e,t){const s=e===t,i=e.getColDef()===t,r=e.getColId()==t;return s||i||r}getDisplayNameForColumn(e,t,s=!1){if(!e)return null;const i=this.getHeaderName(e.getColDef(),e,null,null,t);return s?this.wrapHeaderNameWithAggFunc(e,i):i}getDisplayNameForProvidedColumnGroup(e,t,s){const i=t?t.getColGroupDef():null;return i?this.getHeaderName(i,null,e,t,s):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,s,i,r){const n=e.headerValueGetter;if(n){const o=this.gos.addGridCommonParams({colDef:e,column:t,columnGroup:s,providedColumnGroup:i,location:r});return typeof n=="function"?n(o):typeof n=="string"?this.expressionService.evaluate(n,o):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}else{if(e.headerName!=null)return e.headerName;if(e.field)return FA(e.field)}return""}wrapHeaderNameWithAggFunc(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const s=e.getColDef().pivotValueColumn,i=ve(s);let r=null,n;if(i){const o=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&this.valueColumns.length===1,a=e.getColDef().pivotTotalColumnIds!==void 0;if(o&&!a)return t;r=s?s.getAggFunc():null,n=!0}else{const o=e.isValueActive(),a=this.pivotMode||!this.isRowGroupEmpty();o&&a?(r=e.getAggFunc(),n=!0):n=!1}if(n){const o=typeof r=="string"?r:"func";return`${this.localeService.getLocaleTextFunc()(o,o)}(${t})`}return t}getColumnGroup(e,t){if(!e)return null;if(e instanceof Ls)return e;const s=this.getAllDisplayedTrees(),i=typeof t=="number";let r=null;return Wa(s,!1,n=>{if(n instanceof Ls){const o=n;let a;i?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(r=o)}}),r}isReady(){return this.ready}extractValueColumns(e,t){this.valueColumns=this.extractColumns(t,this.valueColumns,(s,i)=>s.setValueActive(i,e),()=>{},()=>{},s=>{const i=s.aggFunc;if(i===null||i==="")return null;if(i!==void 0)return!!i},s=>s.initialAggFunc!=null&&s.initialAggFunc!=""),this.valueColumns.forEach(s=>{const i=s.getColDef();i.aggFunc!=null&&i.aggFunc!=""?s.setAggFunc(i.aggFunc):s.getAggFunc()||s.setAggFunc(i.initialAggFunc)})}extractRowGroupColumns(e,t){this.rowGroupColumns=this.extractColumns(t,this.rowGroupColumns,(s,i)=>s.setRowGroupActive(i,e),s=>s.rowGroupIndex,s=>s.initialRowGroupIndex,s=>s.rowGroup,s=>s.initialRowGroup)}extractColumns(e=[],t=[],s,i,r,n,o){const a=[],l=[];(this.primaryColumns||[]).forEach(p=>{const g=e.indexOf(p)<0,m=p.getColDef(),C=wf(n(m)),y=wf(o(m)),R=na(i(m)),x=na(r(m));let S;C!==void 0?S=C:R!==void 0?R===null?S=!1:S=R>=0:g?y!==void 0?S=y:x!==void 0?S=x!=null&&x>=0:S=!1:S=t.indexOf(p)>=0,S&&((g?R!=null||x!=null:R!=null)?a.push(p):l.push(p))});const u=p=>{const g=i(p.getColDef()),m=r(p.getColDef());return g??m};a.sort((p,g)=>{const m=u(p),C=u(g);return m===C?0:m<C?-1:1});const h=[].concat(a);return t.forEach(p=>{l.indexOf(p)>=0&&h.push(p)}),l.forEach(p=>{h.indexOf(p)<0&&h.push(p)}),t.forEach(p=>{h.indexOf(p)<0&&s(p,!1)}),h.forEach(p=>{t.indexOf(p)<0&&s(p,!0)}),h}extractPivotColumns(e,t){this.pivotColumns=this.extractColumns(t,this.pivotColumns,(s,i)=>s.setPivotActive(i,e),s=>s.pivotIndex,s=>s.initialPivotIndex,s=>s.pivot,s=>s.initialPivot)}resetColumnGroupState(e){if(!this.primaryColumnTree)return;const t=[];Jn(null,this.primaryColumnTree,s=>{if(s instanceof Rs){const i=s.getColGroupDef(),r={groupId:s.getGroupId(),open:i?i.openByDefault:void 0};t.push(r)}}),this.setColumnGroupState(t,e)}getColumnGroupState(){const e=[];return Jn(null,this.gridBalancedTree,t=>{t instanceof Rs&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})}),e}setColumnGroupState(e,t){if(!this.gridBalancedTree)return;this.columnAnimationService.start();const s=[];if(e.forEach(i=>{const r=i.groupId,n=i.open,o=this.getProvidedColumnGroup(r);o&&o.isExpanded()!==n&&(this.logger.log("columnGroupOpened("+o.getGroupId()+","+n+")"),o.setExpanded(n),s.push(o))}),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t),s.length){const i={type:w.EVENT_COLUMN_GROUP_OPENED,columnGroup:Rs.length===1?s[0]:void 0,columnGroups:s};this.eventService.dispatchEvent(i)}this.columnAnimationService.finish()}setColumnGroupOpened(e,t,s){let i;e instanceof Rs?i=e.getId():i=e||"",this.setColumnGroupState([{groupId:i,open:t}],s)}getProvidedColumnGroup(e){typeof e!="string"&&console.error("AG Grid: group key must be a string");let t=null;return Jn(null,this.gridBalancedTree,s=>{s instanceof Rs&&s.getId()===e&&(t=s)}),t}calculateColumnsForDisplay(){let e;return this.pivotMode&&ot(this.secondaryColumns)?e=this.gridColumns.filter(t=>{const s=this.groupAutoColumns&&pr(this.groupAutoColumns,t),i=this.valueColumns&&pr(this.valueColumns,t);return s||i}):e=this.gridColumns.filter(t=>this.groupAutoColumns&&pr(this.groupAutoColumns,t)||t.isVisible()),e}checkColSpanActiveInCols(e){let t=!1;return e.forEach(s=>{ve(s.getColDef().colSpan)&&(t=!0)}),t}calculateColumnsForGroupDisplay(){this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};const e=t=>{const s=t.getColDef(),i=s.showRowGroup;s&&ve(i)&&(this.groupDisplayColumns.push(t),typeof i=="string"?this.groupDisplayColumnsMap[i]=t:i===!0&&this.getRowGroupColumns().forEach(r=>{this.groupDisplayColumnsMap[r.getId()]=t}))};this.gridColumns.forEach(e)}getGroupDisplayColumns(){return this.groupDisplayColumns}getGroupDisplayColumnForGroup(e){return this.groupDisplayColumnsMap[e]}updateDisplayedColumns(e){const t=this.calculateColumnsForDisplay();this.buildDisplayedTrees(t),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)}isSecondaryColumnsPresent(){return ve(this.secondaryColumns)}setSecondaryColumns(e,t){if(!this.gridColumns)return;const s=e;if(!(!s&&ot(this.secondaryColumns))){if(s){this.processSecondaryColumnDefinitions(e);const i=this.columnFactory.createColumnTree(e,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0,t);this.destroyOldColumns(this.secondaryBalancedTree,i.columnTree),this.secondaryBalancedTree=i.columnTree,this.secondaryHeaderRowCount=i.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(r=>this.secondaryColumnsMap[r.getId()]=r),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(t)}}processSecondaryColumnDefinitions(e){const t=this.gos.get("processPivotResultColDef"),s=this.gos.get("processPivotResultColGroupDef");if(!t&&!s)return;const i=r=>{r.forEach(n=>{if(ve(n.children)){const a=n;s&&s(a),i(a.children)}else t&&t(n)})};e&&i(e)}updateGridColumns(){const e=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.createGroupAutoColumnsIfNeeded()){const i=Bo(this.groupAutoColumns.map(r=>[r,!0]));this.lastPrimaryOrder&&(this.lastPrimaryOrder=this.lastPrimaryOrder.filter(r=>!i.has(r)),this.lastPrimaryOrder=[...this.groupAutoColumns,...this.lastPrimaryOrder]),this.lastSecondaryOrder&&(this.lastSecondaryOrder=this.lastSecondaryOrder.filter(r=>!i.has(r)),this.lastSecondaryOrder=[...this.groupAutoColumns,...this.lastSecondaryOrder])}let s;if(this.secondaryColumns&&this.secondaryBalancedTree){const i=this.secondaryColumns.some(r=>this.gridColumnsMap[r.getColId()]!==void 0);this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,i&&(s=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,s=this.lastPrimaryOrder);if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(s),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(i=>this.gridColumnsMap[i.getId()]=i),this.setAutoHeightActive(),!Fn(e,this.gridBalancedTree)){const i={type:w.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(i)}}setAutoHeightActive(){this.autoHeightActive=this.gridColumns.filter(e=>e.isAutoHeight()).length>0,this.autoHeightActive&&(this.autoHeightActiveAtLeastOnce=!0,this.gos.isRowModelType("clientSide")||this.gos.isRowModelType("serverSide")||tt("autoHeight columns only work with Client Side Row Model and Server Side Row Model."))}orderGridColsLike(e){if(ot(e))return;const t=Bo(e.map((l,u)=>[l,u]));let s=!0;if(this.gridColumns.forEach(l=>{t.has(l)&&(s=!1)}),s)return;const i=Bo(this.gridColumns.map(l=>[l,!0])),r=e.filter(l=>i.has(l)),n=Bo(r.map(l=>[l,!0])),o=this.gridColumns.filter(l=>!n.has(l)),a=r.slice();o.forEach(l=>{let u=l.getOriginalParent();if(!u){a.push(l);return}const h=[];for(;!h.length&&u;)u.getLeafColumns().forEach(C=>{const y=a.indexOf(C)>=0,R=h.indexOf(C)<0;y&&R&&h.push(C)}),u=u.getOriginalParent();if(!h.length){a.push(l);return}const p=h.map(m=>a.indexOf(m)),g=Math.max(...p);ch(a,l,g+1)}),this.gridColumns=a}isPrimaryColumnGroupsPresent(){return this.primaryHeaderRowCount>1}refreshQuickFilterColumns(){var e;let t=(e=this.isPivotMode()&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?this.secondaryColumns:this.primaryColumns)!=null?e:[];this.groupAutoColumns&&(t=t.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?t:t.filter(s=>s.isVisible()||s.isRowGroupActive())}placeLockedColumns(e){const t=[],s=[],i=[];return e.forEach(r=>{const n=r.getColDef().lockPosition;n==="right"?i.push(r):n==="left"||n===!0?t.push(r):s.push(r)}),[...t,...s,...i]}addAutoGroupToGridColumns(){if(ot(this.groupAutoColumns)){this.destroyOldColumns(this.groupAutoColsBalancedTree),this.groupAutoColsBalancedTree=null;return}this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;const e=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,e),this.groupAutoColsBalancedTree=e,this.gridBalancedTree=e.concat(this.gridBalancedTree)}clearDisplayedAndViewportColumns(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.ariaOrderColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}updateGroupsAndDisplayedColumns(e){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(e),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();const t={type:w.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}deriveDisplayedColumns(e){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinColumnsAriaOrder(),this.joinDisplayedColumns(),this.setLeftValues(e),this.displayedAutoHeightCols=this.displayedColumns.filter(t=>t.isAutoHeight())}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}joinColumnsAriaOrder(){const e=this.getAllGridColumns(),t=[],s=[],i=[];for(const r of e){const n=r.getPinned();n?n===!0||n==="left"?t.push(r):i.push(r):s.push(r)}this.ariaOrderColumns=t.concat(s).concat(i)}joinDisplayedColumns(){this.gos.get("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}setLeftValues(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()}setLeftValuesOfColumns(e){if(!this.primaryColumns)return;const t=this.getPrimaryAndSecondaryAndAutoColumns().slice(0),s=this.gos.get("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(i=>{if(s){let r=this.getWidthOfColsInList(i);i.forEach(n=>{r-=n.getActualWidth(),n.setLeft(r,e)})}else{let r=0;i.forEach(n=>{n.setLeft(r,e),r+=n.getActualWidth()})}wA(t,i)}),t.forEach(i=>{i.setLeft(null,e)})}setLeftValuesOfGroups(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(e=>{e.forEach(t=>{t instanceof Ls&&t.checkLeft()})})}derivedDisplayedColumnsFromDisplayedTree(e,t){t.length=0,Wa(e,!0,s=>{s instanceof Kt&&t.push(s)})}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}extractViewportColumns(){this.isColumnVirtualisationSuppressed()?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}getVirtualHeaderGroupRow(e,t){let s;switch(e){case"left":s=this.viewportRowLeft[t];break;case"right":s=this.viewportRowRight[t];break;default:s=this.viewportRowCenter[t];break}return ot(s)&&(s=[]),s}calculateHeaderRows(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};const e={};this.headerViewportColumns.forEach(s=>e[s.getId()]=!0);const t=(s,i,r)=>{let n=!1;for(let o=0;o<s.length;o++){const a=s[o];let l=!1;if(a instanceof Kt)l=e[a.getId()]===!0;else{const h=a.getDisplayedChildren();h&&(l=t(h,i,r+1))}l&&(n=!0,i[r]||(i[r]=[]),i[r].push(a))}return n};t(this.displayedTreeLeft,this.viewportRowLeft,0),t(this.displayedTreeRight,this.viewportRowRight,0),t(this.displayedTreeCentre,this.viewportRowCenter,0)}extractViewport(){const e=i=>`${i.getId()}-${i.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.viewportColumns.map(e).join("#"),s=this.viewportColumnsHash!==t;return s&&(this.viewportColumnsHash=t,this.calculateHeaderRows()),s}refreshFlexedColumns(e={}){var t;const s=e.source?e.source:"flex";if(e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];let i=-1;if(e.resizingCols){const g=new Set(e.resizingCols);let m=this.displayedColumnsCenter;for(let C=m.length-1;C>=0;C--)if(g.has(m[C])){i=C;break}}let r=0,n=[],o=0,a=0;for(let g=0;g<this.displayedColumnsCenter.length;g++)this.displayedColumnsCenter[g].getFlex()&&g>i?(n.push(this.displayedColumnsCenter[g]),a+=this.displayedColumnsCenter[g].getFlex(),o+=(t=this.displayedColumnsCenter[g].getMinWidth())!=null?t:0):r+=this.displayedColumnsCenter[g].getActualWidth();if(!n.length)return[];let l=[];r+o>this.flexViewportWidth&&(n.forEach(g=>{var m;return g.setActualWidth((m=g.getMinWidth())!=null?m:0,s)}),l=n,n=[]);const u=[];let h;e:for(;;){h=this.flexViewportWidth-r;const g=h/a;for(let m=0;m<n.length;m++){const C=n[m],y=g*C.getFlex();let R=0;const x=C.getMinWidth(),S=C.getMaxWidth();if(ve(x)&&y<x?R=x:ve(S)&&y>S&&(R=S),R){C.setActualWidth(R,s),ZS(n,C),a-=C.getFlex(),l.push(C),r+=C.getActualWidth();continue e}u[m]=Math.round(y)}break}let p=h;return n.forEach((g,m)=>{g.setActualWidth(Math.min(u[m],p),s),l.push(g),p-=u[m]}),e.skipSetLeft||this.setLeftValues(s),e.updateBodyWidths&&this.updateBodyWidths(),e.fireResizedEvent&&this.dispatchColumnResizedEvent(l,!0,s,n),n}sizeColumnsToFit(e,t="sizeColumnsToFit",s,i){var r,n,o,a,l;if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.sizeColumnsToFit(e,t,s,i));return}const u={};i&&((r=i==null?void 0:i.columnLimits)==null||r.forEach(x=>{var S=x,{key:T}=S,I=w1(S,["key"]);u[typeof T=="string"?T:T.getColId()]=I}));const h=this.getAllDisplayedColumns(),p=e===this.getWidthOfColsInList(h);if(e<=0||!h.length||p)return;const g=[],m=[];h.forEach(x=>{x.getColDef().suppressSizeToFit===!0?m.push(x):g.push(x)});const C=g.slice(0);let y=!1;const R=x=>{Vi(g,x),m.push(x)};for(g.forEach(x=>{var S,T;x.resetActualWidth(t);const I=u==null?void 0:u[x.getId()],V=(S=I==null?void 0:I.minWidth)!=null?S:i==null?void 0:i.defaultMinWidth,j=(T=I==null?void 0:I.maxWidth)!=null?T:i==null?void 0:i.defaultMaxWidth,P=x.getActualWidth();typeof V=="number"&&P<V?x.setActualWidth(V,t,!0):typeof j=="number"&&P>j&&x.setActualWidth(j,t,!0)});!y;){y=!0;const x=e-this.getWidthOfColsInList(m);if(x<=0)g.forEach(S=>{var T,I;const V=(I=(T=u==null?void 0:u[S.getId()])==null?void 0:T.minWidth)!=null?I:i==null?void 0:i.defaultMinWidth;if(typeof V=="number"){S.setActualWidth(V,t,!0);return}S.setMinimum(t)});else{const S=x/this.getWidthOfColsInList(g);let T=x;for(let I=g.length-1;I>=0;I--){const V=g[I],j=u==null?void 0:u[V.getId()],P=(n=j==null?void 0:j.minWidth)!=null?n:i==null?void 0:i.defaultMinWidth,N=(o=j==null?void 0:j.maxWidth)!=null?o:i==null?void 0:i.defaultMaxWidth,_=(a=V.getMinWidth())!=null?a:0,L=(l=V.getMaxWidth())!=null?l:Number.MAX_VALUE,M=typeof P=="number"&&P>_?P:V.getMinWidth(),E=typeof N=="number"&&N<L?N:V.getMaxWidth();let F=Math.round(V.getActualWidth()*S);ve(M)&&F<M?(F=M,R(V),y=!1):ve(E)&&F>E?(F=E,R(V),y=!1):I===0&&(F=T),V.setActualWidth(F,t,!0),T-=F}}}C.forEach(x=>{x.fireColumnWidthChangedEvent(t)}),this.setLeftValues(t),this.updateBodyWidths(),!s&&this.dispatchColumnResizedEvent(C,!0,t)}buildDisplayedTrees(e){const t=[],s=[],i=[];e.forEach(n=>{switch(n.getPinned()){case"left":t.push(n);break;case"right":s.push(n);break;default:i.push(n);break}});const r=new PA;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(t,r,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(s,r,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(i,r,null,this.displayedTreeCentre),this.updateDisplayedMap()}updateDisplayedMap(){this.displayedColumnsAndGroupsMap={};const e=t=>{this.displayedColumnsAndGroupsMap[t.getUniqueId()]=t};Wa(this.displayedTreeCentre,!1,e),Wa(this.displayedTreeLeft,!1,e),Wa(this.displayedTreeRight,!1,e)}isDisplayed(e){return this.displayedColumnsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){const e=this.getAllDisplayedTrees();Wa(e,!1,t=>{t instanceof Ls&&t.calculateDisplayedColumns()})}getGroupAutoColumns(){return this.groupAutoColumns}createGroupAutoColumnsIfNeeded(){const e=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;const t=this.gos.isGroupUseEntireRow(this.pivotMode),s=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.gos.get("treeData"))&&!s&&!t){const n=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);if(!this.autoColsEqual(n,this.groupAutoColumns)||e)return this.groupAutoColumns=n,!0}else this.groupAutoColumns=null;return!1}isGroupSuppressAutoColumn(){return this.gos.get("groupDisplayType")==="custom"?!0:this.gos.get("treeDataDisplayType")==="custom"}autoColsEqual(e,t){return Fn(e,t,(s,i)=>s.getColId()===i.getColId())}getWidthOfColsInList(e){return e.reduce((t,s)=>t+s.getActualWidth(),0)}getFirstDisplayedColumn(){const e=this.gos.get("enableRtl"),t=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];e&&t.reverse();for(let s=0;s<t.length;s++){const i=this[t[s]]();if(i.length)return e?Mt(i):i[0]}return null}setColumnHeaderHeight(e,t){if(e.setAutoHeaderHeight(t)){const i={type:w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(i)}}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.getAllDisplayedColumns().filter(s=>s.isAutoHeaderHeight()).map(s=>s.getAutoHeaderHeight()||0);return Math.max(e,...t)}getHeaderHeight(){var e;return(e=this.gos.get("headerHeight"))!=null?e:this.environment.getFromTheme(25,"headerHeight")}getFloatingFiltersHeight(){var e;return(e=this.gos.get("floatingFiltersHeight"))!=null?e:this.getHeaderHeight()}getGroupHeaderHeight(){var e;return(e=this.gos.get("groupHeaderHeight"))!=null?e:this.getHeaderHeight()}getPivotHeaderHeight(){var e;return(e=this.gos.get("pivotHeaderHeight"))!=null?e:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var e;return(e=this.gos.get("pivotGroupHeaderHeight"))!=null?e:this.getGroupHeaderHeight()}queueResizeOperations(){this.shouldQueueResizeOperations=!0}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}resetColumnDefIntoColumn(e,t){const s=e.getUserProvidedColDef();if(!s)return!1;const i=this.columnFactory.addColumnDefaultAndTypes(s,e.getColId());return e.setColDef(i,s,t),!0}isColumnGroupingLocked(e){const t=this.gos.get("groupLockGroupColumns");if(!e.isRowGroupActive()||t===0)return!1;if(t===-1)return!0;const s=this.rowGroupColumns.findIndex(i=>i.getColId()===e.getColId());return t>s}generateColumnStateForRowGroupAndPivotIndexes(e,t){let s={};const i=(r,n,o,a,l,u)=>{if(!n.length||!this.primaryColumns)return[];const h=Object.keys(r),p=new Set(h),g=new Set(h),m=new Set(n.map(V=>{const j=V.getColId();return g.delete(j),j}).concat(h)),C=[],y={};let R=0;for(let V=0;V<this.primaryColumns.length;V++){const j=this.primaryColumns[V].getColId();m.has(j)&&(C.push(j),y[j]=R++)}let x=1e3,S=!1,T=0;const I=V=>{const j=y[V];for(let P=T;P<j;P++){const N=C[P];g.has(N)&&(r[N][l]=x++,g.delete(N))}T=j};n.forEach(V=>{const j=V.getColId();if(p.has(j))I(j),r[j][l]=x++;else{const P=V.getColDef();(P[l]===null||P[l]===void 0&&P[u]==null)&&(S||(P[o]||P[o]===void 0&&P[a]?I(j):(g.forEach(L=>{r[L][l]=x+y[L]}),x+=C.length,S=!0)),s[j]||(s[j]={colId:j}),s[j][l]=x++)}})};return i(e,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(s)}onColumnsReady(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout(()=>{if(t==="fitGridWidth"){const{columnLimits:s,defaultMinWidth:i,defaultMaxWidth:r}=e,n=s==null?void 0:s.map(({colId:o,minWidth:a,maxWidth:l})=>({key:o,minWidth:a,maxWidth:l}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:i,defaultMaxWidth:r,columnLimits:n})}else t==="fitProvidedWidth"&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")})}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if((e==null?void 0:e.type)!=="fitCellContents")return;const{colIds:t,skipHeader:s}=e;setTimeout(()=>{t?this.autoSizeColumns({columns:t,skipHeader:s,source:"autosizeColumns"}):this.autoSizeAllColumns("autosizeColumns",s)})}};f([A("expressionService")],Us.prototype,"expressionService",2);f([A("columnFactory")],Us.prototype,"columnFactory",2);f([A("displayedGroupCreator")],Us.prototype,"displayedGroupCreator",2);f([A("ctrlsService")],Us.prototype,"ctrlsService",2);f([A("autoWidthCalculator")],Us.prototype,"autoWidthCalculator",2);f([A("columnAnimationService")],Us.prototype,"columnAnimationService",2);f([A("autoGroupColService")],Us.prototype,"autoGroupColService",2);f([A("valueCache")],Us.prototype,"valueCache",2);f([A("animationFrameService")],Us.prototype,"animationFrameService",2);f([A("sortController")],Us.prototype,"sortController",2);f([A("columnDefFactory")],Us.prototype,"columnDefFactory",2);f([zt("aggFuncService")],Us.prototype,"aggFuncService",2);f([xe],Us.prototype,"init",1);f([Fi],Us.prototype,"destroyColumns",1);f([rn(0,Fr("loggerFactory"))],Us.prototype,"setBeans",1);Us=f([Le("columnModel")],Us);function xc(e){return e==="gridOptionsUpdated"?"gridOptionsChanged":e}function Wa(e,t,s){if(e)for(let i=0;i<e.length;i++){const r=e[i];if(r instanceof Ls){const n=t?r.getDisplayedChildren():r.getChildren();Wa(n,t,s)}s(r)}}var qy=class extends Se{createDisplayedGroups(e,t,s,i){const r=this.mapOldGroupsById(i),n=[];let o=e;for(;o.length;){const a=o;o=[];let l=0;const u=h=>{const p=l;l=h;const g=a[p],C=(g instanceof Ls?g.getProvidedColumnGroup():g).getOriginalParent();if(C==null){for(let R=p;R<h;R++)n.push(a[R]);return}const y=this.createColumnGroup(C,t,r,s);for(let R=p;R<h;R++)y.addChild(a[R]);o.push(y)};for(let h=1;h<a.length;h++){const p=a[h],m=(p instanceof Ls?p.getProvidedColumnGroup():p).getOriginalParent(),C=a[l],R=(C instanceof Ls?C.getProvidedColumnGroup():C).getOriginalParent();m!==R&&u(h)}l<a.length&&u(a.length)}return this.setupParentsIntoColumns(n,null),n}createColumnGroup(e,t,s,i){const r=e.getGroupId(),n=t.getInstanceIdForKey(r),o=Ls.createUniqueId(r,n);let a=s[o];return a&&a.getProvidedColumnGroup()!==e&&(a=null),ve(a)?a.reset():(a=new Ls(e,r,n,i),this.context.createBean(a)),a}mapOldGroupsById(e){const t={},s=i=>{i.forEach(r=>{if(r instanceof Ls){const n=r;t[r.getUniqueId()]=n,s(n.getChildren())}})};return e&&s(e),t}setupParentsIntoColumns(e,t){e.forEach(s=>{if(s.setParent(t),s instanceof Ls){const i=s;this.setupParentsIntoColumns(i.getChildren(),i)}})}};qy=f([Le("displayedGroupCreator")],qy);var H1={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,excludeHiddenColumnsFromQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,enableChartToolPanelsButton:!0,suppressChartToolPanelsButton:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressParentsInRowNodes:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,suppressAggAtRootLevel:!0,removePivotHeaderRowWhenSingleValueColumn:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,functionsPassive:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0},Ns=class{};Ns.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"];Ns.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy"];Ns.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"];Ns.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"];Ns.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilterAllLevels","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval"];Ns.OTHER_PROPERTIES=["suppressStickyTotalRow"];Ns.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher"];Ns.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"];Ns.FUNCTION_PROPERTIES=[...Ns.FUNCTIONAL_PROPERTIES,...Ns.CALLBACK_PROPERTIES];Ns.ALL_PROPERTIES=[...Ns.ARRAY_PROPERTIES,...Ns.OBJECT_PROPERTIES,...Ns.STRING_PROPERTIES,...Ns.NUMBER_PROPERTIES,...Ns.FUNCTION_PROPERTIES,...Ns.BOOLEAN_PROPERTIES,...Ns.OTHER_PROPERTIES];var hh=Ns,ei=class Pg{static getCallbackForEvent(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substring(1)}static getGridOptionKeys(){return this.ALL_PROPERTIES_AND_CALLBACKS}static combineAttributesAndGridOptions(t,s){typeof t!="object"&&(t={});const i=Xe({},t);return Pg.getGridOptionKeys().forEach(n=>{const o=s[n];typeof o<"u"&&o!==Pg.VUE_OMITTED_PROPERTY&&(i[n]=o)}),i}static processOnChange(t,s,i){if(!t)return;const r={};let n=!1;if(Object.keys(t).filter(a=>Pg.ALL_PROPERTIES_AND_CALLBACKS_SET.has(a)).forEach(a=>{r[a]=t[a],n=!0}),!n)return;s.__internalUpdateGridOptions(r,!0);const o={type:w.EVENT_COMPONENT_STATE_CHANGED};ui(r,(a,l)=>{o[a]=l}),s.dispatchEvent(o)}};ei.EVENTS=pl(w);ei.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY";ei.EXCLUDED_INTERNAL_EVENTS=[w.EVENT_SCROLLBAR_WIDTH_CHANGED,w.EVENT_CHECKBOX_CHANGED,w.EVENT_HEIGHT_SCALE_CHANGED,w.EVENT_BODY_HEIGHT_CHANGED,w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,w.EVENT_SCROLL_VISIBILITY_CHANGED,w.EVENT_COLUMN_HOVER_CHANGED,w.EVENT_FLASH_CELLS,w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,w.EVENT_DISPLAYED_ROWS_CHANGED,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,w.EVENT_STORE_UPDATED,w.EVENT_COLUMN_PANEL_ITEM_DRAG_START,w.EVENT_COLUMN_PANEL_ITEM_DRAG_END,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,w.EVENT_FULL_WIDTH_ROW_FOCUSED,w.EVENT_HEADER_HEIGHT_CHANGED,w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,w.EVENT_CELL_FOCUS_CLEARED,w.EVENT_GRID_STYLES_CHANGED,w.EVENT_FILTER_DESTROYED,w.EVENT_ROW_DATA_UPDATE_STARTED,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,w.EVENT_DATA_TYPES_INFERRED,w.EVENT_FIELD_VALUE_CHANGED,w.EVENT_FIELD_PICKER_VALUE_SELECTED,w.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,w.EVENT_SUPPRESS_MENU_HIDE_CHANGED,w.EVENT_SUPPRESS_FIELD_DOT_NOTATION,w.EVENT_ROW_COUNT_READY,w.EVENT_SIDE_BAR_UPDATED];ei.PUBLIC_EVENTS=ei.EVENTS.filter(e=>!pr(ei.EXCLUDED_INTERNAL_EVENTS,e));ei.EVENT_CALLBACKS=ei.EVENTS.map(e=>ei.getCallbackForEvent(e));ei.BOOLEAN_PROPERTIES=hh.BOOLEAN_PROPERTIES;ei.ALL_PROPERTIES=hh.ALL_PROPERTIES;ei.ALL_PROPERTIES_AND_CALLBACKS=[...ei.ALL_PROPERTIES,...ei.EVENT_CALLBACKS];ei.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(ei.ALL_PROPERTIES_AND_CALLBACKS);var Rf=ei,Qy=class extends Se{constructor(){super(...arguments),this.componentsMappedByName={}}setupComponents(e){e&&e.forEach(t=>this.addComponent(t))}addComponent(e){const s=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[s]=e.componentClass}getComponentClass(e){return this.componentsMappedByName[e]}};Qy=f([Le("agStackComponentsRegistry")],Qy);var _A={};$s(_A,{getAriaCheckboxStateName:()=>Bm,getAriaLabel:()=>OA,getAriaLevel:()=>j1,getAriaPosInSet:()=>LA,getAriaSortState:()=>MA,removeAriaExpanded:()=>HA,removeAriaSort:()=>KA,setAriaActiveDescendant:()=>s0,setAriaAtomic:()=>GA,setAriaChecked:()=>z1,setAriaColCount:()=>zA,setAriaColIndex:()=>r0,setAriaColSpan:()=>UA,setAriaControls:()=>n0,setAriaDescribedBy:()=>W1,setAriaDisabled:()=>t0,setAriaExpanded:()=>co,setAriaHidden:()=>hp,setAriaLabel:()=>fr,setAriaLabelledBy:()=>Xc,setAriaLevel:()=>BA,setAriaLive:()=>e0,setAriaMultiSelectable:()=>jA,setAriaPosInSet:()=>Vm,setAriaRelevant:()=>VA,setAriaRole:()=>fs,setAriaRowCount:()=>WA,setAriaRowIndex:()=>i0,setAriaSelected:()=>eu,setAriaSetSize:()=>Gm,setAriaSort:()=>$A});function Br(e,t,s){s==null||typeof s=="string"&&s==""?XS(e,t):Hr(e,t,s)}function Hr(e,t,s){e.setAttribute(kA(t),s.toString())}function XS(e,t){e.removeAttribute(kA(t))}function kA(e){return`aria-${e}`}function fs(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function MA(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function j1(e){return parseInt(e.getAttribute("aria-level"),10)}function LA(e){return parseInt(e.getAttribute("aria-posinset"),10)}function OA(e){return e.getAttribute("aria-label")}function fr(e,t){Br(e,"label",t)}function Xc(e,t){Br(e,"labelledby",t)}function W1(e,t){Br(e,"describedby",t)}function e0(e,t){Br(e,"live",t)}function GA(e,t){Br(e,"atomic",t)}function VA(e,t){Br(e,"relevant",t)}function BA(e,t){Br(e,"level",t)}function t0(e,t){Br(e,"disabled",t)}function hp(e,t){Br(e,"hidden",t)}function s0(e,t){Br(e,"activedescendant",t)}function co(e,t){Hr(e,"expanded",t)}function HA(e){XS(e,"expanded")}function Gm(e,t){Hr(e,"setsize",t)}function Vm(e,t){Hr(e,"posinset",t)}function jA(e,t){Hr(e,"multiselectable",t)}function WA(e,t){Hr(e,"rowcount",t)}function i0(e,t){Hr(e,"rowindex",t)}function zA(e,t){Hr(e,"colcount",t)}function r0(e,t){Hr(e,"colindex",t)}function UA(e,t){Hr(e,"colspan",t)}function $A(e,t){Hr(e,"sort",t)}function KA(e){XS(e,"sort")}function eu(e,t){Br(e,"selected",t)}function z1(e,t){Hr(e,"checked",t===void 0?"mixed":t)}function n0(e,t){Br(e,"controls",t.id),Xc(t,e.id)}function Bm(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var YA={};$s(YA,{browserSupportsPreventScroll:()=>c0,getBodyHeight:()=>ZA,getBodyWidth:()=>QA,getMaxDivHeight:()=>qA,getSafariVersion:()=>o0,getScrollbarWidth:()=>JA,getTabIndex:()=>Tf,isBrowserChrome:()=>Hm,isBrowserFirefox:()=>a0,isBrowserSafari:()=>Gn,isIOSUserAgent:()=>yo,isInvisibleScrollbar:()=>u0,isMacOsUserAgent:()=>l0});var aC,ng,lC,cC,uC,dC,Zy,Jy;function Gn(){return aC===void 0&&(aC=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),aC}function o0(){if(ng===void 0)if(Gn()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(ng=e[1]!=null?parseFloat(e[1]):0)}else ng=0;return ng}function Hm(){if(lC===void 0){const e=window;lC=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return lC}function a0(){return cC===void 0&&(cC=/(firefox)/i.test(navigator.userAgent)),cC}function l0(){return uC===void 0&&(uC=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),uC}function yo(){return dC===void 0&&(dC=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),dC}function c0(){return!Gn()||o0()>=15}function Tf(e){if(!e)return null;const t=e.tabIndex,s=e.getAttribute("tabIndex");return t===-1&&(s===null||s===""&&!a0())?null:t.toString()}function qA(){if(!document.body)return-1;let e=1e6;const t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,s=document.createElement("div");for(document.body.appendChild(s);;){const i=e*2;if(s.style.height=i+"px",i>t||s.clientHeight!==i)break;e=i}return document.body.removeChild(s),e}function QA(){var e,t,s;return(s=(e=document.body)==null?void 0:e.clientWidth)!=null?s:window.innerHeight||((t=document.documentElement)==null?void 0:t.clientWidth)||-1}function ZA(){var e,t,s;return(s=(e=document.body)==null?void 0:e.clientHeight)!=null?s:window.innerHeight||((t=document.documentElement)==null?void 0:t.clientHeight)||-1}function JA(){return Jy==null&&XA(),Jy}function XA(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let s=t.offsetWidth-t.clientWidth;s===0&&t.clientWidth===0&&(s=null),t.parentNode&&t.parentNode.removeChild(t),s!=null&&(Jy=s,Zy=s===0)}function u0(){return Zy==null&&XA(),Zy}var eF={};$s(eF,{dateToFormattedString:()=>_c,parseDateTimeFromString:()=>Ui,serialiseDate:()=>_r});var tF={};$s(tF,{cleanNumber:()=>U1,createArrayOfNumbers:()=>sF,decToHex:()=>$1,formatNumberCommas:()=>d0,formatNumberTwoDecimalPlacesAndCommas:()=>K1,padStartWidthZeros:()=>Ic,sum:()=>Y1});function Ic(e,t){return e.toString().padStart(t,"0")}function sF(e,t){const s=[];for(let i=e;i<=t;i++)s.push(i);return s}function U1(e){return typeof e=="string"&&(e=parseInt(e,10)),typeof e=="number"?Math.floor(e):null}function $1(e,t){let s="";for(let i=0;i<t;i++)s+=String.fromCharCode(e&255),e>>>=8;return s}function K1(e,t,s){return typeof e!="number"?"":d0(Math.round(e*100)/100,t,s)}function d0(e,t,s){return typeof e!="number"?"":e.toString().replace(".",s).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${t}`)}function Y1(e){return e==null?null:e.reduce((t,s)=>t+s,0)}function _r(e,t=!0,s="-"){if(!e)return null;let i=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(r=>Ic(r,2)).join(s);return t&&(i+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(r=>Ic(r,2)).join(":")),i}var hC=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function _c(e,t="YYYY-MM-DD"){const s=Ic(e.getFullYear(),4),i=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={YYYY:()=>s.slice(s.length-4,s.length),YY:()=>s.slice(s.length-2,s.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>i[e.getMonth()],MMM:()=>i[e.getMonth()].slice(0,3),MM:()=>Ic(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${hC(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${hC(e.getDate())}`,DD:()=>Ic(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>r[e.getDay()],ddd:()=>r[e.getDay()].slice(0,3),dd:()=>r[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${hC(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(n).join("|"),"g");return t.replace(o,a=>a in n?n[a]():a)}function Ui(e){if(!e)return null;const[t,s]=e.split(" ");if(!t)return null;const i=t.split("-").map(p=>parseInt(p,10));if(i.filter(p=>!isNaN(p)).length!==3)return null;const[r,n,o]=i,a=new Date(r,n-1,o);if(a.getFullYear()!==r||a.getMonth()!==n-1||a.getDate()!==o)return null;if(!s||s==="00:00:00")return a;const[l,u,h]=s.split(":").map(p=>parseInt(p,10));return l>=0&&l<24&&a.setHours(l),u>=0&&u<60&&a.setMinutes(u),h>=0&&h<60&&a.setSeconds(h),a}var iF={};$s(iF,{FOCUSABLE_EXCLUDE:()=>h0,FOCUSABLE_SELECTOR:()=>rF,addOrRemoveAttribute:()=>Ln,addStylesToElement:()=>y0,bindCellRendererToHtmlElement:()=>S0,clearElement:()=>xs,copyNodeList:()=>cF,ensureDomOrder:()=>v0,formatSize:()=>jm,getAbsoluteHeight:()=>g0,getAbsoluteWidth:()=>ph,getElementRectWithOffset:()=>f0,getElementSize:()=>ba,getInnerHeight:()=>pp,getInnerWidth:()=>Hl,getScrollLeft:()=>fh,insertWithDomOrder:()=>oF,isElementChildOfClass:()=>gl,isFocusableFormField:()=>p0,isHorizontalScrollShowing:()=>aF,isInDOM:()=>m0,isNodeOrElement:()=>gp,isRtlNegativeScroll:()=>gh,isVerticalScrollShowing:()=>lF,isVisible:()=>Zi,iterateNamedNodeMap:()=>uF,loadTemplate:()=>$i,nodeListForEach:()=>w0,radioCssClass:()=>Xy,removeFromParent:()=>nn,setDisabled:()=>tu,setDisplayed:()=>Dt,setDomChildOrder:()=>C0,setElementHeight:()=>q1,setElementWidth:()=>vh,setFixedHeight:()=>fl,setFixedWidth:()=>kr,setScrollLeft:()=>mh,setVisible:()=>nF});var og;function Xy(e,t,s){const i=e.parentElement;let r=i&&i.firstChild;for(;r;)t&&r.classList.toggle(t,r===e),s&&r.classList.toggle(s,r!==e),r=r.nextSibling}var rF="[tabindex], input, select, button, textarea, [href]",h0="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function p0(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),r=t.call(e,h0),n=Zi(e);return i&&!r&&n}function Dt(e,t,s={}){const{skipAriaHidden:i}=s;e.classList.toggle("ag-hidden",!t),i||hp(e,!t)}function nF(e,t,s={}){const{skipAriaHidden:i}=s;e.classList.toggle("ag-invisible",!t),i||hp(e,!t)}function tu(e,t){const s="disabled",i=t?r=>r.setAttribute(s,""):r=>r.removeAttribute(s);i(e),w0(e.querySelectorAll("input"),r=>i(r))}function gl(e,t,s){let i=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof s=="number"){if(++i>s)break}else if(e===s)break}return!1}function ba(e){const{height:t,width:s,borderTopWidth:i,borderRightWidth:r,borderBottomWidth:n,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:u,paddingLeft:h,marginTop:p,marginRight:g,marginBottom:m,marginLeft:C,boxSizing:y}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(s||"0"),borderTopWidth:parseFloat(i||"0"),borderRightWidth:parseFloat(r||"0"),borderBottomWidth:parseFloat(n||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(u||"0"),paddingLeft:parseFloat(h||"0"),marginTop:parseFloat(p||"0"),marginRight:parseFloat(g||"0"),marginBottom:parseFloat(m||"0"),marginLeft:parseFloat(C||"0"),boxSizing:y}}function pp(e){const t=ba(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom:t.height}function Hl(e){const t=ba(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight:t.width}function g0(e){const t=ba(e),s=t.marginBottom+t.marginTop;return Math.ceil(e.offsetHeight+s)}function ph(e){const t=ba(e),s=t.marginLeft+t.marginRight;return Math.ceil(e.offsetWidth+s)}function f0(e){const t=e.getBoundingClientRect(),{borderTopWidth:s,borderLeftWidth:i,borderRightWidth:r,borderBottomWidth:n}=ba(e);return{top:t.top+(s||0),left:t.left+(i||0),right:t.right+(r||0),bottom:t.bottom+(n||0)}}function gh(){if(typeof og=="boolean")return og;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML=`<div style="width: 2px">
            <span style="display: inline-block; width: 1px"></span>
            <span style="display: inline-block; width: 1px"></span>
        </div>`,document.body.appendChild(e),e.scrollLeft=1,og=Math.floor(e.scrollLeft)===0,document.body.removeChild(e),og}function fh(e,t){let s=e.scrollLeft;return t&&(s=Math.abs(s),Hm()&&!gh()&&(s=e.scrollWidth-e.clientWidth-s)),s}function mh(e,t,s){s&&(gh()?t*=-1:(Gn()||Hm())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function xs(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function nn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function m0(e){return!!e.offsetParent}function Zi(e){const t=e;return t.checkVisibility?t.checkVisibility({checkVisibilityCSS:!0}):!(!m0(e)||window.getComputedStyle(e).visibility!=="visible")}function $i(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function v0(e,t,s){s&&s.nextSibling===t||(s?s.nextSibling?e.insertBefore(t,s.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t))}function C0(e,t){for(let s=0;s<t.length;s++){const i=t[s],r=e.children[s];r!==i&&e.insertBefore(i,r)}}function oF(e,t,s){s?s.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}function y0(e,t){if(t)for(const[s,i]of Object.entries(t)){if(!s||!s.length||i==null)continue;const r=NA(s),n=i.toString(),o=n.replace(/\s*!important/g,""),a=o.length!=n.length?"important":void 0;e.style.setProperty(r,o,a)}}function aF(e){return e.clientWidth<e.scrollWidth}function lF(e){return e.clientHeight<e.scrollHeight}function vh(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):kr(e,t)}function kr(e,t){t=jm(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function q1(e,t){t==="flex"?(e.style.removeProperty("height"),e.style.removeProperty("minHeight"),e.style.removeProperty("maxHeight"),e.style.flex="1 1 auto"):fl(e,t)}function fl(e,t){t=jm(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function jm(e){return typeof e=="number"?`${e}px`:e}function gp(e){return e instanceof Node||e instanceof HTMLElement}function cF(e){if(e==null)return[];const t=[];return w0(e,s=>t.push(s)),t}function uF(e,t){if(e)for(let s=0;s<e.length;s++){const i=e[s];t(i.name,i.value)}}function Ln(e,t,s){s==null?e.removeAttribute(t):e.setAttribute(t,s.toString())}function w0(e,t){if(e!=null)for(let s=0;s<e.length;s++)t(e[s])}function S0(e,t){e.then(s=>{const i=s.getGui();i!=null&&(typeof i=="object"?t.appendChild(i):t.innerHTML=i)})}var dF={};$s(dF,{fuzzyCheckStrings:()=>hF,fuzzySuggestions:()=>fp});function hF(e,t,s){const i={},r=e.filter(n=>!t.some(o=>o===n));return r.length>0&&r.forEach(n=>i[n]=fp(n,s).values),i}function fp(e,t,s,i){let r=t.map((a,l)=>({value:a,relevance:Q1(e.toLowerCase(),a.toLocaleLowerCase()),idx:l}));if(r.sort((a,l)=>l.relevance-a.relevance),s&&(r=r.filter(a=>a.relevance!==0)),r.length>0&&i&&i>0){const l=r[0].relevance*i;r=r.filter(u=>l-u.relevance<0)}const n=[],o=[];for(const a of r)n.push(a.value),o.push(a.idx);return{values:n,indices:o}}function Q1(e,t){const s=e.replace(/\s/g,""),i=t.replace(/\s/g,"");let r=0,n=-1;for(let o=0;o<s.length;o++){const a=i.indexOf(s[o],n+1);a!==-1&&(n=a,r+=100-n*100/1e4*100)}return r}var pF={};$s(pF,{createIcon:()=>Er,createIconNoSpan:()=>cs,iconNameClassMap:()=>gF});var gF={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus"};function Er(e,t,s){const i=cs(e,t,s);if(i){const{className:n}=i;if(typeof n=="string"&&n.indexOf("ag-icon")>-1||typeof n=="object"&&n["ag-icon"])return i}const r=document.createElement("span");return r.appendChild(i),r}function cs(e,t,s,i){let r=null;const n=s&&s.getColDef().icons;if(n&&(r=n[e]),t&&!r){const o=t.get("icons");o&&(r=o[e])}if(r){let o;if(typeof r=="function")o=r();else if(typeof r=="string")o=r;else throw new Error("icon from grid options needs to be a string or a function");if(typeof o=="string")return $i(o);if(gp(o))return o;console.warn("AG Grid: iconRenderer should return back a string or a dom object")}else{const o=document.createElement("span");let a=gF[e];return a||(i?a=e:(console.warn(`AG Grid: Did not find icon ${e}`),a="")),o.setAttribute("class",`ag-icon ag-icon-${a}`),o.setAttribute("unselectable","on"),fs(o,"presentation"),o}}var fF={};$s(fF,{isDeleteKey:()=>CF,isEventFromPrintableCharacter:()=>Wm,isUserSuppressingHeaderKeyboardEvent:()=>mF,isUserSuppressingKeyboardEvent:()=>Df,normaliseQwertyAzerty:()=>vF});var U=class{};U.BACKSPACE="Backspace";U.TAB="Tab";U.ENTER="Enter";U.ESCAPE="Escape";U.SPACE=" ";U.LEFT="ArrowLeft";U.UP="ArrowUp";U.RIGHT="ArrowRight";U.DOWN="ArrowDown";U.DELETE="Delete";U.F2="F2";U.PAGE_UP="PageUp";U.PAGE_DOWN="PageDown";U.PAGE_HOME="Home";U.PAGE_END="End";U.A="KeyA";U.C="KeyC";U.D="KeyD";U.V="KeyV";U.X="KeyX";U.Y="KeyY";U.Z="KeyZ";var Z1=65,J1=67,X1=86,eO=68,tO=90,sO=89;function Wm(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key.length===1}function Df(e,t,s,i,r){const n=i?i.getColDef().suppressKeyboardEvent:void 0;if(!n)return!1;const o=e.addGridCommonParams({event:t,editing:r,column:i,node:s,data:s.data,colDef:i.getColDef()});return!!(n&&n(o))}function mF(e,t,s,i){const r=i.getDefinition(),n=r&&r.suppressHeaderKeyboardEvent;if(!ve(n))return!1;const o=e.addGridCommonParams({colDef:r,column:i,headerRowIndex:s,event:t});return!!n(o)}function vF(e){const{keyCode:t}=e;let s;switch(t){case Z1:s=U.A;break;case J1:s=U.C;break;case X1:s=U.V;break;case eO:s=U.D;break;case tO:s=U.Z;break;case sO:s=U.Y;break;default:s=e.code}return s}function CF(e,t=!1){return e===U.DELETE?!0:!t&&e===U.BACKSPACE?l0():!1}var yF={};$s(yF,{areEventsNear:()=>x0});function x0(e,t,s){if(s===0)return!1;const i=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(i,r)<=s}var wF={};$s(wF,{sortRowNodesByOrder:()=>iO});function iO(e,t){if(!e)return!1;const s=(o,a)=>{const l=t[o.id],u=t[a.id],h=l!==void 0,p=u!==void 0,g=h&&p,m=!h&&!p;return g?l-u:m?o.__objectId-a.__objectId:h?1:-1};let i,r,n=!1;for(let o=0;o<e.length-1;o++)if(i=e[o],r=e[o+1],s(i,r)>0){n=!0;break}return n?(e.sort(s),!0):!1}var SF={};$s(SF,{convertToSet:()=>b0});function b0(e){const t=new Set;return e.forEach(s=>t.add(s)),t}var rO=Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe(Xe({},_A),vA),YA),eF),iF),mA),lA),dF),nA),pF),fF),IA),yF),tF),oA),wF),SF),AA),nt=rO,su=class{constructor(e=0,t=1){this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}},Ps=class Ag{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(s=>this.onDone(s),s=>this.onReject(s))}static all(t){return new Ag(s=>{let i=t.length;const r=new Array(i);t.forEach((n,o)=>{n.then(a=>{r[o]=a,i--,i===0&&s(r)})})})}static resolve(t=null){return new Ag(s=>s(t))}then(t){return new Ag(s=>{this.status===1?s(t(this.resolution)):this.waiters.push(i=>s(t(i)))})}resolveNow(t,s){return this.status===1?s(this.resolution):t}onDone(t){this.status=1,this.resolution=t,this.waiters.forEach(s=>s(t))}onReject(t){console.warn("TBI")}},mp=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1){t.forEach(i=>this.addCssClass(i));return}if(this.cssClassStates[e]!==!0&&e.length){const i=this.getGui();i&&i.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1){t.forEach(i=>this.removeCssClass(i));return}if(this.cssClassStates[e]!==!1&&e.length){const i=this.getGui();i&&i.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return t?t.classList.contains(e):!1}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const i=(e||"").split(" ");if(i.length>1){i.forEach(r=>this.addOrRemoveCssClass(r,t));return}}if(this.cssClassStates[e]!==t&&e.length){const i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}},vp=class za extends Se{constructor(t,s,i,r){super(),this.parentComp=t,this.tooltipShowDelayOverride=s,this.tooltipHideDelayOverride=i,this.shouldDisplayTooltip=r,this.SHOW_QUICK_TOOLTIP_DIFF=1e3,this.FADE_OUT_TOOLTIP_TIMEOUT=1e3,this.INTERACTIVE_HIDE_DELAY=100,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const t=this.parentComp.getGui();this.tooltipTrigger===0&&(this.addManagedListener(t,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(t,"mouseleave",this.onMouseLeave.bind(this))),this.tooltipTrigger===1&&(this.addManagedListener(t,"focusin",this.onFocusIn.bind(this)),this.addManagedListener(t,"focusout",this.onFocusOut.bind(this))),this.addManagedListener(t,"mousemove",this.onMouseMove.bind(this)),this.interactionEnabled||(this.addManagedListener(t,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(t,"keydown",this.onKeyDown.bind(this)))}getGridOptionsTooltipDelay(t){const s=this.gos.get(t);return s<0&&tt(`${t} should not be lower than 0`),Math.max(200,s)}getTooltipDelay(t){var s,i;return t==="show"?(s=this.tooltipShowDelayOverride)!=null?s:this.getGridOptionsTooltipDelay("tooltipShowDelay"):(i=this.tooltipHideDelayOverride)!=null?i:this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const t=this.gos.get("tooltipTrigger");return!t||t==="hover"?0:1}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!yo()&&(za.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(t)},this.INTERACTIVE_HIDE_DELAY):this.prepareToShowTooltip(t))}onMouseMove(t){this.lastMouseEvent&&(this.lastMouseEvent=t),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(t){var s;const i=t.relatedTarget,r=this.parentComp.getGui(),n=(s=this.tooltipComp)==null?void 0:s.getGui();this.isInteractingWithTooltip||r.contains(i)||this.interactionEnabled&&(n!=null&&n.contains(i))||this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}prepareToShowTooltip(t){if(this.state!=0||za.isLocked)return;let s=0;t&&(s=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),s),this.state=1}isLastTooltipHiddenRecently(){const t=new Date().getTime(),s=za.lastTooltipHideTime;return t-s<this.SHOW_QUICK_TOOLTIP_DIFF}setToDoNothing(){this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const t=Xe({},this.parentComp.getTooltipParams());if(!ve(t.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip()){this.setToDoNothing();return}this.state=2,this.tooltipInstanceCount++;const s=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(t).newAgStackInstance().then(s)}hideTooltip(t){if(!t&&this.isInteractingWithTooltip)return;this.tooltipComp&&(this.destroyTooltipComp(),za.lastTooltipHideTime=new Date().getTime());const s={type:w.EVENT_TOOLTIP_HIDE,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(s),this.state=0}newTooltipComponentCallback(t,s){if(this.state!==2||this.tooltipInstanceCount!==t){this.getContext().destroyBean(s);return}const r=s.getGui();this.tooltipComp=s,r.classList.contains("ag-tooltip")||r.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&r.classList.add("ag-tooltip-animate"),this.interactionEnabled&&r.classList.add("ag-tooltip-interactive");const n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({eChild:r,ariaLabel:n("ariaLabelTooltip","Tooltip")});o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1&&(this.onBodyScrollEventCallback=this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,this.setToDoNothing.bind(this)),this.onColumnMovedEventCallback=this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,this.setToDoNothing.bind(this))),this.interactionEnabled&&(this.tooltipTrigger===0?(this.tooltipMouseEnterListener=this.addManagedListener(r,"mouseenter",this.onTooltipMouseEnter.bind(this))||null,this.tooltipMouseLeaveListener=this.addManagedListener(r,"mouseleave",this.onTooltipMouseLeave.bind(this))||null):(this.tooltipFocusInListener=this.addManagedListener(r,"focusin",this.onTooltipFocusIn.bind(this))||null,this.tooltipFocusOutListener=this.addManagedListener(r,"focusout",this.onTooltipFocusOut.bind(this))||null));const a={type:w.EVENT_TOOLTIP_SHOW,tooltipGui:r,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(a),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isInteractingWithTooltip=!1,this.lockService()}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}onTooltipFocusOut(t){var s;const i=this.parentComp.getGui(),r=(s=this.tooltipComp)==null?void 0:s.getGui(),n=t.relatedTarget;r!=null&&r.contains(n)||(this.isInteractingWithTooltip=!1,i.contains(n)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const t={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(rs(Xe({},t),{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(rs(Xe({},t),{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const t=this.tooltipPopupDestroyFunc,s=this.tooltipComp,i=this.tooltipTrigger===0?this.FADE_OUT_TOOLTIP_TIMEOUT:0;window.setTimeout(()=>{t(),this.getContext().destroyBean(s)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(t=>{t&&t()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){za.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},this.INTERACTIVE_HIDE_DELAY)}unlockService(){za.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};vp.isLocked=!1;f([A("popupService")],vp.prototype,"popupService",2);f([A("userComponentFactory")],vp.prototype,"userComponentFactory",2);f([xe],vp.prototype,"postConstruct",1);var nO=vp,wo=class extends Se{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshToolTip()}setBrowserTooltip(e){const t="title",s=this.ctrl.getGui();s&&(e!=null&&e!=""?s.setAttribute(t,e):s.removeAttribute(t))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){var e,t,s,i;if(this.tooltipManager!=null)return;const r={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new nO(r,(t=(e=this.ctrl).getTooltipShowDelayOverride)==null?void 0:t.call(e),(i=(s=this.ctrl).getTooltipHideDelayOverride)==null?void 0:i.call(s),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const e=this.ctrl,t=e.getColumn?e.getColumn():void 0,s=e.getColDef?e.getColDef():void 0,i=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:s,column:t,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:i,data:i?i.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0,hideTooltipCallback:()=>{var r;return(r=this.tooltipManager)==null?void 0:r.hideTooltip(!0)}}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}};f([A("beans")],wo.prototype,"beans",2);f([xe],wo.prototype,"postConstruct",1);var oO=new su,Cp=class ew extends Se{constructor(t){super(),this.displayed=!0,this.visible=!0,this.compId=oO.next(),this.cssClassManager=new mp(()=>this.eGui),t&&this.setTemplate(t)}preConstructOnComponent(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips")}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(t){const{newTooltipText:s,showDelayOverride:i,hideDelayOverride:r,location:n,shouldDisplayTooltip:o}=t||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==s&&(this.tooltipText=s);const a=()=>this.tooltipText;s!=null&&(this.tooltipFeature=this.createBean(new wo({getTooltipValue:a,getGui:()=>this.getGui(),getLocation:()=>n??"UNKNOWN",getColDef:t==null?void 0:t.getColDef,getColumn:t==null?void 0:t.getColumn,getTooltipShowDelayOverride:i!=null?()=>i:void 0,getTooltipHideDelayOverride:r!=null?()=>r:void 0,shouldDisplayTooltip:o})))}createChildComponentsFromTags(t,s){cF(t.childNodes).forEach(r=>{if(!(r instanceof HTMLElement))return;const n=this.createComponentFromElement(r,o=>{o.getGui()&&this.copyAttributesFromNode(r,o.getGui())},s);if(n){if(n.addItems&&r.children.length){this.createChildComponentsFromTags(r,s);const o=Array.prototype.slice.call(r.children);n.addItems(o)}this.swapComponentForNode(n,t,r)}else r.childNodes&&this.createChildComponentsFromTags(r,s)})}createComponentFromElement(t,s,i){const r=t.nodeName,n=i?i[t.getAttribute("ref")]:void 0,o=this.agStackComponentsRegistry.getComponentClass(r);if(o){ew.elementGettingCreated=t;const a=new o(n);return a.setParentComponent(this),this.createBean(a,null,s),a}return null}copyAttributesFromNode(t,s){uF(t.attributes,(i,r)=>s.setAttribute(i,r))}swapComponentForNode(t,s,i){const r=t.getGui();s.replaceChild(r,i),s.insertBefore(document.createComment(i.nodeName),r),this.addDestroyFunc(this.destroyBean.bind(this,t)),this.swapInComponentForQuerySelectors(t,i)}swapInComponentForQuerySelectors(t,s){const i=this;this.iterateOverQuerySelectors(r=>{i[r.attributeName]===s&&(i[r.attributeName]=t)})}iterateOverQuerySelectors(t){let s=Object.getPrototypeOf(this);for(;s!=null;){const i=s.__agComponentMetaData,r=_m(s.constructor);i&&i[r]&&i[r].querySelectors&&i[r].querySelectors.forEach(n=>t(n)),s=Object.getPrototypeOf(s)}}activateTabIndex(t){const s=this.gos.get("tabIndex");t||(t=[]),t.length||t.push(this.getGui()),t.forEach(i=>i.setAttribute("tabindex",s.toString()))}setTemplate(t,s){const i=$i(t);this.setTemplateFromElement(i,s)}setTemplateFromElement(t,s){this.eGui=t,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),s)}createChildComponentsPreConstruct(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}wireQuerySelectors(){if(!this.eGui)return;const t=this;this.iterateOverQuerySelectors(s=>{const i=n=>t[s.attributeName]=n;if(s.refSelector&&this.getAttribute("ref")===s.refSelector)i(this.eGui);else{const n=this.eGui.querySelector(s.querySelector);n&&i(n.__agComponent||n)}})}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(t){this.parentComponent=t}getParentComponent(){return this.parentComponent}setGui(t){this.eGui=t}queryForHtmlElement(t){return this.eGui.querySelector(t)}queryForHtmlInputElement(t){return this.eGui.querySelector(t)}appendChild(t,s){if(t!=null)if(s||(s=this.eGui),gp(t))s.appendChild(t);else{const i=t;s.appendChild(i.getGui())}}isDisplayed(){return this.displayed}setVisible(t,s={}){if(t!==this.visible){this.visible=t;const{skipAriaHidden:i}=s;nF(this.eGui,t,{skipAriaHidden:i})}}setDisplayed(t,s={}){if(t!==this.displayed){this.displayed=t;const{skipAriaHidden:i}=s;Dt(this.eGui,t,{skipAriaHidden:i});const r={type:ew.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(r)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const t=this.eGui;t&&t.__agComponent&&(t.__agComponent=void 0),super.destroy()}addGuiEventListener(t,s,i){this.eGui.addEventListener(t,s,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(t,s))}addCssClass(t){this.cssClassManager.addCssClass(t)}removeCssClass(t){this.cssClassManager.removeCssClass(t)}containsCssClass(t){return this.cssClassManager.containsCssClass(t)}addOrRemoveCssClass(t,s){this.cssClassManager.addOrRemoveCssClass(t,s)}getAttribute(t){const{eGui:s}=this;return s?s.getAttribute(t):null}getRefElement(t){return this.queryForHtmlElement(`[ref="${t}"]`)}};Cp.EVENT_DISPLAYED_CHANGED="displayedChanged";f([A("agStackComponentsRegistry")],Cp.prototype,"agStackComponentsRegistry",2);f([hA],Cp.prototype,"preConstructOnComponent",1);f([hA],Cp.prototype,"createChildComponentsPreConstruct",1);var at=Cp;function Fe(e){return aO.bind(this,`[ref=${e}]`,e)}function aO(e,t,s,i,r){if(e===null){console.error("AG Grid: QuerySelector selector should not be null");return}if(typeof r=="number"){console.error("AG Grid: QuerySelector should be on an attribute");return}lO(s,"querySelectors",{attributeName:i,querySelector:e,refSelector:t})}function lO(e,t,s){const i=cO(e,_m(e.constructor));i[t]||(i[t]=[]),i[t].push(s)}function cO(e,t){return e.__agComponentMetaData||(e.__agComponentMetaData={}),e.__agComponentMetaData[t]||(e.__agComponentMetaData[t]={}),e.__agComponentMetaData[t]}var E0=class extends at{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),s=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${s("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const s=t.getModelAsString(e);this.eFloatingFilterText.setValue(s)}})}onParamsUpdated(e){this.refresh(e)}refresh(e){this.init(e)}};f([Fe("eFloatingFilterText")],E0.prototype,"eFloatingFilterText",2);f([A("columnModel")],E0.prototype,"columnModel",2);var xF=class{constructor(e,t,s,i,r){this.alive=!0,this.context=e,this.eParent=i,t.getDateCompDetails(s).newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}this.dateComp=a,a&&(i.appendChild(a.getGui()),a.afterGuiAttached&&a.afterGuiAttached(),this.tempValue&&a.setDate(this.tempValue),this.disabled!=null&&this.setDateCompDisabled(this.disabled),r==null||r(this))})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){Dt(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&typeof this.dateComp.afterGuiAttached=="function"&&this.dateComp.afterGuiAttached(e)}updateParams(e){var t,s;let i=!1;(t=this.dateComp)!=null&&t.refresh&&typeof this.dateComp.refresh=="function"&&this.dateComp.refresh(e)!==null&&(i=!0),!i&&((s=this.dateComp)!=null&&s.onParamsUpdated)&&typeof this.dateComp.onParamsUpdated=="function"&&this.dateComp.onParamsUpdated(e)!==null&&tt("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}setDateCompDisabled(e){this.dateComp!=null&&this.dateComp.setDisabled!=null&&this.dateComp.setDisabled(e)}},bF=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(e=>{if(typeof e=="string")return;const t=[["displayKey"],["displayName"],["predicate","test"]],s=i=>i.some(r=>e[r]!=null)?!0:(console.warn(`AG Grid: ignoring FilterOptionDef as it doesn't contain one of '${i}'`),!1);if(!t.every(s)){this.filterOptions=this.filterOptions.filter(i=>i===e)||[];return}this.customFilterOptions[e.displayKey]=e})}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const t=this.filterOptions[0];typeof t=="string"?this.defaultOption=t:t.displayKey?this.defaultOption=t.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}},EF={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},zm=class RF extends Se{constructor(t,s={}){super(),this.eFocusableElement=t,this.callbacks=s,this.callbacks=Xe({shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;const r=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,i.shiftKey);r&&(r.focus(),i.preventDefault())}},s)}postConstruct(){this.eFocusableElement.classList.add(RF.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}addKeyDownListeners(t){this.addManagedListener(t,"keydown",s=>{if(!(s.defaultPrevented||un(s))){if(this.callbacks.shouldStopEventPropagation(s)){gn(s);return}s.key===U.TAB?this.callbacks.onTabKeyDown(s):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(s)}})}};zm.FOCUS_MANAGED_CLASS="ag-focus-managed";f([A("focusService")],zm.prototype,"focusService",2);f([xe],zm.prototype,"postConstruct",1);var Ea=zm,TF="ag-resizer-wrapper",uO=`<div class="${TF}">
        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>
        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>
        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>
        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>
        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>
        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>
        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>
        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>
    </div>`,xu=class extends Se{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,s=t/2-this.getWidth()/2,i=e/2-this.getHeight()/2;this.offsetElement(s,i)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:s,width:i,minHeight:r,height:n,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,u=0;const h=Zi(this.element);if(h){const p=this.findBoundaryElement(),g=window.getComputedStyle(p);if(g.minWidth!=null){const m=p.offsetWidth-this.element.offsetWidth;u=parseInt(g.minWidth,10)-m}if(g.minHeight!=null){const m=p.offsetHeight-this.element.offsetHeight;l=parseInt(g.minHeight,10)-m}}if(this.minHeight=r||l,this.minWidth=s||u,i&&this.setWidth(i),n&&this.setHeight(n),(!i||!n)&&this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(h&&t){let p=this.boundaryEl,g=!0;if(p||(p=this.findBoundaryElement(),g=!1),p){const m=parseFloat(p.style.top),C=parseFloat(p.style.left);g?this.offsetElement(isNaN(C)?0:C,isNaN(m)?0:m):this.setPosition(C,m)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const s=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(s),this.moveElementDragListener=s):(this.dragService.removeDragSource(s),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const i=!!e[t],r=this.getResizerElement(t),n={dragStartPixels:0,eElement:r,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragService.addDragSource(n),this.resizeListeners.push(n),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[t]=i)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,s=this.element;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)fl(s,e),e=g0(s),i=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const r=this.getAvailableHeight();r&&e>r&&(e=r)}this.getHeight()!==e&&(i?(s.style.maxHeight="unset",s.style.minHeight="unset"):t?fl(s,e):(s.style.height=`${e}px`,s.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:s}=this.offsetParent;if(!s)return null;const i=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),n=e?this.position.y:i.top,o=e?0:r.top;let a=0;if(t){const u=this.element.parentElement;if(u){const{bottom:h}=u.getBoundingClientRect();a=h-i.bottom}}return s+o-n-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:s}=this.config;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)kr(t,e),e=ph(t),i=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:r}=this.offsetParent,n=s?this.position.x:this.element.getBoundingClientRect().left;r&&e+n>r&&(e=r-n)}this.getWidth()!==e&&(i?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?kr(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:s}=this.config,i=s?this.boundaryEl:this.element;i&&(this.popupService.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const s=this.getAvailableHeight();this.element.style.setProperty("max-height",`${s}px`)};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:s,isTop:i,anywhereWithin:r,topBuffer:n}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!s,!!r,o)?0:o,u=this.shouldSkipY(t,!!i,n,a)?0:a;return{movementX:l,movementY:u}}shouldSkipX(e,t,s,i){const r=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&n.left>=e.clientX||n.right<=e.clientX&&n.right<=o.right;return l?!0:(t?l=i<0&&e.clientX>a+n.left||i>0&&e.clientX<a+n.left:s?l=i<0&&e.clientX>o.right||i>0&&e.clientX<a+n.left:l=i<0&&e.clientX>o.right||i>0&&e.clientX<o.right,l)}shouldSkipY(e,t,s=0,i){const r=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&n.top>=e.clientY||n.bottom<=e.clientY&&n.bottom<=o.bottom;return l?!0:(t?l=i<0&&e.clientY>a+n.top+s||i>0&&e.clientY<a+n.top:l=i<0&&e.clientY>o.bottom||i>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const s=new DOMParser().parseFromString(uO,"text/html").body;e.appendChild(s.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${TF}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:s,forcePopupParentAsOffsetParent:i}=this.config;!s&&!i&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(s=>!s.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,s=0;for(let i=0;i<e.length;i++){const r=e[i],n=!!r.style.flex&&r.style.flex!=="0 0 auto";if(r===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(n){const l=window.getComputedStyle(r);l.minHeight&&(o=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else o=r.offsetHeight,a=r.offsetWidth;t+=o,s+=a}return{height:t,width:s}}applySizeToSiblings(e){let t=null;const s=this.getSiblings();if(s){for(let i=0;i<s.length;i++){const r=s[i];r!==t&&(e?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(t=s[i+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:s}=this.config,{isTop:i,isRight:r,isBottom:n,isLeft:o}=this.currentResizer,a=r||o,l=n||i,{movementX:u,movementY:h}=this.calculateMouseMovement({e,isLeft:o,isTop:i}),p=this.position.x,g=this.position.y;let m=0,C=0;if(a&&u){const y=o?-1:1,R=this.getWidth(),x=R+u*y;let S=!1;o&&(m=R-x,(p+m<=0||x<=this.minWidth)&&(S=!0,m=0)),S||this.setWidth(x)}if(l&&h){const y=i?-1:1,R=this.getHeight(),x=R+h*y;let S=!1;i?(C=R-x,(g+C<=0||x<=this.minHeight)&&(S=!0,C=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&R<x&&this.getMinSizeOfSiblings().height+x>this.element.parentElement.offsetHeight&&(S=!0),S||this.setHeight(x)}this.updateDragStartPosition(e.clientX,e.clientY),((t||s)&&m||C)&&this.offsetElement(p+m,g+C)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;const s={type:"resize"};this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchEvent(s)}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:s}=this.position;let i;this.config.calculateTopBuffer&&(i=this.config.calculateTopBuffer());const{movementX:r,movementY:n}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:i});this.offsetElement(t+r,s+n),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}};f([A("popupService")],xu.prototype,"popupService",2);f([A("resizeObserverService")],xu.prototype,"resizeObserverService",2);f([A("dragService")],xu.prototype,"dragService",2);var Um=class fd extends at{constructor(t){super(),this.filterNameKey=t,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.buttonListeners=[]}postConstruct(){this.resetTemplate(),this.createManagedBean(new Ea(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new xu(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(t){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(t){let s=this.getGui();s&&s.removeEventListener("submit",this.onFormSubmit);const i=`
            <form class="ag-filter-wrapper">
                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" ref="eFilterBody">
                    ${this.createBodyTemplate()}
                </div>
            </form>`;this.setTemplate(i,t),s=this.getGui(),s&&s.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(t){this.setParams(t),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(t){this.providedFilterParams=t,this.applyActive=fd.isUseApplyButton(t),this.resetButtonsPanel()}updateParams(t){this.providedFilterParams=t,this.applyActive=fd.isUseApplyButton(t),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(){const{buttons:t}=this.providedFilterParams,s=t&&t.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(xs(this.eButtonsPanel),this.buttonListeners.forEach(n=>n==null?void 0:n()),this.buttonListeners=[]):s&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!s){this.eButtonsPanel&&nn(this.eButtonsPanel);return}const i=document.createDocumentFragment(),r=n=>{let o,a;switch(n){case"apply":o=this.translate("applyFilter"),a=h=>this.onBtApply(!1,!1,h);break;case"clear":o=this.translate("clearFilter"),a=()=>this.onBtClear();break;case"reset":o=this.translate("resetFilter"),a=()=>this.onBtReset();break;case"cancel":o=this.translate("cancelFilter"),a=h=>{this.onBtCancel(h)};break;default:console.warn("AG Grid: Unknown button type specified");return}const u=$i(`<button
                    type="${n==="apply"?"submit":"button"}"
                    ref="${n}FilterButton"
                    class="ag-button ag-standard-button ag-filter-apply-panel-button"
                >${o}
                </button>`);this.buttonListeners.push(this.addManagedListener(u,"click",a)),i.append(u)};b0(t).forEach(n=>r(n)),this.eButtonsPanel.append(i),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const t=fd.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),s=xi(this.checkApplyDebounce.bind(this),t);this.onBtApplyDebounce=()=>{this.debouncePending=!0,s()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(t){return(t!=null?this.setModelIntoUi(t):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(t){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(t)})}handleCancelEnd(t){this.providedFilterParams.closeOnApply&&this.close(t)}resetUiToActiveModel(t,s){const i=()=>{this.onUiChanged(!1,"prevent"),s==null||s()};t!=null?this.setModelIntoUi(t).then(i):this.resetUiToDefaults().then(i)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(t="api"){const s=this.getModelFromUi();if(!this.isModelValid(s))return!1;const i=this.appliedModel;return this.appliedModel=s,!this.areModelsEqual(i,s)}isModelValid(t){return!0}onFormSubmit(t){t.preventDefault()}onBtApply(t=!1,s=!1,i){i&&i.preventDefault(),this.applyModel(s?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:t,afterDataChange:s,source:"columnFilter"});const{closeOnApply:r}=this.providedFilterParams;r&&this.applyActive&&!t&&!s&&this.close(i)}onNewRowsLoaded(){}close(t){if(!this.hidePopup)return;const s=t,i=s&&s.key;let r;(i==="Enter"||i==="Space")&&(r={keyboardEvent:s}),this.hidePopup(r),this.hidePopup=null}onUiChanged(t=!1,s){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const i=this.isModelValid(this.getModelFromUi()),r=this.getRefElement("applyFilterButton");r&&tu(r,!i)}t&&!s||s==="immediately"?this.onBtApply(t):(!this.applyActive&&!s||s==="debounce")&&this.onBtApplyDebounce()}afterGuiAttached(t){t&&(this.hidePopup=t.hidePopup),this.refreshFilterResizer(t==null?void 0:t.container)}refreshFilterResizer(t){if(!this.positionableFeature||t==="toolPanel")return;const s=t==="floatingFilter"||t==="columnFilter",{positionableFeature:i,gos:r}=this;s?(i.restoreLastSize(),i.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}static getDebounceMs(t,s){return fd.isUseApplyButton(t)?(t.debounceMs!=null&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):t.debounceMs!=null?t.debounceMs:s}static isUseApplyButton(t){return!!t.buttons&&t.buttons.indexOf("apply")>=0}refresh(t){return this.providedFilterParams=t,!0}destroy(){const t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(t){return this.localeService.getLocaleTextFunc()(t,EF[t])}getCellValue(t){return this.providedFilterParams.getValue(t)}getPositionableElement(){return this.eFilterBody}};f([A("rowModel")],Um.prototype,"rowModel",2);f([Fe("eFilterBody")],Um.prototype,"eFilterBody",2);f([xe],Um.prototype,"postConstruct",1);var Pf=Um,R0=class extends at{constructor(e,t){super(t),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:s,labelAlignment:i,disabled:r}=this.config;r!=null&&this.setDisabled(r),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),s!=null&&this.setLabelWidth(s),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}refreshLabel(){xs(this.eLabel),typeof this.label=="string"?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),this.label===""?(Dt(this.eLabel,!1),fs(this.eLabel,"presentation")):(Dt(this.eLabel,!0),fs(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const s=this.getGui().classList;return s.toggle("ag-label-align-left",e==="left"),s.toggle("ag-label-align-right",e==="right"),s.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(vh(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return tu(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}};f([xe],R0.prototype,"postConstruct",1);var DF=class extends R0{constructor(e,t,s){super(e,t),this.className=s}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:s}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),s!=null&&this.onValueChange(s),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId();OA(e)!==null?Xc(e,""):Xc(e,t??"")}setAriaLabel(e){return fr(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListener(this,w.EVENT_FIELD_VALUE_CHANGED,()=>e(this.getValue())),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return kr(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED}),this)}},dO=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,jl=class extends DF{constructor(e){if(super(e,(e==null?void 0:e.template)||dO,e==null?void 0:e.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.ariaRole=e==null?void 0:e.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:s,variableWidth:i,minPickerWidth:r,maxPickerWidth:n}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!i,s!=null&&this.setPickerMaxHeight(s),r!=null&&this.setPickerMinWidth(r),n!=null&&this.setPickerMaxWidth(n)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedListener(t,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(this.eLabel,"mousedown",this.onLabelOrWrapperMouseDown.bind(this)),this.addManagedListener(this.eWrapper,"mousedown",this.onLabelOrWrapperMouseDown.bind(this));const{pickerIcon:s,inputWidth:i}=this.config;if(s){const r=cs(s,this.gos);r&&this.eIcon.appendChild(r)}i!=null&&this.setInputWidth(i)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),co(e,!1),this.ariaRole&&fs(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&(e==null?void 0:e.target)===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case U.UP:case U.DOWN:case U.ENTER:case U.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case U.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.gos.getDocument(),t=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||(this.destroyMouseWheelFunc=this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,()=>{this.hidePicker()}));const s=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:i,pickerAriaLabelValue:r,modalPicker:n=!0}=this.config,o={modal:n,eChild:t,closeOnEsc:!0,closedCallback:()=>{const m=this.gos.getActiveDomElement(),C=!m||m===e.body;this.beforeHidePicker(),C&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:s(i,r)},a=this.popupService.addPopup(o),{maxPickerHeight:l,minPickerWidth:u,maxPickerWidth:h,variableWidth:p}=this;p?(u&&(t.style.minWidth=u),t.style.width=jm(ph(this.eWrapper)),h&&(t.style.maxWidth=h)):vh(t,h??ph(this.eWrapper));const g=l??`${pp(this.popupService.getPopupParent())}px`;return t.style.setProperty("max-height",g),t.style.position="absolute",this.alignPickerToComponent(),a.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:e}=this.config,{pickerGap:t}=this,s=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:e,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:s,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();co(t,e),this.eWrapper.classList.toggle("ag-picker-expanded",e),this.eWrapper.classList.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var t;(t=this.pickerComponent)!=null&&t.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(e){return vh(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}};f([A("popupService")],jl.prototype,"popupService",2);f([Fe("eLabel")],jl.prototype,"eLabel",2);f([Fe("eWrapper")],jl.prototype,"eWrapper",2);f([Fe("eDisplayField")],jl.prototype,"eDisplayField",2);f([Fe("eIcon")],jl.prototype,"eIcon",2);var $m=class Fg extends at{constructor(t="default",s=!1){super(`<div class="ag-list ag-${t}-list" role="listbox"></div>`),this.cssIdentifier=t,this.unFocusable=s,this.options=[],this.itemEls=[]}init(){const t=this.getGui();this.addManagedListener(t,"mouseleave",()=>this.clearHighlighted()),!this.unFocusable&&this.addManagedListener(t,"keydown",this.handleKeyDown.bind(this))}handleKeyDown(t){const s=t.key;switch(s){case U.ENTER:if(!this.highlightedEl)this.setValue(this.getValue());else{const i=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(i)}break;case U.DOWN:case U.UP:t.preventDefault(),this.navigate(s);break;case U.PAGE_DOWN:case U.PAGE_UP:case U.PAGE_HOME:case U.PAGE_END:t.preventDefault(),this.navigateToPage(s);break}}navigate(t){const s=t===U.DOWN;let i;if(!this.highlightedEl)i=this.itemEls[s?0:this.itemEls.length-1];else{let n=this.itemEls.indexOf(this.highlightedEl)+(s?1:-1);n=Math.min(Math.max(n,0),this.itemEls.length-1),i=this.itemEls[n]}this.highlightItem(i)}navigateToPage(t){if(!this.highlightedEl||this.itemEls.length===0)return;const s=this.itemEls.indexOf(this.highlightedEl),i=this.options.length-1,r=this.itemEls[0].clientHeight,n=Math.floor(this.getGui().clientHeight/r);let o=-1;t===U.PAGE_HOME?o=0:t===U.PAGE_END?o=i:t===U.PAGE_DOWN?o=Math.min(s+n,i):t===U.PAGE_UP&&(o=Math.max(s-n,0)),o!==-1&&this.highlightItem(this.itemEls[o])}addOptions(t){return t.forEach(s=>this.addOption(s)),this}addOption(t){const{value:s,text:i}=t,r=i||s;return this.options.push({value:s,text:r}),this.renderOption(s,r),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(t=>{nn(t)}),this.itemEls=[]}updateIndices(){const t=this.getGui().querySelectorAll(".ag-list-item");t.forEach((s,i)=>{Vm(s,i+1),Gm(s,t.length)})}renderOption(t,s){const i=this.gos.getDocument(),r=i.createElement("div");fs(r,"option"),r.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const n=i.createElement("span");r.appendChild(n),n.textContent=s,this.unFocusable||(r.tabIndex=-1),this.itemEls.push(r),this.addManagedListener(r,"mousemove",()=>this.highlightItem(r)),this.addManagedListener(r,"mousedown",o=>{o.preventDefault(),this.setValue(t)}),this.createManagedBean(new wo({getTooltipValue:()=>s,getGui:()=>r,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>n.scrollWidth>n.clientWidth})),this.getGui().appendChild(r)}setValue(t,s){if(this.value===t)return this.fireItemSelected(),this;if(t==null)return this.reset(s),this;const i=this.options.findIndex(r=>r.value===t);if(i!==-1){const r=this.options[i];this.value=r.value,this.displayValue=r.text,this.highlightItem(this.itemEls[i]),s||this.fireChangeEvent()}return this}setValueByIndex(t){return this.setValue(this.options[t].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const t=this.options.findIndex(s=>s.value===this.value);t!==-1&&this.highlightItem(this.itemEls[t])}reset(t){this.value=null,this.displayValue=null,this.clearHighlighted(),t||this.fireChangeEvent()}highlightItem(t){if(!Zi(t))return;this.clearHighlighted(),this.highlightedEl=t,this.highlightedEl.classList.add(Fg.ACTIVE_CLASS),eu(this.highlightedEl,!0);const s=this.getGui(),{scrollTop:i,clientHeight:r}=s,{offsetTop:n,offsetHeight:o}=t;(n+o>i+r||n<i)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){!this.highlightedEl||!Zi(this.highlightedEl)||(this.highlightedEl.classList.remove(Fg.ACTIVE_CLASS),eu(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED}),this.fireItemSelected()}fireItemSelected(){this.dispatchEvent({type:Fg.EVENT_ITEM_SELECTED})}};$m.EVENT_ITEM_SELECTED="selectedItem";$m.ACTIVE_CLASS="ag-active-item";f([xe],$m.prototype,"init",1);var SE=$m,PF=class AF extends jl{constructor(t){super(Xe({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox"},t))}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:t,value:s,placeholder:i}=this.config;t!=null&&this.addOptions(t),s!=null&&this.setValue(s,!0),i&&s==null&&(this.eDisplayField.textContent=i),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}onWrapperFocusOut(t){this.eWrapper.contains(t.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new SE("select",!0)),this.listComponent.setParentComponent(this);const t=this.listComponent.getAriaElement(),s=`ag-select-list-${this.listComponent.getCompId()}`;t.setAttribute("id",s),n0(this.getAriaElement(),t),this.listComponent.addManagedListener(this.listComponent,SE.EVENT_ITEM_SELECTED,()=>{this.hidePicker(),this.dispatchEvent({type:AF.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,w.EVENT_FIELD_VALUE_CHANGED,()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())})}createPickerComponent(){return this.listComponent}onKeyDown(t){var s;const{key:i}=t;switch(i===U.TAB&&this.hidePicker(),i){case U.ENTER:case U.UP:case U.DOWN:case U.PAGE_UP:case U.PAGE_DOWN:case U.PAGE_HOME:case U.PAGE_END:t.preventDefault(),this.isPickerDisplayed?(s=this.listComponent)==null||s.handleKeyDown(t):super.onKeyDown(t);break;case U.ESCAPE:super.onKeyDown(t);break}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(t){return t.forEach(s=>this.addOption(s)),this}addOption(t){return this.listComponent.addOption(t),this}clearOptions(){var t;return(t=this.listComponent)==null||t.clearOptions(),this}setValue(t,s,i){if(this.value===t||!this.listComponent)return this;if(i||this.listComponent.setValue(t,!0),this.listComponent.getValue()===this.getValue())return this;let n=this.listComponent.getDisplayValue();return n==null&&this.config.placeholder&&(n=this.config.placeholder),this.eDisplayField.textContent=n,this.setTooltip({newTooltipText:n??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(t,s)}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),super.destroy()}};PF.EVENT_ITEM_SELECTED="selectedItem";var Km=PF,on=class extends DF{constructor(e,t,s="text",i="input"){super(e,`
            <div role="presentation">
                <div ref="eLabel" class="ag-input-field-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">
                    <${i} ref="eInput" class="ag-input-field-input"></${i}>
                </div>
            </div>`,t),this.inputType=s,this.displayFieldTag=i}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName:e,inputWidth:t}=this.config;e!=null&&this.setInputName(e),t!=null&&this.setInputWidth(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>this.setValue(e.target.value))}setInputType(){this.displayFieldTag==="input"&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return vh(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return Ln(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return fr(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return tu(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)Ln(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";Ln(this.eInput,"autocomplete",t)}return this}};f([Fe("eLabel")],on.prototype,"eLabel",2);f([Fe("eWrapper")],on.prototype,"eWrapper",2);f([Fe("eInput")],on.prototype,"eInput",2);var Ym=class extends on{constructor(e,t="ag-checkbox",s="checkbox"){super(e,t,s),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,s){this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED,selected:e,previousValue:t,event:s});const i=this.getInputElement(),r={type:w.EVENT_CHECKBOX_CHANGED,id:i.id,name:i.name,selected:e,previousValue:t};this.eventService.dispatchEvent(r)}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),s=this.selected=e.target.checked;this.refreshSelectedClass(s),this.dispatchChange(s,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",e===!0),this.eWrapper.classList.toggle("ag-indeterminate",e==null)}},FF=class extends Ym{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedListener(this.eventService,w.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}},T0=class{constructor(e,t,s){this.localeService=e,this.optionsFactory=t,this.valueFormatter=s}getModelAsString(e){if(!e)return null;const t=e.operator!=null,s=this.localeService.getLocaleTextFunc();if(t){const i=e;let{conditions:r}=i;if(!r){const{condition1:a,condition2:l}=i;r=[a,l]}const n=r.map(a=>this.getModelAsString(a)),o=i.operator==="AND"?"andCondition":"orCondition";return n.join(` ${s(o,EF[o])} `)}else{if(e.type===ps.BLANK||e.type===ps.NOT_BLANK)return s(e.type,e.type);{const i=e,r=this.optionsFactory.getCustomOption(i.type),{displayKey:n,displayName:o,numberOfInputs:a}=r||{};return n&&o&&a===0?(s(n,o),o):this.conditionToString(i,r)}}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){var t;return this.valueFormatter?(t=this.valueFormatter(e??null))!=null?t:"":String(e)}},Ni=class rc extends Pf{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(t){const s=this.optionsFactory.getCustomOption(t);if(s){const{numberOfInputs:r}=s;return r??1}const i=[rc.EMPTY,rc.NOT_BLANK,rc.BLANK];return t&&i.indexOf(t)>=0?0:t===rc.IN_RANGE?2:1}onFloatingFilterChanged(t,s){this.setTypeFromFloatingFilter(t),this.setValueFromFloatingFilter(s),this.onUiChanged(!0)}setTypeFromFloatingFilter(t){this.eTypes.forEach((s,i)=>{i===0?s.setValue(t,!0):s.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const t=this.getUiCompleteConditions();return t.length===0?null:this.maxNumConditions>1&&t.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:t[0],condition2:t[1],conditions:t}:t[0]}getConditionTypes(){return this.eTypes.map(t=>t.getValue())}getConditionType(t){return this.eTypes[t].getValue()}getJoinOperator(){return this.eJoinOperatorsOr.length===0?this.defaultJoinOperator:this.eJoinOperatorsOr[0].getValue()===!0?"OR":"AND"}areModelsEqual(t,s){if(!t&&!s)return!0;if(!t&&s||t&&!s)return!1;const i=!t.operator,r=!s.operator;if(!i&&r||i&&!r)return!1;let o;if(i){const a=t,l=s;o=this.areSimpleModelsEqual(a,l)}else{const a=t,l=s;o=a.operator===l.operator&&Fn(a.conditions,l.conditions,(u,h)=>this.areSimpleModelsEqual(u,h))}return o}shouldRefresh(t){var s,i,r;const n=this.getModel(),o=n?(s=n.conditions)!=null?s:[n]:null,a=(r=(i=t.filterOptions)==null?void 0:i.map(u=>typeof u=="string"?u:u.displayKey))!=null?r:this.getDefaultFilterOptions();return!(!(!o||o.every(u=>a.find(h=>h===u.type)!==void 0))||typeof t.maxNumConditions=="number"&&o&&o.length>t.maxNumConditions)}refresh(t){return!this.shouldRefresh(t)||!super.refresh(t)?!1:(this.setParams(t),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(t){if(t.operator){let i=t;i.conditions||(i.conditions=[i.condition1,i.condition2]);const r=this.validateAndUpdateConditions(i.conditions),n=this.getNumConditions();if(r<n)this.removeConditionsAndOperators(r);else if(r>n)for(let a=n;a<r;a++)this.createJoinOperatorPanel(),this.createOption();const o=i.operator==="OR";this.eJoinOperatorsAnd.forEach(a=>a.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(a=>a.setValue(o,!0)),i.conditions.forEach((a,l)=>{this.eTypes[l].setValue(a.type,!0),this.setConditionIntoUi(a,l)})}else{const i=t;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(i.type,!0),this.setConditionIntoUi(i,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Ps.resolve()}validateAndUpdateConditions(t){let s=t.length;return s>this.maxNumConditions&&(t.splice(this.maxNumConditions),tt('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),s=this.maxNumConditions),s}doesFilterPass(t){var s;const i=this.getModel();if(i==null)return!0;const{operator:r}=i,n=[];if(r){const a=i;n.push(...(s=a.conditions)!=null?s:[])}else n.push(i);return n[r&&r==="OR"?"some":"every"](a=>this.individualConditionPasses(t,a))}setParams(t){super.setParams(t),this.setNumConditions(t),this.defaultJoinOperator=this.getDefaultJoinOperator(t.defaultJoinOperator),this.filterPlaceholder=t.filterPlaceholder,this.optionsFactory=new bF,this.optionsFactory.init(t,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(t){var s,i;t.suppressAndOrCondition!=null&&tt('Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.'),t.alwaysShowBothConditions!=null&&tt('Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.'),this.maxNumConditions=(s=t.maxNumConditions)!=null?s:t.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(tt('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=(i=t.numAlwaysVisibleConditions)!=null?i:t.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(tt('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(tt('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const t=this.createManagedBean(new Km);this.eTypes.push(t),t.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(t.getGui());const s=this.createValueElement();this.eConditionBodies.push(s),this.eFilterBody.appendChild(s),this.putOptionsIntoDropdown(t),this.resetType(t);const i=this.getNumConditions()-1;this.forEachPositionInput(i,r=>this.resetInput(r)),this.addChangedListeners(t,i)}createJoinOperatorPanel(){const t=document.createElement("div");this.eJoinOperatorPanels.push(t),t.classList.add("ag-filter-condition");const s=this.createJoinOperator(this.eJoinOperatorsAnd,t,"and"),i=this.createJoinOperator(this.eJoinOperatorsOr,t,"or");this.eFilterBody.appendChild(t);const r=this.eJoinOperatorPanels.length-1,n=this.joinOperatorId++;this.resetJoinOperatorAnd(s,r,n),this.resetJoinOperatorOr(i,r,n),this.isReadOnly()||(s.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(t,s,i){const r=this.createManagedBean(new FF);return t.push(r),r.addCssClass("ag-filter-condition-operator"),r.addCssClass(`ag-filter-condition-operator-${i}`),s.appendChild(r.getGui()),r}getDefaultJoinOperator(t){return t==="AND"||t==="OR"?t:"AND"}createFilterListOptions(){const t=this.optionsFactory.getFilterOptions();this.filterListOptions=t.map(s=>typeof s=="string"?this.createBoilerplateListOption(s):this.createCustomListOption(s))}putOptionsIntoDropdown(t){this.filterListOptions.forEach(s=>{t.addOption(s)}),t.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(t){return{value:t,text:this.translate(t)}}createCustomListOption(t){const{displayKey:s}=t,i=this.optionsFactory.getCustomOption(t.displayKey);return{value:s,text:i?this.localeService.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(s)}}isAllowTwoConditions(){return this.maxNumConditions>=2}createBodyTemplate(){return""}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const t=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,t)}updateNumConditions(){var t;let s=-1,i=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?s=r:i=!1;if(this.shouldAddNewConditionAtEnd(i))this.createJoinOperatorPanel(),this.createOption();else{const r=(t=this.lastUiCompletePosition)!=null?t:this.getNumConditions()-2;if(s<r){this.removeConditionsAndOperators(r+1);const n=s+1,o=r-n;o>0&&this.removeConditionsAndOperators(n,o),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=s}updateConditionStatusesAndValues(t,s){this.eTypes.forEach((r,n)=>{const o=this.isConditionDisabled(n,t);r.setDisabled(o||this.filterListOptions.length<=1),n===1&&(tu(this.eJoinOperatorPanels[0],o),this.eJoinOperatorsAnd[0].setDisabled(o),this.eJoinOperatorsOr[0].setDisabled(o))}),this.eConditionBodies.forEach((r,n)=>{Dt(r,this.isConditionBodyVisible(n))});const i=(s??this.getJoinOperator())==="OR";this.eJoinOperatorsAnd.forEach((r,n)=>{r.setValue(!i,!0)}),this.eJoinOperatorsOr.forEach((r,n)=>{r.setValue(i,!0)}),this.forEachInput((r,n,o,a)=>{this.setElementDisplayed(r,n<a),this.setElementDisabled(r,this.isConditionDisabled(o,t))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(t){return t&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(t,s){if(t>=this.getNumConditions())return;this.removeComponents(this.eTypes,t,s),this.removeElements(this.eConditionBodies,t,s),this.removeValueElements(t,s);const i=Math.max(t-1,0);this.removeElements(this.eJoinOperatorPanels,i,s),this.removeComponents(this.eJoinOperatorsAnd,i,s),this.removeComponents(this.eJoinOperatorsOr,i,s)}removeElements(t,s,i){this.removeItems(t,s,i).forEach(n=>nn(n))}removeComponents(t,s,i){this.removeItems(t,s,i).forEach(n=>{nn(n.getGui()),this.destroyBean(n)})}removeItems(t,s,i){return i==null?t.splice(s):t.splice(s,i)}afterGuiAttached(t){if(super.afterGuiAttached(t),this.resetPlaceholder(),!(t!=null&&t.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{const s=this.getInputs(0)[0];if(!s)return;s instanceof on&&s.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const t=this.getModel();this.resetUiToActiveModel(t);let s=-1,i=-1,r=!1;const n=this.getJoinOperator();for(let a=this.getNumConditions()-1;a>=0;a--)if(this.isConditionUiComplete(a))s===-1&&(s=a,i=a);else{const l=a>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(a-1),u=a<s;(l||u)&&(this.removeConditionsAndOperators(a,1),r=!0,u&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,n),r&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getPlaceholderText(t,s){let i=this.translate(t);if(km(this.filterPlaceholder)){const r=this.filterPlaceholder,n=this.eTypes[s].getValue(),o=this.translate(n);i=r({filterOptionKey:n,filterOption:o,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){const t=this.localeService.getLocaleTextFunc();this.forEachInput((s,i,r,n)=>{if(!(s instanceof on))return;const o=i===0&&n>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",a=i===0&&n>1?t("ariaFilterFromValue","Filter from value"):i===0?t("ariaFilterValue","Filter Value"):t("ariaFilterToValue","Filter to Value");s.setInputPlaceholder(this.getPlaceholderText(o,r)),s.setInputAriaLabel(a)})}setElementValue(t,s,i){t instanceof on&&t.setValue(s!=null?String(s):null,!0)}setElementDisplayed(t,s){t instanceof at&&Dt(t.getGui(),s)}setElementDisabled(t,s){t instanceof at&&tu(t.getGui(),s)}attachElementOnChange(t,s){t instanceof on&&t.onValueChange(s)}forEachInput(t){this.getConditionTypes().forEach((s,i)=>{this.forEachPositionTypeInput(i,s,t)})}forEachPositionInput(t,s){const i=this.getConditionType(t);this.forEachPositionTypeInput(t,i,s)}forEachPositionTypeInput(t,s,i){const r=this.getNumberOfInputs(s),n=this.getInputs(t);for(let o=0;o<n.length;o++){const a=n[o];a!=null&&i(a,o,t,r)}}isConditionDisabled(t,s){return this.isReadOnly()?!0:t===0?!1:t>s+1}isConditionBodyVisible(t){const s=this.getConditionType(t);return this.getNumberOfInputs(s)>0}isConditionUiComplete(t){return!(t>=this.getNumConditions()||this.getConditionType(t)===rc.EMPTY||this.getValues(t).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const t=[];for(let s=0;s<this.getNumConditions();s++)this.isConditionUiComplete(s)&&t.push(this.createCondition(s));return t}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let t=this.getNumConditions();t<this.numAlwaysVisibleConditions;t++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(t){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(s=>this.resetType(s)),this.eJoinOperatorsAnd.forEach((s,i)=>this.resetJoinOperatorAnd(s,i,this.joinOperatorId+i)),this.eJoinOperatorsOr.forEach((s,i)=>this.resetJoinOperatorOr(s,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(s=>this.resetInput(s)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,t||this.onUiChanged(),Ps.resolve()}resetType(t){const i=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");t.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(t,s,i){this.resetJoinOperator(t,s,this.isDefaultOperator("AND"),this.translate("andCondition"),i)}resetJoinOperatorOr(t,s,i){this.resetJoinOperator(t,s,this.isDefaultOperator("OR"),this.translate("orCondition"),i)}resetJoinOperator(t,s,i,r,n){this.updateJoinOperatorDisabled(t.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${n}`).setLabel(r),s)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((t,s)=>this.updateJoinOperatorDisabled(t,s)),this.eJoinOperatorsOr.forEach((t,s)=>this.updateJoinOperatorDisabled(t,s))}updateJoinOperatorDisabled(t,s){t.setDisabled(this.isReadOnly()||s>0)}resetInput(t){this.setElementValue(t,null),this.setElementDisabled(t,this.isReadOnly())}setConditionIntoUi(t,s){const i=this.mapValuesFromModel(t);this.forEachInput((r,n,o,a)=>{o===s&&this.setElementValue(r,i[n]!=null?i[n]:null)})}setValueFromFloatingFilter(t){this.forEachInput((s,i,r,n)=>{this.setElementValue(s,i===0&&r===0?t:null,!0)})}isDefaultOperator(t){return t===this.defaultJoinOperator}addChangedListeners(t,s){this.isReadOnly()||(t.onValueChange(this.listener),this.forEachPositionInput(s,i=>{this.attachElementOnChange(i,this.listener)}))}individualConditionPasses(t,s){const i=this.getCellValue(t.node),r=this.mapValuesFromModel(s),n=this.optionsFactory.getCustomOption(s.type),o=this.evaluateCustomFilter(n,r,i);return o??(i==null?this.evaluateNullValue(s.type):this.evaluateNonNullValue(r,i,s,t))}evaluateCustomFilter(t,s,i){if(t==null)return;const{predicate:r}=t;if(r!=null&&!s.some(n=>n==null))return r(s,i)}isBlank(t){return t==null||typeof t=="string"&&t.trim().length===0}hasInvalidInputs(){return!1}};Ni.EMPTY="empty";Ni.BLANK="blank";Ni.NOT_BLANK="notBlank";Ni.EQUALS="equals";Ni.NOT_EQUAL="notEqual";Ni.LESS_THAN="lessThan";Ni.LESS_THAN_OR_EQUAL="lessThanOrEqual";Ni.GREATER_THAN="greaterThan";Ni.GREATER_THAN_OR_EQUAL="greaterThanOrEqual";Ni.IN_RANGE="inRange";Ni.CONTAINS="contains";Ni.NOT_CONTAINS="notContains";Ni.STARTS_WITH="startsWith";Ni.ENDS_WITH="endsWith";var ps=Ni,Fs=class ks extends ps{setParams(t){super.setParams(t),this.scalarFilterParams=t}evaluateNullValue(t){switch(t){case ks.EQUALS:case ks.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case ks.GREATER_THAN:case ks.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case ks.LESS_THAN:case ks.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case ks.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case ks.BLANK:return!0;case ks.NOT_BLANK:return!1}return!1}evaluateNonNullValue(t,s,i){const r=this.comparator(),n=t[0]!=null?r(t[0],s):0;switch(i.type){case ks.EQUALS:return n===0;case ks.NOT_EQUAL:return n!==0;case ks.GREATER_THAN:return n>0;case ks.GREATER_THAN_OR_EQUAL:return n>=0;case ks.LESS_THAN:return n<0;case ks.LESS_THAN_OR_EQUAL:return n<=0;case ks.IN_RANGE:{const o=r(t[1],s);return this.scalarFilterParams.inRangeInclusive?n>=0&&o<=0:n>0&&o<0}case ks.BLANK:return this.isBlank(s);case ks.NOT_BLANK:return!this.isBlank(s);default:return console.warn('AG Grid: Unexpected type of filter "'+i.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}},xE=1e3,bE=1/0,NF=class extends T0{constructor(e,t,s){super(t,s),this.dateFilterParams=e}conditionToString(e,t){const{type:s}=e,{numberOfInputs:i}=t||{},r=s==ps.IN_RANGE||i===2,n=Ui(e.dateFrom),o=Ui(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){const l=n!==null?_c(n,a):"null",u=o!==null?_c(o,a):"null";return`${l}-${u}`}return n!=null?_c(n,a):`${s}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},D0=class IF extends Fs{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=xE,this.maxValidYear=bE,this.minValidDate=null,this.maxValidDate=null}afterGuiAttached(t){super.afterGuiAttached(t),this.dateConditionFromComps[0].afterGuiAttached(t)}mapValuesFromModel(t){const{dateFrom:s,dateTo:i,type:r}=t||{};return[s&&Ui(s)||null,i&&Ui(i)||null].slice(0,this.getNumberOfInputs(r))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(t,s){const i=s;return s==null||i<t?-1:i>t?1:0}setParams(t){this.dateFilterParams=t,super.setParams(t);const s=(i,r)=>{if(t[i]!=null)if(isNaN(t[i]))console.warn(`AG Grid: DateFilter ${i} is not a number`);else return t[i]==null?r:Number(t[i]);return r};this.minValidYear=s("minValidYear",xE),this.maxValidYear=s("maxValidYear",bE),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),t.minValidDate?this.minValidDate=t.minValidDate instanceof Date?t.minValidDate:Ui(t.minValidDate):this.minValidDate=null,t.maxValidDate?this.maxValidDate=t.maxValidDate instanceof Date?t.maxValidDate:Ui(t.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&console.warn("AG Grid: DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new NF(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(t){const s=new xF(this.getContext(),this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},t);return this.addDestroyFunc(()=>s.destroy()),s}setElementValue(t,s){t.setDate(s)}setElementDisplayed(t,s){t.setDisplayed(s)}setElementDisabled(t,s){t.setDisabled(s)}getDefaultFilterOptions(){return IF.DEFAULT_FILTER_OPTIONS}createValueElement(){const s=this.gos.getDocument().createElement("div");return s.classList.add("ag-filter-body"),this.createFromToElement(s,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(s,this.eConditionPanelsTo,this.dateConditionToComps,"to"),s}createFromToElement(t,s,i,r){const o=this.gos.getDocument().createElement("div");o.classList.add(`ag-filter-${r}`),o.classList.add(`ag-filter-date-${r}`),s.push(o),t.appendChild(o),i.push(this.createDateCompWrapper(o))}removeValueElements(t,s){this.removeDateComps(this.dateConditionFromComps,t,s),this.removeDateComps(this.dateConditionToComps,t,s),this.removeItems(this.eConditionPanelsFrom,t,s),this.removeItems(this.eConditionPanelsTo,t,s)}removeDateComps(t,s,i){this.removeItems(t,s,i).forEach(n=>n.destroy())}isValidDateValue(t){if(t===null)return!1;if(this.minValidDate){if(t<this.minValidDate)return!1}else if(t.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(t>this.maxValidDate)return!1}else if(t.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(t){if(!super.isConditionUiComplete(t))return!1;let s=!0;return this.forEachInput((i,r,n,o)=>{n!==t||!s||r>=o||(s=s&&this.isValidDateValue(i.getDate()))}),s}areSimpleModelsEqual(t,s){return t.dateFrom===s.dateFrom&&t.dateTo===s.dateTo&&t.type===s.type}getFilterType(){return"date"}createCondition(t){const s=this.getConditionType(t),i={},r=this.getValues(t);return r.length>0&&(i.dateFrom=_r(r[0])),r.length>1&&(i.dateTo=_r(r[1])),Xe({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:s},i)}resetPlaceholder(){const t=this.localeService.getLocaleTextFunc(),s=this.translate("dateFormatOoo"),i=t("ariaFilterValue","Filter Value");this.forEachInput(r=>{r.setInputPlaceholder(s),r.setInputAriaLabel(i)})}getInputs(t){return t>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[t],this.dateConditionToComps[t]]}getValues(t){const s=[];return this.forEachPositionInput(t,(i,r,n,o)=>{r<o&&s.push(i.getDate())}),s}translate(t){return t===Fs.LESS_THAN?super.translate("before"):t===Fs.GREATER_THAN?super.translate("after"):super.translate(t)}getModelAsString(t){var s;return(s=this.filterModelFormatter.getModelAsString(t))!=null?s:""}};D0.DEFAULT_FILTER_OPTIONS=[Fs.EQUALS,Fs.NOT_EQUAL,Fs.LESS_THAN,Fs.GREATER_THAN,Fs.IN_RANGE,Fs.BLANK,Fs.NOT_BLANK];f([A("userComponentFactory")],D0.prototype,"userComponentFactory",2);var _F=D0,P0=class extends at{getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return e==null?void 0:e.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.getDefaultOption();return}const t=e.operator;let s;t?s=e.conditions[0]:s=e,this.lastType=s.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const s=e;return this.isTypeEditable(s.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){this.optionsFactory=new bF,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),t||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!e.filterParams.readOnly;const s=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(s)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.setSimpleParams(e)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:s}=t||{};return s==null||s==1}isTypeEditable(e){const t=[ps.IN_RANGE,ps.EMPTY,ps.BLANK,ps.NOT_BLANK];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),s=this.localeService.getLocaleTextFunc();return`${t} ${s("ariaFilterInput","Filter Input")}`}};f([A("columnModel")],P0.prototype,"columnModel",2);var qm=class extends P0{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>
                <div ref="eDateWrapper" style="display: flex;"></div>
            </div>`)}getDefaultFilterOptions(){return _F.DEFAULT_FILTER_OPTIONS}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new NF(this.filterParams,this.localeService,this.optionsFactory);const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){if(e){const s=e;this.dateComp.setDate(Ui(s.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Dt(this.eDateWrapper,e),Dt(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=this.dateComp.getDate(),t=_r(e);this.params.parentFilterInstance(s=>{if(s){const i=Ui(t);s.onFloatingFilterChanged(this.getLastType()||null,i)}})}getDateComponentParams(){const e=Pf.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:xi(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new xF(this.getContext(),this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,e=>{e.setInputAriaLabel(this.getAriaLabel(this.params))}),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const e=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(e)}getFilterModelFormatter(){return this.filterModelFormatter}};f([A("userComponentFactory")],qm.prototype,"userComponentFactory",2);f([Fe("eReadOnlyText")],qm.prototype,"eReadOnlyText",2);f([Fe("eDateWrapper")],qm.prototype,"eDateWrapper",2);var kF=class extends at{constructor(){super(`
            <div class="ag-filter-filter">
                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListener(t,"mousedown",()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus()}),this.addManagedListener(t,"input",s=>{s.target===this.gos.getActiveDomElement()&&(this.eDateInput.isDisabled()||this.params.onDateChanged())})}setParams(e){const t=this.eDateInput.getInputElement(),s=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=s&&Gn(),t.type=s?"date":"text";const{minValidYear:i,maxValidYear:r,minValidDate:n,maxValidDate:o}=e.filterParams||{};if(n&&i&&tt("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),o&&r&&tt("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),n&&o){const[a,l]=[n,o].map(u=>u instanceof Date?u:Ui(u));a&&l&&a.getTime()>l.getTime()&&tt("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}n?n instanceof Date?t.min=_c(n):t.min=n:i&&(t.min=`${i}-01-01`),o?o instanceof Date?t.max=_c(o):t.max=o:r&&(t.max=`${r}-12-31`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}getDate(){return Ui(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(_r(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&e.filterParams.browserDatePicker!=null?e.filterParams.browserDatePicker:Hm()||a0()||Gn()&&o0()>=14.1}};f([Fe("eDateInput")],kF.prototype,"eDateInput",2);var Wl=class extends on{constructor(e,t="ag-text-field",s="text"){super(e,t,s)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){return this.eInput.value!==e&&(this.eInput.value=ve(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=s=>{Wm(s)&&s.key&&!e.test(s.key)&&s.preventDefault()};this.addManagedListener(this.eInput,"keydown",t),this.addManagedListener(this.eInput,"paste",s=>{var i;const r=(i=s.clipboardData)==null?void 0:i.getData("text");r&&r.split("").some(n=>!e.test(n))&&s.preventDefault()})}},A0=class extends Wl{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"blur",()=>{const r=parseFloat(this.eInput.value),n=isNaN(r)?"":this.normalizeValue(r.toString());this.value!==n&&this.setValue(n)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any";const{precision:e,min:t,max:s,step:i}=this.config;typeof e=="number"&&this.setPrecision(e),typeof t=="number"&&this.setMin(t),typeof s=="number"&&this.setMax(s),typeof i=="number"&&this.setStep(i)}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}normalizeValue(e){if(e==="")return"";this.precision!=null&&(e=this.adjustPrecision(e));const t=parseFloat(e);return this.min!=null&&t<this.min?e=this.min.toString():this.max!=null&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(this.precision==null)return e;if(t){const i=parseFloat(e).toFixed(this.precision);return parseFloat(i).toString()}const s=String(e).split(".");if(s.length>1){if(s[1].length<=this.precision)return e;if(this.precision>0)return`${s[0]}.${s[1].slice(0,this.precision)}`}return s[0]}setMin(e){return this.min===e?this:(this.min=e,Ln(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,Ln(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,Ln(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(s=>super.setValue(s,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,s){if(ve(s)){let i=this.isScientificNotation(s);if(i&&this.eInput.validity.valid)return e(s);if(!i){s=this.adjustPrecision(s);const r=this.normalizeValue(s);i=s!=r}if(i)return t(s)}return e(s)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},MF=class extends T0{conditionToString(e,t){const{numberOfInputs:s}=t||{};return e.type==ps.IN_RANGE||s===2?`${this.formatValue(e.filter)}-${this.formatValue(e.filterTo)}`:e.filter!=null?this.formatValue(e.filter):`${e.type}`}};function tw(e){const{allowedCharPattern:t}=e??{};return t??null}var LF=class OF extends Fs{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(t){return this.numberFilterParams.allowedCharPattern!==t.allowedCharPattern?!1:super.refresh(t)}mapValuesFromModel(t){const{filter:s,filterTo:i,type:r}=t||{};return[this.processValue(s),this.processValue(i)].slice(0,this.getNumberOfInputs(r))}getDefaultDebounceMs(){return 500}comparator(){return(t,s)=>t===s?0:t<s?1:-1}setParams(t){this.numberFilterParams=t,super.setParams(t),this.filterModelFormatter=new MF(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return OF.DEFAULT_FILTER_OPTIONS}setElementValue(t,s,i){const r=!i&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(s??null):s;super.setElementValue(t,r)}createValueElement(){const t=tw(this.numberFilterParams),s=document.createElement("div");return s.classList.add("ag-filter-body"),fs(s,"presentation"),this.createFromToElement(s,this.eValuesFrom,"from",t),this.createFromToElement(s,this.eValuesTo,"to",t),s}createFromToElement(t,s,i,r){const n=this.createManagedBean(r?new Wl({allowedCharPattern:r}):new A0);n.addCssClass(`ag-filter-${i}`),n.addCssClass("ag-filter-filter"),s.push(n),t.appendChild(n.getGui())}removeValueElements(t,s){this.removeComponents(this.eValuesFrom,t,s),this.removeComponents(this.eValuesTo,t,s)}getValues(t){const s=[];return this.forEachPositionInput(t,(i,r,n,o)=>{r<o&&s.push(this.processValue(this.stringToFloat(i.getValue())))}),s}areSimpleModelsEqual(t,s){return t.filter===s.filter&&t.filterTo===s.filterTo&&t.type===s.type}getFilterType(){return"number"}processValue(t){return t==null||isNaN(t)?null:t}stringToFloat(t){if(typeof t=="number")return t;let s=Mn(t);return s!=null&&s.trim()===""&&(s=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(s):s==null||s.trim()==="-"?null:parseFloat(s)}createCondition(t){const s=this.getConditionType(t),i={filterType:this.getFilterType(),type:s},r=this.getValues(t);return r.length>0&&(i.filter=r[0]),r.length>1&&(i.filterTo=r[1]),i}getInputs(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]}getModelAsString(t){var s;return(s=this.filterModelFormatter.getModelAsString(t))!=null?s:""}hasInvalidInputs(){let t=!1;return this.forEachInput(s=>{if(!s.getInputElement().validity.valid){t=!0;return}}),t}};LF.DEFAULT_FILTER_OPTIONS=[Fs.EQUALS,Fs.NOT_EQUAL,Fs.GREATER_THAN,Fs.GREATER_THAN_OR_EQUAL,Fs.LESS_THAN,Fs.LESS_THAN_OR_EQUAL,Fs.IN_RANGE,Fs.BLANK,Fs.NOT_BLANK];var GF=LF,VF=class extends T0{conditionToString(e,t){const{numberOfInputs:s}=t||{};return e.type==ps.IN_RANGE||s===2?`${e.filter}-${e.filterTo}`:e.filter!=null?`${e.filter}`:`${e.type}`}},en=class nc extends ps{constructor(){super("textFilter"),this.eValuesFrom=[],this.eValuesTo=[]}static trimInput(t){const s=t&&t.trim();return s===""?t:s}getDefaultDebounceMs(){return 500}setParams(t){this.textFilterParams=t,super.setParams(t),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?nc.DEFAULT_FORMATTER:nc.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new VF(this.localeService,this.optionsFactory)}getTextMatcher(){const t=this.textFilterParams.textCustomComparator;return t?(nt.warnOnce("textCustomComparator is deprecated, use textMatcher instead."),({filterOption:s,value:i,filterText:r})=>t(s,i,r)):this.textFilterParams.textMatcher||nc.DEFAULT_MATCHER}createCondition(t){const s=this.getConditionType(t),i={filterType:this.getFilterType(),type:s},r=this.getValuesWithSideEffects(t,!0);return r.length>0&&(i.filter=r[0]),r.length>1&&(i.filterTo=r[1]),i}getFilterType(){return"text"}areSimpleModelsEqual(t,s){return t.filter===s.filter&&t.filterTo===s.filterTo&&t.type===s.type}getInputs(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]}getValues(t){return this.getValuesWithSideEffects(t,!1)}getValuesWithSideEffects(t,s){const i=[];return this.forEachPositionInput(t,(r,n,o,a)=>{var l;if(n<a){let u=Mn(r.getValue());s&&this.textFilterParams.trimInput&&(u=(l=nc.trimInput(u))!=null?l:null,r.setValue(u,!0)),i.push(u)}}),i}getDefaultFilterOptions(){return nc.DEFAULT_FILTER_OPTIONS}createValueElement(){const t=document.createElement("div");return t.classList.add("ag-filter-body"),fs(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from"),this.createFromToElement(t,this.eValuesTo,"to"),t}createFromToElement(t,s,i){const r=this.createManagedBean(new Wl);r.addCssClass(`ag-filter-${i}`),r.addCssClass("ag-filter-filter"),s.push(r),t.appendChild(r.getGui())}removeValueElements(t,s){this.removeComponents(this.eValuesFrom,t,s),this.removeComponents(this.eValuesTo,t,s)}mapValuesFromModel(t){const{filter:s,filterTo:i,type:r}=t||{};return[s||null,i||null].slice(0,this.getNumberOfInputs(r))}evaluateNullValue(t){const s=[ps.NOT_EQUAL,ps.NOT_CONTAINS,ps.BLANK];return t?s.indexOf(t)>=0:!1}evaluateNonNullValue(t,s,i,r){const n=t.map(C=>this.formatter(C))||[],o=this.formatter(s),{api:a,colDef:l,column:u,columnApi:h,context:p,textFormatter:g}=this.textFilterParams;if(i.type===ps.BLANK)return this.isBlank(s);if(i.type===ps.NOT_BLANK)return!this.isBlank(s);const m={api:a,colDef:l,column:u,columnApi:h,context:p,node:r.node,data:r.data,filterOption:i.type,value:o,textFormatter:g};return n.some(C=>this.matcher(rs(Xe({},m),{filterText:C})))}getModelAsString(t){var s;return(s=this.filterModelFormatter.getModelAsString(t))!=null?s:""}};en.DEFAULT_FILTER_OPTIONS=[ps.CONTAINS,ps.NOT_CONTAINS,ps.EQUALS,ps.NOT_EQUAL,ps.STARTS_WITH,ps.ENDS_WITH,ps.BLANK,ps.NOT_BLANK];en.DEFAULT_FORMATTER=e=>e;en.DEFAULT_LOWERCASE_FORMATTER=e=>e==null?null:e.toString().toLowerCase();en.DEFAULT_MATCHER=({filterOption:e,value:t,filterText:s})=>{if(s==null)return!1;switch(e){case en.CONTAINS:return t.indexOf(s)>=0;case en.NOT_CONTAINS:return t.indexOf(s)<0;case en.EQUALS:return t===s;case en.NOT_EQUAL:return t!=s;case en.STARTS_WITH:return t.indexOf(s)===0;case en.ENDS_WITH:const i=t.lastIndexOf(s);return i>=0&&i===t.length-s.length;default:return!1}};var F0=en,BF=class extends Se{constructor(e){super(),this.params=e,this.valueChangedListener=()=>{}}setupGui(e){var t;this.eFloatingFilterTextInput=this.createManagedBean(new Wl((t=this.params)==null?void 0:t.config));const s=this.eFloatingFilterTextInput.getGui();e.appendChild(s),this.addManagedListener(s,"input",i=>this.valueChangedListener(i)),this.addManagedListener(s,"keydown",i=>this.valueChangedListener(i))}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}setAutoComplete(e){this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}setValueChangedListener(e){this.valueChangedListener=e}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterTextInput.setInputAriaLabel(e)}},Qm=class extends P0{postConstruct(){this.setTemplate(`
            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>
        `)}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.floatingFilterInputService=this.createFloatingFilterInputService(e),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){var t;this.params=e;const s=(t=e.browserAutoComplete)!=null?t:!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:s}),this.applyActive=Pf.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){const i=Pf.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),r=xi(this.syncUpWithParentFilter.bind(this),i);this.floatingFilterInputService.setValueChangedListener(r)}}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const t=this.floatingFilterInputService.getValue();xs(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(e),this.floatingFilterInputService.setValue(t,!0)}syncUpWithParentFilter(e){const t=e.key===U.ENTER;if(this.applyActive&&!t)return;let s=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(s=F0.trimInput(s),this.floatingFilterInputService.setValue(s,!0)),this.params.parentFilterInstance(i=>{i&&i.onFloatingFilterChanged(this.getLastType()||null,s||null)})}setEditable(e){this.floatingFilterInputService.setEditable(e)}};f([Fe("eFloatingFilterInputContainer")],Qm.prototype,"eFloatingFilterInputContainer",2);f([xe],Qm.prototype,"postConstruct",1);var hO=class extends Se{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new A0),this.eFloatingFilterTextInput=this.createManagedBean(new Wl),this.eFloatingFilterTextInput.setDisabled(!0);const t=this.eFloatingFilterNumberInput.getGui(),s=this.eFloatingFilterTextInput.getGui();e.appendChild(t),e.appendChild(s),this.setupListeners(t,i=>this.valueChangedListener(i)),this.setupListeners(s,i=>this.valueChangedListener(i))}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eFloatingFilterNumberInput.setAutoComplete(e),this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(e){this.valueChangedListener=e}setupListeners(e,t){this.addManagedListener(e,"input",t),this.addManagedListener(e,"keydown",t)}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterNumberInput.setInputAriaLabel(e),this.eFloatingFilterTextInput.setInputAriaLabel(e)}},pO=class extends Qm{init(e){var t;super.init(e),this.filterModelFormatter=new MF(this.localeService,this.optionsFactory,(t=e.filterParams)==null?void 0:t.numberFormatter)}onParamsUpdated(e){this.refresh(e)}refresh(e){tw(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return GF.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.allowedCharPattern=tw(e.filterParams),this.allowedCharPattern?this.createManagedBean(new BF({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new hO)}},gO=class extends Qm{init(e){super.init(e),this.filterModelFormatter=new VF(this.localeService,this.optionsFactory)}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return F0.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new BF)}},yp=class md{constructor(t,s=!1){this.destroyFuncs=[],this.touching=!1,this.eventService=new pn,this.eElement=t,this.preventMouseClick=s;const i=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),n=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",i,{passive:!0}),this.eElement.addEventListener("touchmove",r,{passive:!0}),this.eElement.addEventListener("touchend",n,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",i,{passive:!0}),this.eElement.removeEventListener("touchmove",r,{passive:!0}),this.eElement.removeEventListener("touchend",n,{passive:!1})})}getActiveTouch(t){for(let s=0;s<t.length;s++)if(t[s].identifier===this.touchStart.identifier)return t[s];return null}addEventListener(t,s){this.eventService.addEventListener(t,s)}removeEventListener(t,s){this.eventService.removeEventListener(t,s)}onTouchStart(t){if(this.touching)return;this.touchStart=t.touches[0],this.touching=!0,this.moved=!1;const s=this.touchStart;window.setTimeout(()=>{const i=this.touchStart===s;if(this.touching&&i&&!this.moved){this.moved=!0;const r={type:md.EVENT_LONG_TAP,touchStart:this.touchStart,touchEvent:t};this.eventService.dispatchEvent(r)}},500)}onTouchMove(t){if(!this.touching)return;const s=this.getActiveTouch(t.touches);if(!s)return;!x0(s,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(t){if(this.touching){if(!this.moved){const s={type:md.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(s),this.checkForDoubleTap()}this.preventMouseClick&&t.cancelable&&t.preventDefault(),this.touching=!1}}checkForDoubleTap(){const t=new Date().getTime();if(this.lastTapTime&&this.lastTapTime>0)if(t-this.lastTapTime>md.DOUBLE_TAP_MILLIS){const i={type:md.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(i),this.lastTapTime=null}else this.lastTapTime=t;else this.lastTapTime=t}destroy(){this.destroyFuncs.forEach(t=>t())}};yp.EVENT_TAP="tap";yp.EVENT_DOUBLE_TAP="doubleTap";yp.EVENT_LONG_TAP="longTap";yp.DOUBLE_TAP_MILLIS=500;var Ws=yp,So=class HF extends at{constructor(t){super(),t||this.setTemplate(HF.TEMPLATE)}attachCustomElements(t,s,i,r,n){this.eSortOrder=t,this.eSortAsc=s,this.eSortDesc=i,this.eSortMixed=r,this.eSortNone=n}setupSort(t,s=!1){this.column=t,this.suppressOrder=s,this.setupMultiSortIndicator(),!(!this.column.isSortable()&&!this.column.getColDef().showRowGroup)&&(this.addInIcon("sortAscending",this.eSortAsc,t),this.addInIcon("sortDescending",this.eSortDesc,t),this.addInIcon("sortUnSort",this.eSortNone,t),this.addManagedPropertyListener("unSortIcon",()=>this.updateIcons()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.updateIcons()),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,()=>this.onSortChanged()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.onSortChanged()),this.onSortChanged())}addInIcon(t,s,i){if(s==null)return;const r=cs(t,this.gos,i);r&&s.appendChild(r)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const t=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const s=t==="asc";Dt(this.eSortAsc,s,{skipAriaHidden:!0})}if(this.eSortDesc){const s=t==="desc";Dt(this.eSortDesc,s,{skipAriaHidden:!0})}if(this.eSortNone){const s=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),i=t==null;Dt(this.eSortNone,!s&&i,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const t=this.column.getColDef().showRowGroup;this.gos.isColumnsSortingCoupledToGroup()&&t&&(this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,()=>this.updateMultiSortIndicator()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateMultiSortIndicator()),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const t=this.sortController.getDisplaySortForColumn(this.column)==="mixed";Dt(this.eSortMixed,t,{skipAriaHidden:!0})}}updateSortOrder(){var t;if(!this.eSortOrder)return;const s=this.sortController.getColumnsWithSortingOrdered(),i=(t=this.sortController.getDisplaySortIndexForColumn(this.column))!=null?t:-1,r=s.some(o=>{var a;return(a=this.sortController.getDisplaySortIndexForColumn(o))!=null?a:!1}),n=i>=0&&r;Dt(this.eSortOrder,n,{skipAriaHidden:!0}),i>=0?this.eSortOrder.textContent=(i+1).toString():xs(this.eSortOrder)}};So.TEMPLATE=`<span class="ag-sort-indicator-container">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>
        </span>`;f([Fe("eSortOrder")],So.prototype,"eSortOrder",2);f([Fe("eSortAsc")],So.prototype,"eSortAsc",2);f([Fe("eSortDesc")],So.prototype,"eSortDesc",2);f([Fe("eSortMixed")],So.prototype,"eSortMixed",2);f([Fe("eSortNone")],So.prototype,"eSortNone",2);f([A("columnModel")],So.prototype,"columnModel",2);f([A("sortController")],So.prototype,"sortController",2);var N0=So,pi=class jF extends at{constructor(){super(...arguments),this.lastMovingChanged=0}destroy(){super.destroy()}refresh(t){const s=this.params;return this.params=t,this.workOutTemplate()!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||this.workOutSort()!=this.currentSort||this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||s.enableFilterButton!=t.enableFilterButton||s.enableFilterIcon!=t.enableFilterIcon?!1:(this.setDisplayName(t),!0)}workOutTemplate(){var t;let s=(t=this.params.template)!=null?t:jF.TEMPLATE;return s=s&&s.trim?s.trim():s,s}init(t){this.params=t,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(t)}setDisplayName(t){if(this.currentDisplayName!=t.displayName){this.currentDisplayName=t.displayName;const s=Ds(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=s)}}addInIcon(t,s,i){if(s==null)return;const r=cs(t,this.gos,i);r&&s.appendChild(r)}setupTap(){const{gos:t}=this;if(t.get("suppressTouch"))return;const s=new Ws(this.getGui(),!0),i=this.shouldSuppressMenuHide(),r=i&&ve(this.eMenu),n=r?new Ws(this.eMenu,!0):s;if(this.params.enableMenu){const o=r?"EVENT_TAP":"EVENT_LONG_TAP",a=l=>this.params.showColumnMenuAfterMouseClick(l.touchStart);this.addManagedListener(n,Ws[o],a)}if(this.params.enableSorting){const o=a=>{var l,u;const h=a.touchStart.target;i&&((l=this.eMenu)!=null&&l.contains(h)||(u=this.eFilterButton)!=null&&u.contains(h))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListener(s,Ws.EVENT_TAP,o)}if(this.params.enableFilterButton){const o=new Ws(this.eFilterButton,!0);this.addManagedListener(o,"tap",()=>this.params.showFilter(this.eFilterButton)),this.addDestroyFunc(()=>o.destroy())}this.addDestroyFunc(()=>s.destroy()),r&&this.addDestroyFunc(()=>n.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){nn(this.eMenu),this.eMenu=void 0;return}const t=this.menuService.isLegacyMenuEnabled();this.addInIcon(t?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!t),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedListener(this.eMenu,"click",()=>this.params.showColumnMenu(this.eMenu)),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(t){var s,i,r,n;const{column:o}=this.params,a=this.menuService.isLegacyMenuEnabled();if(t&&!a){if(this.menuService.isFilterMenuInHeaderEnabled(o))return this.params.showFilter((i=(s=this.eFilterButton)!=null?s:this.eMenu)!=null?i:this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu((n=(r=this.eMenu)!=null?r:this.eFilterButton)!=null?n:this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new N0(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListener(this.params.column,Kt.EVENT_MOVING_CHANGED,()=>{this.lastMovingChanged=new Date().getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",s=>{const i=this.params.column.isMoving(),n=new Date().getTime()-this.lastMovingChanged<50;if(!(i||n)){const l=this.gos.get("multiSortKey")==="ctrl"?s.ctrlKey||s.metaKey:s.shiftKey;this.params.progressSort(l)}});const t=()=>{if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",this.params.column.isSortAscending()),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",this.params.column.isSortDescending()),this.addOrRemoveCssClass("ag-header-cell-sorted-none",this.params.column.isSortNone()),this.params.column.getColDef().showRowGroup){const s=this.columnModel.getSourceColumnsForGroupColumn(this.params.column),r=!(s==null?void 0:s.every(n=>this.params.column.getSort()==n.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",r)}};this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,t),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedListener(this.eFilterButton,"click",()=>this.params.showFilter(this.eFilterButton)):this.eFilterButton=void 0}configureFilter(t,s,i){if(!t)return nn(s),!1;const{column:r}=this.params;return this.addInIcon("filter",s,r),this.addManagedListener(r,Kt.EVENT_FILTER_CHANGED,i),i(),!0}onFilterChangedIcon(){const t=this.params.column.isFilterActive();Dt(this.eFilter,t,{skipAriaHidden:!0})}onFilterChangedButton(){const t=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",t)}getAnchorElementForMenu(t){var s,i,r,n;return t?(i=(s=this.eFilterButton)!=null?s:this.eMenu)!=null?i:this.getGui():(n=(r=this.eMenu)!=null?r:this.eFilterButton)!=null?n:this.getGui()}};pi.TEMPLATE=`<div class="ag-cell-label-container" role="presentation">
            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>
            <span ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text"></span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>
                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>
            </div>
        </div>`;f([A("sortController")],pi.prototype,"sortController",2);f([A("menuService")],pi.prototype,"menuService",2);f([A("columnModel")],pi.prototype,"columnModel",2);f([Fe("eFilter")],pi.prototype,"eFilter",2);f([Fe("eFilterButton")],pi.prototype,"eFilterButton",2);f([Fe("eSortIndicator")],pi.prototype,"eSortIndicator",2);f([Fe("eMenu")],pi.prototype,"eMenu",2);f([Fe("eLabel")],pi.prototype,"eLabel",2);f([Fe("eText")],pi.prototype,"eText",2);f([Fe("eSortOrder")],pi.prototype,"eSortOrder",2);f([Fe("eSortAsc")],pi.prototype,"eSortAsc",2);f([Fe("eSortDesc")],pi.prototype,"eSortDesc",2);f([Fe("eSortMixed")],pi.prototype,"eSortMixed",2);f([Fe("eSortNone")],pi.prototype,"eSortNone",2);var sw=pi,wp=class WF extends at{constructor(){super(WF.TEMPLATE)}destroy(){super.destroy()}init(t){this.params=t,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&tt("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");const t=r=>{if(un(r))return;const n=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")};this.addTouchAndClickListeners(this.eCloseIcon,t),this.addTouchAndClickListeners(this.eOpenIcon,t);const s=r=>{gn(r)};this.addManagedListener(this.eCloseIcon,"dblclick",s),this.addManagedListener(this.eOpenIcon,"dblclick",s),this.addManagedListener(this.getGui(),"dblclick",t),this.updateIconVisibility();const i=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(i,Rs.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(i,Rs.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}addTouchAndClickListeners(t,s){const i=new Ws(t,!0);this.addManagedListener(i,Ws.EVENT_TAP,s),this.addDestroyFunc(()=>i.destroy()),this.addManagedListener(t,"click",s)}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const s=this.params.columnGroup.isExpanded();Dt(this.eOpenIcon,s),Dt(this.eCloseIcon,!s)}else Dt(this.eOpenIcon,!1),Dt(this.eCloseIcon,!1)}addInIcon(t,s){const i=cs(t,this.gos,null);i&&this.getRefElement(s).appendChild(i)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable()){Dt(this.eOpenIcon,!1),Dt(this.eCloseIcon,!1);return}}setupLabel(){var t;const{displayName:s,columnGroup:i}=this.params;if(ve(s)){const r=Ds(s,!0);this.getRefElement("agLabel").textContent=r}this.addOrRemoveCssClass("ag-sticky-label",!((t=i.getColGroupDef())!=null&&t.suppressStickyLabel))}};wp.TEMPLATE=`<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">
            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>
            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>
            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>
        </div>`;f([A("columnModel")],wp.prototype,"columnModel",2);f([Fe("agOpened")],wp.prototype,"eOpenIcon",2);f([Fe("agClosed")],wp.prototype,"eCloseIcon",2);var fO=wp,zl=class extends at{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},I0=class zF extends zl{constructor(){super(zF.TEMPLATE)}init(t){this.params=t,this.focusAfterAttached=t.cellStartedEdit,this.eTextArea.setMaxLength(t.maxLength||200).setCols(t.cols||60).setRows(t.rows||10),ve(t.value,!0)&&this.eTextArea.setValue(t.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(t){const s=t.key;(s===U.LEFT||s===U.UP||s===U.RIGHT||s===U.DOWN||t.shiftKey&&s===U.ENTER)&&t.stopPropagation()}afterGuiAttached(){const t=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(t("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const t=this.eTextArea.getValue();return!ve(t)&&!ve(this.params.value)?this.params.value:this.params.parseValue(t)}};I0.TEMPLATE=`<div class="ag-large-text">
            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>
        </div>`;f([Fe("eTextArea")],I0.prototype,"eTextArea",2);var mO=I0,_0=class extends zl{constructor(){super(`<div class="ag-cell-edit-wrapper">
                <ag-select class="ag-cell-editor" ref="eSelect"></ag-select>
            </div>`),this.startedByEnter=!1}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueService:s,gos:i}=this,{values:r,value:n,eventKey:o}=e;if(ot(r)){console.warn("AG Grid: no values found for select cellEditor");return}this.startedByEnter=o!=null?o===U.ENTER:!1;let a=!1;r.forEach(p=>{const g={value:p},m=s.formatValue(e.column,null,p),C=m!=null;g.text=C?m:p,t.addOption(g),a=a||n===p}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:u,valueListMaxHeight:h}=e;l!=null&&t.setPickerGap(l),h!=null&&t.setPickerMaxHeight(h),u!=null&&t.setPickerMaxWidth(u),i.get("editType")!=="fullRow"&&this.addManagedListener(this.eSelect,Km.EVENT_ITEM_SELECTED,()=>e.stopEditing())}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}};f([A("valueService")],_0.prototype,"valueService",2);f([Fe("eSelect")],_0.prototype,"eSelect",2);var Sp=class extends zl{constructor(e){super(`
            <div class="ag-cell-edit-wrapper">
                ${e.getTemplate()}
            </div>`),this.cellEditorInput=e}init(e){this.params=e;const t=this.eInput;this.cellEditorInput.init(t,e);let s;if(e.cellStartedEdit){this.focusAfterAttached=!0;const i=e.eventKey;i===U.BACKSPACE||e.eventKey===U.DELETE?s="":i&&i.length===1?s=i:(s=this.cellEditorInput.getStartValue(),i!==U.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,s=this.cellEditorInput.getStartValue();s!=null&&t.setStartValue(s),this.addManagedListener(t.getGui(),"keydown",i=>{const{key:r}=i;(r===U.PAGE_UP||r===U.PAGE_DOWN)&&i.preventDefault()})}afterGuiAttached(){var e,t;const s=this.localeService.getLocaleTextFunc(),i=this.eInput;if(i.setInputAriaLabel(s("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Gn()||i.getFocusableElement().focus();const r=i.getInputElement();this.highlightAllOnFocus?r.select():(t=(e=this.cellEditorInput).setCaret)==null||t.call(e)}focusIn(){const e=this.eInput,t=e.getFocusableElement(),s=e.getInputElement();t.focus(),s.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}};f([Fe("eInput")],Sp.prototype,"eInput",2);var vO=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}init(e,t){this.eInput=e,this.params=t,t.maxLength!=null&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return!ve(e)&&!ve(this.params.value)?this.params.value:this.params.parseValue(e)}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=ve(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}},EE=class extends Sp{constructor(){super(new vO)}},CO="",yO="",UF=class extends at{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-change-delta");const s=document.createElement("span");s.setAttribute("class","ag-value-change-value"),e.appendChild(t),e.appendChild(s),this.setTemplateFromElement(e)}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e,!0)}showDelta(e,t){const s=Math.abs(t),i=e.formatValue(s),r=ve(i)?i:s,n=t>=0;n?this.eDelta.textContent=CO+r:this.eDelta.textContent=yO+r,this.eDelta.classList.toggle("ag-value-change-delta-up",n),this.eDelta.classList.toggle("ag-value-change-delta-down",!n)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),xs(this.eDelta)}refresh(e,t=!1){const s=e.value;if(s===this.lastValue||(ve(e.valueFormatted)?this.eValue.textContent=e.valueFormatted:ve(e.value)?this.eValue.textContent=s:xs(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering()))return!1;if(typeof s=="number"&&typeof this.lastValue=="number"){const i=s-this.lastValue;this.showDelta(e,i)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=s,!0}};f([A("filterManager")],UF.prototype,"filterManager",2);var $F=class extends at{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-slide-current"),e.appendChild(t),this.setTemplateFromElement(e),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const t=document.createElement("span");t.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=t,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let s=e.value;return ot(s)&&(s=""),s===this.lastValue||this.filterManager.isSuppressFlashingCellsBecauseFiltering()?!1:(t||this.addSlideAnimation(),this.lastValue=s,ve(e.valueFormatted)?this.eCurrent.textContent=e.valueFormatted:ve(e.value)?this.eCurrent.textContent=s:xs(this.eCurrent),!0)}};f([A("filterManager")],$F.prototype,"filterManager",2);var ns=class qt{constructor(t){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=qt.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}setData(t){this.setDataCommon(t,!1)}updateData(t){this.setDataCommon(t,!0)}setDataCommon(t,s){const i=this.data;this.data=t,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const r=this.createDataChangedEvent(t,i,s);this.dispatchLocalEvent(r)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(t,s,i){return{type:qt.EVENT_DATA_CHANGED,node:this,oldData:s,newData:t,update:i}}createLocalRowEvent(t){return{type:t,node:this}}getRowIndexString(){return this.rowPinned==="top"?"t-"+this.rowIndex:this.rowPinned==="bottom"?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const t=new qt(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}setDataAndId(t,s){const i=ve(this.id)?this.createDaemonNode():null,r=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(s),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,i);const n=this.createDataChangedEvent(t,r,!1);this.dispatchLocalEvent(n)}checkRowSelectable(){const t=this.beans.gos.get("isRowSelectable");this.setRowSelectable(t?t(this):!0)}setRowSelectable(t,s){if(this.selectable!==t){if(this.selectable=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_SELECTABLE_CHANGED)),s)return;if(this.beans.gos.get("groupSelectsChildren")){const r=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:r??!1,source:"selectableChanged"});return}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(t){const s=this.beans.gos.getCallback("getRowId");if(s)if(this.data){const i=this.getGroupKeys(!0);this.id=s({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level}),this.id!==null&&typeof this.id=="string"&&this.id.startsWith(qt.ID_PREFIX_ROW_GROUP)&&console.error(`AG Grid: Row IDs cannot start with ${qt.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`),this.id!==null&&typeof this.id!="string"&&(this.id=""+this.id)}else this.id=void 0;else this.id=t}getGroupKeys(t=!1){const s=[];let i=this;for(t&&(i=i.parent);i&&i.level>=0;)s.push(i.key),i=i.parent;return s.reverse(),s}isPixelInRange(t){return!ve(this.rowTop)||!ve(this.rowHeight)?!1:t>=this.rowTop&&t<this.rowTop+this.rowHeight}setFirstChild(t){this.firstChild!==t&&(this.firstChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_FIRST_CHILD_CHANGED)))}setLastChild(t){this.lastChild!==t&&(this.lastChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_LAST_CHILD_CHANGED)))}setChildIndex(t){this.childIndex!==t&&(this.childIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_CHILD_INDEX_CHANGED)))}setRowTop(t){this.oldRowTop=this.rowTop,this.rowTop!==t&&(this.rowTop=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_TOP_CHANGED)),this.setDisplayed(t!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(t){this.displayed!==t&&(this.displayed=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_DISPLAYED_CHANGED)))}setDragging(t){this.dragging!==t&&(this.dragging=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_DRAGGING_CHANGED)))}setHighlighted(t){t!==this.highlighted&&(this.highlighted=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_HIGHLIGHT_CHANGED)))}setHovered(t){this.hovered!==t&&(this.hovered=t)}isHovered(){return this.hovered}setAllChildrenCount(t){this.allChildrenCount!==t&&(this.allChildrenCount=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}setMaster(t){this.master!==t&&(this.master&&!t&&(this.expanded=!1),this.master=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_MASTER_CHANGED)))}setGroup(t){this.group!==t&&(this.group&&!t&&(this.expanded=!1),this.group=t,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_GROUP_CHANGED)))}setRowHeight(t,s=!1){this.rowHeight=t,this.rowHeightEstimated=s,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_HEIGHT_CHANGED))}setRowAutoHeight(t,s){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[s.getId()]=t,t!=null&&(this.checkAutoHeightsDebounced==null&&(this.checkAutoHeightsDebounced=xi(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let t=!1,s=!0,i=0;const r=this.__autoHeights;if(r==null||(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(a=>{let l=r[a.getId()];if(l==null)if(this.beans.columnModel.isColSpanActive()){let u=[];switch(a.getPinned()){case"left":u=this.beans.columnModel.getDisplayedLeftColumnsForRow(this);break;case"right":u=this.beans.columnModel.getDisplayedRightColumnsForRow(this);break;case null:u=this.beans.columnModel.getViewportCenterColumnsForRow(this);break}if(u.includes(a)){t=!0;return}l=-1}else{t=!0;return}else s=!1;l>i&&(i=l)}),t)||((s||i<10)&&(i=this.beans.gos.getRowHeightForNode(this).height),i==this.rowHeight))return;this.setRowHeight(i);const o=this.beans.rowModel;o.onRowHeightChangedDebounced&&o.onRowHeightChangedDebounced()}setRowIndex(t){this.rowIndex!==t&&(this.rowIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_ROW_INDEX_CHANGED)))}setUiLevel(t){this.uiLevel!==t&&(this.uiLevel=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_UI_LEVEL_CHANGED)))}setExpanded(t,s,i){if(this.expanded===t)return;this.expanded=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_EXPANDED_CHANGED));const r=Object.assign({},this.createGlobalRowEvent(w.EVENT_ROW_GROUP_OPENED),{expanded:t,event:s||null});this.beans.rowNodeEventThrottle.dispatchExpanded(r,i),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(t){return this.beans.gos.addGridCommonParams({type:t,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}dispatchLocalEvent(t){this.eventService&&this.eventService.dispatchEvent(t)}setDataValue(t,s,i){const n=(()=>{var l;return typeof t!="string"?t:(l=this.beans.columnModel.getGridColumn(t))!=null?l:this.beans.columnModel.getPrimaryColumn(t)})(),o=this.getValueFromValueService(n);if(this.beans.gos.get("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(n,o,s,i),!1;const a=this.beans.valueService.setValue(this,n,s,i);return this.dispatchCellChangedEvent(n,s,o),this.checkRowSelectable(),a}getValueFromValueService(t){var s,i;const r=this.leafGroup&&this.beans.columnModel.isPivotMode(),n=this.group&&this.expanded&&!this.footer&&!r;let o=!1;const a=(s=this.beans.gos.get("groupTotalRow"))!=null?s:this.beans.gos.get("groupIncludeFooter");typeof a!="function"?o=!!a:o=!!((i=this.beans.gos.getCallback("groupTotalRow"))!=null?i:this.beans.gos.getCallback("groupIncludeFooter"))({node:this});const l=this.beans.gos.get("groupSuppressBlankHeader"),u=n&&o&&!l;return this.beans.valueService.getValue(t,this,!1,u)}dispatchEventForSaveValueReadOnly(t,s,i,r){const n=this.beans.gos.addGridCommonParams({type:w.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:t,colDef:t.getColDef(),data:this.data,node:this,oldValue:s,newValue:i,value:i,source:r});this.beans.eventService.dispatchEvent(n)}setGroupValue(t,s){const i=this.beans.columnModel.getGridColumn(t);ot(this.groupData)&&(this.groupData={});const r=i.getColId(),n=this.groupData[r];n!==s&&(this.groupData[r]=s,this.dispatchCellChangedEvent(i,s,n))}setAggData(t){const s=this.aggData;if(this.aggData=t,this.eventService){const i=r=>{const n=this.aggData?this.aggData[r]:void 0,o=s?s[r]:void 0;if(n===o)return;const a=this.beans.columnModel.lookupGridColumn(r);a&&this.dispatchCellChangedEvent(a,n,o)};for(const r in this.aggData)i(r);for(const r in t)r in this.aggData||i(r)}}updateHasChildren(){let t=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gos.isRowModelType("serverSide")){const i=this.beans.gos.get("treeData"),r=this.beans.gos.get("isServerSideGroup");t=!this.stub&&!this.footer&&(i?!!r&&r(this.data):!!this.group)}t!==this.__hasChildren&&(this.__hasChildren=!!t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(qt.EVENT_HAS_CHILDREN_CHANGED)))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return this.group&&Pr(this.childrenAfterGroup)}dispatchCellChangedEvent(t,s,i){const r={type:qt.EVENT_CELL_CHANGED,node:this,column:t,newValue:s,oldValue:i};this.dispatchLocalEvent(r)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.footer?!1:this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(s=>s.depthFirstSearch(t)),t(this)}calculateSelectedFromChildren(){var t;let s=!1,i=!1,r=!1;if(!((t=this.childrenAfterGroup)!=null&&t.length))return this.selectable?this.selected:null;for(let n=0;n<this.childrenAfterGroup.length;n++){const o=this.childrenAfterGroup[n];let a=o.isSelected();if(!o.selectable){const l=o.calculateSelectedFromChildren();if(l===null)continue;a=l}switch(a){case!0:s=!0;break;case!1:i=!0;break;default:r=!0;break}}if(!(r||s&&i))return s?!0:i?!1:this.selectable?this.selected:null}setSelectedInitialValue(t){this.selected=t}selectThisNode(t,s,i="api"){const r=!this.selectable&&t,n=this.selected===t;if(r||n)return!1;this.selected=t,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(qt.EVENT_ROW_SELECTED));const o=this.sibling;o&&o.footer&&o.eventService&&o.dispatchLocalEvent(o.createLocalRowEvent(qt.EVENT_ROW_SELECTED));const a=rs(Xe({},this.createGlobalRowEvent(w.EVENT_ROW_SELECTED)),{event:s||null,source:i});return this.beans.eventService.dispatchEvent(a),!0}setSelected(t,s=!1,i="api"){if(typeof i=="boolean"){console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.");return}this.setSelectedParams({newValue:t,clearSelection:s,rangeSelect:!1,source:i})}setSelectedParams(t){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):this.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(rs(Xe({},t),{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return this.rowPinned==="top"||this.rowPinned==="bottom"}isParentOfNode(t){let s=this.parent;for(;s;){if(s===t)return!0;s=s.parent}return!1}addEventListener(t,s){var i,r;this.eventService||(this.eventService=new pn),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new QS(this.beans.frameworkOverrides));const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.wrap(s))!=null?r:s;this.eventService.addEventListener(t,n)}removeEventListener(t,s){var i,r;if(!this.eventService)return;const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.unwrap(s))!=null?r:s;this.eventService.removeEventListener(t,n),this.eventService.noRegisteredListenersExist()&&(this.eventService=null)}onMouseEnter(){this.dispatchLocalEvent(this.createLocalRowEvent(qt.EVENT_MOUSE_ENTER))}onMouseLeave(){this.dispatchLocalEvent(this.createLocalRowEvent(qt.EVENT_MOUSE_LEAVE))}getFirstChildOfFirstChild(t){let s=this,i=!0,r=!1,n=null;for(;i&&!r;){const o=s.parent;ve(o)&&s.firstChild?o.rowGroupColumn===t&&(r=!0,n=o):i=!1,s=o}return r?n:null}isFullWidthCell(){if(this.detail)return!0;const t=this.beans.gos.getCallback("isFullWidthRow");return t?t({rowNode:this}):!1}getRoute(){if(this.key==null)return;const t=[];let s=this;for(;s.key!=null;)t.push(s.key),s=s.parent;return t.reverse()}createFooter(){if(this.sibling)return;const t=new Set(["eventService","__objectId","sticky"]),s=new qt(this.beans);Object.keys(this).forEach(i=>{t.has(i)||(s[i]=this[i])}),s.footer=!0,s.setRowTop(null),s.setRowIndex(null),s.oldRowTop=null,s.id="rowGroupFooter_"+this.id,s.sibling=this,this.sibling=s}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}};ns.ID_PREFIX_ROW_GROUP="row-group-";ns.ID_PREFIX_TOP_PINNED="t-";ns.ID_PREFIX_BOTTOM_PINNED="b-";ns.OBJECT_ID_SEQUENCE=0;ns.EVENT_ROW_SELECTED="rowSelected";ns.EVENT_DATA_CHANGED="dataChanged";ns.EVENT_CELL_CHANGED="cellChanged";ns.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged";ns.EVENT_MASTER_CHANGED="masterChanged";ns.EVENT_GROUP_CHANGED="groupChanged";ns.EVENT_MOUSE_ENTER="mouseEnter";ns.EVENT_MOUSE_LEAVE="mouseLeave";ns.EVENT_HEIGHT_CHANGED="heightChanged";ns.EVENT_TOP_CHANGED="topChanged";ns.EVENT_DISPLAYED_CHANGED="displayedChanged";ns.EVENT_FIRST_CHILD_CHANGED="firstChildChanged";ns.EVENT_LAST_CHILD_CHANGED="lastChildChanged";ns.EVENT_CHILD_INDEX_CHANGED="childIndexChanged";ns.EVENT_ROW_INDEX_CHANGED="rowIndexChanged";ns.EVENT_EXPANDED_CHANGED="expandedChanged";ns.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged";ns.EVENT_SELECTABLE_CHANGED="selectableChanged";ns.EVENT_UI_LEVEL_CHANGED="uiLevelChanged";ns.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged";ns.EVENT_DRAGGING_CHANGED="draggingChanged";var yt=ns,Zm=class extends at{constructor(){super(`
            <div class="ag-selection-checkbox" role="presentation">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),s=Bm(e,t),[i,r]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],n=e(i,r);this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${n} (${s})`)}onClicked(e,t,s){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:s.shiftKey,groupSelectsFiltered:t,event:s,source:"checkboxSelected"})}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",i=>{gn(i)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",i=>{gn(i);const r=this.gos.get("groupSelectsFiltered"),n=this.eCheckbox.getValue();this.shouldHandleIndeterminateState(n,r)?this.onClicked(!0,r,i||{})===0&&this.onClicked(!1,r,i):n?this.onClicked(!1,r,i):this.onClicked(!0,r,i||{})}),this.addManagedListener(this.rowNode,yt.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gos.get("isRowSelectable")||typeof this.getIsVisible()=="function"){const i=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,i),this.addManagedListener(this.rowNode,yt.EVENT_DATA_CHANGED,i),this.addManagedListener(this.rowNode,yt.EVENT_CELL_CHANGED,i),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(this.eCheckbox.getPreviousValue()===void 0||e===void 0)&&this.gos.isRowModelType("clientSide")}showOrHideSelect(){var e,t,s;let i=this.rowNode.selectable;const r=this.getIsVisible();if(i)if(typeof r=="function"){const o=(e=this.overrides)==null?void 0:e.callbackParams;if(!this.column)i=r(rs(Xe({},o),{node:this.rowNode,data:this.rowNode.data}));else{const a=this.column.createColumnFunctionCallbackParams(this.rowNode);i=r(Xe(Xe({},o),a))}}else i=r??!1;if((t=this.column)==null?void 0:t.getColDef().showDisabledCheckboxes){this.eCheckbox.setDisabled(!i),this.setVisible(!0),this.setDisplayed(!0);return}if((s=this.overrides)!=null&&s.removeHidden){this.setDisplayed(i);return}this.setVisible(i)}getIsVisible(){var e,t;return this.overrides?this.overrides.isVisible:(t=(e=this.column)==null?void 0:e.getColDef())==null?void 0:t.checkboxSelection}};f([Fe("eCheckbox")],Zm.prototype,"eCheckbox",2);f([xe],Zm.prototype,"postConstruct",1);var KF=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(KF||{}),ut=class extends Se{constructor(){super(...arguments),this.dragSourceAndParamsList=[],this.dropTargets=[]}init(){this.ePinnedIcon=Er("columnMovePin",this.gos,null),this.eHideIcon=Er("columnMoveHide",this.gos,null),this.eMoveIcon=Er("columnMoveMove",this.gos,null),this.eLeftIcon=Er("columnMoveLeft",this.gos,null),this.eRightIcon=Er("columnMoveRight",this.gos,null),this.eGroupIcon=Er("columnMoveGroup",this.gos,null),this.eAggregateIcon=Er("columnMoveValue",this.gos,null),this.ePivotIcon=Er("columnMovePivot",this.gos,null),this.eDropNotAllowedIcon=Er("dropNotAllowed",this.gos,null)}addDragSource(e,t=!1){const s={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:s,dragSource:e}),this.dragService.addDragSource(s)}removeDragSource(e){const t=this.dragSourceAndParamsList.find(s=>s.dragSource===e);t&&(this.dragService.removeDragSource(t.params),Vi(this.dragSourceAndParamsList,t))}clearDragSourceParamsList(){this.dragSourceAndParamsList.forEach(e=>this.dragService.removeDragSource(e.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=void 0,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(e){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}onDragging(e,t){var s,i,r,n;const o=this.getHorizontalDirection(e),a=this.getVerticalDirection(e);this.eventLastTime=e,this.positionGhost(e);const l=this.dropTargets.filter(h=>this.isMouseOnDropTarget(e,h)),u=this.findCurrentDropTarget(e,l);if(u!==this.lastDropTarget)this.leaveLastTargetIfExists(e,o,a,t),this.lastDropTarget!==null&&u===null&&((i=(s=this.dragSource).onGridExit)==null||i.call(s,this.dragItem)),this.lastDropTarget===null&&u!==null&&((n=(r=this.dragSource).onGridEnter)==null||n.call(r,this.dragItem)),this.enterDragTargetIfExists(u,e,o,a,t),this.lastDropTarget=u;else if(u&&u.onDragging){const h=this.createDropTargetEvent(u,e,o,a,t);u.onDragging(h)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,s=[[e.getContainer()]];return t?s.concat(t):s}allContainersIntersect(e,t){for(const s of t){const i=s.getBoundingClientRect();if(i.width===0||i.height===0)return!1;const r=e.clientX>=i.left&&e.clientX<i.right,n=e.clientY>=i.top&&e.clientY<i.bottom;if(!r||!n)return!1}return!0}isMouseOnDropTarget(e,t){const s=this.getAllContainersFromDropTarget(t);let i=!1;for(const r of s)if(this.allContainersIntersect(e,r)){i=!0;break}return t.targetContainsSource&&!t.getContainer().contains(this.dragSource.eElement)?!1:i&&t.isInterestedIn(this.dragSource.type,this.dragSource.eElement)}findCurrentDropTarget(e,t){const s=t.length;if(s===0)return null;if(s===1)return t[0];const r=this.gos.getRootNode().elementsFromPoint(e.clientX,e.clientY);for(const n of r)for(const o of t)if(xA(this.getAllContainersFromDropTarget(o)).indexOf(n)!==-1)return o;return null}enterDragTargetIfExists(e,t,s,i,r){if(e){if(e.onDragEnter){const n=this.createDropTargetEvent(e,t,s,i,r);e.onDragEnter(n)}this.setGhostIcon(e.getIconName?e.getIconName():null)}}leaveLastTargetIfExists(e,t,s,i){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const r=this.createDropTargetEvent(this.lastDropTarget,e,t,s,i);this.lastDropTarget.onDragLeave(r)}this.setGhostIcon(null)}}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.filter(s=>s.external).find(s=>s.getContainer()===e.getContainer())||null}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,s=e.clientX;return t===s?null:t>s?0:1}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,s=e.clientY;return t===s?null:t>s?0:1}createDropTargetEvent(e,t,s,i,r){const n=e.getContainer(),o=n.getBoundingClientRect(),{gridApi:a,columnApi:l,dragItem:u,dragSource:h}=this,p=t.clientX-o.left,g=t.clientY-o.top;return{event:t,x:p,y:g,vDirection:i,hDirection:s,dragSource:h,fromNudge:r,dragItem:u,api:a,columnApi:l,dropZoneTarget:n}}positionGhost(e){const t=this.eGhost;if(!t)return;const i=t.getBoundingClientRect().height,r=QA()-2,n=ZA()-2,o=f0(t.offsetParent),{clientY:a,clientX:l}=e;let u=a-o.top-i/2,h=l-o.left-10;const p=this.gos.getDocument(),g=p.defaultView||window,m=g.pageYOffset||p.documentElement.scrollTop,C=g.pageXOffset||p.documentElement.scrollLeft;r>0&&h+t.clientWidth>r+C&&(h=r+C-t.clientWidth),h<0&&(h=0),n>0&&u+t.clientHeight>n+m&&(u=n+m-t.clientHeight),u<0&&(u=0),t.style.left=`${h}px`,t.style.top=`${u}px`}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=$i(ut.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);const{theme:e}=this.environment.getTheme();e&&this.eGhost.classList.add(e),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const t=this.eGhost.querySelector(".ag-dnd-ghost-label");let s=this.dragSource.dragItemName;km(s)&&(s=s()),t.innerHTML=Ds(s)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const i=this.gos.getDocument();let r=null,n=null;try{r=i.fullscreenElement}catch{}finally{r||(r=this.gos.getRootNode());const o=r.querySelector("body");o?n=o:r instanceof ShadowRoot?n=r:r instanceof Document?n=r==null?void 0:r.documentElement:n=r}this.eGhostParent=n,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}setGhostIcon(e,t=!1){xs(this.eGhostIcon);let s=null;switch(e||(e=this.dragSource.getDefaultIconName?this.dragSource.getDefaultIconName():ut.ICON_NOT_ALLOWED),e){case ut.ICON_PINNED:s=this.ePinnedIcon;break;case ut.ICON_MOVE:s=this.eMoveIcon;break;case ut.ICON_LEFT:s=this.eLeftIcon;break;case ut.ICON_RIGHT:s=this.eRightIcon;break;case ut.ICON_GROUP:s=this.eGroupIcon;break;case ut.ICON_AGGREGATE:s=this.eAggregateIcon;break;case ut.ICON_PIVOT:s=this.ePivotIcon;break;case ut.ICON_NOT_ALLOWED:s=this.eDropNotAllowedIcon;break;case ut.ICON_HIDE:s=this.eHideIcon;break}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",t),!(s===this.eHideIcon&&this.gos.get("suppressDragLeaveHidesColumns"))&&s&&this.eGhostIcon.appendChild(s)}};ut.ICON_PINNED="pinned";ut.ICON_MOVE="move";ut.ICON_LEFT="left";ut.ICON_RIGHT="right";ut.ICON_GROUP="group";ut.ICON_AGGREGATE="aggregate";ut.ICON_PIVOT="pivot";ut.ICON_NOT_ALLOWED="notAllowed";ut.ICON_HIDE="hide";ut.GHOST_TEMPLATE=`<div class="ag-dnd-ghost ag-unselectable">
            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>
            <div class="ag-dnd-ghost-label"></div>
        </div>`;f([A("dragService")],ut.prototype,"dragService",2);f([A("mouseEventService")],ut.prototype,"mouseEventService",2);f([A("columnApi")],ut.prototype,"columnApi",2);f([A("gridApi")],ut.prototype,"gridApi",2);f([xe],ut.prototype,"init",1);f([Fi],ut.prototype,"clearDragSourceParamsList",1);ut=f([Le("dragAndDropService")],ut);var Dl=class extends at{constructor(e,t,s,i,r,n){super(),this.cellValueFn=e,this.rowNode=t,this.column=s,this.customGui=i,this.dragStartPixels=r,this.suppressVisibilityChange=n,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(cs("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gos.get("rowDragManaged")?new QF(this,this.beans,this.rowNode,this.column):new qF(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e),this.addDragSource(t)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const t=this.beans.selectionService.getSelectedNodes();return t.indexOf(this.rowNode)!==-1?t:[this.rowNode]}checkCompatibility(){const e=this.gos.get("rowDragManaged");this.gos.get("treeData")&&e&&tt("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const t=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:this.getGui(),dragItemName:()=>{var s;const i=this.getDragItem(),r=((s=i.rowNodes)==null?void 0:s.length)||1,n=this.getRowDragText(this.column);return n?n(i,r):r===1?this.cellValueFn():`${r} ${t("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}removeDragSource(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}};f([A("beans")],Dl.prototype,"beans",2);f([xe],Dl.prototype,"postConstruct",1);f([Fi],Dl.prototype,"removeDragSource",1);var YF=class extends Se{constructor(e,t,s){super(),this.parent=e,this.rowNode=t,this.column=s}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let s=!0,i=!1;this.column&&(s=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),i=km(this.column.getColDef().rowDrag)),i?(this.parent.setDisplayed(!0,t),this.parent.setVisible(s,t)):(this.parent.setDisplayed(s,t),this.parent.setVisible(!0,t))}}},qF=class extends YF{constructor(e,t,s,i){super(e,s,i),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}};f([xe],qF.prototype,"postConstruct",1);var QF=class extends YF{constructor(e,t,s,i){super(e,s,i),this.beans=t}postConstruct(){this.addManagedListener(this.beans.eventService,w.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const t=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),s=t&&t.shouldPreventRowMove(),i=this.gos.get("suppressRowDrag"),r=this.beans.dragAndDropService.hasExternalDropZones(),n=s&&!r||i;this.setDisplayedOrVisible(n)}};f([xe],QF.prototype,"postConstruct",1);var Ul=class extends Se{init(e,t,s,i,r,n,o){var a,l,u,h;this.params=o,this.eGui=t,this.eCheckbox=s,this.eExpanded=i,this.eContracted=r,this.comp=e,this.compClass=n;const{node:p,value:g,colDef:m}=o,C=this.isTopLevelFooter();if(!C){if(this.isEmbeddedRowMismatch())return;if(p.footer&&this.gos.get("groupHideOpenParents")){const R=m&&m.showRowGroup,x=p.rowGroupColumn&&p.rowGroupColumn.getColId();if(R!==x)return}}if(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),!C){const y=o.node.footer&&o.node.rowGroupIndex===this.columnModel.getRowGroupColumns().findIndex(j=>{var P;return j.getColId()===((P=o.colDef)==null?void 0:P.showRowGroup)}),x=this.gos.get("groupDisplayType")!="multipleColumns"||this.gos.get("treeData")||this.gos.get("showOpenedGroup")&&!o.node.footer&&(!o.node.group||o.node.rowGroupIndex!=null&&o.node.rowGroupIndex>this.columnModel.getRowGroupColumns().findIndex(j=>{var P;return j.getColId()===((P=o.colDef)==null?void 0:P.showRowGroup)})),S=!p.group&&(((a=this.params.colDef)==null?void 0:a.field)||((l=this.params.colDef)==null?void 0:l.valueGetter)),T=this.isExpandable(),I=this.columnModel.isPivotMode()&&p.leafGroup&&((u=p.rowGroupColumn)==null?void 0:u.getColId())===((h=o.column)==null?void 0:h.getColDef().showRowGroup);if(!this.showingValueForOpenedParent&&!T&&!S&&!x&&!y&&!I)return}this.addExpandAndContract(),this.addFullWidthRowDraggerIfNeeded(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded()}getCellAriaRole(){var e,t;const s=(e=this.params.colDef)==null?void 0:e.cellAriaRole,i=(t=this.params.column)==null?void 0:t.getColDef().cellAriaRole;return s||i||"gridcell"}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node:e,eGridCell:t}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable()){HA(t);return}const s=()=>{co(t,!!e.expanded)};this.expandListener=this.addManagedListener(e,yt.EVENT_EXPANDED_CHANGED,s)||null,s()}isTopLevelFooter(){if(!this.gos.getGrandTotalRow()||this.params.value!=null||this.params.node.level!=-1)return!1;const t=this.params.colDef;if(t==null||t.showRowGroup===!0)return!0;const i=this.columnModel.getRowGroupColumns();return!i||i.length===0?!0:i[0].getId()===t.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gos.get("embedFullWidthRows"))return!1;const e=this.params.pinned==="left",t=this.params.pinned==="right",s=!e&&!t;return this.gos.get("enableRtl")?this.columnModel.isPinningLeft()?!t:!s:this.columnModel.isPinningLeft()?!e:!s}findDisplayedGroupNode(){const e=this.params.column,t=this.params.node;if(this.showingValueForOpenedParent){let s=t.parent;for(;s!=null;){if(s.rowGroupColumn&&e.isRowGroupDisplayed(s.rowGroupColumn.getId())){this.displayedGroupNode=s;break}s=s.parent}}ot(this.displayedGroupNode)&&(this.displayedGroupNode=t)}setupShowingValueForOpenedParent(){const e=this.params.node,t=this.params.column;if(!this.gos.get("groupHideOpenParents")){this.showingValueForOpenedParent=!1;return}if(!e.groupData){this.showingValueForOpenedParent=!1;return}if(e.rowGroupColumn!=null){const r=e.rowGroupColumn.getId();if(t.isRowGroupDisplayed(r)){this.showingValueForOpenedParent=!1;return}}const i=e.groupData[t.getId()]!=null;this.showingValueForOpenedParent=i}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){var e;const t=this.adjustParamsWithDetailsFromRelatedColumn(),s=this.getInnerCompDetails(t),{valueFormatted:i,value:r}=t;let n=i;if(n==null){const o=this.displayedGroupNode.rowGroupColumn&&((e=this.params.column)==null?void 0:e.isRowGroupDisplayed(this.displayedGroupNode.rowGroupColumn.getId()));this.displayedGroupNode.key===""&&this.displayedGroupNode.group&&o?n=this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):n=r??null}this.comp.setInnerRenderer(s,n)}adjustParamsWithDetailsFromRelatedColumn(){const e=this.displayedGroupNode.rowGroupColumn,t=this.params.column;if(!e)return this.params;if(t!=null&&!t.isRowGroupDisplayed(e.getId()))return this.params;const i=this.params,{value:r,node:n}=this.params,o=this.valueService.formatValue(e,n,r);return rs(Xe({},i),{valueFormatted:o})}addFooterValue(){let e=this.params.totalValueGetter;if(!e){const i=this.params.footerValueGetter;i&&(e=i,tt("As of v31.3, footerValueGetter is deprecated. Use `totalValueGetter` instead."))}let t="";if(e){const i=YS(this.params);i.value=this.params.value,typeof e=="function"?t=e(i):typeof e=="string"?t=this.expressionService.evaluate(e,i):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else t=this.localeService.getLocaleTextFunc()("footerTotal","Total")+" "+(this.params.value!=null?this.params.value:"");const s=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(s,t)}getInnerCompDetails(e){if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gos.get("groupRowRendererParams"),e);const t=this.userComponentFactory.getInnerRendererDetails(e,e),s=o=>o&&o.componentClass==this.compClass;if(t&&!s(t))return t;const i=this.displayedGroupNode.rowGroupColumn,r=i?i.getColDef():void 0;if(!r)return;const n=this.userComponentFactory.getCellRendererDetails(r,e);if(n&&!s(n))return n;if(s(n)&&r.cellRendererParams&&r.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(r.cellRendererParams,e)}addChildCount(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,yt.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}updateChildCount(){const e=this.displayedGroupNode.allChildrenCount,i=this.isShowRowGroupForThisRow()&&e!=null&&e>=0?`(${e})`:"";this.comp.setChildCount(i)}isShowRowGroupForThisRow(){if(this.gos.get("treeData"))return!0;const e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;const t=this.params.column;return t==null||t.isRowGroupDisplayed(e.getId())}addExpandAndContract(){var e;const t=this.params,s=cs("groupExpanded",this.gos,null),i=cs("groupContracted",this.gos,null);s&&this.eExpanded.appendChild(s),i&&this.eContracted.appendChild(i);const r=t.eGridCell;!(((e=this.params.column)==null?void 0:e.isCellEditable(t.node))&&this.gos.get("enableGroupEdit"))&&this.isExpandable()&&!t.suppressDoubleClickExpand&&this.addManagedListener(r,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(t.node,yt.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();const o=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,yt.EVENT_ALL_CHILDREN_COUNT_CHANGED,o),this.addManagedListener(this.displayedGroupNode,yt.EVENT_MASTER_CHANGED,o),this.addManagedListener(this.displayedGroupNode,yt.EVENT_GROUP_CHANGED,o),this.addManagedListener(this.displayedGroupNode,yt.EVENT_HAS_CHILDREN_CHANGED,o)}onExpandClicked(e){un(e)||(gn(e),this.onExpandOrContract(e))}onExpandOrContract(e){const t=this.displayedGroupNode,s=!t.expanded;!s&&t.sticky&&this.scrollToStickyNode(t),t.setExpanded(s,e)}scrollToStickyNode(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const e=this.displayedGroupNode,t=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!t))return!1;const i=this.params.column;return i!=null&&typeof i.getColDef().showRowGroup=="string"?this.isShowRowGroupForThisRow():!0}showExpandAndContractIcons(){const{params:e,displayedGroupNode:t,columnModel:s}=this,{node:i}=e,r=this.isExpandable();if(r){const u=this.showingValueForOpenedParent?!0:i.expanded;this.comp.setExpandedDisplayed(u),this.comp.setContractedDisplayed(!u)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const n=s.isPivotMode(),o=n&&t.leafGroup,a=r&&!o,l=i.footer&&i.level===-1;this.comp.addOrRemoveCssClass("ag-cell-expandable",a),this.comp.addOrRemoveCssClass("ag-row-group",a),n?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",o):l||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!a)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const e=this.params.node;this.params.suppressPadding||(this.addManagedListener(e,yt.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}setIndent(){if(this.gos.get("groupHideOpenParents"))return;const e=this.params,t=e.node,s=!!e.colDef,i=this.gos.get("treeData"),n=!s||i||e.colDef.showRowGroup===!0?t.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+n,this.comp.addOrRemoveCssClass(this.indentClass,!0)}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const e=new Dl(()=>this.params.value,this.params.node);this.createManagedBean(e,this.context),this.eGui.insertAdjacentElement("afterbegin",e.getGui())}isUserWantsSelected(){const e=this.params.checkbox;return typeof e=="function"||e===!0}addCheckboxIfNeeded(){const e=this.displayedGroupNode,t=this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail;if(t){const s=new Zm;this.getContext().createBean(s),s.init({rowNode:this.params.node,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(s.getGui()),this.addDestroyFunc(()=>this.getContext().destroyBean(s))}this.comp.setCheckboxVisible(t)}onKeyDown(e){!(e.key===U.ENTER)||this.params.suppressEnterExpand||this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e)}onCellDblClicked(e){if(un(e))return;Ef(this.eExpanded,e)||Ef(this.eContracted,e)||this.onExpandOrContract(e)}};f([A("expressionService")],Ul.prototype,"expressionService",2);f([A("valueService")],Ul.prototype,"valueService",2);f([A("columnModel")],Ul.prototype,"columnModel",2);f([A("userComponentFactory")],Ul.prototype,"userComponentFactory",2);f([A("ctrlsService")],Ul.prototype,"ctrlsService",2);var $l=class ZF extends at{constructor(){super(ZF.TEMPLATE)}init(t){const s={setInnerRenderer:(o,a)=>this.setRenderDetails(o,a),setChildCount:o=>this.eChildCount.textContent=o,addOrRemoveCssClass:(o,a)=>this.addOrRemoveCssClass(o,a),setContractedDisplayed:o=>Dt(this.eContracted,o),setExpandedDisplayed:o=>Dt(this.eExpanded,o),setCheckboxVisible:o=>this.eCheckbox.classList.toggle("ag-invisible",!o)},i=this.createManagedBean(new Ul),r=!t.colDef,n=this.getGui();i.init(s,n,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,t),r&&fs(n,i.getCellAriaRole())}setRenderDetails(t,s){if(t){const i=t.newAgStackInstance();if(!i)return;i.then(r=>{if(!r)return;const n=()=>this.context.destroyBean(r);this.isAlive()?(this.eValue.appendChild(r.getGui()),this.addDestroyFunc(n)):n()})}else this.eValue.innerText=s}destroy(){this.getContext().destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}};$l.TEMPLATE=`<span class="ag-cell-wrapper">
            <span class="ag-group-expanded" ref="eExpanded"></span>
            <span class="ag-group-contracted" ref="eContracted"></span>
            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>
            <span class="ag-group-value" ref="eValue"></span>
            <span class="ag-group-child-count" ref="eChildCount"></span>
        </span>`;f([Fe("eExpanded")],$l.prototype,"eExpanded",2);f([Fe("eContracted")],$l.prototype,"eContracted",2);f([Fe("eCheckbox")],$l.prototype,"eCheckbox",2);f([Fe("eValue")],$l.prototype,"eValue",2);f([Fe("eChildCount")],$l.prototype,"eChildCount",2);var RE=$l,Jm=class JF extends at{constructor(){super(JF.TEMPLATE)}init(t){t.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingError","ERR")}setupLoading(){const t=cs("groupLoading",this.gos,null);t&&this.eLoadingIcon.appendChild(t);const s=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=s("loadingOoo","Loading")}refresh(t){return!1}destroy(){super.destroy()}};Jm.TEMPLATE=`<div class="ag-loading">
            <span class="ag-loading-icon" ref="eLoadingIcon"></span>
            <span class="ag-loading-text" ref="eLoadingText"></span>
        </div>`;f([Fe("eLoadingIcon")],Jm.prototype,"eLoadingIcon",2);f([Fe("eLoadingText")],Jm.prototype,"eLoadingText",2);var wO=Jm,XF=class eN extends at{constructor(){super(eN.TEMPLATE)}init(t){const s=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",s),this.addDestroyFunc(()=>Xc(t.eParentOfValue)),Xc(t.eParentOfValue,s),t.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const t=this.localeService.getLocaleTextFunc();this.getGui().innerText=t("loadingError","ERR");const s=t("ariaSkeletonCellLoadingFailed","Row failed to load");fr(this.getGui(),s)}setupLoading(){const s=this.gos.getDocument().createElement("div");s.classList.add("ag-skeleton-effect"),this.getGui().appendChild(s);const r=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");fr(this.getGui(),r)}refresh(t){return!1}destroy(){super.destroy()}};XF.TEMPLATE='<div class="ag-skeleton-container"></div>';var SO=XF,tN=class sN extends at{constructor(){super()}destroy(){super.destroy()}init(t){const s=this.gos.get("overlayLoadingTemplate");if(this.setTemplate(s??sN.DEFAULT_LOADING_OVERLAY_TEMPLATE),!s){const i=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=i("loadingOoo","Loading...")})}}};tN.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>';var xO=tN,iN=class rN extends at{constructor(){super()}destroy(){super.destroy()}init(t){const s=this.gos.get("overlayNoRowsTemplate");if(this.setTemplate(s??rN.DEFAULT_NO_ROWS_TEMPLATE),!s){const i=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=i("noRowsToShow","No Rows To Show")})}}};iN.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center"></span>';var bO=iN,EO=class extends zl{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().textContent=Ds(t,!0)}},RO=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}init(e,t){this.eInput=e,this.params=t,t.max!=null&&e.setMax(t.max),t.min!=null&&e.setMin(t.min),t.precision!=null&&e.setPrecision(t.precision),t.step!=null&&e.setStep(t.step);const s=e.getInputElement();t.preventStepping?e.addManagedListener(s,"keydown",this.preventStepping):t.showStepperButtons&&s.classList.add("ag-number-field-input-stepper")}preventStepping(e){(e.key===U.UP||e.key===U.DOWN)&&e.preventDefault()}getValue(){const e=this.eInput.getValue();if(!ve(e)&&!ve(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(t==null)return t;if(typeof t=="string"){if(t==="")return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}},TO=class extends Sp{constructor(){super(new RO)}},DO=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,t.min!=null&&e.setMin(t.min),t.max!=null&&e.setMax(t.max),t.step!=null&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return!ve(e)&&!ve(this.params.value)?this.params.value:e??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return _r(e,!1)}},PO=class extends Sp{constructor(){super(new DO)}},AO=class{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,t.min!=null&&e.setMin(t.min),t.max!=null&&e.setMax(t.max),t.step!=null&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return!ve(e)&&!ve(this.params.value)?this.params.value:this.params.parseValue(e??"")}getStartValue(){var e,t;return _r((t=this.parseDate((e=this.params.value)!=null?e:void 0))!=null?t:null,!1)}parseDate(e){return this.getDataTypeService().getDateParserFunction(this.params.column)(e)}formatDate(e){return this.getDataTypeService().getDateFormatterFunction(this.params.column)(e)}},nN=class extends Sp{constructor(){super(new AO(()=>this.dataTypeService))}};f([A("dataTypeService")],nN.prototype,"dataTypeService",2);var k0=class oN extends at{constructor(){super(oN.TEMPLATE)}init(t){this.params=t,this.updateCheckbox(t);const s=this.eCheckbox.getInputElement();s.setAttribute("tabindex","-1"),e0(s,"polite"),this.addManagedListener(s,"click",i=>{if(gn(i),this.eCheckbox.isDisabled())return;const r=this.eCheckbox.getValue();this.onCheckboxChanged(r)}),this.addManagedListener(s,"dblclick",i=>{gn(i)}),this.addManagedListener(this.params.eGridCell,"keydown",i=>{if(i.key===U.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===this.gos.getActiveDomElement()&&this.eCheckbox.toggle();const r=this.eCheckbox.getValue();this.onCheckboxChanged(r),i.preventDefault()}})}refresh(t){return this.params=t,this.updateCheckbox(t),!0}updateCheckbox(t){var s,i,r;let n,o=!0;if(t.node.group&&t.column){const p=t.column.getColId();p.startsWith(Jc)?n=t.value==null||t.value===""?void 0:t.value==="true":t.node.aggData&&t.node.aggData[p]!==void 0?n=(s=t.value)!=null?s:void 0:o=!1}else n=(i=t.value)!=null?i:void 0;if(!o){this.eCheckbox.setDisplayed(!1);return}this.eCheckbox.setValue(n);const a=t.disabled!=null?t.disabled:!((r=t.column)!=null&&r.isCellEditable(t.node));this.eCheckbox.setDisabled(a);const l=this.localeService.getLocaleTextFunc(),u=Bm(l,n),h=a?u:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${u})`;this.eCheckbox.setInputAriaLabel(h)}onCheckboxChanged(t){const{column:s,node:i,rowIndex:r,value:n}=this.params,o={type:w.EVENT_CELL_EDITING_STARTED,column:s,colDef:s==null?void 0:s.getColDef(),data:i.data,node:i,rowIndex:r,rowPinned:i.rowPinned,value:n};this.eventService.dispatchEvent(o);const a=this.params.node.setDataValue(this.params.column,t,"edit"),l={type:w.EVENT_CELL_EDITING_STOPPED,column:s,colDef:s==null?void 0:s.getColDef(),data:i.data,node:i,rowIndex:r,rowPinned:i.rowPinned,value:n,oldValue:n,newValue:t,valueChanged:a};this.eventService.dispatchEvent(l)}};k0.TEMPLATE=`
        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">
            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
        </div>`;f([Fe("eCheckbox")],k0.prototype,"eCheckbox",2);var FO=k0,aN=class extends zl{constructor(){super(`
            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}init(e){var t;this.params=e;const s=(t=e.value)!=null?t:void 0;this.eCheckbox.setValue(s),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(s),this.addManagedListener(this.eCheckbox,w.EVENT_FIELD_VALUE_CHANGED,r=>this.setAriaLabel(r.selected))}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),s=Bm(t,e),i=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${i} (${s})`)}};f([Fe("eCheckbox")],aN.prototype,"eCheckbox",2);var NO=class extends at{constructor(){super(),this.setTemplate("<div></div>")}init(e){var t;this.params=e,this.cssClassPrefix=(t=this.params.cssClassPrefix)!=null?t:"ag-menu-option",this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu()}configureDefaults(){return!0}addIcon(){if(this.params.isCompact)return;const e=$i(`<span ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`);this.params.checked?e.appendChild(cs("check",this.gos)):this.params.icon&&(gp(this.params.icon)?e.appendChild(this.params.icon):typeof this.params.icon=="string"?e.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(e)}addName(){const e=$i(`<span ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(e)}addShortcut(){if(this.params.isCompact)return;const e=$i(`<span ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(e)}addSubMenu(){const e=$i(`<span ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),t=this.getGui();if(this.params.subMenu){const s=this.gos.get("enableRtl")?"smallLeft":"smallRight";co(t,!1),e.appendChild(cs(s,this.gos))}t.appendChild(e)}getClassName(e){return`${this.cssClassPrefix}-${e}`}destroy(){super.destroy()}},Af=class extends Se{constructor(){super(...arguments),this.agGridDefaults={agDateInput:kF,agColumnHeader:sw,agColumnGroupHeader:fO,agSortIndicator:N0,agTextColumnFloatingFilter:gO,agNumberColumnFloatingFilter:pO,agDateColumnFloatingFilter:qm,agReadOnlyFloatingFilter:E0,agAnimateShowChangeCellRenderer:UF,agAnimateSlideCellRenderer:$F,agGroupCellRenderer:RE,agGroupRowRenderer:RE,agLoadingCellRenderer:wO,agSkeletonCellRenderer:SO,agCheckboxCellRenderer:FO,agCellEditor:EE,agTextCellEditor:EE,agNumberCellEditor:TO,agDateCellEditor:PO,agDateStringCellEditor:nN,agSelectCellEditor:_0,agLargeTextCellEditor:mO,agCheckboxCellEditor:aN,agTextColumnFilter:F0,agNumberColumnFilter:GF,agDateColumnFilter:_F,agLoadingOverlay:xO,agNoRowsOverlay:bO,agTooltipComponent:EO,agMenuItem:NO},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}init(){const e=this.gos.get("components");e!=null&&ui(e,(t,s)=>this.registerJsComponent(t,s))}registerDefaultComponent(e,t){if(this.agGridDefaults[e]){console.error("Trying to overwrite a default component. You should call registerComponent");return}this.agGridDefaults[e]=t}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const s=(a,l)=>({componentFromFramework:l,component:a}),i=this.getFrameworkOverrides().frameworkComponent(t,this.gos.get("components"));if(i!=null)return s(i,!0);const r=this.jsComps[t];if(r){const a=this.getFrameworkOverrides().isFrameworkComponent(r);return s(r,a)}const n=this.agGridDefaults[t];if(n)return s(n,!1);const o=this.enterpriseAgDefaultCompsModule[t];return o?Vt.__assertRegistered(o,`AG Grid '${e}' component: ${t}`,this.context.getGridId()):Zc(()=>{this.warnAboutMissingComponent(e,t)},"MissingComp"+t),null}warnAboutMissingComponent(e,t){const s=[...Object.keys(this.agGridDefaults).filter(r=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(r)),...Object.keys(this.jsComps)],i=fp(t,s,!0,.8).values;console.warn(`AG Grid: Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),i.length>0&&console.warn(`         Did you mean: [${i.slice(0,3)}]?`),console.warn(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}};f([xe],Af.prototype,"init",1);Af=f([Le("userComponentRegistry")],Af);var IO={propertyName:"dateComponent",cellRenderer:!1},_O={propertyName:"headerComponent",cellRenderer:!1},kO={propertyName:"headerGroupComponent",cellRenderer:!1},TE={propertyName:"cellRenderer",cellRenderer:!0},MO={propertyName:"loadingCellRenderer",cellRenderer:!0},LO={propertyName:"cellEditor",cellRenderer:!1},DE={propertyName:"innerRenderer",cellRenderer:!0},OO={propertyName:"loadingOverlayComponent",cellRenderer:!1},GO={propertyName:"noRowsOverlayComponent",cellRenderer:!1},VO={propertyName:"tooltipComponent",cellRenderer:!1},iw={propertyName:"filter",cellRenderer:!1},BO={propertyName:"floatingFilterComponent",cellRenderer:!1},HO={propertyName:"toolPanel",cellRenderer:!1},jO={propertyName:"statusPanel",cellRenderer:!1},WO={propertyName:"fullWidthCellRenderer",cellRenderer:!0},zO={propertyName:"loadingCellRenderer",cellRenderer:!0},UO={propertyName:"groupRowRenderer",cellRenderer:!0},$O={propertyName:"detailCellRenderer",cellRenderer:!0},KO={propertyName:"menuItem",cellRenderer:!1},lN=class{static getFloatingFilterType(e){return this.filterToFloatingFilterMapping[e]}};lN.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var pa=class extends Se{getHeaderCompDetails(e,t){return this.getCompDetails(e,_O,"agColumnHeader",t)}getHeaderGroupCompDetails(e){const t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,kO,"agColumnGroupHeader",e)}getFullWidthCellRendererDetails(e){return this.getCompDetails(this.gridOptions,WO,null,e,!0)}getFullWidthLoadingCellRendererDetails(e){return this.getCompDetails(this.gridOptions,zO,"agLoadingCellRenderer",e,!0)}getFullWidthGroupCellRendererDetails(e){return this.getCompDetails(this.gridOptions,UO,"agGroupRowRenderer",e,!0)}getFullWidthDetailCellRendererDetails(e){return this.getCompDetails(this.gridOptions,$O,"agDetailCellRenderer",e,!0)}getInnerRendererDetails(e,t){return this.getCompDetails(e,DE,null,t)}getFullWidthGroupRowInnerCellRenderer(e,t){return this.getCompDetails(e,DE,null,t)}getCellRendererDetails(e,t){return this.getCompDetails(e,TE,null,t)}getLoadingCellRendererDetails(e,t){return this.getCompDetails(e,MO,"agSkeletonCellRenderer",t,!0)}getCellEditorDetails(e,t){return this.getCompDetails(e,LO,"agCellEditor",t,!0)}getFilterDetails(e,t,s){return this.getCompDetails(e,iw,s,t,!0)}getDateCompDetails(e){return this.getCompDetails(this.gridOptions,IO,"agDateInput",e,!0)}getLoadingOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,OO,"agLoadingOverlay",e,!0)}getNoRowsOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,GO,"agNoRowsOverlay",e,!0)}getTooltipCompDetails(e){return this.getCompDetails(e.colDef,VO,"agTooltipComponent",e,!0)}getSetFilterCellRendererDetails(e,t){return this.getCompDetails(e,TE,null,t)}getFloatingFilterCompDetails(e,t,s){return this.getCompDetails(e,BO,s,t)}getToolPanelCompDetails(e,t){return this.getCompDetails(e,HO,null,t,!0)}getStatusPanelCompDetails(e,t){return this.getCompDetails(e,jO,null,t,!0)}getMenuItemCompDetails(e,t){return this.getCompDetails(e,KO,"agMenuItem",t,!0)}getCompDetails(e,t,s,i,r=!1){const{propertyName:n,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:u,paramsFromSelector:h,popupFromSelector:p,popupPositionFromSelector:g}=this.getCompKeys(e,t,i);const m=x=>{const S=this.userComponentRegistry.retrieve(n,x);S&&(l=S.componentFromFramework?void 0:S.component,u=S.componentFromFramework?S.component:void 0)};if(a!=null&&m(a),l==null&&u==null&&s!=null&&m(s),l&&o&&!this.agComponentUtils.doesImplementIComponent(l)&&(l=this.agComponentUtils.adaptFunction(n,l)),!l&&!u){r&&console.error(`AG Grid: Could not find component ${a}, did you forget to configure this component?`);return}const C=this.mergeParamsWithApplicationProvidedParams(e,t,i,h),y=l==null,R=l||u;return{componentFromFramework:y,componentClass:R,params:C,type:t,popupFromSelector:p,popupPositionFromSelector:g,newAgStackInstance:()=>this.newAgStackInstance(R,y,C,t)}}getCompKeys(e,t,s){const{propertyName:i}=t;let r,n,o,a,l,u;if(e){const h=e,p=h[i+"Selector"],g=p?p(s):null,m=C=>{typeof C=="string"?r=C:C!=null&&C!==!0&&(this.getFrameworkOverrides().isFrameworkComponent(C)?o=C:n=C)};g?(m(g.component),a=g.params,l=g.popup,u=g.popupPosition):m(h[i])}return{compName:r,jsComp:n,fwComp:o,paramsFromSelector:a,popupFromSelector:l,popupPositionFromSelector:u}}newAgStackInstance(e,t,s,i){const r=i.propertyName,n=!t;let o;if(n)o=new e;else{const l=this.componentMetadataProvider.retrieve(r);o=this.frameworkComponentWrapper.wrap(e,l.mandatoryMethodList,l.optionalMethodList,i)}const a=this.initComponent(o,s);return a==null?Ps.resolve(o):a.then(()=>o)}mergeParamsWithApplicationProvidedParams(e,t,s,i=null){const r=this.gos.getGridCommonParams();zi(r,s);const n=e,o=n&&n[t.propertyName+"Params"];if(typeof o=="function"){const a=o(s);zi(r,a)}else typeof o=="object"&&zi(r,o);return zi(r,i),r}initComponent(e,t){if(this.context.createBean(e),e.init!=null)return e.init(t)}getDefaultFloatingFilterType(e,t){if(e==null)return null;let s=null,{compName:i,jsComp:r,fwComp:n}=this.getCompKeys(e,iw);return i?s=lN.getFloatingFilterType(i):r==null&&n==null&&e.filter===!0&&(s=t()),s}};f([A("gridOptions")],pa.prototype,"gridOptions",2);f([A("agComponentUtils")],pa.prototype,"agComponentUtils",2);f([A("componentMetadataProvider")],pa.prototype,"componentMetadataProvider",2);f([A("userComponentRegistry")],pa.prototype,"userComponentRegistry",2);f([zt("frameworkComponentWrapper")],pa.prototype,"frameworkComponentWrapper",2);pa=f([Le("userComponentFactory")],pa);var cN=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.indexOf("x")!==-1,this.scrollVertically=e.scrollAxis.indexOf("y")!==-1,this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const s=t||this.shouldSkipVerticalScroll();if(s&&this.shouldSkipHorizontalScroll())return;const i=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<i.left+r,this.tickRight=e.clientX>i.right-r,this.tickUp=e.clientY<i.top+r&&!s,this.tickDown=e.clientY>i.bottom-r&&!s,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let e;if(e=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},yr=class extends Se{constructor(e){super(),this.eContainer=e}postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(e=>{const t=e.gridBodyCtrl;this.autoScrollService=new cN({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:s=>t.getScrollFeature().setVerticalScrollPosition(s),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?ut.ICON_NOT_ALLOWED:ut.ICON_MOVE}shouldPreventRowMove(){return!!(this.columnModel.getRowGroupColumns().length||this.filterManager.isAnyFilterPresent()||this.sortController.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const i=[...this.selectionService.getSelectedNodes()].sort((r,n)=>r.rowIndex==null||n.rowIndex==null?0:this.getRowIndexNumber(r)-this.getRowIndexNumber(n));if(i.indexOf(t)!==-1)return i}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent(w.EVENT_ROW_DRAG_ENTER,e),this.getRowNodes(e).forEach(t=>{t.setDragging(!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}isDropZoneWithinThisGrid(e){const s=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:i}=e;return!s.contains(i)}onEnterOrDragging(e){this.dispatchGridEvent(w.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const s=this.isFromThisGrid(e),i=this.gos.get("rowDragManaged"),r=e.dragItem.rowNodes;i&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!s?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(r[0],t):this.moveRows(r,t))}getRowIndexNumber(e){return parseInt(Mt(e.getRowIndexString().split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel.getLastHighlightedRowNode(),s=t&&t.highlighted===1,i=this.mouseEventService.getNormalisedPosition(e).y,r=e.dragItem.rowNodes;let n=s?1:0;if(this.isFromThisGrid(e))r.forEach(o=>{o.rowTop<i&&(n-=1)}),this.moveRows(r,i,n);else{const o=this.gos.getCallback("getRowId");let a=this.clientSideRowModel.getRowIndexAtPixel(i)+1;this.clientSideRowModel.getHighlightPosition(i)===0&&a--,this.clientSideRowModel.updateRowData({add:r.map(l=>l.data).filter(l=>!this.clientSideRowModel.getRowNode(o?o({data:l,level:0}):l.id)),addIndex:a})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,s=0){var i;this.clientSideRowModel.ensureRowsAtPixel(e,t,s)&&(this.focusService.clearFocusedCell(),(i=this.rangeService)==null||i.removeAllCellRanges())}addRowDropZone(e){if(!e.getContainer()){tt("addRowDropZone - A container target needs to be provided");return}if(this.dragAndDropService.findExternalZone(e)){console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");return}let t={getContainer:e.getContainer};e.fromGrid?t=e:(e.onDragEnter&&(t.onDragEnter=s=>{e.onDragEnter(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_ENTER,s))}),e.onDragLeave&&(t.onDragLeave=s=>{e.onDragLeave(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_LEAVE,s))}),e.onDragging&&(t.onDragging=s=>{e.onDragging(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_MOVE,s))}),e.onDragStop&&(t.onDragStop=s=>{e.onDragStop(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_END,s))})),this.dragAndDropService.addDropTarget(Xe({isInterestedIn:s=>s===2,getIconName:()=>ut.ICON_MOVE,external:!0},t))}getRowDropZone(e){const t=this.getContainer.bind(this),s=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),r=this.onDragging.bind(this),n=this.onDragStop.bind(this);return e?{getContainer:t,onDragEnter:e.onDragEnter?o=>{s(o),e.onDragEnter(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_ENTER,o))}:s,onDragLeave:e.onDragLeave?o=>{i(o),e.onDragLeave(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_LEAVE,o))}:i,onDragging:e.onDragging?o=>{r(o),e.onDragging(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_MOVE,o))}:r,onDragStop:e.onDragStop?o=>{n(o),e.onDragStop(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_END,o))}:n,fromGrid:!0}:{getContainer:t,onDragEnter:s,onDragLeave:i,onDragging:r,onDragStop:n,fromGrid:!0}}draggingToRowDragEvent(e,t){const s=this.mouseEventService.getNormalisedPosition(t).y,i=s>this.paginationProxy.getCurrentPageHeight();let r=-1,n;i||(r=this.rowModel.getRowIndexAtPixel(s),n=this.rowModel.getRow(r));let o;switch(t.vDirection){case 1:o="down";break;case 0:o="up";break;default:o=null;break}return this.gos.addGridCommonParams({type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:r,overNode:n,y:s,vDirection:o})}dispatchGridEvent(e,t){const s=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(s)}onDragLeave(e){this.dispatchGridEvent(w.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent(w.EVENT_ROW_DRAG_END,e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&!this.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(t=>{t.setDragging(!1)})}};f([A("dragAndDropService")],yr.prototype,"dragAndDropService",2);f([A("rowModel")],yr.prototype,"rowModel",2);f([A("paginationProxy")],yr.prototype,"paginationProxy",2);f([A("columnModel")],yr.prototype,"columnModel",2);f([A("focusService")],yr.prototype,"focusService",2);f([A("sortController")],yr.prototype,"sortController",2);f([A("filterManager")],yr.prototype,"filterManager",2);f([A("selectionService")],yr.prototype,"selectionService",2);f([A("mouseEventService")],yr.prototype,"mouseEventService",2);f([A("ctrlsService")],yr.prototype,"ctrlsService",2);f([zt("rangeService")],yr.prototype,"rangeService",2);f([xe],yr.prototype,"postConstruct",1);var Ch=class extends Se{constructor(){super(...arguments),this.dragEndFunctions=[],this.dragSources=[]}removeAllListeners(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}removeListener(e){const t=e.dragSource.eElement,s=e.mouseDownListener;if(t.removeEventListener("mousedown",s),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(e){const t=this.dragSources.find(s=>s.dragSource===e);t&&(this.removeListener(t),Vi(this.dragSources,t))}isDragging(){return this.dragging}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:s,includeTouch:i,stopPropagationForTouch:r}=e;s.addEventListener("mousedown",t);let n=null;const o=this.gos.get("suppressTouch");i&&!o&&(n=a=>{p0(a.target)||(a.cancelable&&(a.preventDefault(),r&&a.stopPropagation()),this.onTouchStart(e,a))},s.addEventListener("touchstart",n,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:n,touchEnabled:!!i})}getStartTarget(){return this.startTarget}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const s=t.touches[0];this.touchLastTime=s,this.touchStart=s;const i=l=>this.onTouchMove(l,e.eElement),r=l=>this.onTouchUp(l,e.eElement),n=l=>{l.cancelable&&l.preventDefault()},o=t.target,a=[{target:this.gos.getRootNode(),type:"touchmove",listener:n,options:{passive:!1}},{target:o,type:"touchmove",listener:i,options:{passive:!0}},{target:o,type:"touchend",listener:r,options:{passive:!0}},{target:o,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onCommonMove(s,this.touchStart,e.eElement)}onMouseDown(e,t){const s=t;if(e.skipMouseEvent&&e.skipMouseEvent(t)||s._alreadyProcessedByDragService||(s._alreadyProcessedByDragService=!0,t.button!==0))return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const i=l=>this.onMouseMove(l,e.eElement),r=l=>this.onMouseUp(l,e.eElement),n=l=>l.preventDefault(),o=this.gos.getRootNode(),a=[{target:o,type:"mousemove",listener:i},{target:o,type:"mouseup",listener:r},{target:o,type:"contextmenu",listener:n}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(t=>{const{target:s,type:i,listener:r,options:n}=t;s.addEventListener(i,r,n)}),this.dragEndFunctions.push(()=>{e.forEach(t=>{const{target:s,type:i,listener:r,options:n}=t;s.removeEventListener(i,r,n)})})}isEventNearStartEvent(e,t){const{dragStartPixels:s}=this.currentDragParams,i=ve(s)?s:4;return x0(e,t,i)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,s){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(e,t))return;this.dragging=!0;const i={type:w.EVENT_DRAG_STARTED,target:s};this.eventService.dispatchEvent(i),this.currentDragParams.onDragStart(t),this.currentDragParams.onDragging(t)}this.currentDragParams.onDragging(e)}onTouchMove(e,t){const s=this.getFirstActiveTouch(e.touches);s&&this.onCommonMove(s,this.touchStart,t)}onMouseMove(e,t){var s;Gn()&&((s=this.gos.getDocument().getSelection())==null||s.removeAllRanges()),this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gos.get("enableCellTextSelection"),s=e.type==="mousemove";return t&&s&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,s=t==null?void 0:t.tagName.toLocaleLowerCase();return!!(s!=null&&s.match("^a$|textarea|input|select|button"))}onTouchUp(e,t){let s=this.getFirstActiveTouch(e.changedTouches);s||(s=this.touchLastTime),this.onUpCommon(s,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(e);const s={type:w.EVENT_DRAG_STOPPED,target:t};this.eventService.dispatchEvent(s)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(s=>s()),this.dragEndFunctions.length=0}};f([A("mouseEventService")],Ch.prototype,"mouseEventService",2);f([Fi],Ch.prototype,"removeAllListeners",1);Ch=f([Le("dragService")],Ch);var pC="ag-list-item-hovered",uN=class extends Se{constructor(e,t,s){super(),this.comp=e,this.virtualList=t,this.params=s,this.currentDragValue=null,this.lastHoveredListItem=null}postConstruct(){this.addManagedListener(this.params.eventSource,this.params.listItemDragStartEvent,this.listItemDragStart.bind(this)),this.addManagedListener(this.params.eventSource,this.params.listItemDragEndEvent,this.listItemDragEnd.bind(this)),this.createDropTarget(),this.createAutoScrollService()}listItemDragStart(e){this.currentDragValue=this.params.getCurrentDragValue(e),this.moveBlocked=this.params.isMoveBlocked(this.currentDragValue)}listItemDragEnd(){window.setTimeout(()=>{this.currentDragValue=null,this.moveBlocked=!1},10)}createDropTarget(){const e={isInterestedIn:t=>t===this.params.dragSourceType,getIconName:()=>this.moveBlocked?ut.ICON_PINNED:ut.ICON_MOVE,getContainer:()=>this.comp.getGui(),onDragging:t=>this.onDragging(t),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave()};this.dragAndDropService.addDropTarget(e)}createAutoScrollService(){const e=this.virtualList.getGui();this.autoScrollService=new cN({scrollContainer:e,scrollAxis:"y",getVerticalPosition:()=>e.scrollTop,setVerticalPosition:t=>e.scrollTop=t})}onDragging(e){if(!this.currentDragValue||this.moveBlocked)return;const t=this.getListDragItem(e),s=this.virtualList.getComponentAt(t.rowIndex);if(!s)return;const i=s.getGui().parentElement;this.lastHoveredListItem&&this.lastHoveredListItem.rowIndex===t.rowIndex&&this.lastHoveredListItem.position===t.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredListItem=t,Xy(i,pC),Xy(i,`ag-item-highlight-${t.position}`))}getListDragItem(e){const t=this.virtualList.getGui(),s=parseFloat(window.getComputedStyle(t).paddingTop),i=this.virtualList.getRowHeight(),r=this.virtualList.getScrollTop(),n=Math.max(0,(e.y-s+r)/i),o=this.params.getNumRows(this.comp)-1,a=Math.min(o,n)|0;return{rowIndex:a,position:Math.round(n)>n||n>o?"bottom":"top",component:this.virtualList.getComponentAt(a)}}onDragStop(){this.moveBlocked||(this.params.moveItem(this.currentDragValue,this.lastHoveredListItem),this.clearHoveredItems(),this.autoScrollService.ensureCleared())}onDragLeave(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll(`.${pC}`).forEach(t=>{[pC,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(s=>{t.classList.remove(s)})}),this.lastHoveredListItem=null}};f([A("dragAndDropService")],uN.prototype,"dragAndDropService",2);f([xe],uN.prototype,"postConstruct",1);function sl(e){const t=e;return t!=null&&t.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}var bt=class{constructor(){this.detailGridInfoMap={},this.destroyCalled=!1}init(){switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel;break}this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl})}__getAlignedGridService(){return this.alignedGridsService}getGridId(){return this.context.getGridId()}addDetailGridInfo(e,t){this.detailGridInfoMap[e]=t}removeDetailGridInfo(e){delete this.detailGridInfoMap[e]}getDetailGridInfo(e){return this.detailGridInfoMap[e]}forEachDetailGridInfo(e){let t=0;ui(this.detailGridInfoMap,(s,i)=>{ve(i)&&(e(i,t),t++)})}getDataAsCsv(e){if(Vt.__assertRegistered("@ag-grid-community/csv-export","api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(e)}exportDataAsCsv(e){Vt.__assertRegistered("@ag-grid-community/csv-export","api.exportDataAsCsv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(e)}assertNotExcelMultiSheet(e,t){return Vt.__assertRegistered("@ag-grid-enterprise/excel-export","api."+e,this.context.getGridId())?this.excelCreator.getFactoryMode()===1?(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1):!0:!1}getDataAsExcel(e){if(this.assertNotExcelMultiSheet("getDataAsExcel",e))return this.excelCreator.getDataAsExcel(e)}exportDataAsExcel(e){this.assertNotExcelMultiSheet("exportDataAsExcel",e)&&this.excelCreator.exportDataAsExcel(e)}getSheetDataForExcel(e){if(Vt.__assertRegistered("@ag-grid-enterprise/excel-export","api.getSheetDataForExcel",this.context.getGridId()))return this.excelCreator.setFactoryMode(1),this.excelCreator.getSheetDataForExcel(e)}getMultipleSheetsAsExcel(e){if(Vt.__assertRegistered("@ag-grid-enterprise/excel-export","api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(e)}exportMultipleSheetsAsExcel(e){Vt.__assertRegistered("@ag-grid-enterprise/excel-export","api.exportMultipleSheetsAsExcel",this.context.getGridId())&&this.excelCreator.exportMultipleSheetsAsExcel(e)}setGridAriaProperty(e,t){if(!e)return;const s=this.ctrlsService.getGridBodyCtrl().getGui(),i=`aria-${e}`;t===null?s.removeAttribute(i):s.setAttribute(i,t)}logMissingRowModel(e,...t){console.error(`AG Grid: api.${e} can only be called when gridOptions.rowModelType is ${t.join(" or ")}`)}logDeprecation(e,t,s,i){tt(`Since ${e} api.${t} is deprecated. Please use ${s} instead. ${i??""}`)}getPinnedTopRowCount(){return this.pinnedRowModel.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.pinnedRowModel.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.pinnedRowModel.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.pinnedRowModel.getPinnedBottomRow(e)}expireValueCache(){this.valueCache.expire()}getVerticalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}getHorizontalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}refreshCells(e={}){this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.refreshCells(e))}flashCells(e={}){const t=s=>tt(`Since v31.1 api.flashCells parameter '${s}Delay' is deprecated. Please use '${s}Duration' instead.`);ve(e.fadeDelay)&&t("fade"),ve(e.flashDelay)&&t("flash"),this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.flashCells(e))}redrawRows(e={}){const t=e?e.rowNodes:void 0;this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.redrawRows(t))}refreshHeader(){this.frameworkOverrides.wrapIncoming(()=>this.ctrlsService.getHeaderRowContainerCtrls().forEach(e=>e.refresh()))}isAnyFilterPresent(){return this.filterManager.isAnyFilterPresent()}isColumnFilterPresent(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}isQuickFilterPresent(){return this.filterManager.isQuickFilterPresent()}getModel(){return tt("Since v31.1 getModel() is deprecated. Please use the appropriate grid API methods instead."),this.rowModel}setRowNodeExpanded(e,t,s,i){this.expansionService.setRowNodeExpanded(e,t,s,i)}onGroupExpandedOrCollapsed(){if(ot(this.clientSideRowModel)){this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide");return}this.expansionService.onGroupExpandedOrCollapsed()}refreshClientSideRowModel(e){if(ot(this.clientSideRowModel)){this.logMissingRowModel("refreshClientSideRowModel","clientSide");return}this.clientSideRowModel.refreshModel(e)}isAnimationFrameQueueEmpty(){return this.animationFrameService.isQueueEmpty()}flushAllAnimationFrames(){this.animationFrameService.flushAllFrames()}getRowNode(e){return this.rowModel.getRowNode(e)}getSizesForCurrentTheme(){return{rowHeight:this.gos.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}expandAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}collapseAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!1):this.logMissingRowModel("collapseAll","clientSide","serverSide")}addRenderedRowListener(e,t,s){this.rowRenderer.addRenderedRowListener(e,t,s)}getQuickFilter(){return this.gos.get("quickFilterText")}getAdvancedFilterModel(){return Vt.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.getAdvancedFilterModel",this.context.getGridId())?this.filterManager.getAdvancedFilterModel():null}setAdvancedFilterModel(e){this.filterManager.setAdvancedFilterModel(e)}showAdvancedFilterBuilder(){Vt.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.setAdvancedFilterModel",this.context.getGridId())&&this.filterManager.showAdvancedFilterBuilder("api")}setNodesSelected(e){if(!e.nodes.every(o=>o.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):o.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),!1):!0))return;const{nodes:s,source:i,newValue:r}=e,n=s;this.selectionService.setNodesSelected({nodes:n,source:i??"api",newValue:r})}selectAll(e="apiSelectAll"){this.selectionService.selectAllRowNodes({source:e})}deselectAll(e="apiSelectAll"){this.selectionService.deselectAllRowNodes({source:e})}selectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.selectAllRowNodes({source:e,justFiltered:!0})}deselectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.deselectAllRowNodes({source:e,justFiltered:!0})}getServerSideSelectionState(){return ot(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getSelectionState()}setServerSideSelectionState(e){if(ot(this.serverSideRowModel)){this.logMissingRowModel("setServerSideSelectionState","serverSide");return}this.selectionService.setSelectionState(e,"api")}selectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.selectAllRowNodes({source:e,justCurrentPage:!0})}deselectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.deselectAllRowNodes({source:e,justCurrentPage:!0})}showLoadingOverlay(){this.overlayService.showLoadingOverlay()}showNoRowsOverlay(){this.overlayService.showNoRowsOverlay()}hideOverlay(){this.overlayService.hideOverlay()}getSelectedNodes(){return this.selectionService.getSelectedNodes()}getSelectedRows(){return this.selectionService.getSelectedRows()}getBestCostNodeSelection(){if(ot(this.clientSideRowModel)){this.logMissingRowModel("getBestCostNodeSelection","clientSide");return}return this.selectionService.getBestCostNodeSelection()}getRenderedNodes(){return this.rowRenderer.getRenderedNodes()}ensureColumnVisible(e,t="auto"){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(e,t),"ensureVisible")}ensureIndexVisible(e,t){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e,t),"ensureVisible")}ensureNodeVisible(e,t=null){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(e,t),"ensureVisible")}forEachLeafNode(e){if(ot(this.clientSideRowModel)){this.logMissingRowModel("forEachLeafNode","clientSide");return}this.clientSideRowModel.forEachLeafNode(e)}forEachNode(e,t){this.rowModel.forEachNode(e,t)}forEachNodeAfterFilter(e){if(ot(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilter","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilter(e)}forEachNodeAfterFilterAndSort(e){if(ot(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilterAndSort(e)}getFilterInstance(e,t){return tt("'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."),this.filterManager.getFilterInstance(e,t)}getColumnFilterInstance(e){return this.filterManager.getColumnFilterInstance(e)}destroyFilter(e){const t=this.columnModel.getPrimaryColumn(e);if(t)return this.filterManager.destroyFilter(t,"api")}getStatusPanel(e){if(!Vt.__assertRegistered("@ag-grid-enterprise/status-bar","api.getStatusPanel",this.context.getGridId()))return;const t=this.statusBarService.getStatusPanel(e);return sl(t)}getColumnDef(e){const t=this.columnModel.getPrimaryColumn(e);return t?t.getColDef():null}getColumnDefs(){return this.columnModel.getColumnDefs()}onFilterChanged(e="api"){this.filterManager.onFilterChanged({source:e})}onSortChanged(){this.sortController.onSortChanged("api")}setFilterModel(e){this.frameworkOverrides.wrapIncoming(()=>this.filterManager.setFilterModel(e))}getFilterModel(){return this.filterManager.getFilterModel()}getColumnFilterModel(e){return this.filterManager.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.filterManager.setColumnFilterModel(e,t)}getFocusedCell(){return this.focusService.getFocusedCell()}clearFocusedCell(){return this.focusService.clearFocusedCell()}setFocusedCell(e,t,s){this.focusService.setFocusedCell({rowIndex:e,column:t,rowPinned:s,forceBrowserFocus:!0})}addRowDropZone(e){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(e)}removeRowDropZone(e){const t=this.dragAndDropService.findExternalZone(e);t&&this.dragAndDropService.removeDropTarget(t)}getRowDropZoneParams(e){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(e)}assertSideBarLoaded(e){return Vt.__assertRegistered("@ag-grid-enterprise/side-bar","api."+e,this.context.getGridId())}isSideBarVisible(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarService.getSideBarComp().isDisplayed()}setSideBarVisible(e){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarService.getSideBarComp().setDisplayed(e)}setSideBarPosition(e){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarService.getSideBarComp().setSideBarPosition(e)}openToolPanel(e){this.assertSideBarLoaded("openToolPanel")&&this.sideBarService.getSideBarComp().openToolPanel(e,"api")}closeToolPanel(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarService.getSideBarComp().close("api")}getOpenedToolPanel(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarService.getSideBarComp().openedItem():null}refreshToolPanel(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarService.getSideBarComp().refresh()}isToolPanelShowing(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarService.getSideBarComp().isToolPanelShowing()}getToolPanelInstance(e){if(this.assertSideBarLoaded("getToolPanelInstance")){const t=this.sideBarService.getSideBarComp().getToolPanelInstance(e);return sl(t)}}getSideBar(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarService.getSideBarComp().getDef()}resetRowHeights(){if(ve(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive()){console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");return}this.clientSideRowModel.resetRowHeights()}}setRowCount(e,t){if(this.serverSideRowModel){if(this.columnModel.isRowGroupEmpty()){this.serverSideRowModel.setRowCount(e,t);return}console.error("AG Grid: setRowCount cannot be used while using row grouping.");return}if(this.infiniteRowModel){this.infiniteRowModel.setRowCount(e,t);return}this.logMissingRowModel("setRowCount","infinite","serverSide")}onRowHeightChanged(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}getValue(e,t){return this.logDeprecation("31.3","getValue","getCellValue"),this.getCellValue({colKey:e,rowNode:t})}getCellValue(e){var t;const{colKey:s,rowNode:i,useFormatter:r}=e;let n=(t=this.columnModel.getPrimaryColumn(s))!=null?t:this.columnModel.getGridColumn(s);if(ot(n))return null;const o=this.valueService.getValue(n,i);if(r){const a=this.valueService.formatValue(n,i,o);return a??Ds(o,!0)}return o}addEventListener(e,t){this.apiEventService.addEventListener(e,t)}addGlobalListener(e){this.apiEventService.addGlobalListener(e)}removeEventListener(e,t){this.apiEventService.removeEventListener(e,t)}removeGlobalListener(e){this.apiEventService.removeGlobalListener(e)}dispatchEvent(e){this.eventService.dispatchEvent(e)}destroy(){var e;const t=`See ${this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}`;if(this.destroyCalled)return;const s={type:w.EVENT_GRID_PRE_DESTROYED,state:this.getState()};this.dispatchEvent(s),this.destroyCalled=!0,(e=this.ctrlsService.get("gridCtrl"))==null||e.destroyGridUi(),this.context.destroy(),this.detailGridInfoMap={},aA(this,["isDestroyed"],t)}isDestroyed(){return this.destroyCalled}resetQuickFilter(){this.filterManager.resetQuickFilterCache()}getCellRanges(){return this.rangeService?this.rangeService.getCellRanges():(Vt.__assertRegistered("@ag-grid-enterprise/range-selection","api.getCellRanges",this.context.getGridId()),null)}addCellRange(e){if(this.rangeService){this.rangeService.addCellRange(e);return}Vt.__assertRegistered("@ag-grid-enterprise/range-selection","api.addCellRange",this.context.getGridId())}clearRangeSelection(){this.rangeService&&this.rangeService.removeAllCellRanges(),Vt.__assertRegistered("@ag-grid-enterprise/range-selection","gridApi.clearRangeSelection",this.context.getGridId())}undoCellEditing(){this.undoRedoService.undo("api")}redoCellEditing(){this.undoRedoService.redo("api")}getCurrentUndoSize(){return this.undoRedoService.getCurrentUndoStackSize()}getCurrentRedoSize(){return this.undoRedoService.getCurrentRedoStackSize()}assertChart(e,t){if(Vt.__assertRegistered("@ag-grid-enterprise/charts","api."+e,this.context.getGridId()))return this.frameworkOverrides.wrapIncoming(()=>t())}getChartModels(){return this.assertChart("getChartModels",()=>this.chartService.getChartModels())}getChartRef(e){return this.assertChart("getChartRef",()=>this.chartService.getChartRef(e))}getChartImageDataURL(e){return this.assertChart("getChartImageDataURL",()=>this.chartService.getChartImageDataURL(e))}downloadChart(e){return this.assertChart("downloadChart",()=>this.chartService.downloadChart(e))}openChartToolPanel(e){return this.assertChart("openChartToolPanel",()=>this.chartService.openChartToolPanel(e))}closeChartToolPanel(e){return this.assertChart("closeChartToolPanel",()=>this.chartService.closeChartToolPanel(e.chartId))}createRangeChart(e){return this.assertChart("createRangeChart",()=>this.chartService.createRangeChart(e))}createPivotChart(e){return this.assertChart("createPivotChart",()=>this.chartService.createPivotChart(e))}createCrossFilterChart(e){return this.assertChart("createCrossFilterChart",()=>this.chartService.createCrossFilterChart(e))}updateChart(e){return this.assertChart("updateChart",()=>this.chartService.updateChart(e))}restoreChart(e,t){return this.assertChart("restoreChart",()=>this.chartService.restoreChart(e,t))}assertClipboard(e,t){Vt.__assertRegistered("@ag-grid-enterprise/clipboard","api"+e,this.context.getGridId())&&t()}copyToClipboard(e){this.assertClipboard("copyToClipboard",()=>this.clipboardService.copyToClipboard(e))}cutToClipboard(e){this.assertClipboard("cutToClipboard",()=>this.clipboardService.cutToClipboard(e))}copySelectedRowsToClipboard(e){this.assertClipboard("copySelectedRowsToClipboard",()=>this.clipboardService.copySelectedRowsToClipboard(e))}copySelectedRangeToClipboard(e){this.assertClipboard("copySelectedRangeToClipboard",()=>this.clipboardService.copySelectedRangeToClipboard(e))}copySelectedRangeDown(){this.assertClipboard("copySelectedRangeDown",()=>this.clipboardService.copyRangeDown())}pasteFromClipboard(){this.assertClipboard("pasteFromClipboard",()=>this.clipboardService.pasteFromClipboard())}showColumnMenuAfterButtonClick(e,t){tt("'showColumnMenuAfterButtonClick' is deprecated. Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere.");const s=this.columnModel.getGridColumn(e);this.menuService.showColumnMenu({column:s,buttonElement:t,positionBy:"button"})}showColumnMenuAfterMouseClick(e,t){tt("'showColumnMenuAfterMouseClick' is deprecated. Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere.");let s=this.columnModel.getGridColumn(e);if(s||(s=this.columnModel.getPrimaryColumn(e)),!s){console.error(`AG Grid: column '${e}' not found`);return}this.menuService.showColumnMenu({column:s,mouseEvent:t,positionBy:"mouse"})}showContextMenu(e){const{rowNode:t,column:s,value:i,x:r,y:n}=e||{};let{x:o,y:a}=this.menuService.getContextMenuPosition(t,s);r!=null&&(o=r),n!=null&&(a=n),this.menuService.showContextMenu({mouseEvent:new MouseEvent("mousedown",{clientX:o,clientY:a}),rowNode:t,column:s,value:i})}showColumnChooser(e){this.menuService.showColumnChooser({chooserParams:e})}showColumnFilter(e){const t=this.columnModel.getGridColumn(e);if(!t){console.error(`AG Grid: column '${e}' not found`);return}this.menuService.showFilterMenu({column:t,containerType:"columnFilter",positionBy:"auto"})}showColumnMenu(e){const t=this.columnModel.getGridColumn(e);if(!t){console.error(`AG Grid: column '${e}' not found`);return}this.menuService.showColumnMenu({column:t,positionBy:"auto"})}hidePopupMenu(){this.menuService.hidePopupMenu()}hideColumnChooser(){this.menuService.hideColumnChooser()}tabToNextCell(e){return this.navigationService.tabToNextCell(!1,e)}tabToPreviousCell(e){return this.navigationService.tabToNextCell(!0,e)}getCellRendererInstances(e={}){return this.rowRenderer.getCellRendererInstances(e).map(sl)}getCellEditorInstances(e={}){return this.rowRenderer.getCellEditorInstances(e).map(sl)}getEditingCells(){return this.rowRenderer.getEditingCells()}stopEditing(e=!1){this.rowRenderer.stopEditing(e)}startEditingCell(e){const t=this.columnModel.getGridColumn(e.colKey);if(!t){console.warn(`AG Grid: no column found for ${e.colKey}`);return}const s={rowIndex:e.rowIndex,rowPinned:e.rowPinned||null,column:t};e.rowPinned==null&&this.ensureIndexVisible(e.rowIndex),this.ensureColumnVisible(e.colKey);const r=this.navigationService.getCellByPosition(s);r&&(this.focusService.isCellFocused(s)||this.focusService.setFocusedCell(s),r.startRowOrCellEdit(e.key))}addAggFunc(e,t){this.logDeprecation("v31.1","addAggFunc(key, func)","addAggFuncs({ key: func })"),this.aggFuncService&&this.aggFuncService.addAggFuncs({key:t})}addAggFuncs(e){this.aggFuncService&&this.aggFuncService.addAggFuncs(e)}clearAggFuncs(){this.aggFuncService&&this.aggFuncService.clear()}applyServerSideTransaction(e){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransaction","serverSide");return}return this.serverSideTransactionManager.applyTransaction(e)}applyServerSideTransactionAsync(e,t){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransactionAsync","serverSide");return}return this.serverSideTransactionManager.applyTransactionAsync(e,t)}applyServerSideRowData(e){var t,s;const i=(t=e.startRow)!=null?t:0,r=(s=e.route)!=null?s:[];if(i<0){console.warn(`AG Grid: invalid value ${e.startRow} for startRow, the value should be >= 0`);return}this.serverSideRowModel?this.serverSideRowModel.applyRowData(e.successParams,i,r):this.logMissingRowModel("setServerSideDatasource","serverSide")}retryServerSideLoads(){if(!this.serverSideRowModel){this.logMissingRowModel("retryServerSideLoads","serverSide");return}this.serverSideRowModel.retryLoads()}flushServerSideAsyncTransactions(){if(!this.serverSideTransactionManager){this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide");return}return this.serverSideTransactionManager.flushAsyncTransactions()}applyTransaction(e){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransaction","clientSide");return}return this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.updateRowData(e))}applyTransactionAsync(e,t){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransactionAsync","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.batchUpdateRowData(e,t))}flushAsyncTransactions(){if(!this.clientSideRowModel){this.logMissingRowModel("flushAsyncTransactions","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.flushAsyncTransactions())}refreshInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}purgeInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}refreshServerSide(e){if(!this.serverSideRowModel){this.logMissingRowModel("refreshServerSide","serverSide");return}this.serverSideRowModel.refreshStore(e)}getServerSideGroupLevelState(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}getInfiniteRowCount(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}isLastRowIndexKnown(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}getCacheBlockState(){return this.rowNodeBlockLoader.getBlockState()}getFirstDisplayedRow(){return this.logDeprecation("v31.1","getFirstDisplayedRow","getFirstDisplayedRowIndex"),this.getFirstDisplayedRowIndex()}getFirstDisplayedRowIndex(){return this.rowRenderer.getFirstVirtualRenderedRow()}getLastDisplayedRow(){return this.logDeprecation("v31.1","getLastDisplayedRow","getLastDisplayedRowIndex"),this.getLastDisplayedRowIndex()}getLastDisplayedRowIndex(){return this.rowRenderer.getLastVirtualRenderedRow()}getDisplayedRowAtIndex(e){return this.rowModel.getRow(e)}getDisplayedRowCount(){return this.rowModel.getRowCount()}paginationIsLastPageFound(){return this.paginationProxy.isLastPageFound()}paginationGetPageSize(){return this.paginationProxy.getPageSize()}paginationGetCurrentPage(){return this.paginationProxy.getCurrentPage()}paginationGetTotalPages(){return this.paginationProxy.getTotalPages()}paginationGetRowCount(){return this.paginationProxy.getMasterRowCount()}paginationGoToNextPage(){this.paginationProxy.goToNextPage()}paginationGoToPreviousPage(){this.paginationProxy.goToPreviousPage()}paginationGoToFirstPage(){this.paginationProxy.goToFirstPage()}paginationGoToLastPage(){this.paginationProxy.goToLastPage()}paginationGoToPage(e){this.paginationProxy.goToPage(e)}sizeColumnsToFit(e){typeof e=="number"?this.columnModel.sizeColumnsToFit(e,"api"):this.gridBodyCtrl.sizeColumnsToFit(e)}setColumnGroupOpened(e,t){this.columnModel.setColumnGroupOpened(e,t,"api")}getColumnGroup(e,t){return this.columnModel.getColumnGroup(e,t)}getProvidedColumnGroup(e){return this.columnModel.getProvidedColumnGroup(e)}getDisplayNameForColumn(e,t){return this.columnModel.getDisplayNameForColumn(e,t)||""}getDisplayNameForColumnGroup(e,t){return this.columnModel.getDisplayNameForColumnGroup(e,t)||""}getColumn(e){return this.columnModel.getPrimaryColumn(e)}getColumns(){return this.columnModel.getAllPrimaryColumns()}applyColumnState(e){return this.columnModel.applyColumnState(e,"api")}getColumnState(){return this.columnModel.getColumnState()}resetColumnState(){this.columnModel.resetColumnState("api")}getColumnGroupState(){return this.columnModel.getColumnGroupState()}setColumnGroupState(e){this.columnModel.setColumnGroupState(e,"api")}resetColumnGroupState(){this.columnModel.resetColumnGroupState("api")}isPinning(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}isPinningLeft(){return this.columnModel.isPinningLeft()}isPinningRight(){return this.columnModel.isPinningRight()}getDisplayedColAfter(e){return this.columnModel.getDisplayedColAfter(e)}getDisplayedColBefore(e){return this.columnModel.getDisplayedColBefore(e)}setColumnVisible(e,t){this.logDeprecation("v31.1","setColumnVisible(key,visible)","setColumnsVisible([key],visible)"),this.columnModel.setColumnsVisible([e],t,"api")}setColumnsVisible(e,t){this.columnModel.setColumnsVisible(e,t,"api")}setColumnPinned(e,t){this.logDeprecation("v31.1","setColumnPinned(key,pinned)","setColumnsPinned([key],pinned)"),this.columnModel.setColumnsPinned([e],t,"api")}setColumnsPinned(e,t){this.columnModel.setColumnsPinned(e,t,"api")}getAllGridColumns(){return this.columnModel.getAllGridColumns()}getDisplayedLeftColumns(){return this.columnModel.getDisplayedLeftColumns()}getDisplayedCenterColumns(){return this.columnModel.getDisplayedCenterColumns()}getDisplayedRightColumns(){return this.columnModel.getDisplayedRightColumns()}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getAllDisplayedVirtualColumns(){return this.columnModel.getViewportColumns()}moveColumn(e,t){this.logDeprecation("v31.1","moveColumn(key, toIndex)","moveColumns([key], toIndex)"),this.columnModel.moveColumns([e],t,"api")}moveColumnByIndex(e,t){this.columnModel.moveColumnByIndex(e,t,"api")}moveColumns(e,t){this.columnModel.moveColumns(e,t,"api")}moveRowGroupColumn(e,t){this.columnModel.moveRowGroupColumn(e,t,"api")}setColumnAggFunc(e,t){this.columnModel.setColumnAggFunc(e,t,"api")}setColumnWidth(e,t,s=!0,i="api"){this.logDeprecation("v31.1","setColumnWidth(col, width)","setColumnWidths([{key: col, newWidth: width}])"),this.columnModel.setColumnWidths([{key:e,newWidth:t}],!1,s,i)}setColumnWidths(e,t=!0,s="api"){this.columnModel.setColumnWidths(e,!1,t,s)}isPivotMode(){return this.columnModel.isPivotMode()}getPivotResultColumn(e,t){return this.columnModel.getSecondaryPivotColumn(e,t)}setValueColumns(e){this.columnModel.setValueColumns(e,"api")}getValueColumns(){return this.columnModel.getValueColumns()}removeValueColumn(e){this.logDeprecation("v31.1","removeValueColumn(colKey)","removeValueColumns([colKey])"),this.columnModel.removeValueColumns([e],"api")}removeValueColumns(e){this.columnModel.removeValueColumns(e,"api")}addValueColumn(e){this.logDeprecation("v31.1","addValueColumn(colKey)","addValueColumns([colKey])"),this.columnModel.addValueColumns([e],"api")}addValueColumns(e){this.columnModel.addValueColumns(e,"api")}setRowGroupColumns(e){this.columnModel.setRowGroupColumns(e,"api")}removeRowGroupColumn(e){this.logDeprecation("v31.1","removeRowGroupColumn(colKey)","removeRowGroupColumns([colKey])"),this.columnModel.removeRowGroupColumns([e],"api")}removeRowGroupColumns(e){this.columnModel.removeRowGroupColumns(e,"api")}addRowGroupColumn(e){this.logDeprecation("v31.1","addRowGroupColumn(colKey)","addRowGroupColumns([colKey])"),this.columnModel.addRowGroupColumns([e],"api")}addRowGroupColumns(e){this.columnModel.addRowGroupColumns(e,"api")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}setPivotColumns(e){this.columnModel.setPivotColumns(e,"api")}removePivotColumn(e){this.logDeprecation("v31.1","removePivotColumn(colKey)","removePivotColumns([colKey])"),this.columnModel.removePivotColumns([e],"api")}removePivotColumns(e){this.columnModel.removePivotColumns(e,"api")}addPivotColumn(e){this.logDeprecation("v31.1","addPivotColumn(colKey)","addPivotColumns([colKey])"),this.columnModel.addPivotColumns([e],"api")}addPivotColumns(e){this.columnModel.addPivotColumns(e,"api")}getPivotColumns(){return this.columnModel.getPivotColumns()}getLeftDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeLeft()}getCenterDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeCentre()}getRightDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeRight()}getAllDisplayedColumnGroups(){return this.columnModel.getAllDisplayedTrees()}autoSizeColumn(e,t){return this.logDeprecation("v31.1","autoSizeColumn(key, skipHeader)","autoSizeColumns([key], skipHeader)"),this.columnModel.autoSizeColumns({columns:[e],skipHeader:t,source:"api"})}autoSizeColumns(e,t){this.columnModel.autoSizeColumns({columns:e,skipHeader:t,source:"api"})}autoSizeAllColumns(e){this.columnModel.autoSizeAllColumns("api",e)}setPivotResultColumns(e){this.columnModel.setSecondaryColumns(e,"api")}getPivotResultColumns(){return this.columnModel.getSecondaryColumns()}getState(){return this.stateService.getState()}getGridOption(e){return this.gos.get(e)}setGridOption(e,t){this.updateGridOptions({[e]:t})}updateGridOptions(e){this.gos.updateGridOptions({options:e})}__internalUpdateGridOptions(e,t){this.gos.updateGridOptions({options:e,force:t,source:"gridOptionsUpdated"})}deprecatedUpdateGridOption(e,t){tt(`set${e.charAt(0).toUpperCase()}${e.slice(1,e.length)} is deprecated. Please use 'api.setGridOption('${e}', newValue)' or 'api.updateGridOptions({ ${e}: newValue })' instead.`),this.setGridOption(e,t)}setPivotMode(e){this.deprecatedUpdateGridOption("pivotMode",e)}setPinnedTopRowData(e){this.deprecatedUpdateGridOption("pinnedTopRowData",e)}setPinnedBottomRowData(e){this.deprecatedUpdateGridOption("pinnedBottomRowData",e)}setPopupParent(e){this.deprecatedUpdateGridOption("popupParent",e)}setSuppressModelUpdateAfterUpdateTransaction(e){this.deprecatedUpdateGridOption("suppressModelUpdateAfterUpdateTransaction",e)}setDataTypeDefinitions(e){this.deprecatedUpdateGridOption("dataTypeDefinitions",e)}setPagination(e){this.deprecatedUpdateGridOption("pagination",e)}paginationSetPageSize(e){this.deprecatedUpdateGridOption("paginationPageSize",e)}setSideBar(e){this.deprecatedUpdateGridOption("sideBar",e)}setSuppressClipboardPaste(e){this.deprecatedUpdateGridOption("suppressClipboardPaste",e)}setGroupRemoveSingleChildren(e){this.deprecatedUpdateGridOption("groupRemoveSingleChildren",e)}setGroupRemoveLowestSingleChildren(e){this.deprecatedUpdateGridOption("groupRemoveLowestSingleChildren",e)}setGroupDisplayType(e){this.deprecatedUpdateGridOption("groupDisplayType",e)}setGroupIncludeFooter(e){this.deprecatedUpdateGridOption("groupIncludeFooter",e)}setGroupIncludeTotalFooter(e){this.deprecatedUpdateGridOption("groupIncludeTotalFooter",e)}setRowClass(e){this.deprecatedUpdateGridOption("rowClass",e)}setDeltaSort(e){this.deprecatedUpdateGridOption("deltaSort",e)}setSuppressRowDrag(e){this.deprecatedUpdateGridOption("suppressRowDrag",e)}setSuppressMoveWhenRowDragging(e){this.deprecatedUpdateGridOption("suppressMoveWhenRowDragging",e)}setSuppressRowClickSelection(e){this.deprecatedUpdateGridOption("suppressRowClickSelection",e)}setEnableAdvancedFilter(e){this.deprecatedUpdateGridOption("enableAdvancedFilter",e)}setIncludeHiddenColumnsInAdvancedFilter(e){this.deprecatedUpdateGridOption("includeHiddenColumnsInAdvancedFilter",e)}setAdvancedFilterParent(e){this.deprecatedUpdateGridOption("advancedFilterParent",e)}setAdvancedFilterBuilderParams(e){this.deprecatedUpdateGridOption("advancedFilterBuilderParams",e)}setQuickFilter(e){tt("setQuickFilter is deprecated. Please use 'api.setGridOption('quickFilterText', newValue)' or 'api.updateGridOptions({ quickFilterText: newValue })' instead."),this.gos.updateGridOptions({options:{quickFilterText:e}})}setExcludeHiddenColumnsFromQuickFilter(e){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",!e)}setIncludeHiddenColumnsInQuickFilter(e){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",e)}setQuickFilterParser(e){this.deprecatedUpdateGridOption("quickFilterParser",e)}setQuickFilterMatcher(e){this.deprecatedUpdateGridOption("quickFilterMatcher",e)}setAlwaysShowHorizontalScroll(e){this.deprecatedUpdateGridOption("alwaysShowHorizontalScroll",e)}setAlwaysShowVerticalScroll(e){this.deprecatedUpdateGridOption("alwaysShowVerticalScroll",e)}setFunctionsReadOnly(e){this.deprecatedUpdateGridOption("functionsReadOnly",e)}setColumnDefs(e,t="api"){tt("setColumnDefs is deprecated. Please use 'api.setGridOption('columnDefs', newValue)' or 'api.updateGridOptions({ columnDefs: newValue })' instead."),this.gos.updateGridOptions({options:{columnDefs:e},source:t})}setAutoGroupColumnDef(e,t="api"){tt("setAutoGroupColumnDef is deprecated. Please use 'api.setGridOption('autoGroupColumnDef', newValue)' or 'api.updateGridOptions({ autoGroupColumnDef: newValue })' instead."),this.gos.updateGridOptions({options:{autoGroupColumnDef:e},source:t})}setDefaultColDef(e,t="api"){tt("setDefaultColDef is deprecated. Please use 'api.setGridOption('defaultColDef', newValue)' or 'api.updateGridOptions({ defaultColDef: newValue })' instead."),this.gos.updateGridOptions({options:{defaultColDef:e},source:t})}setColumnTypes(e,t="api"){tt("setColumnTypes is deprecated. Please use 'api.setGridOption('columnTypes', newValue)' or 'api.updateGridOptions({ columnTypes: newValue })' instead."),this.gos.updateGridOptions({options:{columnTypes:e},source:t})}setTreeData(e){this.deprecatedUpdateGridOption("treeData",e)}setServerSideDatasource(e){this.deprecatedUpdateGridOption("serverSideDatasource",e)}setCacheBlockSize(e){this.deprecatedUpdateGridOption("cacheBlockSize",e)}setDatasource(e){this.deprecatedUpdateGridOption("datasource",e)}setViewportDatasource(e){this.deprecatedUpdateGridOption("viewportDatasource",e)}setRowData(e){this.deprecatedUpdateGridOption("rowData",e)}setEnableCellTextSelection(e){this.deprecatedUpdateGridOption("enableCellTextSelection",e)}setHeaderHeight(e){this.deprecatedUpdateGridOption("headerHeight",e)}setDomLayout(e){this.deprecatedUpdateGridOption("domLayout",e)}setFillHandleDirection(e){this.deprecatedUpdateGridOption("fillHandleDirection",e)}setGroupHeaderHeight(e){this.deprecatedUpdateGridOption("groupHeaderHeight",e)}setFloatingFiltersHeight(e){this.deprecatedUpdateGridOption("floatingFiltersHeight",e)}setPivotHeaderHeight(e){this.deprecatedUpdateGridOption("pivotHeaderHeight",e)}setPivotGroupHeaderHeight(e){this.deprecatedUpdateGridOption("pivotGroupHeaderHeight",e)}setAnimateRows(e){this.deprecatedUpdateGridOption("animateRows",e)}setIsExternalFilterPresent(e){this.deprecatedUpdateGridOption("isExternalFilterPresent",e)}setDoesExternalFilterPass(e){this.deprecatedUpdateGridOption("doesExternalFilterPass",e)}setNavigateToNextCell(e){this.deprecatedUpdateGridOption("navigateToNextCell",e)}setTabToNextCell(e){this.deprecatedUpdateGridOption("tabToNextCell",e)}setTabToNextHeader(e){this.deprecatedUpdateGridOption("tabToNextHeader",e)}setNavigateToNextHeader(e){this.deprecatedUpdateGridOption("navigateToNextHeader",e)}setRowGroupPanelShow(e){this.deprecatedUpdateGridOption("rowGroupPanelShow",e)}setGetGroupRowAgg(e){this.deprecatedUpdateGridOption("getGroupRowAgg",e)}setGetBusinessKeyForNode(e){this.deprecatedUpdateGridOption("getBusinessKeyForNode",e)}setGetChildCount(e){this.deprecatedUpdateGridOption("getChildCount",e)}setProcessRowPostCreate(e){this.deprecatedUpdateGridOption("processRowPostCreate",e)}setGetRowId(e){tt("getRowId is a static property and can no longer be updated.")}setGetRowClass(e){this.deprecatedUpdateGridOption("getRowClass",e)}setIsFullWidthRow(e){this.deprecatedUpdateGridOption("isFullWidthRow",e)}setIsRowSelectable(e){this.deprecatedUpdateGridOption("isRowSelectable",e)}setIsRowMaster(e){this.deprecatedUpdateGridOption("isRowMaster",e)}setPostSortRows(e){this.deprecatedUpdateGridOption("postSortRows",e)}setGetDocument(e){this.deprecatedUpdateGridOption("getDocument",e)}setGetContextMenuItems(e){this.deprecatedUpdateGridOption("getContextMenuItems",e)}setGetMainMenuItems(e){this.deprecatedUpdateGridOption("getMainMenuItems",e)}setProcessCellForClipboard(e){this.deprecatedUpdateGridOption("processCellForClipboard",e)}setSendToClipboard(e){this.deprecatedUpdateGridOption("sendToClipboard",e)}setProcessCellFromClipboard(e){this.deprecatedUpdateGridOption("processCellFromClipboard",e)}setProcessPivotResultColDef(e){this.deprecatedUpdateGridOption("processPivotResultColDef",e)}setProcessPivotResultColGroupDef(e){this.deprecatedUpdateGridOption("processPivotResultColGroupDef",e)}setPostProcessPopup(e){this.deprecatedUpdateGridOption("postProcessPopup",e)}setInitialGroupOrderComparator(e){this.deprecatedUpdateGridOption("initialGroupOrderComparator",e)}setGetChartToolbarItems(e){this.deprecatedUpdateGridOption("getChartToolbarItems",e)}setPaginationNumberFormatter(e){this.deprecatedUpdateGridOption("paginationNumberFormatter",e)}setGetServerSideGroupLevelParams(e){this.deprecatedUpdateGridOption("getServerSideGroupLevelParams",e)}setIsServerSideGroupOpenByDefault(e){this.deprecatedUpdateGridOption("isServerSideGroupOpenByDefault",e)}setIsApplyServerSideTransaction(e){this.deprecatedUpdateGridOption("isApplyServerSideTransaction",e)}setIsServerSideGroup(e){this.deprecatedUpdateGridOption("isServerSideGroup",e)}setGetServerSideGroupKey(e){this.deprecatedUpdateGridOption("getServerSideGroupKey",e)}setGetRowStyle(e){this.deprecatedUpdateGridOption("getRowStyle",e)}setGetRowHeight(e){this.deprecatedUpdateGridOption("getRowHeight",e)}};f([A("rowRenderer")],bt.prototype,"rowRenderer",2);f([A("navigationService")],bt.prototype,"navigationService",2);f([A("filterManager")],bt.prototype,"filterManager",2);f([A("columnModel")],bt.prototype,"columnModel",2);f([A("selectionService")],bt.prototype,"selectionService",2);f([A("gridOptionsService")],bt.prototype,"gos",2);f([A("valueService")],bt.prototype,"valueService",2);f([A("alignedGridsService")],bt.prototype,"alignedGridsService",2);f([A("eventService")],bt.prototype,"eventService",2);f([A("pinnedRowModel")],bt.prototype,"pinnedRowModel",2);f([A("context")],bt.prototype,"context",2);f([A("rowModel")],bt.prototype,"rowModel",2);f([A("sortController")],bt.prototype,"sortController",2);f([A("paginationProxy")],bt.prototype,"paginationProxy",2);f([A("focusService")],bt.prototype,"focusService",2);f([A("dragAndDropService")],bt.prototype,"dragAndDropService",2);f([A("menuService")],bt.prototype,"menuService",2);f([A("valueCache")],bt.prototype,"valueCache",2);f([A("animationFrameService")],bt.prototype,"animationFrameService",2);f([A("ctrlsService")],bt.prototype,"ctrlsService",2);f([A("overlayService")],bt.prototype,"overlayService",2);f([A("stateService")],bt.prototype,"stateService",2);f([A("expansionService")],bt.prototype,"expansionService",2);f([A("apiEventService")],bt.prototype,"apiEventService",2);f([A("frameworkOverrides")],bt.prototype,"frameworkOverrides",2);f([A("undoRedoService")],bt.prototype,"undoRedoService",2);f([A("rowNodeBlockLoader")],bt.prototype,"rowNodeBlockLoader",2);f([zt("csvCreator")],bt.prototype,"csvCreator",2);f([zt("excelCreator")],bt.prototype,"excelCreator",2);f([zt("rangeService")],bt.prototype,"rangeService",2);f([zt("clipboardService")],bt.prototype,"clipboardService",2);f([zt("aggFuncService")],bt.prototype,"aggFuncService",2);f([zt("statusBarService")],bt.prototype,"statusBarService",2);f([zt("chartService")],bt.prototype,"chartService",2);f([zt("ssrmTransactionManager")],bt.prototype,"serverSideTransactionManager",2);f([zt("sideBarService")],bt.prototype,"sideBarService",2);f([xe],bt.prototype,"init",1);bt=f([Le("gridApi")],bt);var Ki=class extends Se{constructor(){super(...arguments),this.quickFilter=null,this.quickFilterParts=null}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",e=>this.setQuickFilter(e.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onQuickFilterColumnConfigChanged()),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}isQuickFilterPresent(){return this.quickFilter!==null}doesRowPassQuickFilter(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(t,e):this.quickFilterParts.every(s=>t?this.doesRowPassQuickFilterCache(e,s):this.doesRowPassQuickFilterNoCache(e,s))}resetQuickFilterCache(){this.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseQuickFilter(e){return ve(e)?this.gos.isRowModelType("clientSide")?e.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(e!=null&&typeof e!="string"){console.warn(`AG Grid - Grid option quickFilterText only supports string inputs, received: ${typeof e}`);return}const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.dispatchEvent({type:Ki.EVENT_QUICK_FILTER_CHANGED}))}setQuickFilterParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),s=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,s&&(this.setQuickFilterParts(),this.dispatchEvent({type:Ki.EVENT_QUICK_FILTER_CHANGED}))}onQuickFilterColumnConfigChanged(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchEvent({type:Ki.EVENT_QUICK_FILTER_CHANGED})}doesRowPassQuickFilterNoCache(e,t){return this.columnModel.getAllColumnsForQuickFilter().some(i=>{const r=this.getQuickFilterTextForColumn(i,e);return ve(r)&&r.indexOf(t)>=0})}doesRowPassQuickFilterCache(e,t){return this.checkGenerateQuickFilterAggregateText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilterMatcher(e,t){let s;e?(this.checkGenerateQuickFilterAggregateText(t),s=t.quickFilterAggregateText):s=this.getQuickFilterAggregateText(t);const{quickFilterParts:i,matcher:r}=this;return r(i,s)}checkGenerateQuickFilterAggregateText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getQuickFilterAggregateText(e))}getQuickFilterTextForColumn(e,t){let s=this.valueService.getValue(e,t,!0);const i=e.getColDef();if(i.getQuickFilterText){const r=this.gos.addGridCommonParams({value:s,node:t,data:t.data,column:e,colDef:i});s=i.getQuickFilterText(r)}return ve(s)?s.toString().toUpperCase():null}getQuickFilterAggregateText(e){const t=[];return this.columnModel.getAllColumnsForQuickFilter().forEach(i=>{const r=this.getQuickFilterTextForColumn(i,e);ve(r)&&t.push(r)}),t.join(Ki.QUICK_FILTER_SEPARATOR)}};Ki.EVENT_QUICK_FILTER_CHANGED="quickFilterChanged";Ki.QUICK_FILTER_SEPARATOR=`
`;f([A("valueService")],Ki.prototype,"valueService",2);f([A("columnModel")],Ki.prototype,"columnModel",2);f([A("rowModel")],Ki.prototype,"rowModel",2);f([xe],Ki.prototype,"postConstruct",1);Ki=f([Le("quickFilterService")],Ki);var Or=class extends Se{constructor(){super(...arguments),this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue=[]}init(){var e,t,s;this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,()=>this.onColumnsChanged()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,w.EVENT_ROW_DATA_UPDATED,()=>this.onNewRowsLoaded("rowDataUpdated")),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",i=>this.setAdvancedFilterModel(i.currentValue)),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,({enabled:i})=>this.onAdvancedFilterEnabledChanged(i)),this.addManagedListener(this.eventService,w.EVENT_DATA_TYPES_INFERRED,()=>this.processFilterModelUpdateQueue()),this.addManagedListener(this.quickFilterService,Ki.EVENT_QUICK_FILTER_CHANGED,()=>this.onFilterChanged({source:"quickFilter"})),this.initialFilterModel=Xe({},(s=(t=(e=this.gos.get("initialState"))==null?void 0:e.filter)==null?void 0:t.filterModel)!=null?s:{})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"?e({}):!1}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"?t(e):!1}setFilterModel(e,t="api"){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}if(this.dataTypeService.isPendingInference()){this.filterModelUpdateQueue.push({model:e,source:t});return}const s=[],i=this.getFilterModel();if(e){const r=b0(Object.keys(e));this.allColumnFilters.forEach((n,o)=>{const a=e[o];s.push(this.setModelOnFilterWrapper(n.filterPromise,a)),r.delete(o)}),r.forEach(n=>{const o=this.columnModel.getPrimaryColumn(n)||this.columnModel.getGridColumn(n);if(!o){console.warn("AG Grid: setFilterModel() - no column found for colId: "+n);return}if(!o.isFilterAllowed()){console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+n);return}const a=this.getOrCreateFilterWrapper(o,"NO_UI");if(!a){console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+n);return}s.push(this.setModelOnFilterWrapper(a.filterPromise,e[n]))})}else this.allColumnFilters.forEach(r=>{s.push(this.setModelOnFilterWrapper(r.filterPromise,null))});Ps.all(s).then(()=>{const r=this.getFilterModel(),n=[];this.allColumnFilters.forEach((o,a)=>{const l=i?i[a]:null,u=r?r[a]:null;nt.jsonEquals(l,u)||n.push(o.column)}),n.length>0&&this.onFilterChanged({columns:n,source:t})})}setModelOnFilterWrapper(e,t){return new Ps(s=>{e.then(i=>{typeof i.setModel!="function"&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),s()),(i.setModel(t)||Ps.resolve()).then(()=>s())})})}getFilterModel(){const e={};return this.allColumnFilters.forEach((t,s)=>{const i=this.getModelFromFilterWrapper(t);ve(i)&&(e[s]=i)}),e}getModelFromFilterWrapper(e){var t;const i=e.filterPromise.resolveNow(null,r=>r);return i==null?(t=this.initialFilterModel[e.column.getColId()])!=null?t:null:typeof i.getModel!="function"?(console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel"),null):i.getModel()}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(e){var t;e?this.allColumnFilters.size&&(this.allColumnFilters.forEach(s=>this.disposeFilterWrapper(s,"advancedFilterEnabled")),this.onFilterChanged({source:"advancedFilter"})):(t=this.advancedFilterService)!=null&&t.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){var e;return!!((e=this.advancedFilterService)!=null&&e.isEnabled())}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;const e=i=>i?i.isFilterActive?i.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1):!1,t=!!this.gos.getGroupAggFiltering(),s=i=>{if(!i.isPrimary())return!0;const n=!this.columnModel.isPivotActive();return!i.isValueActive()||!n?!1:this.columnModel.isPivotMode()?!0:t};this.allColumnFilters.forEach(i=>{if(i.filterPromise.resolveNow(!1,e)){const r=i.filterPromise.resolveNow(null,n=>n);s(i.column)?this.activeAggregateFilters.push(r):this.activeColumnFilters.push(r)}})}updateFilterFlagInColumns(e,t){this.allColumnFilters.forEach(s=>{const i=s.filterPromise.resolveNow(!1,r=>r.isFilterActive());s.column.setFilterActive(i,e,t)})}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}doColumnFiltersPass(e,t,s){const{data:i,aggData:r}=e,n=s?this.activeAggregateFilters:this.activeColumnFilters,o=s?r:i;for(let a=0;a<n.length;a++){const l=n[a];if(!(l==null||l===t)){if(typeof l.doesFilterPass!="function")throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:e,data:o}))return!1}}return!0}resetQuickFilterCache(){this.quickFilterService.resetQuickFilterCache()}refreshFiltersForAggregations(){this.gos.getGroupAggFiltering()&&this.onFilterChanged()}callOnFilterChangedOutsideRenderCycle(e){const t=()=>this.onFilterChanged(e);this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}onFilterChanged(e={}){const{source:t,filterInstance:s,additionalEventAttributes:i,columns:r}=e;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",i),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(o=>{o.filterPromise&&o.filterPromise.then(a=>{a&&a!==s&&a.onAnyFilterChanged&&a.onAnyFilterChanged()})});const n={source:t,type:w.EVENT_FILTER_CHANGED,columns:r||[]};i&&zi(n,i),this.processingFilterChange=!0,this.eventService.dispatchEvent(n),this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){var e;return!((e=this.gos.get("allowShowChangeAfterFilter"))!=null?e:!1)&&this.processingFilterChange}isQuickFilterPresent(){return this.quickFilterService.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!this.gos.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode)||this.isColumnFilterPresent()&&!this.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)||this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(e.rowNode))}onNewRowsLoaded(e){this.allColumnFilters.forEach(t=>{t.filterPromise.then(s=>{s.onNewRowsLoaded&&s.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(e,{afterDataChange:!0}),this.updateActiveFilters()}createValueGetter(e){return({node:t})=>this.valueService.getValue(e,t,!0)}createGetValue(e){return(t,s)=>{const i=s?this.columnModel.getGridColumn(s):e;return i?this.valueService.getValue(i,t,!0):void 0}}getFilterComponent(e,t,s=!0){var i;if(s)return((i=this.getOrCreateFilterWrapper(e,t))==null?void 0:i.filterPromise)||null;const r=this.cachedFilter(e);return r?r.filterPromise:null}isFilterActive(e){const t=this.cachedFilter(e);return!!t&&t.filterPromise.resolveNow(!1,s=>s.isFilterActive())}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return null;let s=this.cachedFilter(e);return s||(s=this.createFilterWrapper(e,t),this.setColumnFilterWrapper(e,s)),s}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;if(Vt.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))t="agSetColumnFilter";else{const s=this.dataTypeService.getBaseDataType(e);s==="number"?t="agNumberColumnFilter":s==="date"||s==="dateString"?t="agDateColumnFilter":t="agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;if(Vt.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))t="agSetColumnFloatingFilter";else{const s=this.dataTypeService.getBaseDataType(e);s==="number"?t="agNumberColumnFloatingFilter":s==="date"||s==="dateString"?t="agDateColumnFloatingFilter":t="agTextColumnFloatingFilter"}return t}createFilterInstance(e){const t=this.getDefaultFilter(e),s=e.getColDef();let i;const r=rs(Xe({},this.createFilterParams(e,s)),{filterModifiedCallback:()=>this.filterModifiedCallbackFactory(i,e)(),filterChangedCallback:o=>this.filterChangedCallbackFactory(i,e)(o),doesRowPassOtherFilter:o=>this.doesRowPassOtherFilters(i,o)}),n=this.userComponentFactory.getFilterDetails(s,r,t);return n?{filterPromise:()=>{const o=n.newAgStackInstance();return o&&o.then(a=>i=a),o},compDetails:n}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return this.gos.addGridCommonParams({column:e,colDef:YS(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e,t){var s;const i={column:e,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:r,compDetails:n}=this.createFilterInstance(e);return i.filterPromise=(s=r==null?void 0:r())!=null?s:null,i.compDetails=n,i}onColumnsChanged(){const e=[];this.allColumnFilters.forEach((t,s)=>{let i;t.column.isPrimary()?i=this.columnModel.getPrimaryColumn(s):i=this.columnModel.getGridColumn(s),!(i&&i===t.column)&&(e.push(t.column),this.disposeFilterWrapper(t,"columnChanged"),this.disposeColumnListener(s))}),e.length>0?this.onFilterChanged({columns:e,source:"api"}):this.updateDependantFilters()}updateDependantFilters(){const e=this.columnModel.getGroupAutoColumns();e==null||e.forEach(t=>{t.getColDef().filter==="agGroupColumnFilter"&&this.getOrCreateFilterWrapper(t,"NO_UI")})}isFilterAllowed(e){var t,s;if(this.isAdvancedFilterEnabled()||!e.isFilterAllowed())return!1;const r=this.allColumnFilters.get(e.getColId());return(s=(t=r==null?void 0:r.filterPromise)==null?void 0:t.resolveNow(!0,n=>typeof(n==null?void 0:n.isFilterAllowed)=="function"?n==null?void 0:n.isFilterAllowed():!0))!=null?s:!0}getFloatingFilterCompDetails(e,t){const s=l=>{const u=this.getFilterComponent(e,"NO_UI");u!=null&&u.then(h=>{l(sl(h))})},i=e.getColDef(),r=rs(Xe({},this.createFilterParams(e,i)),{filterChangedCallback:()=>s(l=>this.filterChangedCallbackFactory(l,e)())}),n=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(i,iw,r);let o=this.userComponentFactory.getDefaultFloatingFilterType(i,()=>this.getDefaultFloatingFilter(e));o==null&&(o="agReadOnlyFloatingFilter");const a={column:e,filterParams:n,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:s,showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(i,a,o)}getCurrentFloatingFilterParentModel(e){const t=this.getFilterComponent(e,"NO_UI",!1);return t?t.resolveNow(null,s=>s&&s.getModel()):null}destroyFilter(e,t="api"){const s=e.getColId(),i=this.allColumnFilters.get(s);this.disposeColumnListener(s),delete this.initialFilterModel[s],i&&(this.disposeFilterWrapper(i,t),this.onFilterChanged({columns:[e],source:"api"}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){e.filterPromise.then(s=>{this.getContext().destroyBean(s),e.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId());const i={type:w.EVENT_FILTER_DESTROYED,source:t,column:e.column};this.eventService.dispatchEvent(i)})}filterModifiedCallbackFactory(e,t){return()=>{const s={type:w.EVENT_FILTER_MODIFIED,column:t,filterInstance:e};this.eventService.dispatchEvent(s)}}filterChangedCallbackFactory(e,t){return s=>{var i;const r=(i=s==null?void 0:s.source)!=null?i:"api",n={filter:e,additionalEventAttributes:s,columns:[t],source:r};this.callOnFilterChangedOutsideRenderCycle(n)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const s=t.column,{compDetails:i}=s.isFilterAllowed()?this.createFilterInstance(s):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,i)){this.destroyFilter(s,"paramsUpdated");return}const r=s.getColDef().filterParams;if(!t.filterPromise){this.destroyFilter(s,"paramsUpdated");return}t.filterPromise.then(n=>{(n!=null&&n.refresh?n.refresh(Xe(rs(Xe({},this.createFilterParams(s,s.getColDef())),{filterModifiedCallback:this.filterModifiedCallbackFactory(n,s),filterChangedCallback:this.filterChangedCallbackFactory(n,s),doesRowPassOtherFilter:a=>this.doesRowPassOtherFilters(n,a)}),r)):!0)===!1&&this.destroyFilter(s,"paramsUpdated")})}setColumnFilterWrapper(e,t){const s=e.getColId();this.allColumnFilters.set(s,t),this.allColumnListeners.set(s,this.addManagedListener(e,Kt.EVENT_COL_DEF_CHANGED,()=>this.checkDestroyFilter(s)))}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:s}=e,{componentClass:i}=t;return!(s===i||(s==null?void 0:s.render)&&(i==null?void 0:i.render)&&s.render===i.render)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(e){if(this.isAdvancedFilterEnabled()){if(this.dataTypeService.isPendingInference()){this.advancedFilterModelUpdateQueue.push(e);return}this.advancedFilterService.setModel(e??null),this.onFilterChanged({source:"advancedFilter"})}}showAdvancedFilterBuilder(e){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder(e,!0)}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvancedFilterEnabled()?!1:this.columnModel.getAllGridColumns().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e,t){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}const s=this.getFilterInstanceImpl(e,r=>{if(!t)return;const n=sl(r);t(n)});return sl(s)}getColumnFilterInstance(e){return new Promise(t=>{this.getFilterInstance(e,s=>{t(s)})})}getFilterInstanceImpl(e,t){const s=this.columnModel.getPrimaryColumn(e);if(!s)return;const i=this.getFilterComponent(s,"NO_UI"),r=i&&i.resolveNow(null,n=>n);return r?setTimeout(t,0,r):i&&i.then(n=>{t(n)}),r}warnAdvancedFilters(){tt("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(e){var t;(t=this.advancedFilterService)==null||t.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model:e,source:t})=>this.setFilterModel(e,t)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key:e,model:t,resolve:s})=>{this.setColumnFilterModel(e,t).then(()=>s())}),this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue.forEach(e=>this.setAdvancedFilterModel(e)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){if(this.isAdvancedFilterEnabled())return this.warnAdvancedFilters(),Promise.resolve();if(this.dataTypeService.isPendingInference()){let n=()=>{};const o=new Promise(a=>{n=a});return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:n}),o}const s=this.columnModel.getPrimaryColumn(e),i=s?this.getOrCreateFilterWrapper(s,"NO_UI"):null;return i?(n=>new Promise(o=>{n.then(a=>o(a))}))(this.setModelOnFilterWrapper(i.filterPromise,t)):Promise.resolve()}getFilterWrapper(e){var t;const s=this.columnModel.getPrimaryColumn(e);return s&&(t=this.cachedFilter(s))!=null?t:null}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}};f([A("valueService")],Or.prototype,"valueService",2);f([A("columnModel")],Or.prototype,"columnModel",2);f([A("rowModel")],Or.prototype,"rowModel",2);f([A("userComponentFactory")],Or.prototype,"userComponentFactory",2);f([A("rowRenderer")],Or.prototype,"rowRenderer",2);f([A("dataTypeService")],Or.prototype,"dataTypeService",2);f([A("quickFilterService")],Or.prototype,"quickFilterService",2);f([zt("advancedFilterService")],Or.prototype,"advancedFilterService",2);f([xe],Or.prototype,"init",1);Or=f([Le("filterManager")],Or);var Xm=class extends at{constructor(e,t){super('<div class="ag-filter"></div>'),this.column=e,this.source=t,this.filterWrapper=null}postConstruct(){this.createFilter(!0),this.addManagedListener(this.eventService,w.EVENT_FILTER_DESTROYED,this.onFilterDestroyed.bind(this))}hasFilter(){return!!this.filterWrapper}getFilter(){var e,t;return(t=(e=this.filterWrapper)==null?void 0:e.filterPromise)!=null?t:null}afterInit(){var e,t,s;return(s=(t=(e=this.filterWrapper)==null?void 0:e.filterPromise)==null?void 0:t.then(()=>{}))!=null?s:Ps.resolve()}afterGuiAttached(e){var t,s;(s=(t=this.filterWrapper)==null?void 0:t.filterPromise)==null||s.then(i=>{var r;(r=i==null?void 0:i.afterGuiAttached)==null||r.call(i,e)})}afterGuiDetached(){var e,t;(t=(e=this.filterWrapper)==null?void 0:e.filterPromise)==null||t.then(s=>{var i;(i=s==null?void 0:s.afterGuiDetached)==null||i.call(s)})}createFilter(e){var t;const{column:s,source:i}=this;this.filterWrapper=this.filterManager.getOrCreateFilterWrapper(s,i),(t=this.filterWrapper)!=null&&t.filterPromise&&this.filterWrapper.filterPromise.then(r=>{let n=r.getGui();if(ve(n)||console.warn(`AG Grid: getGui method from filter returned ${n}, it should be a DOM element or an HTML template string.`),typeof n=="string"&&(n=$i(n)),this.appendChild(n),e){const o={type:w.EVENT_FILTER_OPENED,column:s,source:i,eGui:this.getGui()};this.eventService.dispatchEvent(o)}})}onFilterDestroyed(e){(e.source==="api"||e.source==="paramsUpdated")&&e.column.getId()===this.column.getId()&&this.columnModel.getPrimaryColumn(this.column)&&(xs(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}};f([A("filterManager")],Xm.prototype,"filterManager",2);f([A("columnModel")],Xm.prototype,"columnModel",2);f([xe],Xm.prototype,"postConstruct",1);var M0=class extends at{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},Kl=class dN extends M0{constructor(t){super(dN.TEMPLATE,t)}postConstruct(){const t=this.getGui(),s={addOrRemoveCssClass:(i,r)=>this.addOrRemoveCssClass(i,r),addOrRemoveBodyCssClass:(i,r)=>this.eFloatingFilterBody.classList.toggle(i,r),setButtonWrapperDisplayed:i=>Dt(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>t.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(s,t,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(t){if(!t){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=t.newAgStackInstance(),this.compPromise.then(s=>this.afterCompCreated(s))}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(t){if(t){if(!this.isAlive()){this.destroyBean(t);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=t,this.eFloatingFilterBody.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached()}}};Kl.TEMPLATE=`<div class="ag-header-cell ag-floating-filter" role="gridcell">
            <div ref="eFloatingFilterBody" role="presentation"></div>
            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">
                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>
            </div>
        </div>`;f([Fe("eFloatingFilterBody")],Kl.prototype,"eFloatingFilterBody",2);f([Fe("eButtonWrapper")],Kl.prototype,"eButtonWrapper",2);f([Fe("eButtonShowMainFilter")],Kl.prototype,"eButtonShowMainFilter",2);f([xe],Kl.prototype,"postConstruct",1);f([Fi],Kl.prototype,"destroyFloatingFilterComp",1);var YO=Kl,ev=class extends Se{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},s=t.autoHeight?"ag-layout-auto-height":t.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(s,t)}getDomLayout(){var e;const t=(e=this.gos.get("domLayout"))!=null?e:"normal";return["normal","print","autoHeight"].indexOf(t)===-1?(tt(`${t} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):t}};f([xe],ev.prototype,"postConstruct",1);var xo=class extends Se{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=xi(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=xi(()=>this.lastScrollSource[0]=null,500)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const{fakeHScrollComp:e,fakeVScrollComp:t}=this.ctrlsService.getParams();this.addManagedListener(this.centerRowsCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),e.onScrollCallback(this.onFakeHScroll.bind(this));const s=this.gos.get("debounceVerticalScrollbar"),i=s?xi(this.onVScroll.bind(this),100):this.onVScroll.bind(this),r=s?xi(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",i),t.onScrollCallback(r)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){if(this.centerRowsCtrl==null)return;e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft());const s=this.enableRtl?e:-e,{topCenter:i,stickyTopCenter:r,stickyBottomCenter:n,centerHeader:o,bottomCenter:a,fakeHScrollComp:l}=this.ctrlsService.getParams();o.setHorizontalScroll(-s),a.setContainerTranslateX(s),i.setContainerTranslateX(s),r.setContainerTranslateX(s),n.setContainerTranslateX(s);const u=this.centerRowsCtrl.getViewportElement(),h=this.lastScrollSource[1]===0;e=Math.abs(e),h?l.setScrollPosition(e):mh(u,e,this.enableRtl)}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(this.lastScrollSource[t]=e,!0):this.lastScrollSource[t]===e}onFakeHScroll(){this.isControllingScroll(1,1)&&this.onHScrollCommon(1)}onHScroll(){this.isControllingScroll(0,1)&&this.onHScrollCommon(0)}onHScrollCommon(e){const t=this.centerRowsCtrl.getViewportElement(),{scrollLeft:s}=t;if(this.shouldBlockScrollUpdate(1,s,!0))return;let i;e===0?i=fh(t,this.enableRtl):i=this.ctrlsService.get("fakeHScrollComp").getScrollPosition(),this.doHorizontalScroll(Math.round(i)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(1,0)&&this.onVScrollCommon(1)}onVScroll(){this.isControllingScroll(0,0)&&this.onVScrollCommon(0)}onVScrollCommon(e){let t;e===0?t=this.eBodyViewport.scrollTop:t=this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),!this.shouldBlockScrollUpdate(0,t,!0)&&(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,e===0?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:w.EVENT_BODY_SCROLL,direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const s=rs(Xe({},t),{type:w.EVENT_BODY_SCROLL_END});this.eventService.dispatchEvent(s)},100)}shouldBlockScrollUpdate(e,t,s=!1){return s&&!yo()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=pp(this.eBodyViewport),{scrollHeight:s}=this.eBodyViewport;return e<0||e+t>s}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:s}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&gh()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>s}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(0)}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl&&gh()?e=e>0?0:i:e=Math.min(Math.max(e,0),i)),mh(this.centerRowsCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){return this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight,{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const s=this.rowModel.getRowCount();let i=-1;for(let r=0;r<s;r++){const n=this.rowModel.getRow(r);if(typeof e=="function"){if(n&&e(n)){i=r;break}}else if(e===n||e===n.data){i=r;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t){if(this.gos.isDomLayout("print"))return;const s=this.paginationProxy.getRowCount();if(typeof e!="number"||e<0||e>=s){console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+e);return}const r=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{r||this.paginationProxy.goToPageWithIndex(e);const n=this.ctrlsService.getGridBodyCtrl(),o=n.getStickyTopHeight(),a=n.getStickyBottomHeight(),l=this.paginationProxy.getRow(e);let u;do{const h=l.rowTop,p=l.rowHeight,g=this.paginationProxy.getPixelOffset(),m=l.rowTop-g,C=m+l.rowHeight,y=this.getVScrollPosition(),R=this.heightScaler.getDivStretchOffset(),x=y.top+R,S=y.bottom+R,T=S-x,I=this.heightScaler.getScrollPositionForPixel(m),V=this.heightScaler.getScrollPositionForPixel(C-T),j=Math.min((I+V)/2,m),P=x+o>m,N=S-a<C;let _=null;t==="top"?_=I:t==="bottom"?_=V:t==="middle"?_=j:P?_=I-o:N&&(_=V+a),_!==null&&(this.setVerticalScrollPosition(_),this.rowRenderer.redraw({afterScroll:!0})),u=h!==l.rowTop||p!==l.rowHeight}while(u);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(e,t="auto"){const s=this.columnModel.getGridColumn(e);if(!s||s.isPinned()||!this.columnModel.isColumnDisplayed(s))return;const i=this.getPositionedHorizontalScroll(s,t);this.getFrameworkOverrides().wrapIncoming(()=>{i!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(i),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(e,t){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(t),this.setVerticalScrollPosition(e),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:s,columnAfterEnd:i}=this.isColumnOutsideViewport(e),r=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),n=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?s:i)||r,l=o?i:s;t!=="auto"&&(a=t==="start",l=t==="end");const u=t==="middle";if(a||l||u){const{colLeft:h,colMiddle:p,colRight:g}=this.getColumnBounds(e);return u?p-n/2:a?o?g:h:o?h-n:g-n}return null}isColumnOutsideViewport(e){const{start:t,end:s}=this.getViewportBounds(),{colLeft:i,colRight:r}=this.getColumnBounds(e),n=this.enableRtl,o=n?t>r:s<r,a=n?s<i:t>i;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,s=this.columnModel.getBodyContainerWidth(),i=e.getActualWidth(),r=e.getLeft(),n=t?-1:1,o=t?s-r:r,a=o+i*n,l=o+i/2*n;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),s=t,i=e+t;return{start:s,end:i,width:e}}};f([A("ctrlsService")],xo.prototype,"ctrlsService",2);f([A("animationFrameService")],xo.prototype,"animationFrameService",2);f([A("paginationProxy")],xo.prototype,"paginationProxy",2);f([A("rowModel")],xo.prototype,"rowModel",2);f([A("rowContainerHeightService")],xo.prototype,"heightScaler",2);f([A("rowRenderer")],xo.prototype,"rowRenderer",2);f([A("columnModel")],xo.prototype,"columnModel",2);f([xe],xo.prototype,"postConstruct",1);var hN="ag-force-vertical-scroll",qO="ag-selectable",QO="ag-column-moving",gi=class extends Se{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,s,i,r,n,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=s,this.eTop=i,this.eBottom=r,this.eStickyTop=n,this.eStickyBottom=o,this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new ev(this.comp)),this.bodyScrollFeature=this.createManagedBean(new xo(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([i,s,r,n,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.filterManager.setupAdvancedFilterHeaderComp(i),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addFocusListeners(e){e.forEach(t=>{this.addManagedListener(t,"focusin",s=>{const{target:i}=s,r=gl(i,"ag-root",t);t.classList.toggle("ag-has-focus",!r)}),this.addManagedListener(t,"focusout",s=>{const{target:i,relatedTarget:r}=s,n=t.contains(r),o=gl(r,"ag-root",t);gl(i,"ag-root",t)||(!n||o)&&t.classList.remove("ag-has-focus")})})}setColumnMovingCss(e){this.comp.setColumnMovingCss(QO,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(qO,e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();const t=e&&this.gos.getScrollbarWidth()||0,s=u0()?16:0,i=`calc(100% + ${t+s}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(i))}onGridColumnsChanged(){const e=this.columnModel.getAllGridColumns();this.comp.setColumnCount(e.length)}disableBrowserDragging(){this.addManagedListener(this.eGridBody,"dragstart",e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const e=s=>{const i=s.relatedTarget;if(Tf(i)===null){this.rowRenderer.stopEditing();return}let r=t.some(n=>n.contains(i))&&this.mouseEventService.isElementInThisGrid(i);if(!r){const n=this.popupService;r=n.getActivePopups().some(o=>o.contains(i))||n.isElementWithinCustomPopup(i)}r||this.rowRenderer.stopEditing()},t=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];t.forEach(s=>this.addManagedListener(s,"focusout",e))}updateRowCount(){const e=this.headerNavigationService.getHeaderRowCount()+this.filterManager.getHeaderRowCount(),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,s=t===-1?-1:e+t;this.comp.setRowCount(s)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?hN:null,s=this.gos.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||s&&lF(this.eBodyViewport)}setupRowAnimationCssClass(){const e=()=>{const t=this.gos.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),s=t?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(s,t)};e(),this.addManagedListener(this.eventService,w.EVENT_HEIGHT_SCALE_CHANGED,e),this.addManagedPropertyListener("animateRows",e)}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",e),this.mockContextMenuForIPad(e),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyWheel.bind(this)),this.addManagedListener(this.eStickyBottom,"wheel",this.onStickyWheel.bind(this)),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const e=this.eBodyViewport.querySelector(".ag-full-width-container"),t=this.eBodyViewport.querySelector(".ag-center-cols-viewport");e&&t&&this.addManagedListener(e,"wheel",s=>this.onFullWidthContainerWheel(s,t))}onFullWidthContainerWheel(e,t){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),t.scrollBy({left:e.deltaX}))}onBodyViewportContextMenu(e,t,s){if(!e&&!s)return;this.gos.get("preventDefaultOnContextMenu")&&(e||s).preventDefault();const{target:i}=e||t;(i===this.eBodyViewport||i===this.ctrlsService.get("center").getViewportElement())&&this.menuService.showContextMenu({mouseEvent:e,touchEvent:s,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(e){if(!yo())return;const t=new Ws(this.eBodyViewport),s=i=>{e(void 0,i.touchStart,i.touchEvent)};this.addManagedListener(t,Ws.EVENT_LONG_TAP,s),this.addDestroyFunc(()=>t.destroy())}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}onStickyWheel(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new yr(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}onPinnedRowDataChanged(){this.setFloatingHeights()}setFloatingHeights(){const{pinnedRowModel:e}=this;let t=e.getPinnedTopTotalHeight(),s=e.getPinnedBottomTotalHeight();this.comp.setTopHeight(t),this.comp.setBottomHeight(s),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(s?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.gos.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const t=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+this.filterManager.getHeaderHeight(),s=this.pinnedRowModel.getPinnedTopTotalHeight();let i=0;t>0&&(i+=t),s>0&&(i+=s),i>0&&(i+=1),this.comp.setStickyTopTop(`${i}px`)}setStickyBottomOffsetBottom(){const e=this.pinnedRowModel.getPinnedBottomTotalHeight(),s=this.scrollVisibleService.isHorizontalScrollShowing()&&this.gos.getScrollbarWidth()||0,i=e+s;this.comp.setStickyBottomBottom(`${i}px`)}sizeColumnsToFit(e,t){const i=this.isVerticalScrollShowing()?this.gos.getScrollbarWidth():0,n=Hl(this.eGridBody)-i;if(n>0){this.columnModel.sizeColumnsToFit(n,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFit(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFit(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFit(e,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}};f([A("animationFrameService")],gi.prototype,"animationFrameService",2);f([A("rowContainerHeightService")],gi.prototype,"rowContainerHeightService",2);f([A("ctrlsService")],gi.prototype,"ctrlsService",2);f([A("columnModel")],gi.prototype,"columnModel",2);f([A("scrollVisibleService")],gi.prototype,"scrollVisibleService",2);f([A("menuService")],gi.prototype,"menuService",2);f([A("headerNavigationService")],gi.prototype,"headerNavigationService",2);f([A("dragAndDropService")],gi.prototype,"dragAndDropService",2);f([A("pinnedRowModel")],gi.prototype,"pinnedRowModel",2);f([A("rowRenderer")],gi.prototype,"rowRenderer",2);f([A("popupService")],gi.prototype,"popupService",2);f([A("mouseEventService")],gi.prototype,"mouseEventService",2);f([A("rowModel")],gi.prototype,"rowModel",2);f([A("filterManager")],gi.prototype,"filterManager",2);var nd="ag-cell-range-selected",ZO="ag-cell-range-chart",JO="ag-cell-range-single-cell",XO="ag-cell-range-chart-category",eG="ag-cell-range-handle",tG="ag-cell-range-top",sG="ag-cell-range-right",iG="ag-cell-range-bottom",rG="ag-cell-range-left",nG=class{constructor(e,t){this.beans=e,this.rangeService=e.rangeService,this.selectionHandleFactory=e.selectionHandleFactory,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(nd,this.rangeCount!==0),this.cellComp.addOrRemoveCssClass(`${nd}-1`,this.rangeCount===1),this.cellComp.addOrRemoveCssClass(`${nd}-2`,this.rangeCount===2),this.cellComp.addOrRemoveCssClass(`${nd}-3`,this.rangeCount===3),this.cellComp.addOrRemoveCssClass(`${nd}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass(ZO,this.hasChartRange),eu(this.eGui,this.rangeCount>0?!0:void 0),this.cellComp.addOrRemoveCssClass(JO,this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),s=!t&&e.top,i=!t&&e.right,r=!t&&e.bottom,n=!t&&e.left;this.cellComp.addOrRemoveCssClass(tG,s),this.cellComp.addOrRemoveCssClass(sG,i),this.cellComp.addOrRemoveCssClass(iG,r),this.cellComp.addOrRemoveCssClass(rG,n)}isSingleCell(){const{rangeService:e}=this.beans;return this.rangeCount===1&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(s=>pr([1,0],s.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,s=!1,i=!1,r=!1;const n=this.cellCtrl.getCellPosition().column,o=this.beans.columnModel;let a,l;e?(a=o.getDisplayedColAfter(n),l=o.getDisplayedColBefore(n)):(a=o.getDisplayedColBefore(n),l=o.getDisplayedColAfter(n));const u=this.rangeService.getCellRanges().filter(h=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),h));a||(r=!0),l||(s=!0);for(let h=0;h<u.length&&!(t&&s&&i&&r);h++){const p=u[h],g=this.rangeService.getRangeStartRow(p),m=this.rangeService.getRangeEndRow(p);!t&&this.beans.rowPositionUtils.sameRow(g,this.cellCtrl.getCellPosition())&&(t=!0),!i&&this.beans.rowPositionUtils.sameRow(m,this.cellCtrl.getCellPosition())&&(i=!0),!r&&a&&p.columns.indexOf(a)<0&&(r=!0),!s&&l&&p.columns.indexOf(l)<0&&(s=!0)}return{top:t,right:s,bottom:i,left:r}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass(eG,!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeService.getCellRanges(),s=t.length;if(this.rangeCount<1||s<1)return!1;const i=Mt(t),r=this.cellCtrl.getCellPosition(),n=e.get("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),o=e.get("enableRangeHandle");let a=s===1&&!this.cellCtrl.isEditing()&&(n||o);if(this.hasChartRange){const u=t[0].type===1&&this.rangeService.isCellInSpecificRange(r,t[0]);this.cellComp.addOrRemoveCssClass(XO,u),a=i.type===0}return a&&i.endRow!=null&&this.rangeService.isContiguousRange(i)&&this.rangeService.isBottomRightCell(i,r)}addSelectionHandle(){const e=this.beans.gos,t=Mt(this.rangeService.getCellRanges()).type,i=e.get("enableFillHandle")&&ot(t)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==i&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(i)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},oG=class extends Se{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListener(this.beans.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}setComp(e){this.eGui=e,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Fn(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const e=this.column.getColSpan(this.rowNode),t=[];if(e===1)t.push(this.column);else{let s=this.column;const i=this.column.getPinned();for(let r=0;s&&r<e&&(t.push(s),s=this.beans.columnModel.getDisplayedColAfter(s),!(!s||ot(s)||i!==s.getPinned()));r++);}return t}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=Mt(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||this.column.getPinned()==="left")return e;const t=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(this.column.getPinned()==="right"){const s=this.beans.columnModel.getBodyContainerWidth();return t+s+(e||0)}return t+(e||0)}applyRowSpan(e){if(this.rowSpan===1&&!e)return;const s=this.beans.gos.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=`${s}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},aG=class extends Se{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),{cellClassRules:t}=e,s=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(t===this.cellClassRules?void 0:this.cellClassRules,t,s,i=>this.cellComp.addOrRemoveCssClass(i,!0),i=>this.cellComp.addOrRemoveCssClass(i,!1)),this.cellClassRules=t}applyUserStyles(){const e=this.column.getColDef();if(!e.cellStyle)return;let t;if(typeof e.cellStyle=="function"){const s=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex}),i=e.cellStyle;t=i(s)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}applyClassesFromColDef(){const e=this.column.getColDef(),t=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(s=>this.cellComp.addOrRemoveCssClass(s,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach(s=>this.cellComp.addOrRemoveCssClass(s,!0))}destroy(){super.destroy()}},Ct=class{postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gos.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}};f([A("resizeObserverService")],Ct.prototype,"resizeObserverService",2);f([A("paginationProxy")],Ct.prototype,"paginationProxy",2);f([A("context")],Ct.prototype,"context",2);f([A("gridOptionsService")],Ct.prototype,"gos",2);f([A("environment")],Ct.prototype,"environment",2);f([A("rowRenderer")],Ct.prototype,"rowRenderer",2);f([A("valueService")],Ct.prototype,"valueService",2);f([A("eventService")],Ct.prototype,"eventService",2);f([A("columnModel")],Ct.prototype,"columnModel",2);f([A("headerNavigationService")],Ct.prototype,"headerNavigationService",2);f([A("navigationService")],Ct.prototype,"navigationService",2);f([A("columnAnimationService")],Ct.prototype,"columnAnimationService",2);f([A("focusService")],Ct.prototype,"focusService",2);f([A("popupService")],Ct.prototype,"popupService",2);f([A("stylingService")],Ct.prototype,"stylingService",2);f([A("columnHoverService")],Ct.prototype,"columnHoverService",2);f([A("userComponentFactory")],Ct.prototype,"userComponentFactory",2);f([A("userComponentRegistry")],Ct.prototype,"userComponentRegistry",2);f([A("animationFrameService")],Ct.prototype,"animationFrameService",2);f([A("dragService")],Ct.prototype,"dragService",2);f([A("dragAndDropService")],Ct.prototype,"dragAndDropService",2);f([A("sortController")],Ct.prototype,"sortController",2);f([A("filterManager")],Ct.prototype,"filterManager",2);f([A("rowContainerHeightService")],Ct.prototype,"rowContainerHeightService",2);f([A("frameworkOverrides")],Ct.prototype,"frameworkOverrides",2);f([A("cellPositionUtils")],Ct.prototype,"cellPositionUtils",2);f([A("rowPositionUtils")],Ct.prototype,"rowPositionUtils",2);f([A("selectionService")],Ct.prototype,"selectionService",2);f([A("rowCssClassCalculator")],Ct.prototype,"rowCssClassCalculator",2);f([A("rowModel")],Ct.prototype,"rowModel",2);f([A("ctrlsService")],Ct.prototype,"ctrlsService",2);f([A("ctrlsFactory")],Ct.prototype,"ctrlsFactory",2);f([A("agStackComponentsRegistry")],Ct.prototype,"agStackComponentsRegistry",2);f([A("valueCache")],Ct.prototype,"valueCache",2);f([A("rowNodeEventThrottle")],Ct.prototype,"rowNodeEventThrottle",2);f([A("localeService")],Ct.prototype,"localeService",2);f([A("syncService")],Ct.prototype,"syncService",2);f([A("ariaAnnouncementService")],Ct.prototype,"ariaAnnouncementService",2);f([zt("rangeService")],Ct.prototype,"rangeService",2);f([zt("selectionHandleFactory")],Ct.prototype,"selectionHandleFactory",2);f([xe],Ct.prototype,"postConstruct",1);Ct=f([Le("beans")],Ct);var lG=class extends Ct{constructor(e,t,s){super(),this.cellCtrl=e,this.beans=t,this.column=s}onMouseEvent(e,t){if(!un(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.isDoubleClickOnIPad()){this.onCellDoubleClicked(e),e.preventDefault();return}const{eventService:t,rangeService:s,gos:i}=this.beans,r=e.ctrlKey||e.metaKey;s&&r&&s.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&s.intersectLastRange(!0);const n=this.cellCtrl.createEvent(e,w.EVENT_CELL_CLICKED);t.dispatchEvent(n);const o=this.column.getColDef();o.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{o.onCellClicked(n)})},0),(i.get("singleClickEdit")||o.singleClickEdit)&&!i.get("suppressClickEdit")&&!(e.shiftKey&&(s==null?void 0:s.getCellRanges().length)!=0)&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!yo()||JS("dblclick"))return!1;const e=new Date().getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const t=this.column.getColDef(),s=this.cellCtrl.createEvent(e,w.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(s),typeof t.onCellDoubleClicked=="function"&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{t.onCellDoubleClicked(s)})},0),!this.beans.gos.get("singleClickEdit")&&!this.beans.gos.get("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:s,shiftKey:i}=e,r=e.target,{cellCtrl:n,beans:o}=this,{eventService:a,rangeService:l,focusService:u}=o;if(this.isRightClickInExistingRange(e))return;const h=l&&l.getCellRanges().length!=0;if(!i||!h){const p=Gn()&&!n.isEditing()&&!p0(r);n.focusCell(p)}if(i&&h&&!u.isCellFocused(n.getCellPosition())){e.preventDefault();const p=u.getFocusedCell();if(p){const{column:g,rowIndex:m,rowPinned:C}=p,y=o.rowRenderer.getRowByPosition({rowIndex:m,rowPinned:C}),R=y==null?void 0:y.getCellCtrl(g);R!=null&&R.isEditing()&&R.stopEditing(),u.setFocusedCell({column:g,rowIndex:m,rowPinned:C,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(r)){if(l){const p=this.cellCtrl.getCellPosition();if(i)l.extendLatestRangeToCell(p);else{const g=t||s;l.setRangeToCell(p,g)}}a.dispatchEvent(this.cellCtrl.createEvent(e,w.EVENT_CELL_MOUSE_DOWN))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){const s=t.isCellInAnyRange(this.cellCtrl.getCellPosition()),i=e.button===2||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(s&&i)return!0}return!1}containsWidget(e){return gl(e,"ag-selection-checkbox",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,w.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,w.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),s=t.contains(e.target),i=t.contains(e.relatedTarget);return s&&i}destroy(){}},cG=class extends Se{constructor(e,t,s,i,r){super(),this.cellCtrl=e,this.beans=t,this.rowNode=i,this.rowCtrl=r}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case U.ENTER:this.onEnterKeyDown(e);break;case U.F2:this.onF2KeyDown(e);break;case U.ESCAPE:this.onEscapeKeyDown(e);break;case U.TAB:this.onTabKeyDown(e);break;case U.BACKSPACE:case U.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case U.DOWN:case U.UP:case U.RIGHT:case U.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){var s;const{cellCtrl:i,beans:r,rowNode:n}=this,{gos:o,rangeService:a,eventService:l}=r;if(!i.isEditing()){if(l.dispatchEvent({type:w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),CF(e,o.get("enableCellEditingOnBackspace"))){if(a&&o.get("enableRangeSelection"))a.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){const u=i.getColumn(),h=(s=this.beans.valueService.parseValue(u,n,"",n.getValueFromValueService(u)))!=null?s:null;n.setDataValue(u,h,"cellClear")}}else i.startRowOrCellEdit(e,t);l.dispatchEvent({type:w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END})}}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const t=e.shiftKey?U.UP:U.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(U.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(U.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const i=e.key;i===" "?this.onSpaceKeyDown(e):(this.cellCtrl.startRowOrCellEdit(i,e),e.preventDefault())}onSpaceKeyDown(e){const{gos:t}=this.beans;if(!this.cellCtrl.isEditing()&&t.isRowSelection()){const s=this.rowNode.isSelected(),i=!s;if(i||!t.get("suppressRowDeselection")){const r=this.beans.gos.get("groupSelectsFiltered"),n=this.rowNode.setSelectedParams({newValue:i,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spaceKey"});s===void 0&&n===0&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spaceKey"})}}e.preventDefault()}destroy(){super.destroy()}},pN=class extends at{constructor(e,t,s){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=s}postConstruct(){this.getGui().appendChild(cs("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const t=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);const s=()=>{try{const i=JSON.stringify(this.rowNode.data);e.dataTransfer.setData("application/json",i),e.dataTransfer.setData("text/plain",i)}catch{}};if(t){const i=this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:e});t(i)}else s()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};f([xe],pN.prototype,"postConstruct",1);var uG="ag-column-first",dG="ag-column-last",tv=class{static getHeaderClassesFromColDef(e,t,s,i){return ot(e)?[]:this.getColumnClassesFromCollDef(e.headerClass,e,t,s,i)}static getToolPanelClassesFromColDef(e,t,s,i){return ot(e)?[]:this.getColumnClassesFromCollDef(e.toolPanelClass,e,t,s,i)}static refreshFirstAndLastStyles(e,t,s){e.addOrRemoveCssClass(uG,s.isColumnAtEdge(t,"first")),e.addOrRemoveCssClass(dG,s.isColumnAtEdge(t,"last"))}static getClassParams(e,t,s,i){return t.addGridCommonParams({colDef:e,column:s,columnGroup:i})}static getColumnClassesFromCollDef(e,t,s,i,r){if(ot(e))return[];let n;if(typeof e=="function"){const o=this.getClassParams(t,s,i,r);n=e(o)}else n=e;return typeof n=="string"?[n]:Array.isArray(n)?[...n]:[]}},hG="ag-cell",pG="ag-cell-auto-height",gG="ag-cell-normal-height",fG="ag-cell-focus",mG="ag-cell-first-right-pinned",vG="ag-cell-last-left-pinned",CG="ag-cell-not-inline-editing",yG="ag-column-hover",wG="ag-cell-wrap-text",SG=0,gN=class rw extends Se{constructor(t,s,i,r){super(),this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.column=t,this.rowNode=s,this.beans=i,this.rowCtrl=r,this.instanceId=t.getId()+"-"+SG++,this.colIdSanitised=Ds(this.column.getId()),i.gos.get("suppressCellFocus")||(this.tabIndex=-1),this.createCellPosition(),this.addFeatures(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new oG(this,this.beans),this.addDestroyFunc(()=>{var s;(s=this.cellPositionFeature)==null||s.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new aG(this,this.beans),this.addDestroyFunc(()=>{var s;(s=this.cellCustomStyleFeature)==null||s.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new lG(this,this.beans,this.column),this.addDestroyFunc(()=>{var s;(s=this.cellMouseListenerFeature)==null||s.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new cG(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var s;(s=this.cellKeyboardListenerFeature)==null||s.destroy(),this.cellKeyboardListenerFeature=null}),this.column.isTooltipEnabled()&&(this.enableTooltipFeature(),this.addDestroyFunc(()=>{this.disableTooltipFeature()})),this.beans.rangeService&&this.beans.gos.get("enableRangeSelection")&&(this.cellRangeFeature=new nG(this.beans,this),this.addDestroyFunc(()=>{var s;(s=this.cellRangeFeature)==null||s.destroy(),this.cellRangeFeature=null}))}enableTooltipFeature(t,s){const i=()=>{const o=this.column.getColDef(),a=this.rowNode.data;if(o.tooltipField&&ve(a))return Nc(a,o.tooltipField,this.column.isTooltipFieldContainsDots());const l=o.tooltipValueGetter;return l?l(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},r=this.beans.gos.get("tooltipShowMode")==="whenTruncated";!s&&r&&!this.isCellRenderer()&&(s=()=>{const o=this.getGui(),a=o.children.length===0?o:o.querySelector(".ag-cell-value");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:t!=null?()=>t:i,getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:s};this.tooltipFeature=new wo(n,this.beans)}disableTooltipFeature(){this.tooltipFeature&&(this.tooltipFeature.destroy(),this.tooltipFeature=null)}setComp(t,s,i,r,n){var o,a,l,u;this.cellComp=t,this.eGui=s,this.printLayout=r,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(i),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),(o=this.cellPositionFeature)==null||o.setComp(s),(a=this.cellCustomStyleFeature)==null||a.setComp(t),(l=this.tooltipFeature)==null||l.refreshToolTip(),(u=this.cellKeyboardListenerFeature)==null||u.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(t,s),n&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(h=>h()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(t){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!t)return;const s=t.parentElement,i=this.beans.gos.getRowHeightForNode(this.rowNode).height,r=a=>{if(this.editing||!this.isAlive())return;const{paddingTop:l,paddingBottom:u,borderBottomWidth:h,borderTopWidth:p}=ba(s),g=l+u+h+p,C=t.offsetHeight+g;if(a<5){const R=this.beans.gos.getDocument(),x=!R||!R.contains(t),S=C==0;if(x||S){window.setTimeout(()=>r(a+1),0);return}}const y=Math.max(C,i);this.rowNode.setRowAutoHeight(y,this.column)},n=()=>r(0);n();const o=this.beans.resizeObserverService.observeResize(t,n);this.addDestroyFunc(()=>{o(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){var t;return(t=this.column.getColDef().cellAriaRole)!=null?t:"gridcell"}getInstanceId(){return this.instanceId}getColumnIdSanitised(){return this.colIdSanitised}getTabIndex(){return this.tabIndex}isCellRenderer(){const t=this.column.getColDef();return t.cellRenderer!=null||t.cellRendererSelector!=null}getValueToDisplay(){var t;return(t=this.valueFormatted)!=null?t:this.value}showValue(t=!1){var s;const i=this.getValueToDisplay();let r;if(this.rowNode.stub){const n=this.createCellRendererParams();r=this.beans.userComponentFactory.getLoadingCellRendererDetails(this.column.getColDef(),n)}else if(this.isCellRenderer()){const n=this.createCellRendererParams();r=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),n)}this.cellComp.setRenderDetails(r,i,t),(s=this.cellRangeFeature)==null||s.refreshHandle()}setupControlComps(){const t=this.column.getColDef();this.includeSelection=this.isIncludeControl(t.checkboxSelection),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(t){return this.rowNode.rowPinned!=null?!1:typeof t=="function"||t===!0}refreshShouldDestroy(){const t=this.column.getColDef(),s=this.includeSelection!=this.isIncludeControl(t.checkboxSelection),i=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),r=this.includeDndSource!=this.isIncludeControl(t.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return s||i||r||n}startEditing(t=null,s=!1,i=null){if(!this.isCellEditable()||this.editing)return;if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startEditing(t,s,i)});return}const r=this.createCellEditorParams(t,s),n=this.column.getColDef(),o=this.beans.userComponentFactory.getCellEditorDetails(n,r);this.editCompDetails=o;const a=(o==null?void 0:o.popupFromSelector)!=null?o.popupFromSelector:!!n.cellEditorPopup,l=(o==null?void 0:o.popupPositionFromSelector)!=null?o.popupPositionFromSelector:n.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(o,a,l,this.beans.gos.get("reactiveCustomComponents"));const u=this.createEvent(i,w.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(u)}setEditing(t){var s;this.editing!==t&&(this.editing=t,(s=this.cellRangeFeature)==null||s.refreshHandle())}stopRowOrCellEdit(t=!1){this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.stopEditing(t):this.stopEditing(t)}onPopupEditorClosed(){this.isEditing()&&this.stopEditingAndFocus()}takeValueFromCellEditor(t){const s={newValueExists:!1};if(t)return s;const i=this.cellComp.getCellEditor();return!i||i.isCancelAfterEnd&&i.isCancelAfterEnd()?s:{newValue:i.getValue(),newValueExists:!0}}saveNewValue(t,s){if(s===t)return!1;this.suppressRefreshCell=!0;const i=this.rowNode.setDataValue(this.column,s,"edit");return this.suppressRefreshCell=!1,i}stopEditing(t=!1){if(!this.editing)return!1;const{newValue:s,newValueExists:i}=this.takeValueFromCellEditor(t),r=this.rowNode.getValueFromValueService(this.column);let n=!1;return i&&(n=this.saveNewValue(r,s)),this.setEditing(!1),this.cellComp.setEditDetails(),this.editCompDetails=void 0,this.updateAndFormatValue(!1),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(r,s,!t&&!!n),n}dispatchEditingStoppedEvent(t,s,i){const r=rs(Xe({},this.createEvent(null,w.EVENT_CELL_EDITING_STOPPED)),{oldValue:t,newValue:s,valueChanged:i});this.beans.eventService.dispatchEvent(r)}createCellEditorParams(t,s){return this.beans.gos.addGridCommonParams({value:this.rowNode.getValueFromValueService(this.column),eventKey:t,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,cellStartedEdit:s,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)})}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:s=>this.beans.valueService.setValue(this.rowNode,this.column,s),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(s,i,r,n)=>this.registerRowDragger(s,i,n),setTooltip:(s,i)=>{var r;this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(s,i),(r=this.tooltipFeature)==null||r.refreshToolTip()}})}parseValue(t){return this.beans.valueService.parseValue(this.column,this.rowNode,t,this.getValue())}setFocusOutOnEditor(){if(!this.editing)return;const t=this.cellComp.getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(){if(!this.editing)return;const t=this.cellComp.getCellEditor();t&&t.focusIn?t.focusIn():this.focusCell(!0)}onCellChanged(t){t.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(t){var s;this.refreshShouldDestroy()?(s=this.rowCtrl)==null||s.recreateCell(this):this.refreshCell(t)}refreshCell(t){var s,i,r,n;if(this.suppressRefreshCell||this.editing)return;const o=this.column.getColDef(),a=t!=null&&!!t.newData,l=t!=null&&!!t.suppressFlash||!!o.suppressCellFlash,u=o.field==null&&o.valueGetter==null&&o.showRowGroup==null,h=t&&t.forceRefresh||u||a,p=!!this.cellComp,g=this.updateAndFormatValue(p),m=h||g;if(p){if(m){this.showValue(a);const C=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!l&&!C&&(this.beans.gos.get("enableCellChangeFlash")||o.enableCellChangeFlash)&&this.flashCell(),(s=this.cellCustomStyleFeature)==null||s.applyUserStyles(),(i=this.cellCustomStyleFeature)==null||i.applyClassesFromColDef()}(r=this.tooltipFeature)==null||r.refreshToolTip(),(n=this.cellCustomStyleFeature)==null||n.applyCellClassRules()}}stopEditingAndFocus(t=!1,s=!1){this.stopRowOrCellEdit(),this.focusCell(!0),t||this.navigateAfterEdit(s)}navigateAfterEdit(t){if(this.beans.gos.get("enterNavigatesVerticallyAfterEdit")){const i=t?U.UP:U.DOWN;this.beans.navigationService.navigateToNextCell(null,i,this.getCellPosition(),!1)}}flashCell(t){var s,i;const r=(s=t==null?void 0:t.flashDuration)!=null?s:t==null?void 0:t.flashDelay,n=(i=t==null?void 0:t.fadeDuration)!=null?i:t==null?void 0:t.fadeDelay;this.animateCell("data-changed",r,n)}animateCell(t,s,i){if(!this.cellComp)return;const r=`ag-cell-${t}`,n=`ag-cell-${t}-animation`,{gos:o}=this.beans;s||(s=o.get("cellFlashDuration")),ve(i)||(i=o.get("cellFadeDuration")),this.cellComp.addOrRemoveCssClass(r,!0),this.cellComp.addOrRemoveCssClass(n,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(r,!1),this.cellComp.addOrRemoveCssClass(n,!0),this.eGui.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(n,!1),this.eGui.style.transition="")},i))},s)})}onFlashCells(t){if(!this.cellComp)return;const s=this.beans.cellPositionUtils.createId(this.getCellPosition());t.cells[s]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(t){var s;return(s=this.callValueFormatter(t))!=null?s:t}callValueFormatter(t){return this.beans.valueService.formatValue(this.column,this.rowNode,t)}updateAndFormatValue(t){const s=this.value,i=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),t?!this.valuesAreEqual(s,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(t,s){const i=this.column.getColDef();return i.equals?i.equals(t,s):t===s}getComp(){return this.cellComp}getValue(){return this.value}addDomData(){const t=this.getGui();this.beans.gos.setDomData(t,rw.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gos.setDomData(t,rw.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(t,s){return this.beans.gos.addGridCommonParams({type:s,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:t,rowIndex:this.rowNode.rowIndex})}processCharacter(t){var s;(s=this.cellKeyboardListenerFeature)==null||s.processCharacter(t)}onKeyDown(t){var s;(s=this.cellKeyboardListenerFeature)==null||s.onKeyDown(t)}onMouseEvent(t,s){var i;(i=this.cellMouseListenerFeature)==null||i.onMouseEvent(t,s)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var t;this.cellComp&&((t=this.cellPositionFeature)==null||t.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:t,column:s,beans:i}=this;tv.refreshFirstAndLastStyles(t,s,i.columnModel)}refreshAriaColIndex(){const t=this.beans.columnModel.getAriaColumnIndex(this.column);r0(this.getGui(),t)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var t;return(t=this.cellPositionFeature)==null?void 0:t.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(t,s=null){if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(t,s)});return}this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.startRowEditing(t,this):this.startEditing(t,!0,s)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return this.cellRangeFeature!=null}focusCell(t=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:t})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const t=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass(mG,t)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const t=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass(vG,t)}onCellFocused(t){if(this.beans.gos.get("suppressCellFocus"))return;const s=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp){s&&(t!=null&&t.forceBrowserFocus)&&(this.focusEventToRestore=t);return}this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass(fG,s),s&&t&&t.forceBrowserFocus&&this.cellComp.getFocusableElement().focus({preventScroll:!!t.preventScrollOnBrowserFocus});const i=this.beans.gos.get("editType")==="fullRow";!s&&!i&&this.editing&&this.stopRowOrCellEdit(),s&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:Mn(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass(hG,!0),this.cellComp.addOrRemoveCssClass(CG,!0);const t=this.column.isAutoHeight()==!0;this.cellComp.addOrRemoveCssClass(pG,t),this.cellComp.addOrRemoveCssClass(gG,!t)}onColumnHover(){if(!this.cellComp||!this.beans.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass(yG,t)}onColDefChanged(){if(!this.cellComp)return;if(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),!this.editing)this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0});else{const s=this.getCellEditor();if(s!=null&&s.refresh){const{eventKey:i,cellStartedEdit:r}=this.editCompDetails.params,n=this.createCellEditorParams(i,r),o=this.column.getColDef(),a=this.beans.userComponentFactory.getCellEditorDetails(o,n);s.refresh(a.params)}}}setWrapText(){const t=this.column.getColDef().wrapText==!0;this.cellComp.addOrRemoveCssClass(wG,t)}dispatchCellContextMenuEvent(t){const s=this.column.getColDef(),i=this.createEvent(t,w.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(i),s.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{s.onCellContextMenu(i)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const t=new Zm;return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t}createDndSource(){const t=new pN(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(t),t}registerRowDragger(t,s,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(t,s);return}const r=this.createRowDragComp(t,s,i);r&&(this.customRowDragComp=r,this.addDestroyFunc(()=>{this.beans.context.destroyBean(r),this.customRowDragComp=null}))}createRowDragComp(t,s,i){const r=this.beans.gos.get("pagination"),n=this.beans.gos.get("rowDragManaged"),o=this.beans.gos.isRowModelType("clientSide");if(n){if(!o){tt("managed row dragging is only allowed in the Client Side Row Model");return}if(r){tt("managed row dragging is not possible when doing pagination");return}}const a=new Dl(()=>this.value,this.rowNode,this.column,t,s,i);return this.beans.context.createBean(a),a}};gN.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var ml=gN,xG=0,fN=class nw extends Se{constructor(t,s,i,r,n){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=s,this.gos=s.gos,this.rowNode=t,this.paginationPage=s.paginationProxy.getCurrentPage(),this.useAnimationFrameForCreate=r,this.printLayout=n,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=t.id+"-"+xG++,this.rowId=Ds(t.id),this.initRowBusinessKey(),this.rowFocused=s.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=s.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.isFullWidth()&&!this.gos.get("suppressCellFocus")&&(this.tabIndex=-1),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const t=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=Ds(t)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}getTabIndex(){return this.tabIndex}isSticky(){return this.rowNode.sticky}getInstanceId(){return this.instanceId}setComp(t,s,i){const r={rowComp:t,element:s,containerType:i};this.allRowGuis.push(r),i==="left"?this.leftGui=r:i==="right"?this.rightGui=r:i==="fullWidth"?this.fullWidthGui=r:this.centerGui=r,this.initialiseRowComp(r),this.rowType!=="FullWidthLoading"&&!this.rowNode.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(t){switch(this.allRowGuis=this.allRowGuis.filter(s=>s.containerType!==t),t){case"left":this.leftGui=void 0;break;case"right":this.rightGui=void 0;break;case"fullWidth":this.fullWidthGui=void 0;break;case"center":this.centerGui=void 0;break}}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(t){const s=t?"none":"";this.allRowGuis.forEach(i=>i.element.style.display=s)}initialiseRowComp(t){const s=this.gos;this.listenOnDomOrder(t),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),s.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=t.rowComp;this.getInitialRowClasses(t.containerType).forEach(n=>i.addOrRemoveCssClass(n,!0)),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&co(t.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),s.setDomData(t.element,nw.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>s.setDomData(t.element,nw.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t.element),this.isFullWidth()&&this.setupFullWidth(t),s.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(t){this.businessKeySanitised!=null&&t.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(t){this.rowId=Ds(this.rowNode.id),this.rowId!=null&&t.setRowId(this.rowId)}executeSlideAndFadeAnimations(t){const{containerType:s}=t;this.slideInAnimation[s]&&(zy(()=>{this.onTopChanged()}),this.slideInAnimation[s]=!1),this.fadeInAnimation[s]&&(zy(()=>{t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[s]=!1)}addRowDraggerToRow(t){if(this.gos.get("enableRangeSelection")){tt("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`");return}const s=this.beans.localeService.getLocaleTextFunc(),i=new Dl(()=>`1 ${s("rowDragRow","row")}`,this.rowNode,void 0,t.element,void 0,!0),r=this.createBean(i,this.beans.context);this.rowDragComps.push(r)}setupFullWidth(t){const s=this.getPinnedForContainer(t.containerType);if(this.rowType=="FullWidthDetail"&&!Vt.__assertRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;const i=this.createFullWidthCompDetails(t.element,s);t.rowComp.showFullWidth(i)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){var t,s;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(i=>{var r;return(r=i==null?void 0:i.rowComp)==null?void 0:r.getFullWidthCellRenderer()}):[(s=(t=this.fullWidthGui)==null?void 0:t.rowComp)==null?void 0:s.getFullWidthCellRenderer()]}getCellElement(t){const s=this.getCellCtrl(t);return s?s.getGui():null}executeProcessRowPostCreateFunc(){const t=this.gos.getCallback("processRowPostCreate");if(!t||!this.areAllContainersReady())return;const s={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};t(s)}areAllContainersReady(){const t=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),s=!!this.centerGui,i=!!this.rightGui||!this.beans.columnModel.isPinningRight();return t&&s&&i}setRowType(){const t=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow"),s=this.rowNode.isFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,r=this.beans.columnModel.isPivotMode(),o=!!this.rowNode.group&&!this.rowNode.footer&&this.gos.isGroupUseEntireRow(r);t?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":s?this.rowType="FullWidth":o?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(t=!1,s=!1){if(this.isFullWidth())return;if(t||this.gos.get("suppressAnimationFrame")||this.printLayout){this.updateColumnListsImpl(s);return}this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(t,s,i=null){const r={list:[],map:{}},n=(o,a)=>{r.list.push(a),r.map[o]=a};return s.forEach(o=>{const a=o.getInstanceId();let l=t.map[a];l||(l=new ml(o,this.rowNode,this.beans,this)),n(a,l)}),t.list.forEach(o=>{if(r.map[o.getColumn().getInstanceId()]!=null)return;if(!this.isCellEligibleToBeRemoved(o,i)){n(o.getColumn().getInstanceId(),o);return}o.destroy()}),r}updateColumnListsImpl(t){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(t)}setCellCtrls(t){this.allRowGuis.forEach(s=>{const i=this.getCellCtrlsForContainer(s.containerType);s.rowComp.setCellCtrls(i,t)})}getCellCtrlsForContainer(t){switch(t){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list;default:const s=t;throw new Error(`Unhandled case: ${s}`)}}createAllCellCtrls(){const t=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const s=t.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,s);const i=t.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,i,"left");const r=t.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(t,s){if(t.getColumn().getPinned()!=s)return!0;const o=t.isEditing(),a=this.beans.focusService.isCellFocused(t.getCellPosition());if(o||a){const u=t.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(u)>=0)}return!0}getDomOrder(){return this.gos.get("ensureDomOrder")||this.gos.isDomLayout("print")}listenOnDomOrder(t){const s=()=>{t.rowComp.setDomOrder(this.getDomOrder())};this.addManagedPropertyListener("domLayout",s),this.addManagedPropertyListener("ensureDomOrder",s)}setAnimateFlags(t){if(this.isSticky()||!t)return;const s=ve(this.rowNode.oldRowTop),i=this.beans.columnModel.isPinningLeft(),r=this.beans.columnModel.isPinningRight();if(s){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.slideInAnimation.fullWidth=!0;return}this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=r}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.fadeInAnimation.fullWidth=!0;return}this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=r}}isEditing(){return this.editingRow}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const t=(a,l)=>a?a.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(a.element,l).params):!0,s=t(this.fullWidthGui,null),i=t(this.centerGui,null),r=t(this.leftGui,"left"),n=t(this.rightGui,"right");return s&&i&&r&&n}addListeners(){this.addManagedListener(this.rowNode,yt.EVENT_HEIGHT_CHANGED,()=>this.onRowHeightChanged()),this.addManagedListener(this.rowNode,yt.EVENT_ROW_SELECTED,()=>this.onRowSelected()),this.addManagedListener(this.rowNode,yt.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.rowNode.detail&&this.addManagedListener(this.rowNode.parent,yt.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_CELL_CHANGED,this.postProcessCss.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_DRAGGING_CHANGED,this.postProcessRowDragging.bind(this)),this.addManagedListener(this.rowNode,yt.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));const t=this.beans.eventService;this.addManagedListener(t,w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(t,w.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(t,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(t,w.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(t,w.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addManagedListener(t,w.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusChanged.bind(this)),this.addManagedListener(t,w.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(t,w.EVENT_MODEL_UPDATED,this.refreshFirstAndLastRowStyles.bind(this)),this.addManagedListener(t,w.EVENT_COLUMN_MOVED,this.updateColumnLists.bind(this)),this.addDestroyFunc(()=>{this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowDragEntireRow"],()=>{if(this.gos.get("rowDragEntireRow")){this.allRowGuis.forEach(i=>{this.addRowDraggerToRow(i)});return}this.destroyBeans(this.rowDragComps,this.beans.context),this.rowDragComps=[]}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListener(this.rowNode,yt.EVENT_ROW_INDEX_CHANGED,()=>{this.getAllCellCtrls().forEach(t=>t.onRowIndexChanged())}),this.addManagedListener(this.rowNode,yt.EVENT_CELL_CHANGED,t=>{this.getAllCellCtrls().forEach(s=>s.onCellChanged(t))})}onRowNodeDataChanged(t){if(this.isFullWidth()!==!!this.rowNode.isFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(i=>i.refreshCell({suppressFlash:!t.update,newData:!t.update})),this.allRowGuis.forEach(i=>{this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const t=this.rowNode.highlighted;this.allRowGuis.forEach(s=>{const i=t===0,r=t===1;s.rowComp.addOrRemoveCssClass("ag-row-highlight-above",i),s.rowComp.addOrRemoveCssClass("ag-row-highlight-below",r)})}postProcessRowDragging(){const t=this.rowNode.dragging;this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass("ag-row-dragging",t))}updateExpandedCss(){const t=this.rowNode.isExpandable(),s=this.rowNode.expanded==!0;this.allRowGuis.forEach(i=>{i.rowComp.addOrRemoveCssClass("ag-row-group",t),i.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&s),i.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!s),co(i.element,t&&s)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Mn(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(t){const s=this.allRowGuis.find(l=>l.element.contains(t.target));if(!((s?s.element:null)===t.target))return;const n=this.rowNode,o=this.beans.focusService.getFocusedCell(),a={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:o&&o.column};this.beans.navigationService.navigateToNextCell(t,t.key,a,!0),t.preventDefault()}onTabKeyDown(t){if(t.defaultPrevented||un(t))return;const s=this.allRowGuis.find(o=>o.element.contains(t.target)),i=s?s.element:null,r=i===t.target;let n=null;r||(n=this.beans.focusService.findNextFocusableElement(i,!1,t.shiftKey)),(this.isFullWidth()&&r||!n)&&this.beans.navigationService.onTabKeyDown(this,t)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var t;const s=(t=this.allRowGuis.find(i=>Zi(i.element)))==null?void 0:t.element;return s?s.getBoundingClientRect().top:0}onFullWidthRowFocused(t){var s;const i=this.rowNode,r=t?this.isFullWidth()&&t.rowIndex===i.rowIndex&&t.rowPinned==i.rowPinned:!1,n=this.fullWidthGui?this.fullWidthGui.element:(s=this.centerGui)==null?void 0:s.element;n&&(n.classList.toggle("ag-full-width-focus",r),r&&n.focus({preventScroll:!0}))}recreateCell(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),t.destroy(),this.updateColumnLists()}removeCellCtrl(t,s){const i={list:[],map:{}};return t.list.forEach(r=>{r!==s&&(i.list.push(r),i.map[r.getColumn().getInstanceId()]=r)}),i}onMouseEvent(t,s){switch(t){case"dblclick":this.onRowDblClick(s);break;case"click":this.onRowClick(s);break;case"touchstart":case"mousedown":this.onRowMouseDown(s);break}}createRowEvent(t,s){return this.gos.addGridCommonParams({type:t,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:s})}createRowEventWithSource(t,s){const i=this.createRowEvent(t,s);return i.source=this,i}onRowDblClick(t){if(un(t))return;const s=this.createRowEventWithSource(w.EVENT_ROW_DOUBLE_CLICKED,t);this.beans.eventService.dispatchEvent(s)}onRowMouseDown(t){if(this.lastMouseDownOnDragger=gl(t.target,"ag-row-drag",3),!this.isFullWidth())return;const s=this.rowNode,i=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:s.rowIndex,column:i.getAllDisplayedColumns()[0],rowPinned:s.rowPinned,forceBrowserFocus:!0})}onRowClick(t){if(un(t)||this.lastMouseDownOnDragger)return;const i=this.createRowEventWithSource(w.EVENT_ROW_CLICKED,t);this.beans.eventService.dispatchEvent(i);const r=t.ctrlKey||t.metaKey,n=t.shiftKey;if(this.gos.get("groupSelectsChildren")&&this.rowNode.group||this.isRowSelectionBlocked()||this.gos.get("suppressRowClickSelection"))return;const a=this.gos.get("rowMultiSelectWithClick"),l=!this.gos.get("suppressRowDeselection"),u="rowClicked";if(this.rowNode.isSelected())a?this.rowNode.setSelectedParams({newValue:!1,event:t,source:u}):r?l&&this.rowNode.setSelectedParams({newValue:!1,event:t,source:u}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:t,source:u});else{const h=a?!1:!r;this.rowNode.setSelectedParams({newValue:!0,clearSelection:h,rangeSelect:n,event:t,source:u})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!this.gos.isRowSelection()}setupDetailRowAutoHeight(t){if(this.rowType!=="FullWidthDetail"||!this.gos.get("detailRowAutoHeight"))return;const s=()=>{const r=t.clientHeight;if(r!=null&&r>0){const n=()=>{this.rowNode.setRowHeight(r),this.beans.clientSideRowModel?this.beans.clientSideRowModel.onRowHeightChanged():this.beans.serverSideRowModel&&this.beans.serverSideRowModel.onRowHeightChanged()};window.setTimeout(n,0)}},i=this.beans.resizeObserverService.observeResize(t,s);this.addDestroyFunc(i),s()}createFullWidthCompDetails(t,s){const i=this.gos.addGridCommonParams({fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,eGridCell:t,eParentOfValue:t,pinned:s,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(r,n,o,a)=>this.addFullWidthRowDragging(r,n,o,a),setTooltip:(r,n)=>this.refreshRowTooltip(r,n)});switch(this.rowType){case"FullWidthDetail":return this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(i);case"FullWidthGroup":return this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(i);case"FullWidthLoading":return this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(i);default:return this.beans.userComponentFactory.getFullWidthCellRendererDetails(i)}}refreshRowTooltip(t,s){if(!this.fullWidthGui)return;const i={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>t,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:s};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new wo(i,this.beans))}addFullWidthRowDragging(t,s,i="",r){if(!this.isFullWidth())return;const n=new Dl(()=>i,this.rowNode,void 0,t,s,r);this.createBean(n,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(n,this.beans.context)})}onUiLevelChanged(){const t=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=t){const s="ag-row-level-"+t,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(r=>{r.rowComp.addOrRemoveCssClass(s,!0),r.rowComp.addOrRemoveCssClass(i,!1)})}this.rowLevel=t}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}refreshFirstAndLastRowStyles(){const t=this.isFirstRowOnPage(),s=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-first",t))),this.lastRowOnPage!==s&&(this.lastRowOnPage=s,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-last",s)))}stopEditing(t=!1){if(this.stoppingRowEdit)return;const s=this.getAllCellCtrls(),i=this.editingRow;this.stoppingRowEdit=!0;let r=!1;for(const n of s){const o=n.stopEditing(t);i&&!t&&!r&&o&&(r=!0)}if(r){const n=this.createRowEvent(w.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(n)}i&&this.setEditingRow(!1),this.stoppingRowEdit=!1}setInlineEditingCss(t){this.allRowGuis.forEach(s=>{s.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),s.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}setEditingRow(t){this.editingRow=t,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-editing",t));const s=t?this.createRowEvent(w.EVENT_ROW_EDITING_STARTED):this.createRowEvent(w.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(s)}startRowEditing(t=null,s=null,i=null){if(this.editingRow)return;this.getAllCellCtrls().reduce((n,o)=>{const a=o===s;return a?o.startEditing(t,a,i):o.startEditing(null,a,i),n?!0:o.isEditing()},!1)&&this.setEditingRow(!0)}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const t=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);!t||!t.length||t.forEach(s=>{this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass(s,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,t=>{this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass(t,!0))},t=>{this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass(t,!1))})}setStylesFromGridOptions(t,s){t&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(s,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(t){return t==="left"?"left":t==="right"?"right":null}getInitialRowClasses(t){const s=this.getPinnedForContainer(t),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[t],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:s};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)}processStylesFromGridOptions(){const t=this.gos.get("rowStyle");if(t&&typeof t=="function"){console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");return}const s=this.gos.getCallback("getRowStyle");let i;if(s){const r={data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex};i=s(r)}return i||t?Object.assign({},t,i):this.emptyStyle}onRowSelected(t){const s=!!this.rowNode.isSelected();this.forEachGui(t,i=>{i.rowComp.addOrRemoveCssClass("ag-row-selected",s),eu(i.element,s),i.element.contains(this.beans.gos.getActiveDomElement())&&(i===this.centerGui||i===this.fullWidthGui)&&this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const t=this.rowNode.isSelected();if(t&&this.beans.gos.get("suppressRowDeselection"))return;const i=this.beans.localeService.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(i)}addHoverFunctionality(t){this.active&&(this.addManagedListener(t,"mouseenter",()=>this.rowNode.onMouseEnter()),this.addManagedListener(t,"mouseleave",()=>this.rowNode.onMouseLeave()),this.addManagedListener(this.rowNode,yt.EVENT_MOUSE_ENTER,()=>{!this.beans.dragService.isDragging()&&!this.gos.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),this.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,yt.EVENT_MOUSE_LEAVE,()=>{t.classList.remove("ag-row-hover"),this.rowNode.setHovered(!1)}))}roundRowTopToBounds(t){const s=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(s.top,!0)-100,r=this.applyPaginationOffset(s.bottom,!0)+100;return Math.min(Math.max(i,t),r)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(t,s){t?s(t):this.allRowGuis.forEach(s)}onRowHeightChanged(t){if(this.rowNode.rowHeight==null)return;const s=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=this.gos.isGetRowHeightFunction()?this.gos.getRowHeightForNode(this.rowNode).height:void 0,o=n?`${Math.min(i,n)-2}px`:void 0;this.forEachGui(t,a=>{a.element.style.height=`${s}px`,o&&a.element.style.setProperty("--ag-line-height",o)})}addEventListener(t,s){super.addEventListener(t,s)}removeEventListener(t,s){super.removeEventListener(t,s)}destroyFirstPass(t=!1){if(this.active=!1,!t&&this.gos.isAnimateRows()&&!this.isSticky())if(this.rowNode.rowTop!=null){const r=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(r)}else this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.rowNode.setHovered(!1);const s=this.createRowEvent(w.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(s),this.beans.eventService.dispatchEvent(s),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const t=s=>(s.list.forEach(i=>i.destroy()),{list:[],map:{}});this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)}setFocusedClasses(t){this.forEachGui(t,s=>{s.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),s.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const t=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses()),!t&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const t=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(t,s=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return t;const i=this.beans.paginationProxy.getPixelOffset();return t+i*(s?1:-1)}setRowTop(t){if(!this.printLayout&&ve(t)){const s=this.applyPaginationOffset(t),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?s:this.beans.rowContainerHeightService.getRealPixelPosition(s)}px`;this.setRowTopStyle(n)}}getInitialRowTop(t){return this.suppressRowTransform?this.getInitialRowTopShared(t):void 0}getInitialTransform(t){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(t)})`}getInitialRowTopShared(t){if(this.printLayout)return"";let s;if(this.isSticky())s=this.rowNode.stickyRowTop;else{const i=this.slideInAnimation[t]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,r=this.applyPaginationOffset(i);s=this.rowNode.isRowPinned()?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}return s+"px"}setRowTopStyle(t){this.allRowGuis.forEach(s=>this.suppressRowTransform?s.rowComp.setTop(t):s.rowComp.setTransform(`translateY(${t})`))}getRowNode(){return this.rowNode}getCellCtrl(t){let s=null;return this.getAllCellCtrls().forEach(i=>{i.getColumn()==t&&(s=i)}),s!=null||this.getAllCellCtrls().forEach(i=>{i.getColSpanningList().indexOf(t)>=0&&(s=i)}),s}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(t){const s=this.rowNode.getRowIndexString(),i=this.beans.headerNavigationService.getHeaderRowCount()+this.beans.filterManager.getHeaderRowCount(),r=this.rowNode.rowIndex%2===0,n=i+this.rowNode.rowIndex+1;this.forEachGui(t,o=>{o.rowComp.setRowIndex(s),o.rowComp.addOrRemoveCssClass("ag-row-even",r),o.rowComp.addOrRemoveCssClass("ag-row-odd",!r),i0(o.element,n)})}};fN.DOM_DATA_KEY_ROW_CTRL="renderedRow";var vl=fN,Xi=class extends Se{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedListener(this.element,e,t)}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",JS("touchstart")?"touchstart":"mousedown"].forEach(s=>{const i=this.processMouseEvent.bind(this,s);this.addManagedListener(this.element,s,i)})}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||un(t))return;const s=this.getRowForEvent(t),i=this.mouseEventService.getRenderedCellForEvent(t);e==="contextmenu"?this.handleContextMenuMouseEvent(t,void 0,s,i):(i&&i.onMouseEvent(e,t),s&&s.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!yo())return;const e=new Ws(this.element),t=s=>{const i=this.getRowForEvent(s.touchEvent),r=this.mouseEventService.getRenderedCellForEvent(s.touchEvent);this.handleContextMenuMouseEvent(void 0,s.touchEvent,i,r)};this.addManagedListener(e,Ws.EVENT_LONG_TAP,t),this.addDestroyFunc(()=>e.destroy())}getRowForEvent(e){let t=e.target;for(;t;){const s=this.gos.getDomData(t,vl.DOM_DATA_KEY_ROW_CTRL);if(s)return s;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,s,i){const r=s?s.getRowNode():null,n=i?i.getColumn():null;let o=null;if(n){const u=e||t;i.dispatchCellContextMenuEvent(u??null),o=this.valueService.getValue(n,r)}const a=this.ctrlsService.getGridBodyCtrl(),l=i?i.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:r,column:n,value:o,anchorToElement:l})}getControlsForEventTarget(e){return{cellCtrl:bf(this.gos,e,ml.DOM_DATA_KEY_CELL_CTRL),rowCtrl:bf(this.gos,e,vl.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:s,rowCtrl:i}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(s?this.processCellKeyboardEvent(s,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}processCellKeyboardEvent(e,t,s){const i=e.getRowNode(),r=e.getColumn(),n=e.isEditing();if(!Df(this.gos,s,i,r,n)&&t==="keydown"&&(!n&&this.navigationService.handlePageScrollingKey(s)||e.onKeyDown(s),this.doGridOperations(s,e.isEditing()),Wm(s)&&e.processCharacter(s)),t==="keydown"){const a=e.createEvent(s,w.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(a)}}processFullWidthRowKeyboardEvent(e,t,s){const i=e.getRowNode(),r=this.focusService.getFocusedCell(),n=r&&r.column;if(!Df(this.gos,s,i,n,!1)){const a=s.key;if(t==="keydown")switch(a){case U.PAGE_HOME:case U.PAGE_END:case U.PAGE_UP:case U.PAGE_DOWN:this.navigationService.handlePageScrollingKey(s,!0);break;case U.UP:case U.DOWN:e.onKeyboardNavigate(s);break;case U.TAB:e.onTabKeyDown(s);break}}if(t==="keydown"){const a=e.createRowEvent(w.EVENT_CELL_KEY_DOWN,s);this.eventService.dispatchEvent(a)}}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!this.mouseEventService.isEventFromThisGrid(e))return;const s=vF(e);if(s===U.A)return this.onCtrlAndA(e);if(s===U.C)return this.onCtrlAndC(e);if(s===U.D)return this.onCtrlAndD(e);if(s===U.V)return this.onCtrlAndV(e);if(s===U.X)return this.onCtrlAndX(e);if(s===U.Y)return this.onCtrlAndY();if(s===U.Z)return this.onCtrlAndZ(e)}onCtrlAndA(e){const{pinnedRowModel:t,paginationProxy:s,rangeService:i}=this;if(i&&s.isRowsToRender()){const[r,n]=[t.isEmpty("top"),t.isEmpty("bottom")],o=r?null:"top";let a,l;n?(a=null,l=this.paginationProxy.getRowCount()-1):(a="bottom",l=t.getPinnedBottomRowData().length-1);const u=this.columnModel.getAllDisplayedColumns();if(Pr(u))return;i.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:l,rowEndPinned:a,columnStart:u[0],columnEnd:Mt(u)})}e.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:s}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||s!=null&&s.isEditing()||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:s}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||s!=null&&s.isEditing()||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:s}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||s!=null&&s.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){this.gos.get("undoRedoCellEditing")&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService.redo("ui")}};f([A("mouseEventService")],Xi.prototype,"mouseEventService",2);f([A("valueService")],Xi.prototype,"valueService",2);f([A("menuService")],Xi.prototype,"menuService",2);f([A("ctrlsService")],Xi.prototype,"ctrlsService",2);f([A("navigationService")],Xi.prototype,"navigationService",2);f([A("focusService")],Xi.prototype,"focusService",2);f([A("undoRedoService")],Xi.prototype,"undoRedoService",2);f([A("columnModel")],Xi.prototype,"columnModel",2);f([A("paginationProxy")],Xi.prototype,"paginationProxy",2);f([A("pinnedRowModel")],Xi.prototype,"pinnedRowModel",2);f([zt("rangeService")],Xi.prototype,"rangeService",2);f([zt("clipboardService")],Xi.prototype,"clipboardService",2);f([xe],Xi.prototype,"postConstruct",1);var bu=class extends Se{constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedListener(this.eventService,w.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this)),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const e=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.getBodyViewportElement(),t=Hl(e);if(t<=50)return;let s=this.getPinnedColumnsOverflowingViewport(t-50);const i=this.gos.getCallback("processUnpinnedColumns");s.length&&(i&&(s=i({columns:s,viewportWidth:t})),this.columnModel.setColumnsPinned(s,null,"viewportSizeFeature"))}getPinnedColumnsOverflowingViewport(e){const t=this.pinnedWidthService.getPinnedRightWidth(),s=this.pinnedWidthService.getPinnedLeftWidth(),i=t+s;if(i<e)return[];const r=[...this.columnModel.getDisplayedLeftColumns()],n=[...this.columnModel.getDisplayedRightColumns()];let o=0,a=0,l=0;const u=[];let h=i-l-e;for(;(a<r.length||o<n.length)&&h>0;){if(o<n.length){const p=n[o++];h-=p.getActualWidth(),u.push(p)}if(a<r.length&&h>0){const p=r[a++];h-=p.getActualWidth(),u.push(p)}}return u}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.getBodyViewportElement(),t=pp(e);if(this.bodyHeight!==t){this.bodyHeight=t;const s={type:w.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(s)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}};f([A("ctrlsService")],bu.prototype,"ctrlsService",2);f([A("pinnedWidthService")],bu.prototype,"pinnedWidthService",2);f([A("columnModel")],bu.prototype,"columnModel",2);f([A("scrollVisibleService")],bu.prototype,"scrollVisibleService",2);f([xe],bu.prototype,"postConstruct",1);var L0=class extends Se{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;Dt(this.element,t),kr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}};f([A("pinnedWidthService")],L0.prototype,"pinnedWidthService",2);f([xe],L0.prototype,"postConstruct",1);var O0=class extends Se{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;Dt(this.element,t),kr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}};f([A("pinnedWidthService")],O0.prototype,"pinnedWidthService",2);f([xe],O0.prototype,"postConstruct",1);var sv=class extends Se{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=e!=null?`${e}px`:"";this.eContainer.style.height=t,this.eViewport&&(this.eViewport.style.height=t)}};f([A("rowContainerHeightService")],sv.prototype,"maxDivHeightScaler",2);f([xe],sv.prototype,"postConstruct",1);var iv=class extends Se{constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListener("enableRangeSelection",t=>{if(t.currentValue){this.enableFeature();return}this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature()),this.gos.get("enableRangeSelection")&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}};f([A("dragService")],iv.prototype,"dragService",2);f([zt("rangeService")],iv.prototype,"rangeService",2);f([xe],iv.prototype,"postConstruct",1);var Eu=class extends Se{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addSpacer&&(this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_SCROLLBAR_WIDTH_CHANGED,e)),this.setWidth()}setWidth(){const{columnModel:e}=this,t=this.gos.isDomLayout("print"),s=e.getBodyContainerWidth(),i=e.getDisplayedColumnsLeftWidth(),r=e.getDisplayedColumnsRightWidth();let n;t?n=s+i+r:(n=s,this.addSpacer&&(this.gos.get("enableRtl")?i:r)===0&&this.scrollVisibleService.isVerticalScrollShowing()&&(n+=this.gos.getScrollbarWidth())),this.callback(n)}};f([A("columnModel")],Eu.prototype,"columnModel",2);f([A("scrollVisibleService")],Eu.prototype,"scrollVisibleService",2);f([xe],Eu.prototype,"postConstruct",1);var es=(e=>(e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth",e.TOP_LEFT="topLeft",e.TOP_RIGHT="topRight",e.TOP_CENTER="topCenter",e.TOP_FULL_WIDTH="topFullWidth",e.STICKY_TOP_LEFT="stickyTopLeft",e.STICKY_TOP_RIGHT="stickyTopRight",e.STICKY_TOP_CENTER="stickyTopCenter",e.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",e.STICKY_BOTTOM_LEFT="stickyBottomLeft",e.STICKY_BOTTOM_RIGHT="stickyBottomRight",e.STICKY_BOTTOM_CENTER="stickyBottomCenter",e.STICKY_BOTTOM_FULL_WIDTH="stickyBottomFullWidth",e.BOTTOM_LEFT="bottomLeft",e.BOTTOM_RIGHT="bottomRight",e.BOTTOM_CENTER="bottomCenter",e.BOTTOM_FULL_WIDTH="bottomFullWidth",e))(es||{});function mN(e){switch(e){case"center":case"topCenter":case"stickyTopCenter":case"bottomCenter":case"stickyBottomCenter":return"center";case"left":case"topLeft":case"stickyTopLeft":case"bottomLeft":case"stickyBottomLeft":return"left";case"right":case"topRight":case"stickyTopRight":case"bottomRight":case"stickyBottomRight":return"right";case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return"fullWidth";default:throw Error("Invalid Row Container Type")}}var bG=Bo([["center","ag-center-cols-container"],["left","ag-pinned-left-cols-container"],["right","ag-pinned-right-cols-container"],["fullWidth","ag-full-width-container"],["topCenter","ag-floating-top-container"],["topLeft","ag-pinned-left-floating-top"],["topRight","ag-pinned-right-floating-top"],["topFullWidth","ag-floating-top-full-width-container"],["stickyTopCenter","ag-sticky-top-container"],["stickyTopLeft","ag-pinned-left-sticky-top"],["stickyTopRight","ag-pinned-right-sticky-top"],["stickyTopFullWidth","ag-sticky-top-full-width-container"],["stickyBottomCenter","ag-sticky-bottom-container"],["stickyBottomLeft","ag-pinned-left-sticky-bottom"],["stickyBottomRight","ag-pinned-right-sticky-bottom"],["stickyBottomFullWidth","ag-sticky-bottom-full-width-container"],["bottomCenter","ag-floating-bottom-container"],["bottomLeft","ag-pinned-left-floating-bottom"],["bottomRight","ag-pinned-right-floating-bottom"],["bottomFullWidth","ag-floating-bottom-full-width-container"]]),EG=Bo([["center","ag-center-cols-viewport"],["topCenter","ag-floating-top-viewport"],["stickyTopCenter","ag-sticky-top-viewport"],["bottomCenter","ag-floating-bottom-viewport"],["stickyBottomCenter","ag-sticky-bottom-viewport"]]),Yl=class vN extends Se{constructor(t){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=t,this.isFullWithContainer=this.name==="topFullWidth"||this.name==="stickyTopFullWidth"||this.name==="stickyBottomFullWidth"||this.name==="bottomFullWidth"||this.name==="fullWidth"}static getRowContainerCssClasses(t){const s=bG.get(t),i=EG.get(t);return{container:s,viewport:i}}static getPinned(t){switch(t){case"bottomLeft":case"topLeft":case"stickyTopLeft":case"stickyBottomLeft":case"left":return"left";case"bottomRight":case"topRight":case"stickyTopRight":case"stickyBottomRight":case"right":return"right";default:return null}}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>this.viewportSizeFeature=this.createManagedBean(new bu(this)))}registerWithCtrlsService(){switch(this.name){case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return;default:this.ctrlsService.register(this.name,this)}}forContainers(t,s){t.indexOf(this.name)>=0&&s()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(t,s,i){this.comp=t,this.eContainer=s,this.eViewport=i,this.createManagedBean(new Xi(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();const r=["topCenter","topLeft","topRight"],n=["stickyTopCenter","stickyTopLeft","stickyTopRight"],o=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],a=["bottomCenter","bottomLeft","bottomRight"],l=["center","left","right"],u=[...r,...a,...l,...n,...o],h=["center","left","right","fullWidth"],p=["center","topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],g=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],m=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"];this.forContainers(g,()=>{this.pinnedWidthFeature=this.createManagedBean(new L0(this.eContainer)),this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(m,()=>{this.pinnedWidthFeature=this.createManagedBean(new O0(this.eContainer)),this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(h,()=>this.createManagedBean(new sv(this.eContainer,this.name==="center"?i:void 0))),this.forContainers(u,()=>this.createManagedBean(new iv(this.eContainer))),this.forContainers(p,()=>this.createManagedBean(new Eu(C=>this.comp.setContainerWidth(`${C}px`)))),this.addListeners(),this.registerWithCtrlsService()}addListeners(){this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>this.onDisplayedColumnsChanged()),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>this.onDisplayedColumnsWidthChanged()),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_ROWS_CHANGED,t=>this.onDisplayedRowsChanged(t.afterScroll)),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(["stickyTopCenter","stickyTopLeft","stickyTopRight","stickyTopFullWidth","stickyBottomCenter","stickyBottomLeft","stickyBottomRight","stickyBottomFullWidth"].indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const i=()=>{const r=this.gos.get("ensureDomOrder"),n=this.gos.isDomLayout("print");this.comp.setDomOrder(r||n)};this.addManagedPropertyListener("domLayout",i),i()}stopHScrollOnPinnedRows(){this.forContainers(["topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],()=>{const t=()=>this.eViewport.scrollLeft=0;this.addManagedListener(this.eViewport,"scroll",t)})}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const t=s=>{this.dragService.isDragging()&&s.cancelable&&s.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(t=!1){const s=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(s,i,t)}getCenterWidth(){return Hl(this.eViewport)}getCenterViewportScrollLeft(){return fh(this.eViewport,this.enableRtl)}registerViewportResizeListener(t){const s=this.resizeObserverService.observeResize(this.eViewport,t);this.addDestroyFunc(()=>s())}isViewportInTheDOMTree(){return m0(this.eViewport)}getViewportScrollLeft(){return fh(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||aF(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(t){this.eContainer.style.transform=`translateX(${t}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(t){mh(this.eViewport,t,this.enableRtl)}isContainerVisible(){return!vN.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const t=this.isContainerVisible();this.visible!=t&&(this.visible=t,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(t=!1){const s=this.getRowCtrls();if(!this.visible||s.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const i=this.gos.isDomLayout("print"),n=this.gos.get("embedFullWidthRows")||i,o=s.filter(a=>{const l=a.isFullWidth();return this.isFullWithContainer?!n&&l:n||!l});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:t})}getRowCtrls(){switch(this.name){case"topCenter":case"topLeft":case"topRight":case"topFullWidth":return this.rowRenderer.getTopRowCtrls();case"stickyTopCenter":case"stickyTopLeft":case"stickyTopRight":case"stickyTopFullWidth":return this.rowRenderer.getStickyTopRowCtrls();case"stickyBottomCenter":case"stickyBottomLeft":case"stickyBottomRight":case"stickyBottomFullWidth":return this.rowRenderer.getStickyBottomRowCtrls();case"bottomCenter":case"bottomLeft":case"bottomRight":case"bottomFullWidth":return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getCentreRowCtrls()}}};f([A("dragService")],Yl.prototype,"dragService",2);f([A("ctrlsService")],Yl.prototype,"ctrlsService",2);f([A("columnModel")],Yl.prototype,"columnModel",2);f([A("resizeObserverService")],Yl.prototype,"resizeObserverService",2);f([A("rowRenderer")],Yl.prototype,"rowRenderer",2);f([xe],Yl.prototype,"postConstruct",1);var Ff=Yl,RG=`<div class="ag-root ag-unselectable" role="treegrid">
        <ag-header-root ref="gridHeader"></ag-header-root>
        <div class="ag-floating-top" ref="eTop" role="presentation">
            <ag-row-container ref="topLeftContainer" name="topLeft"></ag-row-container>
            <ag-row-container ref="topCenterContainer" name="topCenter"></ag-row-container>
            <ag-row-container ref="topRightContainer" name="topRight"></ag-row-container>
            <ag-row-container ref="topFullWidthContainer" name="topFullWidth"></ag-row-container>
        </div>
        <div class="ag-body" ref="eBody" role="presentation">
            <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">
                <ag-row-container ref="leftContainer" name="left"></ag-row-container>
                <ag-row-container ref="centerContainer" name="center"></ag-row-container>
                <ag-row-container ref="rightContainer" name="right"></ag-row-container>
                <ag-row-container ref="fullWidthContainer" name="fullWidth"></ag-row-container>
            </div>
            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>
        </div>
        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">
            <ag-row-container ref="stickyTopLeftContainer" name="stickyTopLeft"></ag-row-container>
            <ag-row-container ref="stickyTopCenterContainer" name="stickyTopCenter"></ag-row-container>
            <ag-row-container ref="stickyTopRightContainer" name="stickyTopRight"></ag-row-container>
            <ag-row-container ref="stickyTopFullWidthContainer" name="stickyTopFullWidth"></ag-row-container>
        </div>
        <div class="ag-sticky-bottom" ref="eStickyBottom" role="presentation">
            <ag-row-container ref="stickyBottomLeftContainer" name="stickyBottomLeft"></ag-row-container>
            <ag-row-container ref="stickyBottomCenterContainer" name="stickyBottomCenter"></ag-row-container>
            <ag-row-container ref="stickyBottomRightContainer" name="stickyBottomRight"></ag-row-container>
            <ag-row-container ref="stickyBottomFullWidthContainer" name="stickyBottomFullWidth"></ag-row-container>
        </div>
        <div class="ag-floating-bottom" ref="eBottom" role="presentation">
            <ag-row-container ref="bottomLeftContainer" name="bottomLeft"></ag-row-container>
            <ag-row-container ref="bottomCenterContainer" name="bottomCenter"></ag-row-container>
            <ag-row-container ref="bottomRightContainer" name="bottomRight"></ag-row-container>
            <ag-row-container ref="bottomFullWidthContainer" name="bottomFullWidth"></ag-row-container>
        </div>
        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>
        <ag-overlay-wrapper></ag-overlay-wrapper>
    </div>`,mn=class extends at{constructor(){super(RG)}init(){const t=(i,r)=>{const n=`${i}px`;r.style.minHeight=n,r.style.height=n},s={setRowAnimationCssOnBodyViewport:(i,r)=>this.setRowAnimationCssOnBodyViewport(i,r),setColumnCount:i=>zA(this.getGui(),i),setRowCount:i=>WA(this.getGui(),i),setTopHeight:i=>t(i,this.eTop),setBottomHeight:i=>t(i,this.eBottom),setTopDisplay:i=>this.eTop.style.display=i,setBottomDisplay:i=>this.eBottom.style.display=i,setStickyTopHeight:i=>this.eStickyTop.style.height=i,setStickyTopTop:i=>this.eStickyTop.style.top=i,setStickyTopWidth:i=>this.eStickyTop.style.width=i,setStickyBottomHeight:i=>this.eStickyBottom.style.height=i,setStickyBottomBottom:i=>this.eStickyBottom.style.bottom=i,setStickyBottomWidth:i=>this.eStickyBottom.style.width=i,setColumnMovingCss:(i,r)=>this.addOrRemoveCssClass(i,r),updateLayoutClasses:(i,r)=>{[this.eBodyViewport.classList,this.eBody.classList].forEach(o=>{o.toggle("ag-layout-auto-height",r.autoHeight),o.toggle("ag-layout-normal",r.normal),o.toggle("ag-layout-print",r.print)}),this.addOrRemoveCssClass("ag-layout-auto-height",r.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",r.normal),this.addOrRemoveCssClass("ag-layout-print",r.print)},setAlwaysVerticalScrollClass:(i,r)=>this.eBodyViewport.classList.toggle(hN,r),registerBodyViewportResizeListener:i=>{const r=this.resizeObserverService.observeResize(this.eBodyViewport,i);this.addDestroyFunc(()=>r())},setPinnedTopBottomOverflowY:i=>this.eTop.style.overflowY=this.eBottom.style.overflowY=i,setCellSelectableCss:(i,r)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(n=>n.classList.toggle(i,r))},setBodyViewportWidth:i=>this.eBodyViewport.style.width=i};this.ctrl=this.createManagedBean(new gi),this.ctrl.setComp(s,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(this.rangeService&&this.gos.get("enableRangeSelection")||this.gos.get("rowSelection")==="multiple")&&jA(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(t,s){const i=this.eBodyViewport.classList;i.toggle("ag-row-animation",s),i.toggle("ag-row-no-animation",!s)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}};f([A("resizeObserverService")],mn.prototype,"resizeObserverService",2);f([zt("rangeService")],mn.prototype,"rangeService",2);f([Fe("eBodyViewport")],mn.prototype,"eBodyViewport",2);f([Fe("eStickyTop")],mn.prototype,"eStickyTop",2);f([Fe("eStickyBottom")],mn.prototype,"eStickyBottom",2);f([Fe("eTop")],mn.prototype,"eTop",2);f([Fe("eBottom")],mn.prototype,"eBottom",2);f([Fe("gridHeader")],mn.prototype,"headerRootComp",2);f([Fe("eBody")],mn.prototype,"eBody",2);f([xe],mn.prototype,"init",1);var iu=class extends Se{postConstruct(){this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateImpl())}):this.updateImpl()}updateImpl(){const e=this.ctrlsService.get("center");if(!e||this.columnAnimationService.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t)}setScrollsVisible(e){if(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing){this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing;const s={type:w.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(s)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}};f([A("ctrlsService")],iu.prototype,"ctrlsService",2);f([A("columnAnimationService")],iu.prototype,"columnAnimationService",2);f([xe],iu.prototype,"postConstruct",1);iu=f([Le("scrollVisibleService")],iu);var ro=class extends Se{constructor(){super(...arguments),this.gridInstanceId=ro.gridInstanceSequence.next()}stampTopLevelGridCompWithGridInstance(e){e[ro.GRID_DOM_KEY]=this.gridInstanceId}getRenderedCellForEvent(e){return bf(this.gos,e.target,ml.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(e){return this.isElementInThisGrid(e.target)}isElementInThisGrid(e){let t=e;for(;t;){const s=t[ro.GRID_DOM_KEY];if(ve(s))return s===this.gridInstanceId;t=t.parentElement}return!1}getCellPositionForEvent(e){const t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}getNormalisedPosition(e){const t=this.gos.isDomLayout("normal"),s=e;let i,r;if(s.clientX!=null||s.clientY!=null?(i=s.clientX,r=s.clientY):(i=s.x,r=s.y),t){const n=this.ctrlsService.getGridBodyCtrl(),o=n.getScrollFeature().getVScrollPosition(),a=n.getScrollFeature().getHScrollPosition();i+=a.left,r+=o.top}return{x:i,y:r}}};ro.gridInstanceSequence=new su;ro.GRID_DOM_KEY="__ag_grid_instance";f([A("ctrlsService")],ro.prototype,"ctrlsService",2);ro=f([Le("mouseEventService")],ro);var hi=class extends Se{constructor(){super(),this.onPageDown=Uy(this.onPageDown,100),this.onPageUp=Uy(this.onPageUp,100)}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const s=e.key,i=e.altKey,r=e.ctrlKey||e.metaKey,n=!!this.rangeService&&e.shiftKey,o=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(s){case U.PAGE_HOME:case U.PAGE_END:!r&&!i&&(this.onHomeOrEndKey(s),a=!0);break;case U.LEFT:case U.RIGHT:case U.UP:case U.DOWN:if(!o)return!1;r&&!i&&!n&&(this.onCtrlUpDownLeftRight(s,o),a=!0);break;case U.PAGE_DOWN:case U.PAGE_UP:!r&&!i&&(a=this.handlePageUpDown(s,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,s){return s&&(t=this.focusService.getFocusedCell()),t?(e===U.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo(e){var t;const{scrollIndex:s,scrollType:i,scrollColumn:r,focusIndex:n,focusColumn:o}=e;ve(r)&&!r.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(r),ve(s)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(s,i),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(n),this.focusService.setFocusedCell({rowIndex:n,column:o,rowPinned:null,forceBrowserFocus:!0}),(t=this.rangeService)==null||t.setRangeToCell({rowIndex:n,rowPinned:null,column:o})}onPageDown(e){const s=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.getViewportHeight(),r=this.paginationProxy.getPixelOffset(),n=s.top+i,o=this.paginationProxy.getRowIndexAtPixel(n+r);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}onPageUp(e){const s=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.paginationProxy.getPixelOffset(),r=s.top,n=this.paginationProxy.getRowIndexAtPixel(r+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,n,!0):this.navigateToNextPage(e,n,!0)}navigateToNextPage(e,t,s=!1){const i=this.getViewportHeight(),r=this.paginationProxy.getPageFirstRow(),n=this.paginationProxy.getPageLastRow(),o=this.paginationProxy.getPixelOffset(),a=this.paginationProxy.getRow(e.rowIndex),l=s?(a==null?void 0:a.rowHeight)-i-o:i-o,u=(a==null?void 0:a.rowTop)+l;let h=this.paginationProxy.getRowIndexAtPixel(u+o);if(h===e.rowIndex){const g=s?-1:1;t=h=e.rowIndex+g}let p;s?(p="bottom",h<r&&(h=r),t<r&&(t=r)):(p="top",h>n&&(h=n),t>n&&(t=n)),this.isRowTallerThanView(h)&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,s=!1){this.navigateTo({scrollIndex:t,scrollType:s?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const i=this.getNextFocusIndexForAutoHeight(e,s);this.navigateTo({scrollIndex:t,scrollType:s?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){var s;const i=t?-1:1,r=this.getViewportHeight(),n=this.paginationProxy.getPageLastRow();let o=0,a=e.rowIndex;for(;a>=0&&a<=n;){const l=this.paginationProxy.getRow(a);if(l){const u=(s=l.rowHeight)!=null?s:0;if(o+u>r)break;o+=u}a+=i}return Math.max(0,Math.min(a,n))}getViewportHeight(){const{gridBodyCtrl:e,center:t}=this.ctrlsService.getParams(),s=e.getScrollFeature().getVScrollPosition(),i=this.gos.getScrollbarWidth();let r=s.bottom-s.top;return t.isHorizontalScrollShowing()&&(r-=i),r}isRowTallerThanView(e){const t=this.paginationProxy.getRow(e);if(!t)return!1;const s=t.rowHeight;return typeof s!="number"?!1:s>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const s=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:i,column:r}=s;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:r,focusIndex:i,focusColumn:r})}onHomeOrEndKey(e){const t=e===U.PAGE_HOME,s=this.columnModel.getAllDisplayedColumns(),i=t?s[0]:Mt(s),r=t?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:i,focusIndex:r,focusColumn:i})}onTabKeyDown(e,t){const s=t.shiftKey,i=this.tabToNextCellCommon(e,s,t);if(i!==!1){i&&t.preventDefault();return}if(s){const{rowIndex:r,rowPinned:n}=e.getRowPosition();(n?r===0:r===this.paginationProxy.getPageFirstRow())&&(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusPreviousFromFirstCell(t)))}else e instanceof ml&&e.focusCell(!0),this.focusService.focusNextGridCoreContainer(s)&&t.preventDefault()}tabToNextCell(e,t){const s=this.focusService.getFocusedCell();if(!s)return!1;let i=this.getCellByPosition(s);return!i&&(i=this.rowRenderer.getRowByPosition(s),!i||!i.isFullWidth())?!1:!!this.tabToNextCellCommon(i,e,t)}tabToNextCellCommon(e,t,s){let i=e.isEditing();if(!i&&e instanceof ml){const o=e.getRowCtrl();o&&(i=o.isEditing())}let r;return i?this.gos.get("editType")==="fullRow"?r=this.moveToNextEditingRow(e,t,s):r=this.moveToNextEditingCell(e,t,s):r=this.moveToNextCellNotEditing(e,t),r===null?r:r||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t,s=null){const i=e.getCellPosition();e.getGui().focus(),e.stopEditing();const r=this.findNextCellToFocusOn(i,t,!0);return r===!1?null:r==null?!1:(r.startEditing(null,!0,s),r.focusCell(!1),!0)}moveToNextEditingRow(e,t,s=null){const i=e.getCellPosition(),r=this.findNextCellToFocusOn(i,t,!0);if(r===!1)return null;if(r==null)return!1;const n=r.getCellPosition(),o=this.isCellEditable(i),a=this.isCellEditable(n),l=n&&i.rowIndex===n.rowIndex&&i.rowPinned===n.rowPinned;return o&&e.setFocusOutOnEditor(),l||(e.getRowCtrl().stopEditing(),r.getRowCtrl().startRowEditing(void 0,void 0,s)),a?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const s=this.columnModel.getAllDisplayedColumns();let i;e instanceof vl?i=rs(Xe({},e.getRowPosition()),{column:t?s[0]:Mt(s)}):i=e.getCellPosition();const r=this.findNextCellToFocusOn(i,t,!1);if(r===!1)return null;if(r instanceof ml)r.focusCell(!0);else if(r)return this.tryToFocusFullWidthRow(r.getRowPosition(),t);return ve(r)}findNextCellToFocusOn(e,t,s){var i;let r=e;for(;;){e!==r&&(e=r),t||(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextTabbedCell(r,t);const n=this.gos.getCallback("tabToNextCell");if(ve(n)){const u=n({backwards:t,editing:s,previousCellPosition:e,nextCellPosition:r||null});if(u===!0||u===null)u===null&&tt("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),r=e;else{if(u===!1)return!1;u.floating&&(tt("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),u.rowPinned=u.floating),r={rowIndex:u.rowIndex,column:u.column,rowPinned:u.rowPinned}}}if(!r)return null;if(r.rowIndex<0){const l=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:l+r.rowIndex,column:r.column},fromCell:!0}),null}const o=this.gos.get("editType")==="fullRow";if(s&&!o&&!this.isCellEditable(r))continue;this.ensureCellVisible(r);const a=this.getCellByPosition(r);if(!a){const l=this.rowRenderer.getRowByPosition(r);if(!l||!l.isFullWidth()||s)continue;return l}if(!a.isSuppressNavigable())return(i=this.rangeService)==null||i.setRangeToCell(r),a}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return e.rowPinned==="top"?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):e.rowPinned==="bottom"?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.paginationProxy.getRow(e.rowIndex)}navigateToNextCell(e,t,s,i){let r=s,n=!1;for(;r&&(r===s||!this.isValidNavigateCell(r));)this.gos.get("enableRtl")?t===U.LEFT&&(r=this.getLastCellOfColSpan(r)):t===U.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextCellToFocus(t,r),n=ot(r);if(n&&e&&e.key===U.UP&&(r={rowIndex:-1,rowPinned:null,column:s.column}),i){const a=this.gos.getCallback("navigateToNextCell");if(ve(a)){const u=a({key:t,previousCellPosition:s,nextCellPosition:r||null,event:e});ve(u)?(u.floating&&(tt("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),u.rowPinned=u.floating),r={rowPinned:u.rowPinned,rowIndex:u.rowIndex,column:u.column}):r=null}}if(!r)return;if(r.rowIndex<0){const a=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+r.rowIndex,column:s.column},event:e||void 0,fromCell:!0});return}const o=this.getNormalisedPosition(r);o?this.focusPosition(o):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t=!1){const s=this.columnModel.getAllDisplayedColumns(),i=this.rowRenderer.getRowByPosition(e);if(!i||!i.isFullWidth())return!1;const r=this.focusService.getFocusedCell(),n={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?Mt(s):s[0])};this.focusPosition(n);const o=r!=null?this.rowPositionUtils.before(n,r):!1,a={type:w.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:n.column,isFullWidthCell:!0,floating:n.rowPinned,fromBelow:o};return this.eventService.dispatchEvent(a),!0}focusPosition(e){var t;this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),(t=this.rangeService)==null||t.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const s=t.getColSpanningList();return s.length===1?e:{rowIndex:e.rowIndex,column:Mt(s),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=this.gos.isGroupRowsSticky(),s=this.rowModel.getRow(e.rowIndex);!(t&&(s==null?void 0:s.sticky))&&ot(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}};f([A("mouseEventService")],hi.prototype,"mouseEventService",2);f([A("paginationProxy")],hi.prototype,"paginationProxy",2);f([A("focusService")],hi.prototype,"focusService",2);f([A("columnModel")],hi.prototype,"columnModel",2);f([A("rowModel")],hi.prototype,"rowModel",2);f([A("ctrlsService")],hi.prototype,"ctrlsService",2);f([A("rowRenderer")],hi.prototype,"rowRenderer",2);f([A("headerNavigationService")],hi.prototype,"headerNavigationService",2);f([A("rowPositionUtils")],hi.prototype,"rowPositionUtils",2);f([A("cellNavigationService")],hi.prototype,"cellNavigationService",2);f([A("pinnedRowModel")],hi.prototype,"pinnedRowModel",2);f([zt("rangeService")],hi.prototype,"rangeService",2);f([xe],hi.prototype,"postConstruct",1);hi=f([Le("navigationService")],hi);var G0=class CN extends zl{constructor(t){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=t}postConstruct(){this.gos.setDomData(this.getGui(),CN.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}addKeyDownListener(){const t=this.getGui(),s=this.params,i=r=>{Df(this.gos,r,s.node,s.column,!0)||s.onKeyDown(r)};this.addManagedListener(t,"keydown",i)}};G0.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper";f([xe],G0.prototype,"postConstruct",1);var yN=G0,TG=class extends at{constructor(t,s,i,r,n){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=t,this.column=s.getColumn(),this.rowNode=s.getRowNode(),this.rowCtrl=s.getRowCtrl(),this.eRow=r,this.cellCtrl=s;const o=document.createElement("div");o.setAttribute("comp-id",`${this.getCompId()}`),this.setTemplateFromElement(o);const a=this.getGui();this.forceWrapper=s.isForceWrapper(),this.refreshWrapper(!1);const l=(p,g)=>{g!=null&&g!=""?a.setAttribute(p,g):a.removeAttribute(p)};fs(a,s.getCellAriaRole()),l("col-id",s.getColumnIdSanitised());const u=s.getTabIndex();u!==void 0&&l("tabindex",u.toString());const h={addOrRemoveCssClass:(p,g)=>this.addOrRemoveCssClass(p,g),setUserStyles:p=>y0(a,p),getFocusableElement:()=>this.getFocusableElement(),setIncludeSelection:p=>this.includeSelection=p,setIncludeRowDrag:p=>this.includeRowDrag=p,setIncludeDndSource:p=>this.includeDndSource=p,setRenderDetails:(p,g,m)=>this.setRenderDetails(p,g,m),setEditDetails:(p,g,m)=>this.setEditDetails(p,g,m),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};s.setComp(h,this.getGui(),this.eCellWrapper,i,n)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(t,s,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const n=this.refreshWrapper(!1);this.refreshEditStyles(!1),t?!(i||n)&&this.refreshCellRenderer(t)||(this.destroyRenderer(),this.createCellRendererInstance(t)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(s))}setEditDetails(t,s,i){t?this.createCellEditorInstance(t,s,i):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(t){const s=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=s||this.forceWrapper,r=i&&this.eCellWrapper==null;if(r){const h=document.createElement("div");h.setAttribute("role","presentation"),h.setAttribute("class","ag-cell-wrapper"),this.eCellWrapper=h,this.getGui().appendChild(this.eCellWrapper)}const n=!i&&this.eCellWrapper!=null;n&&(nn(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!i);const o=!t&&i,a=o&&this.eCellValue==null;if(a){const h=document.createElement("span");h.setAttribute("role","presentation"),h.setAttribute("class","ag-cell-value"),this.eCellValue=h,this.eCellWrapper.appendChild(this.eCellValue)}const l=!o&&this.eCellValue!=null;l&&(nn(this.eCellValue),this.eCellValue=void 0);const u=r||n||a||l;return u&&this.removeControls(),t||s&&this.addControls(),u}addControls(){this.includeRowDrag&&this.rowDraggingComp==null&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&this.dndSourceComp==null&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(t,s,i){const r=this.editorVersion,n=t.newAgStackInstance();if(!n)return;const{params:o}=t;n.then(l=>this.afterCellEditorCreated(r,l,o,s,i)),ot(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(t){const s=this.getParentOfValue();xs(s);const i=t!=null?Ds(t,!0):null;i!=null&&(s.textContent=i)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context:t}=this.beans;this.cellRenderer=t.destroyBean(this.cellRenderer),nn(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:t}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=t.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=t.destroyBean(this.cellEditorPopupWrapper),nn(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(t){if(this.cellRenderer==null||this.cellRenderer.refresh==null||this.cellRendererClass!==t.componentClass)return!1;const s=this.cellRenderer.refresh(t.params);return s===!0||s===void 0}createCellRendererInstance(t){const i=!this.beans.gos.get("suppressAnimationFrame"),r=this.rendererVersion,{componentClass:n}=t,o=()=>{if(this.rendererVersion!==r||!this.isAlive())return;const l=t.newAgStackInstance(),u=this.afterCellRendererCreated.bind(this,r,n);l&&l.then(u)};i&&this.firstRender?this.beans.animationFrameService.createTask(o,this.rowNode.rowIndex,"createTasksP2"):o()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(t,s,i){if(!this.isAlive()||t!==this.rendererVersion){this.beans.context.destroyBean(i);return}if(this.cellRenderer=i,this.cellRendererClass=s,this.cellRendererGui=this.cellRenderer.getGui(),this.cellRendererGui!=null){const n=this.getParentOfValue();xs(n),n.appendChild(this.cellRendererGui)}}afterCellEditorCreated(t,s,i,r,n){if(t!==this.editorVersion){this.beans.context.destroyBean(s);return}if(s.isCancelBeforeStart&&s.isCancelBeforeStart()){this.beans.context.destroyBean(s),this.cellCtrl.stopEditing(!0);return}if(!s.getGui){console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`),this.beans.context.destroyBean(s);return}this.cellEditor=s,this.cellEditorGui=s.getGui();const l=r||s.isPopup!==void 0&&s.isPopup();l?this.addPopupCellEditor(i,n):this.addInCellEditor(),this.refreshEditStyles(!0,l),s.afterGuiAttached&&s.afterGuiAttached()}refreshEditStyles(t,s){var i;this.addOrRemoveCssClass("ag-cell-inline-editing",t&&!s),this.addOrRemoveCssClass("ag-cell-popup-editing",t&&!!s),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!t||!!s),(i=this.rowCtrl)==null||i.setInlineEditingCss(t)}addInCellEditor(){const t=this.getGui();t.contains(this.beans.gos.getActiveDomElement())&&t.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(t,s){this.beans.gos.get("editType")==="fullRow"&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const i=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new yN(t));const r=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&r.appendChild(this.cellEditorGui);const n=this.beans.popupService,o=this.beans.gos.get("stopEditingWhenCellsLoseFocus"),a=s??(i.getPopupPosition?i.getPopupPosition():"over"),l=this.beans.gos.get("enableRtl"),u={ePopup:r,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:a,alignSide:l?"right":"left",keepWithinBounds:!0},h=n.positionPopupByComponent.bind(n,u),p=this.beans.localeService.getLocaleTextFunc(),g=n.addPopup({modal:o,eChild:r,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:h,ariaLabel:p("ariaLabelCellEditor","Cell Editor")});g&&(this.hideEditorPopup=g.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const t=this.getGui();t.contains(this.beans.gos.getActiveDomElement())&&c0()&&t.focus({preventScroll:!0}),xs(this.getParentOfValue())}},DG=class extends at{constructor(t,s,i){super(),this.cellComps={},this.beans=s,this.rowCtrl=t;const r=document.createElement("div");r.setAttribute("comp-id",`${this.getCompId()}`),r.setAttribute("style",this.getInitialStyle(i)),this.setTemplateFromElement(r);const n=this.getGui(),o=n.style;this.domOrder=this.rowCtrl.getDomOrder(),fs(n,"row");const a=this.rowCtrl.getTabIndex();a!=null&&n.setAttribute("tabindex",a.toString());const l={setDomOrder:u=>this.domOrder=u,setCellCtrls:u=>this.setCellCtrls(u),showFullWidth:u=>this.showFullWidth(u),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(u,h)=>this.addOrRemoveCssClass(u,h),setUserStyles:u=>y0(n,u),setTop:u=>o.top=u,setTransform:u=>o.transform=u,setRowIndex:u=>n.setAttribute("row-index",u),setRowId:u=>n.setAttribute("row-id",u),setRowBusinessKey:u=>n.setAttribute("row-business-key",u),refreshFullWidth:u=>this.refreshFullWidth(u)};t.setComp(l,this.getGui(),i),this.addDestroyFunc(()=>{t.unsetComp(i)})}getInitialStyle(t){const s=this.rowCtrl.getInitialTransform(t);return s?`transform: ${s}`:`top: ${this.rowCtrl.getInitialRowTop(t)}`}showFullWidth(t){const s=r=>{if(this.isAlive()){const n=r.getGui();this.getGui().appendChild(n),this.rowCtrl.setupDetailRowAutoHeight(n),this.setFullWidthRowComp(r)}else this.beans.context.destroyBean(r)},i=t.newAgStackInstance();i&&i.then(s)}setCellCtrls(t){const s=Object.assign({},this.cellComps);t.forEach(r=>{const n=r.getInstanceId();this.cellComps[n]==null?this.newCellComp(r):s[n]=null});const i=ha(s).filter(r=>r!=null);this.destroyCells(i),this.ensureDomOrder(t)}ensureDomOrder(t){if(!this.domOrder)return;const s=[];t.forEach(i=>{const r=this.cellComps[i.getInstanceId()];r&&s.push(r.getGui())}),C0(this.getGui(),s)}newCellComp(t){const s=new TG(this.beans,t,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[t.getInstanceId()]=s,this.getGui().appendChild(s.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const t=ha(this.cellComps).filter(s=>s!=null);this.destroyCells(t)}setFullWidthRowComp(t){this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(t){t.forEach(s=>{if(!s)return;const i=s.getCtrl().getInstanceId();this.cellComps[i]===s&&(s.detach(),s.destroy(),this.cellComps[i]=null)})}refreshFullWidth(t){const{fullWidthCellRenderer:s}=this;if(!s||!s.refresh)return!1;const i=t();return s.refresh(i)}};function PG(){const e=at.elementGettingCreated.getAttribute("name"),t=Ff.getRowContainerCssClasses(e);let s;return e==="center"||e==="topCenter"||e==="stickyTopCenter"||e==="bottomCenter"||e==="stickyBottomCenter"?s=`<div class="${t.viewport}" ref="eViewport" role="presentation">
                <div class="${t.container}" ref="eContainer"></div>
            </div>`:s=`<div class="${t.container}" ref="eContainer"></div>`,s}var Ru=class extends at{constructor(){super(PG()),this.rowComps={},this.name=at.elementGettingCreated.getAttribute("name"),this.type=mN(this.name)}postConstruct(){const t={setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>this.eContainer.style.width=i};this.createManagedBean(new Ff(this.name)).setComp(t,this.eContainer,this.eViewport)}preDestroy(){this.setRowCtrls([])}setRowCtrls(t){const s=Xe({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;const i=r=>{const n=r.getInstanceId(),o=s[n];if(o)this.rowComps[n]=o,delete s[n],this.ensureDomOrder(o.getGui());else{if(!r.getRowNode().displayed)return;const a=new DG(r,this.beans,this.type);this.rowComps[n]=a,this.appendRow(a.getGui())}};t.forEach(i),ha(s).forEach(r=>{this.eContainer.removeChild(r.getGui()),r.destroy()}),fs(this.eContainer,"rowgroup")}appendRow(t){this.domOrder?oF(this.eContainer,t,this.lastPlacedElement):this.eContainer.appendChild(t),this.lastPlacedElement=t}ensureDomOrder(t){this.domOrder&&(v0(this.eContainer,t,this.lastPlacedElement),this.lastPlacedElement=t)}};f([A("beans")],Ru.prototype,"beans",2);f([Fe("eViewport")],Ru.prototype,"eViewport",2);f([Fe("eContainer")],Ru.prototype,"eContainer",2);f([xe],Ru.prototype,"postConstruct",1);f([Fi],Ru.prototype,"preDestroy",1);var V0=class{constructor(e){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(s=>{s.isPrimary()&&(s.isAnyFunctionActive()||(s.isAllowValue()?this.columnsToAggregate.push(s):s.isAllowRowGroup()?this.columnsToGroup.push(s):s.isAllowPivot()&&this.columnsToPivot.push(s)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?ut.ICON_PINNED:ut.ICON_MOVE:null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}};f([A("columnModel")],V0.prototype,"columnModel",2);f([A("gridOptionsService")],V0.prototype,"gos",2);var Cl=class{static attemptMoveColumns(e){const{isFromHeader:t,hDirection:s,xPosition:i,fromEnter:r,fakeEvent:n,pinned:o,gos:a,columnModel:l}=e,u=s===0,h=s===1;let{allMovingColumns:p}=e;if(t){let I=[];p.forEach(V=>{var j;let P=null,N=V.getParent();for(;N!=null&&N.getDisplayedLeafColumns().length===1;)P=N,N=N.getParent();P!=null?(!!((j=P.getColGroupDef())!=null&&j.marryChildren)?P.getProvidedColumnGroup().getLeafColumns():P.getLeafColumns()).forEach(M=>{I.includes(M)||I.push(M)}):I.includes(V)||I.push(V)}),p=I}const g=p.slice();l.sortColumnsLikeGridColumns(g);const m=this.calculateValidMoves({movingCols:g,draggingRight:h,xPosition:i,pinned:o,gos:a,columnModel:l}),C=this.calculateOldIndex(g,l);if(m.length===0)return;const y=m[0];let R=C!==null&&!r;if(t&&(R=C!==null),R&&!n&&(u&&y>=C||h&&y<=C))return;const x=l.getAllDisplayedColumns();let S=[],T=null;for(let I=0;I<m.length;I++){const V=m[I],j=l.getProposedColumnOrder(g,V);if(!l.doesOrderPassRules(j))continue;const P=j.filter(_=>x.includes(_));if(T===null)T=P;else if(!Fn(P,T))break;const N=this.groupFragCount(j);S.push({move:V,fragCount:N})}if(S.length!==0)return S.sort((I,V)=>I.fragCount-V.fragCount),this.moveColumns(p,S[0].move,"uiColumnMoved",!1,l)}static moveColumns(e,t,s,i,r){return r.moveColumns(e,t,s,i),i?null:{columns:e,toIndex:t}}static calculateOldIndex(e,t){const s=t.getAllGridColumns(),i=yA(e.map(l=>s.indexOf(l))),r=i[0];return Mt(i)-r!==i.length-1?null:r}static groupFragCount(e){function t(i){let r=[],n=i.getOriginalParent();for(;n!=null;)r.push(n),n=n.getOriginalParent();return r}let s=0;for(let i=0;i<e.length-1;i++){let r=t(e[i]),n=t(e[i+1]);[r,n]=r.length>n.length?[r,n]:[n,r],r.forEach(o=>{n.indexOf(o)===-1&&s++})}return s}static getDisplayedColumns(e,t){switch(t){case"left":return e.getDisplayedLeftColumns();case"right":return e.getDisplayedRightColumns();default:return e.getDisplayedCenterColumns()}}static calculateValidMoves(e){const{movingCols:t,draggingRight:s,xPosition:i,pinned:r,gos:n,columnModel:o}=e;if(n.get("suppressMovableColumns")||t.some(S=>S.getColDef().suppressMovable))return[];const l=this.getDisplayedColumns(o,r),u=o.getAllGridColumns(),h=l.filter(S=>pr(t,S)),p=l.filter(S=>!pr(t,S)),g=u.filter(S=>!pr(t,S));let m=0,C=i;if(s){let S=0;h.forEach(T=>S+=T.getActualWidth()),C-=S}if(C>0){for(let S=0;S<p.length;S++){const T=p[S];if(C-=T.getActualWidth(),C<0)break;m++}s&&m++}let y;if(m>0){const S=p[m-1];y=g.indexOf(S)+1}else y=g.indexOf(p[0]),y===-1&&(y=0);const R=[y],x=(S,T)=>S-T;if(s){let S=y+1;const T=u.length-1;for(;S<=T;)R.push(S),S++;R.sort(x)}else{let S=y;const T=u.length-1;let I=u[S];for(;S<=T&&l.indexOf(I)<0;)S++,R.push(S),I=u[S];S=y-1;const V=0;for(;S>=V;)R.push(S),S--;R.sort(x).reverse()}return R}static normaliseX(e,t,s,i,r){const n=r.getHeaderRowContainerCtrl(t).getViewport();return s&&(e-=n.getBoundingClientRect().left),i.get("enableRtl")&&(e=n.clientWidth-e),t==null&&(e+=r.get("center").getCenterViewportScrollLeft()),e}},Tu=class{constructor(e){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.isCenterContainer=!ve(e)}init(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){return this.pinned?ut.ICON_PINNED:ut.ICON_MOVE}onDragEnter(e){const t=e.dragItem.columns;if(e.dragSource.type===0)this.setColumnsVisible(t,!0,"uiColumnDragged");else{const i=e.dragItem.visibleState,r=(t||[]).filter(n=>i[n.getId()]);this.setColumnsVisible(r,!0,"uiColumnDragged")}this.setColumnsPinned(t,this.pinned,"uiColumnDragged"),this.onDragging(e,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,s){if(e){const i=e.filter(r=>!r.getColDef().lockVisible);this.columnModel.setColumnsVisible(i,t,s)}}setColumnsPinned(e,t,s){if(e){const i=e.filter(r=>!r.getColDef().lockPinned);this.columnModel.setColumnsPinned(i,t,s)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}checkCenterForScrolling(e){if(this.isCenterContainer){const t=this.ctrlsService.get("center"),s=t.getCenterViewportScrollLeft(),i=s+t.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=e<s+50,this.needToMoveLeft=e>i-50):(this.needToMoveLeft=e<s+50,this.needToMoveRight=e>i-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(e=this.lastDraggingEvent,t=!1,s=!1,i=!1){var r;if(i){if(this.lastMovedInfo){const{columns:h,toIndex:p}=this.lastMovedInfo;Cl.moveColumns(h,p,"uiColumnMoved",!0,this.columnModel)}return}if(this.lastDraggingEvent=e,ot(e.hDirection))return;const n=Cl.normaliseX(e.x,this.pinned,!1,this.gos,this.ctrlsService);t||this.checkCenterForScrolling(n);const o=this.normaliseDirection(e.hDirection),a=e.dragSource.type,l=((r=e.dragSource.getDragItem().columns)==null?void 0:r.filter(h=>h.getColDef().lockPinned?h.getPinned()==this.pinned:!0))||[],u=Cl.attemptMoveColumns({allMovingColumns:l,isFromHeader:a===1,hDirection:o,xPosition:n,pinned:this.pinned,fromEnter:t,fakeEvent:s,gos:this.gos,columnModel:this.columnModel});u&&(this.lastMovedInfo=u)}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case 0:return 1;case 1:return 0;default:console.error(`AG Grid: Unknown direction ${e}`)}else return e}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(ut.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(ut.ICON_RIGHT,!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(ut.ICON_MOVE))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*5,e>100&&(e=100);let t=null;const s=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=s.scrollHorizontally(-e):this.needToMoveRight&&(t=s.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const r=this.lastDraggingEvent.dragItem.columns.filter(n=>!n.getColDef().lockPinned);if(r.length>0&&(this.dragAndDropService.setGhostIcon(ut.ICON_PINNED),this.failedMoveAttempts>7)){const n=this.needToMoveLeft?"left":"right";this.setColumnsPinned(r,n,"uiColumnDragged"),this.dragAndDropService.nudge()}}}};f([A("columnModel")],Tu.prototype,"columnModel",2);f([A("dragAndDropService")],Tu.prototype,"dragAndDropService",2);f([A("gridOptionsService")],Tu.prototype,"gos",2);f([A("ctrlsService")],Tu.prototype,"ctrlsService",2);f([xe],Tu.prototype,"init",1);var Du=class extends Se{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.left.getContainerElement()],[e.bottomLeft.getContainerElement()],[e.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.right.getContainerElement()],[e.bottomRight.getContainerElement()],[e.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.center.getViewportElement()],[e.bottomCenter.getViewportElement()],[e.topCenter.getViewportElement()]];break}})}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}init(){this.moveColumnFeature=this.createManagedBean(new Tu(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new V0(this.pinned)),this.dragAndDropService.addDropTarget(this)}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}};f([A("dragAndDropService")],Du.prototype,"dragAndDropService",2);f([A("columnModel")],Du.prototype,"columnModel",2);f([A("ctrlsService")],Du.prototype,"ctrlsService",2);f([xe],Du.prototype,"postConstruct",1);f([xe],Du.prototype,"init",1);var Pu=class wN extends M0{constructor(t){super(wN.TEMPLATE,t),this.headerCompVersion=0,this.column=t.getColumnGroupChild(),this.pinned=t.getPinned()}postConstruct(){const t=this.getGui();((n,o)=>{o!=null&&o!=""?t.setAttribute(n,o):t.removeAttribute(n)})("col-id",this.column.getColId());const i={setWidth:n=>t.style.width=n,addOrRemoveCssClass:(n,o)=>this.addOrRemoveCssClass(n,o),setAriaSort:n=>n?$A(t,n):KA(t),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper);const r=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",r)}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(t){this.headerCompVersion++;const s=this.headerCompVersion;t.newAgStackInstance().then(i=>this.afterCompCreated(s,i))}afterCompCreated(t,s){if(t!=this.headerCompVersion||!this.isAlive()){this.destroyBean(s);return}this.destroyHeaderComp(),this.headerComp=s,this.headerCompGui=s.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}};Pu.TEMPLATE=`<div class="ag-header-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>
        </div>`;f([Fe("eResize")],Pu.prototype,"eResize",2);f([Fe("eHeaderCompWrapper")],Pu.prototype,"eHeaderCompWrapper",2);f([xe],Pu.prototype,"postConstruct",1);f([Fi],Pu.prototype,"destroyHeaderComp",1);var AG=Pu,rv=class SN extends M0{constructor(t){super(SN.TEMPLATE,t)}postConstruct(){const t=this.getGui(),s=(r,n)=>n!=null?t.setAttribute(r,n):t.removeAttribute(r);t.setAttribute("col-id",this.ctrl.getColId());const i={addOrRemoveCssClass:(r,n)=>this.addOrRemoveCssClass(r,n),setResizableDisplayed:r=>Dt(this.eResize,r),setWidth:r=>t.style.width=r,setAriaExpanded:r=>s("aria-expanded",r),setUserCompDetails:r=>this.setUserCompDetails(r),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,t,this.eResize)}setUserCompDetails(t){t.newAgStackInstance().then(s=>this.afterHeaderCompCreated(s))}afterHeaderCompCreated(t){const s=()=>this.destroyBean(t);if(!this.isAlive()){s();return}const i=this.getGui(),r=t.getGui();i.appendChild(r),this.addDestroyFunc(s),this.headerGroupComp=t,this.ctrl.setDragSource(i)}};rv.TEMPLATE=`<div class="ag-header-group-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
        </div>`;f([Fe("eResize")],rv.prototype,"eResize",2);f([xe],rv.prototype,"postConstruct",1);var FG=rv,ow=(e=>(e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter",e))(ow||{}),B0=class extends at{constructor(t){super(),this.headerComps={},this.ctrl=t,this.setTemplate(`<div class="${this.ctrl.getHeaderRowClass()}" role="row"></div>`)}init(){i0(this.getGui(),this.ctrl.getAriaRowIndex());const t={setHeight:s=>this.getGui().style.height=s,setTop:s=>this.getGui().style.top=s,setHeaderCtrls:(s,i)=>this.setHeaderCtrls(s,i),setWidth:s=>this.getGui().style.width=s};this.ctrl.setComp(t)}destroyHeaderCtrls(){this.setHeaderCtrls([],!1)}setHeaderCtrls(t,s){if(!this.isAlive())return;const i=this.headerComps;if(this.headerComps={},t.forEach(r=>{const n=r.getInstanceId();let o=i[n];delete i[n],o==null&&(o=this.createHeaderComp(r),this.getGui().appendChild(o.getGui())),this.headerComps[n]=o}),ui(i,(r,n)=>{this.getGui().removeChild(n.getGui()),this.destroyBean(n)}),s){const r=ha(this.headerComps);r.sort((o,a)=>{const l=o.getCtrl().getColumnGroupChild().getLeft(),u=a.getCtrl().getColumnGroupChild().getLeft();return l-u});const n=r.map(o=>o.getGui());C0(this.getGui(),n)}}createHeaderComp(t){let s;switch(this.ctrl.getType()){case"group":s=new FG(t);break;case"filter":s=new YO(t);break;default:s=new AG(t);break}return this.createBean(s),s.setParentComponent(this),s}};f([xe],B0.prototype,"init",1);f([Fi],B0.prototype,"destroyHeaderCtrls",1);var NG=0,bo=class xN extends Se{constructor(t,s,i){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=t,this.parentRowCtrl=i,this.beans=s,this.instanceId=t.getUniqueId()+"-"+NG++}postConstruct(){this.addManagedPropertyListeners(["suppressHeaderFocus"],()=>this.refreshTabIndex())}shouldStopEventPropagation(t){const{headerRowIndex:s,column:i}=this.focusService.getFocusedHeader();return mF(this.gos,t,s,i)}getWrapperHasFocus(){return this.gos.getActiveDomElement()===this.eGui}setGui(t){this.eGui=t,this.addDomData(),this.addManagedListener(this.beans.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onDisplayedColumnsChanged(){!this.comp||!this.column||(this.refreshFirstAndLastStyles(),this.refreshAriaColIndex())}refreshFirstAndLastStyles(){const{comp:t,column:s,beans:i}=this;tv.refreshFirstAndLastStyles(t,s,i.columnModel)}refreshAriaColIndex(){const{beans:t,column:s}=this,i=t.columnModel.getAriaColumnIndex(s);r0(this.eGui,i)}addResizeAndMoveKeyboardListeners(){this.resizeFeature&&(this.addManagedListener(this.eGui,"keydown",this.onGuiKeyDown.bind(this)),this.addManagedListener(this.eGui,"keyup",this.onGuiKeyUp.bind(this)))}refreshTabIndex(){this.gos.get("suppressHeaderFocus")?this.eGui.removeAttribute("tabindex"):this.eGui.setAttribute("tabindex","-1")}onGuiKeyDown(t){var s;const i=this.gos.getActiveDomElement(),r=t.key===U.LEFT||t.key===U.RIGHT;if(this.isResizing&&(t.preventDefault(),t.stopImmediatePropagation()),i!==this.eGui||!t.shiftKey&&!t.altKey||((this.isResizing||r)&&(t.preventDefault(),t.stopImmediatePropagation()),!r))return;const n=t.key===U.LEFT!==this.gos.get("enableRtl"),o=KF[n?"Left":"Right"];if(t.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const a=this.getViewportAdjustedResizeDiff(t);this.resizeHeader(a,t.shiftKey),(s=this.resizeFeature)==null||s.toggleColumnResizing(!0)}else this.moveHeader(o)}getViewportAdjustedResizeDiff(t){let s=this.getResizeDiff(t);if(this.column.getPinned()){const r=this.pinnedWidthService.getPinnedLeftWidth(),n=this.pinnedWidthService.getPinnedRightWidth(),o=Hl(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(r+n+s>o)if(o>r+n)s=o-r-n;else return 0}return s}getResizeDiff(t){let s=t.key===U.LEFT!==this.gos.get("enableRtl");const i=this.column.getPinned(),r=this.gos.get("enableRtl");return i&&r!==(i==="right")&&(s=!s),(s?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=setTimeout(()=>{var t;(t=this.resizeFeature)==null||t.toggleColumnResizing(!1)},150))}handleKeyDown(t){const s=this.getWrapperHasFocus();switch(t.key){case U.PAGE_DOWN:case U.PAGE_UP:case U.PAGE_HOME:case U.PAGE_END:s&&t.preventDefault()}}addDomData(){const t=xN.DOM_DATA_KEY_HEADER_CTRL;this.gos.setDomData(this.eGui,t,this),this.addDestroyFunc(()=>this.gos.setDomData(this.eGui,t,null))}getGui(){return this.eGui}focus(t){return this.eGui?(this.lastFocusEvent=t||null,this.eGui.focus(),!0):!1}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(t,s,i){const r=t??s;this.gos.get("preventDefaultOnContextMenu")&&r.preventDefault();const n=i instanceof Kt?i:void 0;this.menuService.isHeaderContextMenuEnabled(n)&&this.menuService.showHeaderContextMenu(n,t,s),this.dispatchColumnMouseEvent(w.EVENT_COLUMN_HEADER_CONTEXT_MENU,i)}dispatchColumnMouseEvent(t,s){const i={type:t,column:s};this.eventService.dispatchEvent(i)}destroy(){super.destroy(),this.removeDragSource(),this.comp=null,this.column=null,this.resizeFeature=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null,this.eGui=null}};bo.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";f([A("pinnedWidthService")],bo.prototype,"pinnedWidthService",2);f([A("focusService")],bo.prototype,"focusService",2);f([A("userComponentFactory")],bo.prototype,"userComponentFactory",2);f([A("ctrlsService")],bo.prototype,"ctrlsService",2);f([A("dragAndDropService")],bo.prototype,"dragAndDropService",2);f([A("menuService")],bo.prototype,"menuService",2);f([xe],bo.prototype,"postConstruct",1);var nv=bo,ov=class extends Se{constructor(e,t,s,i){super(),this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=i,this.beans=s}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?Mt(this.colsSpanning):this.columnOrGroup}postConstruct(){this.addManagedListener(this.columnOrGroup,Kt.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}setLeftFirstTime(){const e=this.beans.gos.get("suppressColumnMoveAnimation"),t=ve(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),s=e.getOldLeft(),i=this.modifyLeftForPrintLayout(e,s),r=this.modifyLeftForPrintLayout(e,t);this.setLeft(i),this.actualLeft=r,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!this.beans.gos.isDomLayout("print")||e.getPinned()==="left")return t;const i=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(e.getPinned()==="right"){const r=this.beans.columnModel.getBodyContainerWidth();return i+r+t}return i+t}setLeft(e){if(ve(e)&&(this.eCell.style.left=`${e}px`),this.columnOrGroup instanceof Kt)this.columnOrGroup;else{const s=this.columnOrGroup.getLeafColumns();if(!s.length)return;s.length>1&&UA(this.ariaEl,s.length),s[0]}}};f([xe],ov.prototype,"postConstruct",1);var xp=class extends Se{constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}};f([A("columnHoverService")],xp.prototype,"columnHoverService",2);f([xe],xp.prototype,"postConstruct",1);var IG=class extends nv{constructor(e,t,s){super(e,t,s),this.iconCreated=!1,this.column=e}setComp(e,t,s,i){this.comp=e,this.eButtonShowMainFilter=s,this.eFloatingFilterBody=i,this.setGui(t),this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,Kt.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}resizeHeader(){}moveHeader(){}setupActive(){const e=this.column.getColDef(),t=!!e.filter,s=!!e.floatingFilter;this.active=t&&s}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=cs("filter",this.gos,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(){this.createManagedBean(new Ea(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();fr(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(this.gos.getActiveDomElement()===this.eGui)return;const i=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(i){this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),i.focus();return}const r=this.findNextColumnWithFloatingFilter(e.shiftKey);r&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:r},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.columnModel;let s=this.column;do if(s=e?t.getDisplayedColBefore(s):t.getDisplayedColAfter(s),!s)break;while(!s.getColDef().filter||!s.getColDef().floatingFilter);return s}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case U.UP:case U.DOWN:t||e.preventDefault();case U.LEFT:case U.RIGHT:if(t)return;e.stopPropagation();case U.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case U.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const s=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&gl(e.relatedTarget,"ag-floating-filter");if(s&&i&&e.target===this.eGui){const n=this.lastFocusEvent,o=!!(n&&n.key===U.TAB);if(n&&o){const a=n.shiftKey;this.focusService.focusInto(this.eGui,a)}}const r=this.getRowIndex();this.beans.focusService.setFocusedHeader(r,this.column)}setupHover(){this.createManagedBean(new xp([this.column],this.eGui));const e=()=>{if(!this.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",t)};this.addManagedListener(this.eventService,w.EVENT_COLUMN_HOVER_CHANGED,e),e()}setupLeft(){const e=new ov(this.column,this.eGui,this.beans);this.createManagedBean(e)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(){if(!this.active)return;const{filterManager:e}=this.beans,t=s=>{if((s==null?void 0:s.source)==="filterDestroyed"&&this.context.isDestroyed())return;const i=this.comp.getFloatingFilterComp();i&&i.then(r=>{var n;if(r){const o=e.getCurrentFloatingFilterParentModel(this.column);r.onParentModelChanged(o,s?this.gos.addGridCommonParams({columns:(n=s.columns)!=null?n:[],type:w.EVENT_FILTER_CHANGED,source:s.source==="api"?"api":"columnFilter"}):null)}})};this.destroySyncListener=this.addManagedListener(this.column,Kt.EVENT_FILTER_CHANGED,t),e.isFilterActive(this.column)&&t(null)}setupWidth(){const e=()=>{const t=`${this.column.getActualWidth()}px`;this.comp.setWidth(t)};this.addManagedListener(this.column,Kt.EVENT_WIDTH_CHANGED,e),e()}setupFilterChangedListener(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,Kt.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=this.beans.filterManager.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(){var e,t;const s=this.active;this.setupActive();const i=!s&&this.active;s&&!this.active&&((e=this.destroySyncListener)==null||e.call(this),(t=this.destroyFilterChangedListener)==null||t.call(this));const r=this.active?this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,n=this.comp.getFloatingFilterComp();!n||!r?this.updateCompDetails(r,i):n.then(o=>{var a;!o||this.beans.filterManager.areFilterCompsDifferent((a=this.userCompDetails)!=null?a:null,r)?this.updateCompDetails(r,i):this.updateFloatingFilterParams(r)})}updateCompDetails(e,t){this.isAlive()&&(this.setCompDetails(e),this.setupFilterButton(),this.setupUi(),t&&(this.setupSyncWithFilter(),this.setupFilterChangedListener()))}updateFloatingFilterParams(e){var t;if(!e)return;const s=e.params;(t=this.comp.getFloatingFilterComp())==null||t.then(i=>{let r=!1;i!=null&&i.refresh&&typeof i.refresh=="function"&&i.refresh(s)!==null&&(r=!0),!r&&(i!=null&&i.onParamsUpdated)&&typeof i.onParamsUpdated=="function"&&i.onParamsUpdated(s)!==null&&tt("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")})}destroy(){super.destroy(),this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.destroySyncListener=null,this.destroyFilterChangedListener=null}},Au=class extends Se{constructor(e,t,s,i,r){super(),this.pinned=e,this.column=t,this.eResize=s,this.comp=i,this.ctrl=r}postConstruct(){const e=[];let t,s;const i=()=>{if(Dt(this.eResize,t),!t)return;const o=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(e.push(o),s){const a=this.gos.get("skipHeaderOnAutoSize"),l=()=>{this.columnModel.autoSizeColumn(this.column,"uiColumnResized",a)};this.eResize.addEventListener("dblclick",l);const u=new Ws(this.eResize);u.addEventListener(Ws.EVENT_DOUBLE_TAP,l),e.push(()=>{this.eResize.removeEventListener("dblclick",l),u.removeEventListener(Ws.EVENT_DOUBLE_TAP,l),u.destroy()})}},r=()=>{e.forEach(o=>o()),e.length=0},n=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==s)&&(t=o,s=a,r(),i())};n(),this.addDestroyFunc(r),this.ctrl.addRefreshFunction(n)}onResizing(e,t){const{column:s,lastResizeAmount:i,resizeStartWidth:r}=this,n=this.normaliseResizeAmount(t),o=r+n,a=[{key:s,newWidth:o}];if(this.column.getPinned()){const l=this.pinnedWidthService.getPinnedLeftWidth(),u=this.pinnedWidthService.getPinnedRightWidth(),h=Hl(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(l+u+(n-i)>h)return}this.lastResizeAmount=n,this.columnModel.setColumnWidths(a,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const s=this.pinned!=="left",i=this.pinned==="right";return this.gos.get("enableRtl")?s&&(t*=-1):i&&(t*=-1),t}};f([A("horizontalResizeService")],Au.prototype,"horizontalResizeService",2);f([A("pinnedWidthService")],Au.prototype,"pinnedWidthService",2);f([A("ctrlsService")],Au.prototype,"ctrlsService",2);f([A("columnModel")],Au.prototype,"columnModel",2);f([xe],Au.prototype,"postConstruct",1);var H0=class extends Se{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(this.gos.getActiveDomElement())&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new Ym),this.cbSelectAll.addCssClass("ag-header-select-all"),fs(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,w.EVENT_FIELD_VALUE_CHANGED,this.onCbSelectAll.bind(this)),hp(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(e);const t=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),s=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),i=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${i} (${s})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${i} (${s})`),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(e){return this.gos.get("rowSelection")==="multiple"?!0:(console.warn(`AG Grid: ${e} is only available if using 'multiple' rowSelection.`),!1)}checkRightRowModelType(e){const t=this.rowModel.getType();return t==="clientSide"||t==="serverSide"?!0:(console.warn(`AG Grid: ${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.isFilteredOnly(),s=this.isCurrentPageOnly();let i="uiSelectAll";s?i="uiSelectAllCurrentPage":t&&(i="uiSelectAllFiltered");const r={source:i,justFiltered:t,justCurrentPage:s};e?this.selectionService.selectAllRowNodes(r):this.selectionService.deselectAllRowNodes(r)}isCheckboxSelection(){let e=this.column.getColDef().headerCheckboxSelection;if(typeof e=="function"){const t=e,s=this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()});e=t(s)}return e?this.checkRightRowModelType("headerCheckboxSelection")&&this.checkSelectionType("headerCheckboxSelection"):!1}isFilteredOnly(){return!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){return!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}};f([A("rowModel")],H0.prototype,"rowModel",2);f([A("selectionService")],H0.prototype,"selectionService",2);var _G=class extends nv{constructor(e,t,s){super(e,t,s),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,s,i){this.comp=e,this.setGui(t),this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(i),this.addColumnHoverListener(),this.setupFilterClass(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.resizeFeature=this.createManagedBean(new Au(this.getPinned(),this.column,s,e,this)),this.createManagedBean(new xp([this.column],t)),this.createManagedBean(new ov(this.column,t,this.beans)),this.createManagedBean(new Ea(t,{shouldStopEventPropagation:r=>this.shouldStopEventPropagation(r),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(),this.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],this.refresh.bind(this)),this.addManagedListener(this.column,Kt.EVENT_COL_DEF_CHANGED,this.refresh.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}resizeHeader(e,t){var s,i;if(!this.column.isResizable())return;const r=this.column.getActualWidth(),n=(s=this.column.getMinWidth())!=null?s:0,o=(i=this.column.getMaxWidth())!=null?i:Number.MAX_SAFE_INTEGER,a=Math.min(Math.max(r+e,n),o);this.beans.columnModel.setColumnWidths([{key:this.column,newWidth:a}],t,!0,"uiColumnResized")}moveHeader(e){const{eGui:t,column:s,gos:i,ctrlsService:r}=this,n=this.getPinned(),o=t.getBoundingClientRect().left,a=s.getActualWidth(),l=i.get("enableRtl"),u=e===0!==l,h=Cl.normaliseX(u?o-20:o+a+20,n,!0,i,r);Cl.attemptMoveColumns({allMovingColumns:[s],isFromHeader:!0,hDirection:e,xPosition:h,pinned:n,fromEnter:!1,fakeEvent:!1,gos:i,columnModel:this.beans.columnModel}),r.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(s,"auto")}setupUserComp(){const e=this.lookupUserCompDetails();this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(t,e)}createParams(){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:t=>{this.menuService.showColumnMenu({column:this.column,buttonElement:t,positionBy:"button"})},showColumnMenuAfterMouseClick:t=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:t,positionBy:"mouse"})},showFilter:t=>{this.menuService.showFilterMenu({column:this.column,buttonElement:t,containerType:"columnFilter",positionBy:"button"})},progressSort:t=>{this.beans.sortController.progressSort(this.column,!!t,"uiColumnSorted")},setSort:(t,s)=>{this.beans.sortController.setSortForColumn(this.column,t,!!s,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(t,s)=>{this.setupTooltip(t,s)}})}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new H0(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===U.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===U.ENTER&&this.onEnterKeyDown(e),e.key===U.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const t=e.shiftKey;this.beans.sortController.progressSort(this.column,t,"uiColumnSorted")}}showMenuOnKeyPress(e,t){const s=this.comp.getUserCompInstance();!s||!(s instanceof sw)||s.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const t=this.getRowIndex();this.focusService.setFocusedHeader(t,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const s=this.gos.get("tooltipShowMode")==="whenTruncated",i=this.eGui,r=this.column.getColDef();!t&&s&&!r.headerComponent&&(t=()=>{const a=i.querySelector(".ag-header-cell-text");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>i,getLocation:()=>"header",getTooltipValue:()=>e??this.column.getColDef().headerTooltip,shouldDisplayTooltip:t},o=this.createManagedBean(new wo(n));this.refreshFunctions.push(()=>o.refreshToolTip())}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),s=tv.getHeaderClassesFromColDef(t,this.gos,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(s),s.forEach(r=>{i.has(r)?i.delete(r):this.comp.addOrRemoveCssClass(r,!0)}),i.forEach(r=>this.comp.addOrRemoveCssClass(r,!1))};this.refreshFunctions.push(e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e||!this.draggable)return;const{column:t,beans:s,displayName:i,dragAndDropService:r,gos:n}=this,{columnModel:o}=s;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>a?ut.ICON_HIDE:ut.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),t.setMoving(!0,"uiColumnMoved")},onDragStopped:()=>t.setMoving(!1,"uiColumnMoved"),onGridEnter:u=>{var h;if(a){const p=((h=u==null?void 0:u.columns)==null?void 0:h.filter(g=>!g.getColDef().lockVisible))||[];o.setColumnsVisible(p,!0,"uiColumnMoved")}},onGridExit:u=>{var h;if(a){const p=((h=u==null?void 0:u.columns)==null?void 0:h.filter(g=>!g.getColDef().lockVisible))||[];o.setColumnsVisible(p,!1,"uiColumnMoved")}}};r.addDragSource(l,!0)}createDragItem(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(e){this.refreshFunctions.push(e)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(e=>e())}refreshHeaderComp(){const e=this.lookupUserCompDetails();(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.columnModel.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const e=()=>{const t=this.column.getActualWidth();this.comp.setWidth(`${t}px`)};this.addManagedListener(this.column,Kt.EVENT_WIDTH_CHANGED,e),e()}setupMovingCss(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};this.addManagedListener(this.column,Kt.EVENT_MOVING_CHANGED,e),e()}setupMenuClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};this.addManagedListener(this.column,Kt.EVENT_MENU_VISIBLE_CHANGED,e),e()}setupSortableClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};e(),this.addRefreshFunction(e),this.addManagedListener(this.eventService,Kt.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}setupFilterClass(){const e=()=>{const t=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",t),this.refreshAria()};this.addManagedListener(this.column,Kt.EVENT_FILTER_ACTIVE_CHANGED,e),e()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};e(),this.addRefreshFunction(e)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:s,beans:i}=this;if(!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),s.addOrRemoveCssClass("ag-header-span-height",!1),s.addOrRemoveCssClass("ag-header-span-total",!1);return}const{numberOfParents:r,isSpanningTotal:n}=this.column.getColumnGroupPaddingInfo();s.addOrRemoveCssClass("ag-header-span-height",r>0);const{columnModel:o}=i,a=o.getColumnHeaderRowHeight();if(r===0){s.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${a}px`);return}s.addOrRemoveCssClass("ag-header-span-total",n);const u=o.isPivotMode()?o.getPivotGroupHeaderHeight():o.getGroupHeaderHeight(),h=r*u;e.style.setProperty("top",`${-h}px`),e.style.setProperty("height",`${a+h}px`)}setupAutoHeight(e){const{columnModel:t,resizeObserverService:s}=this.beans,i=u=>{if(!this.isAlive())return;const{paddingTop:h,paddingBottom:p,borderBottomWidth:g,borderTopWidth:m}=ba(this.getGui()),C=h+p+g+m,R=e.offsetHeight+C;if(u<5){const x=this.beans.gos.getDocument(),S=!x||!x.contains(e),T=R==0;if(S||T){window.setTimeout(()=>i(u+1),0);return}}t.setColumnHeaderHeight(this.column,R)};let r=!1,n;const o=()=>{const u=this.column.isAutoHeaderHeight();u&&!r&&a(),!u&&r&&l()},a=()=>{r=!0,i(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),n=s.observeResize(e,()=>i(0))},l=()=>{r=!1,n&&n(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),n=void 0};o(),this.addDestroyFunc(()=>l()),this.addManagedListener(this.column,Kt.EVENT_WIDTH_CHANGED,()=>r&&i(0)),this.addManagedListener(this.eventService,Kt.EVENT_SORT_CHANGED,()=>{r&&window.setTimeout(()=>i(0))}),this.addRefreshFunction(o)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(MA(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(this.beans.gos.getActiveDomElement()))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,s)=>t==="filter"?-1:s.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnouncementService.announceValue(e)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(){const e=()=>{if(!this.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",t)};this.addManagedListener(this.eventService,w.EVENT_COLUMN_HOVER_CHANGED,e),e()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(){const e=i=>this.handleMouseOverChange(i.type==="mouseenter"),t=()=>this.dispatchColumnMouseEvent(w.EVENT_COLUMN_HEADER_CLICKED,this.column),s=i=>this.handleContextMenuMouseEvent(i,void 0,this.column);this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e),this.addManagedListener(this.getGui(),"click",t),this.addManagedListener(this.getGui(),"contextmenu",s)}handleMouseOverChange(e){this.setActiveHeader(e);const s={type:e?w.EVENT_COLUMN_HEADER_MOUSE_OVER:w.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column};this.eventService.dispatchEvent(s)}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return t instanceof sw?t.getAnchorElementForMenu(e):this.getGui()}destroy(){super.destroy(),this.refreshFunctions=null,this.selectAllFeature=null,this.dragSourceElement=null,this.userCompDetails=null,this.userHeaderClasses=null,this.ariaDescriptionProperties=null}},bp=class extends Se{constructor(e,t,s,i){super(),this.eResize=t,this.comp=e,this.pinned=s,this.columnGroup=i}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gos.get("suppressAutoSize")){const t=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const s=[];this.columnGroup.getDisplayedLeafColumns().forEach(r=>{r.getColDef().suppressAutoSize||s.push(r.getColId())}),s.length>0&&this.columnModel.autoSizeColumns({columns:s,skipHeader:t,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(e){const t=this.getInitialValues(e);this.storeLocalValues(t),this.toggleColumnResizing(!0)}onResizing(e,t,s="uiColumnResized"){const i=this.normaliseDragChange(t),r=this.resizeStartWidth+i;this.resizeColumnsFromLocalValues(r,s,e)}getInitialValues(e){const t=this.getColumnsToResize(),s=this.getInitialSizeOfColumns(t),i=this.getSizeRatiosOfColumns(t,s),r={columnsToResize:t,resizeStartWidth:s,resizeRatios:i};let n=null;if(e&&(n=this.columnModel.getDisplayedGroupAtDirection(this.columnGroup,"After")),n){const o=n.getDisplayedLeafColumns(),a=r.groupAfterColumns=o.filter(u=>u.isResizable()),l=r.groupAfterStartWidth=this.getInitialSizeOfColumns(a);r.groupAfterRatios=this.getSizeRatiosOfColumns(a,l)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}storeLocalValues(e){const{columnsToResize:t,resizeStartWidth:s,resizeRatios:i,groupAfterColumns:r,groupAfterStartWidth:n,groupAfterRatios:o}=e;this.resizeCols=t,this.resizeStartWidth=s,this.resizeRatios=i,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=n,this.resizeTakeFromRatios=o}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),s=this.getInitialValues();t>s.resizeStartWidth&&this.resizeColumns(s,t,e,!0)}resizeColumnsFromLocalValues(e,t,s=!0){var i,r,n;if(!this.resizeCols||!this.resizeRatios)return;const o={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:(i=this.resizeTakeFromCols)!=null?i:void 0,groupAfterStartWidth:(r=this.resizeTakeFromStartWidth)!=null?r:void 0,groupAfterRatios:(n=this.resizeTakeFromRatios)!=null?n:void 0};this.resizeColumns(o,e,t,s)}resizeColumns(e,t,s,i=!0){const{columnsToResize:r,resizeStartWidth:n,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:u}=e,h=[];if(h.push({columns:r,ratios:o,width:t}),a){const p=t-n;h.push({columns:a,ratios:u,width:l-p})}this.columnModel.resizeColumnSets({resizeSets:h,finished:i,source:s}),i&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}getInitialSizeOfColumns(e){return e.reduce((t,s)=>t+s.getActualWidth(),0)}getSizeRatiosOfColumns(e,t){return e.map(s=>s.getActualWidth()/t)}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.clearLocalValues()}};f([A("horizontalResizeService")],bp.prototype,"horizontalResizeService",2);f([A("autoWidthCalculator")],bp.prototype,"autoWidthCalculator",2);f([A("columnModel")],bp.prototype,"columnModel",2);f([xe],bp.prototype,"postConstruct",1);var bN=class extends Se{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,Ls.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.addEventListener("widthChanged",e),t.addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.removeEventListener("widthChanged",e),t.removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",e===0)}};f([xe],bN.prototype,"postConstruct",1);var kG=class extends nv{constructor(e,t,s){super(e,t,s),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const i=this.getGui();this.setDragSource(i)}},this.column=e}setComp(e,t,s){this.comp=e,this.setGui(t),this.displayName=this.beans.columnModel.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.addDestroyFunc(()=>{this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature))}),this.setupUserComp(),this.addHeaderMouseListeners();const i=this.getParentRowCtrl().getPinned(),r=this.column.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new xp(r,t)),this.createManagedBean(new ov(this.column,t,this.beans)),this.createManagedBean(new bN(e,this.column)),this.resizeFeature=this.createManagedBean(new bp(e,s,i,this.column)),this.createManagedBean(new Ea(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addManagedPropertyListener(w.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners()}resizeHeader(e,t){if(!this.resizeFeature)return;const s=this.resizeFeature.getInitialValues(t);this.resizeFeature.resizeColumns(s,s.resizeStartWidth+e,"uiColumnResized",!0)}moveHeader(e){const{beans:t,eGui:s,column:i,gos:r,ctrlsService:n}=this,o=r.get("enableRtl"),a=e===0,l=this.getPinned(),u=s.getBoundingClientRect(),h=u.left,p=u.width,g=Cl.normaliseX(a!==o?h-20:h+p+20,l,!0,r,n),m=i.getGroupId(),C=this.focusService.getFocusedHeader();Cl.attemptMoveColumns({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,hDirection:e,xPosition:g,pinned:l,fromEnter:!1,fakeEvent:!1,gos:r,columnModel:t.columnModel});const y=i.getDisplayedLeafColumns(),R=a?y[0]:Mt(y);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(R,"auto"),!this.isAlive()&&C&&this.restoreFocus(m,i,C)}restoreFocus(e,t,s){const i=t.getLeafColumns();if(!i.length)return;const r=i[0].getParent();if(!r)return;const n=this.findGroupWidthId(r,e);n&&this.focusService.focusHeaderPosition({headerPosition:rs(Xe({},s),{column:n})})}findGroupWidthId(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return null}resizeLeafColumnsToFit(e){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(){const e=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:s=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),s,"gridInitializing")},setTooltip:(s,i)=>{this.setupTooltip(s,i)}}),t=this.userComponentFactory.getHeaderGroupCompDetails(e);this.comp.setUserCompDetails(t)}addHeaderMouseListeners(){const e=i=>this.handleMouseOverChange(i.type==="mouseenter"),t=()=>this.dispatchColumnMouseEvent(w.EVENT_COLUMN_HEADER_CLICKED,this.column.getProvidedColumnGroup()),s=i=>this.handleContextMenuMouseEvent(i,void 0,this.column.getProvidedColumnGroup());this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e),this.addManagedListener(this.getGui(),"click",t),this.addManagedListener(this.getGui(),"contextmenu",s)}handleMouseOverChange(e){const s={type:e?w.EVENT_COLUMN_HEADER_MOUSE_OVER:w.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column.getProvidedColumnGroup()};this.eventService.dispatchEvent(s)}setupTooltip(e,t){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const s=this.column.getColGroupDef(),i=this.gos.get("tooltipShowMode")==="whenTruncated",r=this.eGui;!t&&i&&!(s!=null&&s.headerGroupComponent)&&(t=()=>{const o=r.querySelector(".ag-header-group-text");return o?o.scrollWidth>o.clientWidth:!0});const n={getColumn:()=>this.column,getGui:()=>r,getLocation:()=>"headerGroup",getTooltipValue:()=>e??(s&&s.headerTooltip),shouldDisplayTooltip:t};s&&(n.getColDef=()=>s),this.createBean(new wo(n))}setupExpandable(){const e=this.column.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(e,Rs.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(e,Rs.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}refreshExpanded(){const e=this.column;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const e=this.column.getColGroupDef(),t=tv.getHeaderClassesFromColDef(e,this.gos,null,this.column);this.column.isPadding()?(t.push("ag-header-group-cell-no-group"),this.column.getLeafColumns().every(i=>i.isSpanHeaderHeight())&&t.push("ag-header-span-height")):t.push("ag-header-group-cell-with-group"),t.forEach(s=>this.comp.addOrRemoveCssClass(s,!0))}setupMovingCss(){const t=this.column.getProvidedColumnGroup().getLeafColumns(),s=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());t.forEach(i=>{this.addManagedListener(i,Kt.EVENT_MOVING_CHANGED,s)}),s()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const t=this.getRowIndex();this.beans.focusService.setFocusedHeader(t,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===U.ENTER){const s=this.column,i=!s.isExpanded();this.beans.columnModel.setColumnGroupOpened(s.getProvidedColumnGroup(),i,"uiColumnExpanded")}}setDragSource(e){if(!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),!e))return;const{beans:t,column:s,displayName:i,gos:r,dragAndDropService:n}=this,{columnModel:o}=t,a=s.getProvidedColumnGroup().getLeafColumns();let l=!r.get("suppressDragLeaveHidesColumns");const u=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>l?ut.ICON_HIDE:ut.ICON_NOT_ALLOWED,dragItemName:i,getDragItem:()=>this.getDragItemForGroup(s),onDragStarted:()=>{l=!r.get("suppressDragLeaveHidesColumns"),a.forEach(h=>h.setMoving(!0,"uiColumnDragged"))},onDragStopped:()=>a.forEach(h=>h.setMoving(!1,"uiColumnDragged")),onGridEnter:h=>{var p;if(l){const g=((p=h==null?void 0:h.columns)==null?void 0:p.filter(m=>!m.getColDef().lockVisible))||[];o.setColumnsVisible(g,!0,"uiColumnMoved")}},onGridExit:h=>{var p;if(l){const g=((p=h==null?void 0:h.columns)==null?void 0:p.filter(m=>!m.getColDef().lockVisible))||[];o.setColumnsVisible(g,!1,"uiColumnMoved")}}};n.addDragSource(u,!0)}getDragItemForGroup(e){const t=e.getProvidedColumnGroup().getLeafColumns(),s={};t.forEach(r=>s[r.getId()]=r.isVisible());const i=[];return this.beans.columnModel.getAllDisplayedColumns().forEach(r=>{t.indexOf(r)>=0&&(i.push(r),Vi(t,r))}),t.forEach(r=>i.push(r)),{columns:i,visibleState:s}}isSuppressMoving(){let e=!1;return this.column.getLeafColumns().forEach(s=>{(s.getColDef().suppressMovable||s.getColDef().lockPosition)&&(e=!0)}),e||this.gos.get("suppressMovableColumns")}},MG=0,Od=class extends Se{constructor(e,t,s){super(),this.instanceId=MG++,this.rowIndex=e,this.pinned=t,this.type=s;const i=s=="group"?"ag-header-row-column-group":s=="filter"?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${i}`}postConstruct(){this.isPrintLayout=this.gos.isDomLayout("print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}getInstanceId(){return this.instanceId}setComp(e,t=!0){this.comp=e,t&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(){this.addManagedListener(this.eventService,w.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_VIRTUAL_COLUMNS_CHANGED,e=>this.onVirtualColumnsChanged(e.afterScroll)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",e=>this.isEnsureDomOrder=e.currentValue),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}getHeaderCellCtrl(e){if(this.headerCellCtrls)return pl(this.headerCellCtrls).find(t=>t.getColumnGroupChild()===e)}onDisplayedColumnsChanged(){this.isPrintLayout=this.gos.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{columnModel:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){var{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{columnModel:e,filterManager:t}=this.beans;let s=e.getHeaderRowCount();const i=[];let r=0;t.hasFloatingFilters()&&(s++,r=1);const n=e.getColumnGroupHeaderRowHeight(),o=e.getColumnHeaderRowHeight(),a=1+r,l=s-a;for(let p=0;p<l;p++)i.push(n);i.push(o);for(let p=0;p<r;p++)i.push(e.getFloatingFiltersHeight());let u=0;for(let p=0;p<this.rowIndex;p++)u+=i[p];const h=i[this.rowIndex];return{topOffset:u,rowHeight:h}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(e=!1){const t=this.getHeaderCtrls(),s=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,s,e)}getHeaderCtrls(){const e=this.headerCellCtrls;this.headerCellCtrls=new Map;const t=this.getColumnsInViewport();for(const r of t)this.recycleAndCreateHeaderCtrls(r,e);const s=r=>{const{focusService:n,columnModel:o}=this.beans;return n.isHeaderWrapperFocused(r)?o.isDisplayed(r.getColumnGroupChild()):!1};if(e)for(const[r,n]of e)s(n)?this.headerCellCtrls.set(r,n):this.destroyBean(n);return Array.from(this.headerCellCtrls.values())}recycleAndCreateHeaderCtrls(e,t){if(!this.headerCellCtrls||e.isEmptyGroup())return;const s=e.getUniqueId();let i;if(t&&(i=t.get(s),t.delete(s)),i&&i.getColumnGroupChild()!=e&&(this.destroyBean(i),i=void 0),i==null)switch(this.type){case"filter":i=this.createBean(new IG(e,this.beans,this));break;case"group":i=this.createBean(new kG(e,this.beans,this));break;default:i=this.createBean(new _G(e,this.beans,this));break}this.headerCellCtrls.set(s,i)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(this.pinned!=null)return[];let e=[];const t=this.getActualDepth(),{columnModel:s}=this.beans;return["left",null,"right"].forEach(i=>{const r=s.getVirtualHeaderGroupRow(i,t);e=e.concat(r)}),e}getActualDepth(){return this.type=="filter"?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}focusHeader(e,t){if(!this.headerCellCtrls)return!1;const i=Array.from(this.headerCellCtrls.values()).find(r=>r.getColumnGroupChild()==e);return i?i.focus(t):!1}destroy(){this.headerCellCtrls&&this.headerCellCtrls.forEach(e=>{this.destroyBean(e)}),this.headerCellCtrls=void 0,super.destroy()}};f([A("beans")],Od.prototype,"beans",2);f([xe],Od.prototype,"postConstruct",1);var Ra=class extends Se{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}setupDragAndDrop(e){const t=new Du(this.pinned,e);this.createManagedBean(t)}refresh(e=!1){const t=new su,s=this.focusService.getFocusHeaderToUseAfterRefresh(),i=()=>{const a=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let l=0;l<a;l++){const u=this.createBean(new Od(t.next(),this.pinned,"group"));this.groupsRowCtrls.push(u)}},r=()=>{const a=t.next(),l=!this.hidden&&(this.columnsRowCtrl==null||!e||this.columnsRowCtrl.getRowIndex()!==a);(l||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),l&&(this.columnsRowCtrl=this.createBean(new Od(a,this.pinned,"column")))},n=()=>{this.includeFloatingFilter=this.filterManager.hasFloatingFilters()&&!this.hidden;const a=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){a();return}const l=t.next();if(this.filtersRowCtrl){const u=this.filtersRowCtrl.getRowIndex()!==l;(!e||u)&&a()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new Od(l,this.pinned,"filter")))};i(),r(),n();const o=this.getAllCtrls();this.comp.setCtrls(o),this.restoreFocusOnHeader(s)}restoreFocusOnHeader(e){e==null||e.column.getPinned()!=this.pinned||this.focusService.focusHeaderPosition({headerPosition:e})}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const e=this.filterManager.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new Eu(e=>this.comp.setCenterWidth(`${e}px`),!0))}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}setupPinnedWidth(){if(this.pinned==null)return;const e=this.pinned==="left",t=this.pinned==="right";this.hidden=!0;const s=()=>{const i=e?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(i==null)return;const r=i==0,n=this.hidden!==r,o=this.gos.get("enableRtl"),a=this.gos.getScrollbarWidth(),u=this.scrollVisibleService.isVerticalScrollShowing()&&(o&&e||!o&&t)?i+a:i;this.comp.setPinnedContainerWidth(`${u}px`),this.comp.setDisplayed(!r),n&&(this.hidden=r,this.refresh())};this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,s),this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,s),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,s),this.addManagedListener(this.eventService,w.EVENT_SCROLLBAR_WIDTH_CHANGED,s)}getHeaderCtrlForColumn(e){if(e instanceof Kt)return this.columnsRowCtrl?this.columnsRowCtrl.getHeaderCellCtrl(e):void 0;if(this.groupsRowCtrls.length!==0)for(let t=0;t<this.groupsRowCtrls.length;t++){const s=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(s)return s}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const s=this.getAllCtrls()[e];return s?s.getType():void 0}focusHeader(e,t,s){const r=this.getAllCtrls()[e];return r?r.focusHeader(t,s):!1}getViewport(){return this.eViewport}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}};f([A("ctrlsService")],Ra.prototype,"ctrlsService",2);f([A("scrollVisibleService")],Ra.prototype,"scrollVisibleService",2);f([A("pinnedWidthService")],Ra.prototype,"pinnedWidthService",2);f([A("columnModel")],Ra.prototype,"columnModel",2);f([A("focusService")],Ra.prototype,"focusService",2);f([A("filterManager")],Ra.prototype,"filterManager",2);var ql=class Ng extends at{constructor(t){super(),this.headerRowComps={},this.rowCompsList=[],this.pinned=t}init(){this.selectAndSetTemplate();const t={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{const r=this.getGui();r.style.width=i,r.style.maxWidth=i,r.style.minWidth=i}};this.createManagedBean(new Ra(this.pinned)).setComp(t,this.getGui())}selectAndSetTemplate(){const t=this.pinned=="left",s=this.pinned=="right",i=t?Ng.PINNED_LEFT_TEMPLATE:s?Ng.PINNED_RIGHT_TEMPLATE:Ng.CENTER_TEMPLATE;this.setTemplate(i),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}destroyRowComps(){this.setCtrls([])}destroyRowComp(t){this.destroyBean(t),this.eRowContainer.removeChild(t.getGui())}setCtrls(t){const s=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i;const r=n=>{const o=n.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),i&&v0(this.eRowContainer,o,i),i=o};t.forEach(n=>{const o=n.getInstanceId(),a=s[o];delete s[o];const l=a||this.createBean(new B0(n));this.headerRowComps[o]=l,this.rowCompsList.push(l),r(l)}),ha(s).forEach(n=>this.destroyRowComp(n))}};ql.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="rowgroup"></div>';ql.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="rowgroup"></div>';ql.CENTER_TEMPLATE=`<div class="ag-header-viewport" role="presentation">
            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>
        </div>`;f([Fe("eCenterContainer")],ql.prototype,"eCenterContainer",2);f([xe],ql.prototype,"init",1);f([Fi],ql.prototype,"destroyRowComps",1);var gC=ql,Pl=class extends Se{constructor(){super(...arguments),this.currentHeaderRowWithoutSpan=-1}postConstruct(){this.ctrlsService.whenReady(t=>{this.gridBodyCon=t.gridBodyCtrl});const e=this.gos.getDocument();this.addManagedListener(e,"mousedown",()=>this.setCurrentHeaderRowWithoutSpan(-1))}getHeaderRowCount(){const e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0}navigateVertically(e,t,s){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:i,column:r}=t,n=this.getHeaderRowCount(),o=e===0;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:u}=o?this.headerPositionUtils.getColumnVisibleParent(r,i):this.headerPositionUtils.getColumnVisibleChild(r,i),h=!1;return a<0&&(a=0,l=r,h=!0),a>=n?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):u!==void 0&&(this.currentHeaderRowWithoutSpan=u),!h&&!l?!1:this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:s})}setCurrentHeaderRowWithoutSpan(e){this.currentHeaderRowWithoutSpan=e}navigateHorizontally(e,t=!1,s){const i=this.focusService.getFocusedHeader(),r=e===2,n=this.gos.get("enableRtl");let o,a;if(this.currentHeaderRowWithoutSpan!==-1?i.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=i.headerRowIndex,r!==n?(a="Before",o=this.headerPositionUtils.findHeader(i,a)):(a="After",o=this.headerPositionUtils.findHeader(i,a)),o||!t)return this.focusService.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:s});if(t){const l=this.gos.getCallback("tabToNextHeader");if(l)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a})}return this.focusNextHeaderRow(i,a,s)}focusNextHeaderRow(e,t,s){const i=e.headerRowIndex;let r=null,n;if(t==="Before"?i>0&&(n=i-1,this.currentHeaderRowWithoutSpan-=1,r=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"end")):(n=i+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),r=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"start")),!r)return!1;const{column:o,headerRowIndex:a}=this.headerPositionUtils.getHeaderIndexToFocus(r.column,r==null?void 0:r.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:o,headerRowIndex:a},direction:t,fromTab:!0,allowUserOverride:!0,event:s})}scrollToColumn(e,t="After"){if(e.getPinned())return;let s;if(e instanceof Ls){const i=e.getDisplayedLeafColumns();s=t==="Before"?Mt(i):i[0]}else s=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(s)}};f([A("focusService")],Pl.prototype,"focusService",2);f([A("headerPositionUtils")],Pl.prototype,"headerPositionUtils",2);f([A("ctrlsService")],Pl.prototype,"ctrlsService",2);f([xe],Pl.prototype,"postConstruct",1);Pl=f([Le("headerNavigationService")],Pl);var Ta=class extends Se{setComp(e,t,s){this.comp=e,this.eGui=t,this.createManagedBean(new Ea(s,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight();const i=this.onHeaderContextMenu.bind(this);this.addManagedListener(this.eGui,"contextmenu",i),this.mockContextMenuForIPad(i),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,e)}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:e}=this;let t=0,s=e.getHeaderRowCount(),i;this.filterManager.hasFloatingFilters()&&(s++,t=1);const n=this.columnModel.getColumnGroupHeaderRowHeight(),o=this.columnModel.getColumnHeaderRowHeight(),a=1+t,l=s-a;if(i=t*e.getFloatingFiltersHeight(),i+=l*n,i+=o,this.headerHeight===i)return;this.headerHeight=i;const u=`${i+1}px`;this.comp.setHeightAndMinHeight(u),this.eventService.dispatchEvent({type:w.EVENT_HEADER_HEIGHT_CHANGED})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const t=this.columnModel.getAllDisplayedColumns().some(s=>s.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",t)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),s=e.shiftKey!==t?2:3;(this.headerNavigationService.navigateHorizontally(s,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case U.LEFT:t=2;case U.RIGHT:ve(t)||(t=3),this.headerNavigationService.navigateHorizontally(t,!1,e);break;case U.UP:t=0;case U.DOWN:ve(t)||(t=1),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget:t}=e;!t&&this.eGui.contains(this.gos.getActiveDomElement())||this.eGui.contains(t)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(e,t,s){if(!e&&!s||!this.menuService.isHeaderContextMenuEnabled())return;const{target:i}=e??t;(i===this.eGui||i===this.ctrlsService.getHeaderRowContainerCtrl().getViewport())&&this.menuService.showHeaderContextMenu(void 0,e,s)}mockContextMenuForIPad(e){if(!yo())return;const t=new Ws(this.eGui),s=i=>{e(void 0,i.touchStart,i.touchEvent)};this.addManagedListener(t,Ws.EVENT_LONG_TAP,s),this.addDestroyFunc(()=>t.destroy())}};f([A("headerNavigationService")],Ta.prototype,"headerNavigationService",2);f([A("focusService")],Ta.prototype,"focusService",2);f([A("columnModel")],Ta.prototype,"columnModel",2);f([A("ctrlsService")],Ta.prototype,"ctrlsService",2);f([A("filterManager")],Ta.prototype,"filterManager",2);f([A("menuService")],Ta.prototype,"menuService",2);var j0=class EN extends at{constructor(){super(EN.TEMPLATE)}postConstruct(){const t={addOrRemoveCssClass:(r,n)=>this.addOrRemoveCssClass(r,n),setHeightAndMinHeight:r=>{this.getGui().style.height=r,this.getGui().style.minHeight=r}};this.createManagedBean(new Ta).setComp(t,this.getGui(),this.getFocusableElement());const i=r=>{this.createManagedBean(r),this.appendChild(r)};i(new gC("left")),i(new gC(null)),i(new gC("right"))}};j0.TEMPLATE='<div class="ag-header" role="presentation"/>';f([xe],j0.prototype,"postConstruct",1);var LG=j0,yh=class extends Se{addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};return this.dragService.addDragSource(t),()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const s=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(s)}setResizeIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}};f([A("dragService")],yh.prototype,"dragService",2);f([A("ctrlsService")],yh.prototype,"ctrlsService",2);yh=f([Le("horizontalResizeService")],yh);var ga=class extends Se{hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(e,t,s){this.showPopup(e,i=>{this.popupService.positionPopupUnderMouseEvent({column:e,type:s,mouseEvent:t,ePopup:i})},s,t.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(e,t,s){let i=-1,r="left";const n=this.menuService.isLegacyMenuEnabled();!n&&this.gos.get("enableRtl")&&(i=1,r="right");let o=n?void 0:4*i,a=n?void 0:4;this.showPopup(e,l=>{this.popupService.positionPopupByComponent({type:s,eventSource:t,ePopup:l,nudgeX:o,nudgeY:a,alignSide:r,keepWithinBounds:!0,position:"under",column:e})},s,t,n)}showPopup(e,t,s,i,r){const n=e?this.createBean(new Xm(e,"COLUMN_MENU")):void 0;if(this.activeMenu=n,!(n!=null&&n.hasFilter())||!e)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const o=document.createElement("div");fs(o,"presentation"),o.classList.add("ag-menu"),r||o.classList.add("ag-filter-menu"),this.tabListener=this.addManagedListener(o,"keydown",C=>this.trapFocusWithin(C,o)),o.appendChild(n==null?void 0:n.getGui());let a;const l=()=>n==null?void 0:n.afterGuiDetached(),u=this.menuService.isColumnMenuAnchoringEnabled()?i??this.ctrlsService.getGridBodyCtrl().getGui():void 0,h=C=>{e.setMenuVisible(!1,"contextMenu");const y=C instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),y&&i&&Zi(i)){const R=this.focusService.findTabbableParent(i);R&&R.focus()}l(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,s,e)},p=this.localeService.getLocaleTextFunc(),g=r&&s!=="columnFilter"?p("ariaLabelColumnMenu","Column Menu"):p("ariaLabelColumnFilter","Column Filter"),m=this.popupService.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:h,positionCallback:()=>t(o),anchorToElement:u,ariaLabel:g});m&&(this.hidePopup=a=m.hideFunc),n.afterInit().then(()=>{t(o),n.afterGuiAttached({container:s,hidePopup:a})}),e.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,s,e)}trapFocusWithin(e,t){e.key!==U.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,s){const i={type:w.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible:e,switchingTab:!1,key:t,column:s??null};this.eventService.dispatchEvent(i)}isMenuEnabled(e){var t;return e.isFilterAllowed()&&((t=e.getColDef().menuTabs)!=null?t:["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}};f([A("filterManager")],ga.prototype,"filterManager",2);f([A("popupService")],ga.prototype,"popupService",2);f([A("focusService")],ga.prototype,"focusService",2);f([A("ctrlsService")],ga.prototype,"ctrlsService",2);f([A("menuService")],ga.prototype,"menuService",2);ga=f([Le("filterMenuFactory")],ga);var Ig=(e=>(e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom",e))(Ig||{}),av=class extends Se{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1;const{comp:t,eTopGuard:s,eBottomGuard:i,focusTrapActive:r,forceFocusOutWhenTabGuardsAreEmpty:n,focusInnerElement:o,onFocusIn:a,onFocusOut:l,shouldStopEventPropagation:u,onTabKeyDown:h,handleKeyDown:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=s,this.eBottomGuard=i,this.providedFocusInnerElement=o,this.eFocusableElement=g,this.focusTrapActive=!!r,this.forceFocusOutWhenTabGuardsAreEmpty=!!n,this.providedFocusIn=a,this.providedFocusOut=l,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=h,this.providedHandleKeyDown=p}postConstruct(){this.createManagedBean(new Ea(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedListener(e,"focus",this.onFocus.bind(this)))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length===0){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}findNextElementOutsideAndFocus(e){const t=this.gos.getDocument(),s=this.focusService.findFocusableElements(t.body,null,!0),i=s.indexOf(e?this.eTopGuard:this.eBottomGuard);if(i===-1)return;let r,n;e?(r=0,n=i):(r=i+1,n=s.length);const o=s.slice(r,n),a=this.gos.get("tabIndex");o.sort((l,u)=>{const h=parseInt(l.getAttribute("tabindex")||"0"),p=parseInt(u.getAttribute("tabindex")||"0");return p===a?1:h===a?-1:h===0?1:p===0?-1:h-p}),o[e?o.length-1:0].focus()}onFocusIn(e){this.focusTrapActive||(this.providedFocusIn&&this.providedFocusIn(e),this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const s=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),s&&(s.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e){return e===this.eTopGuard||e===this.eBottomGuard}};f([A("focusService")],av.prototype,"focusService",2);f([xe],av.prototype,"postConstruct",1);var Ep=class extends at{initialiseTabGuard(t){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();const s=[this.eTopGuard,this.eBottomGuard],i={setTabIndex:r=>{s.forEach(n=>r!=null?n.setAttribute("tabindex",r):n.removeAttribute("tabindex"))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new av({comp:i,focusTrapActive:!!t.focusTrapActive,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:t.onFocusIn,onFocusOut:t.onFocusOut,focusInnerElement:t.focusInnerElement,handleKeyDown:t.handleKeyDown,onTabKeyDown:t.onTabKeyDown,shouldStopEventPropagation:t.shouldStopEventPropagation,forceFocusOutWhenTabGuardsAreEmpty:t.forceFocusOutWhenTabGuardsAreEmpty}))}createTabGuard(t){const s=document.createElement("div"),i=t==="top"?"ag-tab-guard-top":"ag-tab-guard-bottom";return s.classList.add("ag-tab-guard",i),fs(s,"presentation"),s}addTabGuards(t,s){this.eFocusableElement.insertAdjacentElement("afterbegin",t),this.eFocusableElement.insertAdjacentElement("beforeend",s)}removeAllChildrenExceptTabGuards(){const t=[this.eTopGuard,this.eBottomGuard];xs(this.getFocusableElement()),this.addTabGuards(...t)}forceFocusOutOfContainer(t=!1){this.tabGuardCtrl.forceFocusOutOfContainer(t)}appendChild(t,s){gp(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):super.appendChild(t,s)}},lv=class RN extends Ep{constructor(t){super(RN.getTemplate(t.cssClass)),this.items=[],this.tabbedItemScrollMap=new Map,this.params=t}postConstruct(){this.setupHeader(),this.params.items&&this.params.items.forEach(t=>this.addItem(t)),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),focusInnerElement:this.focusInnerElement.bind(this),focusTrapActive:!0}),this.addDestroyFunc(()=>{var t,s,i;return(i=(s=(t=this.activeItem)==null?void 0:t.tabbedItem)==null?void 0:s.afterDetachedCallback)==null?void 0:i.call(s)})}static getTemplate(t){return`<div class="ag-tabs ${t}">
            <div ref="eHeader"></div>
            <div ref="eBody" role="presentation" class="ag-tabs-body ${t?`${t}-body`:""}"></div>
        </div>`}setupHeader(){const{enableCloseButton:t,cssClass:s}=this.params,i=(r,n)=>{r.classList.add(`ag-tabs-${n}`),s&&r.classList.add(`${s}-${n}`)};t?(this.setupCloseButton(i),this.eTabHeader=this.gos.getDocument().createElement("div"),i(this.eHeader,"header-wrapper"),fs(this.eHeader,"presentation"),this.eHeader.appendChild(this.eTabHeader)):this.eTabHeader=this.eHeader,fs(this.eTabHeader,"tablist"),i(this.eTabHeader,"header")}setupCloseButton(t){const s=this.gos.getDocument(),i=s.createElement("button");t(i,"close-button");const r=cs("close",this.gos,void 0,!0);fr(i,this.params.closeButtonAriaLabel),i.appendChild(r),this.addManagedListener(i,"click",()=>{var o,a;return(a=(o=this.params).onCloseClicked)==null?void 0:a.call(o)});const n=s.createElement("div");t(n,"close-button-wrapper"),fs(n,"presentation"),n.appendChild(i),this.eHeader.appendChild(n),this.eCloseButton=i}handleKeyDown(t){switch(t.key){case U.RIGHT:case U.LEFT:if(!this.eTabHeader.contains(this.gos.getActiveDomElement()))return;const s=t.key===U.RIGHT,i=this.gos.get("enableRtl"),r=this.items.indexOf(this.activeItem),n=s!==i?Math.min(r+1,this.items.length-1):Math.max(r-1,0);if(r===n)return;t.preventDefault();const o=this.items[n];this.showItemWrapper(o),o.eHeaderButton.focus();break;case U.UP:case U.DOWN:t.stopPropagation();break}}onTabKeyDown(t){var s,i,r,n;if(t.defaultPrevented)return;const{focusService:o,eHeader:a,eBody:l,activeItem:u,params:h}=this,{suppressTrapFocus:p,enableCloseButton:g}=h,m=this.gos.getActiveDomElement(),C=t.target,y=t.shiftKey;if(a.contains(m)){t.preventDefault(),g&&y&&!((s=this.eCloseButton)!=null&&s.contains(m))?(i=this.eCloseButton)==null||i.focus():p&&y?(r=this.focusService.findFocusableElementBeforeTabGuard(this.gos.getDocument().body,C))==null||r.focus():this.focusBody(t.shiftKey);return}let R=null;if(o.isTargetUnderManagedComponent(l,C)&&(y&&(R=this.focusService.findFocusableElementBeforeTabGuard(l,C)),!R&&!p&&(R=u.eHeaderButton)),!R&&l.contains(m)&&(R=o.findNextFocusableElement(l,!1,y),!R)){t.preventDefault(),p&&!y?this.forceFocusOutOfContainer(y):g&&!y?(n=this.eCloseButton)==null||n.focus():this.focusHeader();return}R&&(t.preventDefault(),R.focus())}focusInnerElement(t){t?this.focusHeader():this.focusBody(!0)}focusHeader(t){this.activeItem.eHeaderButton.focus({preventScroll:t})}focusBody(t){this.focusService.focusInto(this.eBody,t)}setAfterAttachedParams(t){this.afterAttachedParams=t}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(t){const s=document.createElement("span");fs(s,"tab"),s.setAttribute("tabindex","-1"),s.appendChild(t.title),s.classList.add("ag-tab"),this.eTabHeader.appendChild(s),fr(s,t.titleLabel);const i={tabbedItem:t,eHeaderButton:s};this.items.push(i),s.addEventListener("click",this.showItemWrapper.bind(this,i))}showItem(t){const s=this.items.find(i=>i.tabbedItem===t);s&&this.showItemWrapper(s)}showItemWrapper(t){var s,i,r,n,o,a;const{tabbedItem:l,eHeaderButton:u}=t;if((i=(s=this.params).onItemClicked)==null||i.call(s,{item:l}),this.activeItem===t){(n=(r=this.params).onActiveItemClicked)==null||n.call(r);return}this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),xs(this.eBody),l.bodyPromise.then(h=>{this.eBody.appendChild(h);const p=!this.focusService.isKeyboardMode();if(this.params.suppressFocusBodyOnOpen||this.focusService.focusInto(this.eBody,!1,p),l.afterAttachedCallback&&l.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const g=l.getScrollableContainer&&l.getScrollableContainer()||h;this.lastScrollListener=this.addManagedListener(g,"scroll",()=>{this.tabbedItemScrollMap.set(l.name,g.scrollTop)});const m=this.tabbedItemScrollMap.get(l.name);m!==void 0&&setTimeout(()=>{g.scrollTop=m},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),(a=(o=this.activeItem.tabbedItem).afterDetachedCallback)==null||a.call(o)),u.classList.add("ag-tab-selected"),this.activeItem=t}};f([A("focusService")],lv.prototype,"focusService",2);f([Fe("eHeader")],lv.prototype,"eHeader",2);f([Fe("eBody")],lv.prototype,"eBody",2);f([xe],lv.prototype,"postConstruct",1);var OG=50,aw=class extends Se{constructor(){super(...arguments),this.polyfillFunctions=[]}observeResize(e,t){const s=this.gos.getWindow(),i=()=>{const a=new s.ResizeObserver(t);return a.observe(e),()=>a.disconnect()},r=()=>{var a,l;let u=(a=e==null?void 0:e.clientWidth)!=null?a:0,h=(l=e==null?void 0:e.clientHeight)!=null?l:0,p=!0;const g=()=>{var m,C;if(p){const y=(m=e==null?void 0:e.clientWidth)!=null?m:0,R=(C=e==null?void 0:e.clientHeight)!=null?C:0;(y!==u||R!==h)&&(u=y,h=R,t()),this.doNextPolyfillTurn(g)}};return g(),()=>p=!1},n=this.gos.get("suppressBrowserResizeObserver");return!!s.ResizeObserver&&!n?i():this.getFrameworkOverrides().wrapIncoming(()=>r(),"resize-observer")}doNextPolyfillTurn(e){this.polyfillFunctions.push(e),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;const e=()=>{const t=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],t.forEach(s=>s())};this.polyfillScheduled=!0,window.setTimeout(e,OG)}};aw=f([Le("resizeObserverService")],aw);var ru=class extends Se{constructor(){super(...arguments),this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}setScrollTop(e){const t=this.gos.get("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&e===0){const s=this.paginationProxy.getCurrentPage();s!==this.lastPage&&(this.lastPage=s,this.scrollGoingDown=!0)}this.lastScrollTop=e}init(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){this.useAnimationFrame===!1&&console.warn(`AG Grid: AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,s){this.verifyAnimationFrameOn(s);const i={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[s],i),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((s,i)=>s.index!==i.index?t*(i.index-s.index):i.createOrder-s.createOrder),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,s=t.list,i=this.createTasksP2,r=i.list,n=this.destroyTasks,o=new Date().getTime();let a=new Date().getTime()-o;const l=e<=0,u=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!u.getScrollFeature().scrollGridIfNeeded()){let p;if(s.length)this.sortTaskList(t),p=s.pop().task;else if(r.length)this.sortTaskList(i),p=r.pop().task;else if(n.length)p=n.pop();else{this.cancelledTasks.clear();break}this.cancelledTasks.has(p)||p()}a=new Date().getTime()-o}s.length||r.length||n.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=this.gos.getWindow();t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{if(!this.isOn()){window.setTimeout(e,0);return}t||(t=!0,this.addDestroyTask(()=>{t=!1,e()}))}}};f([A("ctrlsService")],ru.prototype,"ctrlsService",2);f([A("paginationProxy")],ru.prototype,"paginationProxy",2);f([xe],ru.prototype,"init",1);ru=f([Le("animationFrameService")],ru);var wh=class extends Se{postConstruct(){this.isClientSideRowModel=this.rowModel.getType()==="clientSide"}expandRows(e){if(!this.isClientSideRowModel)return;const t=new Set(e);this.rowModel.forEachNode(s=>{s.id&&t.has(s.id)&&(s.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const e=[];return this.rowModel.forEachNode(({expanded:t,id:s})=>{t&&s&&e.push(s)}),e}expandAll(e){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(e)}setRowNodeExpanded(e,t,s,i){e&&(s&&e.parent&&e.parent.level!==-1&&this.setRowNodeExpanded(e.parent,t,s,i),e.setExpanded(t,void 0,i))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}};f([A("rowModel")],wh.prototype,"rowModel",2);f([xe],wh.prototype,"postConstruct",1);wh=f([Le("expansionService")],wh);var Gr=class extends Se{postConstruct(){var e;this.activeMenuFactory=(e=this.enterpriseMenuFactory)!=null?e:this.filterMenuFactory}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const t=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(t,e,e.containerType,!0)}showHeaderContextMenu(e,t,s){this.activeMenuFactory.showMenuAfterContextMenuEvent(e,t,s)}getContextMenuPosition(e,t){const s=this.getRowCtrl(e),i=this.getCellGui(s,t);if(!i)return s?{x:0,y:s.getRowYPosition()}:{x:0,y:0};const r=i.getBoundingClientRect();return{x:r.x+r.width/2,y:r.y+r.height/2}}showContextMenu(e){var t,s,i;const{column:r,rowNode:n}=e;let{anchorToElement:o,value:a}=e;n&&r&&a==null&&(a=n.getValueFromValueService(r)),o==null&&(o=this.getContextMenuAnchorElement(n,r)),(i=this.contextMenuFactory)==null||i.onContextMenu((t=e.mouseEvent)!=null?t:null,(s=e.touchEvent)!=null?s:null,n??null,r??null,a,o)}showColumnChooser(e){var t;(t=this.columnChooserFactory)==null||t.showColumnChooser(e)}hidePopupMenu(){var e;(e=this.contextMenuFactory)==null||e.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){var e;(e=this.columnChooserFactory)==null||e.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(e){const{suppressMenu:t,suppressHeaderMenuButton:s}=e.getColDef();return!(s??t)&&this.activeMenuFactory.isMenuEnabled(e)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&this.filterManager.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e!=null&&e.getColDef().suppressHeaderContextMenu)&&this.getColumnMenuType()==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(yo()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return this.filterManager.isFilterAllowed(e)&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return this.getColumnMenuType()==="new"}isLegacyMenuEnabled(){return this.getColumnMenuType()==="legacy"}isFloatingFilterButtonEnabled(e){var t;const s=e.getColDef(),i=(t=s.floatingFilterComponentParams)==null?void 0:t.suppressFilterButton;return i!=null&&tt("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),s.suppressFloatingFilterButton==null?!i:!s.suppressFloatingFilterButton}getColumnMenuType(){var e;return(e=this.gos.get("columnMenu"))!=null?e:"legacy"}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()||this.gos.exists("suppressMenuHide")?e:!0}showColumnMenuCommon(e,t,s,i){const{column:r,positionBy:n}=t;if(n==="button"){const{buttonElement:o}=t;e.showMenuAfterButtonClick(r,o,s,i)}else if(n==="mouse"){const{mouseEvent:o}=t;e.showMenuAfterMouseEvent(r,o,s,i)}else r&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(r,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const o=this.ctrlsService.getHeaderRowContainerCtrl(r.getPinned()).getHeaderCtrlForColumn(r);e.showMenuAfterButtonClick(r,o.getAnchorElementForMenu(i),s,!0)}))}getRowCtrl(e){const{rowIndex:t,rowPinned:s}=e||{};if(t!=null)return this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:s})||void 0}getCellGui(e,t){if(!e||!t)return;const s=e.getCellCtrl(t);return(s==null?void 0:s.getGui())||void 0}getContextMenuAnchorElement(e,t){const s=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),i=this.getRowCtrl(e);if(!i)return s;const r=this.getCellGui(i,t);return r||(i.isFullWidth()?i.getFullWidthElement():s)}};f([A("filterMenuFactory")],Gr.prototype,"filterMenuFactory",2);f([A("ctrlsService")],Gr.prototype,"ctrlsService",2);f([A("animationFrameService")],Gr.prototype,"animationFrameService",2);f([A("filterManager")],Gr.prototype,"filterManager",2);f([A("rowRenderer")],Gr.prototype,"rowRenderer",2);f([zt("columnChooserFactory")],Gr.prototype,"columnChooserFactory",2);f([zt("contextMenuFactory")],Gr.prototype,"contextMenuFactory",2);f([zt("enterpriseMenuFactory")],Gr.prototype,"enterpriseMenuFactory",2);f([xe],Gr.prototype,"postConstruct",1);Gr=f([Le("menuService")],Gr);var Al=class extends Se{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const s=this.getHeaderCellForColumn(e);if(!s)return-1;const i=this.rowRenderer.getAllCellsForColumn(e);return t||i.push(s),this.addElementsToContainerAndGetWidth(i)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const s=this.centerRowContainerCtrl.getContainerElement();e.forEach(n=>this.cloneItemIntoDummy(n,t)),s.appendChild(t);const i=t.offsetWidth;s.removeChild(t);const r=this.getAutoSizePadding();return i+r}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(e){let t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(s=>{const i=s.getHtmlElementForColumnHeader(e);i!=null&&(t=i)}),t}cloneItemIntoDummy(e,t){const s=e.cloneNode(!0);s.style.width="",s.style.position="static",s.style.left="";const i=document.createElement("div"),r=i.classList;["ag-header-cell","ag-header-group-cell"].some(a=>s.classList.contains(a))?(r.add("ag-header","ag-header-row"),i.style.position="static"):r.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const u=o.classList[l];u!="ag-row-position-absolute"&&r.add(u)}break}o=o.parentElement}i.appendChild(s),t.appendChild(i)}};f([A("rowRenderer")],Al.prototype,"rowRenderer",2);f([A("ctrlsService")],Al.prototype,"ctrlsService",2);f([A("rowCssClassCalculator")],Al.prototype,"rowCssClassCalculator",2);f([xe],Al.prototype,"postConstruct",1);Al=f([Le("autoWidthCalculator")],Al);var Rp=class extends Se{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.topContainerHeight=0,this.bottomContainerHeight=0}postConstruct(){this.isClientSide=this.rowModel.getType()==="clientSide",this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl})}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}getLastPixelOfGroup(e){return this.isClientSide?this.getClientSideLastPixelOfGroup(e):this.getServerSideLastPixelOfGroup(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}getServerSideLastPixelOfGroup(e){var t,s,i,r;if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(e.isExpandable()||e.footer){if(e.master)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1){let o=(t=e.childStore)==null?void 0:t.getStoreBounds();return e.footer&&(o=(s=e.sibling.childStore)==null?void 0:s.getStoreBounds()),((i=o==null?void 0:o.heightPx)!=null?i:0)+((r=o==null?void 0:o.topPx)!=null?r:0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(e){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(e.isExpandable()||e.footer){const t=e.footer&&e.rowIndex===0,s=!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1;if(t||s){let i=e.footer?e.sibling:e;for(;i.isExpandable()&&i.expanded;)if(i.master)i=i.detailNode;else if(i.childrenAfterSort){if(i.childrenAfterSort.length===0)break;i=Mt(i.childrenAfterSort)}return i.rowTop+i.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(e){const t=e==="top";let s=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,s);const i=t?this.rowRenderer.getFirstVisibleVerticalPixel():this.rowRenderer.getLastVisibleVerticalPixel(),r=new Set,n=u=>{if(r.add(u),t){const h=this.getLastPixelOfGroup(u),p=i+s+u.rowHeight;h<p?u.stickyRowTop=s+(h-p):u.stickyRowTop=s}else{const h=this.getFirstPixelOfGroup(u),p=i-(s+u.rowHeight);h>p?u.stickyRowTop=s-(h-p):u.stickyRowTop=s}s=0,r.forEach(h=>{const p=h.stickyRowTop+h.rowHeight;s<p&&(s=p)})},o=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=u=>u.displayed?u.footer?o===!0||o==="grand"&&u.level===-1||o==="group"&&u.level>-1?!1:!r.has(u):u.isExpandable()?a===!0?!1:!r.has(u)&&u.expanded:!1:!1;for(let u=0;u<100;u++){let h=i+s;t||(h=i-s);const p=this.rowModel.getRowIndexAtPixel(h),g=this.rowModel.getRow(p);if(g==null)break;const C=this.getStickyAncestors(g).find(R=>(t?R.rowIndex<p:R.rowIndex>p)&&l(R));if(C){n(C);continue}if((t?g.rowTop<h:g.rowTop+g.rowHeight>h)&&l(g)){n(g);continue}break}return t||r.forEach(u=>{u.stickyRowTop=s-(u.stickyRowTop+u.rowHeight)}),this.refreshNodesAndContainerHeight(e,r,s)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(e===!0)return!0;const t=!!this.gos.get("groupIncludeFooter")||e==="group",s=!!this.gos.get("groupIncludeTotalFooter")||e==="grand";return t&&s?!0:s?"grand":t?"group":!1}canRowsBeSticky(){const e=this.gos.isGroupRowsSticky(),t=this.areFooterRowsStickySuppressed(),s=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!s)}getStickyAncestors(e){const t=[];let s=e.footer?e.sibling:e.parent;for(;s;)s.sibling&&t.push(s.sibling),t.push(s),s=s.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some(s=>s.getRowNode()===e)){for(let s=0;s<this.stickyTopRowCtrls.length;s++){const i=this.stickyTopRowCtrls[s].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows();return}for(let s=0;s<this.stickyBottomRowCtrls.length;s++){const i=this.stickyBottomRowCtrls[s].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}refreshNodesAndContainerHeight(e,t,s){const i=e==="top",r=i?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,n={},o=[];for(let p=0;p<r.length;p++){const g=r[p].getRowNode();if(!t.has(g)){n[g.id]=r[p],g.sticky=!1;continue}o.push(r[p])}const a=new Set;for(let p=0;p<o.length;p++)a.add(o[p].getRowNode());const l=[];t.forEach(p=>{a.has(p)||(p.sticky=!0,l.push(this.createRowCon(p,!1,!1)))});let u=!!l.length||o.length!==r.length;i?this.topContainerHeight!==s&&(this.topContainerHeight=s,this.gridBodyCtrl.setStickyTopHeight(s),u=!0):this.bottomContainerHeight!==s&&(this.bottomContainerHeight=s,this.gridBodyCtrl.setStickyBottomHeight(s),u=!0),this.destroyRowCtrls(n,!1);const h=[...o,...l];return h.sort((p,g)=>g.getRowNode().rowIndex-p.getRowNode().rowIndex),i||h.reverse(),h.forEach(p=>p.setRowTop(p.getRowNode().stickyRowTop)),u?(i?this.stickyTopRowCtrls=h:this.stickyBottomRowCtrls=h,!0):!1}};f([A("rowModel")],Rp.prototype,"rowModel",2);f([A("rowRenderer")],Rp.prototype,"rowRenderer",2);f([A("ctrlsService")],Rp.prototype,"ctrlsService",2);f([xe],Rp.prototype,"postConstruct",1);var mr=class extends Se{constructor(){super(...arguments),this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach(n=>n.onRangeSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(n=>n.updateRangeBordersIfRangeCount())},s=()=>{this.eventService.addEventListener(w.EVENT_RANGE_SELECTION_CHANGED,e),this.eventService.addEventListener(w.EVENT_COLUMN_MOVED,t),this.eventService.addEventListener(w.EVENT_COLUMN_PINNED,t),this.eventService.addEventListener(w.EVENT_COLUMN_VISIBLE,t)},i=()=>{this.eventService.removeEventListener(w.EVENT_RANGE_SELECTION_CHANGED,e),this.eventService.removeEventListener(w.EVENT_COLUMN_MOVED,t),this.eventService.removeEventListener(w.EVENT_COLUMN_PINNED,t),this.eventService.removeEventListener(w.EVENT_COLUMN_VISIBLE,t)};this.addDestroyFunc(()=>i()),this.addManagedPropertyListener("enableRangeSelection",n=>{n.currentValue?s():i()}),this.gos.get("enableRangeSelection")&&s()}}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){if(this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,w.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,w.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListeners(["suppressCellFocus","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.gos.isGroupRowsSticky()){const e=this.rowModel.getType();(e==="clientSide"||e==="serverSide")&&(this.stickyRowFeature=this.createManagedBean(new Rp(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gos.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new GG(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const e=ha(this.rowCtrlsByRowIndex),t=ha(this.zombieRowCtrls),s=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];t.length>0||s.length>0?this.allRowCtrls=[...e,...t,...s]:this.allRowCtrls=e}onCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}registerCellEventListeners(){this.addManagedListener(this.eventService,w.EVENT_CELL_FOCUSED,e=>{this.onCellFocusChanged(e)}),this.addManagedListener(this.eventService,w.EVENT_CELL_FOCUS_CLEARED,()=>{this.onCellFocusChanged()}),this.addManagedListener(this.eventService,w.EVENT_FLASH_CELLS,e=>{this.getAllCellCtrls().forEach(t=>t.onFlashCells(e))}),this.addManagedListener(this.eventService,w.EVENT_COLUMN_HOVER_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())}),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())}),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.columnModel.getAllGridColumns().forEach(t=>{const s=l=>{this.getAllCellCtrls().forEach(u=>{u.getColumn()===t&&l(u)})},i=()=>{s(l=>l.onLeftChanged())},r=()=>{s(l=>l.onWidthChanged())},n=()=>{s(l=>l.onFirstRightPinnedChanged())},o=()=>{s(l=>l.onLastLeftPinnedChanged())},a=()=>{s(l=>l.onColDefChanged())};t.addEventListener("leftChanged",i),t.addEventListener("widthChanged",r),t.addEventListener("firstRightPinnedChanged",n),t.addEventListener("lastLeftPinnedChanged",o),t.addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.removeEventListener("leftChanged",i),t.removeEventListener("widthChanged",r),t.removeEventListener("firstRightPinnedChanged",n),t.removeEventListener("lastLeftPinnedChanged",o),t.removeEventListener("colDefChanged",a)})})}onDomLayoutChanged(){const e=this.gos.isDomLayout("print"),t=e||this.gos.get("embedFullWidthRows"),s=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,s&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(e){const t=[];return this.getAllRowCtrls().forEach(s=>{const i=s.getCellElement(e);i&&t.push(i)}),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(e,t){e.forEach(s=>{s.destroyFirstPass(),s.destroySecondPass()}),e.length=0,t&&t.forEach(s=>{const i=new vl(s,this.beans,!1,!1,this.printLayout);e.push(i)})}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}redrawRow(e,t=!1){var s;if(e.sticky)this.stickyRowFeature.refreshStickyNode(e);else if((s=this.cachedRowCtrls)!=null&&s.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const i=r=>{const n=r[e.rowIndex];n&&n.getRowNode()===e&&(n.destroyFirstPass(),n.destroySecondPass(),r[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(e!=null){e==null||e.forEach(s=>this.redrawRow(s,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(e){const t=e!=null&&e.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(t==null)return null;const s=this.gos.getActiveDomElement(),i=this.gos.getDomData(s,ml.DOM_DATA_KEY_CELL_CTRL),r=this.gos.getDomData(s,vl.DOM_DATA_KEY_ROW_CTRL);return i||r?t:null}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const s=!e.domLayoutChanged&&!!e.recycleRows,i=e.animate&&this.gos.isAnimateRows(),r=s?this.getRowsToRecycle():null;s||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows(),this.recycleRows(r,i),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,s=this.gos.get("suppressScrollOnNewData");t&&!s&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}updateContainerHeights(){if(this.printLayout){this.rowContainerHeightService.setModelHeight(null);return}let e=this.paginationProxy.getCurrentPageHeight();e===0&&(e=1),this.rowContainerHeightService.setModelHeight(e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}releaseLockOnRefresh(){this.refreshInProgress=!1}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&(this.focusService.setRestoreFocusedCell(e),this.onCellFocusChanged(this.beans.gos.addGridCommonParams({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"mock"})))}stopEditing(e=!1){this.getAllRowCtrls().forEach(t=>{t.stopEditing(e)})}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),s=t.length;for(let i=0;i<s;i++){const r=t[i].getAllCellCtrls(),n=r.length;for(let o=0;o<n;o++)e.push(r[o])}return e}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],t=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],s=[...this.topRowCtrls,...this.bottomRowCtrls,...e,...t];for(const i in this.rowCtrlsByRowIndex)s.push(this.rowCtrlsByRowIndex[i]);return s}addRenderedRowListener(e,t,s){const i=this.rowCtrlsByRowIndex[t];i&&i.addEventListener(e,s)}flashCells(e={}){this.getCellCtrls(e.rowNodes,e.columns).forEach(t=>t.flashCell(e))}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};this.getCellCtrls(e.rowNodes,e.columns).forEach(s=>s.refreshOrDestroyCell(t)),e.rowNodes&&(this.getRowCtrls(e.rowNodes).forEach(s=>{if(!s.isFullWidth())return;s.refreshFullWidth()||this.redrawRow(s.getRowNode(),!0)}),this.dispatchDisplayedRowsChanged(!1))}getCellRendererInstances(e){var t;const s=this.getCellCtrls(e.rowNodes,e.columns).map(n=>n.getCellRenderer()).filter(n=>n!=null);if((t=e.columns)!=null&&t.length)return s;const i=[],r=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(n=>{if(r&&!this.isRowInMap(n.getRowNode(),r)||!n.isFullWidth())return;const o=n.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const l=o[a];l!=null&&i.push(l)}}),[...i,...s]}getCellEditorInstances(e){const t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(s=>{const i=s.getCellEditor();i&&t.push(i)}),t}getEditingCells(){const e=[];return this.getAllCellCtrls().forEach(t=>{if(t.isEditing()){const s=t.getCellPosition();e.push(s)}}),e}mapRowNodes(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach(s=>{const i=s.id;switch(s.rowPinned){case"top":t.top[i]=s;break;case"bottom":t.bottom[i]=s;break;default:t.normal[i]=s;break}}),t}isRowInMap(e,t){const s=e.id;switch(e.rowPinned){case"top":return t.top[s]!=null;case"bottom":return t.bottom[s]!=null;default:return t.normal[s]!=null}}getRowCtrls(e){const t=this.mapRowNodes(e),s=this.getAllRowCtrls();return!e||!t?s:s.filter(i=>{const r=i.getRowNode();return this.isRowInMap(r,t)})}getCellCtrls(e,t){let s;ve(t)&&(s={},t.forEach(r=>{const n=this.columnModel.getGridColumn(r);ve(n)&&(s[n.getId()]=!0)}));const i=[];return this.getRowCtrls(e).forEach(r=>{r.getAllCellCtrls().forEach(n=>{const o=n.getColumn().getId();s&&!s[o]||i.push(n)})}),i}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const e=[];ui(this.rowCtrlsByRowIndex,(s,i)=>{i.getRowNode().id==null&&e.push(s)}),this.removeRowCtrls(e);const t={};return ui(this.rowCtrlsByRowIndex,(s,i)=>{const r=i.getRowNode();t[r.id]=i}),this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){e.forEach(s=>{const i=this.rowCtrlsByRowIndex[s];i&&(i.destroyFirstPass(t),i.destroySecondPass()),delete this.rowCtrlsByRowIndex[s]})}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{afterScroll:t}=e;let s;this.stickyRowFeature&&c0()&&(s=this.getCellToRestoreFocusToAfterRefresh()||void 0);const i=this.firstRenderedRow,r=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let n=!1;this.stickyRowFeature&&(n=this.stickyRowFeature.checkStickyRows());const o=this.firstRenderedRow!==i||this.lastRenderedRow!==r;if(!(t&&!n&&!o)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t&&!n),s!=null)){const a=this.getCellToRestoreFocusToAfterRefresh();s!=null&&a==null&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(s))}}removeRowCompsNotToDraw(e,t){const s={};e.forEach(n=>s[n]=!0);const r=Object.keys(this.rowCtrlsByRowIndex).filter(n=>!s[n]);this.removeRowCtrls(r,t)}calculateIndexesToDraw(e){let t=sF(this.firstRenderedRow,this.lastRenderedRow);const s=(r,n)=>{const o=n.getRowNode().rowIndex;o!=null&&(o<this.firstRenderedRow||o>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(n)&&t.push(o)};ui(this.rowCtrlsByRowIndex,s),ui(e,s),t.sort((r,n)=>r-n);const i=[];for(let r=0;r<t.length;r++){const n=t[r],o=this.paginationProxy.getRow(n);o&&!o.sticky&&i.push(n)}return i}recycleRows(e,t=!1,s=!1){const i=this.calculateIndexesToDraw(e);(this.printLayout||s)&&(t=!1),this.removeRowCompsNotToDraw(i,!t),i.forEach(r=>{this.createOrUpdateRowCtrl(r,e,t,s)}),e&&(s&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)),this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){const t={type:w.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(t)}onDisplayedColumnsChanged(){const e=this.columnModel.isPinningLeft(),t=this.columnModel.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach(t=>{const s=t.getRowNode().rowIndex;e.push(s.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=this.mapRowNodes(e);return this.getAllRowCtrls().filter(s=>{if(!s.isFullWidth())return!1;const i=s.getRowNode();return!(t!=null&&!this.isRowInMap(i,t))})}createOrUpdateRowCtrl(e,t,s,i){let r,n=this.rowCtrlsByRowIndex[e];if(n||(r=this.paginationProxy.getRow(e),ve(r)&&ve(t)&&t[r.id]&&r.alreadyRendered&&(n=t[r.id],t[r.id]=null)),!n)if(r||(r=this.paginationProxy.getRow(e)),ve(r))n=this.createRowCon(r,s,i);else return;return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=n,n}destroyRowCtrls(e,t){const s=[];ui(e,(i,r)=>{if(r){if(this.cachedRowCtrls&&r.isCacheable()){this.cachedRowCtrls.addRow(r);return}r.destroyFirstPass(!t),t?(this.zombieRowCtrls[r.getInstanceId()]=r,s.push(()=>{r.destroySecondPass(),delete this.zombieRowCtrls[r.getInstanceId()]})):r.destroySecondPass()}}),t&&(s.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),cA(s))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=this.gos.getRowHeightAsNumber();return e*t}workOutFirstAndLastRowsToRender(){this.rowContainerHeightService.updateOffset();let e,t;if(!this.paginationProxy.isRowsToRender())e=0,t=-1;else if(this.printLayout)this.environment.refreshRowHeightVariable(),e=this.paginationProxy.getPageFirstRow(),t=this.paginationProxy.getPageLastRow();else{const a=this.getRowBufferInPixels(),l=this.ctrlsService.getGridBodyCtrl(),u=this.gos.get("suppressRowVirtualisation");let h=!1,p,g;do{const x=this.paginationProxy.getPixelOffset(),{pageFirstPixel:S,pageLastPixel:T}=this.paginationProxy.getCurrentPagePixelRange(),I=this.rowContainerHeightService.getDivStretchOffset(),V=l.getScrollFeature().getVScrollPosition(),j=V.top,P=V.bottom;u?(p=S+I,g=T+I):(p=Math.max(j+x-a,S)+I,g=Math.min(P+x+a,T)+I),this.firstVisibleVPixel=Math.max(j+x,S)+I,this.lastVisibleVPixel=Math.min(P+x,T)+I,h=this.ensureAllRowsInRangeHaveHeightsCalculated(p,g)}while(h);let m=this.paginationProxy.getRowIndexAtPixel(p),C=this.paginationProxy.getRowIndexAtPixel(g);const y=this.paginationProxy.getPageFirstRow(),R=this.paginationProxy.getPageLastRow();m<y&&(m=y),C>R&&(C=R),e=m,t=C}const s=this.gos.isDomLayout("normal"),i=this.gos.get("suppressMaxRenderedRowRestriction"),r=Math.max(this.getRowBuffer(),500);s&&!i&&t-e>r&&(t=e+r);const n=e!==this.firstRenderedRow,o=t!==this.lastRenderedRow;if(n||o){this.firstRenderedRow=e,this.lastRenderedRow=t;const a={type:w.EVENT_VIEWPORT_CHANGED,firstRow:e,lastRow:t};this.eventService.dispatchEvent(a)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const e={type:w.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(e)})}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const s=this.paginationProxy.ensureRowHeightsValid(e,t,-1,-1);return s&&this.updateContainerHeights(),s}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const i=e.getRowNode(),r=this.focusService.isRowNodeFocused(i),n=e.isEditing(),o=i.detail;return r||n||o?!!this.paginationProxy.isRowPresent(i):!1}createRowCon(e,t,s){const i=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(i)return i;const r=this.gos.get("suppressAnimationFrame"),n=s&&!r&&!this.printLayout;return new vl(e,this.beans,t,n,this.printLayout)}getRenderedNodes(){const e=this.rowCtrlsByRowIndex;return Object.values(e).map(t=>t.getRowNode())}getRowByPosition(e){let t;const{rowIndex:s}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[s];break;case"bottom":t=this.bottomRowCtrls[s];break;default:t=this.rowCtrlsByRowIndex[s],t||(t=this.getStickyTopRowCtrls().find(i=>i.getRowNode().rowIndex===s)||null,t||(t=this.getStickyBottomRowCtrls().find(i=>i.getRowNode().rowIndex===s)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}};f([A("animationFrameService")],mr.prototype,"animationFrameService",2);f([A("paginationProxy")],mr.prototype,"paginationProxy",2);f([A("columnModel")],mr.prototype,"columnModel",2);f([A("pinnedRowModel")],mr.prototype,"pinnedRowModel",2);f([A("rowModel")],mr.prototype,"rowModel",2);f([A("focusService")],mr.prototype,"focusService",2);f([A("beans")],mr.prototype,"beans",2);f([A("rowContainerHeightService")],mr.prototype,"rowContainerHeightService",2);f([A("ctrlsService")],mr.prototype,"ctrlsService",2);f([xe],mr.prototype,"postConstruct",1);mr=f([Le("rowRenderer")],mr);var GG=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e==null||e.id==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.getRowNode()!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,s=this.entriesMap[t];delete this.entriesMap[t],Vi(this.entriesList,s)}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],Vi(this.entriesList,e)}getEntries(){return this.entriesList}},Sh=class extends Se{init(){this.setPinnedTopRowData(),this.setPinnedBottomRowData(),this.addManagedPropertyListener("pinnedTopRowData",()=>this.setPinnedTopRowData()),this.addManagedPropertyListener("pinnedBottomRowData",()=>this.setPinnedBottomRowData())}isEmpty(e){const t=e==="top"?this.pinnedTopRows:this.pinnedBottomRows;return Pr(t)}isRowsToRender(e){return!this.isEmpty(e)}getRowAtPixel(e,t){const s=t==="top"?this.pinnedTopRows:this.pinnedBottomRows;if(Pr(s))return 0;for(let i=0;i<s.length;i++){const r=s[i];if(r.rowTop+r.rowHeight-1>=e)return i}return s.length-1}setPinnedTopRowData(){const e=this.gos.get("pinnedTopRowData");this.pinnedTopRows=this.createNodesFromData(e,!0);const t={type:w.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}setPinnedBottomRowData(){const e=this.gos.get("pinnedBottomRowData");this.pinnedBottomRows=this.createNodesFromData(e,!1);const t={type:w.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}createNodesFromData(e,t){const s=[];if(e){let i=0;e.forEach((r,n)=>{const o=new yt(this.beans);o.data=r;const a=t?yt.ID_PREFIX_TOP_PINNED:yt.ID_PREFIX_BOTTOM_PINNED;o.id=a+n,o.rowPinned=t?"top":"bottom",o.setRowTop(i),o.setRowHeight(this.gos.getRowHeightForNode(o).height),o.setRowIndex(n),i+=o.rowHeight,s.push(o)})}return s}getPinnedTopRowData(){return this.pinnedTopRows}getPinnedBottomRowData(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(e){return this.pinnedTopRows[e]}getPinnedBottomRow(e){return this.pinnedBottomRows[e]}forEachPinnedTopRow(e){Pr(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)}forEachPinnedBottomRow(e){Pr(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(e){if(!e||e.length===0)return 0;const t=Mt(e);return t.rowTop+t.rowHeight}};f([A("beans")],Sh.prototype,"beans",2);f([xe],Sh.prototype,"init",1);Sh=f([Le("pinnedRowModel")],Sh);var cv=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(e,t){if(e.children)for(let s=0;s<e.children.length;s++)this.depthFirstSearchChangedPath(e.children[s],t);t(e.rowNode)}depthFirstSearchEverything(e,t,s){if(e.childrenAfterGroup)for(let i=0;i<e.childrenAfterGroup.length;i++){const r=e.childrenAfterGroup[i];r.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[i],t,s):s&&t(r)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,s=!1){this.active&&!s?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,s=0;for(;!this.mapToItems[t.id];){const i={rowNode:t,children:null};this.mapToItems[t.id]=i,s++,t=t.parent}return s}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let s=e;for(;s;)this.nodeIdsToColumns[s.id]||(this.nodeIdsToColumns[s.id]={}),t.forEach(i=>this.nodeIdsToColumns[s.id][i.getId()]=!0),s=s.parent}linkPathItems(e,t){let s=e;for(let i=0;i<t;i++){const r=this.mapToItems[s.id],n=this.mapToItems[s.parent.id];n.children||(n.children=[]),n.children.push(r),s=s.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const s=this.createPathItems(e);this.linkPathItems(e,s),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const s=this.nodeIdsToColumns[e.id];return t.filter(r=>s[r.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const s=this.nodeIdsToColumns[e.id];return t.filter(r=>!s[r.getId()])}},Fu=class Ua extends Se{constructor(t){super(),this.state=Ua.STATE_WAITING_TO_LOAD,this.version=0,this.id=t}getId(){return this.id}load(){this.state=Ua.STATE_LOADING,this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state=Ua.STATE_WAITING_TO_LOAD}getState(){return this.state}pageLoadFailed(t){this.isRequestMostRecentAndLive(t)&&(this.state=Ua.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}success(t,s){this.successCommon(t,s)}pageLoaded(t,s,i){this.successCommon(t,{rowData:s,rowCount:i})}isRequestMostRecentAndLive(t){const s=t===this.version,i=this.isAlive();return s&&i}successCommon(t,s){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(t)&&(this.state=Ua.STATE_LOADED,this.processServerResult(s))}dispatchLoadCompleted(t=!0){const s={type:Ua.EVENT_LOAD_COMPLETE,success:t,block:this};this.dispatchEvent(s)}};Fu.EVENT_LOAD_COMPLETE="loadComplete";Fu.STATE_WAITING_TO_LOAD="needsLoading";Fu.STATE_LOADING="loading";Fu.STATE_LOADED="loaded";Fu.STATE_FAILED="failed";var lw=Fu,Vn=class extends Se{constructor(){super(...arguments),this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=nt.debounce(this.performCheckBlocksToLoad.bind(this),e))}setBeans(e){this.logger=e.create("RowNodeBlockLoader")}getMaxConcurrentDatasourceRequests(){const e=this.gos.get("maxConcurrentDatasourceRequests");if(e==null)return 2;if(!(e<=0))return e}addBlock(e){this.blocks.push(e),e.addEventListener(lw.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){nt.removeFromArray(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:Vn.BLOCK_LOADED_EVENT}),this.activeBlockLoadsCount==0&&this.dispatchEvent({type:Vn.BLOCK_LOADER_FINISHED_EVENT})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){this.logger.log("checkBlockToLoad: max loads exceeded");return}const e=this.getAvailableLoadingCount(),t=this.blocks.filter(s=>s.getState()===lw.STATE_WAITING_TO_LOAD).slice(0,e);this.registerLoads(t.length),t.forEach(s=>s.load()),this.printCacheStatus()}getBlockState(){if(this.gos.isRowModelType("serverSide"))return this.rowModel.getBlockStates();const e={};return this.blocks.forEach(t=>{const{id:s,state:i}=t.getBlockStateJson();e[s]=i}),e}printCacheStatus(){this.logger.isLogging()&&this.logger.log(`printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return this.maxConcurrentRequests!==void 0?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}};Vn.BLOCK_LOADED_EVENT="blockLoaded";Vn.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished";f([A("rowModel")],Vn.prototype,"rowModel",2);f([xe],Vn.prototype,"postConstruct",1);f([rn(0,Fr("loggerFactory"))],Vn.prototype,"setBeans",1);Vn=f([Le("rowNodeBlockLoader")],Vn);var xh=class extends Se{constructor(){super(...arguments),this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.pixelOffset=0,this.masterRowCount=0}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,w.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this)),this.onModelUpdated()}ensureRowHeightsValid(e,t,s,i){const r=this.rowModel.ensureRowHeightsValid(e,t,this.getPageFirstRow(),this.getPageLastRow());return r&&this.calculatePages(),r}isPaginateChildRows(){return this.gos.get("groupRemoveSingleChildren")||this.gos.get("groupRemoveLowestSingleChildren")?!0:this.gos.get("paginateChildRows")}onModelUpdated(e){this.calculatePages();const t={type:w.EVENT_PAGINATION_CHANGED,animate:e?e.animate:!1,newData:e?e.newData:!1,newPage:e?e.newPage:!1,newPageSize:e?e.newPageSize:!1,keepRenderedRows:e?e.keepRenderedRows:!1};this.eventService.dispatchEvent(t)}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages();const e={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(e)}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){if(!this.active||this.currentPage===e||typeof this.currentPage!="number")return;this.currentPage=e,this.calculatePages();const t={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!0,newPageSize:!1,keepRenderedRows:!1};this.eventService.dispatchEvent(t)}getPixelOffset(){return this.pixelOffset}getRow(e){return this.rowModel.getRow(e)}getRowNode(e){return this.rowModel.getRowNode(e)}getRowIndexAtPixel(e){return this.rowModel.getRowIndexAtPixel(e)}getCurrentPageHeight(){return ot(this.topRowBounds)||ot(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){const e=this.topRowBounds?this.topRowBounds.rowTop:0,t=this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0;return{pageFirstPixel:e,pageLastPixel:t}}isRowPresent(e){return this.rowModel.isRowPresent(e)?e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex:!1}isEmpty(){return this.rowModel.isEmpty()}isRowsToRender(){return this.rowModel.isRowsToRender()}forEachNode(e){return this.rowModel.forEachNode(e)}forEachNodeOnPage(e){const t=this.getPageFirstRow(),s=this.getPageLastRow();for(let i=t;i<=s;i++){const r=this.getRow(i);r&&e(r)}}getType(){return this.rowModel.getType()}getRowBounds(e){const t=this.rowModel.getRowBounds(e);return t.rowIndex=e,t}getPageFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getPageLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getRowCount(){return this.rowModel.getRowCount()}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){return this.active?this.getPageForIndex(e.rowIndex)===this.currentPage:!0}isLastPageFound(){return this.rowModel.isLastRowIndexKnown()}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return ve(this.pageSizeAutoCalculated)?this.pageSizeAutoCalculated:ve(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:ve(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:ve(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;if(this.pageSizeAutoCalculated=void 0,this.pageSize===e)return;this.calculatePages();const t={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!1};this.eventService.dispatchEvent(t)}setPageSize(e,t){const s=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}if(s!==this.pageSize){this.calculatePages();const i={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!0};this.eventService.dispatchEvent(i)}}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(ve(this.topRowBounds)?this.topRowBounds.rowTop:0)}setPixelOffset(e){this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0){this.setZeroRows();return}const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let s=this.pageSize*(this.currentPage+1)-1;if(s>e&&(s=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),s===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const i=this.rowModel.getTopLevelRowDisplayedIndex(s+1);this.bottomDisplayedRowIndex=i-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),this.masterRowCount===0){this.setZeroRows();return}const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}};f([A("rowModel")],xh.prototype,"rowModel",2);f([xe],xh.prototype,"postConstruct",1);xh=f([Le("paginationProxy")],xh);var Nf=class extends Se{processAllCellClasses(e,t,s,i){this.processClassRules(void 0,e.cellClassRules,t,s,i),this.processStaticCellClasses(e,t,s)}processClassRules(e,t,s,i,r){if(t==null&&e==null)return;const n={},o={},a=(l,u)=>{l.split(" ").forEach(h=>{h.trim()!=""&&u(h)})};if(t){const l=Object.keys(t);for(let u=0;u<l.length;u++){const h=l[u],p=t[h];let g;typeof p=="string"?g=this.expressionService.evaluate(p,s):typeof p=="function"&&(g=p(s)),a(h,m=>{g?n[m]=!0:o[m]=!0})}}e&&r&&Object.keys(e).forEach(l=>a(l,u=>{n[u]||(o[u]=!0)})),r&&Object.keys(o).forEach(r),Object.keys(n).forEach(i)}getStaticCellClasses(e,t){const{cellClass:s}=e;if(!s)return[];let i;return typeof s=="function"?i=s(t):i=s,typeof i=="string"&&(i=[i]),i||[]}processStaticCellClasses(e,t,s){this.getStaticCellClasses(e,t).forEach(r=>{s(r)})}};f([A("expressionService")],Nf.prototype,"expressionService",2);Nf=f([Le("stylingService")],Nf);var TN=class extends Ym{constructor(e){super(e,"ag-toggle-button")}setValue(e,t){return super.setValue(e,t),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}},VG=class extends on{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const s=super.setValue(e,t);return this.eInput.value=e,s}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},BG=class extends Wl{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));const e=Gn();this.addManagedListener(this.eInput,"mousedown",()=>{this.isDisabled()||e||this.eInput.focus()}),this.eInput.step="any"}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}setMin(e){var t;const s=e instanceof Date?(t=_r(e??null,!1))!=null?t:void 0:e;return this.min===s?this:(this.min=s,Ln(this.eInput,"min",s),this)}setMax(e){var t;const s=e instanceof Date?(t=_r(e??null,!1))!=null?t:void 0:e;return this.max===s?this:(this.max=s,Ln(this.eInput,"max",s),this)}setStep(e){return this.step===e?this:(this.step=e,Ln(this.eInput,"step",e),this)}getDate(){var e;if(this.eInput.validity.valid)return(e=Ui(this.getValue()))!=null?e:void 0}setDate(e,t){this.setValue(_r(e??null,!1),t)}},HG=class extends on{constructor(e){super(e,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min:e,max:t,step:s}=this.config;e!=null&&this.setMinValue(e),t!=null&&this.setMaxValue(t),this.setStep(s||1)}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>{const t=e.target.value;this.setValue(t)})}setMinValue(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this}setMaxValue(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this}setStep(e){return this.eInput.setAttribute("step",e.toString()),this}setValue(e,t){this.min!=null&&(e=Math.max(parseFloat(e),this.min).toString()),this.max!=null&&(e=Math.min(parseFloat(e),this.max).toString());const s=super.setValue(e,t);return this.eInput.value=e,s}},W0=class extends at{constructor(e,t){super('<div class="ag-rich-select-row" role="presentation"></div>'),this.params=e,this.wrapperEl=t}postConstruct(){this.addManagedListener(this.getGui(),"click",this.onClick.bind(this))}setState(e){let t="";this.params.valueFormatter&&(t=this.params.valueFormatter(e)),this.populateWithRenderer(e,t)||this.populateWithoutRenderer(e,t),this.value=e}highlightString(e){const{parsedValue:t}=this;if(this.params.cellRenderer||!ve(t))return;let s=ve(e);if(s){const i=t==null?void 0:t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(i>=0){const r=i+e.length,n=Ds(t.slice(0,i),!0),o=Ds(t.slice(i,r),!0),a=Ds(t.slice(r));this.renderValueWithoutRenderer(`${n}<span class="ag-rich-select-row-text-highlight">${o}</span>${a}`)}else s=!1}s||this.renderValueWithoutRenderer(t)}updateHighlighted(e){var t;const s=this.getGui(),i=`ag-rich-select-row-${this.getCompId()}`;if((t=s.parentElement)==null||t.setAttribute("id",i),e){const r=this.getParentComponent().getAriaElement();s0(r,i),this.wrapperEl.setAttribute("data-active-option",i)}eu(s.parentElement,e),this.addOrRemoveCssClass("ag-rich-select-row-selected",e)}populateWithoutRenderer(e,t){const s=this.gos.getDocument(),i=this.getGui(),r=s.createElement("span");r.style.overflow="hidden",r.style.textOverflow="ellipsis";const n=Ds(ve(t)?t:e,!0);this.parsedValue=ve(n)?n:null,i.appendChild(r),this.renderValueWithoutRenderer(n),this.setTooltip({newTooltipText:this.parsedValue,shouldDisplayTooltip:()=>r.scrollWidth>r.clientWidth})}renderValueWithoutRenderer(e){const t=this.getGui().querySelector("span");t&&(t.innerHTML=ve(e)?e:"&nbsp;")}populateWithRenderer(e,t){let s,i;return this.params.cellRenderer&&(i=this.userComponentFactory.getCellRendererDetails(this.params,{value:e,valueFormatted:t,setTooltip:(r,n)=>{this.setTooltip({newTooltipText:r,shouldDisplayTooltip:n})}})),i&&(s=i.newAgStackInstance()),s&&S0(s,this.getGui()),s?(s.then(r=>{this.addDestroyFunc(()=>{this.getContext().destroyBean(r)})}),!0):!1}onClick(){const e=this.getParentComponent(),t={type:w.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:!1,value:this.value};e==null||e.dispatchEvent(t)}};f([A("userComponentFactory")],W0.prototype,"userComponentFactory",2);f([xe],W0.prototype,"postConstruct",1);var Tp=class DN extends Ep{constructor(t){super(DN.getTemplate((t==null?void 0:t.cssIdentifier)||"default")),this.renderedRows=new Map,this.rowHeight=20,this.pageSize=-1,this.isScrolling=!1,this.isHeightFromTheme=!0;const{cssIdentifier:s="default",ariaRole:i="listbox",listName:r}=t||{};this.cssIdentifier=s,this.ariaRole=i,this.listName=r}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:t=>this.onFocusIn(t),onFocusOut:t=>this.onFocusOut(t),focusInnerElement:t=>this.focusInnerElement(t),onTabKeyDown:t=>this.onTabKeyDown(t),handleKeyDown:t=>this.handleKeyDown(t)}),this.setAriaProperties(),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}onGridStylesChanged(){this.rowHeight=this.getItemHeight(),this.refresh()}setAriaProperties(){const s=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),i=this.eContainer;fs(i,this.ariaRole),fr(i,s)}addResizeObserver(){const t=()=>this.animationFrameService.requestAnimationFrame(()=>this.drawVirtualRows()),s=this.resizeObserverService.observeResize(this.getGui(),t);this.addDestroyFunc(s)}focusInnerElement(t){this.focusRow(t?this.model.getRowCount()-1:0)}onFocusIn(t){const s=t.target;s.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=LA(s)-1)}onFocusOut(t){this.getFocusableElement().contains(t.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(t){switch(t.key){case U.UP:case U.DOWN:this.navigate(t.key===U.UP)&&t.preventDefault();break;case U.PAGE_HOME:case U.PAGE_END:case U.PAGE_UP:case U.PAGE_DOWN:this.navigateToPage(t.key)!==null&&t.preventDefault();break}}onTabKeyDown(t){this.navigate(t.shiftKey)?t.preventDefault():(gn(t),this.forceFocusOutOfContainer(t.shiftKey))}navigate(t){if(this.lastFocusedRowIndex==null)return!1;const s=this.lastFocusedRowIndex+(t?-1:1);return s<0||s>=this.model.getRowCount()?!1:(this.focusRow(s),!0)}navigateToPage(t,s="focused"){let i=!1;s==="focused"&&(s=this.getLastFocusedRow(),i=!0);const r=this.model.getRowCount()-1;let n=-1;return t===U.PAGE_HOME?n=0:t===U.PAGE_END?n=r:t===U.PAGE_DOWN?n=Math.min(s+this.pageSize,r):t===U.PAGE_UP&&(n=Math.max(s-this.pageSize,0)),n===-1?null:(i?this.focusRow(n):this.ensureIndexVisible(n),n)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(t){this.isScrolling||(this.isScrolling=!0,this.ensureIndexVisible(t),this.animationFrameService.requestAnimationFrame(()=>{if(this.isScrolling=!1,!this.isAlive())return;const s=this.renderedRows.get(t);s&&s.eDiv.focus()}))}getComponentAt(t){const s=this.renderedRows.get(t);return s&&s.rowComponent}forEachRenderedRow(t){this.renderedRows.forEach((s,i)=>t(s.rowComponent,i))}static getTemplate(t){return`<div class="ag-virtual-list-viewport ag-${t}-virtual-list-viewport" role="presentation">
                <div class="ag-virtual-list-container ag-${t}-virtual-list-container" ref="eContainer"></div>
            </div>`}getItemHeight(){return this.isHeightFromTheme?this.environment.getListItemHeight():this.rowHeight}ensureIndexVisible(t,s=!0){const i=this.model.getRowCount();if(typeof t!="number"||t<0||t>=i)return console.warn("AG Grid: invalid row index for ensureIndexVisible: "+t),!1;const r=t*this.rowHeight,n=r+this.rowHeight,o=this.getGui(),a=o.scrollTop,l=o.offsetHeight,u=a+l,h=s?0:this.rowHeight,p=a>r+h,g=u<n-h;if(p)return o.scrollTop=r,!0;if(g){const m=n-l;return o.scrollTop=m,!0}return!1}setComponentCreator(t){this.componentCreator=t}setComponentUpdater(t){this.componentUpdater=t}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(t){this.isHeightFromTheme=!1,this.rowHeight=t,this.refresh()}refresh(t){if(this.model==null||!this.isAlive())return;const s=this.model.getRowCount();this.eContainer.style.height=`${s*this.rowHeight}px`,qS(()=>this.eContainer.clientHeight>=s*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(t)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(t){return!!(t&&this.renderedRows.size&&typeof this.model.areRowsEqual=="function"&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((t,s)=>this.removeRow(s))}drawVirtualRows(t){if(!this.isAlive()||!this.model)return;const s=this.getGui(),i=s.scrollTop,r=i+s.offsetHeight,n=Math.floor(i/this.rowHeight),o=Math.floor(r/this.rowHeight);this.pageSize=Math.floor((r-i)/this.rowHeight),this.ensureRowsRendered(n,o,t)}ensureRowsRendered(t,s,i){this.renderedRows.forEach((r,n)=>{(n<t||n>s)&&n!==this.lastFocusedRowIndex&&this.removeRow(n)}),i&&this.refreshRows();for(let r=t;r<=s;r++)this.renderedRows.has(r)||r<this.model.getRowCount()&&this.insertRow(r)}insertRow(t){const s=this.model.getRow(t),i=document.createElement("div");i.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),fs(i,this.ariaRole==="tree"?"treeitem":"option"),Gm(i,this.model.getRowCount()),Vm(i,t+1),i.setAttribute("tabindex","-1"),i.style.height=`${this.rowHeight}px`,i.style.top=`${this.rowHeight*t}px`;const r=this.componentCreator(s,i);r.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=t),i.appendChild(r.getGui()),this.renderedRows.has(t-1)?this.renderedRows.get(t-1).eDiv.insertAdjacentElement("afterend",i):this.renderedRows.has(t+1)?this.renderedRows.get(t+1).eDiv.insertAdjacentElement("beforebegin",i):this.eContainer.appendChild(i),this.renderedRows.set(t,{rowComponent:r,eDiv:i,value:s})}removeRow(t){const s=this.renderedRows.get(t);this.eContainer.removeChild(s.eDiv),this.destroyBean(s.rowComponent),this.renderedRows.delete(t)}refreshRows(){const t=this.model.getRowCount();this.renderedRows.forEach((s,i)=>{var r,n;if(i>=t)this.removeRow(i);else{const o=this.model.getRow(i);(n=(r=this.model).areRowsEqual)!=null&&n.call(r,s.value,o)?this.componentUpdater(o,s.rowComponent):this.removeRow(i)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(t){this.model=t}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}};f([A("resizeObserverService")],Tp.prototype,"resizeObserverService",2);f([A("animationFrameService")],Tp.prototype,"animationFrameService",2);f([Fe("eContainer")],Tp.prototype,"eContainer",2);f([xe],Tp.prototype,"postConstruct",1);var PN=Tp,jG=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-rich-select-value ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,uv=class extends jl{constructor(e){var t,s;super(rs(Xe({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list",className:"ag-rich-select",pickerIcon:"smallDown",ariaRole:"combobox",template:(t=e==null?void 0:e.template)!=null?t:jG,modalPicker:!1},e),{maxPickerHeight:(s=e==null?void 0:e.maxPickerHeight)!=null?s:"calc(var(--ag-row-height) * 6.5)"})),this.searchString="",this.highlightedItem=-1,this.lastRowHovered=-1,this.searchStringCreator=null;const{cellRowHeight:i,value:r,valueList:n,searchStringCreator:o}=e||{};i!=null&&(this.cellRowHeight=i),r!==void 0&&(this.value=r),n!=null&&(this.values=n),o&&(this.searchStringCreator=o)}postConstruct(){super.postConstruct(),this.createLoadingElement(),this.createListComponent();const{allowTyping:e,placeholder:t}=this.config;e?(this.eInput.setAutoComplete(!1).setInputPlaceholder(t),this.eDisplayField.classList.add("ag-hidden")):this.eInput.setDisplayed(!1),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{searchDebounceDelay:s=300}=this.config;this.clearSearchString=xi(this.clearSearchString,s),this.renderSelectedValue(),e&&(this.eInput.onValueChange(i=>this.searchTextFromString(i)),this.addManagedListener(this.eWrapper,"focus",this.onWrapperFocus.bind(this))),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}createLoadingElement(){const e=this.gos.getDocument(),t=this.localeService.getLocaleTextFunc(),s=e.createElement("div");s.classList.add("ag-loading-text"),s.innerText=t("loadingOoo","Loading..."),this.eLoading=s}createListComponent(){this.listComponent=this.createBean(new PN({cssIdentifier:"rich-select"})),this.listComponent.setComponentCreator(this.createRowComponent.bind(this));const e=(a,l)=>{};this.listComponent.setComponentUpdater(e),this.listComponent.setParentComponent(this),this.addManagedListener(this.listComponent,w.EVENT_FIELD_PICKER_VALUE_SELECTED,a=>{this.onListValueSelected(a.value,a.fromEnterKey)});const{cellRowHeight:t}=this;t&&this.listComponent.setRowHeight(t);const s=this.listComponent.getGui(),i=this.listComponent.getAriaElement();this.addManagedListener(s,"mousemove",this.onPickerMouseMove.bind(this)),this.addManagedListener(s,"mousedown",a=>a.preventDefault()),s.classList.add("ag-rich-select-list");const r=`ag-rich-select-list-${this.listComponent.getCompId()}`;i.setAttribute("id",r);const o=this.localeService.getLocaleTextFunc()(this.config.pickerAriaLabelKey,this.config.pickerAriaLabelValue);fr(i,o),n0(this.eWrapper,i)}renderSelectedValue(){const{value:e,eDisplayField:t,config:s}=this,{allowTyping:i,initialInputValue:r}=this.config,n=this.config.valueFormatter?this.config.valueFormatter(e):e;if(i){this.eInput.setValue(r??n);return}let o;s.cellRenderer&&(o=this.userComponentFactory.getCellRendererDetails(this.config,{value:e,valueFormatted:n}));let a;if(o&&(a=o.newAgStackInstance()),a)xs(t),S0(a,t),a.then(l=>{this.addDestroyFunc(()=>this.getContext().destroyBean(l))});else{if(ve(this.value))t.innerText=n,t.classList.remove("ag-display-as-placeholder");else{const{placeholder:l}=s;ve(l)?(t.innerHTML=`${Ds(l)}`,t.classList.add("ag-display-as-placeholder")):xs(t)}this.setTooltip({newTooltipText:n??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth})}}getCurrentValueIndex(){const{currentList:e,value:t}=this;if(t==null||!e)return-1;for(let s=0;s<e.length;s++)if(e[s]===t)return s;return-1}highlightFilterMatch(){var e;(e=this.listComponent)==null||e.forEachRenderedRow((t,s)=>{t.highlightString(this.searchString)})}highlightSelectedValue(e){var t;e==null&&(e=this.getCurrentValueIndex()),this.highlightedItem=e,(t=this.listComponent)==null||t.forEachRenderedRow((s,i)=>{const r=e===-1?!1:this.highlightedItem===i;s.updateHighlighted(r)})}setRowHeight(e){e!==this.cellRowHeight&&(this.cellRowHeight=e),this.listComponent&&this.listComponent.setRowHeight(e)}createPickerComponent(){const{values:e}=this;return e&&this.setValueList({valueList:e}),this.listComponent}setSearchStringCreator(e){this.searchStringCreator=e}setValueList(e){const{valueList:t,refresh:s}=e;this.listComponent&&this.currentList!==t&&(this.currentList=t,this.listComponent.setModel({getRowCount:()=>t.length,getRow:i=>t[i],areRowsEqual:(i,r)=>i===r}),s&&(this.values?this.listComponent.refresh(!0):(this.values=t,this.isPickerDisplayed&&this.showCurrentValueInPicker())))}showPicker(){super.showPicker(),this.showCurrentValueInPicker(),this.displayOrHidePicker()}showCurrentValueInPicker(){var e,t;if(!this.listComponent)return;if(!this.currentList){this.isPickerDisplayed&&this.eLoading&&this.listComponent.appendChild(this.eLoading);return}(e=this.eLoading)!=null&&e.offsetParent&&((t=this.eLoading.parentElement)==null||t.removeChild(this.eLoading));const s=this.getCurrentValueIndex();s!==-1?(this.listComponent.refresh(),this.listComponent.ensureIndexVisible(s),this.listComponent.refresh(!0),this.highlightSelectedValue(s)):this.listComponent.refresh()}beforeHidePicker(){this.highlightedItem=-1,super.beforeHidePicker()}onWrapperFocus(){if(!this.eInput)return;const e=this.eInput.getFocusableElement();e.focus(),e.select()}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}buildSearchStringFromKeyboardEvent(e){let{key:t}=e;if(t===U.BACKSPACE)this.searchString=this.searchString.slice(0,-1),t="";else if(!Wm(e))return;e.preventDefault(),this.searchTextFromCharacter(t)}searchTextFromCharacter(e){this.searchString+=e,this.runSearch(),this.clearSearchString()}searchTextFromString(e){e==null&&(e=""),this.searchString=e,this.runSearch()}buildSearchStrings(e){const{valueFormatter:t=i=>i}=this.config;let s;return typeof e[0]=="number"||typeof e[0]=="string"?s=e.map(i=>t(i)):typeof e[0]=="object"&&this.searchStringCreator&&(s=this.searchStringCreator(e)),s}getSuggestionsAndFilteredValues(e,t){let s=[],i=[];if(!e.length)return{suggestions:s,filteredValues:i};const{searchType:r="fuzzy",filterList:n}=this.config;if(r==="fuzzy"){const o=fp(this.searchString,t,!0);s=o.values;const a=o.indices;if(n&&a.length)for(let l=0;l<a.length;l++)i.push(this.values[a[l]])}else s=t.filter((o,a)=>{const l=o.toLocaleLowerCase(),u=this.searchString.toLocaleLowerCase(),h=r==="match"?l.startsWith(u):l.indexOf(u)!==-1;return n&&h&&i.push(this.values[a]),h});return{suggestions:s,filteredValues:i}}filterListModel(e){const{filterList:t}=this.config;t&&(this.setValueList({valueList:e,refresh:!0}),this.alignPickerToComponent())}runSearch(){var e,t;const{values:s}=this,i=this.buildSearchStrings(s);if(!i){this.highlightSelectedValue(-1);return}const{suggestions:r,filteredValues:n}=this.getSuggestionsAndFilteredValues(this.searchString,i),{filterList:o,highlightMatch:a,searchType:l="fuzzy"}=this.config,u=n.length,h=!!(o&&this.searchString!=="");if(this.filterListModel(h?n:s),r.length){const p=h?0:i.indexOf(r[0]);this.selectListItem(p)}else if(this.highlightSelectedValue(-1),!h||u)(e=this.listComponent)==null||e.ensureIndexVisible(0);else if(h){this.getAriaElement().removeAttribute("data-active-option");const p=(t=this.listComponent)==null?void 0:t.getAriaElement();p&&s0(p,null)}a&&l!=="fuzzy"&&this.highlightFilterMatch(),this.displayOrHidePicker()}displayOrHidePicker(){var e;const t=(e=this.listComponent)==null?void 0:e.getGui(),s=this.currentList?this.currentList.length===0:!1;t==null||t.classList.toggle("ag-hidden",s)}clearSearchString(){this.searchString=""}selectListItem(e,t){if(!this.isPickerDisplayed||!this.currentList||!this.listComponent||e<0||e>=this.currentList.length)return;this.listComponent.ensureIndexVisible(e,!t)&&!t&&this.listComponent.refresh(!0),this.highlightSelectedValue(e)}setValue(e,t,s){const i=this.currentList?this.currentList.indexOf(e):-1;return i===-1?this:(this.value=e,s||this.selectListItem(i),this.renderSelectedValue(),super.setValue(e,t))}createRowComponent(e){const t=new W0(this.config,this.eWrapper);t.setParentComponent(this.listComponent),this.getContext().createBean(t),t.setState(e);const{highlightMatch:s,searchType:i="fuzzy"}=this.config;return s&&i!=="fuzzy"&&t.highlightString(this.searchString),t}getRowForMouseEvent(e){const{listComponent:t}=this;if(!t)return-1;const i=(t==null?void 0:t.getGui()).getBoundingClientRect(),r=t.getScrollTop(),n=e.clientY-i.top+r;return Math.floor(n/t.getRowHeight())}onPickerMouseMove(e){if(!this.listComponent)return;const t=this.getRowForMouseEvent(e);t!==-1&&t!=this.lastRowHovered&&(this.lastRowHovered=t,this.selectListItem(t,!0))}onNavigationKeyDown(e,t){e.preventDefault();const s=t===U.DOWN;if(!this.isPickerDisplayed&&s){this.showPicker();return}const i=this.highlightedItem,n=i===-1?0:i+(s?1:-1);this.selectListItem(n)}onPageNavigation(e){var t;if(!this.isPickerDisplayed)return;const s=(t=this.listComponent)==null?void 0:t.navigateToPage(e,this.highlightedItem);s!=null&&this.animationFrameService.requestAnimationFrame(()=>{if(!this.isAlive())return null;this.highlightSelectedValue(s)})}onEnterKeyDown(e){this.isPickerDisplayed&&(e.preventDefault(),this.currentList&&this.onListValueSelected(this.currentList[this.highlightedItem],!0))}onTabKeyDown(){!this.isPickerDisplayed||!this.currentList||this.setValue(this.currentList[this.highlightedItem],!1,!0)}onListValueSelected(e,t){this.setValue(e,!1,!0),this.dispatchPickerEvent(e,t),this.hidePicker()}dispatchPickerEvent(e,t){const s={type:w.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:t,value:e};this.dispatchEvent(s)}getFocusableElement(){const{allowTyping:e}=this.config;return e?this.eInput.getFocusableElement():super.getFocusableElement()}onKeyDown(e){const t=e.key,{allowTyping:s}=this.config;switch(t){case U.LEFT:case U.RIGHT:s||e.preventDefault();break;case U.PAGE_HOME:case U.PAGE_END:if(s){e.preventDefault();const i=this.eInput.getInputElement(),r=t===U.PAGE_HOME?0:i.value.length;i.setSelectionRange(r,r);break}case U.PAGE_UP:case U.PAGE_DOWN:e.preventDefault(),this.onPageNavigation(t);break;case U.DOWN:case U.UP:this.onNavigationKeyDown(e,t);break;case U.ESCAPE:this.isPickerDisplayed&&(Zi(this.listComponent.getGui())&&(e.preventDefault(),gn(e)),this.hidePicker());break;case U.ENTER:this.onEnterKeyDown(e);break;case U.TAB:this.onTabKeyDown();break;default:s||this.buildSearchStringFromKeyboardEvent(e)}}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),this.eLoading=void 0,super.destroy()}};f([A("userComponentFactory")],uv.prototype,"userComponentFactory",2);f([A("animationFrameService")],uv.prototype,"animationFrameService",2);f([Fe("eInput")],uv.prototype,"eInput",2);var Nu=class AN extends R0{constructor(t){super(t,AN.TEMPLATE),this.labelAlignment="top"}init(){this.eSlider.addCssClass("ag-slider-field");const{minValue:t,maxValue:s,textFieldWidth:i,step:r,value:n,onValueChange:o}=this.config;t!=null&&this.setMinValue(t),s!=null&&this.setMaxValue(s),i!=null&&this.setTextFieldWidth(i),r!=null&&this.setStep(r),n!=null&&this.setValue(n),o!=null&&this.onValueChange(o)}onValueChange(t){const s=w.EVENT_FIELD_VALUE_CHANGED;return this.addManagedListener(this.eText,s,()=>{const i=parseFloat(this.eText.getValue());this.eSlider.setValue(i.toString(),!0),t(i||0)}),this.addManagedListener(this.eSlider,s,()=>{const i=this.eSlider.getValue();this.eText.setValue(i,!0),t(parseFloat(i))}),this}setSliderWidth(t){return this.eSlider.setWidth(t),this}setTextFieldWidth(t){return this.eText.setWidth(t),this}setMinValue(t){return this.eSlider.setMinValue(t),this.eText.setMin(t),this}setMaxValue(t){return this.eSlider.setMaxValue(t),this.eText.setMax(t),this}getValue(){return this.eText.getValue()}setValue(t,s){return this.getValue()===t?this:(this.eText.setValue(t,!0),this.eSlider.setValue(t,!0),s||this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED}),this)}setStep(t){return this.eSlider.setStep(t),this.eText.setStep(t),this}};Nu.TEMPLATE=`<div class="ag-slider">
            <label ref="eLabel"></label>
            <div class="ag-wrapper ag-slider-wrapper">
                <ag-input-range ref="eSlider"></ag-input-range>
                <ag-input-number-field ref="eText"></ag-input-number-field>
            </div>
        </div>`;f([Fe("eLabel")],Nu.prototype,"eLabel",2);f([Fe("eSlider")],Nu.prototype,"eSlider",2);f([Fe("eText")],Nu.prototype,"eText",2);f([xe],Nu.prototype,"init",1);var WG=Nu,Da=class oc extends at{constructor(t={}){super(oc.getTemplate(t)),this.params=t,this.suppressEnabledCheckbox=!0,this.suppressToggleExpandOnEnableChange=!1;const{enabled:s,items:i,suppressEnabledCheckbox:r,expanded:n,suppressToggleExpandOnEnableChange:o,useToggle:a}=t;this.cssIdentifier=t.cssIdentifier||"default",this.enabled=s??!0,this.items=i||[],this.useToggle=a??!1,this.alignItems=t.alignItems||"center",this.expanded=n??!0,r!=null&&(this.suppressEnabledCheckbox=r),o!=null&&(this.suppressToggleExpandOnEnableChange=o)}static getTemplate(t){const s=t.cssIdentifier||"default",i=t.direction||"vertical";return`
            <div class="ag-group ag-${s}-group" role="presentation">
                <div ref="eToolbar" class="ag-group-toolbar ag-${s}-group-toolbar">
                    <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>
                </div>
                <div ref="eContainer" class="ag-group-container ag-group-container-${i} ag-${s}-group-container"></div>
            </div>
        `}postConstruct(){if(this.setupTitleBar(),this.items.length){const r=this.items;this.items=[],this.addItems(r)}const t=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(t("enabled","Enabled")),this.enabled&&this.setEnabled(this.enabled,void 0,!0),this.setAlignItems(this.alignItems);const{onEnableChange:s,suppressOpenCloseIcons:i}=this.params;this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(i??!1),this.refreshChildDisplay(),Dt(this.eContainer,this.expanded),this.cbGroupEnabled.onValueChange(r=>{this.setEnabled(r,!0,this.suppressToggleExpandOnEnableChange),this.dispatchEnableChangeEvent(r)}),s!=null&&this.onEnableChange(s)}refreshChildDisplay(){var t;Dt(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),(t=this.eTitleBar)==null||t.refreshOnExpand(this.expanded)}isExpanded(){return this.expanded}setAlignItems(t){this.alignItems!==t&&this.removeCssClass(`ag-group-item-alignment-${this.alignItems}`),this.alignItems=t;const s=`ag-group-item-alignment-${this.alignItems}`;return this.addCssClass(s),this}toggleGroupExpand(t){var s;let i=!1;if((s=this.eTitleBar)!=null&&s.isSuppressCollapse()&&!this.useToggle)t=!0,i=!0;else if(t=t??!this.expanded,this.expanded===t)return this;return this.expanded=t,this.refreshChildDisplay(),Dt(this.eContainer,t),i||this.dispatchEvent({type:t?oc.EVENT_EXPANDED:oc.EVENT_COLLAPSED}),this}addItems(t){t.forEach(s=>this.addItem(s))}prependItem(t){this.insertItem(t,!0)}addItem(t){this.insertItem(t,!1)}insertItem(t,s){const i=this.eContainer,r=t instanceof at?t.getGui():t;r.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),s?(i.insertAdjacentElement("afterbegin",r),this.items.unshift(r)):(i.appendChild(r),this.items.push(r))}hideItem(t,s){const i=this.items[s];Dt(i,!t)}getItemIndex(t){const s=t instanceof at?t.getGui():t;return this.items.indexOf(s)}setTitle(t){var s;return(s=this.eTitleBar)==null||s.setTitle(t),this}addTitleBarWidget(t){var s;return(s=this.eTitleBar)==null||s.addWidget(t),this}addCssClassToTitleBar(t){var s;(s=this.eTitleBar)==null||s.addCssClass(t)}dispatchEnableChangeEvent(t){const s={type:oc.EVENT_ENABLE_CHANGE,enabled:t};this.dispatchEvent(s)}setEnabled(t,s,i){var r;return this.enabled=t,this.refreshDisabledStyles(),i||this.toggleGroupExpand(t),s||(this.cbGroupEnabled.setValue(t),(r=this.eToggle)==null||r.setValue(t)),this}isEnabled(){return this.enabled}onEnableChange(t){return this.addManagedListener(this,oc.EVENT_ENABLE_CHANGE,s=>t(s.enabled)),this}hideEnabledCheckbox(t){return this.suppressEnabledCheckbox=t,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(t){var s;return(s=this.eTitleBar)==null||s.hideOpenCloseIcons(t),this}refreshDisabledStyles(){var t;const s=!this.enabled;this.eContainer.classList.toggle("ag-disabled",s),(t=this.eTitleBar)==null||t.refreshDisabledStyles(this.suppressEnabledCheckbox&&s),this.eContainer.classList.toggle("ag-disabled-group-container",s)}setupTitleBar(){const t=this.useToggle?this.createToggleTitleBar():this.createDefaultTitleBar();this.eToolbar.insertAdjacentElement("beforebegin",t.getGui())}createDefaultTitleBar(){const t=this.createManagedBean(new PE(this.params));return this.eTitleBar=t,t.refreshOnExpand(this.expanded),this.addManagedListener(t,PE.EVENT_EXPAND_CHANGED,s=>this.toggleGroupExpand(s.expanded)),t}createToggleTitleBar(){var t;const s=this.createManagedBean(new TN({value:this.enabled,label:this.params.title,labelAlignment:"left",labelWidth:"flex",onValueChange:i=>{this.setEnabled(i,!0),this.dispatchEnableChangeEvent(i)}}));return s.addCssClass("ag-group-title-bar"),s.addCssClass(`ag-${(t=this.params.cssIdentifier)!=null?t:"default"}-group-title-bar ag-unselectable`),this.eToggle=s,this.toggleGroupExpand(this.enabled),s}};Da.EVENT_EXPANDED="expanded";Da.EVENT_COLLAPSED="collapsed";Da.EVENT_ENABLE_CHANGE="enableChange";f([Fe("eToolbar")],Da.prototype,"eToolbar",2);f([Fe("cbGroupEnabled")],Da.prototype,"cbGroupEnabled",2);f([Fe("eContainer")],Da.prototype,"eContainer",2);f([xe],Da.prototype,"postConstruct",1);var zG=Da,fC="ag-disabled-group-title-bar",Iu=class cw extends at{constructor(t={}){super(cw.getTemplate(t)),this.suppressOpenCloseIcons=!1;const{title:s,suppressOpenCloseIcons:i}=t;s&&s.length>0&&(this.title=s),i!=null&&(this.suppressOpenCloseIcons=i)}static getTemplate(t){var s;const i=(s=t.cssIdentifier)!=null?s:"default";return`
            <div class="ag-group-title-bar ag-${i}-group-title-bar ag-unselectable" role="button">
                <span class="ag-group-title-bar-icon ag-${i}-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>
                <span class="ag-group-title-bar-icon ag-${i}-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>
                <span ref="eTitle" class="ag-group-title ag-${i}-group-title"></span>
            </div>
        `}postConstruct(){this.setTitle(this.title),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract()}setupExpandContract(){this.eGroupClosedIcon.appendChild(Er("columnSelectClosed",this.gos,null)),this.eGroupOpenedIcon.appendChild(Er("columnSelectOpen",this.gos,null)),this.addManagedListener(this.getGui(),"click",()=>this.dispatchExpandChanged()),this.addManagedListener(this.getGui(),"keydown",t=>{switch(t.key){case U.ENTER:case U.SPACE:t.preventDefault(),this.dispatchExpandChanged();break;case U.RIGHT:case U.LEFT:t.preventDefault(),this.dispatchExpandChanged(t.key===U.RIGHT);break}})}refreshOnExpand(t){this.refreshAriaStatus(t),this.refreshOpenCloseIcons(t)}refreshAriaStatus(t){this.suppressOpenCloseIcons||co(this.getGui(),t)}refreshOpenCloseIcons(t){const s=!this.suppressOpenCloseIcons;Dt(this.eGroupOpenedIcon,s&&t),Dt(this.eGroupClosedIcon,s&&!t)}isSuppressCollapse(){return this.suppressOpenCloseIcons}dispatchExpandChanged(t){const s={type:cw.EVENT_EXPAND_CHANGED,expanded:t};this.dispatchEvent(s)}setTitle(t){const s=this.getGui(),i=!!t&&t.length>0;t=i?t:void 0,this.eTitle.textContent=t??"",Dt(s,i),t!==this.title&&(this.title=t);const r=s.classList.contains(fC);return this.refreshDisabledStyles(r),this}addWidget(t){return this.getGui().appendChild(t),this}hideOpenCloseIcons(t){return this.suppressOpenCloseIcons=t,t&&this.dispatchExpandChanged(!0),this}refreshDisabledStyles(t){const s=this.getGui();t?(s.classList.add(fC),s.removeAttribute("tabindex")):(s.classList.remove(fC),typeof this.title=="string"?s.setAttribute("tabindex","0"):s.removeAttribute("tabindex"))}};Iu.EVENT_EXPAND_CHANGED="expandedChanged";f([Fe("eGroupOpenedIcon")],Iu.prototype,"eGroupOpenedIcon",2);f([Fe("eGroupClosedIcon")],Iu.prototype,"eGroupClosedIcon",2);f([Fe("eTitle")],Iu.prototype,"eTitle",2);f([xe],Iu.prototype,"postConstruct",1);var PE=Iu,z0=class extends Ep{constructor(e=0,t){super('<div class="ag-menu-list" role="tree"></div>'),this.level=e,this.menuItems=[],this.params=t??{column:null,node:null,value:null}}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.handleFocusIn(e),onFocusOut:e=>this.handleFocusOut(e)})}onTabKeyDown(e){const t=this.getParentComponent(),s=t&&t.getGui();s&&s.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(e){switch(e.key){case U.UP:case U.RIGHT:case U.DOWN:case U.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case U.ESCAPE:this.closeIfIsChild()&&gn(e);break}}handleFocusIn(e){var t,s;const i=e.relatedTarget;!this.tabGuardCtrl.isTabGuard(i)&&(this.getGui().contains(i)||(s=(t=this.activeMenuItem)==null?void 0:t.getSubMenuGui())!=null&&s.contains(i))||(this.activeMenuItem?this.activeMenuItem.activate():this.activateFirstItem())}handleFocusOut(e){var t;const s=e.relatedTarget;!this.activeMenuItem||this.getGui().contains(s)||(t=this.activeMenuItem.getSubMenuGui())!=null&&t.contains(s)||this.activeMenuItem.isSubMenuOpening()||this.activeMenuItem.deactivate()}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(e){e!=null&&Ps.all(e.map(t=>t==="separator"?Ps.resolve({eGui:this.createSeparator()}):typeof t=="string"?(console.warn(`AG Grid: unrecognised menu item ${t}`),Ps.resolve({eGui:null})):this.addItem(t))).then(t=>{t.forEach(s=>{s!=null&&s.eGui&&(this.appendChild(s.eGui),s.comp&&this.menuItems.push(s.comp))})})}addItem(e){const t=this.createManagedBean(new ag);return t.init({menuItemDef:e,isAnotherSubMenuOpen:()=>this.menuItems.some(s=>s.isSubMenuOpen()),level:this.level,contextParams:this.params}).then(()=>(t.setParentComponent(this),this.addManagedListener(t,ag.EVENT_CLOSE_MENU,s=>{this.dispatchEvent(s)}),this.addManagedListener(t,ag.EVENT_MENU_ITEM_ACTIVATED,s=>{this.activeMenuItem&&this.activeMenuItem!==s.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=s.menuItem}),{comp:t,eGui:t.getGui()}))}activateFirstItem(){const e=this.menuItems.filter(t=>!t.isDisabled())[0];e&&e.activate()}createSeparator(){return $i(`
            <div class="ag-menu-separator" aria-hidden="true">
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
            </div>`)}handleNavKey(e){switch(e){case U.UP:case U.DOWN:const s=this.findNextItem(e===U.UP);s&&s!==this.activeMenuItem&&s.activate();return}const t=this.gos.get("enableRtl")?U.RIGHT:U.LEFT;e===t?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const t=this.getParentComponent();return t&&t instanceof ag?(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus(),!0):!1}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(e){const t=this.menuItems.filter(r=>!r.isDisabled());if(!t.length)return;if(!this.activeMenuItem)return e?Mt(t):t[0];e&&t.reverse();let s,i=!1;for(let r=0;r<t.length;r++){const n=t[r];if(!i){n===this.activeMenuItem&&(i=!0);continue}s=n;break}return i&&!s?t[0]:s||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}};f([A("focusService")],z0.prototype,"focusService",2);f([xe],z0.prototype,"postConstruct",1);var FN=class extends Ep{constructor(e){super(),this.wrappedComponent=e,this.setTemplateFromElement(e.getGui())}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===U.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const e=this.parentComponent;e.closeSubMenu(),setTimeout(()=>e.getGui().focus(),0)}};f([xe],FN.prototype,"postConstruct",1);var _u=class ac extends Se{constructor(){super(...arguments),this.isActive=!1,this.subMenuIsOpen=!1,this.subMenuIsOpening=!1,this.suppressRootStyles=!0,this.suppressAria=!0,this.suppressFocus=!0}init(t){var s,i;const{menuItemDef:r,isAnotherSubMenuOpen:n,level:o,childComponent:a,contextParams:l}=t;return this.params=t.menuItemDef,this.level=o,this.isAnotherSubMenuOpen=n,this.childComponent=a,this.contextParams=l,this.cssClassPrefix=(i=(s=this.params.menuItemParams)==null?void 0:s.cssClassPrefix)!=null?i:"ag-menu-option",this.userComponentFactory.getMenuItemCompDetails(this.params,rs(Xe({},r),{level:o,isAnotherSubMenuOpen:n,openSubMenu:h=>this.openSubMenu(h),closeSubMenu:()=>this.closeSubMenu(),closeMenu:h=>this.closeMenu(h),updateTooltip:(h,p)=>this.refreshTooltip(h,p),onItemActivated:()=>this.onItemActivated()})).newAgStackInstance().then(h=>{var p;this.menuItemComp=h;const g=(p=h.configureDefaults)==null?void 0:p.call(h);g&&this.configureDefaults(g===!0?void 0:g)})}addListeners(t,s){s!=null&&s.suppressClick||this.addManagedListener(t,"click",i=>this.onItemSelected(i)),s!=null&&s.suppressKeyboardSelect||this.addManagedListener(t,"keydown",i=>{(i.key===U.ENTER||i.key===U.SPACE)&&(i.preventDefault(),this.onItemSelected(i))}),s!=null&&s.suppressMouseDown||this.addManagedListener(t,"mousedown",i=>{i.stopPropagation(),i.preventDefault()}),s!=null&&s.suppressMouseOver||(this.addManagedListener(t,"mouseenter",()=>this.onMouseEnter()),this.addManagedListener(t,"mouseleave",()=>this.onMouseLeave()))}isDisabled(){return!!this.params.disabled}openSubMenu(t=!1){var s,i;if(this.closeSubMenu(),!this.params.subMenu)return;this.subMenuIsOpening=!0;const r=$i('<div class="ag-menu" role="presentation"></div>');this.eSubMenuGui=r;let n,o=()=>{this.subMenuIsOpening=!1};if(this.childComponent){const h=this.createBean(new FN(this.childComponent));h.setParentComponent(this);const p=h.getGui(),g="mouseenter",m=()=>this.cancelDeactivate();p.addEventListener(g,m),n=()=>p.removeEventListener(g,m),r.appendChild(p),this.childComponent.afterGuiAttached&&(o=()=>{this.childComponent.afterGuiAttached(),this.subMenuIsOpening=!1})}else if(this.params.subMenu){const h=this.createBean(new z0(this.level+1,this.contextParams));h.setParentComponent(this),h.addMenuItems(this.params.subMenu),r.appendChild(h.getGui()),this.addManagedListener(h,ac.EVENT_CLOSE_MENU,p=>this.dispatchEvent(p)),h.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),n=()=>this.destroyBean(h),t&&(o=()=>{h.activateFirstItem(),this.subMenuIsOpening=!1})}const a=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:this.eGui,ePopup:r}),l=this.localeService.getLocaleTextFunc(),u=this.popupService.addPopup({modal:!0,eChild:r,positionCallback:a,anchorToElement:this.eGui,ariaLabel:l("ariaLabelSubMenu","SubMenu"),afterGuiAttached:o});this.subMenuIsOpen=!0,this.setAriaExpanded(!0),this.hideSubMenu=()=>{var h,p;u&&u.hideFunc(),this.subMenuIsOpen=!1,this.setAriaExpanded(!1),n(),(p=(h=this.menuItemComp).setExpanded)==null||p.call(h,!1),this.eSubMenuGui=void 0},(i=(s=this.menuItemComp).setExpanded)==null||i.call(s,!0)}setAriaExpanded(t){this.suppressAria||co(this.eGui,t)}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,this.setAriaExpanded(!1))}isSubMenuOpen(){return this.subMenuIsOpen}isSubMenuOpening(){return this.subMenuIsOpening}activate(t){var s,i;this.cancelActivate(),!this.params.disabled&&(this.isActive=!0,this.suppressRootStyles||this.eGui.classList.add(`${this.cssClassPrefix}-active`),(i=(s=this.menuItemComp).setActive)==null||i.call(s,!0),this.suppressFocus||this.eGui.focus({preventScroll:!0}),t&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){var t,s;this.cancelDeactivate(),this.suppressRootStyles||this.eGui.classList.remove(`${this.cssClassPrefix}-active`),(s=(t=this.menuItemComp).setActive)==null||s.call(t,!1),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}getGui(){return this.menuItemComp.getGui()}getParentComponent(){return this.parentComponent}setParentComponent(t){this.parentComponent=t}getSubMenuGui(){return this.eSubMenuGui}onItemSelected(t){var s,i;(i=(s=this.menuItemComp).select)==null||i.call(s),this.params.action?this.getFrameworkOverrides().wrapOutgoing(()=>this.params.action(this.gos.addGridCommonParams(Xe({},this.contextParams)))):this.openSubMenu(t&&t.type==="keydown"),!(this.params.subMenu&&!this.params.action||this.params.suppressCloseOnSelect)&&this.closeMenu(t)}closeMenu(t){const s={type:ac.EVENT_CLOSE_MENU};t&&(t instanceof MouseEvent?s.mouseEvent=t:s.keyboardEvent=t),this.dispatchEvent(s)}onItemActivated(){const t={type:ac.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(t)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),ac.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),ac.ACTIVATION_DELAY):this.deactivate()}configureDefaults(t){var s,i,r;if(!this.menuItemComp){setTimeout(()=>this.configureDefaults(t));return}let n=this.menuItemComp.getGui();const o=(i=(s=this.menuItemComp).getRootElement)==null?void 0:i.call(s);o&&(t!=null&&t.suppressRootStyles||n.classList.add("ag-menu-option-custom"),n=o),this.eGui=n,this.suppressRootStyles=!!(t!=null&&t.suppressRootStyles),this.suppressRootStyles||(n.classList.add(this.cssClassPrefix),(r=this.params.cssClasses)==null||r.forEach(a=>n.classList.add(a)),this.params.disabled&&n.classList.add(`${this.cssClassPrefix}-disabled`)),t!=null&&t.suppressTooltip||this.refreshTooltip(this.params.tooltip),this.suppressAria=!!(t!=null&&t.suppressAria),this.suppressAria||(fs(n,"treeitem"),BA(n,this.level+1),this.params.disabled&&t0(n,!0)),t!=null&&t.suppressTabIndex||n.setAttribute("tabindex","-1"),this.params.disabled||this.addListeners(n,t),this.suppressFocus=!!(t!=null&&t.suppressFocus)}refreshTooltip(t,s){this.tooltip=t,this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),!(!t||!this.menuItemComp)&&(this.tooltipFeature=this.createBean(new wo({getGui:()=>this.getGui(),getTooltipValue:()=>this.tooltip,getLocation:()=>"menu",shouldDisplayTooltip:s})))}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}};_u.EVENT_CLOSE_MENU="closeMenu";_u.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated";_u.ACTIVATION_DELAY=80;f([A("popupService")],_u.prototype,"popupService",2);f([A("userComponentFactory")],_u.prototype,"userComponentFactory",2);var ag=_u,Ql=class uw extends at{constructor(t){super(uw.getTemplate(t)),this.config=t,this.closable=!0}static getTemplate(t){const s=t.cssIdentifier||"default";return`<div class="ag-panel ag-${s}-panel" tabindex="-1">
            <div ref="eTitleBar" class="ag-panel-title-bar ag-${s}-panel-title-bar ag-unselectable">
                <span ref="eTitle" class="ag-panel-title-bar-title ag-${s}-panel-title-bar-title"></span>
                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${s}-panel-title-bar-buttons"></div>
            </div>
            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-${s}-panel-content-wrapper"></div>
        </div>`}postConstruct(){const{component:t,closable:s,hideTitleBar:i,title:r,minWidth:n=250,width:o,minHeight:a=250,height:l,centered:u,popup:h,x:p,y:g}=this.config;this.positionableFeature=new xu(this.getGui(),{minWidth:n,width:o,minHeight:a,height:l,centered:u,x:p,y:g,popup:h,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const m=this.getGui();t&&this.setBodyComponent(t),i?Dt(this.eTitleBar,!1):(r&&this.setTitle(r),this.setClosable(s??this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",C=>{if(m.contains(C.relatedTarget)||m.contains(this.gos.getActiveDomElement())||this.eTitleBarButtons.contains(C.target)){C.preventDefault();return}const y=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");y&&y.focus()}),!(h&&this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const t=this.getGui();t.focus(),this.close=()=>{t.parentElement.removeChild(t),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(t){this.positionableFeature.setHeight(t)}getWidth(){return this.positionableFeature.getWidth()}setWidth(t){this.positionableFeature.setWidth(t)}setClosable(t){if(t!==this.closable&&(this.closable=t),t){const s=this.closeButtonComp=new at(uw.CLOSE_BTN_TEMPLATE);this.getContext().createBean(s);const i=s.getGui(),r=cs("close",this.gos);r.classList.add("ag-panel-title-bar-button-icon"),i.appendChild(r),this.addTitleBarButton(s),s.addManagedListener(i,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){const s=this.closeButtonComp.getGui();s.parentElement.removeChild(s),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(t){t.setParentComponent(this),this.eContentWrapper.appendChild(t.getGui())}addTitleBarButton(t,s){const i=this.eTitleBarButtons,r=i.children,n=r.length;s==null&&(s=n),s=Math.max(0,Math.min(s,n)),t.addCssClass("ag-panel-title-bar-button");const o=t.getGui();s===0?i.insertAdjacentElement("afterbegin",o):s===n?i.insertAdjacentElement("beforeend",o):r[s-1].insertAdjacentElement("afterend",o),t.setParentComponent(this)}getBodyHeight(){return pp(this.eContentWrapper)}getBodyWidth(){return Hl(this.eContentWrapper)}setTitle(t){this.eTitle.innerText=t}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const t=this.getGui();t&&Zi(t)&&this.close(),super.destroy()}};Ql.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>';f([Fe("eContentWrapper")],Ql.prototype,"eContentWrapper",2);f([Fe("eTitleBar")],Ql.prototype,"eTitleBar",2);f([Fe("eTitleBarButtons")],Ql.prototype,"eTitleBarButtons",2);f([Fe("eTitle")],Ql.prototype,"eTitle",2);f([xe],Ql.prototype,"postConstruct",1);var UG=Ql,$G=class extends UG{constructor(e){super(rs(Xe({},e),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}postConstruct(){const e=this.getGui(),{movable:t,resizable:s,maximizable:i}=this.config;this.addCssClass("ag-dialog"),super.postConstruct(),this.addManagedListener(e,"focusin",r=>{this.popupService.bringPopupToFront(e)}),t&&this.setMovable(t),i&&this.setMaximizable(i),s&&this.setResizable(s)}renderComponent(){const e=this.getGui(),{alwaysOnTop:t,modal:s,title:i,afterGuiAttached:r}=this.config,n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:s,eChild:e,closeOnEsc:!0,closedCallback:this.onClosed.bind(this),alwaysOnTop:t,ariaLabel:i||n("ariaLabelDialog","Dialog"),afterGuiAttached:r});o&&(this.close=o.hideFunc)}onClosed(e){var t,s;this.destroy(),(s=(t=this.config).closedCallback)==null||s.call(t,e)}toggleMaximize(){const e=this.positionableFeature.getPosition();if(this.isMaximized){const{x:t,y:s,width:i,height:r}=this.lastPosition;this.setWidth(i),this.setHeight(r),this.positionableFeature.offsetElement(t,s)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=e.x,this.lastPosition.y=e.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){Dt(this.maximizeIcon,!this.isMaximized),Dt(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(e=>e()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(e){this.positionableFeature.setResizable(e)}setMovable(e){this.positionableFeature.setMovable(e,this.eTitleBar)}setMaximizable(e){if(!e){this.clearMaximizebleListeners(),this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0);return}const t=this.eTitleBar;if(!t||e===this.isMaximizable)return;const s=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),s.addManagedListener(s.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(s,0),this.maximizeListeners.push(this.addManagedListener(t,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",()=>{this.isMaximized=!1,this.refreshMaximizeIcon()})}buildMaximizeAndMinimizeElements(){const e=this.maximizeButtonComp=this.createBean(new at('<div class="ag-dialog-button"></span>')),t=e.getGui();return this.maximizeIcon=cs("maximize",this.gos),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=cs("minimize",this.gos),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e}};f([A("popupService")],$G.prototype,"popupService",2);var KG=0,uo=class extends Se{constructor(){super(...arguments),this.popupList=[]}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl}),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.handleThemeChange.bind(this))}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:s}=e,i=this.getPopupIndex(s);if(i!==-1){const m=this.popupList[i];m.alignedToElement=t}const r=t.getBoundingClientRect(),n=this.getParentRect(),o=this.keepXYWithinBounds(s,r.top-n.top,0),a=s.clientWidth>0?s.clientWidth:200;s.style.minWidth=`${a}px`;const u=n.right-n.left-a;let h;this.gos.get("enableRtl")?(h=g(),h<0&&(h=p(),this.setAlignedStyles(s,"left")),h>u&&(h=0,this.setAlignedStyles(s,"right"))):(h=p(),h>u&&(h=g(),this.setAlignedStyles(s,"right")),h<0&&(h=0,this.setAlignedStyles(s,"left"))),s.style.left=`${h}px`,s.style.top=`${o}px`;function p(){return r.right-n.left-2}function g(){return r.left-n.left-a}}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:s,nudgeY:i,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:s,nudgeY:i,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:s,nudgeY:i,keepWithinBounds:r,eventSource:n,alignSide:o="left",position:a="over",column:l,rowNode:u,type:h}=e,p=n.getBoundingClientRect(),g=this.getParentRect(),m=this.getPopupIndex(t);if(m!==-1){const y=this.popupList[m];y.alignedToElement=n}const C=()=>{let y=p.left-g.left;o==="right"&&(y-=t.offsetWidth-p.width);let R;return a==="over"?(R=p.top-g.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,p,g,e.nudgeY||0)==="under"?R=p.top-g.top+p.height:R=p.top-t.offsetHeight-(i||0)*2-g.top),{x:y,y:R}};this.positionPopup({ePopup:t,nudgeX:s,nudgeY:i,keepWithinBounds:r,updatePosition:C,postProcessCallback:()=>this.callPostProcessPopup(h,t,n,null,l,u)})}shouldRenderUnderOrAbove(e,t,s,i){const r=s.bottom-t.bottom,n=t.top-s.top,o=e.offsetHeight+i;return r>o?"under":n>o||n>r?"above":"under"}setAlignedStyles(e,t){const s=this.getPopupIndex(e);if(s===-1)return;const i=this.popupList[s],{alignedToElement:r}=i;!r||(["right","left","over","above","under"].forEach(o=>{r.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`)}),!t)||(r.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}callPostProcessPopup(e,t,s,i,r,n){const o=this.gos.getCallback("postProcessPopup");o&&o({column:r,rowNode:n,ePopup:t,type:e,eventSource:s,mouseEvent:i})}positionPopup(e){const{ePopup:t,keepWithinBounds:s,nudgeX:i,nudgeY:r,skipObserver:n,updatePosition:o}=e,a={width:0,height:0},l=(u=!1)=>{let{x:h,y:p}=o();u&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,i&&(h+=i),r&&(p+=r),s&&(h=this.keepXYWithinBounds(t,h,1),p=this.keepXYWithinBounds(t,p,0)),t.style.left=`${h}px`,t.style.top=`${p}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!n){const u=this.resizeObserverService.observeResize(t,()=>l(!0));setTimeout(()=>u(),uo.WAIT_FOR_POPUP_CONTENT_RESIZE)}}getActivePopups(){return this.popupList.map(e=>e.element)}getPopupList(){return this.popupList}getParentRect(){const e=this.gos.getDocument();let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),f0(t)}keepXYWithinBounds(e,t,s){const i=s===0,r=i?"clientHeight":"clientWidth",n=i?"top":"left",o=i?"offsetHeight":"offsetWidth",a=i?"scrollTop":"scrollLeft",l=this.gos.getDocument(),u=l.documentElement,h=this.getPopupParent(),p=h.getBoundingClientRect(),g=l.documentElement.getBoundingClientRect(),m=h===l.body,C=e[o];let R=m?(i?g0:ph)(u)+u[a]:h[r];m&&(R-=Math.abs(g[n]-p[n]));const x=R-C;return Math.min(Math.max(t,0),Math.abs(x))}addPopup(e){const t=this.gos.getDocument(),{eChild:s,ariaLabel:i,alwaysOnTop:r,positionCallback:n,anchorToElement:o}=e;if(!t)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(s);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(s);const l=this.createPopupWrapper(s,i,!!r),u=this.addEventListenersToPopup(rs(Xe({},e),{wrapperEl:l}));return n&&n(),this.addPopupToPopupList(s,l,u,o),{hideFunc:u}}initialisePopupPosition(e){const s=this.getPopupParent().getBoundingClientRect();ve(e.style.top)||(e.style.top=`${s.top*-1}px`),ve(e.style.left)||(e.style.left=`${s.left*-1}px`)}createPopupWrapper(e,t,s){const i=this.getPopupParent(),r=document.createElement("div"),{allThemes:n}=this.environment.getTheme();return n.length&&r.classList.add(...n),r.classList.add("ag-popup"),e.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||fs(e,"dialog"),fr(e,t),r.appendChild(e),i.appendChild(r),s?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),r}handleThemeChange(){const{allThemes:e}=this.environment.getTheme();for(const t of this.popupList){for(const s of Array.from(t.wrapper.classList))s.startsWith("ag-theme-")&&t.wrapper.classList.remove(s);e.length&&t.wrapper.classList.add(...e)}}addEventListenersToPopup(e){const t=this.gos.getDocument(),s=this.getPopupParent(),{wrapperEl:i,eChild:r,closedCallback:n,afterGuiAttached:o,closeOnEsc:a,modal:l}=e;let u=!1;const h=C=>{if(!i.contains(this.gos.getActiveDomElement()))return;C.key===U.ESCAPE&&!un(C)&&m({keyboardEvent:C})},p=C=>m({mouseEvent:C}),g=C=>m({touchEvent:C}),m=(C={})=>{const{mouseEvent:y,touchEvent:R,keyboardEvent:x,forceHide:S}=C;!S&&(this.isEventFromCurrentPopup({mouseEvent:y,touchEvent:R},r)||u)||(u=!0,s.removeChild(i),t.removeEventListener("keydown",h),t.removeEventListener("mousedown",p),t.removeEventListener("touchstart",g),t.removeEventListener("contextmenu",p),this.eventService.removeEventListener(w.EVENT_DRAG_STARTED,p),n&&n(y||R||x),this.removePopupFromPopupList(r))};return o&&o({hidePopup:m}),window.setTimeout(()=>{a&&t.addEventListener("keydown",h),l&&(t.addEventListener("mousedown",p),this.eventService.addEventListener(w.EVENT_DRAG_STARTED,p),t.addEventListener("touchstart",g),t.addEventListener("contextmenu",p))},0),m}addPopupToPopupList(e,t,s,i){this.popupList.push({element:e,wrapper:t,hideFunc:s,instanceId:KG++,isAnchored:!!i}),i&&this.setPopupPositionRelatedToElement(e,i)}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const s=this.getPopupIndex(e);if(s===-1)return;const i=this.popupList[s];if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(n=>n&&n()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!t)return;const r=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:i.hideFunc});return i.stopAnchoringPromise=r,i.isAnchored=!0,r}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter(t=>t.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),s=t.getBoundingClientRect(),{element:i,ePopup:r}=e,n=i.getBoundingClientRect(),o=s.top-n.top,a=s.left-n.left;let l=o,u=a;const h=r.style.top,p=parseInt(h.substring(0,h.length-1),10),g=r.style.left,m=parseInt(g.substring(0,g.length-1),10);return new Ps(C=>{this.getFrameworkOverrides().setInterval(()=>{const y=t.getBoundingClientRect(),R=i.getBoundingClientRect();if(R.top==0&&R.left==0&&R.height==0&&R.width==0){e.hidePopup();return}const S=y.top-R.top;if(S!=l){const I=this.keepXYWithinBounds(r,p+o-S,0);r.style.top=`${I}px`}l=S;const T=y.left-R.left;if(T!=u){const I=this.keepXYWithinBounds(r,m+a-T,1);r.style.left=`${I}px`}u=T},200).then(y=>{C(()=>{y!=null&&window.clearInterval(y)})})})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:s,touchEvent:i}=e,r=s||i;if(!r)return!1;const n=this.getPopupIndex(t);if(n===-1)return!1;for(let o=n;o<this.popupList.length;o++){const a=this.popupList[o];if(Ef(a.element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){const t=this.gos.getDocument();for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const s=this.getWrapper(e);s&&(s.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(s))}bringPopupToFront(e){const t=this.getPopupParent(),s=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),i=s.length,r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),n=r.length,o=this.getWrapper(e);if(!o||i<=1||!t.contains(e))return;const a=s.indexOf(o),l=o.querySelectorAll("div"),u=[];for(l.forEach(h=>{h.scrollTop!==0&&u.push([h,h.scrollTop])}),n?o.classList.contains("ag-always-on-top")?a!==i-1&&Mt(r).insertAdjacentElement("afterend",o):a!==i-n-1&&r[0].insertAdjacentElement("beforebegin",o):a!==i-1&&Mt(s).insertAdjacentElement("afterend",o);u.length;){const h=u.pop();h[0].scrollTop=h[1]}}};uo.WAIT_FOR_POPUP_CONTENT_RESIZE=200;f([A("focusService")],uo.prototype,"focusService",2);f([A("ctrlsService")],uo.prototype,"ctrlsService",2);f([A("resizeObserverService")],uo.prototype,"resizeObserverService",2);f([xe],uo.prototype,"postConstruct",1);uo=f([Le("popupService")],uo);var YG=class extends at{constructor(){super(`
        <div class="ag-autocomplete-row" role="presentation">
            <div class="ag-autocomplete-row-label"></div>
        </div>`),this.hasHighlighting=!1}setState(e,t){this.value=e,this.render(),this.updateSelected(t)}updateSelected(e){this.addOrRemoveCssClass("ag-autocomplete-row-selected",e)}setSearchString(e){var t;let s=!1;if(ve(e)){const i=(t=this.value)==null?void 0:t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(i>=0){s=!0,this.hasHighlighting=!0;const r=i+e.length,n=Ds(this.value.slice(0,i)),o=Ds(this.value.slice(i,r)),a=Ds(this.value.slice(r));this.getGui().lastElementChild.innerHTML=`${n}<b>${o}</b>${a}`}}!s&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())}render(){var e;this.getGui().lastElementChild.innerHTML=(e=Ds(this.value))!=null?e:"&nbsp;"}},dv=class NN extends zl{constructor(t){super(NN.TEMPLATE),this.params=t,this.searchString=""}destroy(){super.destroy()}init(){this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new PN({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:()=>this.autocompleteEntries.length,getRow:s=>this.autocompleteEntries[s]});const t=this.virtualList.getGui();this.addManagedListener(t,"click",()=>this.params.onConfirmed()),this.addManagedListener(t,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(t,"mousedown",s=>s.preventDefault()),this.setSelectedValue(0)}onNavigationKeyDown(t,s){t.preventDefault();const i=this.autocompleteEntries.indexOf(this.selectedValue),r=s===U.UP?i-1:i+1;this.checkSetSelectedValue(r)}setSearch(t){this.searchString=t,ve(t)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()}runContainsSearch(t,s){let i,r=!1;const n=t.toLocaleLowerCase(),o=s.filter(a=>{const u=a.toLocaleLowerCase().indexOf(n),h=u===0,p=u>=0;return p&&(!i||!r&&h||r===h&&a.length<i.length)&&(i=a,r=h),p});return!i&&o.length&&(i=o[0]),{topMatch:i,allMatches:o}}runSearch(){var t,s;const{autocompleteEntries:i}=this.params,r=i.map(u=>{var h;return(h=u.displayValue)!=null?h:u.key});let n,o;if(this.params.useFuzzySearch)n=fp(this.searchString,r,!0).values,o=n.length?n[0]:void 0;else{const u=this.runContainsSearch(this.searchString,r);n=u.allMatches,o=u.topMatch}let a=i.filter(({key:u,displayValue:h})=>n.includes(h??u));if(!a.length&&this.selectedValue&&((s=(t=this.params)==null?void 0:t.forceLastSelection)!=null&&s.call(t,this.selectedValue,this.searchString))&&(a=[this.selectedValue]),this.autocompleteEntries=a,this.virtualList.refresh(),!o)return;const l=n.indexOf(o);this.checkSetSelectedValue(l)}updateSearchInList(){this.virtualList.forEachRenderedRow(t=>t.setSearchString(this.searchString))}checkSetSelectedValue(t){t>=0&&t<this.autocompleteEntries.length&&this.setSelectedValue(t)}setSelectedValue(t){const s=this.autocompleteEntries[t];this.selectedValue!==s&&(this.selectedValue=s,this.virtualList.ensureIndexVisible(t),this.virtualList.forEachRenderedRow((i,r)=>{i.updateSelected(t===r)}))}createRowComponent(t){var s;const i=new YG;return this.getContext().createBean(i),i.setState((s=t.displayValue)!=null?s:t.key,t===this.selectedValue),i}onMouseMove(t){const s=this.virtualList.getGui().getBoundingClientRect(),i=this.virtualList.getScrollTop(),r=t.clientY-s.top+i,n=Math.floor(r/this.virtualList.getRowHeight());this.checkSetSelectedValue(n)}afterGuiAttached(){this.virtualList.refresh()}getSelectedValue(){var t;return this.autocompleteEntries.length&&(t=this.selectedValue)!=null?t:null}};dv.TEMPLATE=`<div class="ag-autocomplete-list-popup">
            <div ref="eList" class="ag-autocomplete-list"></div>
        <div>`;f([Fe("eList")],dv.prototype,"eList",2);f([xe],dv.prototype,"init",1);var qG=dv,Pa=class vd extends at{constructor(){super(`
            <div class="ag-autocomplete" role="presentation">
                <ag-input-text-field ref="eAutocompleteInput"></ag-input-text-field>
            </div>`),this.isListOpen=!1,this.lastPosition=0,this.valid=!0}postConstruct(){this.eAutocompleteInput.onValueChange(t=>this.onValueChanged(t)),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc(()=>{this.destroyBean(this.autocompleteList)}),this.addGuiEventListener("focusout",()=>this.onFocusOut())}onValueChanged(t){const s=Mn(t);this.updateValue(s),this.updateAutocompleteList(s)}updateValue(t){this.updateLastPosition(),this.dispatchEvent({type:vd.EVENT_VALUE_CHANGED,value:t}),this.validate(t)}updateAutocompleteList(t){var s,i,r,n;const o=(i=(s=this.listGenerator)==null?void 0:s.call(this,t,this.lastPosition))!=null?i:{enabled:!1};if((!o.type||o.type!==((r=this.autocompleteListParams)==null?void 0:r.type))&&this.isListOpen&&this.closeList(),this.autocompleteListParams=o,(n=this.autocompleteListParams)!=null&&n.enabled){this.isListOpen||this.openList();const{searchString:a}=this.autocompleteListParams;this.autocompleteList.setSearch(a??"")}else this.isListOpen&&this.closeList()}onKeyDown(t){const s=t.key;switch(this.updateLastPosition(),s){case U.ENTER:this.onEnterKeyDown(t);break;case U.TAB:this.onTabKeyDown(t);break;case U.DOWN:case U.UP:this.onUpDownKeyDown(t,s);break;case U.LEFT:case U.RIGHT:case U.PAGE_HOME:case U.PAGE_END:setTimeout(()=>{this.updatePositionAndList()});break;case U.ESCAPE:this.onEscapeKeyDown(t);break;case U.SPACE:t.ctrlKey&&!this.isListOpen&&(t.preventDefault(),this.forceOpenList());break}}confirmSelection(){var t;const s=(t=this.autocompleteList)==null?void 0:t.getSelectedValue();s&&(this.closeList(),this.dispatchEvent({type:vd.EVENT_OPTION_SELECTED,value:this.getValue(),position:this.lastPosition,updateEntry:s,autocompleteType:this.autocompleteListParams.type}))}onTabKeyDown(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.confirmSelection())}onEnterKeyDown(t){t.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()}onUpDownKeyDown(t,s){var i;t.preventDefault(),this.isListOpen?(i=this.autocompleteList)==null||i.onNavigationKeyDown(t,s):this.forceOpenList()}onEscapeKeyDown(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))}onFocusOut(){this.isListOpen&&this.closeList()}updatePositionAndList(){var t;this.updateLastPosition(),this.updateAutocompleteList((t=this.eAutocompleteInput.getValue())!=null?t:null)}setCaret(t,s){const i=this.gos.getDocument(),r=this.gos.getActiveDomElement();s&&(!r||r===i.body)&&this.eAutocompleteInput.getFocusableElement().focus();const n=this.eAutocompleteInput.getInputElement();n.setSelectionRange(t,t),t===n.value.length&&(n.scrollLeft=n.scrollWidth)}forceOpenList(){this.onValueChanged(this.eAutocompleteInput.getValue())}updateLastPosition(){var t;this.lastPosition=(t=this.eAutocompleteInput.getInputElement().selectionStart)!=null?t:0}validate(t){var s;this.validator&&(this.validationMessage=this.validator(t),this.eAutocompleteInput.getInputElement().setCustomValidity((s=this.validationMessage)!=null?s:""),this.valid=!this.validationMessage,this.dispatchEvent({type:vd.EVENT_VALID_CHANGED,isValid:this.valid,validationMessage:this.validationMessage}))}openList(){this.isListOpen=!0,this.autocompleteList=this.createBean(new qG({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:()=>this.confirmSelection(),forceLastSelection:this.forceLastSelection}));const t=this.autocompleteList.getGui(),s={ePopup:t,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gos.get("enableRtl")?"right":"left",keepWithinBounds:!0},i=this.popupService.addPopup({eChild:t,anchorToElement:this.getGui(),positionCallback:()=>this.popupService.positionPopupByComponent(s),ariaLabel:this.listAriaLabel});this.hidePopup=i.hideFunc,this.autocompleteList.afterGuiAttached()}closeList(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null}onCompleted(){this.isListOpen&&this.closeList(),this.dispatchEvent({type:vd.EVENT_VALUE_CONFIRMED,value:this.getValue(),isValid:this.isValid()})}getValue(){return Mn(this.eAutocompleteInput.getValue())}setInputPlaceholder(t){return this.eAutocompleteInput.setInputPlaceholder(t),this}setInputAriaLabel(t){return this.eAutocompleteInput.setInputAriaLabel(t),this}setListAriaLabel(t){return this.listAriaLabel=t,this}setListGenerator(t){return this.listGenerator=t,this}setValidator(t){return this.validator=t,this}isValid(){return this.valid}setValue(t){const{value:s,position:i,silent:r,updateListOnlyIfOpen:n,restoreFocus:o}=t;this.eAutocompleteInput.setValue(s,!0),this.setCaret(i??this.lastPosition,o),r||this.updateValue(s),(!n||this.isListOpen)&&this.updateAutocompleteList(s)}setForceLastSelection(t){return this.forceLastSelection=t,this}setInputDisabled(t){return this.eAutocompleteInput.setDisabled(t),this}};Pa.EVENT_VALUE_CHANGED="eventValueChanged";Pa.EVENT_VALUE_CONFIRMED="eventValueConfirmed";Pa.EVENT_OPTION_SELECTED="eventOptionSelected";Pa.EVENT_VALID_CHANGED="eventValidChanged";f([A("popupService")],Pa.prototype,"popupService",2);f([Fe("eAutocompleteInput")],Pa.prototype,"eAutocompleteInput",2);f([xe],Pa.prototype,"postConstruct",1);var QG=Pa,Aa=class _g extends at{constructor(t,s,i,r){super(),this.dragSourceDropTarget=t,this.ghost=s,this.horizontal=i,this.template=r}init(){var t;this.setTemplate((t=this.template)!=null?t:_g.TEMPLATE);const s=this.getGui();this.addElementClasses(s),this.addElementClasses(this.eDragHandle,"drag-handle"),this.addElementClasses(this.eText,"text"),this.addElementClasses(this.eButton,"button"),this.eDragHandle.appendChild(cs("columnDrag",this.gos)),this.eButton.appendChild(cs("cancel",this.gos)),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const t=this.localeService.getLocaleTextFunc(),s=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(s,t),fr(this.getGui(),s.join(". "))}addAdditionalAriaInstructions(t,s){if(this.isRemovable()){const i=s("ariaDropZoneColumnComponentDescription","Press DELETE to remove");t.push(i)}}setupTooltip(){const t=()=>{const s=this.getTooltip();this.setTooltip({newTooltipText:s})};t(),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,t)}getDragSourceId(){}getDefaultIconName(){return ut.ICON_NOT_ALLOWED}addDragSource(){const{dragAndDropService:t,eDragHandle:s}=this,i=this.createGetDragItem(),r=this.getDefaultIconName(),n={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:s,getDefaultIconName:()=>r,getDragItem:i,dragItemName:this.getDisplayName()};t.addDragSource(n,!0),this.addDestroyFunc(()=>t.removeDragSource(n))}setupComponents(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){Dt(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const t={type:_g.EVENT_COLUMN_REMOVE};this.addGuiEventListener("keydown",i=>this.onKeyDown(i)),this.addManagedListener(this.eButton,"click",i=>{this.dispatchEvent(t),i.stopPropagation()});const s=new Ws(this.eButton);this.addManagedListener(s,Ws.EVENT_TAP,()=>{this.dispatchEvent(t)}),this.addDestroyFunc(s.destroy.bind(s))}onKeyDown(t){t.key===U.DELETE&&this.isRemovable()&&(t.preventDefault(),this.dispatchEvent({type:_g.EVENT_COLUMN_REMOVE}))}getDisplayValue(){return this.getDisplayName()}setTextValue(){const t=this.getDisplayValue(),s=Ds(t);this.eText.innerHTML=s}addElementClasses(t,s){s=s?`-${s}`:"";const i=this.horizontal?"horizontal":"vertical";t.classList.add(`ag-column-drop-cell${s}`,`ag-column-drop-${i}-cell${s}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}};Aa.EVENT_COLUMN_REMOVE="columnRemove";Aa.TEMPLATE=`<span role="option">
          <span ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>
          <span ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>
          <span ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>
        </span>`;f([A("dragAndDropService")],Aa.prototype,"dragAndDropService",2);f([Fe("eText")],Aa.prototype,"eText",2);f([Fe("eDragHandle")],Aa.prototype,"eDragHandle",2);f([Fe("eButton")],Aa.prototype,"eButton",2);f([xe],Aa.prototype,"init",1);var ZG=Aa,Dp=class Sn extends at{constructor(t){super('<div class="ag-unselectable" role="presentation"></div>'),this.horizontal=t,this.state=Sn.STATE_NOT_DRAGGING,this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=document.createElement("div"),this.addElementClasses(this.ePillDropList,"list"),fs(this.ePillDropList,"listbox")}isHorizontal(){return this.horizontal}toggleResizable(t){this.positionableFeature.setResizable(t?{bottom:!0}:!1),this.resizeEnabled=t}isSourceEventFromTarget(t){const{dropZoneTarget:s,dragSource:i}=t;return s.contains(i.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach(t=>t()),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,xs(this.getGui()),xs(this.ePillDropList)}init(t){this.params=t??{},this.createManagedBean(new Ea(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new xu(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature),this.refreshGui(),fr(this.ePillDropList,this.getAriaLabel())}handleKeyDown(t){const s=!this.horizontal;let i=t.key===U.DOWN,r=t.key===U.UP;if(!s){const o=this.gos.get("enableRtl");i=!o&&t.key===U.RIGHT||o&&t.key===U.LEFT,r=!o&&t.key===U.LEFT||o&&t.key===U.RIGHT}if(!i&&!r)return;const n=this.focusService.findNextFocusableElement(this.getFocusableElement(),!1,r);n&&(t.preventDefault(),n.focus())}addElementClasses(t,s){s=s?`-${s}`:"";const i=this.horizontal?"horizontal":"vertical";t.classList.add(`ag-column-drop${s}`,`ag-column-drop-${i}${s}`)}setupDropTarget(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.dragAndDropService.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(t){const s=this.getNewInsertIndex(t);if(s<0)return!1;const i=this.minimumAllowedNewInsertIndex(),r=Math.max(i,s),n=r!==this.insertIndex;return n&&(this.insertIndex=r),n}getNewInsertIndex(t){const s=t.event,i=this.horizontal?s.clientX:s.clientY,r=this.childPillComponents.map(o=>o.getGui().getBoundingClientRect()),n=r.findIndex(o=>this.horizontal?o.right>i&&o.left<i:o.top<i&&o.bottom>i);if(n===-1){const o=this.gos.get("enableRtl");return r.every(u=>i>(this.horizontal?u.right:u.bottom))?o&&this.horizontal?0:this.childPillComponents.length:r.every(u=>i<(this.horizontal?u.left:u.top))?o&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=n?n+1:n}checkDragStartedBySelf(t){this.state===Sn.STATE_NOT_DRAGGING&&(this.state=Sn.STATE_REARRANGE_ITEMS,this.potentialDndItems=this.getItems(t.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(t),this.refreshGui())}onDragging(t){this.checkDragStartedBySelf(t),this.checkInsertIndex(t)&&this.refreshGui()}handleDragEnterEnd(t){}onDragEnter(t){const s=this.getItems(t.dragSource.getDragItem());this.state=Sn.STATE_NEW_ITEMS_IN;const i=s.filter(n=>this.isItemDroppable(n,t)),r=i.every(n=>this.childPillComponents.map(o=>o.getItem()).indexOf(n)!==-1);if(i.length!==0){if(this.potentialDndItems=i,r){this.state=Sn.STATE_NOT_DRAGGING;return}this.handleDragEnterEnd(t),this.checkInsertIndex(t),this.refreshGui()}}isPotentialDndItems(){return CA(this.potentialDndItems)}handleDragLeaveEnd(t){}onDragLeave(t){if(this.state===Sn.STATE_REARRANGE_ITEMS){const s=this.getItems(t.dragSource.getDragItem());this.removeItems(s)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(t),this.potentialDndItems=[],this.refreshGui()),this.state=Sn.STATE_NOT_DRAGGING}refreshOnDragStop(){return!0}onDragStop(){if(this.isPotentialDndItems()){let t=!1;this.state===Sn.STATE_NEW_ITEMS_IN?(this.addItems(this.potentialDndItems),t=!0):t=this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],(this.refreshOnDragStop()||!t)&&this.refreshGui()}this.state=Sn.STATE_NOT_DRAGGING}removeItems(t){const s=this.getExistingItems().filter(i=>!pr(t,i));this.updateItems(s)}addItems(t){if(!t)return;const s=this.getExistingItems().slice(),i=t.filter(r=>s.indexOf(r)<0);$y(s,i,this.insertIndex),this.updateItems(s)}addItem(t){this.insertIndex=this.getExistingItems().length,this.addItems([t]),this.refreshGui()}rearrangeItems(t){const s=this.getNonGhostItems().slice();return $y(s,t,this.insertIndex),Fn(s,this.getExistingItems())?!1:(this.updateItems(s),!0)}refreshGui(){const t=this.ePillDropList.scrollTop,s=this.resizeEnabled,i=this.getFocusedItem();let r=this.focusService.findNextFocusableElement();r||(r=this.focusService.findNextFocusableElement(void 0,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),this.isHorizontal()||(this.ePillDropList.scrollTop=t),s&&this.toggleResizable(s),this.focusService.isKeyboardMode()&&this.restoreFocus(i,r)}getFocusedItem(){const t=this.getGui(),s=this.gos.getActiveDomElement();return t.contains(s)?Array.from(t.querySelectorAll(".ag-column-drop-cell")).indexOf(s):-1}restoreFocus(t,s){const i=this.getGui(),r=Array.from(i.querySelectorAll(".ag-column-drop-cell"));if(t===-1)return;r.length===0&&s.focus();const n=Math.min(r.length-1,t),o=r[n];o&&o.focus()}focusList(t){const s=t?this.childPillComponents.length-1:0;this.restoreFocus(s,this.getFocusableElement())}getNonGhostItems(){const t=this.getExistingItems();return this.isPotentialDndItems()?t.filter(s=>!pr(this.potentialDndItems,s)):t}addItemsToGui(){const s=this.getNonGhostItems().map(i=>this.createItemComponent(i,!1));if(this.isPotentialDndItems()){const i=this.potentialDndItems.map(r=>this.createItemComponent(r,!0));this.insertIndex>=s.length?s.push(...i):s.splice(this.insertIndex,0,...i)}this.appendChild(this.ePillDropList),s.forEach((i,r)=>{r>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(i.getGui())}),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){this.childPillComponents.forEach((t,s)=>{const i=t.getGui();Vm(i,s+1),Gm(i,this.childPillComponents.length)})}createItemComponent(t,s){const i=this.createPillComponent(t,this.dropTarget,s,this.horizontal);return i.addEventListener(ZG.EVENT_COLUMN_REMOVE,this.removeItems.bind(this,[t])),this.context.createBean(i),this.guiDestroyFunctions.push(()=>this.destroyBean(i)),s||this.childPillComponents.push(i),i}addIconAndTitleToGui(){const{title:t,icon:s}=this.params;if(!t||!s)return;const i=document.createElement("div");if(hp(i,!0),this.addElementClasses(i,"title-bar"),this.addElementClasses(s,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingItemsEmpty()),i.appendChild(s),!this.horizontal){const r=document.createElement("span");this.addElementClasses(r,"title"),r.innerHTML=t,i.appendChild(r)}this.appendChild(i)}isExistingItemsEmpty(){return this.getExistingItems().length===0}addEmptyMessageToGui(){const{emptyMessage:t}=this.params;if(!t||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const s=document.createElement("span");s.innerHTML=t,this.addElementClasses(s,"empty-message"),this.ePillDropList.appendChild(s)}addArrow(t){if(this.horizontal){const s=this.gos.get("enableRtl"),i=cs(s?"smallLeft":"smallRight",this.gos);this.addElementClasses(i,"cell-separator"),t.appendChild(i)}}};Dp.STATE_NOT_DRAGGING="notDragging";Dp.STATE_NEW_ITEMS_IN="newItemsIn";Dp.STATE_REARRANGE_ITEMS="rearrangeItems";f([A("focusService")],Dp.prototype,"focusService",2);f([A("dragAndDropService")],Dp.prototype,"dragAndDropService",2);var JG=["touchstart","touchend","touchmove","touchcancel"],IN=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t()}setInterval(e,t){return new Ps(s=>{s(window.setInterval(e,t))})}addEventListener(e,t,s,i){const r=pr(JG,t);e.addEventListener(t,s,{capture:!!i,passive:r})}get shouldWrapOutgoing(){return!1}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`https://www.ag-grid.com/${this.frameworkName==="solid"?"react":this.frameworkName}-data-grid${e?`/${e}`:""}`}},fa=class extends Se{getNextCellToFocus(e,t,s=!1){return s?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const s=e===U.UP,i=e===U.DOWN,r=e===U.LEFT;let n,o;if(s||i)o=s?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),n=t.column;else{const a=this.columnModel.getAllDisplayedColumns(),l=this.gos.get("enableRtl");o=t.rowIndex,n=r!==l?a[0]:Mt(a)}return{rowIndex:o,rowPinned:null,column:n}}getNextCellToFocusWithoutCtrlPressed(e,t){let s=t,i=!1;for(;!i;){switch(e){case U.UP:s=this.getCellAbove(s);break;case U.DOWN:s=this.getCellBelow(s);break;case U.RIGHT:this.gos.get("enableRtl")?s=this.getCellToLeft(s):s=this.getCellToRight(s);break;case U.LEFT:this.gos.get("enableRtl")?s=this.getCellToRight(s):s=this.getCellToLeft(s);break;default:s=null,console.warn("AG Grid: unknown key for navigation "+e);break}s?i=this.isCellGoodToFocusOn(s):i=!0}return s}isCellGoodToFocusOn(e){const t=e.column;let s;switch(e.rowPinned){case"top":s=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":s=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:s=this.rowModel.getRow(e.rowIndex);break}return s?!t.isSuppressNavigable(s):!1}getCellToLeft(e){if(!e)return null;const t=this.columnModel.getDisplayedColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.columnModel.getDisplayedColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,s=e.rowPinned;if(this.isLastRowInContainer(e))switch(s){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const i=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(i);return r||{rowIndex:t+1,rowPinned:s}}getNextStickyPosition(e,t){if(!this.gos.isGroupRowsSticky()||!e||!e.sticky)return;const s=this.rowRenderer.getStickyTopRowCtrls().some(a=>a.getRowNode().rowIndex===e.rowIndex);let i=[];s?i=[...this.rowRenderer.getStickyTopRowCtrls()].sort((a,l)=>a.getRowNode().rowIndex-l.getRowNode().rowIndex):i=[...this.rowRenderer.getStickyBottomRowCtrls()].sort((a,l)=>l.getRowNode().rowIndex-a.getRowNode().rowIndex);const r=t?-1:1,n=i.findIndex(a=>a.getRowNode().rowIndex===e.rowIndex),o=i[n+r];if(o)return{rowIndex:o.getRowNode().rowIndex,rowPinned:null}}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,s=e.rowIndex;return t==="top"?this.pinnedRowModel.getPinnedTopRowData().length-1<=s:t==="bottom"?this.pinnedRowModel.getPinnedBottomRowData().length-1<=s:this.paginationProxy.getPageLastRow()<=s}getRowAbove(e){const t=e.rowIndex,s=e.rowPinned;if(s?t===0:t===this.paginationProxy.getPageFirstRow())return s==="top"?null:s?this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null:this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const r=this.rowModel.getRow(e.rowIndex),n=this.getNextStickyPosition(r,!0);return n||{rowIndex:t-1,rowPinned:s}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const t=this.columnModel.getAllDisplayedColumns();let s=e.rowIndex,i=e.rowPinned,r=this.columnModel.getDisplayedColAfter(e.column);if(!r){r=t[0];const n=this.getRowBelow(e);if(ot(n)||!n.rowPinned&&!this.paginationProxy.isRowInPage(n))return null;s=n?n.rowIndex:null,i=n?n.rowPinned:null}return{rowIndex:s,column:r,rowPinned:i}}getNextTabbedCellBackwards(e){const t=this.columnModel.getAllDisplayedColumns();let s=e.rowIndex,i=e.rowPinned,r=this.columnModel.getDisplayedColBefore(e.column);if(!r){r=Mt(t);const n=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(ot(n)||!n.rowPinned&&!this.paginationProxy.isRowInPage(n))return null;s=n?n.rowIndex:null,i=n?n.rowPinned:null}return{rowIndex:s,column:r,rowPinned:i}}};f([A("columnModel")],fa.prototype,"columnModel",2);f([A("rowModel")],fa.prototype,"rowModel",2);f([A("rowRenderer")],fa.prototype,"rowRenderer",2);f([A("pinnedRowModel")],fa.prototype,"pinnedRowModel",2);f([A("paginationProxy")],fa.prototype,"paginationProxy",2);fa=f([Le("cellNavigationService")],fa);var Fl=class extends Se{constructor(){super(...arguments),this.consuming=!1}setBeans(e){this.logger=e.create("AlignedGridsService")}getAlignedGridApis(){var e;let t=(e=this.gos.get("alignedGrids"))!=null?e:[];const s=typeof t=="function";typeof t=="function"&&(t=t());const i=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return t.map(n=>{var o;if(!n){tl("alignedGrids contains an undefined option."),s||tl(`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`),tl(i());return}if(n instanceof bt)return n;const a=n;return"current"in a?(o=a.current)==null?void 0:o.api:(a.api||tl(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${i()}`),a.api)}).filter(n=>!!n&&!n.isDestroyed())}init(){this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{if(t.isDestroyed())return;const s=t.__getAlignedGridService();e(s)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent(t=>{t.onColumnEvent(e)})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent(t=>{t.onScrollEvent(e)})}onScrollEvent(e){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}getMasterColumns(e){const t=[];return e.columns?e.columns.forEach(s=>{t.push(s)}):e.column&&t.push(e.column),t}getColumnIds(e){const t=[];return e.columns?e.columns.forEach(s=>{t.push(s.getColId())}):e.column&&t.push(e.column.getColId()),t}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case w.EVENT_COLUMN_MOVED:case w.EVENT_COLUMN_VISIBLE:case w.EVENT_COLUMN_PINNED:case w.EVENT_COLUMN_RESIZED:const t=e;this.processColumnEvent(t);break;case w.EVENT_COLUMN_GROUP_OPENED:const s=e;this.processGroupOpenedEvent(s);break;case w.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.");break}})}processGroupOpenedEvent(e){e.columnGroups.forEach(t=>{let s=null;if(t){const i=t.getGroupId();s=this.columnModel.getProvidedColumnGroup(i)}t&&!s||(this.logger.log("onColumnEvent-> processing "+e+" expanded = "+t.isExpanded()),this.columnModel.setColumnGroupOpened(s,t.isExpanded(),"alignedGridChanged"))})}processColumnEvent(e){var t;const s=e.column;let i=null;if(s&&(i=this.columnModel.getPrimaryColumn(s.getColId())),s&&!i)return;const r=this.getMasterColumns(e);switch(e.type){case w.EVENT_COLUMN_MOVED:{const u=e,p=e.api.getColumnState().map(g=>({colId:g.colId}));this.columnModel.applyColumnState({state:p,applyOrder:!0},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${e.type} toIndex = ${u.toIndex}`)}break;case w.EVENT_COLUMN_VISIBLE:{const u=e,p=e.api.getColumnState().map(g=>({colId:g.colId,hide:g.hide}));this.columnModel.applyColumnState({state:p},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${e.type} visible = ${u.visible}`)}break;case w.EVENT_COLUMN_PINNED:{const u=e,p=e.api.getColumnState().map(g=>({colId:g.colId,pinned:g.pinned}));this.columnModel.applyColumnState({state:p},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${e.type} pinned = ${u.pinned}`)}break;case w.EVENT_COLUMN_RESIZED:const a=e,l={};r.forEach(u=>{this.logger.log(`onColumnEvent-> processing ${e.type} actualWidth = ${u.getActualWidth()}`),l[u.getId()]={key:u.getColId(),newWidth:u.getActualWidth()}}),(t=a.flexColumns)==null||t.forEach(u=>{l[u.getId()]&&delete l[u.getId()]}),this.columnModel.setColumnWidths(Object.values(l),!1,a.finished,"alignedGridChanged");break}const o=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(a=>{a.setGridOption("alwaysShowVerticalScroll",o)})}};f([A("columnModel")],Fl.prototype,"columnModel",2);f([A("ctrlsService")],Fl.prototype,"ctrlsService",2);f([rn(0,Fr("loggerFactory"))],Fl.prototype,"setBeans",1);f([xe],Fl.prototype,"init",1);Fl=f([Le("alignedGridsService")],Fl);var Nl=class extends Se{constructor(){super(...arguments),this.selectedNodes=new Map,this.lastRowNode=null}init(){this.rowSelection=this.gos.get("rowSelection"),this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.rowSelection=this.gos.get("rowSelection"),this.deselectAllRowNodes({source:"api"})}),this.addManagedListener(this.eventService,w.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}destroy(){super.destroy(),this.resetNodes(),this.lastRowNode=null}isMultiselect(){return this.rowSelection==="multiple"}setNodesSelected(e){var t;const{newValue:s,clearSelection:i,suppressFinishActions:r,rangeSelect:n,nodes:o,event:a,source:l="api"}=e;if(o.length===0)return 0;if(o.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;const u=this.groupSelectsChildren&&e.groupSelectsFiltered===!0,h=o.map(g=>g.footer?g.sibling:g);if(n){if(o.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;let g=null;if(l==="checkboxSelected"&&s===!1&&this.lastRowNode&&(this.lastRowNode.id?g=this.lastRowNode:this.lastRowNode=null),g==null&&(g=this.getLastSelectedNode()),g){const m=h[0];if(m!==g&&this.isMultiselect())return this.selectRange(m,g,s,l)}}this.lastRowNode=s?null:h[0];let p=0;for(let g=0;g<h.length;g++){const m=h[g];u&&m.group||m.selectThisNode(s,a,l)&&p++,this.groupSelectsChildren&&((t=m.childrenAfterGroup)!=null&&t.length)&&(p+=this.selectChildren(m,s,u,l))}if(!r&&(s&&(i||!this.isMultiselect())&&(p+=this.clearOtherNodes(h[0],l)),p>0)){this.updateGroupsFromChildrenSelections(l);const m={type:w.EVENT_SELECTION_CHANGED,source:l};this.eventService.dispatchEvent(m)}return p}selectRange(e,t,s=!0,i){const r=this.rowModel.getNodesInRangeForSelection(e,t);let n=0;r.forEach(a=>{if(a.group&&this.groupSelectsChildren)return;a.selectThisNode(s,void 0,i)&&n++}),this.updateGroupsFromChildrenSelections(i);const o={type:w.EVENT_SELECTION_CHANGED,source:i};return this.eventService.dispatchEvent(o),n}selectChildren(e,t,s,i){const r=s?e.childrenAfterAggFilter:e.childrenAfterGroup;return ot(r)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:s,source:i,nodes:r})}getLastSelectedNode(){const e=Array.from(this.selectedNodes.keys());if(e.length==0)return null;const t=this.selectedNodes.get(Mt(e));return t||null}getSelectedNodes(){const e=[];return this.selectedNodes.forEach(t=>{t&&e.push(t)}),e}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>{t&&t.data&&e.push(t.data)}),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((s,i)=>{s&&e(s)&&t.set(i,s)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsChildren||this.rowModel.getType()!=="clientSide")return!1;const i=this.rowModel.getRootNode();t||(t=new cv(!0,i),t.setInactive());let r=!1;return t.forEachChangedNodeDepthFirst(n=>{if(n!==i){const o=n.calculateSelectedFromChildren();r=n.selectThisNode(o===null?!1:o,void 0,e)||r}}),r}clearOtherNodes(e,t){const s=new Map;let i=0;return this.selectedNodes.forEach(r=>{if(r&&r.id!==e.id){const n=this.selectedNodes.get(r.id);i+=n.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsChildren&&r.parent&&s.set(r.parent.id,r.parent)}}),s.forEach(r=>{const n=r.calculateSelectedFromChildren();r.selectThisNode(n===null?!1:n,void 0,t)}),i}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(e,t){if(ve(t)&&e.id!==t.id&&t){const i=t.id;this.selectedNodes.get(i)==e&&this.selectedNodes.set(t.id,t)}}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.setSelectedInitialValue(!0),this.selectedNodes.set(e.id,e)):e.setSelectedInitialValue(!1)}reset(e){const t=this.getSelectionCount();if(this.resetNodes(),t){const s={type:w.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(s)}}resetNodes(){var e;(e=this.selectedNodes)==null||e.clear()}getBestCostNodeSelection(){if(this.rowModel.getType()!=="clientSide")return;const t=this.rowModel.getTopLevelNodes();if(t===null)return;const s=[];function i(r){for(let n=0,o=r.length;n<o;n++){const a=r[n];if(a.isSelected())s.push(a);else{const l=a;l.group&&l.children&&i(l.children)}}}return i(t),s}isEmpty(){let e=0;return this.selectedNodes.forEach(t=>{t&&e++}),e===0}deselectAllRowNodes(e){const t=a=>a.selectThisNode(!1,void 0,i),s=this.rowModel.getType()==="clientSide",{source:i,justFiltered:r,justCurrentPage:n}=e;if(n||r){if(!s){console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");return}this.getNodesToSelect(r,n).forEach(t)}else this.selectedNodes.forEach(a=>{a&&t(a)}),this.reset(i);s&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(i);const o={type:w.EVENT_SELECTION_CHANGED,source:i};this.eventService.dispatchEvent(o)}getSelectedCounts(e,t){let s=0,i=0;const r=n=>{this.groupSelectsChildren&&n.group||(n.isSelected()?s++:n.selectable&&i++)};return this.getNodesToSelect(e,t).forEach(r),{selectedCount:s,notSelectedCount:i}}getSelectAllState(e,t){const{selectedCount:s,notSelectedCount:i}=this.getSelectedCounts(e,t);return s===0&&i===0?!1:s>0&&i>0?null:s>0}hasNodesToSelect(e=!1,t=!1){return this.getNodesToSelect(e,t).filter(s=>s.selectable).length>0}getNodesToSelect(e=!1,t=!1){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const s=[];if(t)return this.paginationProxy.forEachNodeOnPage(r=>{if(!r.group){s.push(r);return}if(!r.expanded){const n=o=>{var a;s.push(o),(a=o.childrenAfterFilter)!=null&&a.length&&o.childrenAfterFilter.forEach(n)};n(r);return}this.groupSelectsChildren||s.push(r)}),s;const i=this.rowModel;return e?(i.forEachNodeAfterFilter(r=>{s.push(r)}),s):(i.forEachNode(r=>{s.push(r)}),s)}selectAllRowNodes(e){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const{source:t,justFiltered:s,justCurrentPage:i}=e,r=o=>o.selectThisNode(!0,void 0,t);this.getNodesToSelect(s,i).forEach(r),this.rowModel.getType()==="clientSide"&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t);const n={type:w.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(n)}getSelectionState(){const e=[];return this.selectedNodes.forEach(t=>{t!=null&&t.id&&e.push(t.id)}),e.length?e:null}setSelectionState(e,t){if(!Array.isArray(e))return;const s=new Set(e),i=[];this.rowModel.forEachNode(r=>{s.has(r.id)&&i.push(r)}),this.setNodesSelected({newValue:!0,nodes:i,source:t})}};f([A("rowModel")],Nl.prototype,"rowModel",2);f([A("paginationProxy")],Nl.prototype,"paginationProxy",2);f([xe],Nl.prototype,"init",1);Nl=f([Le("selectionService")],Nl);var nu=class{constructor(e){this.viaApi=(t,...s)=>(tt(`Since v31, 'columnApi.${t}' is deprecated and moved to 'api.${t}'.`),this.api[t](...s)),this.api=e}sizeColumnsToFit(e){this.viaApi("sizeColumnsToFit",e)}setColumnGroupOpened(e,t){this.viaApi("setColumnGroupOpened",e,t)}getColumnGroup(e,t){return this.viaApi("getColumnGroup",e,t)}getProvidedColumnGroup(e){return this.viaApi("getProvidedColumnGroup",e)}getDisplayNameForColumn(e,t){return this.viaApi("getDisplayNameForColumn",e,t)}getDisplayNameForColumnGroup(e,t){return this.viaApi("getDisplayNameForColumnGroup",e,t)}getColumn(e){return this.viaApi("getColumn",e)}getColumns(){return this.viaApi("getColumns")}applyColumnState(e){return this.viaApi("applyColumnState",e)}getColumnState(){return this.viaApi("getColumnState")}resetColumnState(){this.viaApi("resetColumnState")}getColumnGroupState(){return this.viaApi("getColumnGroupState")}setColumnGroupState(e){this.viaApi("setColumnGroupState",e)}resetColumnGroupState(){this.viaApi("resetColumnGroupState")}isPinning(){return this.viaApi("isPinning")}isPinningLeft(){return this.viaApi("isPinningLeft")}isPinningRight(){return this.viaApi("isPinningRight")}getDisplayedColAfter(e){return this.viaApi("getDisplayedColAfter",e)}getDisplayedColBefore(e){return this.viaApi("getDisplayedColBefore",e)}setColumnVisible(e,t){this.viaApi("setColumnVisible",e,t)}setColumnsVisible(e,t){this.viaApi("setColumnsVisible",e,t)}setColumnPinned(e,t){this.viaApi("setColumnPinned",e,t)}setColumnsPinned(e,t){this.viaApi("setColumnsPinned",e,t)}getAllGridColumns(){return this.viaApi("getAllGridColumns")}getDisplayedLeftColumns(){return this.viaApi("getDisplayedLeftColumns")}getDisplayedCenterColumns(){return this.viaApi("getDisplayedCenterColumns")}getDisplayedRightColumns(){return this.viaApi("getDisplayedRightColumns")}getAllDisplayedColumns(){return this.viaApi("getAllDisplayedColumns")}getAllDisplayedVirtualColumns(){return this.viaApi("getAllDisplayedVirtualColumns")}moveColumn(e,t){this.viaApi("moveColumn",e,t)}moveColumnByIndex(e,t){this.viaApi("moveColumnByIndex",e,t)}moveColumns(e,t){this.viaApi("moveColumns",e,t)}moveRowGroupColumn(e,t){this.viaApi("moveRowGroupColumn",e,t)}setColumnAggFunc(e,t){this.viaApi("setColumnAggFunc",e,t)}setColumnWidth(e,t,s=!0,i){this.viaApi("setColumnWidth",e,t,s,i)}setColumnWidths(e,t=!0,s){this.viaApi("setColumnWidths",e,t,s)}setPivotMode(e){this.viaApi("setPivotMode",e)}isPivotMode(){return this.viaApi("isPivotMode")}getPivotResultColumn(e,t){return this.viaApi("getPivotResultColumn",e,t)}setValueColumns(e){this.viaApi("setValueColumns",e)}getValueColumns(){return this.viaApi("getValueColumns")}removeValueColumn(e){this.viaApi("removeValueColumn",e)}removeValueColumns(e){this.viaApi("removeValueColumns",e)}addValueColumn(e){this.viaApi("addValueColumn",e)}addValueColumns(e){this.viaApi("addValueColumns",e)}setRowGroupColumns(e){this.viaApi("setRowGroupColumns",e)}removeRowGroupColumn(e){this.viaApi("removeRowGroupColumn",e)}removeRowGroupColumns(e){this.viaApi("removeRowGroupColumns",e)}addRowGroupColumn(e){this.viaApi("addRowGroupColumn",e)}addRowGroupColumns(e){this.viaApi("addRowGroupColumns",e)}getRowGroupColumns(){return this.viaApi("getRowGroupColumns")}setPivotColumns(e){this.viaApi("setPivotColumns",e)}removePivotColumn(e){this.viaApi("removePivotColumn",e)}removePivotColumns(e){this.viaApi("removePivotColumns",e)}addPivotColumn(e){this.viaApi("addPivotColumn",e)}addPivotColumns(e){this.viaApi("addPivotColumns",e)}getPivotColumns(){return this.viaApi("getPivotColumns")}getLeftDisplayedColumnGroups(){return this.viaApi("getLeftDisplayedColumnGroups")}getCenterDisplayedColumnGroups(){return this.viaApi("getCenterDisplayedColumnGroups")}getRightDisplayedColumnGroups(){return this.viaApi("getRightDisplayedColumnGroups")}getAllDisplayedColumnGroups(){return this.viaApi("getAllDisplayedColumnGroups")}autoSizeColumn(e,t){return this.viaApi("autoSizeColumn",e,t)}autoSizeColumns(e,t){this.viaApi("autoSizeColumns",e,t)}autoSizeAllColumns(e){this.viaApi("autoSizeAllColumns",e)}setPivotResultColumns(e){this.viaApi("setPivotResultColumns",e)}getPivotResultColumns(){return this.viaApi("getPivotResultColumns")}};f([A("gridApi")],nu.prototype,"api",2);nu=f([Le("columnApi")],nu);var ma=class extends Se{constructor(){super(...arguments),this.initialised=!1,this.isSsrm=!1}init(){this.isSsrm=this.gos.isRowModelType("serverSide"),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=s=>this.callColumnCellValueChangedHandler(s),t=this.gos.useAsyncEvents();this.eventService.addEventListener(w.EVENT_CELL_VALUE_CHANGED,e,t),this.addDestroyFunc(()=>this.eventService.removeEventListener(w.EVENT_CELL_VALUE_CHANGED,e,t)),this.addManagedPropertyListener("treeData",s=>this.isTreeData=s.currentValue)}getValue(e,t,s=!1,i=!1){if(this.initialised||this.init(),!t)return;const r=e.getColDef(),n=r.field,o=e.getColId(),a=t.data;let l;const u=t.groupData&&t.groupData[o]!==void 0,h=!i&&t.aggData&&t.aggData[o]!==void 0,p=this.isSsrm&&i&&!!e.getColDef().aggFunc,g=this.isSsrm&&t.footer&&t.field&&(e.getColDef().showRowGroup===!0||e.getColDef().showRowGroup===t.field);if(s&&r.filterValueGetter?l=this.executeFilterValueGetter(r.filterValueGetter,a,e,t):this.isTreeData&&h?l=t.aggData[o]:this.isTreeData&&r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):this.isTreeData&&n&&a?l=Nc(a,n,e.isFieldContainsDots()):u?l=t.groupData[o]:h?l=t.aggData[o]:r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):g?l=Nc(a,t.field,e.isFieldContainsDots()):n&&a&&!p&&(l=Nc(a,n,e.isFieldContainsDots())),this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){const m=l.substring(1);l=this.executeValueGetter(m,a,e,t)}if(l==null){const m=this.getOpenedGroup(t,e);if(m!=null)return m}return l}parseValue(e,t,s,i){const r=e.getColDef(),n=this.gos.addGridCommonParams({node:t,data:t==null?void 0:t.data,oldValue:i,newValue:s,colDef:r,column:e}),o=r.valueParser;return ve(o)?typeof o=="function"?o(n):this.expressionService.evaluate(o,n):s}formatValue(e,t,s,i,r=!0){let n=null,o;const a=e.getColDef();if(i?o=i:r&&(o=a.valueFormatter),o){const l=this.gos.addGridCommonParams({value:s,node:t,data:t?t.data:null,colDef:a,column:e});typeof o=="function"?n=o(l):n=this.expressionService.evaluate(o,l)}else if(a.refData)return a.refData[s]||"";return n==null&&Array.isArray(s)&&(n=s.join(", ")),n}getOpenedGroup(e,t){if(!this.gos.get("showOpenedGroup")||!t.getColDef().showRowGroup)return;const i=t.getColDef().showRowGroup;let r=e.parent;for(;r!=null;){if(r.rowGroupColumn&&(i===!0||i===r.rowGroupColumn.getColId()))return r.key;r=r.parent}}setValue(e,t,s,i){const r=this.columnModel.getPrimaryColumn(t);if(!e||!r)return!1;ot(e.data)&&(e.data={});const{field:n,valueSetter:o}=r.getColDef();if(ot(n)&&ot(o))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(r,s))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:e,data:e.data,oldValue:this.getValue(r,e),newValue:s,colDef:r.getColDef(),column:r});a.newValue=s;let l;if(ve(o)?typeof o=="function"?l=o(a):l=this.expressionService.evaluate(o,a):l=this.setValueUsingField(e.data,n,s,r.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),a.newValue=this.getValue(r,e);const u={type:w.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,api:a.api,columnApi:a.columnApi,colDef:a.colDef,context:a.context,data:e.data,node:e,oldValue:a.oldValue,newValue:a.newValue,value:a.newValue,source:i};return this.eventService.dispatchEvent(u),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.getFrameworkOverrides().wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,columnApi:e.columnApi,context:e.context})})}setValueUsingField(e,t,s,i){if(!t)return!1;let r=!1;if(!i)r=e[t]===s,r||(e[t]=s);else{const n=t.split(".");let o=e;for(;n.length>0&&o;){const a=n.shift();n.length===0?(r=o[a]===s,r||(o[a]=s)):o=o[a]}}return!r}executeFilterValueGetter(e,t,s,i){const r=this.gos.addGridCommonParams({data:t,node:i,column:s,colDef:s.getColDef(),getValue:this.getValueCallback.bind(this,i)});return typeof e=="function"?e(r):this.expressionService.evaluate(e,r)}executeValueGetter(e,t,s,i){const r=s.getColId(),n=this.valueCache.getValue(i,r);if(n!==void 0)return n;const o=this.gos.addGridCommonParams({data:t,node:i,column:s,colDef:s.getColDef(),getValue:this.getValueCallback.bind(this,i)});let a;return typeof e=="function"?a=e(o):a=this.expressionService.evaluate(e,o),this.valueCache.setValue(i,r,a),a}getValueCallback(e,t){const s=this.columnModel.getPrimaryColumn(t);return s?this.getValue(s,e):null}getKeyForNode(e,t){const s=this.getValue(e,t),i=e.getColDef().keyCreator;let r=s;if(i){const n=this.gos.addGridCommonParams({value:s,colDef:e.getColDef(),column:e,node:t,data:t.data});r=i(n)}return typeof r=="string"||r==null||(r=String(r),r==="[object Object]"&&tt("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),r}};f([A("expressionService")],ma.prototype,"expressionService",2);f([A("columnModel")],ma.prototype,"columnModel",2);f([A("valueCache")],ma.prototype,"valueCache",2);f([A("dataTypeService")],ma.prototype,"dataTypeService",2);f([xe],ma.prototype,"init",1);ma=f([Le("valueService")],ma);var If=class extends Se{constructor(){super(...arguments),this.expressionToFunctionCache={}}setBeans(e){this.logger=e.create("ExpressionService")}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);console.error("AG Grid: value should be either a string or a function",e)}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.columnApi,t.getValue,t.column,t.columnGroup)}catch(s){return console.log("Processing of the expression failed"),console.log("Expression = "+e),console.log("Params =",t),console.log("Exception = "+s),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),s=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=s,s}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}};f([rn(0,Fr("loggerFactory"))],If.prototype,"setBeans",1);If=f([Le("expressionService")],If);var _f=class extends Se{setBeans(e){this.logging=e.get("debug")}create(e){return new U0(e,this.isLogging.bind(this))}isLogging(){return this.logging}};f([rn(0,Fr("gridOptionsService"))],_f.prototype,"setBeans",1);_f=f([Le("loggerFactory")],_f);var U0=class{constructor(t,s){this.name=t,this.isLoggingFunc=s}isLogging(){return this.isLoggingFunc()}log(t){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+t)}},Fa=class extends Se{setComp(e,t,s){this.view=e,this.eGridHostDiv=t,this.eGui=s,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:r=>r===1||r===0,getIconName:()=>ut.ICON_NOT_ALLOWED}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new ev(this.view)),this.addRtlSupport();const i=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>i()),this.ctrlsService.register("gridCtrl",this)}isDetailGrid(){var e;const t=this.focusService.findTabbableParent(this.getGui());return((e=t==null?void 0:t.getAttribute("row-id"))==null?void 0:e.startsWith("detail"))||!1}showDropZones(){return Vt.__isRegistered("@ag-grid-enterprise/row-grouping",this.context.getGridId())}showSideBar(){return Vt.__isRegistered("@ag-grid-enterprise/side-bar",this.context.getGridId())}showStatusBar(){return Vt.__isRegistered("@ag-grid-enterprise/status-bar",this.context.getGridId())}showWatermark(){return Vt.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId())}onGridSizeChanged(){const e={type:w.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)}addRtlSupport(){const e=this.gos.get("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.view.getFocusableContainers(),s=this.gos.getActiveDomElement(),r=t.findIndex(n=>n.contains(s))+(e?-1:1);return r<=0||r>=t.length?!1:this.focusService.focusInto(t[r])}focusInnerElement(e){const t=this.view.getFocusableContainers(),s=this.columnModel.getAllDisplayedColumns();if(e){if(t.length>1)return this.focusService.focusInto(Mt(t),!0);const i=Mt(s);if(this.focusService.focusGridView(i,!0))return!0}if(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")){if(this.focusService.focusGridView(s[0]))return!0;for(let i=1;i<t.length;i++)if(this.focusService.focusInto(t[i]))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}};f([A("focusService")],Fa.prototype,"focusService",2);f([A("resizeObserverService")],Fa.prototype,"resizeObserverService",2);f([A("columnModel")],Fa.prototype,"columnModel",2);f([A("ctrlsService")],Fa.prototype,"ctrlsService",2);f([A("mouseEventService")],Fa.prototype,"mouseEventService",2);f([A("dragAndDropService")],Fa.prototype,"dragAndDropService",2);var Pp=class extends Ep{constructor(t){super(),this.eGridDiv=t}postConstruct(){this.logger=this.loggerFactory.create("GridComp");const t={destroyGridUi:()=>this.destroyBean(this),setRtlClass:i=>this.addCssClass(i),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:i=>{this.getGui().style.userSelect=i??"",this.getGui().style.webkitUserSelect=i??""},setCursor:i=>{this.getGui().style.cursor=i??""}};this.ctrl=this.createManagedBean(new Fa);const s=this.createTemplate();this.setTemplate(s),this.ctrl.setComp(t,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:i=>this.ctrl.focusInnerElement(i),forceFocusOutWhenTabGuardsAreEmpty:!0})}insertGridIntoDom(){const t=this.getGui();this.eGridDiv.appendChild(t),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(t),this.logger.log("Grid removed from DOM")})}updateLayoutClasses(t,s){const i=this.eRootWrapperBody.classList;i.toggle("ag-layout-auto-height",s.autoHeight),i.toggle("ag-layout-normal",s.normal),i.toggle("ag-layout-print",s.print),this.addOrRemoveCssClass("ag-layout-auto-height",s.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",s.normal),this.addOrRemoveCssClass("ag-layout-print",s.print)}createTemplate(){const t=this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"",s=this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"",i=this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"",r=this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"";return`<div class="ag-root-wrapper" role="presentation">
                ${t}
                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">
                    <ag-grid-body ref="gridBody"></ag-grid-body>
                    ${s}
                </div>
                ${i}
                <ag-pagination></ag-pagination>
                ${r}
            </div>`}getFocusableElement(){return this.eRootWrapperBody}getFocusableContainers(){const t=[this.gridBodyComp.getGui()];return this.sideBarComp&&t.push(this.sideBarComp.getGui()),t.filter(s=>Zi(s))}};f([A("loggerFactory")],Pp.prototype,"loggerFactory",2);f([Fe("gridBody")],Pp.prototype,"gridBodyComp",2);f([Fe("sideBar")],Pp.prototype,"sideBarComp",2);f([Fe("rootWrapperBody")],Pp.prototype,"eRootWrapperBody",2);f([xe],Pp.prototype,"postConstruct",1);var Il=class extends Se{progressSort(e,t,s){const i=this.getNextSortDirection(e);this.setSortForColumn(e,i,t,s)}setSortForColumn(e,t,s,i){t!=="asc"&&t!=="desc"&&(t=null);const r=this.gos.isColumnsSortingCoupledToGroup();let n=[e];if(r&&e.getColDef().showRowGroup){const l=this.columnModel.getSourceColumnsForGroupColumn(e),u=l==null?void 0:l.filter(h=>h.isSortable());u&&(n=[e,...u])}n.forEach(l=>l.setSort(t,i));const o=(s||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"),a=[];if(!o){const l=this.clearSortBarTheseColumns(n,i);a.push(...l)}this.updateSortIndex(e),a.push(...n),this.dispatchSortChangedEvents(i,a)}updateSortIndex(e){const t=this.gos.isColumnsSortingCoupledToGroup(),s=this.columnModel.getGroupDisplayColumnForGroup(e.getId()),i=t&&s||e,r=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(a=>a.setSortIndex(null));const n=r.filter(a=>t&&a.getColDef().showRowGroup?!1:a!==i);(i.getSort()?[...n,i]:n).forEach((a,l)=>{a.setSortIndex(l)})}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){const t=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(s=>!!s.getSort());return t&&t.length>0}dispatchSortChangedEvents(e,t){const s={type:w.EVENT_SORT_CHANGED,source:e};t&&(s.columns=t),this.eventService.dispatchEvent(s)}clearSortBarTheseColumns(e,t){const s=[];return this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(i=>{e.includes(i)||(i.getSort()&&s.push(i),i.setSort(void 0,t))}),s}getNextSortDirection(e){let t;if(e.getColDef().sortingOrder?t=e.getColDef().sortingOrder:this.gos.get("sortingOrder")?t=this.gos.get("sortingOrder"):t=Il.DEFAULT_SORTING_ORDER,!Array.isArray(t)||t.length<=0)return console.warn(`AG Grid: sortingOrder must be an array with at least one element, currently it's ${t}`),null;const s=t.indexOf(e.getSort()),i=s<0,r=s==t.length-1;let n;return i||r?n=t[0]:n=t[s+1],Il.DEFAULT_SORTING_ORDER.indexOf(n)<0?(console.warn("AG Grid: invalid sort type "+n),null):n}getIndexedSortMap(){let e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(n=>!!n.getSort());if(this.columnModel.isPivotMode()){const n=this.gos.isColumnsSortingCoupledToGroup();e=e.filter(o=>{const a=!!o.getAggFunc(),l=!o.isPrimary(),u=n?this.columnModel.getGroupDisplayColumnForGroup(o.getId()):o.getColDef().showRowGroup;return a||l||u})}const t=this.columnModel.getRowGroupColumns().filter(n=>!!n.getSort()),s={};e.forEach((n,o)=>s[n.getId()]=o),e.sort((n,o)=>{const a=n.getSortIndex(),l=o.getSortIndex();if(a!=null&&l!=null)return a-l;if(a==null&&l==null){const u=s[n.getId()],h=s[o.getId()];return u>h?1:-1}else return l==null?-1:1});const i=this.gos.isColumnsSortingCoupledToGroup()&&!!t.length;i&&(e=[...new Set(e.map(n=>{var o;return(o=this.columnModel.getGroupDisplayColumnForGroup(n.getId()))!=null?o:n}))]);const r=new Map;return e.forEach((n,o)=>r.set(n,o)),i&&t.forEach(n=>{const o=this.columnModel.getGroupDisplayColumnForGroup(n.getId());r.set(n,r.get(o))}),r}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([e,t],[s,i])=>t-i).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=this.gos.isColumnsSortingCoupledToGroup(),s=!!e.getColDef().showRowGroup;return t&&s}getDisplaySortForColumn(e){const t=this.columnModel.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(t!=null&&t.length))return e.getSort();const i=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,r=i[0].getSort();return i.every(o=>o.getSort()==r)?r:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}};Il.DEFAULT_SORTING_ORDER=["asc","desc",null];f([A("columnModel")],Il.prototype,"columnModel",2);Il=f([Le("sortController")],Il);var $t=class extends Se{static addKeyboardModeEvents(e){this.instanceCount>0||(e.addEventListener("keydown",$t.toggleKeyboardMode),e.addEventListener("mousedown",$t.toggleKeyboardMode))}static removeKeyboardModeEvents(e){this.instanceCount>0||(e.addEventListener("keydown",$t.toggleKeyboardMode),e.addEventListener("mousedown",$t.toggleKeyboardMode))}static toggleKeyboardMode(e){const t=$t.keyboardModeActive,s=e.type==="keydown";s&&(e.ctrlKey||e.metaKey||e.altKey)||t!==s&&($t.keyboardModeActive=s)}static unregisterGridCompController(e){$t.removeKeyboardModeEvents(e)}init(){const e=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(t=>{this.gridCtrl=t.gridCtrl})}registerKeyboardFocusEvents(){const e=this.gos.getDocument();$t.addKeyboardModeEvents(e),$t.instanceCount++,this.addDestroyFunc(()=>{$t.instanceCount--,$t.unregisterGridCompController(e)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const e=this.focusedCellPosition.column,t=this.columnModel.getGridColumn(e.getId());e!==t&&this.clearFocusedCell()}isKeyboardMode(){return $t.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),vl.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),nv.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(e,t){let s=e;for(;s;){if(this.gos.getDomData(s,t))return!1;s=s.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(e){return this.isCellRestoreFocused(e)?(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0):!1}isCellRestoreFocused(e){return this.restoredFocusedCellPosition==null?!1:this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}setRestoreFocusedCell(e){this.getFrameworkOverrides().renderingEngine==="react"&&(this.restoredFocusedCellPosition=e)}getFocusEventParams(){const{rowIndex:e,rowPinned:t,column:s}=this.focusedCellPosition,i={rowIndex:e,rowPinned:t,column:s,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:t});return r&&(i.isFullWidthCell=r.isFullWidth()),i}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,this.focusedCellPosition==null)return;const e=Xe({type:w.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(e)}setFocusedCell(e){const{column:t,rowIndex:s,rowPinned:i,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:n=!1}=e,o=this.columnModel.getGridColumn(t);if(!o){this.focusedCellPosition=null;return}this.focusedCellPosition=o?{rowIndex:s,rowPinned:Mn(i),column:o}:null;const a=rs(Xe({type:w.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:r,preventScrollOnBrowserFocus:n,floating:null});this.eventService.dispatchEvent(a)}isCellFocused(e){return this.focusedCellPosition==null?!1:this.cellPositionUtils.equals(e,this.focusedCellPosition)}isRowNodeFocused(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}isHeaderWrapperFocused(e){if(this.focusedHeaderPosition==null)return!1;const t=e.getColumnGroupChild(),s=e.getRowIndex(),i=e.getPinned(),{column:r,headerRowIndex:n}=this.focusedHeaderPosition;return t===r&&s===n&&i==r.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}focusHeaderPosition(e){if(this.gos.get("suppressHeaderFocus"))return!1;const{direction:t,fromTab:s,allowUserOverride:i,event:r,fromCell:n,rowWithoutSpanValue:o}=e;let{headerPosition:a}=e;if(n&&this.filterManager.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(a);if(i){const l=this.getFocusedHeader(),u=this.headerNavigationService.getHeaderRowCount();if(s){const h=this.gos.getCallback("tabToNextHeader");h&&(a=this.getHeaderPositionFromUserFunc({userFunc:h,direction:t,currentPosition:l,headerPosition:a,headerRowCount:u}))}else{const h=this.gos.getCallback("navigateToNextHeader");if(h&&r){const p={key:r.key,previousHeaderPosition:l,nextHeaderPosition:a,headerRowCount:u,event:r};a=h(p)}}}return a?this.focusProvidedHeaderPosition({headerPosition:a,direction:t,event:r,fromCell:n,rowWithoutSpanValue:o}):!1}focusHeaderPositionFromUserFunc(e){if(this.gos.get("suppressHeaderFocus"))return!1;const{userFunc:t,headerPosition:s,direction:i,event:r}=e,n=this.getFocusedHeader(),o=this.headerNavigationService.getHeaderRowCount(),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:i,currentPosition:n,headerPosition:s,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:i,event:r})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:s,currentPosition:i,headerPosition:r,headerRowCount:n}=e,a=t({backwards:s==="Before",previousHeaderPosition:i,nextHeaderPosition:r,headerRowCount:n});return a===!0||a===null?(a===null&&tt("Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),i):a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:s,fromCell:i,rowWithoutSpanValue:r,event:n}=e;if(t.headerRowIndex===-1)return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView(t.column);this.headerNavigationService.scrollToColumn(t.column,s);const a=this.ctrlsService.getHeaderRowContainerCtrl(t.column.getPinned()).focusHeader(t.headerRowIndex,t.column,n);return a&&(r!=null||i)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(r??-1),a}focusFirstHeader(){let e=this.columnModel.getAllDisplayedColumns()[0];if(!e)return!1;e.getParent()&&(e=this.columnModel.getColumnGroupAtLevel(e,0));const t=this.headerPositionUtils.getHeaderIndexToFocus(e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){const t=this.headerNavigationService.getHeaderRowCount()-1,s=Mt(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:s},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(e,t){return this.focusedCellPosition==null?!1:this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===Mn(t)}findFocusableElements(e,t,s=!1){const i=rF;let r=h0;t&&(r+=", "+t),s&&(r+=', [tabindex="-1"]');const n=Array.prototype.slice.apply(e.querySelectorAll(i)).filter(l=>Zi(l)),o=Array.prototype.slice.apply(e.querySelectorAll(r));return o.length?((l,u)=>l.filter(h=>u.indexOf(h)===-1))(n,o):n}focusInto(e,t=!1,s=!1){const i=this.findFocusableElements(e,null,s),r=t?Mt(i):i[0];return r?(r.focus({preventScroll:!0}),!0):!1}findFocusableElementBeforeTabGuard(e,t){if(!t)return null;const s=this.findFocusableElements(e),i=s.indexOf(t);if(i===-1)return null;let r=-1;for(let n=i-1;n>=0;n--)if(s[n].classList.contains("ag-tab-guard-top")){r=n;break}return r<=0?null:s[r-1]}findNextFocusableElement(e=this.eGridDiv,t,s){const i=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),r=this.gos.getActiveDomElement();let n;t?n=i.findIndex(a=>a.contains(r)):n=i.indexOf(r);const o=n+(s?-1:1);return o<0||o>=i.length?null:i[o]}isTargetUnderManagedComponent(e,t){if(!t)return!1;const s=e.querySelectorAll(`.${Ea.FOCUS_MANAGED_CLASS}`);if(!s.length)return!1;for(let i=0;i<s.length;i++)if(s[i].contains(t))return!0;return!1}findTabbableParent(e,t=5){let s=0;for(;e&&Tf(e)===null&&++s<=t;)e=e.parentElement;return Tf(e)===null?null:e}focusGridView(e,t){var s;if(this.gos.get("suppressCellFocus"))return t?this.gos.get("suppressHeaderFocus")?this.focusNextGridCoreContainer(!0,!0):this.focusLastHeader():this.focusNextGridCoreContainer(!1);const i=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!i)return!1;const{rowIndex:r,rowPinned:n}=i,o=this.getFocusedHeader();return!e&&o&&(e=o.column),r==null||!e?!1:(this.navigationService.ensureCellVisible({rowIndex:r,column:e,rowPinned:n}),this.setFocusedCell({rowIndex:r,column:e,rowPinned:Mn(n),forceBrowserFocus:!0}),(s=this.rangeService)==null||s.setRangeToCell({rowIndex:r,rowPinned:n,column:e}),!0)}focusNextGridCoreContainer(e,t=!1){return!t&&this.gridCtrl.focusNextInnerContainer(e)?!0:((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}focusAdvancedFilter(e){var t,s;return this.advancedFilterFocusColumn=e==null?void 0:e.column,(s=(t=this.advancedFilterService)==null?void 0:t.getCtrl().focusHeaderComp())!=null?s:!1}focusNextFromAdvancedFilter(e,t){var s,i;const r=(i=t?void 0:this.advancedFilterFocusColumn)!=null?i:(s=this.columnModel.getAllDisplayedColumns())==null?void 0:s[0];return e?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(r)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}};$t.keyboardModeActive=!1;$t.instanceCount=0;f([A("eGridDiv")],$t.prototype,"eGridDiv",2);f([A("columnModel")],$t.prototype,"columnModel",2);f([A("headerNavigationService")],$t.prototype,"headerNavigationService",2);f([A("headerPositionUtils")],$t.prototype,"headerPositionUtils",2);f([A("rowRenderer")],$t.prototype,"rowRenderer",2);f([A("rowPositionUtils")],$t.prototype,"rowPositionUtils",2);f([A("cellPositionUtils")],$t.prototype,"cellPositionUtils",2);f([A("navigationService")],$t.prototype,"navigationService",2);f([A("ctrlsService")],$t.prototype,"ctrlsService",2);f([A("filterManager")],$t.prototype,"filterManager",2);f([zt("rangeService")],$t.prototype,"rangeService",2);f([zt("advancedFilterService")],$t.prototype,"advancedFilterService",2);f([xe],$t.prototype,"init",1);$t=f([Le("focusService")],$t);var dw=class extends Se{setMouseOver(e){this.selectedColumns=e;const t={type:w.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)}clearMouseOver(){this.selectedColumns=null;const e={type:w.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}};dw=f([Le("columnHoverService")],dw);var bh=class extends Se{constructor(){super(...arguments),this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.ctrlsService.whenReady(e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&this.flush(()=>{this.active=!1})}executeNextVMTurn(e){this.active?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(e){if(this.executeNextFuncs.length===0&&this.executeLaterFuncs.length===0){e();return}const t=s=>{for(;s.length;){const i=s.pop();i&&i()}};this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>t(this.executeNextFuncs),0),window.setTimeout(()=>{e(),t(this.executeLaterFuncs)},200)})}};f([A("ctrlsService")],bh.prototype,"ctrlsService",2);f([xe],bh.prototype,"postConstruct",1);bh=f([Le("columnAnimationService")],bh);var ou=class extends Se{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowsCtrl=e.center,this.addManagedListener(this.eventService,w.EVENT_BODY_HEIGHT_CHANGED,this.checkPageSize.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,this.checkPageSize.bind(this)),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.paginationProxy.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(e>0){const t=()=>{const s=this.gos.getRowHeightAsNumber(),i=Math.floor(e/s);this.paginationProxy.setPageSize(i,"autoCalculated")};this.isBodyRendered?xi(()=>t(),50)():(t(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}};f([A("ctrlsService")],ou.prototype,"ctrlsService",2);f([A("paginationProxy")],ou.prototype,"paginationProxy",2);f([xe],ou.prototype,"postConstruct",1);ou=f([Le("paginationAutoPageSizeService")],ou);var kf=class extends Se{constructor(){super(...arguments),this.cacheVersion=0}init(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,s){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=s)}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}};f([xe],kf.prototype,"init",1);kf=f([Le("valueCache")],kf);var XG="paste",au=class extends Se{init(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,w.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}onCellValueChanged(e){e.source!==XG&&this.doChangeDetection(e.node,e.column)}doChangeDetection(e,t){if(this.gos.get("suppressChangeDetection"))return;const s=[e];if(this.clientSideRowModel&&!e.isRowPinned()){const i=this.gos.get("aggregateOnlyChangedColumns"),r=new cv(i,this.clientSideRowModel.getRootNode());r.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(r),r.forEachChangedNodeDepthFirst(n=>{s.push(n)})}this.rowRenderer.refreshCells({rowNodes:s})}};f([A("rowModel")],au.prototype,"rowModel",2);f([A("rowRenderer")],au.prototype,"rowRenderer",2);f([xe],au.prototype,"init",1);au=f([Le("changeDetectionService")],au);var Mf=class extends Se{adaptFunction(e,t){const s=this.componentMetadataProvider.retrieve(e);return s&&s.functionAdapter?s.functionAdapter(t):null}adaptCellRendererFunction(e){class t{refresh(i){return!1}getGui(){return this.eGui}init(i){const r=e(i),n=typeof r;if(n==="string"||n==="number"||n==="boolean"){this.eGui=$i("<span>"+r+"</span>");return}if(r==null){this.eGui=$i("<span></span>");return}this.eGui=r}}return t}doesImplementIComponent(e){return e?e.prototype&&"getGui"in e.prototype:!1}};f([A("componentMetadataProvider")],Mf.prototype,"componentMetadataProvider",2);Mf=f([Le("agComponentUtils")],Mf);var Eh=class extends Se{postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(e){return this.componentMetaData[e]}};f([A("agComponentUtils")],Eh.prototype,"agComponentUtils",2);f([xe],Eh.prototype,"postConstruct",1);Eh=f([Le("componentMetadataProvider")],Eh);var e2=25,AE=10,mC=8,t2=4,vC=4,CC=6,s2=16,FE=14,yC=8,i2={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:t2*5,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:mC*7,headerCellMinWidth:48,listItemHeight:mC*4,rowHeight:mC*6,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:vC*8,headerCellMinWidth:24,listItemHeight:vC*6,rowHeight:vC*7,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:CC*8,headerCellMinWidth:36,listItemHeight:CC*4,rowHeight:CC*7,chartMenuPanelWidth:240},"ag-theme-quartz":{headerHeight:FE+yC*4.25,headerCellMinWidth:36,listItemHeight:s2+yC,rowHeight:FE+yC*3.5,chartMenuPanelWidth:260}},NE={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},Rh=class extends Se{constructor(){super(...arguments),this.calculatedSizes={},this.calculatedTheme=null}postConstruct(){var e;const t=(e=this.getTheme().el)!=null?e:this.eGridDiv;this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.mutationObserver=new MutationObserver(()=>{this.calculatedSizes={},this.calculatedTheme=null,this.calculatedTheme=this.getTheme(),this.fireGridStylesChangedEvent()}),this.mutationObserver.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}fireGridStylesChangedEvent(){const e={type:w.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(e)}getSassVariable(e){const{themeFamily:t,el:s}=this.getTheme();if(!t||t.indexOf("ag-theme")!==0)return;this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[t]||(this.calculatedSizes[t]={});const i=this.calculatedSizes[t][e];return i??(this.calculatedSizes[t][e]=this.calculateValueForSassProperty(e,t,s),this.calculatedSizes[t][e])}calculateValueForSassProperty(e,t,s){const i="ag-theme-"+(t.match("material")?"material":t.match("balham")?"balham":t.match("alpine")?"alpine":"custom"),r=i2[i][e],n=this.gos.getDocument();if(s||(s=this.eGridDiv),!NE[e])return r;const o=NE[e],a=n.createElement("div"),l=Array.from(s.classList);a.classList.add(t,...l),a.style.position="absolute";const u=o.reduce((p,g)=>{const m=n.createElement("div");return m.style.position="static",m.classList.add(g),p.appendChild(m),m},a);let h=0;if(n.body){n.body.appendChild(a);const p=e.toLowerCase().indexOf("height")!==-1?"height":"width";h=parseInt(window.getComputedStyle(u)[p],10),n.body.removeChild(a)}return h||r}isThemeDark(){const{theme:e}=this.getTheme();return!!e&&e.indexOf("dark")>=0}chartMenuPanelWidth(){return this.getSassVariable("chartMenuPanelWidth")}getTheme(){if(this.calculatedTheme)return this.calculatedTheme;const e=/\bag-(material|(?:theme-([\w\-]*)))\b/g;let t=this.eGridDiv,s=null,i=[];for(;t;)if(s=e.exec(t.className),!s)t=t.parentElement||void 0;else{const n=t.className.match(e);n&&(i=n);break}if(!s)return{allThemes:i};const r=s[0];return this.calculatedTheme={theme:r,el:t,themeFamily:r.replace(/-dark$/,""),allThemes:i},this.calculatedTheme}getFromTheme(e,t){var s;return(s=this.getSassVariable(t))!=null?s:e}getDefaultRowHeight(){return this.getFromTheme(e2,"rowHeight")}getListItemHeight(){return this.getFromTheme(20,"listItemHeight")}refreshRowHeightVariable(){const e=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),t=this.gos.get("rowHeight");if(t==null||isNaN(t)||!isFinite(t))return e!==null&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const s=`${t}px`;return e!=s?(this.eGridDiv.style.setProperty("--ag-line-height",s),t):e!=""?parseFloat(e):-1}getMinColWidth(){const e=this.getFromTheme(null,"headerCellMinWidth");return ve(e)?Math.max(e,AE):AE}destroy(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),super.destroy()}};f([A("eGridDiv")],Rh.prototype,"eGridDiv",2);f([xe],Rh.prototype,"postConstruct",1);Rh=f([Le("environment")],Rh);var lu=class extends Se{constructor(){super(...arguments),this.scrollY=0,this.uiBodyHeight=0}agWire(e){this.logger=e.create("RowContainerHeightService")}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=qA(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,s=this.getUiBodyHeight();(t!==this.scrollY||s!==this.uiBodyHeight)&&(this.scrollY=t,this.uiBodyHeight=s,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.logger.log(`Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:w.EVENT_HEIGHT_SCALE_CHANGED}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return t.bottom-t.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),s=e/t;return this.maxScrollY*s}};f([A("ctrlsService")],lu.prototype,"ctrlsService",2);f([rn(0,Fr("loggerFactory"))],lu.prototype,"agWire",1);f([xe],lu.prototype,"postConstruct",1);lu=f([Le("rowContainerHeightService")],lu);var cu=class extends Se{init(){this.addManagedPropertyListener("isRowSelectable",()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(e=!1){const t=!!this.gos.get("rowSelection"),s=this.gos.get("isRowSelectable");if(!t||!s)return;const i=this.gos.get("groupSelectsChildren"),r=this.rowModel.getType()==="clientSide"&&i,n=[],o=a=>{if(e&&!a.group)return;if(r&&a.group){const u=a.childrenAfterGroup.some(h=>h.selectable===!0);a.setRowSelectable(u,!0);return}const l=s?s(a):!0;a.setRowSelectable(l,!0),!l&&a.isSelected()&&n.push(a)};if(r){const a=this.rowModel;new cv(!1,a.getRootNode()).forEachChangedNodeDepthFirst(o,!0,!0)}else this.rowModel.forEachNode(o);n.length&&this.selectionService.setNodesSelected({nodes:n,newValue:!1,source:"selectableChanged"}),r&&this.selectionService instanceof Nl&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}};f([A("rowModel")],cu.prototype,"rowModel",2);f([A("selectionService")],cu.prototype,"selectionService",2);f([xe],cu.prototype,"init",1);cu=f([Le("selectableService")],cu);var er=class extends at{constructor(){super(),this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate());const{btFirst:t,btPrevious:s,btNext:i,btLast:r,pageSizeComp:n}=this;this.activateTabIndex([t,s,i,r]),t.insertAdjacentElement("afterbegin",cs(e?"last":"first",this.gos)),s.insertAdjacentElement("afterbegin",cs(e?"next":"previous",this.gos)),i.insertAdjacentElement("afterbegin",cs(e?"previous":"next",this.gos)),r.insertAdjacentElement("afterbegin",cs(e?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.onPaginationChanged()}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:s}=e;this.addManagedListener(t,"click",s),this.addManagedListener(t,"keydown",i=>{(i.key===U.ENTER||i.key===U.SPACE)&&(i.preventDefault(),s())})}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}setCurrentPageLabel(){const e=this.paginationProxy.getTotalPages()>0,t=this.paginationProxy.getCurrentPage(),s=e?t+1:0;this.lbCurrent.textContent=this.formatNumber(s)}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t)return t({value:e});const s=this.localeService.getLocaleTextFunc(),i=s("thousandSeparator",","),r=s("decimalSeparator",".");return d0(e,i,r)}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),s=e("to","to"),i=e("of","of"),r=e("firstPage","First Page"),n=e("previousPage","Previous Page"),o=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">
                <ag-page-size-selector ref="pageSizeComp"></ag-page-size-selector>
                <span class="ag-paging-row-summary-panel" role="status">
                    <span id="ag-${l}-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-to">${s}</span>
                    <span id="ag-${l}-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-of">${i}</span>
                    <span id="ag-${l}-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>
                </span>
                <span class="ag-paging-page-summary-panel" role="presentation">
                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${r}"></div>
                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${n}"></div>
                    <span class="ag-paging-description" role="status">
                        <span id="ag-${l}-start-page">${t}</span>
                        <span id="ag-${l}-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>
                        <span id="ag-${l}-of-page">${i}</span>
                        <span id="ag-${l}-of-page-number" ref="lbTotal" class="ag-paging-number"></span>
                    </span>
                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>
                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>
                </span>
            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}enableOrDisableButtons(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.isLastPageFound(),s=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const i=this.isZeroPagesToDisplay(),r=e===s-1;this.nextButtonDisabled=r||i,this.lastButtonDisabled=!t||i||e===s-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){t0(e,t),e.classList.toggle("ag-disabled",t)}updateRowLabels(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.getPageSize(),s=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;let r,n;if(this.isZeroPagesToDisplay()?r=n=0:(r=t*e+1,n=r+t-1,s&&n>i&&(n=i)),this.lbFirstRowOnPage.textContent=this.formatNumber(r),this.rowNodeBlockLoader.isLoading()){const o=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=o("pageLastRowUnknown","?")}else this.lbLastRowOnPage.textContent=this.formatNumber(n)}isZeroPagesToDisplay(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages();return e&&t===0}setTotalLabels(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages(),s=e?this.paginationProxy.getMasterRowCount():null;if(s===1){const i=this.paginationProxy.getRow(0);if(i&&i.group&&!(i.groupData||i.aggData)){this.setTotalLabelsToZero();return}}if(e)this.lbTotal.textContent=this.formatNumber(t),this.lbRecordCount.textContent=this.formatNumber(s);else{const i=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=i,this.lbRecordCount.innerHTML=i}}setTotalLabelsToZero(){this.lbFirstRowOnPage.textContent=this.formatNumber(0),this.lbCurrent.textContent=this.formatNumber(0),this.lbLastRowOnPage.textContent=this.formatNumber(0),this.lbTotal.textContent=this.formatNumber(0),this.lbRecordCount.textContent=this.formatNumber(0)}};f([A("paginationProxy")],er.prototype,"paginationProxy",2);f([A("rowNodeBlockLoader")],er.prototype,"rowNodeBlockLoader",2);f([Fe("btFirst")],er.prototype,"btFirst",2);f([Fe("btPrevious")],er.prototype,"btPrevious",2);f([Fe("btNext")],er.prototype,"btNext",2);f([Fe("btLast")],er.prototype,"btLast",2);f([Fe("lbRecordCount")],er.prototype,"lbRecordCount",2);f([Fe("lbFirstRowOnPage")],er.prototype,"lbFirstRowOnPage",2);f([Fe("lbLastRowOnPage")],er.prototype,"lbLastRowOnPage",2);f([Fe("lbCurrent")],er.prototype,"lbCurrent",2);f([Fe("lbTotal")],er.prototype,"lbTotal",2);f([Fe("pageSizeComp")],er.prototype,"pageSizeComp",2);f([xe],er.prototype,"postConstruct",1);var Ap=class _N extends at{constructor(){super(_N.TEMPLATE),this.inProgress=!1,this.destroyRequested=!1}updateLayoutClasses(t,s){const i=this.eOverlayWrapper.classList;i.toggle("ag-layout-auto-height",s.autoHeight),i.toggle("ag-layout-normal",s.normal),i.toggle("ag-layout-print",s.print)}postConstruct(){this.createManagedBean(new ev(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.registerOverlayWrapperComp(this)}setWrapperTypeClass(t){const s=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&s.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=t,s.toggle(t,!0)}showOverlay(t,s,i){this.inProgress||(this.setWrapperTypeClass(s),this.destroyActiveOverlay(),this.inProgress=!0,t&&t.then(r=>{this.inProgress=!1,this.eOverlayWrapper.appendChild(r.getGui()),this.activeOverlay=r,this.updateListenerDestroyFunc=i,this.destroyRequested&&(this.destroyRequested=!1,this.destroyActiveOverlay())}),this.setDisplayed(!0,{skipAriaHidden:!0}))}destroyActiveOverlay(){var t;if(this.inProgress){this.destroyRequested=!0;return}this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),(t=this.updateListenerDestroyFunc)==null||t.call(this),xs(this.eOverlayWrapper))}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}};Ap.TEMPLATE=`
        <div class="ag-overlay" role="presentation">
            <div class="ag-overlay-panel" role="presentation">
                <div class="ag-overlay-wrapper" ref="eOverlayWrapper" role="presentation"></div>
            </div>
        </div>`;f([A("overlayService")],Ap.prototype,"overlayService",2);f([Fe("eOverlayWrapper")],Ap.prototype,"eOverlayWrapper",2);f([xe],Ap.prototype,"postConstruct",1);var r2=Ap,uu=class extends Se{getFirstRow(){let e=0,t;return this.pinnedRowModel.getPinnedTopRowCount()?t="top":this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(t="bottom"),t===void 0?null:{rowIndex:e,rowPinned:t}}getLastRow(){let e,t=null;const s=this.pinnedRowModel.getPinnedBottomRowCount(),i=this.pinnedRowModel.getPinnedTopRowCount();return s?(t="bottom",e=s-1):this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageLastRow()):i&&(t="top",e=i-1),e===void 0?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}before(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(ve(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}};f([A("rowModel")],uu.prototype,"rowModel",2);f([A("pinnedRowModel")],uu.prototype,"pinnedRowModel",2);f([A("paginationProxy")],uu.prototype,"paginationProxy",2);uu=f([Le("rowPositionUtils")],uu);var hw=class extends Se{createId(e){const{rowIndex:t,rowPinned:s,column:i}=e;return this.createIdFromValues({rowIndex:t,column:i,rowPinned:s})}createIdFromValues(e){const{rowIndex:t,rowPinned:s,column:i}=e;return`${t}.${s??"null"}.${i.getId()}`}equals(e,t){const s=e.column===t.column,i=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return s&&i&&r}};hw=f([Le("cellPositionUtils")],hw);var Cd=class{constructor(e){this.cellValueChanges=e}},wC=class extends Cd{constructor(e,t,s,i){super(e),this.initialRange=t,this.finalRange=s,this.ranges=i}},kN=class MN{constructor(t){this.actionStack=[],this.maxStackSize=t||MN.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(t){t.cellValueChanges&&t.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(t))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};kN.DEFAULT_STACK_SIZE=10;var IE=kN,Bn=class extends Se{constructor(){super(...arguments),this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},s=this.activeCellEdit!==null&&this.cellPositionUtils.equals(this.activeCellEdit,t),i=this.activeRowEdit!==null&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(s||i||this.isPasting||this.isRangeInAction))return;const{rowPinned:n,rowIndex:o,column:a,oldValue:l,value:u}=e,h={rowPinned:n,rowIndex:o,columnId:a.getColId(),newValue:u,oldValue:l};this.cellValueChanges.push(h)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}init(){if(!this.gos.get("undoRedoCellEditing"))return;const e=this.gos.get("undoRedoCellEditingLimit");e<=0||(this.undoStack=new IE(e),this.redoStack=new IE(e),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,w.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,w.EVENT_MODEL_UPDATED,t=>{t.keepUndoRedoStack||this.clearStacks()}),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(t=>{this.gridBodyCtrl=t.gridBodyCtrl}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){const t={type:w.EVENT_UNDO_STARTED,source:e};this.eventService.dispatchEvent(t);const s=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),i={type:w.EVENT_UNDO_ENDED,source:e,operationPerformed:s};this.eventService.dispatchEvent(i)}redo(e){const t={type:w.EVENT_REDO_STARTED,source:e};this.eventService.dispatchEvent(t);const s=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),i={type:w.EVENT_REDO_ENDED,source:e,operationPerformed:s};this.eventService.dispatchEvent(i)}undoRedo(e,t,s,i,r){if(!e)return!1;const n=e.pop();return!n||!n.cellValueChanges?!1:(this.processAction(n,o=>o[i],r),n instanceof wC?this.processRange(this.rangeService,n.ranges||[n[s]]):this.processCell(n.cellValueChanges),t.push(n),!0)}processAction(e,t,s){e.cellValueChanges.forEach(i=>{const{rowIndex:r,rowPinned:n,columnId:o}=i,a={rowIndex:r,rowPinned:n},l=this.rowPositionUtils.getRowNode(a);l.displayed&&l.setDataValue(o,t(i),s)})}processRange(e,t){let s;e.removeAllCellRanges(!0),t.forEach((i,r)=>{if(!i)return;const n=i.startRow,o=i.endRow;r===t.length-1&&(s={rowPinned:n.rowPinned,rowIndex:n.rowIndex,columnId:i.startColumn.getColId()},this.setLastFocusedCell(s));const a={rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:i.startColumn,columns:i.columns};e.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:s,rowPinned:i}=t,r={rowIndex:s,rowPinned:i},n=this.rowPositionUtils.getRowNode(r),o={rowPinned:t.rowPinned,rowIndex:n.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o,this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:s,columnId:i,rowPinned:r}=e,n=this.gridBodyCtrl.getScrollFeature(),o=this.columnModel.getGridColumn(i);if(!o)return;n.ensureIndexVisible(s),n.ensureColumnVisible(o);const a={rowIndex:s,column:o,rowPinned:r};this.focusService.setFocusedCell(rs(Xe({},a),{forceBrowserFocus:!0})),t==null||t.setRangeToCell(a)}addRowEditingListeners(){this.addManagedListener(this.eventService,w.EVENT_ROW_EDITING_STARTED,e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,w.EVENT_ROW_EDITING_STOPPED,()=>{const e=new Cd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null})}addCellEditingListeners(){this.addManagedListener(this.eventService,w.EVENT_CELL_EDITING_STARTED,e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,w.EVENT_CELL_EDITING_STOPPED,e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const s=new Cd(this.cellValueChanges);this.pushActionsToUndoStack(s)}})}addPasteListeners(){this.addManagedListener(this.eventService,w.EVENT_PASTE_START,()=>{this.isPasting=!0}),this.addManagedListener(this.eventService,w.EVENT_PASTE_END,()=>{const e=new Cd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1})}addFillListeners(){this.addManagedListener(this.eventService,w.EVENT_FILL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,w.EVENT_FILL_END,e=>{const t=new wC(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1})}addCellKeyListeners(){this.addManagedListener(this.eventService,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,()=>{let e;this.rangeService&&this.gos.get("enableRangeSelection")?e=new wC(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):e=new Cd(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}};f([A("focusService")],Bn.prototype,"focusService",2);f([A("ctrlsService")],Bn.prototype,"ctrlsService",2);f([A("cellPositionUtils")],Bn.prototype,"cellPositionUtils",2);f([A("rowPositionUtils")],Bn.prototype,"rowPositionUtils",2);f([A("columnModel")],Bn.prototype,"columnModel",2);f([zt("rangeService")],Bn.prototype,"rangeService",2);f([xe],Bn.prototype,"init",1);Bn=f([Le("undoRedoService")],Bn);var Th=class extends Se{findHeader(e,t){let s,i;if(e.column instanceof Ls?s=this.columnModel.getDisplayedGroupAtDirection(e.column,t):(i=`getDisplayedCol${t}`,s=this.columnModel[i](e.column)),!s)return;let{headerRowIndex:r}=e;if(this.getHeaderRowType(r)!=="filter"){const a=[s];for(;s.getParent();)s=s.getParent(),a.push(s);s=a[a.length-1-r]}const{column:n,headerRowIndex:o}=this.getHeaderIndexToFocus(s,r);return{column:n,headerRowIndex:o}}getHeaderIndexToFocus(e,t){let s;if(e instanceof Ls&&this.isAnyChildSpanningHeaderHeight(e)&&e.isPadding()){const i=e;s=i.getLeafColumns()[0];let r=s;for(;r!==i;)t++,r=r.getParent()}return{column:s||e,headerRowIndex:t}}isAnyChildSpanningHeaderHeight(e){return e?e.getLeafColumns().some(t=>t.isSpanHeaderHeight()):!1}getColumnVisibleParent(e,t){const s=this.getHeaderRowType(t),i=s==="filter",r=s==="column";let n=i?e:e.getParent(),o=t-1,a=o;if(r&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;n&&n.isPadding();)n=n.getParent(),o--;a=o,o<0&&(n=e,o=t,a=void 0)}return{column:n,headerRowIndex:o,headerRowIndexWithoutSpan:a}}getColumnVisibleChild(e,t,s="After"){const i=this.getHeaderRowType(t);let r=e,n=t+1,o=n;if(i==="group"){const a=e.getDisplayedLeafColumns(),l=s==="After"?a[0]:Mt(a),u=[];let h=l;for(;h.getParent()!==e;)h=h.getParent(),u.push(h);if(r=l,l.isSpanHeaderHeight())for(let p=u.length-1;p>=0;p--){const g=u[p];if(!g.isPadding()){r=g;break}n++}else r=Mt(u),r||(r=l)}return{column:r,headerRowIndex:n,headerRowIndexWithoutSpan:o}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const s=this.columnModel.getAllDisplayedColumns(),i=s[t==="start"?0:s.length-1];if(!i)return;const n=this.ctrlsService.getHeaderRowContainerCtrl(i.getPinned()).getRowType(e);if(n=="group"){const o=this.columnModel.getColumnGroupAtLevel(i,e);return{headerRowIndex:e,column:o}}return{headerRowIndex:n==null?-1:e,column:i}}};f([A("columnModel")],Th.prototype,"columnModel",2);f([A("ctrlsService")],Th.prototype,"ctrlsService",2);Th=f([Le("headerPositionUtils")],Th);var pw=class{buildColumnDefs(e,t,s){const i=[],r={};return e.forEach(n=>{const o=this.createDefFromColumn(n,t,s);let a=!0,l=o,u=n.getOriginalParent(),h=null;for(;u;){let p=null;if(u.isPadding()){u=u.getOriginalParent();continue}const g=r[u.getGroupId()];if(g){g.children.push(l),a=!1;break}if(p=this.createDefFromGroup(u),p&&(p.children=[l],r[p.groupId]=p,l=p,u=u.getOriginalParent()),u!=null&&h===u){a=!1;break}h=u}a&&i.push(l)}),i}createDefFromGroup(e){const t=Sf(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,s){const i=Sf(e.getColDef());return i.colId=e.getColId(),i.width=e.getActualWidth(),i.rowGroup=e.isRowGroupActive(),i.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,i.pivot=e.isPivotActive(),i.pivotIndex=e.isPivotActive()?s.indexOf(e):null,i.aggFunc=e.isValueActive()?e.getAggFunc():null,i.hide=e.isVisible()?void 0:!0,i.pinned=e.isPinned()?e.getPinned():null,i.sort=e.getSort()?e.getSort():null,i.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,i}};pw=f([Le("columnDefFactory")],pw);var Dh=class{getInitialRowClasses(e){const t=[];return ve(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),Yy(t,this.processClassesFromGridOptions(e.rowNode)),Yy(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&(e.pinned==="left"&&t.push("ag-cell-last-left-pinned"),e.pinned==="right"&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],s=n=>{typeof n=="string"?t.push(n):Array.isArray(n)&&n.forEach(o=>t.push(o))},i=this.gos.get("rowClass");if(i){if(typeof i=="function")return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];s(i)}const r=this.gos.getCallback("getRowClass");if(r){const n={data:e.data,node:e,rowIndex:e.rowIndex},o=r(n);s(o)}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,s=>{t.push(s)},s=>{}),t}processRowClassRules(e,t,s){const i=this.gos.addGridCommonParams({data:e.data,node:e,rowIndex:e.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),i,t,s)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}};f([A("stylingService")],Dh.prototype,"stylingService",2);f([A("gridOptionsService")],Dh.prototype,"gos",2);Dh=f([Le("rowCssClassCalculator")],Dh);var du=class extends Se{init(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup())}doFullSort(e,t){const s=(r,n)=>({currentPos:n,rowNode:r}),i=e.map(s);return i.sort(this.compareRowNodes.bind(this,t)),i.map(r=>r.rowNode)}compareRowNodes(e,t,s){const i=t.rowNode,r=s.rowNode;for(let n=0,o=e.length;n<o;n++){const a=e[n],l=a.sort==="desc",u=this.getValue(i,a.column),h=this.getValue(r,a.column);let p;const g=this.getComparator(a,i);if(g?p=g(u,h,i,r,l):p=nt.defaultComparator(u,h,this.isAccentedSort),!isNaN(p)&&p!==0)return a.sort==="asc"?p:p*-1}return t.currentPos-s.currentPos}getComparator(e,t){const s=e.column,i=s.getColDef().comparator;if(i!=null)return i;if(!s.getColDef().showRowGroup)return;const r=!t.group&&s.getColDef().field;if(!r)return;const n=this.columnModel.getPrimaryColumn(r);if(n)return n.getColDef().comparator}getValue(e,t){var s,i;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(this.gos.isGroupUseEntireRow(this.columnModel.isPivotActive())){const a=(s=e.allLeafChildren)==null?void 0:s[0];return a?this.valueService.getValue(t,a,!1,!1):void 0}const o=this.columnModel.getGroupDisplayColumnForGroup(t.getId());return o?(i=e.groupData)==null?void 0:i[o.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return this.valueService.getValue(t,e,!1,!1)}};f([A("valueService")],du.prototype,"valueService",2);f([A("columnModel")],du.prototype,"columnModel",2);f([xe],du.prototype,"init",1);du=f([Le("rowNodeSorter")],du);var yl=class extends Se{constructor(){super(...arguments),this.params={},this.ready=!1,this.readyCallbacks=[]}checkReady(){const e=this.params;this.ready=e.gridCtrl!=null&&e.gridBodyCtrl!=null&&e.center!=null&&e.left!=null&&e.right!=null&&e.bottomCenter!=null&&e.bottomLeft!=null&&e.bottomRight!=null&&e.topCenter!=null&&e.topLeft!=null&&e.topRight!=null&&e.stickyTopCenter!=null&&e.stickyTopLeft!=null&&e.stickyTopRight!=null&&e.stickyBottomCenter!=null&&e.stickyBottomLeft!=null&&e.stickyBottomRight!=null&&e.centerHeader!=null&&e.leftHeader!=null&&e.rightHeader!=null&&e.fakeHScrollComp!=null&&e.fakeVScrollComp!=null&&e.gridHeaderCtrl!=null,this.ready&&(this.readyCallbacks.forEach(t=>t(e)),this.readyCallbacks.length=0)}whenReady(e){this.ready?e(this.params):this.readyCallbacks.push(e)}register(e,t){this.params[e]=t,this.checkReady()}registerHeaderContainer(e,t){switch(t){case"left":this.params.leftHeader=e;break;case"right":this.params.rightHeader=e;break;default:this.params.centerHeader=e;break}this.checkReady()}get(e){return this.params[e]}getParams(){return this.params}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){return[this.params.leftHeader,this.params.rightHeader,this.params.centerHeader]}getHeaderRowContainerCtrl(e){switch(e){case"left":return this.params.leftHeader;case"right":return this.params.rightHeader;default:return this.params.centerHeader}}};yl.NAME="ctrlsService";yl=f([Le(yl.NAME)],yl);var gw=class extends Se{constructor(){super(...arguments),this.registry={}}register(e){this.registry[e.controllerName]=e.controllerClass}getInstance(e){const t=this.registry[e];if(t!=null)return new t}};gw=f([Le("ctrlsFactory")],gw);var Zl=class extends at{constructor(e,t){super(e),this.direction=t,this.hideTimeout=null}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",l0()||yo())}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=u0(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=["mouseenter","mousedown","touchstart"],t=["mouseleave","touchend"],s=this.getGui();e.forEach(i=>this.addManagedListener(s,i,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0))),t.forEach(i=>this.addManagedListener(s,i,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1)))}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,e=>{e.direction===this.direction&&(this.hideTimeout!==null&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL_END,()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)})}attemptSettingScrollPosition(e){const t=this.getViewport();qS(()=>Zi(t),()=>this.setScrollPosition(e),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedListener(this.getViewport(),"scroll",e)}};f([Fe("eViewport")],Zl.prototype,"eViewport",2);f([Fe("eContainer")],Zl.prototype,"eContainer",2);f([A("scrollVisibleService")],Zl.prototype,"scrollVisibleService",2);f([A("ctrlsService")],Zl.prototype,"ctrlsService",2);f([A("animationFrameService")],Zl.prototype,"animationFrameService",2);var Jl=class LN extends Zl{constructor(){super(LN.TEMPLATE,"horizontal")}postConstruct(){super.postConstruct();const t=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,w.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",t),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new Eu(s=>this.eContainer.style.width=`${s}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const t=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${t}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const t=this.scrollVisibleService.isVerticalScrollShowing();let s=this.columnModel.getDisplayedColumnsRightWidth();const i=!this.enableRtl&&t,r=this.gos.getScrollbarWidth();i&&(s+=r),kr(this.eRightSpacer,s),this.eRightSpacer.classList.toggle("ag-scroller-corner",s<=r);let n=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&t&&(n+=r),kr(this.eLeftSpacer,n),this.eLeftSpacer.classList.toggle("ag-scroller-corner",n<=r)}setScrollVisible(){const t=this.scrollVisibleService.isHorizontalScrollShowing(),s=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),r=t&&this.gos.getScrollbarWidth()||0,o=i?0:r===0&&s?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",s),fl(this.getGui(),o),fl(this.eViewport,o),fl(this.eContainer,o),this.setDisplayed(t,{skipAriaHidden:!0})}getScrollPosition(){return fh(this.getViewport(),this.enableRtl)}setScrollPosition(t){Zi(this.getViewport())||this.attemptSettingScrollPosition(t),mh(this.getViewport(),t,this.enableRtl)}};Jl.TEMPLATE=`<div class="ag-body-horizontal-scroll" aria-hidden="true">
            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>
            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">
                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>
            </div>
            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>
        </div>`;f([Fe("eLeftSpacer")],Jl.prototype,"eLeftSpacer",2);f([Fe("eRightSpacer")],Jl.prototype,"eRightSpacer",2);f([A("columnModel")],Jl.prototype,"columnModel",2);f([A("pinnedRowModel")],Jl.prototype,"pinnedRowModel",2);f([xe],Jl.prototype,"postConstruct",1);var n2=Jl,Ph=class extends Se{postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=this.gos.isDomLayout("print"),t=e?0:this.columnModel.getDisplayedColumnsLeftWidth(),s=e?0:this.columnModel.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:w.EVENT_LEFT_PINNED_WIDTH_CHANGED})),s!=this.rightWidth&&(this.rightWidth=s,this.eventService.dispatchEvent({type:w.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}};f([A("columnModel")],Ph.prototype,"columnModel",2);f([xe],Ph.prototype,"postConstruct",1);Ph=f([Le("pinnedWidthService")],Ph);var hu=class extends Se{constructor(){super(...arguments),this.events=[]}postConstruct(){this.rowModel.getType()=="clientSide"&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e,t){if(this.clientSideRowModel==null){this.eventService.dispatchEvent(e);return}this.events.push(e);const s=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(i=>this.eventService.dispatchEvent(i)),this.events=[]};t?s():(this.dispatchExpandedDebounced==null&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(s)),this.dispatchExpandedDebounced())}};f([A("animationFrameService")],hu.prototype,"animationFrameService",2);f([A("rowModel")],hu.prototype,"rowModel",2);f([xe],hu.prototype,"postConstruct",1);hu=f([Le("rowNodeEventThrottle")],hu);var o2={columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},dndSource:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."},dndSourceOnRowDrag:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."}},Fo=(e,t)=>{var s;return((s=t.rowModelType)!=null?s:"clientSide")==="clientSide"?{module:"@ag-grid-enterprise/row-grouping"}:null},a2={enableRowGroup:Fo,rowGroup:Fo,rowGroupIndex:Fo,enablePivot:Fo,enableValue:Fo,pivot:Fo,pivotIndex:Fo,aggFunc:Fo,cellEditor:e=>e.cellEditor==="agRichSelect"||e.cellEditor==="agRichSelectCellEditor"?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:e=>{var t;const s=["columnsMenuTab","generalMenuTab"];return(t=e.menuTabs)!=null&&t.some(i=>s.includes(i))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},children:()=>bc},l2={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0},c2=Object.keys(l2),bc={objectName:"colDef",allProperties:c2,docsUrl:"column-properties/",deprecations:o2,validations:a2},u2={enableChartToolPanelsButton:{version:"29"},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",renamed:"enterNavigatesVertically"},enterMovesDownAfterEdit:{version:"30",renamed:"enterNavigatesVerticallyAfterEdit"},suppressParentsInRowNodes:{version:"30.2",message:"Using suppressParentsInRowNodes is no longer recommended. To serialize nodes it is now recommended to instead remove the parent node reference before serialization."},advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."}},d2={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!1,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,suppressChartToolPanelsButton:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,functionsPassive:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1},h2={sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",dependencies:e=>{var t;const s=(t=e.rowModelType)!=null?t:"clientSide";switch(s){case"clientSide":const i=`treeData requires 'getDataPath' in the ${s} row model.`;return e.getDataPath?null:i;case"serverSide":const r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${s} row model.`;return e.isServerSideGroup&&e.getServerSideGroupKey?null:r}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],dependencies:e=>{var t;switch((t=e.rowModelType)!=null?t:"clientSide"){case"clientSide":return null;case"serverSide":return e.suppressServerSideInfiniteScroll?"groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll":null}return null}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},suppressParentsInRowNodes:{dependencies:{groupSelectsChildren:[void 0,!1]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},columnDefs:()=>bc,defaultColDef:()=>bc,defaultColGroupDef:()=>bc,autoGroupColumnDef:()=>bc},p2={objectName:"gridOptions",allProperties:[...hh.ALL_PROPERTIES,...Rf.EVENT_CALLBACKS],propertyExceptions:["api","columnApi"],docsUrl:"grid-options/",deprecations:u2,validations:h2},Bt=class{constructor(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new pn,this.globalEventHandlerFactory=e=>(t,s)=>{if(this.destroyed)return;const i=Dg.has(t);if(i&&!e||!i&&e)return;const r=Rf.getCallbackForEvent(t),n=this.gridOptions[r];typeof n=="function"&&this.frameworkOverrides.wrapOutgoing(()=>{n(s)})}}get context(){return this.gridOptions.context}init(){this.columnApi=new nu(this.api);const e=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),e),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.getScrollbarWidth()}destroy(){this.destroyed=!0,this.columnApi=void 0}get(e){var t;return(t=this.gridOptions[e])!=null?t:d2[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return ve(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(s=>{const i=s;return i.api=this.api,i.columnApi=this.columnApi,i.context=this.context,e(i)})}static toBoolean(e){return typeof e=="boolean"?e:typeof e=="string"?e.toUpperCase()==="TRUE"||e=="":!1}static toNumber(e){if(typeof e=="number")return e;if(typeof e=="string"){const t=parseInt(e);return isNaN(t)?void 0:t}}static toConstrainedNum(e,t){return s=>{const i=Bt.toNumber(s);if(!(i==null||i<e||i>t))return i}}static getCoercedValue(e,t){const s=Bt.PROPERTY_COERCIONS.get(e);return s?s(t):t}static getCoercedGridOptions(e){const t={};return Object.entries(e).forEach(([s,i])=>{const r=Bt.getCoercedValue(s,i);t[s]=r}),t}updateGridOptions({options:e,force:t,source:s="api"}){const i={id:Bt.changeSetId++,properties:[]},r=[];Object.entries(e).forEach(([n,o])=>{s==="api"&&H1[n]&&tt(`${n} is an initial property and cannot be updated.`);const a=Bt.getCoercedValue(n,o),l=t||typeof a=="object"&&s==="api",u=this.gridOptions[n];if(l||u!==a){this.gridOptions[n]=a;const h={type:n,currentValue:a,previousValue:u,changeSet:i,source:s};r.push(h)}}),this.validationService.processGridOptions(this.gridOptions),i.properties=r.map(n=>n.type),r.forEach(n=>{this.gridOptions.debug&&console.log(`AG Grid: Updated property ${n.type} from `,n.previousValue," to  ",n.currentValue),this.propertyEventService.dispatchEvent(n)})}addEventListener(e,t){this.propertyEventService.addEventListener(e,t)}removeEventListener(e,t){this.propertyEventService.removeEventListener(e,t)}getScrollbarWidth(){if(this.scrollbarWidth==null){const t=typeof this.gridOptions.scrollbarWidth=="number"&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:JA();t!=null&&(this.scrollbarWidth=t,this.eventService.dispatchEvent({type:w.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}isRowModelType(e){return this.gridOptions.rowModelType===e||e==="clientSide"&&ot(this.gridOptions.rowModelType)}isDomLayout(e){var t;return((t=this.gridOptions.domLayout)!=null?t:"normal")===e}isRowSelection(){return this.gridOptions.rowSelection==="single"||this.gridOptions.rowSelection==="multiple"}useAsyncEvents(){return!this.get("suppressAsyncEvents")}isGetRowHeightFunction(){return typeof this.gridOptions.getRowHeight=="function"}getRowHeightForNode(e,t=!1,s){if(s==null&&(s=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(t)return{height:s,estimated:!0};const r={node:e,data:e.data},n=this.getCallback("getRowHeight")(r);if(this.isNumeric(n))return n===0&&tt("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,n),estimated:!1}}return e.detail&&this.get("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:s,estimated:!1}}getMasterDetailRowHeight(){return this.get("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||ot(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const e=this.environment.refreshRowHeightVariable();return e!==-1?e:(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}getDomDataKey(){return this.domDataKey}getDomData(e,t){const s=e[this.getDomDataKey()];return s?s[t]:void 0}setDomData(e,t,s){const i=this.getDomDataKey();let r=e[i];ot(r)&&(r={},e[i]=r),r[t]=s}getDocument(){let e=null;return this.gridOptions.getDocument&&ve(this.gridOptions.getDocument)?e=this.gridOptions.getDocument():this.eGridDiv&&(e=this.eGridDiv.ownerDocument),e&&ve(e)?e:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getActiveDomElement(){return this.getRootNode().activeElement}getAsyncTransactionWaitMillis(){return ve(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return this.get("ensureDomOrder")?!1:this.get("animateRows")}isGroupRowsSticky(){return!(this.get("paginateChildRows")||this.get("groupHideOpenParents")||this.isDomLayout("print"))}isColumnsSortingCoupledToGroup(){const e=this.gridOptions.autoGroupColumnDef;return!(e!=null&&e.comparator)&&!this.get("treeData")}getGroupAggFiltering(){const e=this.gridOptions.groupAggFiltering;if(typeof e=="function")return this.getCallback("groupAggFiltering");if(e===!0)return()=>!0}getGrandTotalRow(){const e=this.gridOptions.grandTotalRow;if(e)return e;if(this.gridOptions.groupIncludeTotalFooter)return"bottom"}getGroupTotalRowCallback(){const e=this.get("groupTotalRow");if(typeof e=="function")return this.getCallback("groupTotalRow");if(e)return()=>e;const t=this.get("groupIncludeFooter");if(typeof t=="function"){const s=this.getCallback("groupIncludeFooter");return i=>s(i)?"bottom":void 0}return()=>t?"bottom":void 0}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?this.gridOptions.groupDisplayType==="multipleColumns":this.get("groupHideOpenParents")}isGroupUseEntireRow(e){return e?!1:this.gridOptions.groupDisplayType==="groupRows"}getGridCommonParams(){return{api:this.api,columnApi:this.columnApi,context:this.context}}addGridCommonParams(e){const t=e;return t.api=this.api,t.columnApi=this.columnApi,t.context=this.context,t}};Bt.PROPERTY_COERCIONS=new Map([...hh.BOOLEAN_PROPERTIES.map(e=>[e,Bt.toBoolean]),...hh.NUMBER_PROPERTIES.map(e=>[e,Bt.toNumber]),["groupAggFiltering",e=>typeof e=="function"?e:Bt.toBoolean(e)],["pageSize",Bt.toConstrainedNum(1,Number.MAX_VALUE)],["autoSizePadding",Bt.toConstrainedNum(0,Number.MAX_VALUE)],["keepDetailRowsCount",Bt.toConstrainedNum(1,Number.MAX_VALUE)],["rowBuffer",Bt.toConstrainedNum(0,Number.MAX_VALUE)],["infiniteInitialRowCount",Bt.toConstrainedNum(1,Number.MAX_VALUE)],["cacheOverflowSize",Bt.toConstrainedNum(1,Number.MAX_VALUE)],["cacheBlockSize",Bt.toConstrainedNum(1,Number.MAX_VALUE)],["serverSideInitialRowCount",Bt.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelPageSize",Bt.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelBufferSize",Bt.toConstrainedNum(0,Number.MAX_VALUE)]]);Bt.changeSetId=0;f([A("gridOptions")],Bt.prototype,"gridOptions",2);f([A("eventService")],Bt.prototype,"eventService",2);f([A("environment")],Bt.prototype,"environment",2);f([A("frameworkOverrides")],Bt.prototype,"frameworkOverrides",2);f([A("eGridDiv")],Bt.prototype,"eGridDiv",2);f([A("validationService")],Bt.prototype,"validationService",2);f([A("gridApi")],Bt.prototype,"api",2);f([xe],Bt.prototype,"init",1);f([Fi],Bt.prototype,"destroy",1);Bt=f([Le("gridOptionsService")],Bt);var fw=class extends Se{getLocaleTextFunc(){const e=this.gos.getCallback("getLocaleText");if(e)return(s,i,r)=>e({key:s,defaultValue:i,variableValues:r});const t=this.gos.get("localeText");return(s,i,r)=>{let n=t&&t[s];if(n&&r&&r.length){let o=0;for(;!(o>=r.length||n.indexOf("${variable}")===-1);)n=n.replace("${variable}",r[o++])}return n??i}}};fw=f([Le("localeService")],fw);var $0=class ON extends Zl{constructor(){super(ON.TEMPLATE,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new sv(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedListener(this.eventService,w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}setScrollVisible(){const t=this.scrollVisibleService.isVerticalScrollShowing(),s=this.invisibleScrollbar,i=t&&this.gos.getScrollbarWidth()||0,r=i===0&&s?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",s),kr(this.getGui(),r),kr(this.eViewport,r),kr(this.eContainer,r),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:t}=this,i=t.getGridBodyCtrl().getBodyViewportElement(),r=this.getScrollPosition(),n=i.scrollTop;r!=n&&this.setScrollPosition(n,!0)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(t,s){!s&&!Zi(this.getViewport())&&this.attemptSettingScrollPosition(t),this.getViewport().scrollTop=t}};$0.TEMPLATE=`<div class="ag-body-vertical-scroll" aria-hidden="true">
            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">
                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>
            </div>
        </div>`;f([xe],$0.prototype,"postConstruct",1);var g2=$0,_E={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},kE=["january","february","march","april","may","june","july","august","september","october","november","december"],_l=class extends Se{constructor(){super(...arguments),this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}init(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(xc(e.source))})}processDataTypeDefinitions(){var e;const t=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(t).forEach(([i,r])=>{this.dataTypeDefinitions[i]=rs(Xe({},r),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)})});const s=(e=this.gos.get("dataTypeDefinitions"))!=null?e:{};this.dataTypeMatchers={},Object.entries(s).forEach(([i,r])=>{const n=this.processDataTypeDefinition(r,s,[i],t);n&&(this.dataTypeDefinitions[i]=n,r.dataTypeMatcher&&(this.dataTypeMatchers[i]=r.dataTypeMatcher))}),this.checkObjectValueHandlers(t),["dateString","text","number","boolean","date"].forEach(i=>{const r=this.dataTypeMatchers[i];r&&delete this.dataTypeMatchers[i],this.dataTypeMatchers[i]=r??t[i].dataTypeMatcher})}mergeDataTypeDefinitions(e,t){const s=Xe(Xe({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(s.columnTypes=[...this.convertColumnTypes(e.columnTypes),...this.convertColumnTypes(t.columnTypes)]),s}processDataTypeDefinition(e,t,s,i){let r;const n=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=i[n];const a=t[n];if(o&&a&&(o=a),!this.validateDataTypeDefinition(e,o,n))return;r=this.mergeDataTypeDefinitions(o,e)}else{if(s.includes(n)){tt('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');return}const o=t[n];if(!this.validateDataTypeDefinition(e,o,n))return;const a=this.processDataTypeDefinition(o,t,[...s,n],i);if(!a)return;r=this.mergeDataTypeDefinitions(a,e)}return rs(Xe({},r),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)})}validateDataTypeDefinition(e,t,s){return t?t.baseDataType!==e.baseDataType?(tt('The "baseDataType" property of a data type definition must match that of its parent.'),!1):!0:(tt(`The data type definition ${s} does not exist.`),!1)}createGroupSafeValueFormatter(e){if(e.valueFormatter)return t=>{var s,i;if((s=t.node)!=null&&s.group){const r=t.column.getAggFunc();if(r){if(r==="first"||r==="last")return e.valueFormatter(t);if(e.baseDataType==="number"&&r!=="count"){if(typeof t.value=="number")return e.valueFormatter(t);if(typeof t.value=="object"){if(!t.value)return;if("toNumber"in t.value)return e.valueFormatter(rs(Xe({},t),{value:t.value.toNumber()}));if("value"in t.value)return e.valueFormatter(rs(Xe({},t),{value:t.value.value}))}}}if(!this.gos.get("suppressGroupMaintainValueType"))return}else if(this.groupHideOpenParents&&t.column.isRowGroupActive()){if(typeof t.value!="string"||(i=e.dataTypeMatcher)!=null&&i.call(e,t.value))return e.valueFormatter(t);if(!this.gos.get("suppressGroupMaintainValueType"))return}return e.valueFormatter(t)}}updateColDefAndGetDataTypeDefinitionColumnType(e,t,s){let{cellDataType:i}=t;const{field:r}=t;if(i===void 0&&(i=e.cellDataType),(i==null||i===!0)&&(i=this.canInferCellDataType(e,t)?this.inferCellDataType(r,s):!1),!i){e.cellDataType=!1;return}const n=this.dataTypeDefinitions[i];if(!n){tt(`Missing data type definition - "${i}"`);return}return e.cellDataType=i,n.groupSafeValueFormatter&&(e.valueFormatter=n.groupSafeValueFormatter),n.valueParser&&(e.valueParser=n.valueParser),n.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,s),n.columnTypes}updateColDefAndGetColumnType(e,t,s){var i,r;const n=this.updateColDefAndGetDataTypeDefinitionColumnType(e,t,s),o=(r=(i=t.type)!=null?i:n)!=null?r:e.type;return e.type=o,o?this.convertColumnTypes(o):void 0}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const s=i=>{t.add(i.key)};e.addEventListener(Kt.EVENT_STATE_UPDATED,s),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.removeEventListener(Kt.EVENT_STATE_UPDATED,s))}canInferCellDataType(e,t){var s;if(this.rowModel.getType()!=="clientSide")return!1;const i={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,i))return!1;const r=t.type===null?e.type:t.type;if(r){const n=(s=this.gos.get("columnTypes"))!=null?s:{};if(this.convertColumnTypes(r).some(a=>{const l=n[a.trim()];return l&&this.doColDefPropsPreventInference(l,i)}))return!1}return!this.doColDefPropsPreventInference(e,i)}doColDefPropsPreventInference(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([s,i])=>this.doesColDefPropPreventInference(e,t,s,i))}doesColDefPropPreventInference(e,t,s,i){if(!t[s])return!1;const r=e[s];return r===null?(t[s]=!1,!1):i===void 0?!!r:r===i}inferCellDataType(e,t){var s;if(!e)return;let i;const r=this.getInitialData();if(r){const o=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");i=Nc(r,e,o)}else this.initWaitForRowData(t);if(i==null)return;const[n]=(s=Object.entries(this.dataTypeMatchers).find(([o,a])=>a(i)))!=null?s:["object"];return n}getInitialData(){const e=this.gos.get("rowData");if(e!=null&&e.length)return e[0];if(this.initialData)return this.initialData;{const t=this.rowModel.getRootNode().allLeafChildren;if(t!=null&&t.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions;t&&this.columnModel.queueResizeOperations();const s=this.addManagedListener(this.eventService,w.EVENT_ROW_DATA_UPDATE_STARTED,i=>{const{firstRowData:r}=i;if(!r)return;s==null||s(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(r,t),this.columnStateUpdatesPendingInference={},t&&this.columnModel.processResizeOperations();const n={type:w.EVENT_DATA_TYPES_INFERRED};this.eventService.dispatchEvent(n)})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(e,t){this.initialData=e;const s=[];this.columnStateUpdateListenerDestroyFuncs.forEach(n=>n()),this.columnStateUpdateListenerDestroyFuncs=[];const i={},r={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([n,o])=>{const a=this.columnModel.getGridColumn(n);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColumnDefIntoColumn(a,"cellDataTypeInferred"))return;const u=a.getColDef();if(t&&u.type&&u.type!==l.type){const h=this.getUpdatedColumnState(a,o);h.rowGroup&&h.rowGroupIndex==null&&(i[n]=h),h.pivot&&h.pivotIndex==null&&(r[n]=h),s.push(h)}}),t&&s.push(...this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(i,r)),s.length&&this.columnModel.applyColumnState({state:s},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const s=this.columnModel.getColumnStateFromColDef(e);return t.forEach(i=>{delete s[i],i==="rowGroup"?delete s.rowGroupIndex:i==="pivot"&&delete s.pivotIndex}),s}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,s=e.object;this.hasObjectValueParser=t.valueParser!==s.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==s.valueFormatter}convertColumnTypes(e){let t=[];return e instanceof Array?e.some(i=>typeof i!="string")?console.warn("if colDef.type is supplied an array it should be of type 'string[]'"):t=e:typeof e=="string"?t=e.split(","):console.warn("colDef.type should be of type 'string' | 'string[]'"),t}getDateStringTypeDefinition(e){var t;return e?(t=this.getDataTypeDefinition(e))!=null?t:this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){var t;return(t=this.getDataTypeDefinition(e))==null?void 0:t.baseDataType}checkType(e,t){var s;if(t==null)return!0;const i=(s=this.getDataTypeDefinition(e))==null?void 0:s.dataTypeMatcher;return i?i(t):!0}validateColDef(e){e.cellDataType==="object"&&(e.valueFormatter===this.dataTypeDefinitions.object.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&tt('Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&tt('Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'))}setColDefPropertiesForBaseDataType(e,t,s){const i=(a,l,u)=>{let h=a.getColDef().valueFormatter;return h===t.groupSafeValueFormatter&&(h=t.valueFormatter),this.valueService.formatValue(a,l,u,h)},r=Vt.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()),n=this.localeService.getLocaleTextFunc(),o=a=>{const{filterParams:l}=e;e.filterParams=typeof l=="object"?Xe(Xe({},l),a):a};switch(t.baseDataType){case"number":{e.cellEditor="agNumberCellEditor",r&&o({comparator:(a,l)=>{const u=a==null?0:parseInt(a),h=l==null?0:parseInt(l);return u===h?0:u>h?1:-1}});break}case"boolean":{e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=a=>!!a.colDef.editable&&a.event.key===U.SPACE,o(r?{valueFormatter:a=>ve(a.value)?n(String(a.value),a.value?"True":"False"):n("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(a,l)=>l,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(a,l)=>l===!1,numberOfInputs:0}]});break}case"date":{e.cellEditor="agDateCellEditor",e.keyCreator=a=>i(a.column,a.node,a.value),r&&o({valueFormatter:a=>{const l=i(a.column,a.node,a.value);return ve(l)?l:n("blanks","(Blanks)")},treeList:!0,treeListFormatter:(a,l)=>{if(l===1&&a!=null){const u=kE[Number(a)-1];return n(u,_E[u])}return a??n("blanks","(Blanks)")}});break}case"dateString":{e.cellEditor="agDateStringCellEditor",e.keyCreator=l=>i(l.column,l.node,l.value);const a=t.dateParser;o(r?{valueFormatter:l=>{const u=i(l.column,l.node,l.value);return ve(u)?u:n("blanks","(Blanks)")},treeList:!0,treeListPathGetter:l=>{const u=a(l??void 0);return u?[String(u.getFullYear()),String(u.getMonth()+1),String(u.getDate())]:null},treeListFormatter:(l,u)=>{if(u===1&&l!=null){const h=kE[Number(l)-1];return n(h,_E[h])}return l??n("blanks","(Blanks)")}}:{comparator:(l,u)=>{const h=a(u);return u==null||h<l?-1:h>l?1:0}});break}case"object":{e.cellEditorParams={useFormatter:!0},e.comparator=(a,l)=>{const u=this.columnModel.getPrimaryColumn(s),h=u==null?void 0:u.getColDef();if(!u||!h)return 0;const p=a==null?"":i(u,null,a),g=l==null?"":i(u,null,l);return p===g?0:p>g?1:-1},e.keyCreator=a=>i(a.column,a.node,a.value),r?o({valueFormatter:a=>{const l=i(a.column,a.node,a.value);return ve(l)?l:n("blanks","(Blanks)")}}):e.filterValueGetter=a=>i(a.column,a.node,this.valueService.getValue(a.column,a.node));break}}}getDefaultDataTypes(){const e=s=>!!s.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:s=>{var i,r;return((r=(i=s.newValue)==null?void 0:i.trim)==null?void 0:r.call(i))===""?null:Number(s.newValue)},valueFormatter:s=>s.value==null?"":typeof s.value!="number"||isNaN(s.value)?t("invalidNumber","Invalid Number"):String(s.value),dataTypeMatcher:s=>typeof s=="number"},text:{baseDataType:"text",valueParser:s=>s.newValue===""?null:lh(s.newValue),dataTypeMatcher:s=>typeof s=="string"},boolean:{baseDataType:"boolean",valueParser:s=>{var i,r;return s.newValue==null?s.newValue:((r=(i=s.newValue)==null?void 0:i.trim)==null?void 0:r.call(i))===""?null:String(s.newValue).toLowerCase()==="true"},valueFormatter:s=>s.value==null?"":String(s.value),dataTypeMatcher:s=>typeof s=="boolean"},date:{baseDataType:"date",valueParser:s=>Ui(s.newValue==null?null:String(s.newValue)),valueFormatter:s=>{var i;return s.value==null?"":!(s.value instanceof Date)||isNaN(s.value.getTime())?t("invalidDate","Invalid Date"):(i=_r(s.value,!1))!=null?i:""},dataTypeMatcher:s=>s instanceof Date},dateString:{baseDataType:"dateString",dateParser:s=>{var i;return(i=Ui(s))!=null?i:void 0},dateFormatter:s=>{var i;return(i=_r(s??null,!1))!=null?i:void 0},valueParser:s=>e(String(s.newValue))?s.newValue:null,valueFormatter:s=>e(String(s.value))?s.value:"",dataTypeMatcher:s=>typeof s=="string"&&e(s)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:s=>{var i;return(i=lh(s.value))!=null?i:""}}}}};f([A("rowModel")],_l.prototype,"rowModel",2);f([A("columnModel")],_l.prototype,"columnModel",2);f([A("valueService")],_l.prototype,"valueService",2);f([xe],_l.prototype,"init",1);_l=f([Le("dataTypeService")],_l);var kl=class extends Se{constructor(){super(...arguments),this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.ctrlsService.whenReady(()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){this.columnModel.setColumnDefs(e??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.dispatchGridReadyEvent();const e=Vt.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId());new U0("AG Grid",()=>this.gos.get("debug")).log(`initialised successfully, enterprise = ${e}`)}dispatchGridReadyEvent(){const e={type:w.EVENT_GRID_READY};this.eventService.dispatchEvent(e)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.columnModel.setColumnDefs(t,xc(e.source))}}};f([A("ctrlsService")],kl.prototype,"ctrlsService",2);f([A("columnModel")],kl.prototype,"columnModel",2);f([A("rowModel")],kl.prototype,"rowModel",2);f([xe],kl.prototype,"postConstruct",1);kl=f([Le("syncService")],kl);var Ml=class extends Se{constructor(){super(...arguments),this.manuallyDisplayed=!1}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_ROW_DATA_UPDATED,()=>this.onRowDataUpdated()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}registerOverlayWrapperComp(e){this.overlayWrapperComp=e,(!this.gos.get("columnDefs")||this.gos.isRowModelType("clientSide")&&!this.gos.get("rowData"))&&this.showLoadingOverlay()}showLoadingOverlay(){if(this.gos.get("suppressLoadingOverlay"))return;const e={},t=this.userComponentFactory.getLoadingOverlayCompDetails(e);this.showOverlay(t,"ag-overlay-loading-wrapper","loadingOverlayComponentParams")}showNoRowsOverlay(){if(this.gos.get("suppressNoRowsOverlay"))return;const e={},t=this.userComponentFactory.getNoRowsOverlayCompDetails(e);this.showOverlay(t,"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams")}showOverlay(e,t,s){const i=e.newAgStackInstance(),r=this.addManagedPropertyListener(s,({currentValue:n})=>{i.then(o=>{o.refresh&&o.refresh(this.gos.addGridCommonParams(Xe({},n??{})))})});this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.overlayWrapperComp.showOverlay(i,t,r)}hideOverlay(){this.manuallyDisplayed=!1,this.overlayWrapperComp.hideOverlay()}showOrHideOverlay(){const e=this.paginationProxy.isEmpty(),t=this.gos.get("suppressNoRowsOverlay");e&&!t?this.showNoRowsOverlay():this.hideOverlay()}onRowDataUpdated(){this.showOrHideOverlay()}onNewColumnsLoaded(){this.columnModel.isReady()&&!this.paginationProxy.isEmpty()&&!this.manuallyDisplayed&&this.hideOverlay()}};f([A("userComponentFactory")],Ml.prototype,"userComponentFactory",2);f([A("paginationProxy")],Ml.prototype,"paginationProxy",2);f([A("columnModel")],Ml.prototype,"columnModel",2);f([xe],Ml.prototype,"postConstruct",1);Ml=f([Le("overlayService")],Ml);var Ei=class extends Se{constructor(){super(...arguments),this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=xi(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=xi(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=xi(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){var e;this.isClientSideRowModel=this.rowModel.getType()==="clientSide",this.cachedState=(e=this.gos.get("initialState"))!=null?e:{},this.ctrlsService.whenReady(()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const t=this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,({source:r})=>{r==="gridInitializing"&&(t==null||t(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))}),s=this.addManagedListener(this.eventService,w.EVENT_ROW_COUNT_READY,()=>{s==null||s(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())}),i=this.addManagedListener(this.eventService,w.EVENT_FIRST_DATA_RENDERED,()=>{i==null||i(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState()),this.addManagedListener(this.eventService,w.EVENT_TOOL_PANEL_VISIBLE_CHANGED,()=>this.updateCachedState("sideBar",this.getSideBarState())),this.addManagedListener(this.eventService,w.EVENT_SIDE_BAR_UPDATED,()=>this.updateCachedState("sideBar",this.getSideBarState()))}setupStateOnColumnsInitialised(){var e;const t=(e=this.gos.get("initialState"))!=null?e:{};this.setColumnState(t),this.setColumnGroupState(t),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,()=>this.updateColumnState(["aggregation"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,()=>this.updateColumnState(["columnOrder"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PINNED,()=>this.updateColumnState(["columnPinning"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_RESIZED,()=>this.updateColumnState(["columnSizing"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,()=>this.updateColumnState(["columnVisibility"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateColumnState(["rowGroup"])),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,()=>this.updateColumnState(["sort"])),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,()=>this.updateCachedState("columnGroup",this.getColumnGroupState()))}setupStateOnRowCountReady(){var e;const{filter:t,rowGroupExpansion:s,rowSelection:i,pagination:r}=(e=this.gos.get("initialState"))!=null?e:{},n=this.gos.get("advancedFilterModel");(t||n)&&this.setFilterState(t,n),s&&this.setRowGroupExpansionState(s),i&&this.setRowSelectionState(i),r&&this.setPaginationState(r),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState()),this.addManagedListener(this.eventService,w.EVENT_FILTER_CHANGED,()=>this.updateCachedState("filter",this.getFilterState())),this.addManagedListener(this.eventService,w.EVENT_ROW_GROUP_OPENED,()=>this.onRowGroupOpenedDebounced()),this.addManagedListener(this.eventService,w.EVENT_EXPAND_COLLAPSE_ALL,()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())),this.addManagedListener(this.eventService,w.EVENT_SELECTION_CHANGED,()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()}),this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,o=>{(o.newPage||o.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())})}setupStateOnFirstDataRendered(){var e;const{scroll:t,rangeSelection:s,focusedCell:i,columnOrder:r}=(e=this.gos.get("initialState"))!=null?e:{};i&&this.setFocusedCellState(i),s&&this.setRangeSelectionState(s),t&&this.setScrollState(t),this.setColumnPivotState(!!(r!=null&&r.orderedColIds)),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState()),this.updateCachedState("rangeSelection",this.getRangeSelectionState()),this.updateCachedState("scroll",this.getScrollState()),this.addManagedListener(this.eventService,w.EVENT_CELL_FOCUSED,()=>this.updateCachedState("focusedCell",this.getFocusedCellState())),this.addManagedListener(this.eventService,w.EVENT_RANGE_SELECTION_CHANGED,n=>{n.finished&&this.updateCachedState("rangeSelection",this.getRangeSelectionState())}),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL_END,()=>this.updateCachedState("scroll",this.getScrollState()))}getColumnState(){const e=this.columnModel.isPivotMode(),t=[],s=[],i=[],r=[],n=[],o=[],a=[],l=[],u=[],h=this.columnModel.getColumnState();for(let p=0;p<h.length;p++){const{colId:g,sort:m,sortIndex:C,rowGroup:y,rowGroupIndex:R,aggFunc:x,pivot:S,pivotIndex:T,pinned:I,hide:V,width:j,flex:P}=h[p];u.push(g),m&&(t[C??0]={colId:g,sort:m}),y&&(s[R??0]=g),typeof x=="string"&&i.push({colId:g,aggFunc:x}),S&&(r[T??0]=g),I&&(I==="right"?o:n).push(g),V&&a.push(g),(P||j)&&l.push({colId:g,flex:P??void 0,width:j})}return{sort:t.length?{sortModel:t}:void 0,rowGroup:s.length?{groupColIds:s}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:r.length||e?{pivotMode:e,pivotColIds:r}:void 0,columnPinning:n.length||o.length?{leftColIds:n,rightColIds:o}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:u.length?{orderedColIds:u}:void 0}}setColumnState(e){const{sort:t,rowGroup:s,aggregation:i,pivot:r,columnPinning:n,columnVisibility:o,columnSizing:a,columnOrder:l}=e,u={},h=C=>{let y=u[C];return y||(y={colId:C},u[C]=y,y)};t&&t.sortModel.forEach(({colId:C,sort:y},R)=>{const x=h(C);x.sort=y,x.sortIndex=R}),s&&s.groupColIds.forEach((C,y)=>{const R=h(C);R.rowGroup=!0,R.rowGroupIndex=y}),i&&i.aggregationModel.forEach(({colId:C,aggFunc:y})=>{h(C).aggFunc=y}),r&&(r.pivotColIds.forEach((C,y)=>{const R=h(C);R.pivot=!0,R.pivotIndex=y}),this.gos.updateGridOptions({options:{pivotMode:r.pivotMode},source:"gridInitializing"})),n&&(n.leftColIds.forEach(C=>{h(C).pinned="left"}),n.rightColIds.forEach(C=>{h(C).pinned="right"})),o&&o.hiddenColIds.forEach(C=>{h(C).hide=!0}),a&&a.columnSizingModel.forEach(({colId:C,flex:y,width:R})=>{const x=h(C);x.flex=y??null,x.width=R});const p=l==null?void 0:l.orderedColIds,g=!!(p!=null&&p.length),m=g?p.map(C=>h(C)):Object.values(u);if(m.length){this.columnStates=m;const C={sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};this.columnModel.applyColumnState({state:m,applyOrder:g,defaultState:C},"gridInitializing")}}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const s=this.columnGroupStates;if(this.columnGroupStates=void 0,!!this.columnModel.isSecondaryColumnsPresent()){if(t){let i=[];for(const r of t)this.columnModel.getSecondaryColumn(r.colId)&&i.push(r);this.columnModel.applyColumnState({state:i,applyOrder:e},"gridInitializing")}s&&this.columnModel.setColumnGroupState(s,"gridInitializing")}}getColumnGroupState(){const e=this.columnModel.getColumnGroupState(),t=[];return e.forEach(({groupId:s,open:i})=>{i&&t.push(s)}),t.length?{openColumnGroupIds:t}:void 0}setColumnGroupState(e){var t;if(!e.hasOwnProperty("columnGroup"))return;const s=new Set((t=e.columnGroup)==null?void 0:t.openColumnGroupIds),r=this.columnModel.getColumnGroupState().map(({groupId:n})=>{const o=s.has(n);return o&&s.delete(n),{groupId:n,open:o}});s.forEach(n=>{r.push({groupId:n,open:!0})}),r.length&&(this.columnGroupStates=r),this.columnModel.setColumnGroupState(r,"gridInitializing")}getFilterState(){var e;let t=this.filterManager.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);const s=(e=this.filterManager.getAdvancedFilterModel())!=null?e:void 0;return t||s?{filterModel:t,advancedFilterModel:s}:void 0}setFilterState(e,t){const{filterModel:s,advancedFilterModel:i}=e??{advancedFilterModel:t};s&&this.filterManager.setFilterModel(s,"columnFilter"),i&&this.filterManager.setAdvancedFilterModel(i)}getRangeSelectionState(){var e;const t=(e=this.rangeService)==null?void 0:e.getCellRanges().map(s=>{const{id:i,type:r,startRow:n,endRow:o,columns:a,startColumn:l}=s;return{id:i,type:r,startRow:n,endRow:o,colIds:a.map(u=>u.getColId()),startColId:l.getColId()}});return t!=null&&t.length?{cellRanges:t}:void 0}setRangeSelectionState(e){if(!this.gos.get("enableRangeSelection")||!this.rangeService)return;const t=[];e.cellRanges.forEach(s=>{const i=[];if(s.colIds.forEach(n=>{const o=this.columnModel.getGridColumn(n);o&&i.push(o)}),!i.length)return;let r=this.columnModel.getGridColumn(s.startColId);if(!r){const n=this.columnModel.getAllDisplayedColumns(),o=new Set(i);r=n.find(a=>o.has(a))}t.push(rs(Xe({},s),{columns:i,startColumn:r}))}),this.rangeService.setCellRanges(t)}getScrollState(){var e,t,s;if(!this.isClientSideRowModel)return;const i=(e=this.ctrlsService.getGridBodyCtrl())==null?void 0:e.getScrollFeature(),{left:r}=(t=i==null?void 0:i.getHScrollPosition())!=null?t:{left:0},{top:n}=(s=i==null?void 0:i.getVScrollPosition())!=null?s:{top:0};return n||r?{top:n,left:r}:void 0}setScrollState(e){var t;if(!this.isClientSideRowModel)return;const{top:s,left:i}=e;(t=this.ctrlsService.getGridBodyCtrl())==null||t.getScrollFeature().setScrollPosition(s,i)}getSideBarState(){var e,t;return(t=(e=this.sideBarService)==null?void 0:e.getSideBarComp())==null?void 0:t.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.focusService.getFocusedCell();if(e){const{column:t,rowIndex:s,rowPinned:i}=e;return{colId:t.getColId(),rowIndex:s,rowPinned:i}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:s,rowPinned:i}=e;this.focusService.setFocusedCell({column:this.columnModel.getGridColumn(t),rowIndex:s,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const e=this.paginationProxy.getCurrentPage(),t=this.gos.get("paginationAutoPageSize")?void 0:this.paginationProxy.getPageSize();if(!(!e&&!t))return{page:e,pageSize:t}}setPaginationState(e){e.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationProxy.setPageSize(e.pageSize,"initialState"),typeof e.page=="number"&&this.paginationProxy.setPage(e.page)}getRowSelectionState(){var e;const t=this.selectionService.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!((e=t==null?void 0:t.toggledNodes)!=null&&e.length)?void 0:t}setRowSelectionState(e){this.selectionService.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const e=this.expansionService.getExpandedRows();return e.length?{expandedRowGroupIds:e}:void 0}setRowGroupExpansionState(e){this.expansionService.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let s=!1;Object.entries(t).forEach(([i,r])=>{Wy(r,this.cachedState[i])||(s=!0)}),this.cachedState=Xe(Xe({},this.cachedState),t),s&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const s=this.cachedState[e];this.setCachedStateValue(e,t),Wy(t,s)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=rs(Xe({},this.cachedState),{[e]:t})}refreshStaleState(){this.staleStateKeys.forEach(e=>{switch(e){case"rowSelection":this.setCachedStateValue(e,this.getRowSelectionState());break}}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(t=>this.queuedUpdateSources.add(t)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear();const t={type:w.EVENT_STATE_UPDATED,sources:e,state:this.cachedState};this.eventService.dispatchEvent(t)}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),e(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}};f([A("filterManager")],Ei.prototype,"filterManager",2);f([A("ctrlsService")],Ei.prototype,"ctrlsService",2);f([A("focusService")],Ei.prototype,"focusService",2);f([A("columnModel")],Ei.prototype,"columnModel",2);f([A("paginationProxy")],Ei.prototype,"paginationProxy",2);f([A("rowModel")],Ei.prototype,"rowModel",2);f([A("selectionService")],Ei.prototype,"selectionService",2);f([A("expansionService")],Ei.prototype,"expansionService",2);f([A("columnAnimationService")],Ei.prototype,"columnAnimationService",2);f([zt("sideBarService")],Ei.prototype,"sideBarService",2);f([zt("rangeService")],Ei.prototype,"rangeService",2);f([xe],Ei.prototype,"postConstruct",1);Ei=f([Le("stateService")],Ei);var Ah=class extends Se{init(){this.processGridOptions(this.gridOptions)}processGridOptions(e){this.processOptions(e,p2)}processColumnDefs(e){this.processOptions(e,bc)}processOptions(e,t){const{validations:s,deprecations:i,allProperties:r,propertyExceptions:n,objectName:o,docsUrl:a}=t;r&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...n??[],...Object.keys(i)],r,o,a);const l=new Set;Object.keys(e).forEach(h=>{var p;const g=i[h];if(g)if("renamed"in g){const{renamed:T,version:I}=g;l.add(`As of v${I}, ${String(h)} is deprecated. Please use ${String(T)} instead.`),e[T]=e[h]}else{const{message:T,version:I}=g;l.add(`As of v${I}, ${String(h)} is deprecated. ${T??""}`)}const m=e[h];if(m==null||m===!1)return;const C=s[h];let y;if(C)if(typeof C=="function"){const T=C(e,this.gridOptions);if(!T)return;if("objectName"in T){const I=e[h];if(Array.isArray(I)){I.forEach(V=>{this.processOptions(V,T)});return}this.processOptions(e[h],T);return}y=T}else y=C;else return;const{module:R,dependencies:x,supportedRowModels:S}=y;if(S){const T=(p=this.gridOptions.rowModelType)!=null?p:"clientSide";if(!S.includes(T)){l.add(`${String(h)} is not supported with the '${T}' row model.`);return}}if(R){const T=Array.isArray(R)?R:[R];let I=!0;if(T.forEach(V=>{Vt.__assertRegistered(V,String(h),this.context.getGridId())||(I=!1,l.add(`${String(h)} is only available when ${V} is loaded.`))}),!I)return}if(x){const T=this.checkForWarning(h,x,e);if(T){l.add(T);return}}}),l.size>0&&l.forEach(h=>{tt(h)})}checkForWarning(e,t,s){if(typeof t=="function")return t(s,this.gridOptions);const r=Object.entries(t).find(([a,l])=>{const u=s[a];return!l.includes(u)});if(!r)return null;const[n,o]=r;return o.length>1?`'${String(e)}' requires '${n}' to be one of [${o.join(", ")}].`:`'${String(e)}' requires '${n}' to be ${o[0]}.`}checkProperties(e,t,s,i,r){const n=["__ob__","__v_skip","__metadata__"],o=hF(Object.getOwnPropertyNames(e),[...n,...t,...s],s);if(ui(o,(a,l)=>{tt(`invalid ${i} property '${a}' did you mean any of these: ${l.slice(0,8).join(", ")}`)}),Object.keys(o).length>0&&r){const a=this.getFrameworkOverrides().getDocLink(r);tt(`to see all the valid ${i} properties please check: ${a}`)}}};f([A("gridOptions")],Ah.prototype,"gridOptions",2);f([xe],Ah.prototype,"init",1);Ah=f([Le("validationService")],Ah);var Lf=class extends Se{constructor(){super(...arguments),this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new QS(this.getFrameworkOverrides())}addEventListener(e,t){const s=this.frameworkEventWrappingService.wrap(t),i=this.gos.useAsyncEvents()&&!Dg.has(e),r=i?this.asyncEventListeners:this.syncEventListeners;r.has(e)||r.set(e,new Set),r.get(e).add(s),this.eventService.addEventListener(e,s,i)}removeEventListener(e,t){var s;const i=this.frameworkEventWrappingService.unwrap(t),r=this.asyncEventListeners.get(e),n=!!(r!=null&&r.delete(i));n||(s=this.syncEventListeners.get(e))==null||s.delete(i),this.eventService.removeEventListener(e,i,n)}addGlobalListener(e){const t=this.frameworkEventWrappingService.wrapGlobal(e);if(this.gos.useAsyncEvents()){const i=(n,o)=>{Dg.has(n)&&t(n,o)},r=(n,o)=>{Dg.has(n)||t(n,o)};this.globalEventListenerPairs.set(e,{syncListener:i,asyncListener:r}),this.eventService.addGlobalListener(i,!1),this.eventService.addGlobalListener(r,!0)}else this.syncGlobalEventListeners.add(t),this.eventService.addGlobalListener(t,!1)}removeGlobalListener(e){const t=this.frameworkEventWrappingService.unwrapGlobal(e);if(this.globalEventListenerPairs.has(t)){const{syncListener:i,asyncListener:r}=this.globalEventListenerPairs.get(t);this.eventService.removeGlobalListener(i,!1),this.eventService.removeGlobalListener(r,!0),this.globalEventListenerPairs.delete(e)}else this.syncGlobalEventListeners.delete(t),this.eventService.removeGlobalListener(t,!1)}destroyEventListeners(e,t){e.forEach((s,i)=>{s.forEach(r=>this.eventService.removeEventListener(i,r,t)),s.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(s=>this.eventService.removeGlobalListener(s,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(({syncListener:e,asyncListener:t})=>{this.eventService.removeGlobalListener(e,!1),this.eventService.removeGlobalListener(t,!0)}),this.globalEventListenerPairs.clear()}};f([xe],Lf.prototype,"postConstruct",1);Lf=f([Le("apiEventService")],Lf);var K0=class extends at{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.paginationProxy.getPageSize()||(this.paginationProxy.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}init(){this.addManagedPropertyListener("paginationPageSizeSelector",()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,e=>this.handlePaginationChanged(e))}handlePaginationChanged(e){if(!this.selectPageSizeComp||!(e!=null&&e.newPageSize))return;const t=this.paginationProxy.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp&&this.appendChild(this.selectPageSizeComp))}reset(){xs(this.getGui()),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0)}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get("paginationPageSizeSelector")!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.paginationProxy.getPageSize(),s=!t||!e.includes(t);s&&(e.unshift(""),tt(`The paginationPageSize grid option is set to a value that is not in the list of page size options.
                Please make sure that the paginationPageSize grid option is set to one of the values in the 
                paginationPageSizeSelector array, or set the paginationPageSizeSelector to false to hide the page size selector.`)),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0);const i=this.localeService.getLocaleTextFunc(),r=i("pageSizeSelectorLabel","Page Size:"),n=e.map(a=>({value:String(a),text:String(a)})),o=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new Km).addOptions(n).setValue(String(s?"":t)).setAriaLabel(o).setLabel(r).onValueChange(()=>this.handlePageSizeItemSelected()),this.hasEmptyOption=s}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get("paginationPageSizeSelector");return!Array.isArray(t)||!this.validateValues(t)?e:[...t].sort((s,i)=>s-i)}validateValues(e){if(!e.length)return tt(`The paginationPageSizeSelector grid option is an empty array. This is most likely a mistake.
                If you want to hide the page size selector, please set the paginationPageSizeSelector to false.`),!1;for(let t=0;t<e.length;t++){const s=e[t],i=typeof s=="number",r=s>0;if(!i)return tt(`The paginationPageSizeSelector grid option contains a non-numeric value.
                    Please make sure that all values in the paginationPageSizeSelector array are numbers.`),!1;if(!r)return tt(`The paginationPageSizeSelector grid option contains a negative number or zero.
                    Please make sure that all values in the paginationPageSizeSelector array are positive.`),!1}return!0}destroy(){this.toggleSelectDisplay(!1),super.destroy()}};f([A("paginationProxy")],K0.prototype,"paginationProxy",2);f([xe],K0.prototype,"init",1);var Fh=class extends Se{constructor(){super(),this.descriptionContainer=null,this.announceValue=xi(this.announceValue.bind(this),200)}postConstruct(){const e=this.gos.getDocument(),t=this.descriptionContainer=e.createElement("div");t.classList.add("ag-aria-description-container"),e0(t,"polite"),VA(t,"additions text"),GA(t,!0),this.eGridDiv.appendChild(t)}announceValue(e){this.descriptionContainer&&(this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=e)},50))}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(xs(e),e.parentElement&&e.parentElement.removeChild(e)),this.descriptionContainer=null,this.eGridDiv=null}};f([A("eGridDiv")],Fh.prototype,"eGridDiv",2);f([xe],Fh.prototype,"postConstruct",1);Fh=f([Le("ariaAnnouncementService")],Fh);var mw=class{};mw.gridOptions=void 0;var f2=1,m2=class{create(e,t,s,i,r){var n;let o={};mw.gridOptions?(zi(o,mw.gridOptions,!0,!0),o=Xe(Xe({},o),t)):o=t;const a=Bt.getCoercedGridOptions(o),l=!!a.debug,u=(n=a.gridId)!=null?n:String(f2++),h=this.getRegisteredModules(r,u),p=this.createBeansList(a.rowModelType,h,u),g=this.createProvidedBeans(e,a,r);if(!p){tl("Failed to create grid.");return}const m={providedBeanInstances:g,beanClasses:p,debug:l,gridId:u},C=new U0("Context",()=>m.debug),y=new T1(m,C),R=y.getBean("beans");return this.registerModuleUserComponents(R,h),this.registerStackComponents(R,h),this.registerControllers(R,h),s(y),R.syncService.start(),i&&i(y),y.getBean("gridApi")}registerControllers(e,t){t.forEach(s=>{s.controllers&&s.controllers.forEach(i=>e.ctrlsFactory.register(i))})}registerStackComponents(e,t){const s=this.createAgStackComponentsList(t);e.agStackComponentsRegistry.setupComponents(s)}getRegisteredModules(e,t){const s=e?e.modules:null,i=Vt.__getRegisteredModules(t),r=[],n={},o=(a,l,u)=>{(p=>{n[p.moduleName]||(n[p.moduleName]=!0,r.push(p),Vt.__register(p,a,u))})(l),l.dependantModules&&l.dependantModules.forEach(p=>o(a,p,u))};return s&&s.forEach(a=>o(!0,a,t)),i&&i.forEach(a=>o(!Vt.__isPackageBased(),a,void 0)),r}registerModuleUserComponents(e,t){this.extractModuleEntity(t,i=>i.userComponents?i.userComponents:[]).forEach(i=>{e.userComponentRegistry.registerDefaultComponent(i.componentName,i.componentClass)})}createProvidedBeans(e,t,s){let i=s?s.frameworkOverrides:null;ot(i)&&(i=new IN);const r={gridOptions:t,eGridDiv:e,globalEventListener:s?s.globalEventListener:null,globalSyncEventListener:s?s.globalSyncEventListener:null,frameworkOverrides:i};return s&&s.providedBeanInstances&&Object.assign(r,s.providedBeanInstances),r}createAgStackComponentsList(e){let t=[{componentName:"AgCheckbox",componentClass:Ym},{componentName:"AgRadioButton",componentClass:FF},{componentName:"AgToggleButton",componentClass:TN},{componentName:"AgInputTextField",componentClass:Wl},{componentName:"AgInputTextArea",componentClass:VG},{componentName:"AgInputNumberField",componentClass:A0},{componentName:"AgInputDateField",componentClass:BG},{componentName:"AgInputRange",componentClass:HG},{componentName:"AgRichSelect",componentClass:uv},{componentName:"AgSelect",componentClass:Km},{componentName:"AgSlider",componentClass:WG},{componentName:"AgGridBody",componentClass:mn},{componentName:"AgHeaderRoot",componentClass:LG},{componentName:"AgSortIndicator",componentClass:N0},{componentName:"AgPagination",componentClass:er},{componentName:"AgPageSizeSelector",componentClass:K0},{componentName:"AgOverlayWrapper",componentClass:r2},{componentName:"AgGroupComponent",componentClass:zG},{componentName:"AgRowContainer",componentClass:Ru},{componentName:"AgFakeHorizontalScroll",componentClass:n2},{componentName:"AgFakeVerticalScroll",componentClass:g2},{componentName:"AgAutocomplete",componentClass:QG}];const s=this.extractModuleEntity(e,i=>i.agStackComponents?i.agStackComponents:[]);return t=t.concat(s),t}createBeansList(e="clientSide",t,s){const i=t.filter(l=>!l.rowModel||l.rowModel===e),r={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!r[e]){tl("Could not find row model for rowModelType = "+e);return}if(!Vt.__assertRegistered(r[e],`rowModelType = '${e}'`,s))return;const n=[Ct,uu,hw,Th,ou,bt,Af,Mf,Eh,aw,pa,lu,yh,fw,Ah,Sh,Ch,qy,pn,Bt,uo,Nl,Or,Us,Pl,xh,mr,If,uh,Fl,hi,kf,ma,_f,Al,ga,ut,nu,$t,ro,Rh,fa,Nf,iu,Il,dw,bh,cu,dh,au,ru,Bn,Qy,pw,Dh,Vn,du,yl,Ph,hu,gw,_l,Ki,kl,Ml,Ei,wh,Lf,Fh,Gr],o=this.extractModuleEntity(i,l=>l.beans?l.beans:[]);n.push(...o);const a=[];return n.forEach(l=>{a.indexOf(l)<0&&a.push(l)}),a}extractModuleEntity(e,t){return[].concat(...e.map(t))}},v2=class{wrap(e,t,s=[],i){const r=this.createWrapper(e,i);return t.forEach(n=>{this.createMethod(r,n,!0)}),s.forEach(n=>{this.createMethod(r,n,!1)}),r}unwrap(e){return e}createMethod(e,t,s){e.addMethod(t,this.createMethodProxy(e,t,s))}createMethodProxy(e,t,s){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(s&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}}},ku=typeof global>"u"?{}:global;ku.HTMLElement=typeof HTMLElement>"u"?{}:HTMLElement;ku.HTMLButtonElement=typeof HTMLButtonElement>"u"?{}:HTMLButtonElement;ku.HTMLSelectElement=typeof HTMLSelectElement>"u"?{}:HTMLSelectElement;ku.HTMLInputElement=typeof HTMLInputElement>"u"?{}:HTMLInputElement;ku.Node=typeof Node>"u"?{}:Node;ku.MouseEvent=typeof MouseEvent>"u"?{}:MouseEvent;var Y0=class yd{constructor(t,s,i,r,n,o){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=t,this.gos=s,this.eventService=i,this.columnModel=r,this.beans=o,this.selectionService=n,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=yd.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return nt.cloneObject(this.allNodesMap)}getRowNode(t){return this.allNodesMap[t]}setRowData(t){if(typeof t=="string"){console.warn("AG Grid: rowData must be an array.");return}this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(t);const s=this.rootNode,i=this.rootNode.sibling;s.childrenAfterFilter=null,s.childrenAfterGroup=null,s.childrenAfterAggFilter=null,s.childrenAfterSort=null,s.childrenMapped=null,s.updateHasChildren(),this.nextId=0,this.allNodesMap={},t?s.allLeafChildren=t.map(r=>this.createNode(r,this.rootNode,yd.TOP_LEVEL)):(s.allLeafChildren=[],s.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=s.childrenAfterFilter,i.childrenAfterGroup=s.childrenAfterGroup,i.childrenAfterAggFilter=s.childrenAfterAggFilter,i.childrenAfterSort=s.childrenAfterSort,i.childrenMapped=s.childrenMapped,i.allLeafChildren=s.allLeafChildren)}updateRowData(t,s){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(t.add);const i={remove:[],update:[],add:[]},r=[];return this.executeRemove(t,i,r),this.executeUpdate(t,i,r),this.executeAdd(t,i),this.updateSelection(r,"rowDataChanged"),s&&nt.sortRowNodesByOrder(this.rootNode.allLeafChildren,s),i}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(t){const s={type:w.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:t!=null&&t.length?t[0]:null};this.eventService.dispatchEvent(s)}updateSelection(t,s){const i=t.length>0;if(i&&this.selectionService.setNodesSelected({newValue:!1,nodes:t,suppressFinishActions:!0,source:s}),this.selectionService.updateGroupsFromChildrenSelections(s),i){const r={type:w.EVENT_SELECTION_CHANGED,source:s};this.eventService.dispatchEvent(r)}}executeAdd(t,s){var i;const{add:r,addIndex:n}=t;if(nt.missingOrEmpty(r))return;const o=r.map(a=>this.createNode(a,this.rootNode,yd.TOP_LEVEL));if(typeof n=="number"&&n>=0){const{allLeafChildren:a}=this.rootNode,l=a.length;let u=n;if(this.gos.get("treeData")&&n>0&&l>0){for(let m=0;m<l;m++)if(((i=a[m])==null?void 0:i.rowIndex)==n-1){u=m+1;break}}const p=a.slice(0,u),g=a.slice(u,a.length);this.rootNode.allLeafChildren=[...p,...o,...g]}else this.rootNode.allLeafChildren=[...this.rootNode.allLeafChildren,...o];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),s.add=o}executeRemove(t,s,i){const{remove:r}=t;if(nt.missingOrEmpty(r))return;const n={};r.forEach(o=>{const a=this.lookupRowNode(o);a&&(a.isSelected()&&i.push(a),a.clearRowTopAndRowIndex(),n[a.id]=!0,delete this.allNodesMap[a.id],s.remove.push(a))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(o=>!n[o.id]),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(t,s,i){const{update:r}=t;nt.missingOrEmpty(r)||r.forEach(n=>{const o=this.lookupRowNode(n);o&&(o.updateData(n),!o.selectable&&o.isSelected()&&i.push(o),this.setMasterForRow(o,n,yd.TOP_LEVEL,!1),s.update.push(o))})}lookupRowNode(t){const s=this.gos.getCallback("getRowId");let i;if(s){const r=s({data:t,level:0});if(i=this.allNodesMap[r],!i)return console.error(`AG Grid: could not find row id=${r}, data item was not found for this id`),null}else if(i=this.rootNode.allLeafChildren.find(r=>r.data===t),!i)return console.error("AG Grid: could not find data item as object was not found",t),console.error("Consider using getRowId to help the Grid find matching row data"),null;return i||null}createNode(t,s,i){const r=new yt(this.beans);r.group=!1,this.setMasterForRow(r,t,i,!0);const n=this.gos.get("suppressParentsInRowNodes");return s&&!n&&(r.parent=s),r.level=i,r.setDataAndId(t,this.nextId.toString()),this.allNodesMap[r.id]&&console.warn(`AG Grid: duplicate node id '${r.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[r.id]=r,this.nextId++,r}setMasterForRow(t,s,i,r){if(this.gos.get("treeData"))t.setMaster(!1),r&&(t.expanded=!1);else{if(this.gos.get("masterDetail")){const a=this.gos.get("isRowMaster");a?t.setMaster(a(s)):t.setMaster(!0)}else t.setMaster(!1);if(r){const a=this.columnModel.getRowGroupColumns(),l=a?a.length:0,u=i+l;t.expanded=t.master?this.isExpanded(u):!1}}}isExpanded(t){const s=this.gos.get("groupDefaultExpanded");return s===-1?!0:t<s}};Y0.TOP_LEVEL=0;Y0.ROOT_NODE_ID="ROOT_NODE_ID";var C2=Y0,Ri=class extends Se{constructor(){super(...arguments),this.onRowHeightChanged_debounced=nt.debounce(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}init(){const e=this.refreshModel.bind(this,{step:"group"}),t=!this.gos.get("suppressAnimationFrame"),s=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,s),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:"pivot"})),this.addManagedListener(this.eventService,w.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this)),this.addManagedListener(this.eventService,w.EVENT_GRID_READY,()=>this.onGridReady()),this.addPropertyListeners(),this.rootNode=new yt(this.beans),this.nodeManager=new C2(this.rootNode,this.gos,this.eventService,this.columnModel,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["suppressParentsInRowNodes","groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),s=new Set(["excludeChildrenWhenTreeDataFiltering"]),i=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),r=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),n=new Set(["postSortRows","groupDisplayType","accentedSort"]),o=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...e,...t,...s,...i,...i,...r,...n,...o,...a];this.addManagedPropertyListeners(l,u=>{var h;const p=(h=u.changeSet)==null?void 0:h.properties;if(!p)return;const g=m=>p.some(C=>m.has(C));if(g(e)){this.setRowData(this.rootNode.allLeafChildren.map(m=>m.data));return}if(g(t)){this.refreshModel({step:"group"});return}if(g(s)){this.refreshModel({step:"filter"});return}if(g(i)){this.refreshModel({step:"pivot"});return}if(g(r)){this.refreshModel({step:"aggregate"});return}if(g(n)){this.refreshModel({step:"sort"});return}if(g(o)){this.refreshModel({step:"filter_aggregates"});return}g(a)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,s,i){let r,n=!1;do{r=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,s),u=Math.min(a,i);for(let h=l;h<=u;h++){const p=this.getRow(h);if(p.rowHeightEstimated){const g=this.gos.getRowHeightForNode(p);p.setRowHeight(g.height),r=!0,n=!0}}r&&this.setRowTopAndRowIndex()}while(r);return n}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const s=new Set,i=this.gos.isDomLayout("normal");for(let r=0;r<this.rowsToDisplay.length;r++){const n=this.rowsToDisplay[r];if(n.id!=null&&s.add(n.id),n.rowHeight==null){const o=this.gos.getRowHeightForNode(n,i,e);n.setRowHeight(o.height,o.estimated)}n.setRowTop(t),n.setRowIndex(r),t+=n.rowHeight}return s}clearRowTopAndRowIndex(e,t){const s=e.isActive(),i=n=>{n&&n.id!=null&&!t.has(n.id)&&n.clearRowTopAndRowIndex()},r=n=>{if(i(n),i(n.detailNode),i(n.sibling),n.hasChildren()&&n.childrenAfterGroup){const o=n.level==-1;s&&!o&&!n.expanded||n.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(e,t,s=0){const i=this.getRowIndexAtPixel(t),r=this.getRow(i),n=!this.gos.get("suppressAnimationFrame");return r===e[0]?!1:(e.forEach(o=>{nt.removeFromArray(this.rootNode.allLeafChildren,o)}),e.forEach((o,a)=>{nt.insertIntoArray(this.rootNode.allLeafChildren,o,Math.max(i+s,0)+a)}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:n}),!0)}highlightRowAtPixel(e,t){const s=t!=null?this.getRowIndexAtPixel(t):null,i=s!=null?this.getRow(s):null;if(!i||!e||i===e||t==null){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null);return}const r=this.getHighlightPosition(t,i);this.lastHighlightedRow&&this.lastHighlightedRow!==i&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),i.setHighlighted(r),this.lastHighlightedRow=i}getHighlightPosition(e,t){if(!t){const r=this.getRowIndexAtPixel(e);if(t=this.getRow(r||0),!t)return 1}const{rowTop:s,rowHeight:i}=t;return e-s<i/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const t=this.rootNode.childrenAfterAggFilter;return t?t.length:0}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let s=this.rootNode.childrenAfterSort[e];if(this.gos.get("groupHideOpenParents"))for(;s.expanded&&s.childrenAfterSort&&s.childrenAfterSort.length>0;)s=s.childrenAfterSort[0];return s.rowIndex}getRowBounds(e){if(nt.missing(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=this.gos.isAnimateRows();this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=this.gos.isAnimateRows(),i=e.columns.length===0||e.columns.some(r=>r.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=this.gos.isAnimateRows();this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(e){const t=nt.missingOrEmpty(e),s=new cv(!1,this.rootNode);return(t||this.gos.get("treeData"))&&s.setInactive(),s}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction")||e.rowNodeTransactions==null)return!1;const t=e.rowNodeTransactions.filter(i=>i.add!=null&&i.add.length>0||i.remove!=null&&i.remove.length>0);return t==null||t.length==0}buildRefreshModelParams(e){let t="group";const s={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",sort:"sort",pivot:"pivot"};if(nt.exists(e)&&(t=s[e]),nt.missing(t)){console.error(`AG Grid: invalid step ${e}, available steps are ${Object.keys(s).join(", ")}`);return}const i=!this.gos.get("suppressAnimationFrame");return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:i}}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.shouldRowModelIgnoreRefresh())return;let t=typeof e=="object"&&"step"in e?e:this.buildRefreshModelParams(e);if(!t||this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const s=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case"group":this.doRowGrouping(t.rowNodeTransactions,t.rowNodeOrder,s,!!t.afterColumnsChanged);case"filter":this.doFilter(s);case"pivot":this.doPivot(s);case"aggregate":this.doAggregate(s);case"filter_aggregates":this.doFilterAggregates(s);case"sort":this.doSort(t.rowNodeTransactions,s);case"map":this.doRowsToDisplay()}const i=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(s,i),this.isRefreshingModel=!1;const r={type:w.EVENT_MODEL_UPDATED,animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack};this.eventService.dispatchEvent(r)}isEmpty(){const e=nt.missing(this.rootNode.allLeafChildren)||this.rootNode.allLeafChildren.length===0;return nt.missing(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return nt.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let s=!t,i=!1;const r=[],n=this.gos.get("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(o=>{if(i)return;if(s&&(o===t||o===e)&&(i=!0,o.group&&n)){r.push(...o.allLeafChildren);return}if(!s){if(o!==t&&o!==e)return;s=!0}if(!o.group||!n){r.push(o);return}}),r}setDatasource(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||this.rowsToDisplay.length===0)return-1;let t=0,s=this.rowsToDisplay.length-1;if(e<=0)return 0;if(nt.last(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let r=-1,n=-1;for(;;){const o=Math.floor((t+s)/2),a=this.rowsToDisplay[o];if(this.isRowInPixel(a,e)||(a.rowTop<e?t=o+1:a.rowTop>e&&(s=o-1),r===t&&n===s))return o;r=t,n=s}}isRowInPixel(e,t){const s=e.rowTop,i=e.rowTop+e.rowHeight;return s<=t&&i>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((t,s)=>e(t,s))}forEachNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:s,recursionType:i,includeFooterNodes:r}=e;let{index:n}=e;const o=a=>{var l;const u=(l=t[0])==null?void 0:l.parent;if(!u)return;const h=r&&this.gos.getGrandTotalRow(),p=this.gos.getGroupTotalRowCallback(),g=r&&p({node:u});if(u===this.rootNode){h===a&&(u.createFooter(),s(u.sibling,n++));return}g===a&&(u.createFooter(),s(u.sibling,n++))};o("top");for(let a=0;a<t.length;a++){const l=t[a];if(s(l,n++),l.hasChildren()&&!l.footer){let u=null;switch(i){case 0:u=l.childrenAfterGroup;break;case 1:u=l.childrenAfterAggFilter;break;case 2:u=l.childrenAfterSort;break;case 3:u=l.leafGroup?null:l.childrenAfterSort;break}u&&(n=this.recursivelyWalkNodesAndCallback({nodes:[...u],callback:s,recursionType:i,index:n,includeFooterNodes:r}))}}return o("bottom"),n}doAggregate(e){var t;(t=this.aggregationStage)==null||t.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),s=this.columnModel.isPivotActive(),i=o=>{o&&o.forEach(a=>{const l=()=>{a.expanded=e,i(a.childrenAfterGroup)};if(t){nt.exists(a.childrenAfterGroup)&&l();return}if(s){!a.leafGroup&&l();return}a.group&&l()})};this.rootNode&&i(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"});const r=e?"expandAll":"collapseAll",n={type:w.EVENT_EXPAND_COLLAPSE_ALL,source:r};this.eventService.dispatchEvent(n)}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,s,i){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodeOrder:t,changedPath:s}):this.groupStage.execute({rowNode:this.rootNode,changedPath:s,afterColumnsChanged:i}),this.gos.get("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",s)){const n={type:w.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(n)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren();this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:w.EVENT_ROW_COUNT_READY}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){var t;(t=this.pivotStage)==null||t.execute({rowNode:this.rootNode,changedPath:e})}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(e){if(typeof e=="string"&&e.indexOf(yt.ID_PREFIX_ROW_GROUP)==0){let s;return this.forEachNode(i=>{i.id===e&&(s=i)}),s}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){const e={type:w.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(e),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(e,t){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];const s=this.gos.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},s)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const e=[],t=[];let s=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(i=>{const r=this.nodeManager.updateRowData(i.rowDataTransaction,void 0);t.push(r),i.callback&&e.push(i.callback.bind(null,r)),typeof i.rowDataTransaction.addIndex=="number"&&(s=!0)}),this.commonUpdateRowData(t,void 0,s),e.length>0&&window.setTimeout(()=>{e.forEach(i=>i())},0),t.length>0){const i={type:w.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:t};this.eventService.dispatchEvent(i)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e,t){this.valueCache.onDataChanged();const s=this.nodeManager.updateRowData(e,t),i=typeof e.addIndex=="number";return this.commonUpdateRowData([s],t,i),s}createRowNodeOrder(){if(this.gos.get("suppressMaintainUnsortedOrder"))return;const t={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let s=0;s<this.rootNode.allLeafChildren.length;s++){const i=this.rootNode.allLeafChildren[s];t[i.id]=s}return t}commonUpdateRowData(e,t,s){if(!this.hasStarted)return;const i=!this.gos.get("suppressAnimationFrame");s&&(t=this.createRowNodeOrder());const r={type:w.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(r),this.refreshModel({step:"group",rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,keepEditingRows:!0,animate:i})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const s=t.detailNode;s&&s.setRowHeight(s.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}};f([A("columnModel")],Ri.prototype,"columnModel",2);f([A("selectionService")],Ri.prototype,"selectionService",2);f([A("valueCache")],Ri.prototype,"valueCache",2);f([A("beans")],Ri.prototype,"beans",2);f([A("filterStage")],Ri.prototype,"filterStage",2);f([A("sortStage")],Ri.prototype,"sortStage",2);f([A("flattenStage")],Ri.prototype,"flattenStage",2);f([zt("groupStage")],Ri.prototype,"groupStage",2);f([zt("aggregationStage")],Ri.prototype,"aggregationStage",2);f([zt("pivotStage")],Ri.prototype,"pivotStage",2);f([zt("filterAggregatesStage")],Ri.prototype,"filterAggregatesStage",2);f([xe],Ri.prototype,"init",1);Ri=f([Le("rowModel")],Ri);var Of=class extends Se{execute(e){const{changedPath:t}=e;this.filterService.filter(t)}};f([A("filterService")],Of.prototype,"filterService",2);Of=f([Le("filterStage")],Of);var Nh=class extends Se{execute(e){const t=this.sortController.getSortOptions(),s=nt.exists(t)&&t.length>0,i=s&&nt.exists(e.rowNodeTransactions)&&this.gos.get("deltaSort"),r=t.some(n=>this.gos.isColumnsSortingCoupledToGroup()?n.column.isPrimary()&&n.column.isRowGroupActive():!!n.column.getColDef().showRowGroup);this.sortService.sort(t,s,i,e.rowNodeTransactions,e.changedPath,r)}};f([A("sortService")],Nh.prototype,"sortService",2);f([A("sortController")],Nh.prototype,"sortController",2);Nh=f([Le("sortStage")],Nh);var Gf=class extends Se{execute(e){const t=e.rowNode,s=[],i=this.beans.columnModel.isPivotMode(),r=i&&t.leafGroup,n=r?[t]:t.childrenAfterSort,o=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(o,n,s,i,0);const a=s.length>0;if(!r&&a&&o.grandTotalRow){t.createFooter();const u=o.grandTotalRow==="top";this.addRowNodeToRowsToDisplay(o,t.sibling,s,0,u)}return s}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:this.gos.isGroupMultiAutoColumn(),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:this.gos.getGrandTotalRow(),groupTotalRow:this.gos.getGroupTotalRowCallback()}}recursivelyAddToRowsToDisplay(e,t,s,i,r){if(!nt.missingOrEmpty(t))for(let n=0;n<t.length;n++){const o=t[n],a=o.hasChildren(),l=i&&!a,u=e.groupRemoveSingleChildren&&a&&o.childrenAfterGroup.length===1,h=e.groupRemoveLowestSingleChildren&&a&&o.leafGroup&&o.childrenAfterGroup.length===1,p=i&&o.leafGroup,g=e.hideOpenParents&&o.expanded&&!o.master&&!p;if(!l&&!g&&!u&&!h&&this.addRowNodeToRowsToDisplay(e,o,s,r),!(i&&o.leafGroup)){if(a){const C=u||h;if(o.expanded||C){const y=e.groupTotalRow({node:o});y||o.destroyFooter();const R=C?r:r+1;y==="top"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,s,R)),this.recursivelyAddToRowsToDisplay(e,o.childrenAfterSort,s,i,R),y==="bottom"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,s,R))}}else if(o.master&&o.expanded){const C=this.createDetailNode(o);this.addRowNodeToRowsToDisplay(e,C,s,r)}}}}addRowNodeToRowsToDisplay(e,t,s,i,r){r?s.unshift(t):s.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:i)}createDetailNode(e){if(nt.exists(e.detailNode))return e.detailNode;const t=new yt(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,nt.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}};f([A("beans")],Gf.prototype,"beans",2);Gf=f([Le("flattenStage")],Gf);var Ih=class extends Se{sort(e,t,s,i,r,n){const o=this.gos.get("groupMaintainOrder"),a=this.columnModel.getAllGridColumns().some(g=>g.isRowGroupActive());let l={};s&&i&&(l=this.calculateDirtyNodes(i));const u=this.columnModel.isPivotMode(),h=this.gos.getCallback("postSortRows"),p=g=>{var m;this.pullDownGroupDataForHideOpenParents(g.childrenAfterAggFilter,!0);const C=u&&g.leafGroup;if(o&&a&&!g.leafGroup&&!n){const R=(m=this.columnModel.getRowGroupColumns())==null?void 0:m[g.level+1],x=(R==null?void 0:R.getSort())===null,S=g.childrenAfterAggFilter.slice(0);if(g.childrenAfterSort&&!x){const T={};g.childrenAfterSort.forEach((I,V)=>{T[I.id]=V}),S.sort((I,V)=>{var j,P;return((j=T[I.id])!=null?j:0)-((P=T[V.id])!=null?P:0)})}g.childrenAfterSort=S}else!t||C?g.childrenAfterSort=g.childrenAfterAggFilter.slice(0):s?g.childrenAfterSort=this.doDeltaSort(g,l,r,e):g.childrenAfterSort=this.rowNodeSorter.doFullSort(g.childrenAfterAggFilter,e);if(g.sibling&&(g.sibling.childrenAfterSort=g.childrenAfterSort),this.updateChildIndexes(g),h){const R={nodes:g.childrenAfterSort};h(R)}};r&&r.forEachChangedNodeDepthFirst(p),this.updateGroupDataForHideOpenParents(r)}calculateDirtyNodes(e){const t={},s=i=>{i&&i.forEach(r=>t[r.id]=!0)};return e&&e.forEach(i=>{s(i.add),s(i.update),s(i.remove)}),t}doDeltaSort(e,t,s,i){const r=e.childrenAfterAggFilter,n=e.childrenAfterSort;if(!n)return this.rowNodeSorter.doFullSort(r,i);const o={},a=[];r.forEach(p=>{t[p.id]||!s.canSkip(p)?a.push(p):o[p.id]=!0});const l=n.filter(p=>o[p.id]),u=(p,g)=>({currentPos:g,rowNode:p}),h=a.map(u).sort((p,g)=>this.rowNodeSorter.compareRowNodes(i,p,g));return this.mergeSortedArrays(i,h,l.map(u)).map(({rowNode:p})=>p)}mergeSortedArrays(e,t,s){const i=[];let r=0,n=0;for(;r<t.length&&n<s.length;)this.rowNodeSorter.compareRowNodes(e,t[r],s[n])<0?i.push(t[r++]):i.push(s[n++]);for(;r<t.length;)i.push(t[r++]);for(;n<s.length;)i.push(s[n++]);return i}updateChildIndexes(e){if(nt.missing(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let s=0;s<t.length;s++){const i=t[s],r=s===0,n=s===e.childrenAfterSort.length-1;i.setFirstChild(r),i.setLastChild(n),i.setChildIndex(s)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return nt.warnOnce("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=s=>{this.pullDownGroupDataForHideOpenParents(s.childrenAfterSort,!1),s.childrenAfterSort.forEach(i=>{i.hasChildren()&&t(i)})};e&&e.executeFromRootNode(s=>t(s))}pullDownGroupDataForHideOpenParents(e,t){!this.gos.get("groupHideOpenParents")||nt.missing(e)||e.forEach(s=>{this.columnModel.getGroupDisplayColumns().forEach(r=>{const n=r.getColDef().showRowGroup;if(typeof n!="string"){console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");return}const o=n,a=this.columnModel.getPrimaryColumn(o);if(a!==s.rowGroupColumn)if(t)s.setGroupValue(r.getId(),void 0);else{const u=s.getFirstChildOfFirstChild(a);u&&s.setGroupValue(r.getId(),u.key)}})})}};f([A("columnModel")],Ih.prototype,"columnModel",2);f([A("rowNodeSorter")],Ih.prototype,"rowNodeSorter",2);Ih=f([Le("sortService")],Ih);var Vf=class extends Se{filter(e){const t=this.filterManager.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const s=(i,r)=>{i.hasChildren()&&e&&!r?i.childrenAfterFilter=i.childrenAfterGroup.filter(n=>{const o=n.childrenAfterFilter&&n.childrenAfterFilter.length>0,a=n.data&&this.filterManager.doesRowPassFilter({rowNode:n});return o||a}):i.childrenAfterFilter=i.childrenAfterGroup,i.sibling&&(i.sibling.childrenAfterFilter=i.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const i=(n,o)=>{if(n.childrenAfterGroup)for(let a=0;a<n.childrenAfterGroup.length;a++){const l=n.childrenAfterGroup[a],u=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?i(n.childrenAfterGroup[a],u):s(l,u)}s(n,o)},r=n=>i(n,!1);t.executeFromRootNode(r)}else{const i=r=>s(r,!1);t.forEachChangedNodeDepthFirst(i,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}};f([A("filterManager")],Vf.prototype,"filterManager",2);Vf=f([Le("filterService")],Vf);var Ll=class extends Se{postConstruct(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const e=this.gos.exists("getRowId");return this.gos.get("resetRowDataOnUpdate")?!1:e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const[s,i]=t;this.clientSideRowModel.updateRowData(s,i)}createTransactionForRowData(e){if(nt.missing(this.clientSideRowModel)){console.error("AG Grid: ImmutableService only works with ClientSideRowModel");return}const t=this.gos.getCallback("getRowId");if(t==null){console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");return}const s={remove:[],update:[],add:[]},i=this.clientSideRowModel.getCopyOfNodesMap(),n=this.gos.get("suppressMaintainUnsortedOrder")?void 0:{};return nt.exists(e)&&e.forEach((o,a)=>{const l=t({data:o,level:0}),u=i[l];n&&(n[l]=a),u?(u.data!==o&&s.update.push(o),i[l]=void 0):s.add.push(o)}),nt.iterateObject(i,(o,a)=>{a&&s.remove.push(a.data)}),[s,n]}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}};f([A("rowModel")],Ll.prototype,"rowModel",2);f([A("rowRenderer")],Ll.prototype,"rowRenderer",2);f([A("selectionService")],Ll.prototype,"selectionService",2);f([xe],Ll.prototype,"postConstruct",1);Ll=f([Le("immutableService")],Ll);var y2="31.3.4",w2={version:y2,moduleName:"@ag-grid-community/client-side-row-model",rowModel:"clientSide",beans:[Ri,Of,Nh,Gf,Ih,Vf,Ll]},S2=Object.defineProperty,x2=Object.getOwnPropertyDescriptor,Ii=(e,t,s,i)=>{for(var r=i>1?void 0:i?x2(t,s):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(i?o(t,s,r):o(r))||r);return i&&r&&S2(t,s,r),r},b2=(e,t)=>(s,i)=>t(s,i,e),_h=class extends lw{constructor(e,t,s){super(e),this.parentCache=t,this.params=s,this.startRow=e*s.blockSize,this.endRow=this.startRow+s.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,s){nt.exists(t)?e.setDataAndId(t,s.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(nt.missing(this.params.datasource.getRows)){console.warn("AG Grid: datasource is missing getRows method");return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(e,t,s){this.rowNodes.forEach((i,r)=>{this.startRow+r<s&&e(i,t.next())})}getLastAccessed(){return this.lastAccessed}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.next());const s=e-this.startRow;return this.rowNodes[s]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let e=0;e<this.params.blockSize;e++){const t=this.startRow+e,s=new yt(this.beans);s.setRowHeight(this.params.rowHeight),s.uiLevel=0,s.setRowIndex(t),s.setRowTop(this.params.rowHeight*t),this.rowNodes.push(s)}}processServerResult(e){this.rowNodes.forEach((s,i)=>{const r=e.rowData?e.rowData[i]:void 0;!s.id&&s.alreadyRendered&&r&&(this.rowNodes[i]=new yt(this.beans),this.rowNodes[i].setRowIndex(s.rowIndex),this.rowNodes[i].setRowTop(s.rowTop),this.rowNodes[i].setRowHeight(s.rowHeight),s.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[i],r,this.startRow+i)});const t=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,t)}destroyRowNodes(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()})}};Ii([A("beans")],_h.prototype,"beans",2);Ii([xe],_h.prototype,"postConstruct",1);Ii([Fi],_h.prototype,"destroyRowNodes",1);var Mu=class GN extends Se{constructor(t){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=t.initialRowCount,this.params=t}setBeans(t){this.logger=t.create("InfiniteCache")}getRow(t,s=!1){const i=Math.floor(t/this.params.blockSize);let r=this.blocks[i];if(!r){if(s)return;r=this.createBlock(i)}return r.getRow(t)}createBlock(t){const s=this.createBean(new _h(t,this,this.params));return this.blocks[s.getId()]=s,this.blockCount++,this.purgeBlocksIfNeeded(s),this.params.rowNodeBlockLoader.addBlock(s),s}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(s=>s.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroyAllBlocks(){this.getBlocksInOrder().forEach(t=>this.destroyBlock(t))}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(t,s){this.isAlive()&&(this.logger.log(`onPageLoaded: page = ${t.getId()}, lastRow = ${s}`),this.checkRowCount(t,s),this.onCacheUpdated())}purgeBlocksIfNeeded(t){const s=this.getBlocksInOrder().filter(a=>a!=t),i=(a,l)=>l.getLastAccessed()-a.getLastAccessed();s.sort(i);const r=this.params.maxBlocksInCache>0,n=r?this.params.maxBlocksInCache-1:null,o=GN.MAX_EMPTY_BLOCKS_TO_KEEP-1;s.forEach((a,l)=>{const u=a.getState()===_h.STATE_WAITING_TO_LOAD&&l>=o,h=r?l>=n:!1;if(u||h){if(this.isBlockCurrentlyDisplayed(a)||this.isBlockFocused(a))return;this.removeBlockFromCache(a)}})}isBlockFocused(t){const s=this.focusService.getFocusCellToUseAfterRefresh();if(!s||s.rowPinned!=null)return!1;const i=t.getStartRow(),r=t.getEndRow();return s.rowIndex>=i&&s.rowIndex<r}isBlockCurrentlyDisplayed(t){const s=t.getStartRow(),i=t.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(s,i)}removeBlockFromCache(t){t&&this.destroyBlock(t)}checkRowCount(t,s){if(typeof s=="number"&&s>=0)this.rowCount=s,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const r=(t.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<r&&(this.rowCount=r)}}setRowCount(t,s){this.rowCount=t,nt.exists(s)&&(this.lastRowIndexKnown=s),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(t){const s=new su;this.getBlocksInOrder().forEach(i=>i.forEachNode(t,s,this.rowCount))}getBlocksInOrder(){const t=(i,r)=>i.getId()-r.getId();return nt.getAllValuesInObject(this.blocks).sort(t)}destroyBlock(t){delete this.blocks[t.getId()],this.destroyBean(t),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(t)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const t={type:w.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(t)}}destroyAllBlocksPastVirtualRowCount(){const t=[];this.getBlocksInOrder().forEach(s=>{s.getId()*this.params.blockSize>=this.rowCount&&t.push(s)}),t.length>0&&t.forEach(s=>this.destroyBlock(s))}purgeCache(){this.getBlocksInOrder().forEach(t=>this.removeBlockFromCache(t)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(t,s){const i=[];let r=-1,n=!1;const o=new su;nt.missing(t)&&(n=!0);let a=!1;return this.getBlocksInOrder().forEach(u=>{if(!a){if(n&&r+1!==u.getId()){a=!0;return}r=u.getId(),u.forEachNode(h=>{const p=h===t||h===s;(n||p)&&i.push(h),p&&(n=!n)},o,this.rowCount)}}),a||n?[]:i}};Mu.MAX_EMPTY_BLOCKS_TO_KEEP=2;Ii([A("rowRenderer")],Mu.prototype,"rowRenderer",2);Ii([A("focusService")],Mu.prototype,"focusService",2);Ii([b2(0,Fr("loggerFactory"))],Mu.prototype,"setBeans",1);Ii([Fi],Mu.prototype,"destroyAllBlocks",1);var E2=Mu,Hn=class extends Se{getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(e,t,s,i){return!1}init(){this.gos.isRowModelType("infinite")&&(this.rowHeight=this.gos.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&nt.warnOnce("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroyDatasource(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedListener(this.eventService,w.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,w.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this)),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=this.gos.getRowHeightAsNumber(),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;this.cacheParams?e=this.isSortModelDifferent():e=!0,e&&this.reset()}isSortModelDifferent(){return!nt.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;this.gos.getCallback("getRowId")!=null||this.selectionService.reset("rowDataChanged"),this.resetCache()}createModelUpdatedEvent(){return{type:w.EVENT_MODEL_UPDATED,newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:this.gos.getRowHeightAsNumber(),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new su},this.infiniteCache=this.createBean(new E2(this.cacheParams)),this.eventService.dispatchEventOnce({type:w.EVENT_ROW_COUNT_READY});const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}updateRowHeights(){this.forEachNode(t=>{t.setRowHeight(this.rowHeight),t.setRowTop(this.rowHeight*t.rowIndex)});const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(e){let t;return this.forEachNode(s=>{s.id===e&&(t=s)}),t}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),s=this.getRowCount()-1;return t>s?s:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?this.infiniteCache.isLastRowIndexKnown():!1}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}};Ii([A("filterManager")],Hn.prototype,"filterManager",2);Ii([A("sortController")],Hn.prototype,"sortController",2);Ii([A("selectionService")],Hn.prototype,"selectionService",2);Ii([A("rowRenderer")],Hn.prototype,"rowRenderer",2);Ii([A("rowNodeBlockLoader")],Hn.prototype,"rowNodeBlockLoader",2);Ii([xe],Hn.prototype,"init",1);Ii([Fi],Hn.prototype,"destroyDatasource",1);Hn=Ii([Le("rowModel")],Hn);var R2="31.3.4",T2={version:R2,moduleName:"@ag-grid-community/infinite-row-model",rowModel:"infinite",beans:[Hn]},D2=Object.defineProperty,P2=Object.getOwnPropertyDescriptor,tr=(e,t,s,i)=>{for(var r=i>1?void 0:i?P2(t,s):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(i?o(t,s,r):o(r))||r);return i&&r&&D2(t,s,r),r},A2=class{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return(e==null||!e.length)&&(e=this.getDefaultFileName()),e.indexOf(".")===-1?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},F2=class{constructor(e){this.groupColumns=[];const{columnModel:t,valueService:s,gos:i,processCellCallback:r,processHeaderCallback:n,processGroupHeaderCallback:o,processRowGroupCallback:a}=e;this.columnModel=t,this.valueService=s,this.gos=i,this.processCellCallback=r,this.processHeaderCallback=n,this.processGroupHeaderCallback=o,this.processRowGroupCallback=a}prepare(e){this.groupColumns=e.filter(t=>!!t.getColDef().showRowGroup)}extractHeaderValue(e){const t=this.getHeaderName(this.processHeaderCallback,e);return t??""}extractRowCellValue(e,t,s,i,r){const o=(!this.gos.get("groupHideOpenParents")||r.footer)&&this.shouldRenderGroupSummaryCell(r,e,t)?this.createValueForGroupNode(e,r):this.valueService.getValue(e,r);return this.processCell({accumulatedRowIndex:s,rowNode:r,column:e,value:o,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,s){var i;if(!(e&&e.group))return!1;if(this.groupColumns.indexOf(t)!==-1){if(((i=e.groupData)==null?void 0:i[t.getId()])!=null||this.gos.isRowModelType("serverSide")&&e.group)return!0;if(e.footer&&e.level===-1){const a=t.getColDef();return a==null||a.showRowGroup===!0||a.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}const o=this.gos.isGroupUseEntireRow(this.columnModel.isPivotMode());return s===0&&o}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnModel.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const s=this.gos.get("treeData"),i=this.gos.get("suppressGroupMaintainValueType"),r=l=>{var u,h;if(s||i)return l.key;const p=(u=l.groupData)==null?void 0:u[e.getId()];return!p||!l.rowGroupColumn||l.rowGroupColumn.getColDef().useValueFormatterForExport===!1?p:(h=this.valueService.formatValue(l.rowGroupColumn,l,p))!=null?h:p},n=t.footer,o=[r(t)];if(!this.gos.isGroupMultiAutoColumn())for(;t.parent;)t=t.parent,o.push(r(t));const a=o.reverse().join(" -> ");return n?`Total ${a}`:a}processCell(e){var t;const{accumulatedRowIndex:s,rowNode:i,column:r,value:n,processCellCallback:o,type:a}=e;return o?{value:(t=o(this.gos.addGridCommonParams({accumulatedRowIndex:s,column:r,node:i,value:n,type:a,parseValue:l=>this.valueService.parseValue(r,i,l,this.valueService.getValue(r,i)),formatValue:l=>{var u;return(u=this.valueService.formatValue(r,i,l))!=null?u:l}})))!=null?t:""}:r.getColDef().useValueFormatterForExport!==!1?{value:n??"",valueFormatted:this.valueService.formatValue(r,i,n)}:{value:n??""}}},N2=class{static download(e,t){const s=document.defaultView||window;if(!s){console.warn("AG Grid: There is no `window` associated with the current `document`");return}const i=document.createElement("a"),r=s.URL.createObjectURL(t);i.setAttribute("href",r),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:s})),document.body.removeChild(i),s.setTimeout(()=>{s.URL.revokeObjectURL(r)},0)}},ME=`\r
`,I2=class extends F2{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:s}=e;this.suppressQuotes=t,this.columnSeparator=s}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,ME),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((s,i)=>{i!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(s.data.value||""),s.mergeAcross&&this.appendEmptyCells(s.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,s,i){s!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,s){var i;t!=0&&(this.result+=this.columnSeparator);const r=this.extractRowCellValue(e,t,t,"csv",s);this.result+=this.putInQuotes((i=r.valueFormatted)!=null?i:r.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(console.warn("AG Grid: unknown value type during csv conversion"),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=ME),this.isFirstLine=!1}},va=class extends A2{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration.");return}const t=this.getMergedParams(e),s=this.getData(t),i=new Blob(["\uFEFF",s],{type:"text/plain"}),r=typeof t.fileName=="function"?t.fileName(this.gos.getGridCommonParams()):t.fileName;N2.download(this.getFileName(r),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const s=t?Object.assign({},e):this.getMergedParams(e);return this.getData(s)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,valueService:s,gos:i}=this,{processCellCallback:r,processHeaderCallback:n,processGroupHeaderCallback:o,processRowGroupCallback:a,suppressQuotes:l,columnSeparator:u}=e;return new I2({columnModel:t,valueService:s,gos:i,processCellCallback:r||void 0,processHeaderCallback:n||void 0,processGroupHeaderCallback:o||void 0,processRowGroupCallback:a||void 0,suppressQuotes:l||!1,columnSeparator:u||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};tr([A("columnModel")],va.prototype,"columnModel",2);tr([A("valueService")],va.prototype,"valueService",2);tr([A("gridSerializer")],va.prototype,"gridSerializer",2);tr([A("gridOptionsService")],va.prototype,"gos",2);tr([xe],va.prototype,"postConstruct",1);va=tr([Le("csvCreator")],va);var jn=class extends Se{serialize(e,t={}){const{allColumns:s,columnKeys:i,skipRowGroups:r}=t,n=this.getColumnsToExport(s,r,i);return nt.compose(this.prepareSession(n),this.prependContent(t),this.exportColumnGroups(t,n),this.exportHeaders(t,n),this.processPinnedTopRows(t,n),this.processRows(t,n),this.processPinnedBottomRows(t,n),this.appendContent(t))(e).parse()}processRow(e,t,s,i){const r=t.shouldRowBeSkipped||(()=>!1),n=this.gos.get("groupRemoveSingleChildren"),o=this.gos.get("groupRemoveLowestSingleChildren"),l=t.rowPositions!=null||!!t.onlySelected,u=this.gos.get("groupHideOpenParents")&&!l,h=this.columnModel.isPivotMode()?i.leafGroup:!i.group,p=!!i.footer;t.skipRowGroups;const g=o&&i.leafGroup,m=i.allChildrenCount===1&&(n||g);if(!h&&!p&&(t.skipRowGroups||m||u)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&i.rowPinned==="top"||t.skipPinnedBottom&&i.rowPinned==="bottom"||i.level===-1&&!h&&!p||r(this.gos.addGridCommonParams({node:i})))return;const R=e.onNewBodyRow(i);if(s.forEach((x,S)=>{R.onColumn(x,S,i)}),t.getCustomContentBelowRow){const x=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:i}));x&&e.addCustomContent(x)}}appendContent(e){return t=>{const s=e.appendContent;return s&&t.addCustomContent(s),t}}prependContent(e){return t=>{const s=e.prependContent;return s&&t.addCustomContent(s),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return s=>{if(!e.skipColumnGroupHeaders){const i=new PA,r=this.displayedGroupCreator.createDisplayedGroups(t,i,null);this.recursivelyAddHeaderGroups(r,s,e.processGroupHeaderCallback)}return s}}exportHeaders(e,t){return s=>{if(!e.skipColumnHeaders){const i=s.onNewHeaderRow();t.forEach((r,n)=>{i.onColumn(r,n,void 0)})}return s}}processPinnedTopRows(e,t){return s=>{const i=this.processRow.bind(this,s,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="top").sort((r,n)=>r.rowIndex-n.rowIndex).map(r=>this.pinnedRowModel.getPinnedTopRow(r.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedTopRow(i),s}}processRows(e,t){return s=>{const i=this.rowModel,r=i.getType(),n=r==="clientSide",o=r==="serverSide",a=!n&&e.onlySelected,l=this.processRow.bind(this,s,e,t),{exportedRows:u="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(h=>h.rowPinned==null).sort((h,p)=>h.rowIndex-p.rowIndex).map(h=>i.getRow(h.rowIndex)).forEach(l);else if(this.columnModel.isPivotMode())n?i.forEachPivotNode(l,!0):o?i.forEachNodeAfterFilterAndSort(l,!0):i.forEachNode(l);else if(e.onlySelectedAllPages||a){const h=this.selectionService.getSelectedNodes();this.replicateSortedOrder(h),h.forEach(l)}else u==="all"?i.forEachNode(l):n||o?i.forEachNodeAfterFilterAndSort(l,!0):i.forEachNode(l);return s}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),s=(i,r)=>{var n,o,a,l;return i.rowIndex!=null&&r.rowIndex!=null?i.rowIndex-r.rowIndex:i.level===r.level?((n=i.parent)==null?void 0:n.id)===((o=r.parent)==null?void 0:o.id)?this.rowNodeSorter.compareRowNodes(t,{rowNode:i,currentPos:(a=i.rowIndex)!=null?a:-1},{rowNode:r,currentPos:(l=r.rowIndex)!=null?l:-1}):s(i.parent,r.parent):i.level>r.level?s(i.parent,r):s(i,r.parent)};e.sort(s)}processPinnedBottomRows(e,t){return s=>{const i=this.processRow.bind(this,s,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,n)=>r.rowIndex-n.rowIndex).map(r=>this.pinnedRowModel.getPinnedBottomRow(r.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedBottomRow(i),s}}getColumnsToExport(e=!1,t=!1,s){const i=this.columnModel.isPivotMode();if(s&&s.length)return this.columnModel.getGridColumns(s);const r=this.gos.get("treeData");let n=[];return e&&!i?n=this.columnModel.getAllGridColumns():n=this.columnModel.getAllDisplayedColumns(),t&&!r&&(n=n.filter(o=>o.getColId()!==Jc)),n}recursivelyAddHeaderGroups(e,t,s){const i=[];e.forEach(r=>{const n=r;n.getChildren&&n.getChildren().forEach(o=>i.push(o))}),e.length>0&&e[0]instanceof Ls&&this.doAddHeaderHeader(t,e,s),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,s)}doAddHeaderHeader(e,t,s){const i=e.onNewHeaderGroupingRow();let r=0;t.forEach(n=>{const o=n;let a;s?a=s(this.gos.addGridCommonParams({columnGroup:o})):a=this.columnModel.getDisplayNameForColumnGroup(o,"header");const l=o.getLeafColumns().reduce((u,h,p,g)=>{let m=nt.last(u);return h.getColumnGroupShow()==="open"?(!m||m[1]!=null)&&(m=[p],u.push(m)):m&&m[1]==null&&(m[1]=p-1),p===g.length-1&&m&&m[1]==null&&(m[1]=p),u},[]);i.onColumn(o,a||"",r++,o.getLeafColumns().length-1,l)})}};tr([A("displayedGroupCreator")],jn.prototype,"displayedGroupCreator",2);tr([A("columnModel")],jn.prototype,"columnModel",2);tr([A("rowModel")],jn.prototype,"rowModel",2);tr([A("pinnedRowModel")],jn.prototype,"pinnedRowModel",2);tr([A("selectionService")],jn.prototype,"selectionService",2);tr([A("rowNodeSorter")],jn.prototype,"rowNodeSorter",2);tr([A("sortController")],jn.prototype,"sortController",2);jn=tr([Le("gridSerializer")],jn);var _2="31.3.4",k2={version:_2,moduleName:"@ag-grid-community/csv-export",beans:[va,jn]},{utf8_encode:l6}=nt;Vt.__registerModules([w2,T2,k2],!1,void 0);var Lu={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VN=b;function wt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Oi=Object.prototype.hasOwnProperty,M2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,LE={},OE={};function BN(e){return Oi.call(OE,e)?!0:Oi.call(LE,e)?!1:M2.test(e)?OE[e]=!0:(LE[e]=!0,!1)}function _i(e,t,s,i,r,n,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=o}var si={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){si[e]=new _i(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];si[t]=new _i(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){si[e]=new _i(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){si[e]=new _i(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){si[e]=new _i(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){si[e]=new _i(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){si[e]=new _i(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){si[e]=new _i(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){si[e]=new _i(e,5,!1,e.toLowerCase(),null,!1,!1)});var q0=/[\-:]([a-z])/g;function Q0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(q0,Q0);si[t]=new _i(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(q0,Q0);si[t]=new _i(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(q0,Q0);si[t]=new _i(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){si[e]=new _i(e,1,!1,e.toLowerCase(),null,!1,!1)});si.xlinkHref=new _i("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){si[e]=new _i(e,1,!1,e.toLowerCase(),null,!0,!0)});var kg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},L2=["Webkit","ms","Moz","O"];Object.keys(kg).forEach(function(e){L2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),kg[t]=kg[e]})});var O2=/["'&<>]/;function Si(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=O2.exec(e);if(t){var s="",i,r=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==i&&(s+=e.substring(r,i)),r=i+1,s+=t}e=r!==i?s+e.substring(r,i):s}return e}var G2=/([A-Z])/g,V2=/^ms-/,vw=Array.isArray;function Kn(e,t){return{insertionMode:e,selectedValue:t}}function B2(e,t,s){switch(t){case"select":return Kn(1,s.value!=null?s.value:s.defaultValue);case"svg":return Kn(2,null);case"math":return Kn(3,null);case"foreignObject":return Kn(1,null);case"table":return Kn(4,null);case"thead":case"tbody":case"tfoot":return Kn(5,null);case"colgroup":return Kn(7,null);case"tr":return Kn(6,null)}return 4<=e.insertionMode||e.insertionMode===0?Kn(1,null):e}var GE=new Map;function HN(e,t,s){if(typeof s!="object")throw Error(wt(62));t=!0;for(var i in s)if(Oi.call(s,i)){var r=s[i];if(r!=null&&typeof r!="boolean"&&r!==""){if(i.indexOf("--")===0){var n=Si(i);r=Si((""+r).trim())}else{n=i;var o=GE.get(n);o!==void 0||(o=Si(n.replace(G2,"-$1").toLowerCase().replace(V2,"-ms-")),GE.set(n,o)),n=o,r=typeof r=="number"?r===0||Oi.call(kg,i)?""+r:r+"px":Si((""+r).trim())}t?(t=!1,e.push(' style="',n,":",r)):e.push(";",n,":",r)}}t||e.push('"')}function ir(e,t,s,i){switch(s){case"style":HN(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N"){if(t=si.hasOwnProperty(s)?si[s]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(s=t.attributeName,t.type){case 3:i&&e.push(" ",s,'=""');break;case 4:i===!0?e.push(" ",s,'=""'):i!==!1&&e.push(" ",s,'="',Si(i),'"');break;case 5:isNaN(i)||e.push(" ",s,'="',Si(i),'"');break;case 6:!isNaN(i)&&1<=i&&e.push(" ",s,'="',Si(i),'"');break;default:t.sanitizeURL&&(i=""+i),e.push(" ",s,'="',Si(i),'"')}}else if(BN(s)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=s.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(" ",s,'="',Si(i),'"')}}}function Mg(e,t,s){if(t!=null){if(s!=null)throw Error(wt(60));if(typeof t!="object"||!("__html"in t))throw Error(wt(61));t=t.__html,t!=null&&e.push(""+t)}}function H2(e){var t="";return VN.Children.forEach(e,function(s){s!=null&&(t+=s)}),t}function SC(e,t,s,i){e.push(xn(s));var r=s=null,n;for(n in t)if(Oi.call(t,n)){var o=t[n];if(o!=null)switch(n){case"children":s=o;break;case"dangerouslySetInnerHTML":r=o;break;default:ir(e,i,n,o)}}return e.push(">"),Mg(e,r,s),typeof s=="string"?(e.push(Si(s)),null):s}var j2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,VE=new Map;function xn(e){var t=VE.get(e);if(t===void 0){if(!j2.test(e))throw Error(wt(65,e));t="<"+e,VE.set(e,t)}return t}function W2(e,t,s,i,r){switch(t){case"select":e.push(xn("select"));var n=null,o=null;for(h in s)if(Oi.call(s,h)){var a=s[h];if(a!=null)switch(h){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"defaultValue":case"value":break;default:ir(e,i,h,a)}}return e.push(">"),Mg(e,o,n),n;case"option":o=r.selectedValue,e.push(xn("option"));var l=a=null,u=null,h=null;for(n in s)if(Oi.call(s,n)){var p=s[n];if(p!=null)switch(n){case"children":a=p;break;case"selected":u=p;break;case"dangerouslySetInnerHTML":h=p;break;case"value":l=p;default:ir(e,i,n,p)}}if(o!=null)if(s=l!==null?""+l:H2(a),vw(o)){for(i=0;i<o.length;i++)if(""+o[i]===s){e.push(' selected=""');break}}else""+o===s&&e.push(' selected=""');else u&&e.push(' selected=""');return e.push(">"),Mg(e,h,a),a;case"textarea":e.push(xn("textarea")),h=o=n=null;for(a in s)if(Oi.call(s,a)&&(l=s[a],l!=null))switch(a){case"children":h=l;break;case"value":n=l;break;case"defaultValue":o=l;break;case"dangerouslySetInnerHTML":throw Error(wt(91));default:ir(e,i,a,l)}if(n===null&&o!==null&&(n=o),e.push(">"),h!=null){if(n!=null)throw Error(wt(92));if(vw(h)&&1<h.length)throw Error(wt(93));n=""+h}return typeof n=="string"&&n[0]===`
`&&e.push(`
`),n!==null&&e.push(Si(""+n)),null;case"input":e.push(xn("input")),l=h=a=n=null;for(o in s)if(Oi.call(s,o)&&(u=s[o],u!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(wt(399,"input"));case"defaultChecked":l=u;break;case"defaultValue":a=u;break;case"checked":h=u;break;case"value":n=u;break;default:ir(e,i,o,u)}return h!==null?ir(e,i,"checked",h):l!==null&&ir(e,i,"checked",l),n!==null?ir(e,i,"value",n):a!==null&&ir(e,i,"value",a),e.push("/>"),null;case"menuitem":e.push(xn("menuitem"));for(var g in s)if(Oi.call(s,g)&&(n=s[g],n!=null))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(wt(400));default:ir(e,i,g,n)}return e.push(">"),null;case"title":e.push(xn("title")),n=null;for(p in s)if(Oi.call(s,p)&&(o=s[p],o!=null))switch(p){case"children":n=o;break;case"dangerouslySetInnerHTML":throw Error(wt(434));default:ir(e,i,p,o)}return e.push(">"),n;case"listing":case"pre":e.push(xn(t)),o=n=null;for(l in s)if(Oi.call(s,l)&&(a=s[l],a!=null))switch(l){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;default:ir(e,i,l,a)}if(e.push(">"),o!=null){if(n!=null)throw Error(wt(60));if(typeof o!="object"||!("__html"in o))throw Error(wt(61));s=o.__html,s!=null&&(typeof s=="string"&&0<s.length&&s[0]===`
`?e.push(`
`,s):e.push(""+s))}return typeof n=="string"&&n[0]===`
`&&e.push(`
`),n;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(xn(t));for(var m in s)if(Oi.call(s,m)&&(n=s[m],n!=null))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(wt(399,t));default:ir(e,i,m,n)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return SC(e,s,t,i);case"html":return r.insertionMode===0&&e.push("<!DOCTYPE html>"),SC(e,s,t,i);default:if(t.indexOf("-")===-1&&typeof s.is!="string")return SC(e,s,t,i);e.push(xn(t)),o=n=null;for(u in s)if(Oi.call(s,u)&&(a=s[u],a!=null))switch(u){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"style":HN(e,i,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:BN(u)&&typeof a!="function"&&typeof a!="symbol"&&e.push(" ",u,'="',Si(a),'"')}return e.push(">"),Mg(e,o,n),n}}function BE(e,t,s){if(e.push('<!--$?--><template id="'),s===null)throw Error(wt(395));return e.push(s),e.push('"></template>')}function z2(e,t,s,i){switch(s.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');default:throw Error(wt(397))}}function U2(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(wt(397))}}var $2=/[<\u2028\u2029]/g;function xC(e){return JSON.stringify(e).replace($2,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function K2(e,t){return t=t===void 0?"":t,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:t+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}function HE(e,t,s,i){return s.generateStaticMarkup?(e.push(Si(t)),!1):(t===""?e=i:(i&&e.push("<!-- -->"),e.push(Si(t)),e=!0),e)}var Gd=Object.assign,Y2=Symbol.for("react.element"),jN=Symbol.for("react.portal"),WN=Symbol.for("react.fragment"),zN=Symbol.for("react.strict_mode"),UN=Symbol.for("react.profiler"),$N=Symbol.for("react.provider"),KN=Symbol.for("react.context"),YN=Symbol.for("react.forward_ref"),qN=Symbol.for("react.suspense"),QN=Symbol.for("react.suspense_list"),ZN=Symbol.for("react.memo"),Z0=Symbol.for("react.lazy"),q2=Symbol.for("react.scope"),Q2=Symbol.for("react.debug_trace_mode"),Z2=Symbol.for("react.legacy_hidden"),J2=Symbol.for("react.default_value"),jE=Symbol.iterator;function Cw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case WN:return"Fragment";case jN:return"Portal";case UN:return"Profiler";case zN:return"StrictMode";case qN:return"Suspense";case QN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case KN:return(e.displayName||"Context")+".Consumer";case $N:return(e._context.displayName||"Context")+".Provider";case YN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ZN:return t=e.displayName||null,t!==null?t:Cw(e.type)||"Memo";case Z0:t=e._payload,e=e._init;try{return Cw(e(t))}catch{}}return null}var JN={};function WE(e,t){if(e=e.contextTypes,!e)return JN;var s={},i;for(i in e)s[i]=t[i];return s}var il=null;function hv(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var s=t.parent;if(e===null){if(s!==null)throw Error(wt(401))}else{if(s===null)throw Error(wt(401));hv(e,s)}t.context._currentValue2=t.value}}function XN(e){e.context._currentValue2=e.parentValue,e=e.parent,e!==null&&XN(e)}function eI(e){var t=e.parent;t!==null&&eI(t),e.context._currentValue2=e.value}function tI(e,t){if(e.context._currentValue2=e.parentValue,e=e.parent,e===null)throw Error(wt(402));e.depth===t.depth?hv(e,t):tI(e,t)}function sI(e,t){var s=t.parent;if(s===null)throw Error(wt(402));e.depth===s.depth?hv(e,s):sI(e,s),t.context._currentValue2=t.value}function Bf(e){var t=il;t!==e&&(t===null?eI(e):e===null?XN(t):t.depth===e.depth?hv(t,e):t.depth>e.depth?tI(t,e):sI(t,e),il=e)}var zE={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function UE(e,t,s,i){var r=e.state!==void 0?e.state:null;e.updater=zE,e.props=s,e.state=r;var n={queue:[],replace:!1};e._reactInternals=n;var o=t.contextType;if(e.context=typeof o=="object"&&o!==null?o._currentValue2:i,o=t.getDerivedStateFromProps,typeof o=="function"&&(o=o(s,r),r=o==null?r:Gd({},r,o),e.state=r),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&zE.enqueueReplaceState(e,e.state,null),n.queue!==null&&0<n.queue.length)if(t=n.queue,o=n.replace,n.queue=null,n.replace=!1,o&&t.length===1)e.state=t[0];else{for(n=o?t[0]:e.state,r=!0,o=o?1:0;o<t.length;o++){var a=t[o];a=typeof a=="function"?a.call(e,n,s,i):a,a!=null&&(r?(r=!1,n=Gd({},n,a)):Gd(n,a))}e.state=n}else n.queue=null}var X2={id:1,overflow:""};function yw(e,t,s){var i=e.id;e=e.overflow;var r=32-Lg(i)-1;i&=~(1<<r),s+=1;var n=32-Lg(t)+r;if(30<n){var o=r-r%5;return n=(i&(1<<o)-1).toString(32),i>>=o,r-=o,{id:1<<32-Lg(t)+r|s<<r|i,overflow:n+e}}return{id:1<<n|s<<r|i,overflow:e}}var Lg=Math.clz32?Math.clz32:sV,eV=Math.log,tV=Math.LN2;function sV(e){return e>>>=0,e===0?32:31-(eV(e)/tV|0)|0}function iV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rV=typeof Object.is=="function"?Object.is:iV,ho=null,J0=null,Og=null,ts=null,wd=!1,Hf=!1,kh=0,qo=null,pv=0;function Ka(){if(ho===null)throw Error(wt(321));return ho}function $E(){if(0<pv)throw Error(wt(312));return{memoizedState:null,queue:null,next:null}}function X0(){return ts===null?Og===null?(wd=!1,Og=ts=$E()):(wd=!0,ts=Og):ts.next===null?(wd=!1,ts=ts.next=$E()):(wd=!0,ts=ts.next),ts}function ex(){J0=ho=null,Hf=!1,Og=null,pv=0,ts=qo=null}function iI(e,t){return typeof t=="function"?t(e):t}function KE(e,t,s){if(ho=Ka(),ts=X0(),wd){var i=ts.queue;if(t=i.dispatch,qo!==null&&(s=qo.get(i),s!==void 0)){qo.delete(i),i=ts.memoizedState;do i=e(i,s.action),s=s.next;while(s!==null);return ts.memoizedState=i,[i,t]}return[ts.memoizedState,t]}return e=e===iI?typeof t=="function"?t():t:s!==void 0?s(t):t,ts.memoizedState=e,e=ts.queue={last:null,dispatch:null},e=e.dispatch=nV.bind(null,ho,e),[ts.memoizedState,e]}function YE(e,t){if(ho=Ka(),ts=X0(),t=t===void 0?null:t,ts!==null){var s=ts.memoizedState;if(s!==null&&t!==null){var i=s[1];e:if(i===null)i=!1;else{for(var r=0;r<i.length&&r<t.length;r++)if(!rV(t[r],i[r])){i=!1;break e}i=!0}if(i)return s[0]}}return e=e(),ts.memoizedState=[e,t],e}function nV(e,t,s){if(25<=pv)throw Error(wt(301));if(e===ho)if(Hf=!0,e={action:s,next:null},qo===null&&(qo=new Map),s=qo.get(t),s===void 0)qo.set(t,e);else{for(t=s;t.next!==null;)t=t.next;t.next=e}}function oV(){throw Error(wt(394))}function lg(){}var qE={readContext:function(e){return e._currentValue2},useContext:function(e){return Ka(),e._currentValue2},useMemo:YE,useReducer:KE,useRef:function(e){ho=Ka(),ts=X0();var t=ts.memoizedState;return t===null?(e={current:e},ts.memoizedState=e):t},useState:function(e){return KE(iI,e)},useInsertionEffect:lg,useLayoutEffect:function(){},useCallback:function(e,t){return YE(function(){return e},t)},useImperativeHandle:lg,useEffect:lg,useDebugValue:lg,useDeferredValue:function(e){return Ka(),e},useTransition:function(){return Ka(),[!1,oV]},useId:function(){var e=J0.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Lg(e)-1)).toString(32)+t;var s=Gg;if(s===null)throw Error(wt(404));return t=kh++,e=":"+s.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Ka(),t(e._source)},useSyncExternalStore:function(e,t,s){if(s===void 0)throw Error(wt(407));return s()}},Gg=null,bC=VN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function aV(e){return console.error(e),null}function Sd(){}function lV(e,t,s,i,r,n,o,a,l){var u=[],h=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:h,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:r===void 0?aV:r,onAllReady:Sd,onShellReady:o===void 0?Sd:o,onShellError:Sd,onFatalError:Sd},s=jf(t,0,null,s,!1,!1),s.parentFlushed=!0,e=tx(t,e,null,s,h,JN,null,X2),u.push(e),t}function tx(e,t,s,i,r,n,o,a){e.allPendingTasks++,s===null?e.pendingRootTasks++:s.pendingTasks++;var l={node:t,ping:function(){var u=e.pingedTasks;u.push(l),u.length===1&&oI(e)},blockedBoundary:s,blockedSegment:i,abortSet:r,legacyContext:n,context:o,treeContext:a};return r.add(l),l}function jf(e,t,s,i,r,n){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:s,lastPushedText:r,textEmbedded:n}}function Mh(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function Wf(e,t){var s=e.onShellError;s(t),s=e.onFatalError,s(t),e.destination!==null?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function QE(e,t,s,i,r){for(ho={},J0=t,kh=0,e=s(i,r);Hf;)Hf=!1,kh=0,pv+=1,ts=null,e=s(i,r);return ex(),e}function ZE(e,t,s,i){var r=s.render(),n=i.childContextTypes;if(n!=null){var o=t.legacyContext;if(typeof s.getChildContext!="function")i=o;else{s=s.getChildContext();for(var a in s)if(!(a in n))throw Error(wt(108,Cw(i)||"Unknown",a));i=Gd({},o,s)}t.legacyContext=i,or(e,t,r),t.legacyContext=o}else or(e,t,r)}function JE(e,t){if(e&&e.defaultProps){t=Gd({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function ww(e,t,s,i,r){if(typeof s=="function")if(s.prototype&&s.prototype.isReactComponent){r=WE(s,t.legacyContext);var n=s.contextType;n=new s(i,typeof n=="object"&&n!==null?n._currentValue2:r),UE(n,s,i,r),ZE(e,t,n,s)}else{n=WE(s,t.legacyContext),r=QE(e,t,s,i,n);var o=kh!==0;if(typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0)UE(r,s,i,n),ZE(e,t,r,s);else if(o){i=t.treeContext,t.treeContext=yw(i,1,0);try{or(e,t,r)}finally{t.treeContext=i}}else or(e,t,r)}else if(typeof s=="string"){switch(r=t.blockedSegment,n=W2(r.chunks,s,i,e.responseState,r.formatContext),r.lastPushedText=!1,o=r.formatContext,r.formatContext=B2(o,s,i),Sw(e,t,n),r.formatContext=o,s){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:r.chunks.push("</",s,">")}r.lastPushedText=!1}else{switch(s){case Z2:case Q2:case zN:case UN:case WN:or(e,t,i.children);return;case QN:or(e,t,i.children);return;case q2:throw Error(wt(343));case qN:e:{s=t.blockedBoundary,r=t.blockedSegment,n=i.fallback,i=i.children,o=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},l=jf(e,r.chunks.length,a,r.formatContext,!1,!1);r.children.push(l),r.lastPushedText=!1;var u=jf(e,0,null,r.formatContext,!1,!1);u.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=u;try{if(Sw(e,t,i),e.responseState.generateStaticMarkup||u.lastPushedText&&u.textEmbedded&&u.chunks.push("<!-- -->"),u.status=1,zf(a,u),a.pendingTasks===0)break e}catch(h){u.status=4,a.forceClientRender=!0,a.errorDigest=Mh(e,h)}finally{t.blockedBoundary=s,t.blockedSegment=r}t=tx(e,n,s,l,o,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof s=="object"&&s!==null)switch(s.$$typeof){case YN:if(i=QE(e,t,s.render,i,r),kh!==0){s=t.treeContext,t.treeContext=yw(s,1,0);try{or(e,t,i)}finally{t.treeContext=s}}else or(e,t,i);return;case ZN:s=s.type,i=JE(s,i),ww(e,t,s,i,r);return;case $N:if(r=i.children,s=s._context,i=i.value,n=s._currentValue2,s._currentValue2=i,o=il,il=i={parent:o,depth:o===null?0:o.depth+1,context:s,parentValue:n,value:i},t.context=i,or(e,t,r),e=il,e===null)throw Error(wt(403));i=e.parentValue,e.context._currentValue2=i===J2?e.context._defaultValue:i,e=il=e.parent,t.context=e;return;case KN:i=i.children,i=i(s._currentValue2),or(e,t,i);return;case Z0:r=s._init,s=r(s._payload),i=JE(s,i),ww(e,t,s,i,void 0);return}throw Error(wt(130,s==null?s:typeof s,""))}}function or(e,t,s){if(t.node=s,typeof s=="object"&&s!==null){switch(s.$$typeof){case Y2:ww(e,t,s.type,s.props,s.ref);return;case jN:throw Error(wt(257));case Z0:var i=s._init;s=i(s._payload),or(e,t,s);return}if(vw(s)){XE(e,t,s);return}if(s===null||typeof s!="object"?i=null:(i=jE&&s[jE]||s["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(s))){if(s=i.next(),!s.done){var r=[];do r.push(s.value),s=i.next();while(!s.done);XE(e,t,r)}return}throw e=Object.prototype.toString.call(s),Error(wt(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}typeof s=="string"?(i=t.blockedSegment,i.lastPushedText=HE(t.blockedSegment.chunks,s,e.responseState,i.lastPushedText)):typeof s=="number"&&(i=t.blockedSegment,i.lastPushedText=HE(t.blockedSegment.chunks,""+s,e.responseState,i.lastPushedText))}function XE(e,t,s){for(var i=s.length,r=0;r<i;r++){var n=t.treeContext;t.treeContext=yw(n,i,r);try{Sw(e,t,s[r])}finally{t.treeContext=n}}}function Sw(e,t,s){var i=t.blockedSegment.formatContext,r=t.legacyContext,n=t.context;try{return or(e,t,s)}catch(l){if(ex(),typeof l=="object"&&l!==null&&typeof l.then=="function"){s=l;var o=t.blockedSegment,a=jf(e,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(a),o.lastPushedText=!1,e=tx(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,s.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Bf(n)}else throw t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Bf(n),l}}function cV(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,nI(this,t,e)}function rI(e,t,s){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.push(null))):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=s===void 0?Error(wt(432)):s,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(r){return rI(r,t,s)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function zf(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var s=t.children[0];s.id=t.id,s.parentFlushed=!0,s.status===1&&zf(e,s)}else e.completedSegments.push(t)}function nI(e,t,s){if(t===null){if(s.parentFlushed){if(e.completedRootSegment!==null)throw Error(wt(389));e.completedRootSegment=s}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Sd,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(s.parentFlushed&&s.status===1&&zf(t,s),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(cV,e),t.fallbackAbortableTasks.clear()):s.parentFlushed&&s.status===1&&(zf(t,s),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function oI(e){if(e.status!==2){var t=il,s=bC.current;bC.current=qE;var i=Gg;Gg=e.responseState;try{var r=e.pingedTasks,n;for(n=0;n<r.length;n++){var o=r[n],a=e,l=o.blockedSegment;if(l.status===0){Bf(o.context);try{or(a,o,o.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),o.abortSet.delete(o),l.status=1,nI(a,o.blockedBoundary,l)}catch(C){if(ex(),typeof C=="object"&&C!==null&&typeof C.then=="function"){var u=o.ping;C.then(u,u)}else{o.abortSet.delete(o),l.status=4;var h=o.blockedBoundary,p=C,g=Mh(a,p);if(h===null?Wf(a,p):(h.pendingTasks--,h.forceClientRender||(h.forceClientRender=!0,h.errorDigest=g,h.parentFlushed&&a.clientRenderedBoundaries.push(h))),a.allPendingTasks--,a.allPendingTasks===0){var m=a.onAllReady;m()}}}finally{}}}r.splice(0,n),e.destination!==null&&sx(e,e.destination)}catch(C){Mh(e,C),Wf(e,C)}finally{Gg=i,bC.current=s,s===qE&&Bf(t)}}}function cg(e,t,s){switch(s.parentFlushed=!0,s.status){case 0:var i=s.id=e.nextSegmentId++;return s.lastPushedText=!1,s.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=i.toString(16),t.push(e),t.push('"></template>');case 1:s.status=2;var r=!0;i=s.chunks;var n=0;s=s.children;for(var o=0;o<s.length;o++){for(r=s[o];n<r.index;n++)t.push(i[n]);r=gv(e,t,r)}for(;n<i.length-1;n++)t.push(i[n]);return n<i.length&&(r=t.push(i[n])),r;default:throw Error(wt(390))}}function gv(e,t,s){var i=s.boundary;if(i===null)return cg(e,t,s);if(i.parentFlushed=!0,i.forceClientRender)return e.responseState.generateStaticMarkup||(i=i.errorDigest,t.push("<!--$!-->"),t.push("<template"),i&&(t.push(' data-dgst="'),i=Si(i),t.push(i),t.push('"')),t.push("></template>")),cg(e,t,s),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e;if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var r=e.responseState,n=r.nextSuspenseID++;return r=r.boundaryPrefix+n.toString(16),i=i.id=r,BE(t,e.responseState,i),cg(e,t,s),t.push("<!--/$-->")}if(i.byteSize>e.progressiveChunkSize)return i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),BE(t,e.responseState,i.id),cg(e,t,s),t.push("<!--/$-->");if(e.responseState.generateStaticMarkup||t.push("<!--$-->"),s=i.completedSegments,s.length!==1)throw Error(wt(391));return gv(e,t,s[0]),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e}function eR(e,t,s){return z2(t,e.responseState,s.formatContext,s.id),gv(e,t,s),U2(t,s.formatContext)}function tR(e,t,s){for(var i=s.completedSegments,r=0;r<i.length;r++)aI(e,t,s,i[r]);if(i.length=0,e=e.responseState,i=s.id,s=s.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),i===null)throw Error(wt(395));return s=s.toString(16),t.push(i),t.push('","'),t.push(e.segmentPrefix),t.push(s),t.push('")<\/script>')}function aI(e,t,s,i){if(i.status===2)return!0;var r=i.id;if(r===-1){if((i.id=s.rootSegmentID)===-1)throw Error(wt(392));return eR(e,t,i)}return eR(e,t,i),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),r=r.toString(16),t.push(r),t.push('","'),t.push(e.placeholderPrefix),t.push(r),t.push('")<\/script>')}function sx(e,t){try{var s=e.completedRootSegment;if(s!==null&&e.pendingRootTasks===0){gv(e,t,s),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(s=0;s<i.length-1;s++)t.push(i[s]);s<i.length&&t.push(i[s])}var r=e.clientRenderedBoundaries,n;for(n=0;n<r.length;n++){var o=r[n];i=t;var a=e.responseState,l=o.id,u=o.errorDigest,h=o.errorMessage,p=o.errorComponentStack;if(i.push(a.startInlineScript),a.sentClientRenderFunction?i.push('$RX("'):(a.sentClientRenderFunction=!0,i.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(wt(395));if(i.push(l),i.push('"'),u||h||p){i.push(",");var g=xC(u||"");i.push(g)}if(h||p){i.push(",");var m=xC(h||"");i.push(m)}if(p){i.push(",");var C=xC(p);i.push(C)}if(!i.push(")<\/script>")){e.destination=null,n++,r.splice(0,n);return}}r.splice(0,n);var y=e.completedBoundaries;for(n=0;n<y.length;n++)if(!tR(e,t,y[n])){e.destination=null,n++,y.splice(0,n);return}y.splice(0,n);var R=e.partialBoundaries;for(n=0;n<R.length;n++){var x=R[n];e:{r=e,o=t;var S=x.completedSegments;for(a=0;a<S.length;a++)if(!aI(r,o,x,S[a])){a++,S.splice(0,a);var T=!1;break e}S.splice(0,a),T=!0}if(!T){e.destination=null,n++,R.splice(0,n);return}}R.splice(0,n);var I=e.completedBoundaries;for(n=0;n<I.length;n++)if(!tR(e,t,I[n])){e.destination=null,n++,I.splice(0,n);return}I.splice(0,n)}finally{e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.push(null)}}function uV(e,t){try{var s=e.abortableTasks;s.forEach(function(i){return rI(i,e,t)}),s.clear(),e.destination!==null&&sx(e,e.destination)}catch(i){Mh(e,i),Wf(e,i)}}function dV(){}function lI(e,t,s,i){var r=!1,n=null,o="",a={push:function(u){return u!==null&&(o+=u),!0},destroy:function(u){r=!0,n=u}},l=!1;if(e=lV(e,K2(s,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,dV,void 0,function(){l=!0}),oI(e),uV(e,i),e.status===1)e.status=2,a.destroy(e.fatalError);else if(e.status!==2&&e.destination===null){e.destination=a;try{sx(e,a)}catch(u){Mh(e,u),Wf(e,u)}}if(r)throw n;if(!l)throw Error(wt(426));return o}Lu.renderToNodeStream=function(){throw Error(wt(207))};Lu.renderToStaticMarkup=function(e,t){return lI(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Lu.renderToStaticNodeStream=function(){throw Error(wt(208))};Lu.renderToString=function(e,t){return lI(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Lu.version="18.3.1";var ix={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cI=b;function Tt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ar=null,lr=0;function it(e,t){if(t.length!==0)if(512<t.length)0<lr&&(e.enqueue(new Uint8Array(ar.buffer,0,lr)),ar=new Uint8Array(512),lr=0),e.enqueue(t);else{var s=ar.length-lr;s<t.length&&(s===0?e.enqueue(ar):(ar.set(t.subarray(0,s),lr),e.enqueue(ar),t=t.subarray(s)),ar=new Uint8Array(512),lr=0),ar.set(t,lr),lr+=t.length}}function as(e,t){return it(e,t),!0}function sR(e){ar&&0<lr&&(e.enqueue(new Uint8Array(ar.buffer,0,lr)),ar=null,lr=0)}var uI=new TextEncoder;function Ft(e){return uI.encode(e)}function je(e){return uI.encode(e)}function dI(e,t){typeof e.error=="function"?e.error(t):e.close()}var Gi=Object.prototype.hasOwnProperty,hV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iR={},rR={};function hI(e){return Gi.call(rR,e)?!0:Gi.call(iR,e)?!1:hV.test(e)?rR[e]=!0:(iR[e]=!0,!1)}function ki(e,t,s,i,r,n,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=o}var ii={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ii[e]=new ki(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ii[t]=new ki(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ii[e]=new ki(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ii[e]=new ki(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ii[e]=new ki(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ii[e]=new ki(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ii[e]=new ki(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ii[e]=new ki(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ii[e]=new ki(e,5,!1,e.toLowerCase(),null,!1,!1)});var rx=/[\-:]([a-z])/g;function nx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(rx,nx);ii[t]=new ki(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(rx,nx);ii[t]=new ki(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(rx,nx);ii[t]=new ki(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ii[e]=new ki(e,1,!1,e.toLowerCase(),null,!1,!1)});ii.xlinkHref=new ki("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ii[e]=new ki(e,1,!1,e.toLowerCase(),null,!0,!0)});var Vg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pV=["Webkit","ms","Moz","O"];Object.keys(Vg).forEach(function(e){pV.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Vg[t]=Vg[e]})});var gV=/["'&<>]/;function Js(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=gV.exec(e);if(t){var s="",i,r=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==i&&(s+=e.substring(r,i)),r=i+1,s+=t}e=r!==i?s+e.substring(r,i):s}return e}var fV=/([A-Z])/g,mV=/^ms-/,xw=Array.isArray,vV=je("<script>"),CV=je("<\/script>"),yV=je('<script src="'),wV=je('<script type="module" src="'),nR=je('" async=""><\/script>'),SV=/(<\/|<)(s)(cript)/gi;function xV(e,t,s,i){return""+t+(s==="s"?"\\u0073":"\\u0053")+i}function bV(e,t,s,i,r){e=e===void 0?"":e,t=t===void 0?vV:je('<script nonce="'+Js(t)+'">');var n=[];if(s!==void 0&&n.push(t,Ft((""+s).replace(SV,xV)),CV),i!==void 0)for(s=0;s<i.length;s++)n.push(yV,Ft(Js(i[s])),nR);if(r!==void 0)for(i=0;i<r.length;i++)n.push(wV,Ft(Js(r[i])),nR);return{bootstrapChunks:n,startInlineScript:t,placeholderPrefix:je(e+"P:"),segmentPrefix:je(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function bn(e,t){return{insertionMode:e,selectedValue:t}}function EV(e){return bn(e==="http://www.w3.org/2000/svg"?2:e==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function RV(e,t,s){switch(t){case"select":return bn(1,s.value!=null?s.value:s.defaultValue);case"svg":return bn(2,null);case"math":return bn(3,null);case"foreignObject":return bn(1,null);case"table":return bn(4,null);case"thead":case"tbody":case"tfoot":return bn(5,null);case"colgroup":return bn(7,null);case"tr":return bn(6,null)}return 4<=e.insertionMode||e.insertionMode===0?bn(1,null):e}var ox=je("<!-- -->");function oR(e,t,s,i){return t===""?i:(i&&e.push(ox),e.push(Ft(Js(t))),!0)}var aR=new Map,TV=je(' style="'),lR=je(":"),DV=je(";");function pI(e,t,s){if(typeof s!="object")throw Error(Tt(62));t=!0;for(var i in s)if(Gi.call(s,i)){var r=s[i];if(r!=null&&typeof r!="boolean"&&r!==""){if(i.indexOf("--")===0){var n=Ft(Js(i));r=Ft(Js((""+r).trim()))}else{n=i;var o=aR.get(n);o!==void 0||(o=je(Js(n.replace(fV,"-$1").toLowerCase().replace(mV,"-ms-"))),aR.set(n,o)),n=o,r=typeof r=="number"?r===0||Gi.call(Vg,i)?Ft(""+r):Ft(r+"px"):Ft(Js((""+r).trim()))}t?(t=!1,e.push(TV,n,lR,r)):e.push(DV,n,lR,r)}}t||e.push(Ya)}var _o=je(" "),lc=je('="'),Ya=je('"'),cR=je('=""');function rr(e,t,s,i){switch(s){case"style":pI(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N"){if(t=ii.hasOwnProperty(s)?ii[s]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(s=Ft(t.attributeName),t.type){case 3:i&&e.push(_o,s,cR);break;case 4:i===!0?e.push(_o,s,cR):i!==!1&&e.push(_o,s,lc,Ft(Js(i)),Ya);break;case 5:isNaN(i)||e.push(_o,s,lc,Ft(Js(i)),Ya);break;case 6:!isNaN(i)&&1<=i&&e.push(_o,s,lc,Ft(Js(i)),Ya);break;default:t.sanitizeURL&&(i=""+i),e.push(_o,s,lc,Ft(Js(i)),Ya)}}else if(hI(s)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=s.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(_o,Ft(s),lc,Ft(Js(i)),Ya)}}}var ko=je(">"),uR=je("/>");function Bg(e,t,s){if(t!=null){if(s!=null)throw Error(Tt(60));if(typeof t!="object"||!("__html"in t))throw Error(Tt(61));t=t.__html,t!=null&&e.push(Ft(""+t))}}function PV(e){var t="";return cI.Children.forEach(e,function(s){s!=null&&(t+=s)}),t}var EC=je(' selected=""');function RC(e,t,s,i){e.push(En(s));var r=s=null,n;for(n in t)if(Gi.call(t,n)){var o=t[n];if(o!=null)switch(n){case"children":s=o;break;case"dangerouslySetInnerHTML":r=o;break;default:rr(e,i,n,o)}}return e.push(ko),Bg(e,r,s),typeof s=="string"?(e.push(Ft(Js(s))),null):s}var TC=je(`
`),AV=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,dR=new Map;function En(e){var t=dR.get(e);if(t===void 0){if(!AV.test(e))throw Error(Tt(65,e));t=je("<"+e),dR.set(e,t)}return t}var FV=je("<!DOCTYPE html>");function NV(e,t,s,i,r){switch(t){case"select":e.push(En("select"));var n=null,o=null;for(h in s)if(Gi.call(s,h)){var a=s[h];if(a!=null)switch(h){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"defaultValue":case"value":break;default:rr(e,i,h,a)}}return e.push(ko),Bg(e,o,n),n;case"option":o=r.selectedValue,e.push(En("option"));var l=a=null,u=null,h=null;for(n in s)if(Gi.call(s,n)){var p=s[n];if(p!=null)switch(n){case"children":a=p;break;case"selected":u=p;break;case"dangerouslySetInnerHTML":h=p;break;case"value":l=p;default:rr(e,i,n,p)}}if(o!=null)if(s=l!==null?""+l:PV(a),xw(o)){for(i=0;i<o.length;i++)if(""+o[i]===s){e.push(EC);break}}else""+o===s&&e.push(EC);else u&&e.push(EC);return e.push(ko),Bg(e,h,a),a;case"textarea":e.push(En("textarea")),h=o=n=null;for(a in s)if(Gi.call(s,a)&&(l=s[a],l!=null))switch(a){case"children":h=l;break;case"value":n=l;break;case"defaultValue":o=l;break;case"dangerouslySetInnerHTML":throw Error(Tt(91));default:rr(e,i,a,l)}if(n===null&&o!==null&&(n=o),e.push(ko),h!=null){if(n!=null)throw Error(Tt(92));if(xw(h)&&1<h.length)throw Error(Tt(93));n=""+h}return typeof n=="string"&&n[0]===`
`&&e.push(TC),n!==null&&e.push(Ft(Js(""+n))),null;case"input":e.push(En("input")),l=h=a=n=null;for(o in s)if(Gi.call(s,o)&&(u=s[o],u!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(Tt(399,"input"));case"defaultChecked":l=u;break;case"defaultValue":a=u;break;case"checked":h=u;break;case"value":n=u;break;default:rr(e,i,o,u)}return h!==null?rr(e,i,"checked",h):l!==null&&rr(e,i,"checked",l),n!==null?rr(e,i,"value",n):a!==null&&rr(e,i,"value",a),e.push(uR),null;case"menuitem":e.push(En("menuitem"));for(var g in s)if(Gi.call(s,g)&&(n=s[g],n!=null))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(Tt(400));default:rr(e,i,g,n)}return e.push(ko),null;case"title":e.push(En("title")),n=null;for(p in s)if(Gi.call(s,p)&&(o=s[p],o!=null))switch(p){case"children":n=o;break;case"dangerouslySetInnerHTML":throw Error(Tt(434));default:rr(e,i,p,o)}return e.push(ko),n;case"listing":case"pre":e.push(En(t)),o=n=null;for(l in s)if(Gi.call(s,l)&&(a=s[l],a!=null))switch(l){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;default:rr(e,i,l,a)}if(e.push(ko),o!=null){if(n!=null)throw Error(Tt(60));if(typeof o!="object"||!("__html"in o))throw Error(Tt(61));s=o.__html,s!=null&&(typeof s=="string"&&0<s.length&&s[0]===`
`?e.push(TC,Ft(s)):e.push(Ft(""+s)))}return typeof n=="string"&&n[0]===`
`&&e.push(TC),n;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(En(t));for(var m in s)if(Gi.call(s,m)&&(n=s[m],n!=null))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(Tt(399,t));default:rr(e,i,m,n)}return e.push(uR),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return RC(e,s,t,i);case"html":return r.insertionMode===0&&e.push(FV),RC(e,s,t,i);default:if(t.indexOf("-")===-1&&typeof s.is!="string")return RC(e,s,t,i);e.push(En(t)),o=n=null;for(u in s)if(Gi.call(s,u)&&(a=s[u],a!=null))switch(u){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"style":pI(e,i,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:hI(u)&&typeof a!="function"&&typeof a!="symbol"&&e.push(_o,Ft(u),lc,Ft(Js(a)),Ya)}return e.push(ko),Bg(e,o,n),n}}var IV=je("</"),_V=je(">"),kV=je('<template id="'),MV=je('"></template>'),LV=je("<!--$-->"),OV=je('<!--$?--><template id="'),GV=je('"></template>'),VV=je("<!--$!-->"),BV=je("<!--/$-->"),HV=je("<template"),jV=je('"'),WV=je(' data-dgst="');je(' data-msg="');je(' data-stck="');var zV=je("></template>");function hR(e,t,s){if(it(e,OV),s===null)throw Error(Tt(395));return it(e,s),as(e,GV)}var UV=je('<div hidden id="'),$V=je('">'),KV=je("</div>"),YV=je('<svg aria-hidden="true" style="display:none" id="'),qV=je('">'),QV=je("</svg>"),ZV=je('<math aria-hidden="true" style="display:none" id="'),JV=je('">'),XV=je("</math>"),eB=je('<table hidden id="'),tB=je('">'),sB=je("</table>"),iB=je('<table hidden><tbody id="'),rB=je('">'),nB=je("</tbody></table>"),oB=je('<table hidden><tr id="'),aB=je('">'),lB=je("</tr></table>"),cB=je('<table hidden><colgroup id="'),uB=je('">'),dB=je("</colgroup></table>");function hB(e,t,s,i){switch(s.insertionMode){case 0:case 1:return it(e,UV),it(e,t.segmentPrefix),it(e,Ft(i.toString(16))),as(e,$V);case 2:return it(e,YV),it(e,t.segmentPrefix),it(e,Ft(i.toString(16))),as(e,qV);case 3:return it(e,ZV),it(e,t.segmentPrefix),it(e,Ft(i.toString(16))),as(e,JV);case 4:return it(e,eB),it(e,t.segmentPrefix),it(e,Ft(i.toString(16))),as(e,tB);case 5:return it(e,iB),it(e,t.segmentPrefix),it(e,Ft(i.toString(16))),as(e,rB);case 6:return it(e,oB),it(e,t.segmentPrefix),it(e,Ft(i.toString(16))),as(e,aB);case 7:return it(e,cB),it(e,t.segmentPrefix),it(e,Ft(i.toString(16))),as(e,uB);default:throw Error(Tt(397))}}function pB(e,t){switch(t.insertionMode){case 0:case 1:return as(e,KV);case 2:return as(e,QV);case 3:return as(e,XV);case 4:return as(e,sB);case 5:return as(e,nB);case 6:return as(e,lB);case 7:return as(e,dB);default:throw Error(Tt(397))}}var gB=je('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),fB=je('$RS("'),mB=je('","'),vB=je('")<\/script>'),CB=je('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),yB=je('$RC("'),wB=je('","'),SB=je('")<\/script>'),xB=je('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),bB=je('$RX("'),EB=je('"'),RB=je(")<\/script>"),DC=je(","),TB=/[<\u2028\u2029]/g;function PC(e){return JSON.stringify(e).replace(TB,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Vd=Object.assign,DB=Symbol.for("react.element"),gI=Symbol.for("react.portal"),fI=Symbol.for("react.fragment"),mI=Symbol.for("react.strict_mode"),vI=Symbol.for("react.profiler"),CI=Symbol.for("react.provider"),yI=Symbol.for("react.context"),wI=Symbol.for("react.forward_ref"),SI=Symbol.for("react.suspense"),xI=Symbol.for("react.suspense_list"),bI=Symbol.for("react.memo"),ax=Symbol.for("react.lazy"),PB=Symbol.for("react.scope"),AB=Symbol.for("react.debug_trace_mode"),FB=Symbol.for("react.legacy_hidden"),NB=Symbol.for("react.default_value"),pR=Symbol.iterator;function bw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case fI:return"Fragment";case gI:return"Portal";case vI:return"Profiler";case mI:return"StrictMode";case SI:return"Suspense";case xI:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case yI:return(e.displayName||"Context")+".Consumer";case CI:return(e._context.displayName||"Context")+".Provider";case wI:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case bI:return t=e.displayName||null,t!==null?t:bw(e.type)||"Memo";case ax:t=e._payload,e=e._init;try{return bw(e(t))}catch{}}return null}var EI={};function gR(e,t){if(e=e.contextTypes,!e)return EI;var s={},i;for(i in e)s[i]=t[i];return s}var rl=null;function fv(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var s=t.parent;if(e===null){if(s!==null)throw Error(Tt(401))}else{if(s===null)throw Error(Tt(401));fv(e,s)}t.context._currentValue=t.value}}function RI(e){e.context._currentValue=e.parentValue,e=e.parent,e!==null&&RI(e)}function TI(e){var t=e.parent;t!==null&&TI(t),e.context._currentValue=e.value}function DI(e,t){if(e.context._currentValue=e.parentValue,e=e.parent,e===null)throw Error(Tt(402));e.depth===t.depth?fv(e,t):DI(e,t)}function PI(e,t){var s=t.parent;if(s===null)throw Error(Tt(402));e.depth===s.depth?fv(e,s):PI(e,s),t.context._currentValue=t.value}function Uf(e){var t=rl;t!==e&&(t===null?TI(e):e===null?RI(t):t.depth===e.depth?fv(t,e):t.depth>e.depth?DI(t,e):PI(t,e),rl=e)}var fR={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function mR(e,t,s,i){var r=e.state!==void 0?e.state:null;e.updater=fR,e.props=s,e.state=r;var n={queue:[],replace:!1};e._reactInternals=n;var o=t.contextType;if(e.context=typeof o=="object"&&o!==null?o._currentValue:i,o=t.getDerivedStateFromProps,typeof o=="function"&&(o=o(s,r),r=o==null?r:Vd({},r,o),e.state=r),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&fR.enqueueReplaceState(e,e.state,null),n.queue!==null&&0<n.queue.length)if(t=n.queue,o=n.replace,n.queue=null,n.replace=!1,o&&t.length===1)e.state=t[0];else{for(n=o?t[0]:e.state,r=!0,o=o?1:0;o<t.length;o++){var a=t[o];a=typeof a=="function"?a.call(e,n,s,i):a,a!=null&&(r?(r=!1,n=Vd({},n,a)):Vd(n,a))}e.state=n}else n.queue=null}var IB={id:1,overflow:""};function Ew(e,t,s){var i=e.id;e=e.overflow;var r=32-Hg(i)-1;i&=~(1<<r),s+=1;var n=32-Hg(t)+r;if(30<n){var o=r-r%5;return n=(i&(1<<o)-1).toString(32),i>>=o,r-=o,{id:1<<32-Hg(t)+r|s<<r|i,overflow:n+e}}return{id:1<<n|s<<r|i,overflow:e}}var Hg=Math.clz32?Math.clz32:MB,_B=Math.log,kB=Math.LN2;function MB(e){return e>>>=0,e===0?32:31-(_B(e)/kB|0)|0}function LB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var OB=typeof Object.is=="function"?Object.is:LB,po=null,lx=null,jg=null,ss=null,xd=!1,$f=!1,Lh=0,Qo=null,mv=0;function qa(){if(po===null)throw Error(Tt(321));return po}function vR(){if(0<mv)throw Error(Tt(312));return{memoizedState:null,queue:null,next:null}}function cx(){return ss===null?jg===null?(xd=!1,jg=ss=vR()):(xd=!0,ss=jg):ss.next===null?(xd=!1,ss=ss.next=vR()):(xd=!0,ss=ss.next),ss}function ux(){lx=po=null,$f=!1,jg=null,mv=0,ss=Qo=null}function AI(e,t){return typeof t=="function"?t(e):t}function CR(e,t,s){if(po=qa(),ss=cx(),xd){var i=ss.queue;if(t=i.dispatch,Qo!==null&&(s=Qo.get(i),s!==void 0)){Qo.delete(i),i=ss.memoizedState;do i=e(i,s.action),s=s.next;while(s!==null);return ss.memoizedState=i,[i,t]}return[ss.memoizedState,t]}return e=e===AI?typeof t=="function"?t():t:s!==void 0?s(t):t,ss.memoizedState=e,e=ss.queue={last:null,dispatch:null},e=e.dispatch=GB.bind(null,po,e),[ss.memoizedState,e]}function yR(e,t){if(po=qa(),ss=cx(),t=t===void 0?null:t,ss!==null){var s=ss.memoizedState;if(s!==null&&t!==null){var i=s[1];e:if(i===null)i=!1;else{for(var r=0;r<i.length&&r<t.length;r++)if(!OB(t[r],i[r])){i=!1;break e}i=!0}if(i)return s[0]}}return e=e(),ss.memoizedState=[e,t],e}function GB(e,t,s){if(25<=mv)throw Error(Tt(301));if(e===po)if($f=!0,e={action:s,next:null},Qo===null&&(Qo=new Map),s=Qo.get(t),s===void 0)Qo.set(t,e);else{for(t=s;t.next!==null;)t=t.next;t.next=e}}function VB(){throw Error(Tt(394))}function ug(){}var wR={readContext:function(e){return e._currentValue},useContext:function(e){return qa(),e._currentValue},useMemo:yR,useReducer:CR,useRef:function(e){po=qa(),ss=cx();var t=ss.memoizedState;return t===null?(e={current:e},ss.memoizedState=e):t},useState:function(e){return CR(AI,e)},useInsertionEffect:ug,useLayoutEffect:function(){},useCallback:function(e,t){return yR(function(){return e},t)},useImperativeHandle:ug,useEffect:ug,useDebugValue:ug,useDeferredValue:function(e){return qa(),e},useTransition:function(){return qa(),[!1,VB]},useId:function(){var e=lx.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Hg(e)-1)).toString(32)+t;var s=Wg;if(s===null)throw Error(Tt(404));return t=Lh++,e=":"+s.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return qa(),t(e._source)},useSyncExternalStore:function(e,t,s){if(s===void 0)throw Error(Tt(407));return s()}},Wg=null,AC=cI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function BB(e){return console.error(e),null}function bd(){}function HB(e,t,s,i,r,n,o,a,l){var u=[],h=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:h,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:r===void 0?BB:r,onAllReady:n===void 0?bd:n,onShellReady:o===void 0?bd:o,onShellError:a===void 0?bd:a,onFatalError:l===void 0?bd:l},s=Kf(t,0,null,s,!1,!1),s.parentFlushed=!0,e=dx(t,e,null,s,h,EI,null,IB),u.push(e),t}function dx(e,t,s,i,r,n,o,a){e.allPendingTasks++,s===null?e.pendingRootTasks++:s.pendingTasks++;var l={node:t,ping:function(){var u=e.pingedTasks;u.push(l),u.length===1&&II(e)},blockedBoundary:s,blockedSegment:i,abortSet:r,legacyContext:n,context:o,treeContext:a};return r.add(l),l}function Kf(e,t,s,i,r,n){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:s,lastPushedText:r,textEmbedded:n}}function Oh(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function Yf(e,t){var s=e.onShellError;s(t),s=e.onFatalError,s(t),e.destination!==null?(e.status=2,dI(e.destination,t)):(e.status=1,e.fatalError=t)}function SR(e,t,s,i,r){for(po={},lx=t,Lh=0,e=s(i,r);$f;)$f=!1,Lh=0,mv+=1,ss=null,e=s(i,r);return ux(),e}function xR(e,t,s,i){var r=s.render(),n=i.childContextTypes;if(n!=null){var o=t.legacyContext;if(typeof s.getChildContext!="function")i=o;else{s=s.getChildContext();for(var a in s)if(!(a in n))throw Error(Tt(108,bw(i)||"Unknown",a));i=Vd({},o,s)}t.legacyContext=i,cr(e,t,r),t.legacyContext=o}else cr(e,t,r)}function bR(e,t){if(e&&e.defaultProps){t=Vd({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function Rw(e,t,s,i,r){if(typeof s=="function")if(s.prototype&&s.prototype.isReactComponent){r=gR(s,t.legacyContext);var n=s.contextType;n=new s(i,typeof n=="object"&&n!==null?n._currentValue:r),mR(n,s,i,r),xR(e,t,n,s)}else{n=gR(s,t.legacyContext),r=SR(e,t,s,i,n);var o=Lh!==0;if(typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0)mR(r,s,i,n),xR(e,t,r,s);else if(o){i=t.treeContext,t.treeContext=Ew(i,1,0);try{cr(e,t,r)}finally{t.treeContext=i}}else cr(e,t,r)}else if(typeof s=="string"){switch(r=t.blockedSegment,n=NV(r.chunks,s,i,e.responseState,r.formatContext),r.lastPushedText=!1,o=r.formatContext,r.formatContext=RV(o,s,i),Tw(e,t,n),r.formatContext=o,s){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:r.chunks.push(IV,Ft(s),_V)}r.lastPushedText=!1}else{switch(s){case FB:case AB:case mI:case vI:case fI:cr(e,t,i.children);return;case xI:cr(e,t,i.children);return;case PB:throw Error(Tt(343));case SI:e:{s=t.blockedBoundary,r=t.blockedSegment,n=i.fallback,i=i.children,o=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},l=Kf(e,r.chunks.length,a,r.formatContext,!1,!1);r.children.push(l),r.lastPushedText=!1;var u=Kf(e,0,null,r.formatContext,!1,!1);u.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=u;try{if(Tw(e,t,i),u.lastPushedText&&u.textEmbedded&&u.chunks.push(ox),u.status=1,qf(a,u),a.pendingTasks===0)break e}catch(h){u.status=4,a.forceClientRender=!0,a.errorDigest=Oh(e,h)}finally{t.blockedBoundary=s,t.blockedSegment=r}t=dx(e,n,s,l,o,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof s=="object"&&s!==null)switch(s.$$typeof){case wI:if(i=SR(e,t,s.render,i,r),Lh!==0){s=t.treeContext,t.treeContext=Ew(s,1,0);try{cr(e,t,i)}finally{t.treeContext=s}}else cr(e,t,i);return;case bI:s=s.type,i=bR(s,i),Rw(e,t,s,i,r);return;case CI:if(r=i.children,s=s._context,i=i.value,n=s._currentValue,s._currentValue=i,o=rl,rl=i={parent:o,depth:o===null?0:o.depth+1,context:s,parentValue:n,value:i},t.context=i,cr(e,t,r),e=rl,e===null)throw Error(Tt(403));i=e.parentValue,e.context._currentValue=i===NB?e.context._defaultValue:i,e=rl=e.parent,t.context=e;return;case yI:i=i.children,i=i(s._currentValue),cr(e,t,i);return;case ax:r=s._init,s=r(s._payload),i=bR(s,i),Rw(e,t,s,i,void 0);return}throw Error(Tt(130,s==null?s:typeof s,""))}}function cr(e,t,s){if(t.node=s,typeof s=="object"&&s!==null){switch(s.$$typeof){case DB:Rw(e,t,s.type,s.props,s.ref);return;case gI:throw Error(Tt(257));case ax:var i=s._init;s=i(s._payload),cr(e,t,s);return}if(xw(s)){ER(e,t,s);return}if(s===null||typeof s!="object"?i=null:(i=pR&&s[pR]||s["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(s))){if(s=i.next(),!s.done){var r=[];do r.push(s.value),s=i.next();while(!s.done);ER(e,t,r)}return}throw e=Object.prototype.toString.call(s),Error(Tt(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}typeof s=="string"?(i=t.blockedSegment,i.lastPushedText=oR(t.blockedSegment.chunks,s,e.responseState,i.lastPushedText)):typeof s=="number"&&(i=t.blockedSegment,i.lastPushedText=oR(t.blockedSegment.chunks,""+s,e.responseState,i.lastPushedText))}function ER(e,t,s){for(var i=s.length,r=0;r<i;r++){var n=t.treeContext;t.treeContext=Ew(n,i,r);try{Tw(e,t,s[r])}finally{t.treeContext=n}}}function Tw(e,t,s){var i=t.blockedSegment.formatContext,r=t.legacyContext,n=t.context;try{return cr(e,t,s)}catch(l){if(ux(),typeof l=="object"&&l!==null&&typeof l.then=="function"){s=l;var o=t.blockedSegment,a=Kf(e,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(a),o.lastPushedText=!1,e=dx(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,s.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Uf(n)}else throw t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Uf(n),l}}function jB(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,NI(this,t,e)}function FI(e,t,s){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.close())):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=s===void 0?Error(Tt(432)):s,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(r){return FI(r,t,s)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function qf(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var s=t.children[0];s.id=t.id,s.parentFlushed=!0,s.status===1&&qf(e,s)}else e.completedSegments.push(t)}function NI(e,t,s){if(t===null){if(s.parentFlushed){if(e.completedRootSegment!==null)throw Error(Tt(389));e.completedRootSegment=s}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=bd,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(s.parentFlushed&&s.status===1&&qf(t,s),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(jB,e),t.fallbackAbortableTasks.clear()):s.parentFlushed&&s.status===1&&(qf(t,s),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function II(e){if(e.status!==2){var t=rl,s=AC.current;AC.current=wR;var i=Wg;Wg=e.responseState;try{var r=e.pingedTasks,n;for(n=0;n<r.length;n++){var o=r[n],a=e,l=o.blockedSegment;if(l.status===0){Uf(o.context);try{cr(a,o,o.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(ox),o.abortSet.delete(o),l.status=1,NI(a,o.blockedBoundary,l)}catch(C){if(ux(),typeof C=="object"&&C!==null&&typeof C.then=="function"){var u=o.ping;C.then(u,u)}else{o.abortSet.delete(o),l.status=4;var h=o.blockedBoundary,p=C,g=Oh(a,p);if(h===null?Yf(a,p):(h.pendingTasks--,h.forceClientRender||(h.forceClientRender=!0,h.errorDigest=g,h.parentFlushed&&a.clientRenderedBoundaries.push(h))),a.allPendingTasks--,a.allPendingTasks===0){var m=a.onAllReady;m()}}}finally{}}}r.splice(0,n),e.destination!==null&&hx(e,e.destination)}catch(C){Oh(e,C),Yf(e,C)}finally{Wg=i,AC.current=s,s===wR&&Uf(t)}}}function dg(e,t,s){switch(s.parentFlushed=!0,s.status){case 0:var i=s.id=e.nextSegmentId++;return s.lastPushedText=!1,s.textEmbedded=!1,e=e.responseState,it(t,kV),it(t,e.placeholderPrefix),e=Ft(i.toString(16)),it(t,e),as(t,MV);case 1:s.status=2;var r=!0;i=s.chunks;var n=0;s=s.children;for(var o=0;o<s.length;o++){for(r=s[o];n<r.index;n++)it(t,i[n]);r=vv(e,t,r)}for(;n<i.length-1;n++)it(t,i[n]);return n<i.length&&(r=as(t,i[n])),r;default:throw Error(Tt(390))}}function vv(e,t,s){var i=s.boundary;if(i===null)return dg(e,t,s);if(i.parentFlushed=!0,i.forceClientRender)i=i.errorDigest,as(t,VV),it(t,HV),i&&(it(t,WV),it(t,Ft(Js(i))),it(t,jV)),as(t,zV),dg(e,t,s);else if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var r=e.responseState,n=r.nextSuspenseID++;r=je(r.boundaryPrefix+n.toString(16)),i=i.id=r,hR(t,e.responseState,i),dg(e,t,s)}else if(i.byteSize>e.progressiveChunkSize)i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),hR(t,e.responseState,i.id),dg(e,t,s);else{if(as(t,LV),s=i.completedSegments,s.length!==1)throw Error(Tt(391));vv(e,t,s[0])}return as(t,BV)}function RR(e,t,s){return hB(t,e.responseState,s.formatContext,s.id),vv(e,t,s),pB(t,s.formatContext)}function TR(e,t,s){for(var i=s.completedSegments,r=0;r<i.length;r++)_I(e,t,s,i[r]);if(i.length=0,e=e.responseState,i=s.id,s=s.rootSegmentID,it(t,e.startInlineScript),e.sentCompleteBoundaryFunction?it(t,yB):(e.sentCompleteBoundaryFunction=!0,it(t,CB)),i===null)throw Error(Tt(395));return s=Ft(s.toString(16)),it(t,i),it(t,wB),it(t,e.segmentPrefix),it(t,s),as(t,SB)}function _I(e,t,s,i){if(i.status===2)return!0;var r=i.id;if(r===-1){if((i.id=s.rootSegmentID)===-1)throw Error(Tt(392));return RR(e,t,i)}return RR(e,t,i),e=e.responseState,it(t,e.startInlineScript),e.sentCompleteSegmentFunction?it(t,fB):(e.sentCompleteSegmentFunction=!0,it(t,gB)),it(t,e.segmentPrefix),r=Ft(r.toString(16)),it(t,r),it(t,mB),it(t,e.placeholderPrefix),it(t,r),as(t,vB)}function hx(e,t){ar=new Uint8Array(512),lr=0;try{var s=e.completedRootSegment;if(s!==null&&e.pendingRootTasks===0){vv(e,t,s),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(s=0;s<i.length-1;s++)it(t,i[s]);s<i.length&&as(t,i[s])}var r=e.clientRenderedBoundaries,n;for(n=0;n<r.length;n++){var o=r[n];i=t;var a=e.responseState,l=o.id,u=o.errorDigest,h=o.errorMessage,p=o.errorComponentStack;if(it(i,a.startInlineScript),a.sentClientRenderFunction?it(i,bB):(a.sentClientRenderFunction=!0,it(i,xB)),l===null)throw Error(Tt(395));it(i,l),it(i,EB),(u||h||p)&&(it(i,DC),it(i,Ft(PC(u||"")))),(h||p)&&(it(i,DC),it(i,Ft(PC(h||"")))),p&&(it(i,DC),it(i,Ft(PC(p)))),as(i,RB)}r.splice(0,n);var g=e.completedBoundaries;for(n=0;n<g.length;n++)TR(e,t,g[n]);g.splice(0,n),sR(t),ar=new Uint8Array(512),lr=0;var m=e.partialBoundaries;for(n=0;n<m.length;n++){var C=m[n];e:{r=e,o=t;var y=C.completedSegments;for(a=0;a<y.length;a++)if(!_I(r,o,C,y[a])){a++,y.splice(0,a);var R=!1;break e}y.splice(0,a),R=!0}if(!R){e.destination=null,n++,m.splice(0,n);return}}m.splice(0,n);var x=e.completedBoundaries;for(n=0;n<x.length;n++)TR(e,t,x[n]);x.splice(0,n)}finally{sR(t),e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.close()}}function DR(e,t){try{var s=e.abortableTasks;s.forEach(function(i){return FI(i,e,t)}),s.clear(),e.destination!==null&&hx(e,e.destination)}catch(i){Oh(e,i),Yf(e,i)}}ix.renderToReadableStream=function(e,t){return new Promise(function(s,i){var r,n,o=new Promise(function(h,p){n=h,r=p}),a=HB(e,bV(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),EV(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,n,function(){var h=new ReadableStream({type:"bytes",pull:function(p){if(a.status===1)a.status=2,dI(p,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=p;try{hx(a,p)}catch(g){Oh(a,g),Yf(a,g)}}},cancel:function(){DR(a)}},{highWaterMark:0});h.allReady=o,s(h)},function(h){o.catch(function(){}),i(h)},r);if(t&&t.signal){var l=t.signal,u=function(){DR(a,l.reason),l.removeEventListener("abort",u)};l.addEventListener("abort",u)}II(a)})};ix.version="18.3.1";var Ou,kI;Ou=Lu,kI=ix;Ou.version;Ou.renderToString;var WB=Ou.renderToStaticMarkup;Ou.renderToNodeStream;Ou.renderToStaticNodeStream;kI.renderToReadableStream;var zB=Object.defineProperty,UB=Object.defineProperties,$B=Object.getOwnPropertyDescriptors,PR=Object.getOwnPropertySymbols,KB=Object.prototype.hasOwnProperty,YB=Object.prototype.propertyIsEnumerable,AR=(e,t,s)=>t in e?zB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,us=(e,t)=>{for(var s in t||(t={}))KB.call(t,s)&&AR(e,s,t[s]);if(PR)for(var s of PR(t))YB.call(t,s)&&AR(e,s,t[s]);return e},Ti=(e,t)=>UB(e,$B(t)),px=b.createContext({setMethods:()=>{}}),qB=e=>{const{initialProps:t,addUpdateCallback:s,CustomComponentClass:i,setMethods:r}=e,[n,o]=b.useState(t);return b.useEffect(()=>{s(a=>o(a))},[]),Pe.createElement(px.Provider,{value:{setMethods:r}},Pe.createElement(i,us({},n)))},QB=b.memo(qB),ZB=0;function FR(){return`agPortalKey_${++ZB}`}var MI=class{constructor(e,t,s,i){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=s,this.suppressFallbackMethods=!!i,this.statelessComponent=this.isStateless(this.reactComponent),this.key=FR(),this.portalKey=FR(),this.instanceCreated=this.isStatelessComponent()?Ps.resolve(!1):new Ps(r=>{this.resolveInstanceCreated=r})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){return this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy(),this.portalManager.destroyPortal(this.portal)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),s=document.createElement(t||"div");return s.classList.add("ag-react-container"),e.reactContainer=s,s}addParentContainerStyleAndClasses(){this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&(nt.warnOnce('Since v31.1 "getReactContainerStyle" is deprecated. Apply styling directly to ".ag-react-container" if needed.'),Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle())),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses()&&(nt.warnOnce('Since v31.1 "getReactContainerClasses" is deprecated. Apply styling directly to ".ag-react-container" if needed.'),this.componentInstance.getReactContainerClasses().forEach(t=>this.eParentElement.classList.add(t))))}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&t[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,t){const s=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!s){setTimeout(()=>this.callMethod(e,t));return}const i=s[e];if(i)return i.apply(s,t);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,t&&t[0]?t[0]:{})}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.params=e,this.createOrUpdatePortal(e),new Ps(t=>this.createReactComponent(t))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=t=>{var s;this.componentInstance=t,this.addParentContainerStyleAndClasses(),(s=this.resolveInstanceCreated)==null||s.call(this,!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,Ti(us({},e),{key:this.key})),this.portal=Am.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return b.createElement(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,t=>{e(t)})}isNullValue(){return this.valueRenderedIsNull(this.params)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}valueRenderedIsNull(e){if(!this.componentType.cellRenderer)return!1;const t=console.error;try{return console.error=()=>{},WB(b.createElement(this.reactComponent,e))===""}catch{}finally{console.error=t}return!1}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const s=this[`${e}Component`];if(!this.suppressFallbackMethods&&s)return s.bind(this)(t)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function gx(e,t,s){e.forEach(i=>{const r=t[i];r&&(s[i]=r)})}var Na=class extends MI{constructor(){super(...arguments),this.awaitUpdateCallback=new Ps(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=QB}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:s=>this.setMethods(s),addUpdateCallback:s=>{this.updateCallback=()=>(s(this.getProps()),new Ps(i=>{setTimeout(()=>{i()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,gx(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return Ti(us({},this.sourceParams),{key:this.key,ref:this.ref})}refreshProps(){return this.updateCallback?this.updateCallback():new Ps(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},JB=class extends Na{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},XB=class extends Na{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterChangedCallback()}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.model=e,this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getOptionalMethods(){return["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}updateModel(e){this.setModel(e).then(()=>this.sourceParams.filterChangedCallback())}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,delete e.filterModifiedCallback,delete e.valueGetter,e}};function LI(e,t){e.parentFilterInstance(s=>{(s.setModel(t)||Ps.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var eH=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=s=>this.updateModel(s)}getProps(){return Ti(us({},this.floatingFilterParams),{model:this.model,onModelChange:this.onModelChange})}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){gx(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),LI(this.floatingFilterParams,e)}},tH=class extends Na{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),LI(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},sH=class extends Na{refresh(e){this.sourceParams=e,this.refreshProps()}},iH=class extends Na{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},rH=class extends Na{refresh(e){this.sourceParams=e,this.refreshProps()}},nH=class extends Na{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},oH=class extends Na{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}},OI=class GI{constructor(t,s,i){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=s||"div",this.refresher=t,this.maxComponentCreationTimeMs=i||GI.MAX_COMPONENT_CREATION_TIME_IN_MS}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(t){this.portals=this.portals.filter(s=>s!==t),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(t,s,i){this.portals=[...this.portals,t],this.waitForInstance(s,i),this.batchUpdate()}updateReactPortal(t,s){this.portals[this.portals.indexOf(t)]=s,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(t,s,i=Date.now()){if(this.destroyed){s(null);return}if(t.rendered())s(t);else{if(Date.now()-i>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){if(t.isNullValue()){s(t);return}console.error(`AG Grid: React Component '${t.getReactComponentName()}' not created within ${this.maxComponentCreationTimeMs}ms.`),console.error("    If the component is using `forwardRef` but not `useImperativeHandle`, add the following: `useImperativeHandle(ref, () => ({}));`");return}window.setTimeout(()=>{this.waitForInstance(t,s,i)})}}};OI.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3;var aH=OI,Mi=Pe.createContext({}),tn=(...e)=>e.filter(s=>s!=null&&s!=="").join(" "),Nr=class VI{constructor(...t){this.classesMap={},t.forEach(s=>{this.classesMap[s]=!0})}setClass(t,s){if(!!this.classesMap[t]==s)return this;const r=new VI;return r.classesMap=us({},this.classesMap),r.classesMap[t]=s,r}toString(){return Object.keys(this.classesMap).filter(s=>this.classesMap[s]).join(" ")}},Gu=e=>{const t=()=>typeof Symbol=="function"&&Symbol.for,s=()=>t()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===s()},lH=Gy.createRoot!=null&&Gy.flushSync!=null,zg=!1;function cH(e){return zg||setTimeout(()=>zg=!1,0),zg=!0,e()}var fx=(e,t)=>{lH&&e&&!zg?Gy.flushSync(t):t()};function mx(e,t,s){if(t==null||e==null)return t;if(e===t||t.length===0&&e.length===0)return e;if(s||e.length===0&&t.length>0||e.length>0&&t.length===0)return t;const i=[],r=[],n=new Map,o=new Map;for(let a=0;a<t.length;a++){const l=t[a];o.set(l.getInstanceId(),l)}for(let a=0;a<e.length;a++){const l=e[a];n.set(l.getInstanceId(),l),o.has(l.getInstanceId())&&i.push(l)}for(let a=0;a<t.length;a++){const l=t[a],u=l.getInstanceId();n.has(u)||r.push(l)}return i.length===e.length&&r.length===0?e:i.length===0&&r.length===t.length?t:i.length===0?r:r.length===0?i:[...i,...r]}var Fp=(e,t,s,i)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const n=e.newAgStackInstance();if(!n)return;let o,a,l=!1;return n.then(u=>{if(l){t.destroyBean(u);return}o=u,a=o.getGui(),s.appendChild(a),NR(i,o)}),()=>{l=!0,o&&(a&&a.parentElement&&a.parentElement.removeChild(a),t.destroyBean(o),i&&NR(i,void 0))}},NR=(e,t)=>{if(e)if(e instanceof Function)e(t);else{const s=e;s.current=t}},uH=e=>{const t=e.newAgStackInstance();if(t)return t.resolveNow(null,s=>s)},BI=b.forwardRef((e,t)=>{var s;const i=b.useContext(Mi).context,r=b.useRef(null),n=b.useRef(null),o=b.useRef(null),a=b.useRef(null),l=b.useRef(null),u=b.useRef(),[h,p]=b.useState(),[g,m]=b.useState(),[C,y]=b.useState(),[R,x]=b.useState(()=>new Nr),[S,T]=b.useState(()=>new Nr("ag-hidden")),[I,V]=b.useState(()=>new Nr("ag-hidden")),[j,P]=b.useState(()=>new Nr("ag-invisible"));b.useImperativeHandle(t,()=>({refresh(){return!1}})),b.useLayoutEffect(()=>Fp(h,i,n.current),[h]);const N=b.useCallback(me=>{if(r.current=me,!r.current){i.destroyBean(u.current),u.current=null;return}const pe={setInnerRenderer:(ye,Ae)=>{p(ye),y(Ae)},setChildCount:ye=>m(ye),addOrRemoveCssClass:(ye,Ae)=>x(te=>te.setClass(ye,Ae)),setContractedDisplayed:ye=>V(Ae=>Ae.setClass("ag-hidden",!ye)),setExpandedDisplayed:ye=>T(Ae=>Ae.setClass("ag-hidden",!ye)),setCheckboxVisible:ye=>P(Ae=>Ae.setClass("ag-invisible",!ye))};u.current=i.createBean(new Ul),u.current.init(pe,r.current,o.current,a.current,l.current,BI,e)},[]),_=b.useMemo(()=>`ag-cell-wrapper ${R.toString()}`,[R]),L=b.useMemo(()=>`ag-group-expanded ${S.toString()}`,[S]),M=b.useMemo(()=>`ag-group-contracted ${I.toString()}`,[I]),E=b.useMemo(()=>`ag-group-checkbox ${j.toString()}`,[j]),F=h&&h.componentFromFramework,J=F?h.componentClass:void 0,Y=h==null&&C!=null,fe=nt.escapeString(C,!0);return Pe.createElement("span",us({className:_,ref:N},e.colDef?{}:{role:(s=u.current)==null?void 0:s.getCellAriaRole()}),Pe.createElement("span",{className:L,ref:a}),Pe.createElement("span",{className:M,ref:l}),Pe.createElement("span",{className:E,ref:o}),Pe.createElement("span",{className:"ag-group-value",ref:n},Y&&Pe.createElement(Pe.Fragment,null,fe),F&&Pe.createElement(J,us({},h.params))),Pe.createElement("span",{className:"ag-group-child-count"},g))}),IR=BI,dH=e=>{const{ctrl:t}=e,s=t.isAlive(),{context:i}=b.useContext(Mi),r=s?t.getColId():void 0,[n,o]=b.useState(),a=b.useRef(null),l=b.useRef(null),u=b.useRef(null),h=b.useRef();let p=b.useRef();s&&!p.current&&(p.current=new mp(()=>a.current));const g=b.useCallback(R=>{var x;if(a.current=R,!a.current||!s)return;const S={setWidth:I=>{a.current&&(a.current.style.width=I)},addOrRemoveCssClass:(I,V)=>p.current.addOrRemoveCssClass(I,V),setAriaSort:I=>{a.current&&(I?nt.setAriaSort(a.current,I):nt.removeAriaSort(a.current))},setUserCompDetails:I=>o(I),getUserCompInstance:()=>h.current||void 0};t.setComp(S,a.current,l.current,u.current);const T=t.getSelectAllGui();(x=l.current)==null||x.insertAdjacentElement("afterend",T)},[]);b.useLayoutEffect(()=>Fp(n,i,u.current,h),[n]),b.useEffect(()=>{t.setDragSource(a.current)},[n]);const m=b.useMemo(()=>!!((n==null?void 0:n.componentFromFramework)&&Gu(n.componentClass)),[n]),C=n&&n.componentFromFramework,y=n&&n.componentClass;return Pe.createElement("div",{ref:g,className:"ag-header-cell","col-id":r,role:"columnheader"},Pe.createElement("div",{ref:l,className:"ag-header-cell-resize",role:"presentation"}),Pe.createElement("div",{ref:u,className:"ag-header-cell-comp-wrapper",role:"presentation"},C&&m&&Pe.createElement(y,us({},n.params)),C&&!m&&Pe.createElement(y,Ti(us({},n.params),{ref:h}))))},hH=b.memo(dH),pH=e=>{const{context:t}=b.useContext(Mi),{ctrl:s}=e,[i,r]=b.useState(()=>new Nr),[n,o]=b.useState(()=>new Nr),[a,l]=b.useState("false"),[u,h]=b.useState(),[p,g]=b.useState(),m=b.useMemo(()=>s.getColId(),[]),C=b.useRef(null),y=b.useRef(null),R=b.useRef(),x=b.useCallback(P=>{if(C.current=P,!C.current)return;const N={setWidth:_=>{C.current&&(C.current.style.width=_)},addOrRemoveCssClass:(_,L)=>r(M=>M.setClass(_,L)),setUserCompDetails:_=>g(_),setResizableDisplayed:_=>{o(L=>L.setClass("ag-hidden",!_)),l(_?"false":"true")},setAriaExpanded:_=>h(_),getUserCompInstance:()=>R.current||void 0};s.setComp(N,C.current,y.current)},[]);b.useLayoutEffect(()=>Fp(p,t,C.current),[p]),b.useEffect(()=>{C.current&&s.setDragSource(C.current)},[p]);const S=b.useMemo(()=>!!((p==null?void 0:p.componentFromFramework)&&Gu(p.componentClass)),[p]),T=b.useMemo(()=>"ag-header-group-cell "+i.toString(),[i]),I=b.useMemo(()=>"ag-header-cell-resize "+n.toString(),[n]),V=p&&p.componentFromFramework,j=p&&p.componentClass;return Pe.createElement("div",{ref:x,className:T,"col-id":m,role:"columnheader","aria-expanded":u},V&&S&&Pe.createElement(j,us({},p.params)),V&&!S&&Pe.createElement(j,Ti(us({},p.params),{ref:R})),Pe.createElement("div",{ref:y,"aria-hidden":a,className:I}))},gH=b.memo(pH);function vx(){nt.warnOnce("Using custom components without `reactiveCustomComponents = true` is deprecated.")}var fH=e=>{const{context:t,gos:s}=b.useContext(Mi),[i,r]=b.useState(()=>new Nr("ag-header-cell","ag-floating-filter")),[n,o]=b.useState(()=>new Nr),[a,l]=b.useState(()=>new Nr("ag-floating-filter-button","ag-hidden")),[u,h]=b.useState("false"),[p,g]=b.useState(),[m,C]=b.useState(1),y=b.useRef(null),R=b.useRef(null),x=b.useRef(null),S=b.useRef(null),T=b.useRef(),I=b.useRef(),V=me=>{me!=null&&T.current&&T.current(me)},{ctrl:j}=e,P=b.useCallback(me=>{if(y.current=me,!y.current)return;I.current=new Ps(ye=>{T.current=ye});const pe={addOrRemoveCssClass:(ye,Ae)=>r(te=>te.setClass(ye,Ae)),addOrRemoveBodyCssClass:(ye,Ae)=>o(te=>te.setClass(ye,Ae)),setButtonWrapperDisplayed:ye=>{l(Ae=>Ae.setClass("ag-hidden",!ye)),h(ye?"false":"true")},setWidth:ye=>{y.current&&(y.current.style.width=ye)},setCompDetails:ye=>g(ye),getFloatingFilterComp:()=>I.current?I.current:null,setMenuIcon:ye=>{var Ae;return(Ae=S.current)==null?void 0:Ae.appendChild(ye)}};j.setComp(pe,y.current,S.current,R.current)},[]);b.useLayoutEffect(()=>Fp(p,t,R.current,V),[p]);const N=b.useMemo(()=>i.toString(),[i]),_=b.useMemo(()=>n.toString(),[n]),L=b.useMemo(()=>a.toString(),[a]),M=b.useMemo(()=>!!(p&&p.componentFromFramework&&Gu(p.componentClass)),[p]),E=b.useMemo(()=>s.get("reactiveCustomComponents"),[]),F=b.useMemo(()=>{if(p)if(E){const me=new eH(p.params,()=>C(pe=>pe+1));return V(me),me}else p.componentFromFramework&&vx()},[p]),J=F==null?void 0:F.getProps(),Y=p&&p.componentFromFramework,fe=p&&p.componentClass;return Pe.createElement("div",{ref:P,className:N,role:"gridcell"},Pe.createElement("div",{ref:R,className:_,role:"presentation"},Y&&!E&&Pe.createElement(fe,Ti(us({},p.params),{ref:M?()=>{}:V})),Y&&E&&Pe.createElement(px.Provider,{value:{setMethods:me=>F.setMethods(me)}},Pe.createElement(fe,us({},J)))),Pe.createElement("div",{ref:x,"aria-hidden":u,className:L,role:"presentation"},Pe.createElement("button",{ref:S,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},mH=b.memo(fH),vH=e=>{const{ctrl:t}=e,{topOffset:s,rowHeight:i}=b.useMemo(()=>t.getTopAndHeight(),[]),r=t.getAriaRowIndex(),n=t.getHeaderRowClass(),[o,a]=b.useState(()=>i+"px"),[l,u]=b.useState(()=>s+"px"),h=b.useRef(null),p=b.useRef(null),[g,m]=b.useState(()=>t.getHeaderCtrls()),C=b.useRef(null),y=b.useCallback(S=>{if(C.current=S,!S)return;const T={setHeight:I=>a(I),setTop:I=>u(I),setHeaderCtrls:(I,V,j)=>{p.current=h.current,h.current=I;const P=mx(p.current,I,V);P!==p.current&&fx(j,()=>m(P))},setWidth:I=>{C.current&&(C.current.style.width=I)}};t.setComp(T,!1)},[]),R=b.useMemo(()=>({height:o,top:l}),[o,l]),x=b.useCallback(S=>{switch(t.getType()){case ow.COLUMN_GROUP:return Pe.createElement(gH,{ctrl:S,key:S.getInstanceId()});case ow.FLOATING_FILTER:return Pe.createElement(mH,{ctrl:S,key:S.getInstanceId()});default:return Pe.createElement(hH,{ctrl:S,key:S.getInstanceId()})}},[]);return Pe.createElement("div",{ref:y,className:n,role:"row",style:R,"aria-rowindex":r},g.map(x))},CH=b.memo(vH),yH=e=>{const[t,s]=b.useState(!0),[i,r]=b.useState([]),{context:n}=b.useContext(Mi),o=b.useRef(null),a=b.useRef(null),l=b.useRef(null),u=e.pinned==="left",h=e.pinned==="right",p=!u&&!h,g=b.useCallback(y=>{if(o.current=y,!o.current){n.destroyBean(l.current),l.current=null;return}const R={setDisplayed:s,setCtrls:x=>r(x),setCenterWidth:x=>{a.current&&(a.current.style.width=x)},setViewportScrollLeft:x=>{o.current&&(o.current.scrollLeft=x)},setPinnedContainerWidth:x=>{o.current&&(o.current.style.width=x,o.current.style.minWidth=x,o.current.style.maxWidth=x)}};l.current=n.createBean(new Ra(e.pinned)),l.current.setComp(R,o.current)},[]),m=t?"":"ag-hidden",C=()=>i.map(y=>Pe.createElement(CH,{ctrl:y,key:y.getInstanceId()}));return Pe.createElement(Pe.Fragment,null,u&&Pe.createElement("div",{ref:g,className:"ag-pinned-left-header "+m,"aria-hidden":!t,role:"rowgroup"},C()),h&&Pe.createElement("div",{ref:g,className:"ag-pinned-right-header "+m,"aria-hidden":!t,role:"rowgroup"},C()),p&&Pe.createElement("div",{ref:g,className:"ag-header-viewport "+m,role:"presentation"},Pe.createElement("div",{ref:a,className:"ag-header-container",role:"rowgroup"},C())))},FC=b.memo(yH),wH=()=>{const[e,t]=b.useState(()=>new Nr),[s,i]=b.useState(),{context:r}=b.useContext(Mi),n=b.useRef(null),o=b.useRef(null),a=b.useCallback(h=>{if(n.current=h,!h){r.destroyBean(o.current),o.current=null;return}const p={addOrRemoveCssClass:(g,m)=>t(C=>C.setClass(g,m)),setHeightAndMinHeight:g=>i(g)};o.current=r.createBean(new Ta),o.current.setComp(p,n.current,n.current)},[]),l=b.useMemo(()=>"ag-header "+e.toString(),[e]),u=b.useMemo(()=>({height:s,minHeight:s}),[s]);return Pe.createElement("div",{ref:a,className:l,style:u,role:"presentation"},Pe.createElement(FC,{pinned:"left"}),Pe.createElement(FC,{pinned:null}),Pe.createElement(FC,{pinned:"right"}))},SH=b.memo(wH),xH=(e,t)=>{b.useEffect(()=>{const s=t.current;if(s){const i=s.parentElement;if(i){const r=document.createComment(e);return i.insertBefore(r,s),()=>{i.removeChild(r)}}}},[e])},Qa=xH,bH=e=>{const t=b.useRef(e),s=b.useRef(),i=b.useRef(!1),r=b.useRef(!1),[,n]=b.useState(0);i.current&&(r.current=!0),b.useEffect(()=>(i.current||(s.current=t.current(),i.current=!0),n(o=>o+1),()=>{r.current&&s.current&&s.current()}),[])},EH=e=>{const[t,s]=b.useState(),{context:i,popupService:r,localeService:n,gos:o}=b.useContext(Mi);return bH(()=>{const{editDetails:a,cellCtrl:l,eParentCell:u}=e,{compDetails:h}=a,p=o.get("stopEditingWhenCellsLoseFocus"),g=i.createBean(new yN(h.params)),m=g.getGui();if(e.jsChildComp){const T=e.jsChildComp.getGui();T&&m.appendChild(T)}const C={column:l.getColumn(),rowNode:l.getRowNode(),type:"popupCellEditor",eventSource:u,ePopup:m,position:a.popupPosition,keepWithinBounds:!0},y=r.positionPopupByComponent.bind(r,C),R=n.getLocaleTextFunc(),x=r.addPopup({modal:p,eChild:m,closeOnEsc:!0,closedCallback:()=>{l.onPopupEditorClosed()},anchorToElement:u,positionCallback:y,ariaLabel:R("ariaLabelCellEditor","Cell Editor")}),S=x?x.hideFunc:void 0;return s(g),e.jsChildComp&&e.jsChildComp.afterGuiAttached&&e.jsChildComp.afterGuiAttached(),()=>{S!=null&&S(),i.destroyBean(g)}}),Pe.createElement(Pe.Fragment,null,t&&e.wrappedContent&&Am.createPortal(e.wrappedContent,t.getGui()))},_R=b.memo(EH),RH=(e,t,s,i,r,n)=>{const{context:o}=b.useContext(Mi),a=b.useCallback(()=>{const l=r.current;if(!l)return;const u=l.getGui();u&&u.parentElement&&u.parentElement.removeChild(u),o.destroyBean(l),r.current=void 0},[]);b.useEffect(()=>{const l=e!=null,u=e&&e.compDetails&&!e.compDetails.componentFromFramework,h=t&&s==null;if(!(l&&u&&!h)){a();return}const g=e.compDetails;if(r.current){const x=r.current,T=x.refresh!=null&&e.force==!1?x.refresh(g.params):!1;if(T===!0||T===void 0)return;a()}const m=g.newAgStackInstance();if(!m)return;const C=m.resolveNow(null,x=>x);if(!C)return;const y=C.getGui();if(!y)return;(t?s:n.current).appendChild(y),r.current=C},[e,t,i]),b.useEffect(()=>a,[])},TH=RH,DH=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new Ps(s=>{this.resolveInstanceCreated=s}),this.onValueChange=s=>this.updateValue(s),this.value=e.value}getProps(){return Ti(us({},this.cellEditorParams),{initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange})}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){gx(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){var t;this.componentInstance=e,(t=this.resolveInstanceCreated)==null||t.call(this),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]}updateValue(e){this.value=e,this.refreshProps()}},PH=(e,t,s)=>{const i=s.getColumn();if(!e&&t.isPopup&&t.isPopup()){const r=`AG Grid: Found an issue in column ${i.getColId()}. If using React, specify an editor is a popup using colDef.cellEditorPopup=true. AG Grid React cannot depend on the editor component specifying if it's in a popup (via the isPopup() method on the editor), as React needs to know this information BEFORE the component is created.`;nt.doOnce(()=>console.warn(r),"jsEditorComp-isPopup-"+s.getColumn().getColId())}if(e&&t.getPopupPosition&&t.getPopupPosition()!=null){const r=`AG Grid: Found an issue in column ${i.getColId()}. If using React, specify an editor popup position using colDef.cellEditorPopupPosition=true. AG Grid React cannot depend on the editor component specifying it's position (via the getPopupPosition() method on the editor), as React needs to know this information BEFORE the component is created.`;nt.doOnce(()=>console.warn(r),"jsEditorComp-getPopupPosition-"+s.getColumn().getColId())}},AH=(e,t,s)=>{const{compProxy:i}=e;s(i);const r=i.getProps(),n=Gu(t);return Pe.createElement(px.Provider,{value:{setMethods:o=>i.setMethods(o)}},n&&Pe.createElement(t,us({},r)),!n&&Pe.createElement(t,Ti(us({},r),{ref:o=>i.setRef(o)})))},kR=(e,t,s)=>{const i=e.compProxy;return Pe.createElement(Pe.Fragment,null,!i&&Pe.createElement(t,Ti(us({},e.compDetails.params),{ref:s})),i&&AH(e,t,s))},FH=(e,t,s,i,r,n)=>{const o=e.compDetails,a=o.componentClass,l=o.componentFromFramework&&!e.popup,u=o.componentFromFramework&&e.popup,h=!o.componentFromFramework&&e.popup;return Pe.createElement(Pe.Fragment,null,l&&kR(e,a,t),u&&Pe.createElement(_R,{editDetails:e,cellCtrl:r,eParentCell:i,wrappedContent:kR(e,a,s)}),h&&n&&Pe.createElement(_R,{editDetails:e,cellCtrl:r,eParentCell:i,jsChildComp:n}))},NH=(e,t,s,i,r,n,o)=>{const{compDetails:a,value:l}=e,u=!a,h=a&&a.componentFromFramework,p=a&&a.componentClass,g=l!=null&&l.toString?l.toString():l,m=()=>Pe.createElement(Pe.Fragment,null,u&&Pe.createElement(Pe.Fragment,null,g),h&&!n&&Pe.createElement(p,Ti(us({},a.params),{key:t,ref:i})),h&&n&&Pe.createElement(p,Ti(us({},a.params),{key:t})));return Pe.createElement(Pe.Fragment,null,r?Pe.createElement("span",{role:"presentation",id:`cell-${s}`,className:"ag-cell-value",ref:o},m()):m())},IH=e=>{const{context:t}=b.useContext(Mi),{cellCtrl:s,printLayout:i,editingRow:r}=e,n=s.getTabIndex(),o=s.getColumnIdSanitised(),a=s.getInstanceId(),[l,u]=b.useState(()=>s.isCellRenderer()?void 0:{compDetails:void 0,value:s.getValueToDisplay(),force:!1}),[h,p]=b.useState(),[g,m]=b.useState(1),[C,y]=b.useState(),[R,x]=b.useState(!1),[S,T]=b.useState(!1),[I,V]=b.useState(!1),[j,P]=b.useState(),N=b.useMemo(()=>s.isForceWrapper(),[s]),_=b.useMemo(()=>s.getCellAriaRole(),[s]),L=b.useRef(null),M=b.useRef(null),E=b.useRef(),F=b.useRef(),J=b.useRef(),Y=b.useRef([]),fe=b.useRef(),[me,pe]=b.useState(0),ye=b.useCallback($=>{fe.current=$,pe(K=>K+1)},[]),Ae=l!=null&&(R||I||S),te=N||Ae,ce=b.useCallback(($,K)=>{F.current=K,K&&(PH($,K,s),K.isCancelBeforeStart&&K.isCancelBeforeStart()&&setTimeout(()=>{s.stopEditing(!0),s.focusCell(!0)}))},[s]),be=b.useCallback($=>ce(!0,$),[ce]),Ze=b.useCallback($=>ce(!1,$),[ce]);let he=b.useRef();he.current||(he.current=new mp(()=>L.current)),TH(l,te,fe.current,me,E,L);const et=b.useRef();b.useLayoutEffect(()=>{const $=et.current,K=l;if(et.current=l,$==null||$.compDetails==null||K==null||K.compDetails==null)return;const Q=$.compDetails,oe=K.compDetails;if(Q.componentClass!=oe.componentClass||M.current==null||M.current.refresh==null)return;M.current.refresh(oe.params)!=!0&&m(k=>k+1)},[l]),b.useLayoutEffect(()=>{if(!(h&&!h.compDetails.componentFromFramework))return;const K=h.compDetails,Q=h.popup===!0,oe=uH(K);if(!oe)return;const Z=oe.getGui();if(ce(Q,oe),!Q){const k=(N?J:L).current;k==null||k.appendChild(Z),oe.afterGuiAttached&&oe.afterGuiAttached()}return P(oe),()=>{t.destroyBean(oe),ce(Q,void 0),P(void 0),Z&&Z.parentElement&&Z.parentElement.removeChild(Z)}},[h]);const We=b.useCallback($=>{if(J.current=$,!J.current){Y.current.forEach(Q=>Q()),Y.current=[];return}const K=Q=>{var oe;if(Q){const Z=Q.getGui();(oe=J.current)==null||oe.insertAdjacentElement("afterbegin",Z),Y.current.push(()=>{t.destroyBean(Q),nt.removeFromParent(Z)})}return Q};if(R){const Q=s.createSelectionCheckbox();K(Q)}I&&K(s.createDndSource()),S&&K(s.createRowDragComp())},[s,t,I,S,R]),se=b.useCallback($=>{if(L.current=$,!L.current||!s)return;const K={addOrRemoveCssClass:(oe,Z)=>he.current.addOrRemoveCssClass(oe,Z),setUserStyles:oe=>y(oe),getFocusableElement:()=>L.current,setIncludeSelection:oe=>x(oe),setIncludeRowDrag:oe=>T(oe),setIncludeDndSource:oe=>V(oe),getCellEditor:()=>F.current||null,getCellRenderer:()=>M.current?M.current:E.current,getParentOfValue:()=>fe.current?fe.current:J.current?J.current:L.current,setRenderDetails:(oe,Z,k)=>{u(O=>(O==null?void 0:O.compDetails)!==oe||(O==null?void 0:O.value)!==Z||(O==null?void 0:O.force)!==k?{value:Z,compDetails:oe,force:k}:O)},setEditDetails:(oe,Z,k,O)=>{if(oe){let W;O?W=new DH(oe.params,()=>m(ue=>ue+1)):oe.componentFromFramework&&vx(),p({compDetails:oe,popup:Z,popupPosition:k,compProxy:W}),Z||u(void 0)}else p(W=>{W!=null&&W.compProxy&&(F.current=void 0)})}},Q=J.current||void 0;s.setComp(K,L.current,Q,i,r)},[]),ne=b.useMemo(()=>!!(l&&l.compDetails&&l.compDetails.componentFromFramework&&Gu(l.compDetails.componentClass)),[l]);b.useLayoutEffect(()=>{var $;L.current&&(he.current.addOrRemoveCssClass("ag-cell-value",!te),he.current.addOrRemoveCssClass("ag-cell-inline-editing",!!h&&!h.popup),he.current.addOrRemoveCssClass("ag-cell-popup-editing",!!h&&!!h.popup),he.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!h||!!h.popup),($=s.getRowCtrl())==null||$.setInlineEditingCss(!!h),s.shouldRestoreFocus()&&!s.isEditing()&&L.current.focus({preventScroll:!0}))});const B=()=>Pe.createElement(Pe.Fragment,null,l!=null&&NH(l,g,a,M,te,ne,ye),h!=null&&FH(h,Ze,be,L.current,s,j));return Pe.createElement("div",{ref:se,style:C,tabIndex:n,role:_,"col-id":o},te?Pe.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:We},B()):B())},_H=b.memo(IH),kH=e=>{const{context:t,gos:s}=b.useContext(Mi),{rowCtrl:i,containerType:r}=e,n=i.getTabIndex(),o=b.useRef(i.getDomOrder()),a=i.isFullWidth(),l=i.getRowNode().displayed,[u,h]=b.useState(()=>l?i.getRowIndex():null),[p,g]=b.useState(()=>i.getRowId()),[m,C]=b.useState(()=>i.getBusinessKey()),[y,R]=b.useState(()=>i.getRowStyles()),x=b.useRef(null),S=b.useRef(null),[T,I]=b.useState(()=>null),[V,j]=b.useState(),[P,N]=b.useState(()=>l?i.getInitialRowTop(r):void 0),[_,L]=b.useState(()=>l?i.getInitialTransform(r):void 0),M=b.useRef(null),E=b.useRef(),F=b.useRef(!1),[J,Y]=b.useState(0);b.useEffect(()=>{var he;if(F.current||!V||J>10)return;const et=(he=M.current)==null?void 0:he.firstChild;et?(i.setupDetailRowAutoHeight(et),F.current=!0):Y(We=>We+1)},[V,J]);let fe=b.useRef();fe.current||(fe.current=new mp(()=>M.current));const me=b.useCallback(he=>{if(M.current=he,!M.current){i.unsetComp(r);return}if(!i.isAlive())return;const et={setTop:N,setTransform:L,addOrRemoveCssClass:(We,se)=>fe.current.addOrRemoveCssClass(We,se),setDomOrder:We=>o.current=We,setRowIndex:h,setRowId:g,setRowBusinessKey:C,setUserStyles:R,setCellCtrls:(We,se)=>{S.current=x.current,x.current=We;const ne=mx(S.current,We,o.current);ne!==S.current&&fx(se,()=>I(ne))},showFullWidth:We=>j(We),getFullWidthCellRenderer:()=>E.current,refreshFullWidth:We=>ce.current?(j(se=>Ti(us({},se),{params:We()})),!0):!E.current||!E.current.refresh?!1:E.current.refresh(We())};i.setComp(et,M.current,r)},[]);b.useLayoutEffect(()=>Fp(V,t,M.current,E),[V]);const pe=b.useMemo(()=>{const he={top:P,transform:_};return Object.assign(he,y),he},[P,_,y]),ye=a&&V&&V.componentFromFramework,Ae=!a&&T!=null,te=b.useMemo(()=>!!((V==null?void 0:V.componentFromFramework)&&Gu(V.componentClass)),[V]),ce=b.useRef(!1);b.useEffect(()=>{ce.current=te&&!!V&&!!s.get("reactiveCustomComponents")},[te,V]);const be=()=>T==null?void 0:T.map(he=>Pe.createElement(_H,{cellCtrl:he,editingRow:i.isEditing(),printLayout:i.isPrintLayout(),key:he.getInstanceId()})),Ze=()=>{const he=V.componentClass;return Pe.createElement(Pe.Fragment,null,te&&Pe.createElement(he,us({},V.params)),!te&&Pe.createElement(he,Ti(us({},V.params),{ref:E})))};return Pe.createElement("div",{ref:me,role:"row",style:pe,"row-index":u,"row-id":p,"row-business-key":m,tabIndex:n},Ae&&be(),ye&&Ze())},MH=b.memo(kH),LH=e=>{const{context:t}=b.useContext(Mi),{name:s}=e,i=b.useMemo(()=>mN(s),[s]),r=b.useRef(null),n=b.useRef(null),o=b.useRef([]),a=b.useRef([]),[l,u]=b.useState(()=>[]),h=b.useRef(!1),p=b.useRef(),g=b.useMemo(()=>Ff.getRowContainerCssClasses(s),[s]),m=b.useMemo(()=>tn(g.viewport),[g]),C=b.useMemo(()=>tn(g.container),[g]),y=s===es.CENTER||s===es.TOP_CENTER||s===es.BOTTOM_CENTER||s===es.STICKY_TOP_CENTER||s===es.STICKY_BOTTOM_CENTER,R=y?r:n;Qa(" AG Row Container "+s+" ",R);const x=b.useCallback(()=>y?r.current!=null&&n.current!=null:n.current!=null,[]),S=b.useCallback(()=>y?r.current==null&&n.current==null:n.current==null,[]),T=b.useCallback(()=>{if(S()&&(t.destroyBean(p.current),p.current=null),x()){const P=_=>{const L=mx(a.current,o.current,h.current);L!==a.current&&(a.current=L,fx(_,()=>u(L)))},N={setViewportHeight:_=>{r.current&&(r.current.style.height=_)},setRowCtrls:({rowCtrls:_,useFlushSync:L})=>{const M=!!L&&o.current.length>0&&_.length>0;o.current=_,P(M)},setDomOrder:_=>{h.current!=_&&(h.current=_,P(!1))},setContainerWidth:_=>{n.current&&(n.current.style.width=_)}};p.current=t.createBean(new Ff(s)),p.current.setComp(N,n.current,r.current)}},[x,S]),I=b.useCallback(P=>{n.current=P,T()},[T]),V=b.useCallback(P=>{r.current=P,T()},[T]),j=()=>Pe.createElement("div",{className:C,ref:I,role:"rowgroup"},l.map(P=>Pe.createElement(MH,{rowCtrl:P,containerType:i,key:P.getInstanceId()})));return Pe.createElement(Pe.Fragment,null,y?Pe.createElement("div",{className:m,ref:V,role:"presentation"},j()):j())},OH=b.memo(LH),GH=()=>{const{context:e,agStackComponentsRegistry:t,resizeObserverService:s}=b.useContext(Mi),[i,r]=b.useState(""),[n,o]=b.useState(0),[a,l]=b.useState(0),[u,h]=b.useState("0px"),[p,g]=b.useState("0px"),[m,C]=b.useState("100%"),[y,R]=b.useState("0px"),[x,S]=b.useState("0px"),[T,I]=b.useState("100%"),[V,j]=b.useState(""),[P,N]=b.useState(""),[_,L]=b.useState(null),[M,E]=b.useState(""),[F,J]=b.useState(null),[Y,fe]=b.useState("ag-layout-normal");let me=b.useRef();me.current||(me.current=new mp(()=>pe.current));const pe=b.useRef(null),ye=b.useRef(null),Ae=b.useRef(null),te=b.useRef(null),ce=b.useRef(null),be=b.useRef(null),Ze=b.useRef(null),he=b.useRef([]),et=b.useRef([]);Qa(" AG Grid Body ",pe),Qa(" AG Pinned Top ",ye),Qa(" AG Sticky Top ",Ae),Qa(" AG Middle ",be),Qa(" AG Pinned Bottom ",Ze);const We=b.useCallback(X=>{if(pe.current=X,!pe.current){e.destroyBeans(he.current),et.current.forEach(De=>De()),he.current=[],et.current=[];return}if(!e)return;const q=De=>{const Ee=t.getComponentClass(De),Oe=e.createBean(new Ee);return he.current.push(Oe),Oe},ie=(De,Ee)=>{De.appendChild(Ee),et.current.push(()=>De.removeChild(Ee))};ie(pe.current,document.createComment(" AG Fake Horizontal Scroll ")),ie(pe.current,q("AG-FAKE-HORIZONTAL-SCROLL").getGui()),ie(pe.current,document.createComment(" AG Overlay Wrapper ")),ie(pe.current,q("AG-OVERLAY-WRAPPER").getGui()),ce.current&&(ie(ce.current,document.createComment(" AG Fake Vertical Scroll ")),ie(ce.current,q("AG-FAKE-VERTICAL-SCROLL").getGui()));const we={setRowAnimationCssOnBodyViewport:r,setColumnCount:De=>{pe.current&&nt.setAriaColCount(pe.current,De)},setRowCount:De=>{pe.current&&nt.setAriaRowCount(pe.current,De)},setTopHeight:o,setBottomHeight:l,setStickyTopHeight:h,setStickyTopTop:g,setStickyTopWidth:C,setTopDisplay:j,setBottomDisplay:N,setColumnMovingCss:(De,Ee)=>me.current.addOrRemoveCssClass(De,Ee),updateLayoutClasses:fe,setAlwaysVerticalScrollClass:L,setPinnedTopBottomOverflowY:E,setCellSelectableCss:(De,Ee)=>J(Ee?De:null),setBodyViewportWidth:De=>{be.current&&(be.current.style.width=De)},registerBodyViewportResizeListener:De=>{if(be.current){const Ee=s.observeResize(be.current,De);et.current.push(()=>Ee())}},setStickyBottomHeight:R,setStickyBottomBottom:S,setStickyBottomWidth:I},Ne=e.createBean(new gi);he.current.push(Ne),Ne.setComp(we,pe.current,be.current,ye.current,Ze.current,Ae.current,te.current)},[]),se=b.useMemo(()=>tn("ag-root","ag-unselectable",Y),[Y]),ne=b.useMemo(()=>tn("ag-body-viewport",i,Y,_,F),[i,Y,_,F]),B=b.useMemo(()=>tn("ag-body",Y),[Y]),$=b.useMemo(()=>tn("ag-floating-top",F),[F]),K=b.useMemo(()=>tn("ag-sticky-top",F),[F]),Q=b.useMemo(()=>tn("ag-sticky-bottom",F),[F]),oe=b.useMemo(()=>tn("ag-floating-bottom",F),[F]),Z=b.useMemo(()=>({height:n,minHeight:n,display:V,overflowY:M}),[n,V,M]),k=b.useMemo(()=>({height:u,top:p,width:m}),[u,p,m]),O=b.useMemo(()=>({height:y,bottom:x,width:T}),[y,x,T]),W=b.useMemo(()=>({height:a,minHeight:a,display:P,overflowY:M}),[a,P,M]),ue=X=>Pe.createElement(OH,{name:X,key:`${X}-container`}),ae=({section:X,children:q,className:ie,style:we})=>Pe.createElement("div",{ref:X,className:ie,role:"presentation",style:we},q.map(ue));return Pe.createElement("div",{ref:We,className:se,role:"treegrid"},Pe.createElement(SH,null),ae({section:ye,className:$,style:Z,children:[es.TOP_LEFT,es.TOP_CENTER,es.TOP_RIGHT,es.TOP_FULL_WIDTH]}),Pe.createElement("div",{className:B,ref:ce,role:"presentation"},ae({section:be,className:ne,children:[es.LEFT,es.CENTER,es.RIGHT,es.FULL_WIDTH]})),ae({section:Ae,className:K,style:k,children:[es.STICKY_TOP_LEFT,es.STICKY_TOP_CENTER,es.STICKY_TOP_RIGHT,es.STICKY_TOP_FULL_WIDTH]}),ae({section:te,className:Q,style:O,children:[es.STICKY_BOTTOM_LEFT,es.STICKY_BOTTOM_CENTER,es.STICKY_BOTTOM_RIGHT,es.STICKY_BOTTOM_FULL_WIDTH]}),ae({section:Ze,className:oe,style:W,children:[es.BOTTOM_LEFT,es.BOTTOM_CENTER,es.BOTTOM_RIGHT,es.BOTTOM_FULL_WIDTH]}))},VH=b.memo(GH),BH=(e,t)=>{const{children:s,eFocusableElement:i,onTabKeyDown:r,gridCtrl:n,forceFocusOutWhenTabGuardsAreEmpty:o}=e,{context:a}=b.useContext(Mi),l=b.useRef(null),u=b.useRef(null),h=b.useRef(),p=R=>{const x=R==null?void 0:parseInt(R,10).toString();[l,u].forEach(S=>{var T,I;x===void 0?(T=S.current)==null||T.removeAttribute("tabindex"):(I=S.current)==null||I.setAttribute("tabindex",x)})};b.useImperativeHandle(t,()=>({forceFocusOutOfContainer(R){var x;(x=h.current)==null||x.forceFocusOutOfContainer(R)}}));const g=b.useCallback(()=>{if(!l.current&&!u.current){a.destroyBean(h.current),h.current=null;return}if(l.current&&u.current){const R={setTabIndex:p};h.current=a.createBean(new av({comp:R,eTopGuard:l.current,eBottomGuard:u.current,eFocusableElement:i,onTabKeyDown:r,forceFocusOutWhenTabGuardsAreEmpty:o,focusInnerElement:x=>n.focusInnerElement(x)}))}},[]),m=b.useCallback(R=>{l.current=R,g()},[g]),C=b.useCallback(R=>{u.current=R,g()},[g]),y=R=>{const x=R==="top"?Ig.TAB_GUARD_TOP:Ig.TAB_GUARD_BOTTOM;return Pe.createElement("div",{className:`${Ig.TAB_GUARD} ${x}`,role:"presentation",ref:R==="top"?m:C})};return Pe.createElement(Pe.Fragment,null,y("top"),s,y("bottom"))},HH=b.forwardRef(BH),jH=b.memo(HH),WH=({context:e})=>{const[t,s]=b.useState(""),[i,r]=b.useState(""),[n,o]=b.useState(""),[a,l]=b.useState(null),[u,h]=b.useState(null),[p,g]=b.useState(!1),[m,C]=b.useState(),y=b.useRef(null),R=b.useRef(null),x=b.useRef(),[S,T]=b.useState(null),I=b.useRef(()=>{}),V=b.useCallback(()=>{},[]),j=b.useMemo(()=>e.isDestroyed()?null:e.getBean("beans"),[e]);Qa(" AG Grid ",R);const P=b.useCallback(E=>{if(R.current=E,!R.current){e.destroyBean(y.current),y.current=null;return}if(e.isDestroyed())return;y.current=e.createBean(new Fa);const F=y.current;I.current=F.focusInnerElement.bind(F);const J={destroyGridUi:()=>{},setRtlClass:s,forceFocusOutOfContainer:Y=>{var fe;(fe=x.current)==null||fe.forceFocusOutOfContainer(Y)},updateLayoutClasses:o,getFocusableContainers:()=>{var Y,fe;const me=[],pe=(Y=R.current)==null?void 0:Y.querySelector(".ag-root"),ye=(fe=R.current)==null?void 0:fe.querySelector(".ag-side-bar:not(.ag-hidden)");return pe&&me.push(pe),ye&&me.push(ye),me},setCursor:l,setUserSelect:h};F.setComp(J,R.current,R.current),g(!0)},[]);b.useEffect(()=>{if(!m||!j||!y.current||!S||!R.current)return;const E=y.current,F=[],{agStackComponentsRegistry:J}=j,Y=J.getComponentClass("AG-GRID-HEADER-DROP-ZONES"),fe=J.getComponentClass("AG-SIDE-BAR"),me=J.getComponentClass("AG-STATUS-BAR"),pe=J.getComponentClass("AG-WATERMARK"),ye=J.getComponentClass("AG-PAGINATION"),Ae=[],te=R.current;if(E.showDropZones()&&Y){const ce=e.createBean(new Y),be=ce.getGui();te.insertAdjacentElement("afterbegin",be),Ae.push(be),F.push(ce)}if(E.showSideBar()&&fe){const ce=e.createBean(new fe),be=ce.getGui(),Ze=S.querySelector(".ag-tab-guard-bottom");Ze&&(Ze.insertAdjacentElement("beforebegin",be),Ae.push(be)),F.push(ce)}if(E.showStatusBar()&&me){const ce=e.createBean(new me),be=ce.getGui();te.insertAdjacentElement("beforeend",be),Ae.push(be),F.push(ce)}if(ye){const ce=e.createBean(new ye),be=ce.getGui();te.insertAdjacentElement("beforeend",be),Ae.push(be),F.push(ce)}if(E.showWatermark()&&pe){const ce=e.createBean(new pe),be=ce.getGui();te.insertAdjacentElement("beforeend",be),Ae.push(be),F.push(ce)}return()=>{e.destroyBeans(F),Ae.forEach(ce=>{ce.parentElement&&ce.parentElement.removeChild(ce)})}},[m,S,j]);const N=b.useMemo(()=>tn("ag-root-wrapper",t,i,n),[t,i,n]),_=b.useMemo(()=>tn("ag-root-wrapper-body","ag-focus-managed",n),[n]),L=b.useMemo(()=>({userSelect:u??"",WebkitUserSelect:u??"",cursor:a??""}),[u,a]),M=b.useCallback(E=>{x.current=E,C(E!==null)},[]);return Pe.createElement("div",{ref:P,className:N,style:L,role:"presentation"},Pe.createElement("div",{className:_,ref:T,role:"presentation"},p&&S&&j&&Pe.createElement(Mi.Provider,{value:j},Pe.createElement(jH,{ref:M,eFocusableElement:S,onTabKeyDown:V,gridCtrl:y.current,forceFocusOutWhenTabGuardsAreEmpty:!0},Pe.createElement(VH,null)))))},zH=b.memo(WH),HI=e=>{var t,s;const i=b.useRef(),r=b.useRef(null),n=b.useRef(null),o=b.useRef([]),a=b.useRef([]),l=b.useRef(e),u=b.useRef(!1),[h,p]=b.useState(void 0),[,g]=b.useState(0),m=b.useCallback(R=>{if(r.current=R,!r.current){o.current.forEach(P=>P()),o.current.length=0;return}const x=e.modules||[];n.current||(n.current=new aH(()=>g(P=>P+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),o.current.push(()=>{var P;(P=n.current)==null||P.destroy(),n.current=null}));const S=Rf.combineAttributesAndGridOptions(e.gridOptions,e),T={providedBeanInstances:{frameworkComponentWrapper:new $H(n.current,!!S.reactiveCustomComponents)},modules:x,frameworkOverrides:new YH},I=P=>{p(P),o.current.push(()=>{P.destroy()}),P.getBean(yl.NAME).whenReady(()=>{if(P.isDestroyed())return;const _=i.current;_&&e.setGridApi&&e.setGridApi(_,new nu(_))})},V=P=>{P.getBean(yl.NAME).whenReady(()=>{a.current.forEach(_=>_()),a.current.length=0,u.current=!0})},j=new m2;i.current=j.create(r.current,S,I,V,T)},[]),C=b.useMemo(()=>us({height:"100%"},e.containerStyle||{}),[e.containerStyle]),y=b.useCallback(R=>{u.current?R():a.current.push(R)},[]);return b.useEffect(()=>{const R=UH(l.current,e);l.current=e,y(()=>{i.current&&Rf.processOnChange(R,i.current)})},[e]),Pe.createElement("div",{style:C,className:e.className,ref:m},h&&!h.isDestroyed()?Pe.createElement(zH,{context:h}):null,(s=(t=n.current)==null?void 0:t.getPortals())!=null?s:null)};function UH(e,t){const s={};return Object.keys(t).forEach(i=>{const r=t[i];e[i]!==r&&(s[i]=r)}),s}var $H=class extends v2{constructor(e,t){super(),this.parent=e,this.reactiveCustomComponents=t}createWrapper(e,t){if(this.reactiveCustomComponents){const r=(n=>{switch(n){case"filter":return XB;case"floatingFilterComponent":return tH;case"dateComponent":return JB;case"loadingOverlayComponent":return sH;case"noRowsOverlayComponent":return rH;case"statusPanel":return nH;case"toolPanel":return oH;case"menuItem":return iH}})(t.propertyName);if(r)return new r(e,this.parent,t)}else switch(t.propertyName){case"filter":case"floatingFilterComponent":case"dateComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":vx();break}const s=!t.cellRenderer&&t.propertyName!=="toolPanel";return new MI(e,this.parent,t,s)}},KH=b.forwardRef((e,t)=>{const{ctrlsFactory:s,context:i,gos:r,resizeObserverService:n,clientSideRowModel:o,serverSideRowModel:a}=b.useContext(Mi),[l,u]=b.useState(()=>new Nr),[h,p]=b.useState(()=>new Nr),[g,m]=b.useState(),[C,y]=b.useState(),R=b.useRef(),x=b.useRef(null),S=b.useRef(),T=b.useMemo(()=>Vt.__getGridRegisteredModules(e.api.getGridId()),[e]),I=b.useMemo(()=>l.toString()+" ag-details-row",[l]),V=b.useMemo(()=>h.toString()+" ag-details-grid",[h]);t&&b.useImperativeHandle(t,()=>({refresh(){var N,_;return(_=(N=R.current)==null?void 0:N.refresh())!=null?_:!1}})),e.template&&nt.warnOnce("detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://ag-grid.com/react-data-grid/master-detail-custom-detail/");const j=b.useCallback(N=>{if(x.current=N,!x.current){i.destroyBean(R.current),S.current&&S.current();return}const _={addOrRemoveCssClass:(M,E)=>u(F=>F.setClass(M,E)),addOrRemoveDetailGridCssClass:(M,E)=>p(F=>F.setClass(M,E)),setDetailGrid:M=>m(M),setRowData:M=>y(M),getGui:()=>x.current},L=s.getInstance("detailCellRenderer");if(L&&(i.createBean(L),L.init(_,e),R.current=L,r.get("detailRowAutoHeight"))){const M=()=>{if(x.current==null)return;const E=x.current.clientHeight;E!=null&&E>0&&setTimeout(()=>{e.node.setRowHeight(E),o?o.onRowHeightChanged():a&&a.onRowHeightChanged()},0)};S.current=n.observeResize(x.current,M),M()}},[]),P=b.useCallback((N,_)=>{var L;(L=R.current)==null||L.registerDetailWithMaster(N,_)},[]);return Pe.createElement("div",{className:I,ref:j},g&&Pe.createElement(HI,Ti(us({className:V},g),{modules:T,rowData:C,setGridApi:P})))}),YH=class extends IN{constructor(){super("react"),this.frameworkComponents={agGroupCellRenderer:IR,agGroupRowRenderer:IR,agDetailCellRenderer:KH},this.wrapIncoming=(e,t)=>t==="ensureVisible"?cH(e):e(),this.renderingEngine="react"}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}},qH=class extends b.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=(e,t)=>{this.api=e,this.columnApi=t,this.apiListeners.forEach(s=>s(e))}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return Pe.createElement(HI,Ti(us({},this.props),{setGridApi:this.setGridApi}))}};const QH={},MR=e=>{let t;const s=new Set,i=(h,p)=>{const g=typeof h=="function"?h(t):h;if(!Object.is(g,t)){const m=t;t=p??(typeof g!="object"||g===null)?g:Object.assign({},t,g),s.forEach(C=>C(t,m))}},r=()=>t,l={setState:i,getState:r,getInitialState:()=>u,subscribe:h=>(s.add(h),()=>s.delete(h)),destroy:()=>{(QH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},u=t=e(i,r,l);return l},ZH=e=>e?MR(e):MR;var jI={exports:{}},WI={},zI={exports:{}},UI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pu=b;function JH(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var XH=typeof Object.is=="function"?Object.is:JH,ej=pu.useState,tj=pu.useEffect,sj=pu.useLayoutEffect,ij=pu.useDebugValue;function rj(e,t){var s=t(),i=ej({inst:{value:s,getSnapshot:t}}),r=i[0].inst,n=i[1];return sj(function(){r.value=s,r.getSnapshot=t,NC(r)&&n({inst:r})},[e,s,t]),tj(function(){return NC(r)&&n({inst:r}),e(function(){NC(r)&&n({inst:r})})},[e]),ij(s),s}function NC(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!XH(e,s)}catch{return!0}}function nj(e,t){return t()}var oj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?nj:rj;UI.useSyncExternalStore=pu.useSyncExternalStore!==void 0?pu.useSyncExternalStore:oj;zI.exports=UI;var aj=zI.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cv=b,lj=aj;function cj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var uj=typeof Object.is=="function"?Object.is:cj,dj=lj.useSyncExternalStore,hj=Cv.useRef,pj=Cv.useEffect,gj=Cv.useMemo,fj=Cv.useDebugValue;WI.useSyncExternalStoreWithSelector=function(e,t,s,i,r){var n=hj(null);if(n.current===null){var o={hasValue:!1,value:null};n.current=o}else o=n.current;n=gj(function(){function l(m){if(!u){if(u=!0,h=m,m=i(m),r!==void 0&&o.hasValue){var C=o.value;if(r(C,m))return p=C}return p=m}if(C=p,uj(h,m))return C;var y=i(m);return r!==void 0&&r(C,y)?(h=m,C):(h=m,p=y)}var u=!1,h,p,g=s===void 0?null:s;return[function(){return l(t())},g===null?void 0:function(){return l(g())}]},[t,s,i,r]);var a=dj(e,n[0],n[1]);return pj(function(){o.hasValue=!0,o.value=a},[a]),fj(a),a};jI.exports=WI;var mj=jI.exports;const vj=hm(mj),$I={},{useDebugValue:Cj}=Pe,{useSyncExternalStoreWithSelector:yj}=vj;let LR=!1;const wj=e=>e;function Sj(e,t=wj,s){($I?"production":void 0)!=="production"&&s&&!LR&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),LR=!0);const i=yj(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return Cj(i),i}const xj=e=>{($I?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?ZH(e):e,s=(i,r)=>Sj(t,i,r);return Object.assign(s,t),s},bj=e=>xj,Ej={};function Rj(e,t){let s;try{s=e()}catch{return}return{getItem:r=>{var n;const o=l=>l===null?null:JSON.parse(l,void 0),a=(n=s.getItem(r))!=null?n:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,n)=>s.setItem(r,JSON.stringify(n,void 0)),removeItem:r=>s.removeItem(r)}}const Gh=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(i){return Gh(i)(s)},catch(i){return this}}}catch(s){return{then(i){return this},catch(i){return Gh(i)(s)}}}},Tj=(e,t)=>(s,i,r)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:R=>R,version:0,merge:(R,x)=>({...x,...R}),...t},o=!1;const a=new Set,l=new Set;let u;try{u=n.getStorage()}catch{}if(!u)return e((...R)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),s(...R)},i,r);const h=Gh(n.serialize),p=()=>{const R=n.partialize({...i()});let x;const S=h({state:R,version:n.version}).then(T=>u.setItem(n.name,T)).catch(T=>{x=T});if(x)throw x;return S},g=r.setState;r.setState=(R,x)=>{g(R,x),p()};const m=e((...R)=>{s(...R),p()},i,r);let C;const y=()=>{var R;if(!u)return;o=!1,a.forEach(S=>S(i()));const x=((R=n.onRehydrateStorage)==null?void 0:R.call(n,i()))||void 0;return Gh(u.getItem.bind(u))(n.name).then(S=>{if(S)return n.deserialize(S)}).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==n.version){if(n.migrate)return n.migrate(S.state,S.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return S.state}).then(S=>{var T;return C=n.merge(S,(T=i())!=null?T:m),s(C,!0),p()}).then(()=>{x==null||x(C,void 0),o=!0,l.forEach(S=>S(C))}).catch(S=>{x==null||x(void 0,S)})};return r.persist={setOptions:R=>{n={...n,...R},R.getStorage&&(u=R.getStorage())},clearStorage:()=>{u==null||u.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:R=>(a.add(R),()=>{a.delete(R)}),onFinishHydration:R=>(l.add(R),()=>{l.delete(R)})},y(),C||m},Dj=(e,t)=>(s,i,r)=>{let n={storage:Rj(()=>localStorage),partialize:y=>y,version:0,merge:(y,R)=>({...R,...y}),...t},o=!1;const a=new Set,l=new Set;let u=n.storage;if(!u)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),s(...y)},i,r);const h=()=>{const y=n.partialize({...i()});return u.setItem(n.name,{state:y,version:n.version})},p=r.setState;r.setState=(y,R)=>{p(y,R),h()};const g=e((...y)=>{s(...y),h()},i,r);r.getInitialState=()=>g;let m;const C=()=>{var y,R;if(!u)return;o=!1,a.forEach(S=>{var T;return S((T=i())!=null?T:g)});const x=((R=n.onRehydrateStorage)==null?void 0:R.call(n,(y=i())!=null?y:g))||void 0;return Gh(u.getItem.bind(u))(n.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==n.version){if(n.migrate)return[!0,n.migrate(S.state,S.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var T;const[I,V]=S;if(m=n.merge(V,(T=i())!=null?T:g),s(m,!0),I)return h()}).then(()=>{x==null||x(m,void 0),m=i(),o=!0,l.forEach(S=>S(m))}).catch(S=>{x==null||x(void 0,S)})};return r.persist={setOptions:y=>{n={...n,...y},y.storage&&(u=y.storage)},clearStorage:()=>{u==null||u.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:y=>(a.add(y),()=>{a.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},n.skipHydration||C(),m||g},Pj=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Ej?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Tj(e,t)):Dj(e,t),Aj=Pj,Jt=["verified_foods","foods","manual_foods","user_added","ai_enhanced","ai_manually_added","tesco_products","uk_foods_cleaned","fast_foods_database","generic_database","consumer_foods"],Fj={verified_foods:"verifiedFoods",foods:"foods",manual_foods:"manualFoods",user_added:"userAdded",ai_enhanced:"aiEnhanced",ai_manually_added:"aiManuallyAdded",tesco_products:"tescoProducts",uk_foods_cleaned:null,fast_foods_database:null,generic_database:null,consumer_foods:"consumer_foods"},Nj=["uk_foods_cleaned","fast_foods_database","generic_database"],OR={searchQuery:"",indices:[...Jt],verified:"all",hasIssues:!1,hasDuplicates:!1,hasBarcode:!1,zeroCalories:!1,hasReport:!1},Ij=["selection","imageUrl","name","brandName","barcode","_sourceIndex","calories","protein","carbs","fat","fiber","sugar","sodium","servingSizeG","servingDescription","isVerified","_reviewFlags","actions"],oa=bj()(Aj((e,t)=>({foods:[],searchResults:[],isSearching:!1,selectedFoodIds:[],duplicateGroups:[],isLoading:!1,loadingProgress:0,loadingMessage:"",filters:OR,stats:null,undoStack:[],redoStack:[],columnOrder:Ij,dirtyFoodIds:new Set,foodReportIds:new Set,setFoods:s=>e({foods:s,dirtyFoodIds:new Set}),addFoods:s=>e(i=>({foods:[...i.foods,...s]})),updateFood:(s,i)=>e(r=>{const n=r.foods.findIndex(p=>p._id===s);if(n===-1)return r;const o=r.foods[n],a={...o,...i,_isDirty:!0},l=[...r.foods];l[n]=a;const u=new Set(r.dirtyFoodIds);u.add(s);const h={type:"update",food:a,previousState:o};return{foods:l,dirtyFoodIds:u,undoStack:[...r.undoStack,h],redoStack:[]}}),markFoodDeleted:s=>e(i=>{const r=i.foods.findIndex(l=>l._id===s);if(r===-1)return i;const n=i.foods[r],o=[...i.foods];o[r]={...n,_isDeleted:!0};const a={type:"delete",food:o[r],previousState:n};return{foods:o,undoStack:[...i.undoStack,a],redoStack:[]}}),restoreFood:s=>e(i=>{const r=i.foods.findIndex(o=>o._id===s);if(r===-1)return i;const n=[...i.foods];return n[r]={...n[r],_isDeleted:!1},{foods:n}}),setSelectedFoodIds:s=>e({selectedFoodIds:s}),toggleFoodSelection:s=>e(i=>({selectedFoodIds:i.selectedFoodIds.includes(s)?i.selectedFoodIds.filter(n=>n!==s):[...i.selectedFoodIds,s]})),selectAll:()=>e(()=>({selectedFoodIds:t().getFilteredFoods().map(s=>s._id)})),deselectAll:()=>e({selectedFoodIds:[]}),setFilters:s=>e(i=>({filters:{...i.filters,...s}})),clearFilters:()=>e({filters:OR}),setLoading:(s,i="")=>e({isLoading:s,loadingMessage:i}),setLoadingProgress:s=>e({loadingProgress:s}),setStats:s=>e({stats:s}),setDuplicateGroups:s=>e({duplicateGroups:s}),setColumnOrder:s=>e({columnOrder:s}),undo:()=>e(s=>{if(s.undoStack.length===0)return s;const i=s.undoStack[s.undoStack.length-1],r=s.undoStack.slice(0,-1);if(!i.previousState)return{undoStack:r};const n=s.foods.findIndex(a=>a._id===i.food._id);if(n===-1)return{undoStack:r};const o=[...s.foods];return o[n]=i.previousState,{foods:o,undoStack:r,redoStack:[...s.redoStack,i]}}),redo:()=>e(s=>{if(s.redoStack.length===0)return s;const i=s.redoStack[s.redoStack.length-1],r=s.redoStack.slice(0,-1),n=s.foods.findIndex(a=>a._id===i.food._id);if(n===-1)return{redoStack:r};const o=[...s.foods];return o[n]=i.food,{foods:o,redoStack:r,undoStack:[...s.undoStack,i]}}),pushUndo:s=>e(i=>({undoStack:[...i.undoStack,s],redoStack:[]})),clearDirty:()=>e(s=>({dirtyFoodIds:new Set,foods:s.foods.map(i=>({...i,_isDirty:!1}))})),getDirtyFoods:()=>t().foods.filter(i=>i._isDirty),setSearchResults:s=>e({searchResults:s,isSearching:!0}),setIsSearching:s=>e({isSearching:s}),clearSearch:()=>e({searchResults:[],isSearching:!1}),setFoodReportIds:s=>e({foodReportIds:s}),getFilteredFoods:()=>{const s=t(),{filters:i,foods:r,searchResults:n,isSearching:o}=s;return(o?n:r).filter(l=>{if(l._isDeleted||!i.indices.includes(l._sourceIndex)||i.verified==="verified"&&!l.isVerified||i.verified==="unverified"&&l.isVerified||i.hasIssues&&l._reviewFlags.length===0||i.hasBarcode&&!l.barcode||i.zeroCalories&&l.calories!==0||i.hasReport&&!s.foodReportIds.has(l.objectID))return!1;if(!o&&i.searchQuery){const u=i.searchQuery.toLowerCase();if(!`${l.name} ${l.brandName||""} ${l.barcode||""} ${l.ingredientsText||""}`.toLowerCase().includes(u))return!1}return!0})},getFoodById:s=>{const i=t();return i.foods.find(r=>r._id===s)||i.searchResults.find(r=>r._id===s)}}),{name:"nutrasafe-grid-store",partialize:e=>({columnOrder:e.columnOrder,filters:{indices:e.filters.indices}})})),IC="https://us-central1-nutrasafe-705c7.cloudfunctions.net",_j=({food:e,onClose:t,onDelete:s,onSaveImage:i,isDeleting:r,isSaving:n})=>{const[o,a]=b.useState(e.imageUrl||""),[l,u]=b.useState(e.imageUrl||""),h=o!==(e.imageUrl||""),p=()=>{u(o)},g=()=>{o.trim()&&i(o.trim())};return c.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",onClick:t,children:c.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full mx-4 overflow-hidden",onClick:m=>m.stopPropagation(),children:[c.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),e.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:e.brandName})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 p-1",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-6 bg-gray-50 flex items-center justify-center min-h-[300px]",children:l?c.jsx("img",{src:l,alt:e.name,className:"max-h-[400px] max-w-full object-contain rounded-lg shadow",onError:m=>{m.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23f3f4f6" width="200" height="200"/%3E%3Ctext fill="%239ca3af" x="50%25" y="50%25" text-anchor="middle" dy=".3em" font-size="14"%3EImage failed to load%3C/text%3E%3C/svg%3E'}}):c.jsxs("div",{className:"text-gray-400 text-center",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("p",{children:"No image"})]})}),c.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"url",value:o,onChange:m=>a(m.target.value),placeholder:"https://example.com/image.jpg",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),c.jsx("button",{onClick:p,disabled:!o.trim(),className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Preview"})]})]}),c.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-white",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Source: ",c.jsx("span",{className:"font-medium",children:e._sourceIndex})]}),c.jsxs("div",{className:"flex gap-2",children:[e.imageUrl&&c.jsx("button",{onClick:s,disabled:r||n,className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 ${r||n?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-600 hover:bg-red-100"}`,children:r?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Deleting..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})}),h&&o.trim()&&c.jsx("button",{onClick:g,disabled:n||r,className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 ${n||r?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:n?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Saving..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Image"]})})]})]})]})})};let Qf=null;const kj=e=>{const t=e.value,s=e.data,i=()=>{s&&Qf&&Qf(s)};return t?c.jsx("img",{src:t,alt:"",className:"w-12 h-12 object-cover rounded cursor-pointer hover:opacity-80 transition-opacity",onClick:i,title:"Click to view image",onError:r=>{r.target.style.display="none"}}):c.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gray-100 rounded text-gray-400 text-xs cursor-pointer hover:bg-gray-200",onClick:i,title:"Click to view/add image",children:"No img"})},Mj=e=>{var n;const t=e.value,s=(n=e.data)==null?void 0:n._id,i=oa(o=>o.foodReportIds),r=s&&i.has(s);return c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{children:t}),r&&c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-700",title:"Has user report",children:""})]})},Lj=e=>{const t=e.value,s={verified_foods:"bg-green-100 text-green-800",foods:"bg-blue-100 text-blue-800",manual_foods:"bg-purple-100 text-purple-800",user_added:"bg-yellow-100 text-yellow-800",ai_enhanced:"bg-pink-100 text-pink-800",ai_manually_added:"bg-indigo-100 text-indigo-800",tesco_products:"bg-orange-100 text-orange-800",uk_foods_cleaned:"bg-cyan-100 text-cyan-800",fast_foods_database:"bg-red-100 text-red-800",generic_database:"bg-gray-100 text-gray-800",consumer_foods:"bg-teal-100 text-teal-800"},i={verified_foods:"Verified",foods:"Foods",manual_foods:"Manual",user_added:"User",ai_enhanced:"AI",ai_manually_added:"AI Manual",tesco_products:"Tesco",uk_foods_cleaned:"UK Clean",fast_foods_database:"Fast Food",generic_database:"Generic",consumer_foods:"Consumer"};return c.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s[t]}`,children:i[t]})},Oj=e=>{const t=e.value;return c.jsx("span",{className:`inline-flex items-center ${t?"text-green-600":"text-gray-400"}`,children:t?c.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("circle",{cx:"12",cy:"12",r:"10",strokeWidth:"2"})})})},Gj=e=>{const t=e.value;return c.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${t?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-600"}`,children:t?"Per Unit":"Per 100g"})},Vj=e=>{var n;const t=((n=e.data)==null?void 0:n._reviewFlags)||[];if(t.length===0)return c.jsx("span",{className:"text-gray-400 text-xs",children:"None"});const s=t.filter(o=>o.severity==="error").length,i=t.filter(o=>o.severity==="warning").length,r=t.filter(o=>o.severity==="info").length;return c.jsxs("div",{className:"flex gap-1",children:[s>0&&c.jsx("span",{className:"px-1.5 py-0.5 bg-red-100 text-red-700 rounded text-xs",title:t.filter(o=>o.severity==="error").map(o=>o.message).join(`
`),children:s}),i>0&&c.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-700 rounded text-xs",title:t.filter(o=>o.severity==="warning").map(o=>o.message).join(`
`),children:i}),r>0&&c.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",title:t.filter(o=>o.severity==="info").map(o=>o.message).join(`
`),children:r})]})},Ga=e=>{const t=e.value;if(t==null)return c.jsx("span",{className:"text-gray-400",children:"-"});const s=Number.isInteger(t)?t.toString():t.toFixed(1);return c.jsx("span",{className:"font-mono text-right",children:s})},Bj=()=>{const e=b.useRef(null),t=b.useRef(null),s=b.useRef(null),i=b.useRef(new Map),[r,n]=b.useState("idle"),[o,a]=b.useState(null),[l,u]=b.useState(!1),[h,p]=b.useState(!1);b.useEffect(()=>(Qf=a,()=>{Qf=null}),[]);const{getFilteredFoods:g,setSelectedFoodIds:m,updateFood:C,setColumnOrder:y}=oa(),R=g(),x=b.useCallback(async E=>{try{const F={foodId:E.objectID,indexName:E._sourceIndex,updates:{foodName:E.name,brandName:E.brandName,barcode:E.barcode,servingSizeG:E.servingSizeG,servingSize:E.servingDescription,isPerUnit:E.isPerUnit,nutrition:{calories:E.calories,protein:E.protein,carbs:E.carbs,fat:E.fat,fiber:E.fiber,sugar:E.sugar,sodium:E.sodium,saturatedFat:E.saturatedFat}}};return console.log(" Saving to backend:",JSON.stringify(F,null,2)),(await(await fetch(`${IC}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).json()).success}catch(F){return console.error("Auto-save error:",F),!1}},[]),S=b.useCallback(E=>{i.current.set(E._id,E),s.current&&clearTimeout(s.current),n("saving"),s.current=setTimeout(async()=>{const F=Array.from(i.current.values());i.current.clear();let J=!0;for(const Y of F)await x(Y)||(J=!1);n(J?"saved":"error"),setTimeout(()=>n("idle"),2e3)},1e3)},[x]),T=b.useMemo(()=>[{headerCheckboxSelection:!0,checkboxSelection:!0,width:50,pinned:"left",lockPosition:!0,suppressMenu:!0,resizable:!1},{field:"imageUrl",headerName:"Image",width:80,cellRenderer:kj,editable:!1,filter:!1,sortable:!1},{field:"name",headerName:"Name",width:250,editable:!0,filter:"agTextColumnFilter",sortable:!0,cellClass:"font-medium",cellRenderer:Mj},{field:"brandName",headerName:"Brand",width:150,editable:!0,filter:"agTextColumnFilter",sortable:!0},{field:"barcode",headerName:"Barcode",width:130,editable:!0,filter:"agTextColumnFilter",sortable:!0,cellClass:"font-mono text-sm"},{field:"_sourceIndex",headerName:"Source",width:100,cellRenderer:Lj,editable:!1,filter:"agSetColumnFilter",filterParams:{values:[...Jt]},sortable:!0},{field:"calories",headerName:"Cal",width:80,editable:!0,cellRenderer:Ga,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"protein",headerName:"Protein",width:80,editable:!0,cellRenderer:Ga,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"carbs",headerName:"Carbs",width:80,editable:!0,cellRenderer:Ga,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"fat",headerName:"Fat",width:70,editable:!0,cellRenderer:Ga,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"fiber",headerName:"Fibre",width:70,editable:!0,cellRenderer:Ga,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"sugar",headerName:"Sugar",width:70,editable:!0,cellRenderer:Ga,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"sodium",headerName:"Sodium",width:80,editable:!0,cellRenderer:Ga,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"servingSizeG",headerName:"Serving (g)",width:100,editable:!0,valueGetter:E=>{var F;return(F=E.data)==null?void 0:F.servingSizeG},valueFormatter:E=>E.value==null?"-":`${E.value}g`,valueParser:E=>{if(!E.newValue)return null;const F=String(E.newValue).toLowerCase().replace(/[^0-9.]/g,""),J=parseFloat(F);return console.log(`servingSizeG parser: "${E.newValue}" -> ${J}`),isNaN(J)?null:J},filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"servingDescription",headerName:"Serving Desc",width:120,editable:!0,valueFormatter:E=>E.value||"-",filter:"agTextColumnFilter",sortable:!0},{field:"isPerUnit",headerName:"Per Unit",width:90,cellRenderer:Gj,editable:!0,filter:"agSetColumnFilter",filterParams:{values:[!0,!1],valueFormatter:E=>E.value?"Per Unit":"Per 100g"},sortable:!0,cellEditor:"agSelectCellEditor",cellEditorParams:{values:[!0,!1]},valueFormatter:E=>E.value?"Per Unit":"Per 100g"},{field:"isVerified",headerName:"Verified",width:90,cellRenderer:Oj,editable:!1,filter:"agSetColumnFilter",filterParams:{values:[!0,!1],valueFormatter:E=>E.value?"Verified":"Unverified"},sortable:!0},{field:"_reviewFlags",headerName:"Issues",width:100,cellRenderer:Vj,editable:!1,filter:!1,sortable:!1},{field:"_confidenceScore",headerName:"Score",width:80,editable:!1,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn",valueFormatter:E=>E.value?`${E.value}%`:"-"}],[]),I=b.useMemo(()=>({resizable:!0,suppressMovable:!1}),[]),V=b.useCallback(E=>{t.current=E.api},[]),j=b.useCallback(E=>{if(E.data&&E.colDef.field){const F=E.colDef.field;C(E.data._id,{[F]:E.newValue});const J={...E.data,[F]:E.newValue};S(J)}},[C,S]),P=b.useCallback(E=>{if(t.current){const F=t.current.getSelectedRows();m(F.map(J=>J._id))}},[m]),N=b.useCallback(E=>{if(t.current){const J=t.current.getAllDisplayedColumns().map(Y=>Y.getColId());y(J)}},[y]);b.useEffect(()=>{const E=F=>{(F.metaKey||F.ctrlKey)&&F.key==="s"&&(F.preventDefault(),console.log("Save triggered")),(F.metaKey||F.ctrlKey)&&F.key==="z"&&!F.shiftKey&&(F.preventDefault(),oa.getState().undo()),(F.metaKey||F.ctrlKey)&&F.key==="z"&&F.shiftKey&&(F.preventDefault(),oa.getState().redo())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[]);const _=b.useMemo(()=>({"bg-red-50":E=>{var F;return((F=E.data)==null?void 0:F._isDeleted)===!0},"bg-yellow-50":E=>{var F;return((F=E.data)==null?void 0:F._isDirty)===!0},"bg-red-100":E=>{var F,J;return((J=(F=E.data)==null?void 0:F._reviewFlags)==null?void 0:J.some(Y=>Y.severity==="error"))===!0}}),[]),L=b.useCallback(async()=>{if(!(!o||!window.confirm(`Are you sure you want to delete the image for "${o.name}"?

This action cannot be undone.`))){u(!0);try{const F={foodId:o.objectID,indexName:o._sourceIndex,updates:{imageUrl:null}};console.log(" Deleting image:",F);const Y=await(await fetch(`${IC}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).json();if(Y.success)C(o._id,{imageUrl:null}),t.current&&t.current.refreshCells({force:!0}),a(null),console.log(" Image deleted successfully");else throw new Error(Y.error||"Failed to delete image")}catch(F){console.error("Delete image error:",F),alert(`Failed to delete image: ${F instanceof Error?F.message:String(F)}`)}finally{u(!1)}}},[o,C]),M=b.useCallback(async E=>{if(o){p(!0);try{const F={foodId:o.objectID,indexName:o._sourceIndex,updates:{imageUrl:E}};console.log(" Saving image:",F);const Y=await(await fetch(`${IC}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).json();if(Y.success)C(o._id,{imageUrl:E}),t.current&&t.current.refreshCells({force:!0}),a(null),console.log(" Image saved successfully");else throw new Error(Y.error||"Failed to save image")}catch(F){console.error("Save image error:",F),alert(`Failed to save image: ${F instanceof Error?F.message:String(F)}`)}finally{p(!1)}}},[o,C]);return c.jsxs("div",{className:"ag-theme-alpine w-full h-full relative",children:[r!=="idle"&&c.jsxs("div",{className:`absolute top-2 right-2 z-10 px-3 py-1.5 rounded-full text-sm font-medium shadow-lg flex items-center gap-2 ${r==="saving"?"bg-yellow-100 text-yellow-800":r==="saved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[r==="saving"&&c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Saving..."]}),r==="saved"&&c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),r==="error"&&c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Save failed"]})]}),c.jsx(qH,{ref:e,rowData:R,columnDefs:T,defaultColDef:I,rowSelection:"multiple",suppressRowClickSelection:!0,getRowId:E=>E.data._id,onGridReady:V,onCellValueChanged:j,onRowSelected:P,onColumnMoved:N,rowClassRules:_,animateRows:!0,enableCellTextSelection:!0,suppressCopyRowsToClipboard:!1,rowBuffer:20,cacheBlockSize:100,maxBlocksInCache:10,rowHeight:56,headerHeight:40}),o&&c.jsx(_j,{food:o,onClose:()=>a(null),onDelete:L,onSaveImage:M,isDeleting:l,isSaving:h})]})};var KI={exports:{}};/*! algoliasearch-lite.umd.js | 4.25.3 |  Algolia, inc. | https://github.com/algolia/algoliasearch-client-javascript */(function(e,t){(function(s,i){e.exports=i()})(mk,function(){function s(se,ne,B){return ne in se?Object.defineProperty(se,ne,{value:B,enumerable:!0,configurable:!0,writable:!0}):se[ne]=B,se}function i(se,ne){var B=Object.keys(se);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(se);ne&&($=$.filter(function(K){return Object.getOwnPropertyDescriptor(se,K).enumerable})),B.push.apply(B,$)}return B}function r(se){for(var ne=1;ne<arguments.length;ne++){var B=arguments[ne]!=null?arguments[ne]:{};ne%2?i(Object(B),!0).forEach(function($){s(se,$,B[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(se,Object.getOwnPropertyDescriptors(B)):i(Object(B)).forEach(function($){Object.defineProperty(se,$,Object.getOwnPropertyDescriptor(B,$))})}return se}function n(se,ne){if(se==null)return{};var B,$,K=function(oe,Z){if(oe==null)return{};var k,O,W={},ue=Object.keys(oe);for(O=0;O<ue.length;O++)k=ue[O],Z.indexOf(k)>=0||(W[k]=oe[k]);return W}(se,ne);if(Object.getOwnPropertySymbols){var Q=Object.getOwnPropertySymbols(se);for($=0;$<Q.length;$++)B=Q[$],ne.indexOf(B)>=0||Object.prototype.propertyIsEnumerable.call(se,B)&&(K[B]=se[B])}return K}function o(se,ne){return function(B){if(Array.isArray(B))return B}(se)||function(B,$){if(Symbol.iterator in Object(B)||Object.prototype.toString.call(B)==="[object Arguments]"){var K=[],Q=!0,oe=!1,Z=void 0;try{for(var k,O=B[Symbol.iterator]();!(Q=(k=O.next()).done)&&(K.push(k.value),!$||K.length!==$);Q=!0);}catch(W){oe=!0,Z=W}finally{try{Q||O.return==null||O.return()}finally{if(oe)throw Z}}return K}}(se,ne)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(se){return function(ne){if(Array.isArray(ne)){for(var B=0,$=new Array(ne.length);B<ne.length;B++)$[B]=ne[B];return $}}(se)||function(ne){if(Symbol.iterator in Object(ne)||Object.prototype.toString.call(ne)==="[object Arguments]")return Array.from(ne)}(se)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(se){var ne,B="algoliasearch-client-js-".concat(se.key),$=function(){return ne===void 0&&(ne=se.localStorage||window.localStorage),ne},K=function(){return JSON.parse($().getItem(B)||"{}")},Q=function(Z){$().setItem(B,JSON.stringify(Z))},oe=function(){var Z=se.timeToLive?1e3*se.timeToLive:null,k=K(),O=Object.fromEntries(Object.entries(k).filter(function(ue){return o(ue,2)[1].timestamp!==void 0}));if(Q(O),Z){var W=Object.fromEntries(Object.entries(O).filter(function(ue){var ae=o(ue,2)[1],X=new Date().getTime();return!(ae.timestamp+Z<X)}));Q(W)}};return{get:function(Z,k){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}};return Promise.resolve().then(function(){oe();var W=JSON.stringify(Z);return K()[W]}).then(function(W){return Promise.all([W?W.value:k(),W!==void 0])}).then(function(W){var ue=o(W,2),ae=ue[0],X=ue[1];return Promise.all([ae,X||O.miss(ae)])}).then(function(W){return o(W,1)[0]})},set:function(Z,k){return Promise.resolve().then(function(){var O=K();return O[JSON.stringify(Z)]={timestamp:new Date().getTime(),value:k},$().setItem(B,JSON.stringify(O)),k})},delete:function(Z){return Promise.resolve().then(function(){var k=K();delete k[JSON.stringify(Z)],$().setItem(B,JSON.stringify(k))})},clear:function(){return Promise.resolve().then(function(){$().removeItem(B)})}}}function u(se){var ne=a(se.caches),B=ne.shift();return B===void 0?{get:function($,K){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}},oe=K();return oe.then(function(Z){return Promise.all([Z,Q.miss(Z)])}).then(function(Z){return o(Z,1)[0]})},set:function($,K){return Promise.resolve(K)},delete:function($){return Promise.resolve()},clear:function(){return Promise.resolve()}}:{get:function($,K){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}};return B.get($,K,Q).catch(function(){return u({caches:ne}).get($,K,Q)})},set:function($,K){return B.set($,K).catch(function(){return u({caches:ne}).set($,K)})},delete:function($){return B.delete($).catch(function(){return u({caches:ne}).delete($)})},clear:function(){return B.clear().catch(function(){return u({caches:ne}).clear()})}}}function h(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{serializable:!0},ne={};return{get:function(B,$){var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}},Q=JSON.stringify(B);if(Q in ne)return Promise.resolve(se.serializable?JSON.parse(ne[Q]):ne[Q]);var oe=$(),Z=K&&K.miss||function(){return Promise.resolve()};return oe.then(function(k){return Z(k)}).then(function(){return oe})},set:function(B,$){return ne[JSON.stringify(B)]=se.serializable?JSON.stringify($):$,Promise.resolve($)},delete:function(B){return delete ne[JSON.stringify(B)],Promise.resolve()},clear:function(){return ne={},Promise.resolve()}}}function p(se){for(var ne=se.length-1;ne>0;ne--){var B=Math.floor(Math.random()*(ne+1)),$=se[ne];se[ne]=se[B],se[B]=$}return se}function g(se,ne){return ne&&Object.keys(ne).forEach(function(B){se[B]=ne[B](se)}),se}function m(se){for(var ne=arguments.length,B=new Array(ne>1?ne-1:0),$=1;$<ne;$++)B[$-1]=arguments[$];var K=0;return se.replace(/%s/g,function(){return encodeURIComponent(B[K++])})}var C={WithinQueryParameters:0,WithinHeaders:1};function y(se,ne){var B=se||{},$=B.data||{};return Object.keys(B).forEach(function(K){["timeout","headers","queryParameters","data","cacheable"].indexOf(K)===-1&&($[K]=B[K])}),{data:Object.entries($).length>0?$:void 0,timeout:B.timeout||ne,headers:B.headers||{},queryParameters:B.queryParameters||{},cacheable:B.cacheable}}var R={Read:1,Write:2,Any:3},x=1,S=2,T=3;function I(se){var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x;return r(r({},se),{},{status:ne,lastUpdate:Date.now()})}function V(se){return typeof se=="string"?{protocol:"https",url:se,accept:R.Any}:{protocol:se.protocol||"https",url:se.url,accept:se.accept||R.Any}}var j="GET",P="POST";function N(se,ne){return Promise.all(ne.map(function(B){return se.get(B,function(){return Promise.resolve(I(B))})})).then(function(B){var $=B.filter(function(oe){return function(Z){return Z.status===x||Date.now()-Z.lastUpdate>12e4}(oe)}),K=B.filter(function(oe){return function(Z){return Z.status===T&&Date.now()-Z.lastUpdate<=12e4}(oe)}),Q=[].concat(a($),a(K));return{getTimeout:function(oe,Z){return(K.length===0&&oe===0?1:K.length+3+oe)*Z},statelessHosts:Q.length>0?Q.map(function(oe){return V(oe)}):ne}})}function _(se,ne,B,$){var K=[],Q=function(ae,X){if(!(ae.method===j||ae.data===void 0&&X.data===void 0)){var q=Array.isArray(ae.data)?ae.data:r(r({},ae.data),X.data);return JSON.stringify(q)}}(B,$),oe=function(ae,X){var q=r(r({},ae.headers),X.headers),ie={};return Object.keys(q).forEach(function(we){var Ne=q[we];ie[we.toLowerCase()]=Ne}),ie}(se,$),Z=B.method,k=B.method!==j?{}:r(r({},B.data),$.data),O=r(r(r({"x-algolia-agent":se.userAgent.value},se.queryParameters),k),$.queryParameters),W=0,ue=function ae(X,q){var ie=X.pop();if(ie===void 0)throw{name:"RetryError",message:"Unreachable hosts - your application id may be incorrect. If the error persists, please reach out to the Algolia Support team: https://alg.li/support .",transporterStackTrace:F(K)};var we={data:Q,headers:oe,method:Z,url:M(ie,B.path,O),connectTimeout:q(W,se.timeouts.connect),responseTimeout:q(W,$.timeout)},Ne=function(Ee){var Oe={request:we,response:Ee,host:ie,triesLeft:X.length};return K.push(Oe),Oe},De={onSuccess:function(Ee){return function(Oe){try{return JSON.parse(Oe.content)}catch(Ue){throw function(ze,re){return{name:"DeserializationError",message:ze,response:re}}(Ue.message,Oe)}}(Ee)},onRetry:function(Ee){var Oe=Ne(Ee);return Ee.isTimedOut&&W++,Promise.all([se.logger.info("Retryable failure",J(Oe)),se.hostsCache.set(ie,I(ie,Ee.isTimedOut?T:S))]).then(function(){return ae(X,q)})},onFail:function(Ee){throw Ne(Ee),function(Oe,Ue){var ze=Oe.content,re=Oe.status,_t=ze;try{_t=JSON.parse(ze).message}catch{}return function(Gs,Xt,Pt){return{name:"ApiError",message:Gs,status:Xt,transporterStackTrace:Pt}}(_t,re,Ue)}(Ee,F(K))}};return se.requester.send(we).then(function(Ee){return function(Oe,Ue){return function(ze){var re=ze.status;return ze.isTimedOut||function(_t){var Gs=_t.isTimedOut,Xt=_t.status;return!Gs&&~~Xt==0}(ze)||~~(re/100)!=2&&~~(re/100)!=4}(Oe)?Ue.onRetry(Oe):~~(Oe.status/100)==2?Ue.onSuccess(Oe):Ue.onFail(Oe)}(Ee,De)})};return N(se.hostsCache,ne).then(function(ae){return ue(a(ae.statelessHosts).reverse(),ae.getTimeout)})}function L(se){var ne={value:"Algolia for JavaScript (".concat(se,")"),add:function(B){var $="; ".concat(B.segment).concat(B.version!==void 0?" (".concat(B.version,")"):"");return ne.value.indexOf($)===-1&&(ne.value="".concat(ne.value).concat($)),ne}};return ne}function M(se,ne,B){var $=E(B),K="".concat(se.protocol,"://").concat(se.url,"/").concat(ne.charAt(0)==="/"?ne.substr(1):ne);return $.length&&(K+="?".concat($)),K}function E(se){return Object.keys(se).map(function(ne){return m("%s=%s",ne,(B=se[ne],Object.prototype.toString.call(B)==="[object Object]"||Object.prototype.toString.call(B)==="[object Array]"?JSON.stringify(se[ne]):se[ne]));var B}).join("&")}function F(se){return se.map(function(ne){return J(ne)})}function J(se){var ne=se.request.headers["x-algolia-api-key"]?{"x-algolia-api-key":"*****"}:{};return r(r({},se),{},{request:r(r({},se.request),{},{headers:r(r({},se.request.headers),ne)})})}var Y=function(se){var ne=se.appId,B=function(K,Q,oe){var Z={"x-algolia-api-key":oe,"x-algolia-application-id":Q};return{headers:function(){return K===C.WithinHeaders?Z:{}},queryParameters:function(){return K===C.WithinQueryParameters?Z:{}}}}(se.authMode!==void 0?se.authMode:C.WithinHeaders,ne,se.apiKey),$=function(K){var Q=K.hostsCache,oe=K.logger,Z=K.requester,k=K.requestsCache,O=K.responsesCache,W=K.timeouts,ue=K.userAgent,ae=K.hosts,X=K.queryParameters,q={hostsCache:Q,logger:oe,requester:Z,requestsCache:k,responsesCache:O,timeouts:W,userAgent:ue,headers:K.headers,queryParameters:X,hosts:ae.map(function(ie){return V(ie)}),read:function(ie,we){var Ne=y(we,q.timeouts.read),De=function(){return _(q,q.hosts.filter(function(Oe){return(Oe.accept&R.Read)!=0}),ie,Ne)};if((Ne.cacheable!==void 0?Ne.cacheable:ie.cacheable)!==!0)return De();var Ee={request:ie,mappedRequestOptions:Ne,transporter:{queryParameters:q.queryParameters,headers:q.headers}};return q.responsesCache.get(Ee,function(){return q.requestsCache.get(Ee,function(){return q.requestsCache.set(Ee,De()).then(function(Oe){return Promise.all([q.requestsCache.delete(Ee),Oe])},function(Oe){return Promise.all([q.requestsCache.delete(Ee),Promise.reject(Oe)])}).then(function(Oe){var Ue=o(Oe,2);return Ue[0],Ue[1]})})},{miss:function(Oe){return q.responsesCache.set(Ee,Oe)}})},write:function(ie,we){return _(q,q.hosts.filter(function(Ne){return(Ne.accept&R.Write)!=0}),ie,y(we,q.timeouts.write))}};return q}(r(r({hosts:[{url:"".concat(ne,"-dsn.algolia.net"),accept:R.Read},{url:"".concat(ne,".algolia.net"),accept:R.Write}].concat(p([{url:"".concat(ne,"-1.algolianet.com")},{url:"".concat(ne,"-2.algolianet.com")},{url:"".concat(ne,"-3.algolianet.com")}]))},se),{},{headers:r(r(r({},B.headers()),{"content-type":"application/x-www-form-urlencoded"}),se.headers),queryParameters:r(r({},B.queryParameters()),se.queryParameters)}));return g({transporter:$,appId:ne,addAlgoliaAgent:function(K,Q){$.userAgent.add({segment:K,version:Q})},clearCache:function(){return Promise.all([$.requestsCache.clear(),$.responsesCache.clear()]).then(function(){})}},se.methods)},fe=function(se){return function(ne,B){return ne.method===j?se.transporter.read(ne,B):se.transporter.write(ne,B)}},me=function(se){return function(ne){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$={transporter:se.transporter,appId:se.appId,indexName:ne};return g($,B.methods)}},pe=function(se){return function(ne,B){var $=ne.map(function(K){return r(r({},K),{},{params:E(K.params||{})})});return se.transporter.read({method:P,path:"1/indexes/*/queries",data:{requests:$},cacheable:!0},B)}},ye=function(se){return function(ne,B){return Promise.all(ne.map(function($){var K=$.params,Q=K.facetName,oe=K.facetQuery,Z=n(K,["facetName","facetQuery"]);return me(se)($.indexName,{methods:{searchForFacetValues:ce}}).searchForFacetValues(Q,oe,r(r({},B),Z))}))}},Ae=function(se){return function(ne,B,$){return se.transporter.read({method:P,path:m("1/answers/%s/prediction",se.indexName),data:{query:ne,queryLanguages:B},cacheable:!0},$)}},te=function(se){return function(ne,B){return se.transporter.read({method:P,path:m("1/indexes/%s/query",se.indexName),data:{query:ne},cacheable:!0},B)}},ce=function(se){return function(ne,B,$){return se.transporter.read({method:P,path:m("1/indexes/%s/facets/%s/query",se.indexName,ne),data:{facetQuery:B},cacheable:!0},$)}},be=1,Ze=2,he=3,et=function(se){return function(ne,B){var $=ne.map(function(K){return r(r({},K),{},{threshold:K.threshold||0})});return se.transporter.read({method:P,path:"1/indexes/*/recommendations",data:{requests:$},cacheable:!0},B)}};function We(se,ne,B){var $,K={appId:se,apiKey:ne,timeouts:{connect:1,read:2,write:30},requester:{send:function(Q){return new Promise(function(oe){var Z=new XMLHttpRequest;Z.open(Q.method,Q.url,!0),Object.keys(Q.headers).forEach(function(ue){return Z.setRequestHeader(ue,Q.headers[ue])});var k,O=function(ue,ae){return setTimeout(function(){Z.abort(),oe({status:0,content:ae,isTimedOut:!0})},1e3*ue)},W=O(Q.connectTimeout,"Connection timeout");Z.onreadystatechange=function(){Z.readyState>Z.OPENED&&k===void 0&&(clearTimeout(W),k=O(Q.responseTimeout,"Socket timeout"))},Z.onerror=function(){Z.status===0&&(clearTimeout(W),clearTimeout(k),oe({content:Z.responseText||"Network request failed",status:Z.status,isTimedOut:!1}))},Z.onload=function(){clearTimeout(W),clearTimeout(k),oe({content:Z.responseText,status:Z.status,isTimedOut:!1})},Z.send(Q.data)})}},logger:($=he,{debug:function(Q,oe){return be>=$&&console.debug(Q,oe),Promise.resolve()},info:function(Q,oe){return Ze>=$&&console.info(Q,oe),Promise.resolve()},error:function(Q,oe){return console.error(Q,oe),Promise.resolve()}}),responsesCache:h(),requestsCache:h({serializable:!1}),hostsCache:u({caches:[l({key:"".concat("4.25.3","-").concat(se)}),h()]}),userAgent:L("4.25.3").add({segment:"Browser",version:"lite"}),authMode:C.WithinQueryParameters};return Y(r(r(r({},K),B),{},{methods:{search:pe,searchForFacetValues:ye,multipleQueries:pe,multipleSearchForFacetValues:ye,customRequest:fe,initIndex:function(Q){return function(oe){return me(Q)(oe,{methods:{search:te,searchForFacetValues:ce,findAnswers:Ae}})}},getRecommendations:et}}))}return We.version="4.25.3",We})})(KI);var Hj=KI.exports;const jj=hm(Hj),Wj="WK0TIF84M2",zj="577cc4ee3fed660318917bbb54abfb2e",Cx=jj(Wj,zj);function YI(e,t){var J,Y;const s=e.objectID||"",i=e.name||e.foodName||e.title||"",r=e.brandName||e.brand||null,n=e.barcode||e.gtin||e.ean||null;let o=[],a=null;e.ingredients&&(Array.isArray(e.ingredients)?(o=e.ingredients,a=o.join(", ")):typeof e.ingredients=="string"&&(a=e.ingredients,o=e.ingredients.split(/,\s*/))),e.extractedIngredients&&(a=e.extractedIngredients,o.length||(o=a.split(/,\s*/)));const l=Number(e.calories||e.energyKcal||0),u=Number(e.protein||0),h=Number(e.carbs||e.carbohydrate||e.carbohydrates||0),p=Number(e.fat||0),g=e.saturatedFat!==void 0?Number(e.saturatedFat||e.saturates||0):null,m=Number(e.fiber||e.fibre||0),C=Number(e.sugar||e.sugars||0),y=Number(e.sodium||0),R=e.salt!==void 0?Number(e.salt):null,x=e.servingDescription||e.servingSize||e.serving_description||null,S=e.servingSizeG!==void 0?Number(e.servingSizeG||e.serving_size_g||0):null,T=!!(e.per_unit_nutrition||e.isPerUnit),I=!!(e.verified||e.isVerified),V=e.verifiedBy||null,j=e.verifiedAt?new Date(e.verifiedAt):null,P=e.imageUrl||e.image_url||null,N=e.category||e.department||null,_=e.source||null,L=e.createdAt?new Date((J=e.createdAt)!=null&&J._seconds?e.createdAt._seconds*1e3:e.createdAt*1e3):null,M=e.updatedAt?new Date((Y=e.updatedAt)!=null&&Y._seconds?e.updatedAt._seconds*1e3:e.updatedAt*1e3):null,E=Uj({name:i,calories:l,protein:u,carbs:h,fat:p,barcode:n,ingredients:o}),F=$j({name:i,brandName:r,barcode:n,ingredients:o,calories:l,isVerified:I,imageUrl:P});return{_id:`${t}:${s}`,objectID:s,_sourceIndex:t,_firestoreCollection:Fj[t],_hasFirestoreBacking:!Nj.includes(t),name:i,brandName:r,barcode:n,barcodes:n?[n]:[],ingredients:o,ingredientsText:a,calories:l,protein:u,carbs:h,fat:p,saturatedFat:g,fiber:m,sugar:C,sodium:y,salt:R,servingDescription:x,servingSizeG:S,isPerUnit:T,isVerified:I,verifiedBy:V,verifiedAt:j,imageUrl:P,category:N,source:_,createdAt:L,updatedAt:M,_confidenceScore:F,_reviewFlags:E,_duplicateCandidates:[],_isDirty:!1,_isDeleted:!1}}function Uj(e){const t=[];if((!e.name||e.name.trim()==="")&&t.push({type:"missing_name",severity:"error",message:"Missing product name"}),e.calories===0&&e.protein===0&&e.carbs===0&&e.fat===0&&t.push({type:"missing_nutrition",severity:"error",message:"All nutrition values are zero"}),e.calories>900&&t.push({type:"implausible_calories",severity:"error",message:`Calories (${e.calories}) exceed 900 per 100g`}),e.calories>0){const n=e.protein*4+e.carbs*4+e.fat*9;Math.abs(e.calories-n)/e.calories>.3&&n>0&&t.push({type:"implausible_macros",severity:"warning",message:`Macros (${Math.round(n)} cal) don't match calories (${e.calories})`})}const s=["color","flavor","fiber","center"],i=`${e.name} ${e.ingredients.join(" ")}`.toLowerCase();return s.some(n=>i.includes(n))&&t.push({type:"non_uk",severity:"warning",message:"Contains US spelling (may not be UK product)"}),e.barcode||t.push({type:"missing_barcode",severity:"info",message:"No barcode available"}),e.ingredients.length||t.push({type:"missing_ingredients",severity:"info",message:"No ingredients listed"}),t}function $j(e){let t=0;return e.name&&e.name.trim()&&(t+=20),e.brandName&&(t+=10),e.barcode&&(t+=15),e.ingredients.length>0&&(t+=15),e.calories>0&&(t+=15),e.isVerified&&(t+=15),e.imageUrl&&(t+=10),Math.min(100,t)}async function qI(e,t="",s={}){const{page:i=0,hitsPerPage:r=100,filters:n}=s,o=Cx.initIndex(e);try{const a=await o.search(t,{page:i,hitsPerPage:r,filters:n});return{foods:a.hits.map(u=>YI(u,e)),total:a.nbHits,page:a.page}}catch(a){return console.error(`Error searching index ${e}:`,a),{foods:[],total:0,page:0}}}async function QI(e="",t=[...Jt],s={}){const{hitsPerPage:i=1e3}=s,r=await Promise.all(t.map(async u=>{const h=await qI(u,e,{hitsPerPage:i});return{indexName:u,...h}})),n=[],o={},a=["verified_foods","uk_foods_cleaned","tesco_products","manual_foods","ai_enhanced","user_added","foods","ai_manually_added","fast_foods_database","generic_database"];return r.sort((u,h)=>{const p=a.indexOf(u.indexName),g=a.indexOf(h.indexName);return(p===-1?999:p)-(g===-1?999:g)}).forEach(u=>{n.push(...u.foods),o[u.indexName]=u.total}),{foods:n,totalByIndex:o}}async function ZI(e,t=[...Jt]){const s=await Promise.all(t.map(async a=>{const l=await qI(a,"",{hitsPerPage:100,filters:`barcode:"${e}"`});return{indexName:a,...l}})),i=[],r={},n=["verified_foods","uk_foods_cleaned","tesco_products","manual_foods","ai_enhanced","user_added","foods","ai_manually_added","fast_foods_database","generic_database"];return s.sort((a,l)=>{const u=n.indexOf(a.indexName),h=n.indexOf(l.indexName);return(u===-1?999:u)-(h===-1?999:h)}).forEach(a=>{i.push(...a.foods),r[a.indexName]=a.total}),{foods:i,totalByIndex:r}}async function Kj(){const e={};return await Promise.all(Jt.map(async t=>{try{const i=await Cx.initIndex(t).search("",{hitsPerPage:0,analytics:!1});e[t]={entries:i.nbHits}}catch(s){console.error(`Error getting stats for ${t}:`,s),e[t]={entries:0}}})),e}async function Yj(e){for(const t of Jt)try{const i=await Cx.initIndex(t).search("",{filters:`objectID:${e}`,hitsPerPage:1});if(i.hits.length>0)return YI(i.hits[0],t)}catch{continue}return null}const qj=({onSave:e,onRefresh:t,onDeleteSelected:s,onMoveSelected:i,onReports:r,pendingReportsCount:n=0,isSaving:o,isDeleting:a,isMoving:l=!1})=>{const{filters:u,setFilters:h,selectedFoodIds:p,deselectAll:g,stats:m,getDirtyFoods:C,setSearchResults:y,clearSearch:R,isSearching:x}=oa(),[S,T]=b.useState(!1),[I,V]=b.useState(!1),[j,P]=b.useState(!1),[N,_]=b.useState(""),[L,M]=b.useState(!1),E=b.useRef(null),F=C().length,J=b.useCallback(async ce=>{if(!ce.trim()){R();return}P(!0);try{const{foods:be}=await QI(ce,u.indices,{hitsPerPage:500});y(be)}catch(be){console.error("Search error:",be)}finally{P(!1)}},[u.indices,y,R]),Y=b.useCallback(ce=>{const be=ce.target.value;h({searchQuery:be}),E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{J(be)},300)},[h,J]);b.useEffect(()=>()=>{E.current&&clearTimeout(E.current)},[]);const fe=b.useCallback(async()=>{if(N.trim()){M(!0);try{const{foods:ce}=await ZI(N.trim(),u.indices);y(ce),h({searchQuery:`Barcode: ${N}`})}catch(ce){console.error("Barcode search error:",ce)}finally{M(!1)}}},[N,u.indices,y,h]),me=b.useCallback(ce=>{h({verified:ce})},[h]),pe=b.useCallback(ce=>{const be=u.indices,Ze=be.includes(ce)?be.filter(he=>he!==ce):[...be,ce];h({indices:Ze})},[u.indices,h]),ye=b.useCallback(()=>{h({indices:[...Jt]})},[h]),Ae=b.useCallback(()=>{h({indices:[]})},[h]),te={verified_foods:"Verified",foods:"Foods",manual_foods:"Manual",user_added:"User",ai_enhanced:"AI Enhanced",ai_manually_added:"AI Manual",tesco_products:"Tesco",uk_foods_cleaned:"UK Cleaned",fast_foods_database:"Fast Food",generic_database:"Generic",consumer_foods:"Consumer"};return c.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-3",children:c.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-sm",children:"NS"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Food Database Manager"}),m&&c.jsxs("p",{className:"text-xs text-gray-500",children:[m.totalFoods.toLocaleString()," foods across ",Jt.length," indices"]})]})]}),c.jsxs("div",{className:"flex-1 max-w-md",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Search all foods across Algolia...",value:u.searchQuery,onChange:Y,className:`w-full px-4 py-2 pl-10 pr-10 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent ${x?"border-primary-400 bg-primary-50":"border-gray-300"}`}),j?c.jsxs("svg",{className:"absolute left-3 top-2.5 w-5 h-5 text-primary-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),u.searchQuery&&c.jsx("button",{onClick:()=>{h({searchQuery:""}),R()},className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x&&c.jsx("p",{className:"mt-1 text-xs text-primary-600",children:"Searching across all Algolia indices"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Barcode...",value:N,onChange:ce=>_(ce.target.value),onKeyDown:ce=>{ce.key==="Enter"&&fe()},className:"w-36 px-3 py-2 pl-8 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),c.jsx("svg",{className:"absolute left-2.5 top-2.5 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})]}),c.jsxs("button",{onClick:fe,disabled:!N.trim()||L,className:"flex items-center gap-1.5 px-3 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[L?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[c.jsx("button",{onClick:()=>me("all"),className:`px-3 py-1.5 text-sm ${u.verified==="all"?"bg-primary-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"All"}),c.jsx("button",{onClick:()=>me("verified"),className:`px-3 py-1.5 text-sm border-l ${u.verified==="verified"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Verified"}),c.jsx("button",{onClick:()=>me("unverified"),className:`px-3 py-1.5 text-sm border-l ${u.verified==="unverified"?"bg-yellow-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Unverified"})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>T(!S),className:"flex items-center gap-2 px-3 py-1.5 text-sm border border-gray-300 rounded-lg bg-white hover:bg-gray-50",children:[c.jsxs("span",{children:["Indices (",u.indices.length,")"]}),c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),S&&c.jsxs("div",{className:"absolute right-0 mt-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[c.jsxs("div",{className:"p-2 border-b border-gray-100 flex justify-between",children:[c.jsx("button",{onClick:ye,className:"text-xs text-primary-600 hover:underline",children:"Select All"}),c.jsx("button",{onClick:Ae,className:"text-xs text-gray-500 hover:underline",children:"Deselect All"})]}),c.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Jt.map(ce=>{var be;return c.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:u.indices.includes(ce),onChange:()=>pe(ce),className:"rounded text-primary-600 focus:ring-primary-500"}),c.jsx("span",{className:"text-sm text-gray-700",children:te[ce]}),m&&c.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:((be=m.byIndex[ce])==null?void 0:be.toLocaleString())||0})]},ce)})})]})]}),c.jsx("button",{onClick:()=>h({hasIssues:!u.hasIssues}),className:`px-3 py-1.5 text-sm border rounded-lg ${u.hasIssues?"bg-red-100 text-red-700 border-red-300":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Issues"}),c.jsx("button",{onClick:()=>h({zeroCalories:!u.zeroCalories}),className:`px-3 py-1.5 text-sm border rounded-lg ${u.zeroCalories?"bg-orange-100 text-orange-700 border-orange-300":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Show only foods with 0 calories",children:"0 Cal"}),c.jsx("button",{onClick:()=>h({hasReport:!u.hasReport}),className:`px-3 py-1.5 text-sm border rounded-lg ${u.hasReport?"bg-yellow-100 text-yellow-700 border-yellow-300":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Show only foods with user reports",children:" Reports"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[p.length>0&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-primary-50 text-primary-700 rounded-lg",children:[c.jsxs("span",{className:"text-sm font-medium",children:[p.length," selected"]}),c.jsx("button",{onClick:g,className:"text-primary-600 hover:text-primary-800",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i&&c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>V(!I),disabled:l,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[l?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),c.jsx("span",{className:"text-sm font-medium",children:"Move To"}),c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),I&&!l&&c.jsxs("div",{className:"absolute left-0 mt-1 w-56 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[c.jsx("div",{className:"p-2 border-b border-gray-100",children:c.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:["Move ",p.length," food(s) to:"]})}),c.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Jt.map(ce=>{var be;return c.jsxs("button",{onClick:()=>{i(ce),V(!1)},className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-blue-50 rounded transition-colors",children:[te[ce],m&&c.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",((be=m.byIndex[ce])==null?void 0:be.toLocaleString())||0," foods)"]})]},ce)})})]})]}),c.jsxs("button",{onClick:s,disabled:a,className:"flex items-center gap-2 px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[a?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),c.jsx("span",{className:"text-sm font-medium",children:"Delete"})]})]}),r&&c.jsxs("button",{onClick:r,className:`relative p-2 rounded-lg transition-colors ${n>0?"text-orange-600 hover:text-orange-700 hover:bg-orange-50":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,title:`User Reports${n>0?` (${n} pending)`:""}`,children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),n>0&&c.jsx("span",{className:"absolute -top-1 -right-1 flex items-center justify-center min-w-[18px] h-[18px] px-1 text-[10px] font-bold text-white bg-orange-500 rounded-full border-2 border-white",children:n>99?"99+":n})]}),c.jsx("button",{onClick:t,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",title:"Refresh data",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),c.jsxs("button",{onClick:e,disabled:F===0||o,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${F>0?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[o?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),c.jsxs("span",{children:["Save ",F>0?`(${F})`:""]})]})]})]})})},Qj=({onDetectDuplicates:e,onLookupOFF:t,onImageProcessing:s,onGoogleScraper:i,onReports:r,onMasterBuilder:n,onFoodCategorizer:o,isDetectingDuplicates:a,pendingReportsCount:l=0})=>{const{stats:u,duplicateGroups:h,filters:p,setFilters:g,getFilteredFoods:m,selectedFoodIds:C}=oa(),y=m(),R=y.filter(T=>T._reviewFlags.length>0).length,x={verified_foods:"bg-green-500",foods:"bg-blue-500",manual_foods:"bg-purple-500",user_added:"bg-yellow-500",ai_enhanced:"bg-pink-500",ai_manually_added:"bg-indigo-500",tesco_products:"bg-orange-500",uk_foods_cleaned:"bg-cyan-500",fast_foods_database:"bg-red-500",generic_database:"bg-gray-500",consumer_foods:"bg-teal-500"},S={verified_foods:"Verified",foods:"Foods",manual_foods:"Manual",user_added:"User",ai_enhanced:"AI",ai_manually_added:"AI Manual",tesco_products:"Tesco",uk_foods_cleaned:"UK",fast_foods_database:"Fast",generic_database:"Generic",consumer_foods:"Consumer"};return c.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[c.jsxs("div",{className:"p-4 border-b border-gray-100",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Overview"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.length.toLocaleString()}),c.jsx("div",{className:"text-xs text-gray-500",children:"Showing"})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(u==null?void 0:u.totalFoods.toLocaleString())||"-"}),c.jsx("div",{className:"text-xs text-gray-500",children:"Total"})]})]})]}),c.jsxs("div",{className:"p-4 border-b border-gray-100 flex-1 overflow-auto",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Indices"}),c.jsx("div",{className:"space-y-2",children:Jt.map(T=>{const I=(u==null?void 0:u.byIndex[T])||0,V=p.indices.includes(T),j=u!=null&&u.totalFoods?I/u.totalFoods*100:0;return c.jsxs("button",{onClick:()=>{V&&p.indices.length===1?g({indices:[...Jt]}):g(V?{indices:p.indices.filter(P=>P!==T)}:{indices:[T]})},className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${V?"bg-gray-100":"hover:bg-gray-50 opacity-60"}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${x[T]}`}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:S[T]})]}),c.jsx("span",{className:"text-sm text-gray-500",children:I.toLocaleString()})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:c.jsx("div",{className:`${x[T]} h-1 rounded-full transition-all`,style:{width:`${j}%`}})})]},T)})})]}),c.jsxs("div",{className:"p-4 border-b border-gray-100",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Data Quality"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-green-50 rounded-lg",children:[c.jsx("span",{className:"text-sm text-green-700",children:"Verified"}),c.jsx("span",{className:"text-sm font-medium text-green-700",children:(u==null?void 0:u.verified.toLocaleString())||0})]}),c.jsxs("button",{onClick:()=>g({hasIssues:!p.hasIssues}),className:`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-colors ${p.hasIssues?"bg-red-100":"bg-red-50 hover:bg-red-100"}`,children:[c.jsx("span",{className:"text-sm text-red-700",children:"With Issues"}),c.jsx("span",{className:"text-sm font-medium text-red-700",children:R.toLocaleString()})]}),c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-yellow-50 rounded-lg",children:[c.jsx("span",{className:"text-sm text-yellow-700",children:"Duplicates"}),c.jsx("span",{className:"text-sm font-medium text-yellow-700",children:h.length})]})]})]}),c.jsxs("div",{className:"p-4",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Actions"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("button",{onClick:e,disabled:a,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:[a?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),c.jsx("span",{children:"Detect Duplicates"})]}),c.jsxs("button",{onClick:t,className:`w-full flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors ${C.length>0?"text-primary-700 bg-primary-50 hover:bg-primary-100":"text-gray-700 bg-gray-50 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.jsx("span",{children:C.length>0?`Check UK Status (${C.length})`:"OpenFoodFacts Lookup"})]}),c.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),c.jsx("span",{children:"Add New Food"})]}),c.jsxs("button",{onClick:s,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("span",{children:"Image Processing"})]}),c.jsxs("button",{onClick:i,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})}),c.jsx("span",{children:"Google Image Scraper"})]}),c.jsxs("button",{onClick:r,className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${l>0?"text-orange-700 bg-orange-50 hover:bg-orange-100":"text-gray-700 bg-gray-50 hover:bg-gray-100"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("span",{children:"User Reports"})]}),l>0&&c.jsx("span",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold text-white bg-orange-500 rounded-full",children:l>99?"99+":l})]}),c.jsxs("button",{onClick:n,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-green-700 bg-green-50 hover:bg-green-100 rounded-lg transition-colors font-semibold",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),c.jsx("span",{children:"Master Builder"})]}),c.jsxs("button",{onClick:o,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors font-semibold",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),c.jsx("span",{children:"Food Categorizer"})]})]})]})]})},Zj=({message:e,progress:t})=>c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("svg",{className:"w-12 h-12 text-primary-600 animate-spin mx-auto",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),c.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:e}),t!==void 0&&c.jsxs("div",{className:"w-64 mx-auto",children:[c.jsxs("div",{className:"flex justify-between text-sm text-gray-500 mb-1",children:[c.jsx("span",{children:"Loading..."}),c.jsxs("span",{children:[Math.round(t),"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${t}%`}})})]})]})}),Jj="https://uk.openfoodfacts.org/api/v2",Xj="https://world.openfoodfacts.org/api/v2",GR=["en:united-kingdom","en:great-britain","en:england","en:scotland","en:wales","en:northern-ireland","en:uk"],e4=["50","539"],VR=["tesco","sainsbury","sainsburys","sainsbury's","asda","morrisons","waitrose","aldi","lidl","co-op","coop","marks & spencer","m&s","iceland","ocado","booths","budgens","costcutter","spar","londis","nisa","premier","one stop","farmfoods","heron foods","b&m","home bargains","poundland","wilko","superdrug","boots"],t4=["en:tesco","en:sainsburys","en:asda","en:morrisons","en:waitrose","en:aldi","en:lidl","en:co-op","en:marks-and-spencer","en:iceland","en:ocado","en:boots","en:superdrug","en:holland-and-barrett"],BR=[["colour","color"],["flavour","flavor"],["fibre","fiber"],["centre","center"],["litre","liter"],["grey","gray"],["organise","organize"],["recognise","recognize"],["favourite","favorite"],["honour","honor"],["defence","defense"],["licence","license"],["stabiliser","stabilizer"],["pasteurised","pasteurized"],["homogenised","homogenized"],["flavouring","flavoring"],["colouring","coloring"],["sulphur","sulfur"],["sulphite","sulfite"]],s4=["skimmed milk","semi-skimmed","full fat milk","double cream","single cream","clotted cream","cornflour","bicarbonate of soda","caster sugar","demerara","muscovado","golden syrup","treacle","marmite","bovril","hp sauce","worcestershire","crisps","biscuit","aubergine","courgette","coriander","rocket","swede","spring onion","porridge"];function i4(e){const t=[];let s=0,i=0;const r=30;s+=r;const n=e.countries_tags||[],o=n.some(he=>GR.includes(he.toLowerCase()));o?(i+=r,t.push({signal:"Country tags include UK",matched:!0,weight:r,details:n.filter(he=>GR.includes(he.toLowerCase())).join(", ")})):t.push({signal:"Country tags include UK",matched:!1,weight:r,details:n.length>0?`Found: ${n.slice(0,3).join(", ")}`:"No country tags"});const a=25;s+=a;const l=e.code||"",u=e4.some(he=>l.startsWith(he));u?(i+=a,t.push({signal:"UK barcode prefix (50/539)",matched:!0,weight:a,details:`Barcode: ${l}`})):t.push({signal:"UK barcode prefix (50/539)",matched:!1,weight:a,details:l?`Barcode starts with: ${l.substring(0,3)}`:"No barcode"});const h=20;s+=h;const p=(e.brands||"").toLowerCase(),g=(e.brands_tags||[]).map(he=>he.toLowerCase()),m=VR.find(he=>p.includes(he)||g.some(et=>et.includes(he.replace(/[^a-z]/g,""))));m?(i+=h,t.push({signal:"UK retailer brand",matched:!0,weight:h,details:`Matched: ${m}`})):t.push({signal:"UK retailer brand",matched:!1,weight:h,details:p||"No brand"});const C=15;s+=C;const y=e.stores_tags||[],R=e.purchase_places_tags||[],x=[...y,...R].map(he=>he.toLowerCase());x.some(he=>t4.some(et=>he.includes(et.replace("en:",""))))||x.some(he=>VR.some(et=>he.includes(et.replace(/[^a-z]/g,""))))?(i+=C,t.push({signal:"UK store/purchase location",matched:!0,weight:C,details:x.slice(0,3).join(", ")})):t.push({signal:"UK store/purchase location",matched:!1,weight:C,details:x.length>0?x.slice(0,3).join(", "):"No store data"});const T=10;s+=T;const I=((e.ingredients_text||"")+" "+(e.ingredients_text_en||"")).toLowerCase(),V=((e.product_name||"")+" "+(e.product_name_en||"")).toLowerCase(),j=I+" "+V,P=BR.filter(([he])=>j.includes(he)).map(([he])=>he),N=BR.filter(([,he])=>j.includes(he)).map(([,he])=>he);P.length>0&&P.length>=N.length?(i+=T,t.push({signal:"UK spelling patterns",matched:!0,weight:T,details:P.slice(0,3).join(", ")})):N.length>P.length?t.push({signal:"UK spelling patterns",matched:!1,weight:T,details:`US spellings found: ${N.slice(0,3).join(", ")}`}):t.push({signal:"UK spelling patterns",matched:!1,weight:T,details:"No distinctive spelling found"});const _=10;s+=_;const L=s4.filter(he=>j.includes(he.toLowerCase()));L.length>0?(i+=_,t.push({signal:"UK-specific terms",matched:!0,weight:_,details:L.slice(0,3).join(", ")})):t.push({signal:"UK-specific terms",matched:!1,weight:_,details:"No UK-specific terms found"});const M=5;s+=M;const E=e.nutriments||{},F=E.salt_100g!==void 0&&E.salt_100g>0,J=E.sodium_100g!==void 0&&!F;F?(i+=M,t.push({signal:"Salt labeling (UK style)",matched:!0,weight:M,details:`Salt: ${E.salt_100g}g per 100g`})):J?t.push({signal:"Salt labeling (UK style)",matched:!1,weight:M,details:"Sodium only (US style)"}):t.push({signal:"Salt labeling (UK style)",matched:!1,weight:M,details:"No salt/sodium data"});const Y=10;s+=Y;const fe=(e.origins||"").toLowerCase(),me=(e.origins_tags||[]).map(he=>he.toLowerCase()),pe=(e.manufacturing_places||"").toLowerCase(),ye=(e.manufacturing_places_tags||[]).map(he=>he.toLowerCase()),Ae=[fe,...me,pe,...ye].join(" ");["united kingdom","uk","britain","england","scotland","wales","northern ireland"].some(he=>Ae.includes(he))?(i+=Y,t.push({signal:"UK manufacturing/origin",matched:!0,weight:Y,details:Ae.substring(0,50)})):t.push({signal:"UK manufacturing/origin",matched:!1,weight:Y,details:Ae.length>0?Ae.substring(0,50):"No origin data"});const be=Math.round(i/s*100);return{isUKProduct:be>=40||o||u,confidenceScore:be,signals:t.sort((he,et)=>et.weight-he.weight)}}async function r4(e,t="UK"){var i,r,n,o,a;const s=(n=(r=(i=e.selected_images)==null?void 0:i.front)==null?void 0:r.display)==null?void 0:n.en;if(s)return{best_image_url:s,image_confidence_score:8,is_region_match:!0};if((a=(o=e.selected_images)==null?void 0:o.front)!=null&&a.display){const l=e.selected_images.front.display;for(const h of["en","uk","gb"])if(l[h])return{best_image_url:l[h],image_confidence_score:7,is_region_match:h==="en"};const u=Object.keys(l)[0];if(u&&l[u])return{best_image_url:l[u],image_confidence_score:6,is_region_match:!1}}if(e.image_front_url){const l=e.image_front_url.includes("front_en")||e.image_front_url.includes("front_uk");return{best_image_url:e.image_front_url,image_confidence_score:5,is_region_match:l}}return{best_image_url:null,image_confidence_score:0,is_region_match:!1}}async function HR(e,t="UK"){const s=e.replace(/\D/g,"");if(!s||s.length<8)return{product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:"Invalid barcode"};try{let i=await fetch(`${Jj}/product/${s}.json`),r=await i.json();if((r.status!==1||!r.product)&&(i=await fetch(`${Xj}/product/${s}.json`),r=await i.json()),r.status!==1||!r.product)return{product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:"Product not found"};const n=r.product,o=i4(n),a=await r4(n,t);return{product:n,isUKProduct:o.isUKProduct,ukConfidenceScore:o.confidenceScore,ukSignals:o.signals,bestImageUrl:a.best_image_url,imageConfidenceScore:a.image_confidence_score,isRegionMatch:a.is_region_match}}catch(i){return console.error("Error looking up product:",i),{product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:String(i)}}}function _C(e){const t=e.nutriments||{};return{name:e.product_name_en||e.product_name||"Unknown Product",brandName:e.brands||null,barcode:e.code,ingredientsText:e.ingredients_text_en||e.ingredients_text||null,calories:t["energy-kcal_100g"]||0,protein:t.proteins_100g||0,carbs:t.carbohydrates_100g||0,fat:t.fat_100g||0,saturatedFat:t["saturated-fat_100g"]??null,fiber:t.fiber_100g||0,sugar:t.sugars_100g||0,sodium:t.sodium_100g?t.sodium_100g*1e3:0,salt:t.salt_100g??null}}var jR={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JI=function(e){const t=[];let s=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[s++]=r:r<2048?(t[s++]=r>>6|192,t[s++]=r&63|128):(r&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++i)&1023),t[s++]=r>>18|240,t[s++]=r>>12&63|128,t[s++]=r>>6&63|128,t[s++]=r&63|128):(t[s++]=r>>12|224,t[s++]=r>>6&63|128,t[s++]=r&63|128)}return t},n4=function(e){const t=[];let s=0,i=0;for(;s<e.length;){const r=e[s++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const n=e[s++];t[i++]=String.fromCharCode((r&31)<<6|n&63)}else if(r>239&&r<365){const n=e[s++],o=e[s++],a=e[s++],l=((r&7)<<18|(n&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const n=e[s++],o=e[s++];t[i++]=String.fromCharCode((r&15)<<12|(n&63)<<6|o&63)}}return t.join("")},XI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const n=e[r],o=r+1<e.length,a=o?e[r+1]:0,l=r+2<e.length,u=l?e[r+2]:0,h=n>>2,p=(n&3)<<4|a>>4;let g=(a&15)<<2|u>>6,m=u&63;l||(m=64,o||(g=64)),i.push(s[h],s[p],s[g],s[m])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(JI(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):n4(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const s=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const n=s[e.charAt(r++)],a=r<e.length?s[e.charAt(r)]:0;++r;const u=r<e.length?s[e.charAt(r)]:64;++r;const p=r<e.length?s[e.charAt(r)]:64;if(++r,n==null||a==null||u==null||p==null)throw new o4;const g=n<<2|a>>4;if(i.push(g),u!==64){const m=a<<4&240|u>>2;if(i.push(m),p!==64){const C=u<<6&192|p;i.push(C)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a4=function(e){const t=JI(e);return XI.encodeByteArray(t,!0)},Zf=function(e){return a4(e).replace(/\./g,"")},l4=function(e){try{return XI.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4=()=>c4().__FIREBASE_DEFAULTS__,d4=()=>{if(typeof process>"u"||typeof jR>"u")return;const e=jR.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},h4=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&l4(e[1]);return t&&JSON.parse(t)},e_=()=>{try{return u4()||d4()||h4()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},p4=e=>{var t,s;return(s=(t=e_())===null||t===void 0?void 0:t.emulatorHosts)===null||s===void 0?void 0:s[e]},g4=e=>{const t=p4(e);if(!t)return;const s=t.lastIndexOf(":");if(s<=0||s+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(s+1),10);return t[0]==="["?[t.substring(1,s-1),i]:[t.substring(0,s),i]},t_=()=>{var e;return(e=e_())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}wrapCallback(t){return(s,i)=>{s?this.reject(s):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(s):t(s,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},i=t||"demo-project",r=e.iat||0,n=e.sub||e.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Zf(JSON.stringify(s)),Zf(JSON.stringify(o)),""].join(".")}function v4(){try{return typeof indexedDB=="object"}catch{return!1}}function C4(){return new Promise((e,t)=>{try{let s=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),s||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{s=!1},r.onerror=()=>{var n;t(((n=r.error)===null||n===void 0?void 0:n.message)||"")}}catch(s){t(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4="FirebaseError";class Vu extends Error{constructor(t,s,i){super(s),this.code=t,this.customData=i,this.name=y4,Object.setPrototypeOf(this,Vu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,s_.prototype.create)}}class s_{constructor(t,s,i){this.service=t,this.serviceName=s,this.errors=i}create(t,...s){const i=s[0]||{},r=`${this.service}/${t}`,n=this.errors[t],o=n?w4(n,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Vu(r,a,i)}}function w4(e,t){return e.replace(S4,(s,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const S4=/\{\$([^}]+)}/g;function Dw(e,t){if(e===t)return!0;const s=Object.keys(e),i=Object.keys(t);for(const r of s){if(!i.includes(r))return!1;const n=e[r],o=t[r];if(WR(n)&&WR(o)){if(!Dw(n,o))return!1}else if(n!==o)return!1}for(const r of i)if(!s.includes(r))return!1;return!0}function WR(e){return e!==null&&typeof e=="object"}class Vh{constructor(t,s,i){this.name=t,this.instanceFactory=s,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(t,s){this.name=t,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const s=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(s)){const i=new f4;if(this.instancesDeferred.set(s,i),this.isInitialized(s)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:s});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(t){var s;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(s=t==null?void 0:t.optional)!==null&&s!==void 0?s:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(n){if(r)return null;throw n}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(E4(t))try{this.getOrInitializeService({instanceIdentifier:$a})}catch{}for(const[s,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(s);try{const n=this.getOrInitializeService({instanceIdentifier:r});i.resolve(n)}catch{}}}}clearInstance(t=$a){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...t.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=$a){return this.instances.has(t)}getOptions(t=$a){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:s={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:s});for(const[n,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);i===a&&o.resolve(r)}return r}onInit(t,s){var i;const r=this.normalizeInstanceIdentifier(s),n=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;n.add(t),this.onInitCallbacks.set(r,n);const o=this.instances.get(r);return o&&t(o,r),()=>{n.delete(t)}}invokeOnInitCallbacks(t,s){const i=this.onInitCallbacks.get(s);if(i)for(const r of i)try{r(t,s)}catch{}}getOrInitializeService({instanceIdentifier:t,options:s={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:b4(t),options:s}),this.instances.set(t,i),this.instancesOptions.set(t,s),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=$a){return this.component?this.component.multipleInstances?t:$a:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function b4(e){return e===$a?void 0:e}function E4(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const s=this.getProvider(t.name);if(s.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);s.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const s=new x4(t,this);return this.providers.set(t,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Qt||(Qt={}));const T4={debug:Qt.DEBUG,verbose:Qt.VERBOSE,info:Qt.INFO,warn:Qt.WARN,error:Qt.ERROR,silent:Qt.SILENT},D4=Qt.INFO,P4={[Qt.DEBUG]:"log",[Qt.VERBOSE]:"log",[Qt.INFO]:"info",[Qt.WARN]:"warn",[Qt.ERROR]:"error"},A4=(e,t,...s)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),r=P4[t];if(r)console[r](`[${i}]  ${e.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class i_{constructor(t){this.name=t,this._logLevel=D4,this._logHandler=A4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Qt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?T4[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Qt.DEBUG,...t),this._logHandler(this,Qt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Qt.VERBOSE,...t),this._logHandler(this,Qt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Qt.INFO,...t),this._logHandler(this,Qt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Qt.WARN,...t),this._logHandler(this,Qt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Qt.ERROR,...t),this._logHandler(this,Qt.ERROR,...t)}}const F4=(e,t)=>t.some(s=>e instanceof s);let zR,UR;function N4(){return zR||(zR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function I4(){return UR||(UR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const r_=new WeakMap,Pw=new WeakMap,n_=new WeakMap,kC=new WeakMap,yx=new WeakMap;function _4(e){const t=new Promise((s,i)=>{const r=()=>{e.removeEventListener("success",n),e.removeEventListener("error",o)},n=()=>{s(aa(e.result)),r()},o=()=>{i(e.error),r()};e.addEventListener("success",n),e.addEventListener("error",o)});return t.then(s=>{s instanceof IDBCursor&&r_.set(s,e)}).catch(()=>{}),yx.set(t,e),t}function k4(e){if(Pw.has(e))return;const t=new Promise((s,i)=>{const r=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",o),e.removeEventListener("abort",o)},n=()=>{s(),r()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",n),e.addEventListener("error",o),e.addEventListener("abort",o)});Pw.set(e,t)}let Aw={get(e,t,s){if(e instanceof IDBTransaction){if(t==="done")return Pw.get(e);if(t==="objectStoreNames")return e.objectStoreNames||n_.get(e);if(t==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return aa(e[t])},set(e,t,s){return e[t]=s,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function M4(e){Aw=e(Aw)}function L4(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...s){const i=e.call(MC(this),t,...s);return n_.set(i,t.sort?t.sort():[t]),aa(i)}:I4().includes(e)?function(...t){return e.apply(MC(this),t),aa(r_.get(this))}:function(...t){return aa(e.apply(MC(this),t))}}function O4(e){return typeof e=="function"?L4(e):(e instanceof IDBTransaction&&k4(e),F4(e,N4())?new Proxy(e,Aw):e)}function aa(e){if(e instanceof IDBRequest)return _4(e);if(kC.has(e))return kC.get(e);const t=O4(e);return t!==e&&(kC.set(e,t),yx.set(t,e)),t}const MC=e=>yx.get(e);function G4(e,t,{blocked:s,upgrade:i,blocking:r,terminated:n}={}){const o=indexedDB.open(e,t),a=aa(o);return i&&o.addEventListener("upgradeneeded",l=>{i(aa(o.result),l.oldVersion,l.newVersion,aa(o.transaction),l)}),s&&o.addEventListener("blocked",l=>s(l.oldVersion,l.newVersion,l)),a.then(l=>{n&&l.addEventListener("close",()=>n()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const V4=["get","getKey","getAll","getAllKeys","count"],B4=["put","add","delete","clear"],LC=new Map;function $R(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(LC.get(t))return LC.get(t);const s=t.replace(/FromIndex$/,""),i=t!==s,r=B4.includes(s);if(!(s in(i?IDBIndex:IDBObjectStore).prototype)||!(r||V4.includes(s)))return;const n=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let u=l.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[s](...a),r&&l.done]))[0]};return LC.set(t,n),n}M4(e=>({...e,get:(t,s,i)=>$R(t,s)||e.get(t,s,i),has:(t,s)=>!!$R(t,s)||e.has(t,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(j4(s)){const i=s.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(s=>s).join(" ")}}function j4(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Fw="@firebase/app",KR="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go=new i_("@firebase/app"),W4="@firebase/app-compat",z4="@firebase/analytics-compat",U4="@firebase/analytics",$4="@firebase/app-check-compat",K4="@firebase/app-check",Y4="@firebase/auth",q4="@firebase/auth-compat",Q4="@firebase/database",Z4="@firebase/data-connect",J4="@firebase/database-compat",X4="@firebase/functions",eW="@firebase/functions-compat",tW="@firebase/installations",sW="@firebase/installations-compat",iW="@firebase/messaging",rW="@firebase/messaging-compat",nW="@firebase/performance",oW="@firebase/performance-compat",aW="@firebase/remote-config",lW="@firebase/remote-config-compat",cW="@firebase/storage",uW="@firebase/storage-compat",dW="@firebase/firestore",hW="@firebase/vertexai-preview",pW="@firebase/firestore-compat",gW="firebase",fW="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw="[DEFAULT]",mW={[Fw]:"fire-core",[W4]:"fire-core-compat",[U4]:"fire-analytics",[z4]:"fire-analytics-compat",[K4]:"fire-app-check",[$4]:"fire-app-check-compat",[Y4]:"fire-auth",[q4]:"fire-auth-compat",[Q4]:"fire-rtdb",[Z4]:"fire-data-connect",[J4]:"fire-rtdb-compat",[X4]:"fire-fn",[eW]:"fire-fn-compat",[tW]:"fire-iid",[sW]:"fire-iid-compat",[iW]:"fire-fcm",[rW]:"fire-fcm-compat",[nW]:"fire-perf",[oW]:"fire-perf-compat",[aW]:"fire-rc",[lW]:"fire-rc-compat",[cW]:"fire-gcs",[uW]:"fire-gcs-compat",[dW]:"fire-fst",[pW]:"fire-fst-compat",[hW]:"fire-vertex","fire-js":"fire-js",[gW]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf=new Map,vW=new Map,Iw=new Map;function YR(e,t){try{e.container.addComponent(t)}catch(s){go.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,s)}}function Xf(e){const t=e.name;if(Iw.has(t))return go.debug(`There were multiple attempts to register component ${t}.`),!1;Iw.set(t,e);for(const s of Jf.values())YR(s,e);for(const s of vW.values())YR(s,e);return!0}function CW(e,t){const s=e.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yW={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},la=new s_("app","Firebase",yW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wW{constructor(t,s,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},s),this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Vh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw la.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SW=fW;function o_(e,t={}){let s=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:Nw,automaticDataCollectionEnabled:!1},t),r=i.name;if(typeof r!="string"||!r)throw la.create("bad-app-name",{appName:String(r)});if(s||(s=t_()),!s)throw la.create("no-options");const n=Jf.get(r);if(n){if(Dw(s,n.options)&&Dw(i,n.config))return n;throw la.create("duplicate-app",{appName:r})}const o=new R4(r);for(const l of Iw.values())o.addComponent(l);const a=new wW(s,i,o);return Jf.set(r,a),a}function xW(e=Nw){const t=Jf.get(e);if(!t&&e===Nw&&t_())return o_();if(!t)throw la.create("no-app",{appName:e});return t}function kc(e,t,s){var i;let r=(i=mW[e])!==null&&i!==void 0?i:e;s&&(r+=`-${s}`);const n=r.match(/\s|\//),o=t.match(/\s|\//);if(n||o){const a=[`Unable to register library "${r}" with version "${t}":`];n&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),n&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),go.warn(a.join(" "));return}Xf(new Vh(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bW="firebase-heartbeat-database",EW=1,Bh="firebase-heartbeat-store";let OC=null;function a_(){return OC||(OC=G4(bW,EW,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Bh)}catch(s){console.warn(s)}}}}).catch(e=>{throw la.create("idb-open",{originalErrorMessage:e.message})})),OC}async function RW(e){try{const s=(await a_()).transaction(Bh),i=await s.objectStore(Bh).get(l_(e));return await s.done,i}catch(t){if(t instanceof Vu)go.warn(t.message);else{const s=la.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});go.warn(s.message)}}}async function qR(e,t){try{const i=(await a_()).transaction(Bh,"readwrite");await i.objectStore(Bh).put(t,l_(e)),await i.done}catch(s){if(s instanceof Vu)go.warn(s.message);else{const i=la.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});go.warn(i.message)}}}function l_(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TW=1024,DW=30*24*60*60*1e3;class PW{constructor(t){this.container=t,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new FW(s),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,s;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=QR();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)===null||s===void 0?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n)?void 0:(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=DW}),this._storage.overwrite(this._heartbeatsCache))}catch(i){go.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=QR(),{heartbeatsToSend:i,unsentEntries:r}=AW(this._heartbeatsCache.heartbeats),n=Zf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=s,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(s){return go.warn(s),""}}}function QR(){return new Date().toISOString().substring(0,10)}function AW(e,t=TW){const s=[];let i=e.slice();for(const r of e){const n=s.find(o=>o.agent===r.agent);if(n){if(n.dates.push(r.date),ZR(s)>t){n.dates.pop();break}}else if(s.push({agent:r.agent,dates:[r.date]}),ZR(s)>t){s.pop();break}i=i.slice(1)}return{heartbeatsToSend:s,unsentEntries:i}}class FW{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return v4()?C4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await RW(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var s;if(await this._canUseIndexedDBPromise){const r=await this.read();return qR(this.app,{lastSentHeartbeatDate:(s=t.lastSentHeartbeatDate)!==null&&s!==void 0?s:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var s;if(await this._canUseIndexedDBPromise){const r=await this.read();return qR(this.app,{lastSentHeartbeatDate:(s=t.lastSentHeartbeatDate)!==null&&s!==void 0?s:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function ZR(e){return Zf(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NW(e){Xf(new Vh("platform-logger",t=>new H4(t),"PRIVATE")),Xf(new Vh("heartbeat",t=>new PW(t),"PRIVATE")),kc(Fw,KR,e),kc(Fw,KR,"esm2017"),kc("fire-js","")}NW("");var IW="firebase",_W="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kc(IW,_W,"app");var JR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var c_;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(P,N){function _(){}_.prototype=N.prototype,P.D=N.prototype,P.prototype=new _,P.prototype.constructor=P,P.C=function(L,M,E){for(var F=Array(arguments.length-2),J=2;J<arguments.length;J++)F[J-2]=arguments[J];return N.prototype[M].apply(L,F)}}function s(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,s),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(P,N,_){_||(_=0);var L=Array(16);if(typeof N=="string")for(var M=0;16>M;++M)L[M]=N.charCodeAt(_++)|N.charCodeAt(_++)<<8|N.charCodeAt(_++)<<16|N.charCodeAt(_++)<<24;else for(M=0;16>M;++M)L[M]=N[_++]|N[_++]<<8|N[_++]<<16|N[_++]<<24;N=P.g[0],_=P.g[1],M=P.g[2];var E=P.g[3],F=N+(E^_&(M^E))+L[0]+3614090360&4294967295;N=_+(F<<7&4294967295|F>>>25),F=E+(M^N&(_^M))+L[1]+3905402710&4294967295,E=N+(F<<12&4294967295|F>>>20),F=M+(_^E&(N^_))+L[2]+606105819&4294967295,M=E+(F<<17&4294967295|F>>>15),F=_+(N^M&(E^N))+L[3]+3250441966&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(E^_&(M^E))+L[4]+4118548399&4294967295,N=_+(F<<7&4294967295|F>>>25),F=E+(M^N&(_^M))+L[5]+1200080426&4294967295,E=N+(F<<12&4294967295|F>>>20),F=M+(_^E&(N^_))+L[6]+2821735955&4294967295,M=E+(F<<17&4294967295|F>>>15),F=_+(N^M&(E^N))+L[7]+4249261313&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(E^_&(M^E))+L[8]+1770035416&4294967295,N=_+(F<<7&4294967295|F>>>25),F=E+(M^N&(_^M))+L[9]+2336552879&4294967295,E=N+(F<<12&4294967295|F>>>20),F=M+(_^E&(N^_))+L[10]+4294925233&4294967295,M=E+(F<<17&4294967295|F>>>15),F=_+(N^M&(E^N))+L[11]+2304563134&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(E^_&(M^E))+L[12]+1804603682&4294967295,N=_+(F<<7&4294967295|F>>>25),F=E+(M^N&(_^M))+L[13]+4254626195&4294967295,E=N+(F<<12&4294967295|F>>>20),F=M+(_^E&(N^_))+L[14]+2792965006&4294967295,M=E+(F<<17&4294967295|F>>>15),F=_+(N^M&(E^N))+L[15]+1236535329&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(M^E&(_^M))+L[1]+4129170786&4294967295,N=_+(F<<5&4294967295|F>>>27),F=E+(_^M&(N^_))+L[6]+3225465664&4294967295,E=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(E^N))+L[11]+643717713&4294967295,M=E+(F<<14&4294967295|F>>>18),F=_+(E^N&(M^E))+L[0]+3921069994&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(M^E&(_^M))+L[5]+3593408605&4294967295,N=_+(F<<5&4294967295|F>>>27),F=E+(_^M&(N^_))+L[10]+38016083&4294967295,E=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(E^N))+L[15]+3634488961&4294967295,M=E+(F<<14&4294967295|F>>>18),F=_+(E^N&(M^E))+L[4]+3889429448&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(M^E&(_^M))+L[9]+568446438&4294967295,N=_+(F<<5&4294967295|F>>>27),F=E+(_^M&(N^_))+L[14]+3275163606&4294967295,E=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(E^N))+L[3]+4107603335&4294967295,M=E+(F<<14&4294967295|F>>>18),F=_+(E^N&(M^E))+L[8]+1163531501&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(M^E&(_^M))+L[13]+2850285829&4294967295,N=_+(F<<5&4294967295|F>>>27),F=E+(_^M&(N^_))+L[2]+4243563512&4294967295,E=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(E^N))+L[7]+1735328473&4294967295,M=E+(F<<14&4294967295|F>>>18),F=_+(E^N&(M^E))+L[12]+2368359562&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(_^M^E)+L[5]+4294588738&4294967295,N=_+(F<<4&4294967295|F>>>28),F=E+(N^_^M)+L[8]+2272392833&4294967295,E=N+(F<<11&4294967295|F>>>21),F=M+(E^N^_)+L[11]+1839030562&4294967295,M=E+(F<<16&4294967295|F>>>16),F=_+(M^E^N)+L[14]+4259657740&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(_^M^E)+L[1]+2763975236&4294967295,N=_+(F<<4&4294967295|F>>>28),F=E+(N^_^M)+L[4]+1272893353&4294967295,E=N+(F<<11&4294967295|F>>>21),F=M+(E^N^_)+L[7]+4139469664&4294967295,M=E+(F<<16&4294967295|F>>>16),F=_+(M^E^N)+L[10]+3200236656&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(_^M^E)+L[13]+681279174&4294967295,N=_+(F<<4&4294967295|F>>>28),F=E+(N^_^M)+L[0]+3936430074&4294967295,E=N+(F<<11&4294967295|F>>>21),F=M+(E^N^_)+L[3]+3572445317&4294967295,M=E+(F<<16&4294967295|F>>>16),F=_+(M^E^N)+L[6]+76029189&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(_^M^E)+L[9]+3654602809&4294967295,N=_+(F<<4&4294967295|F>>>28),F=E+(N^_^M)+L[12]+3873151461&4294967295,E=N+(F<<11&4294967295|F>>>21),F=M+(E^N^_)+L[15]+530742520&4294967295,M=E+(F<<16&4294967295|F>>>16),F=_+(M^E^N)+L[2]+3299628645&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(M^(_|~E))+L[0]+4096336452&4294967295,N=_+(F<<6&4294967295|F>>>26),F=E+(_^(N|~M))+L[7]+1126891415&4294967295,E=N+(F<<10&4294967295|F>>>22),F=M+(N^(E|~_))+L[14]+2878612391&4294967295,M=E+(F<<15&4294967295|F>>>17),F=_+(E^(M|~N))+L[5]+4237533241&4294967295,_=M+(F<<21&4294967295|F>>>11),F=N+(M^(_|~E))+L[12]+1700485571&4294967295,N=_+(F<<6&4294967295|F>>>26),F=E+(_^(N|~M))+L[3]+2399980690&4294967295,E=N+(F<<10&4294967295|F>>>22),F=M+(N^(E|~_))+L[10]+4293915773&4294967295,M=E+(F<<15&4294967295|F>>>17),F=_+(E^(M|~N))+L[1]+2240044497&4294967295,_=M+(F<<21&4294967295|F>>>11),F=N+(M^(_|~E))+L[8]+1873313359&4294967295,N=_+(F<<6&4294967295|F>>>26),F=E+(_^(N|~M))+L[15]+4264355552&4294967295,E=N+(F<<10&4294967295|F>>>22),F=M+(N^(E|~_))+L[6]+2734768916&4294967295,M=E+(F<<15&4294967295|F>>>17),F=_+(E^(M|~N))+L[13]+1309151649&4294967295,_=M+(F<<21&4294967295|F>>>11),F=N+(M^(_|~E))+L[4]+4149444226&4294967295,N=_+(F<<6&4294967295|F>>>26),F=E+(_^(N|~M))+L[11]+3174756917&4294967295,E=N+(F<<10&4294967295|F>>>22),F=M+(N^(E|~_))+L[2]+718787259&4294967295,M=E+(F<<15&4294967295|F>>>17),F=_+(E^(M|~N))+L[9]+3951481745&4294967295,P.g[0]=P.g[0]+N&4294967295,P.g[1]=P.g[1]+(M+(F<<21&4294967295|F>>>11))&4294967295,P.g[2]=P.g[2]+M&4294967295,P.g[3]=P.g[3]+E&4294967295}i.prototype.u=function(P,N){N===void 0&&(N=P.length);for(var _=N-this.blockSize,L=this.B,M=this.h,E=0;E<N;){if(M==0)for(;E<=_;)r(this,P,E),E+=this.blockSize;if(typeof P=="string"){for(;E<N;)if(L[M++]=P.charCodeAt(E++),M==this.blockSize){r(this,L),M=0;break}}else for(;E<N;)if(L[M++]=P[E++],M==this.blockSize){r(this,L),M=0;break}}this.h=M,this.o+=N},i.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var N=1;N<P.length-8;++N)P[N]=0;var _=8*this.o;for(N=P.length-8;N<P.length;++N)P[N]=_&255,_/=256;for(this.u(P),P=Array(16),N=_=0;4>N;++N)for(var L=0;32>L;L+=8)P[_++]=this.g[N]>>>L&255;return P};function n(P,N){var _=a;return Object.prototype.hasOwnProperty.call(_,P)?_[P]:_[P]=N(P)}function o(P,N){this.h=N;for(var _=[],L=!0,M=P.length-1;0<=M;M--){var E=P[M]|0;L&&E==N||(_[M]=E,L=!1)}this.g=_}var a={};function l(P){return-128<=P&&128>P?n(P,function(N){return new o([N|0],0>N?-1:0)}):new o([P|0],0>P?-1:0)}function u(P){if(isNaN(P)||!isFinite(P))return p;if(0>P)return R(u(-P));for(var N=[],_=1,L=0;P>=_;L++)N[L]=P/_|0,_*=4294967296;return new o(N,0)}function h(P,N){if(P.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(P.charAt(0)=="-")return R(h(P.substring(1),N));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=u(Math.pow(N,8)),L=p,M=0;M<P.length;M+=8){var E=Math.min(8,P.length-M),F=parseInt(P.substring(M,M+E),N);8>E?(E=u(Math.pow(N,E)),L=L.j(E).add(u(F))):(L=L.j(_),L=L.add(u(F)))}return L}var p=l(0),g=l(1),m=l(16777216);e=o.prototype,e.m=function(){if(y(this))return-R(this).m();for(var P=0,N=1,_=0;_<this.g.length;_++){var L=this.i(_);P+=(0<=L?L:4294967296+L)*N,N*=4294967296}return P},e.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(C(this))return"0";if(y(this))return"-"+R(this).toString(P);for(var N=u(Math.pow(P,6)),_=this,L="";;){var M=I(_,N).g;_=x(_,M.j(N));var E=((0<_.g.length?_.g[0]:_.h)>>>0).toString(P);if(_=M,C(_))return E+L;for(;6>E.length;)E="0"+E;L=E+L}},e.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function C(P){if(P.h!=0)return!1;for(var N=0;N<P.g.length;N++)if(P.g[N]!=0)return!1;return!0}function y(P){return P.h==-1}e.l=function(P){return P=x(this,P),y(P)?-1:C(P)?0:1};function R(P){for(var N=P.g.length,_=[],L=0;L<N;L++)_[L]=~P.g[L];return new o(_,~P.h).add(g)}e.abs=function(){return y(this)?R(this):this},e.add=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0,M=0;M<=N;M++){var E=L+(this.i(M)&65535)+(P.i(M)&65535),F=(E>>>16)+(this.i(M)>>>16)+(P.i(M)>>>16);L=F>>>16,E&=65535,F&=65535,_[M]=F<<16|E}return new o(_,_[_.length-1]&-2147483648?-1:0)};function x(P,N){return P.add(R(N))}e.j=function(P){if(C(this)||C(P))return p;if(y(this))return y(P)?R(this).j(R(P)):R(R(this).j(P));if(y(P))return R(this.j(R(P)));if(0>this.l(m)&&0>P.l(m))return u(this.m()*P.m());for(var N=this.g.length+P.g.length,_=[],L=0;L<2*N;L++)_[L]=0;for(L=0;L<this.g.length;L++)for(var M=0;M<P.g.length;M++){var E=this.i(L)>>>16,F=this.i(L)&65535,J=P.i(M)>>>16,Y=P.i(M)&65535;_[2*L+2*M]+=F*Y,S(_,2*L+2*M),_[2*L+2*M+1]+=E*Y,S(_,2*L+2*M+1),_[2*L+2*M+1]+=F*J,S(_,2*L+2*M+1),_[2*L+2*M+2]+=E*J,S(_,2*L+2*M+2)}for(L=0;L<N;L++)_[L]=_[2*L+1]<<16|_[2*L];for(L=N;L<2*N;L++)_[L]=0;return new o(_,0)};function S(P,N){for(;(P[N]&65535)!=P[N];)P[N+1]+=P[N]>>>16,P[N]&=65535,N++}function T(P,N){this.g=P,this.h=N}function I(P,N){if(C(N))throw Error("division by zero");if(C(P))return new T(p,p);if(y(P))return N=I(R(P),N),new T(R(N.g),R(N.h));if(y(N))return N=I(P,R(N)),new T(R(N.g),N.h);if(30<P.g.length){if(y(P)||y(N))throw Error("slowDivide_ only works with positive integers.");for(var _=g,L=N;0>=L.l(P);)_=V(_),L=V(L);var M=j(_,1),E=j(L,1);for(L=j(L,2),_=j(_,2);!C(L);){var F=E.add(L);0>=F.l(P)&&(M=M.add(_),E=F),L=j(L,1),_=j(_,1)}return N=x(P,M.j(N)),new T(M,N)}for(M=p;0<=P.l(N);){for(_=Math.max(1,Math.floor(P.m()/N.m())),L=Math.ceil(Math.log(_)/Math.LN2),L=48>=L?1:Math.pow(2,L-48),E=u(_),F=E.j(N);y(F)||0<F.l(P);)_-=L,E=u(_),F=E.j(N);C(E)&&(E=g),M=M.add(E),P=x(P,F)}return new T(M,P)}e.A=function(P){return I(this,P).h},e.and=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0;L<N;L++)_[L]=this.i(L)&P.i(L);return new o(_,this.h&P.h)},e.or=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0;L<N;L++)_[L]=this.i(L)|P.i(L);return new o(_,this.h|P.h)},e.xor=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0;L<N;L++)_[L]=this.i(L)^P.i(L);return new o(_,this.h^P.h)};function V(P){for(var N=P.g.length+1,_=[],L=0;L<N;L++)_[L]=P.i(L)<<1|P.i(L-1)>>>31;return new o(_,P.h)}function j(P,N){var _=N>>5;N%=32;for(var L=P.g.length-_,M=[],E=0;E<L;E++)M[E]=0<N?P.i(E+_)>>>N|P.i(E+_+1)<<32-N:P.i(E+_);return new o(M,P.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,c_=o}).apply(typeof JR<"u"?JR:typeof self<"u"?self:typeof window<"u"?window:{});var hg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,D){return d==Array.prototype||d==Object.prototype||(d[v]=D.value),d};function s(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof hg=="object"&&hg];for(var v=0;v<d.length;++v){var D=d[v];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var i=s(this);function r(d,v){if(v)e:{var D=i;d=d.split(".");for(var G=0;G<d.length-1;G++){var ee=d[G];if(!(ee in D))break e;D=D[ee]}d=d[d.length-1],G=D[d],v=v(G),v!=G&&v!=null&&t(D,d,{configurable:!0,writable:!0,value:v})}}function n(d,v){d instanceof String&&(d+="");var D=0,G=!1,ee={next:function(){if(!G&&D<d.length){var ge=D++;return{value:v(ge,d[ge]),done:!1}}return G=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}r("Array.prototype.values",function(d){return d||function(){return n(this,function(v,D){return D})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function h(d,v,D){return d.call.apply(d.bind,arguments)}function p(d,v,D){if(!d)throw Error();if(2<arguments.length){var G=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,G),d.apply(v,ee)}}return function(){return d.apply(v,arguments)}}function g(d,v,D){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,g.apply(null,arguments)}function m(d,v){var D=Array.prototype.slice.call(arguments,1);return function(){var G=D.slice();return G.push.apply(G,arguments),d.apply(this,G)}}function C(d,v){function D(){}D.prototype=v.prototype,d.aa=v.prototype,d.prototype=new D,d.prototype.constructor=d,d.Qb=function(G,ee,ge){for(var Me=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)Me[Zt-2]=arguments[Zt];return v.prototype[ee].apply(G,Me)}}function y(d){const v=d.length;if(0<v){const D=Array(v);for(let G=0;G<v;G++)D[G]=d[G];return D}return[]}function R(d,v){for(let D=1;D<arguments.length;D++){const G=arguments[D];if(l(G)){const ee=d.length||0,ge=G.length||0;d.length=ee+ge;for(let Me=0;Me<ge;Me++)d[ee+Me]=G[Me]}else d.push(G)}}class x{constructor(v,D){this.i=v,this.j=D,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function S(d){return/^[\s\xa0]*$/.test(d)}function T(){var d=a.navigator;return d&&(d=d.userAgent)?d:""}function I(d){return I[" "](d),d}I[" "]=function(){};var V=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function j(d,v,D){for(const G in d)v.call(D,d[G],G,d)}function P(d,v){for(const D in d)v.call(void 0,d[D],D,d)}function N(d){const v={};for(const D in d)v[D]=d[D];return v}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(d,v){let D,G;for(let ee=1;ee<arguments.length;ee++){G=arguments[ee];for(D in G)d[D]=G[D];for(let ge=0;ge<_.length;ge++)D=_[ge],Object.prototype.hasOwnProperty.call(G,D)&&(d[D]=G[D])}}function M(d){var v=1;d=d.split(":");const D=[];for(;0<v&&d.length;)D.push(d.shift()),v--;return d.length&&D.push(d.join(":")),D}function E(d){a.setTimeout(()=>{throw d},0)}function F(){var d=ye;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class J{constructor(){this.h=this.g=null}add(v,D){const G=Y.get();G.set(v,D),this.h?this.h.next=G:this.g=G,this.h=G}}var Y=new x(()=>new fe,d=>d.reset());class fe{constructor(){this.next=this.g=this.h=null}set(v,D){this.h=v,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let me,pe=!1,ye=new J,Ae=()=>{const d=a.Promise.resolve(void 0);me=()=>{d.then(te)}};var te=()=>{for(var d;d=F();){try{d.h.call(d.g)}catch(D){E(D)}var v=Y;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}pe=!1};function ce(){this.s=this.s,this.C=this.C}ce.prototype.s=!1,ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function be(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}be.prototype.h=function(){this.defaultPrevented=!0};var Ze=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const D=()=>{};a.addEventListener("test",D,v),a.removeEventListener("test",D,v)}catch{}return d}();function he(d,v){if(be.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var D=this.type=d.type,G=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(V){e:{try{I(v.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(v=null)}}else D=="mouseover"?v=d.fromElement:D=="mouseout"&&(v=d.toElement);this.relatedTarget=v,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:et[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&he.aa.h.call(this)}}C(he,be);var et={2:"touch",3:"pen",4:"mouse"};he.prototype.h=function(){he.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var We="closure_listenable_"+(1e6*Math.random()|0),se=0;function ne(d,v,D,G,ee){this.listener=d,this.proxy=null,this.src=v,this.type=D,this.capture=!!G,this.ha=ee,this.key=++se,this.da=this.fa=!1}function B(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function $(d){this.src=d,this.g={},this.h=0}$.prototype.add=function(d,v,D,G,ee){var ge=d.toString();d=this.g[ge],d||(d=this.g[ge]=[],this.h++);var Me=Q(d,v,G,ee);return-1<Me?(v=d[Me],D||(v.fa=!1)):(v=new ne(v,this.src,ge,!!G,ee),v.fa=D,d.push(v)),v};function K(d,v){var D=v.type;if(D in d.g){var G=d.g[D],ee=Array.prototype.indexOf.call(G,v,void 0),ge;(ge=0<=ee)&&Array.prototype.splice.call(G,ee,1),ge&&(B(v),d.g[D].length==0&&(delete d.g[D],d.h--))}}function Q(d,v,D,G){for(var ee=0;ee<d.length;++ee){var ge=d[ee];if(!ge.da&&ge.listener==v&&ge.capture==!!D&&ge.ha==G)return ee}return-1}var oe="closure_lm_"+(1e6*Math.random()|0),Z={};function k(d,v,D,G,ee){if(Array.isArray(v)){for(var ge=0;ge<v.length;ge++)k(d,v[ge],D,G,ee);return null}return D=Ne(D),d&&d[We]?d.K(v,D,u(G)?!!G.capture:!1,ee):O(d,v,D,!1,G,ee)}function O(d,v,D,G,ee,ge){if(!v)throw Error("Invalid event type");var Me=u(ee)?!!ee.capture:!!ee,Zt=ie(d);if(Zt||(d[oe]=Zt=new $(d)),D=Zt.add(v,D,G,Me,ge),D.proxy)return D;if(G=W(),D.proxy=G,G.src=d,G.listener=D,d.addEventListener)Ze||(ee=Me),ee===void 0&&(ee=!1),d.addEventListener(v.toString(),G,ee);else if(d.attachEvent)d.attachEvent(X(v.toString()),G);else if(d.addListener&&d.removeListener)d.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return D}function W(){function d(D){return v.call(d.src,d.listener,D)}const v=q;return d}function ue(d,v,D,G,ee){if(Array.isArray(v))for(var ge=0;ge<v.length;ge++)ue(d,v[ge],D,G,ee);else G=u(G)?!!G.capture:!!G,D=Ne(D),d&&d[We]?(d=d.i,v=String(v).toString(),v in d.g&&(ge=d.g[v],D=Q(ge,D,G,ee),-1<D&&(B(ge[D]),Array.prototype.splice.call(ge,D,1),ge.length==0&&(delete d.g[v],d.h--)))):d&&(d=ie(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Q(v,D,G,ee)),(D=-1<d?v[d]:null)&&ae(D))}function ae(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[We])K(v.i,d);else{var D=d.type,G=d.proxy;v.removeEventListener?v.removeEventListener(D,G,d.capture):v.detachEvent?v.detachEvent(X(D),G):v.addListener&&v.removeListener&&v.removeListener(G),(D=ie(v))?(K(D,d),D.h==0&&(D.src=null,v[oe]=null)):B(d)}}}function X(d){return d in Z?Z[d]:Z[d]="on"+d}function q(d,v){if(d.da)d=!0;else{v=new he(v,this);var D=d.listener,G=d.ha||d.src;d.fa&&ae(d),d=D.call(G,v)}return d}function ie(d){return d=d[oe],d instanceof $?d:null}var we="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ne(d){return typeof d=="function"?d:(d[we]||(d[we]=function(v){return d.handleEvent(v)}),d[we])}function De(){ce.call(this),this.i=new $(this),this.M=this,this.F=null}C(De,ce),De.prototype[We]=!0,De.prototype.removeEventListener=function(d,v,D,G){ue(this,d,v,D,G)};function Ee(d,v){var D,G=d.F;if(G)for(D=[];G;G=G.F)D.push(G);if(d=d.M,G=v.type||v,typeof v=="string")v=new be(v,d);else if(v instanceof be)v.target=v.target||d;else{var ee=v;v=new be(G,d),L(v,ee)}if(ee=!0,D)for(var ge=D.length-1;0<=ge;ge--){var Me=v.g=D[ge];ee=Oe(Me,G,!0,v)&&ee}if(Me=v.g=d,ee=Oe(Me,G,!0,v)&&ee,ee=Oe(Me,G,!1,v)&&ee,D)for(ge=0;ge<D.length;ge++)Me=v.g=D[ge],ee=Oe(Me,G,!1,v)&&ee}De.prototype.N=function(){if(De.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var D=d.g[v],G=0;G<D.length;G++)B(D[G]);delete d.g[v],d.h--}}this.F=null},De.prototype.K=function(d,v,D,G){return this.i.add(String(d),v,!1,D,G)},De.prototype.L=function(d,v,D,G){return this.i.add(String(d),v,!0,D,G)};function Oe(d,v,D,G){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var ee=!0,ge=0;ge<v.length;++ge){var Me=v[ge];if(Me&&!Me.da&&Me.capture==D){var Zt=Me.listener,qs=Me.ha||Me.src;Me.fa&&K(d.i,Me),ee=Zt.call(qs,G)!==!1&&ee}}return ee&&!G.defaultPrevented}function Ue(d,v,D){if(typeof d=="function")D&&(d=g(d,D));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:a.setTimeout(d,v||0)}function ze(d){d.g=Ue(()=>{d.g=null,d.i&&(d.i=!1,ze(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class re extends ce{constructor(v,D){super(),this.m=v,this.l=D,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ze(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _t(d){ce.call(this),this.h=d,this.g={}}C(_t,ce);var Gs=[];function Xt(d){j(d.g,function(v,D){this.g.hasOwnProperty(D)&&ae(v)},d),d.g={}}_t.prototype.N=function(){_t.aa.N.call(this),Xt(this)},_t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pt=a.JSON.stringify,wr=a.JSON.parse,_a=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function Sr(){}Sr.prototype.h=null;function _s(d){return d.h||(d.h=d.i())}function Xl(){}var vn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Eo(){be.call(this,"d")}C(Eo,be);function Ro(){be.call(this,"c")}C(Ro,be);var jr={},ka=null;function Ma(){return ka=ka||new De}jr.La="serverreachability";function La(d){be.call(this,jr.La,d)}C(La,be);function Wr(d){const v=Ma();Ee(v,new La(v))}jr.STAT_EVENT="statevent";function fi(d,v){be.call(this,jr.STAT_EVENT,d),this.stat=v}C(fi,be);function ds(d){const v=Ma();Ee(v,new fi(v,d))}jr.Ma="timingevent";function sr(d,v){be.call(this,jr.Ma,d),this.size=v}C(sr,be);function zr(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},v)}function Ks(){this.g=!0}Ks.prototype.xa=function(){this.g=!1};function Vs(d,v,D,G,ee,ge){d.info(function(){if(d.g)if(ge)for(var Me="",Zt=ge.split("&"),qs=0;qs<Zt.length;qs++){var Wt=Zt[qs].split("=");if(1<Wt.length){var ri=Wt[0];Wt=Wt[1];var ni=ri.split("_");Me=2<=ni.length&&ni[1]=="type"?Me+(ri+"="+Wt+"&"):Me+(ri+"=redacted&")}}else Me=null;else Me=ge;return"XMLHTTP REQ ("+G+") [attempt "+ee+"]: "+v+`
`+D+`
`+Me})}function Ur(d,v,D,G,ee,ge,Me){d.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+ee+"]: "+v+`
`+D+`
`+ge+" "+Me})}function xr(d,v,D,G){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+Ev(d,D)+(G?" "+G:"")})}function bv(d,v){d.info(function(){return"TIMEOUT: "+v})}Ks.prototype.info=function(){};function Ev(d,v){if(!d.g)return v;if(!v)return null;try{var D=JSON.parse(v);if(D){for(d=0;d<D.length;d++)if(Array.isArray(D[d])){var G=D[d];if(!(2>G.length)){var ee=G[1];if(Array.isArray(ee)&&!(1>ee.length)){var ge=ee[0];if(ge!="noop"&&ge!="stop"&&ge!="close")for(var Me=1;Me<ee.length;Me++)ee[Me]=""}}}}return Pt(D)}catch{return v}}var zu={NO_ERROR:0,TIMEOUT:8},Rv={},H;function le(){}C(le,Sr),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},H=new le;function z(d,v,D,G){this.j=d,this.i=v,this.l=D,this.R=G||1,this.U=new _t(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}var de={},Ve={};function Te(d,v,D){d.L=1,d.v=Un(jt(v)),d.m=D,d.P=!0,Ie(d,null)}function Ie(d,v){d.F=Date.now(),qe(d),d.A=jt(d.v);var D=d.A,G=d.R;Array.isArray(G)||(G=[String(G)]),_x(D.i,"t",G),d.C=0,D=d.j.J,d.h=new Re,d.g=Zx(d.j,D?v:null,!d.m),0<d.O&&(d.M=new re(g(d.Y,d,d.g),d.O)),v=d.U,D=d.g,G=d.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(Gs[0]=ee.toString()),ee=Gs);for(var ge=0;ge<ee.length;ge++){var Me=k(D,ee[ge],G||v.handleEvent,!1,v.h||v);if(!Me)break;v.g[Me.key]=Me}v=d.H?N(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),Wr(),Vs(d.i,d.u,d.A,d.l,d.R,d.m)}z.prototype.ca=function(d){d=d.target;const v=this.M;v&&$n(d)==3?v.j():this.Y(d)},z.prototype.Y=function(d){try{if(d==this.g)e:{const ni=$n(this.g);var v=this.g.Ba();const sc=this.g.Z();if(!(3>ni)&&(ni!=3||this.g&&(this.h.h||this.g.oa()||Bx(this.g)))){this.J||ni!=4||v==7||(v==8||0>=sc?Wr(3):Wr(2)),Nt(this);var D=this.g.Z();this.X=D;t:if(Ye(this)){var G=Bx(this.g);d="";var ee=G.length,ge=$n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ht(this),xt(this);var Me="";break t}this.h.i=new a.TextDecoder}for(v=0;v<ee;v++)this.h.h=!0,d+=this.h.i.decode(G[v],{stream:!(ge&&v==ee-1)});G.length=0,this.h.g+=d,this.C=0,Me=this.h.g}else Me=this.g.oa();if(this.o=D==200,Ur(this.i,this.u,this.A,this.l,this.R,ni,D),this.o){if(this.T&&!this.K){t:{if(this.g){var Zt,qs=this.g;if((Zt=qs.g?qs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Zt)){var Wt=Zt;break t}}Wt=null}if(D=Wt)xr(this.i,this.l,D,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ct(this,D);else{this.o=!1,this.s=3,ds(12),ht(this),xt(this);break e}}if(this.P){D=!0;let $r;for(;!this.J&&this.C<Me.length;)if($r=Ge(this,Me),$r==Ve){ni==4&&(this.s=4,ds(14),D=!1),xr(this.i,this.l,null,"[Incomplete Response]");break}else if($r==de){this.s=4,ds(15),xr(this.i,this.l,Me,"[Invalid Chunk]"),D=!1;break}else xr(this.i,this.l,$r,null),ct(this,$r);if(Ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ni!=4||Me.length!=0||this.h.h||(this.s=1,ds(16),D=!1),this.o=this.o&&D,!D)xr(this.i,this.l,Me,"[Invalid Chunked Response]"),ht(this),xt(this);else if(0<Me.length&&!this.W){this.W=!0;var ri=this.j;ri.g==this&&ri.ba&&!ri.M&&(ri.j.info("Great, no buffering proxy detected. Bytes received: "+Me.length),Av(ri),ri.M=!0,ds(11))}}else xr(this.i,this.l,Me,null),ct(this,Me);ni==4&&ht(this),this.o&&!this.J&&(ni==4?Kx(this.j,this):(this.o=!1,qe(this)))}else gk(this.g),D==400&&0<Me.indexOf("Unknown SID")?(this.s=3,ds(12)):(this.s=0,ds(13)),ht(this),xt(this)}}}catch{}finally{}};function Ye(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Ge(d,v){var D=d.C,G=v.indexOf(`
`,D);return G==-1?Ve:(D=Number(v.substring(D,G)),isNaN(D)?de:(G+=1,G+D>v.length?Ve:(v=v.slice(G,G+D),d.C=G+D,v)))}z.prototype.cancel=function(){this.J=!0,ht(this)};function qe(d){d.S=Date.now()+d.I,lt(d,d.I)}function lt(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=zr(g(d.ba,d),v)}function Nt(d){d.B&&(a.clearTimeout(d.B),d.B=null)}z.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(bv(this.i,this.A),this.L!=2&&(Wr(),ds(17)),ht(this),this.s=2,xt(this)):lt(this,this.S-d)};function xt(d){d.j.G==0||d.J||Kx(d.j,d)}function ht(d){Nt(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,Xt(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function ct(d,v){try{var D=d.j;if(D.G!=0&&(D.g==d||Cn(D.h,d))){if(!d.K&&Cn(D.h,d)&&D.G==3){try{var G=D.Da.g.parse(v)}catch{G=null}if(Array.isArray(G)&&G.length==3){var ee=G;if(ee[0]==0){e:if(!D.u){if(D.g)if(D.g.F+3e3<d.F)Gp(D),Lp(D);else break e;Pv(D),ds(18)}}else D.za=ee[1],0<D.za-D.T&&37500>ee[2]&&D.F&&D.v==0&&!D.C&&(D.C=zr(g(D.Za,D),6e3));if(1>=bs(D.h)&&D.ca){try{D.ca()}catch{}D.ca=void 0}}else Oa(D,11)}else if((d.K||D.g==d)&&Gp(D),!S(v))for(ee=D.Da.g.parse(v),v=0;v<ee.length;v++){let Wt=ee[v];if(D.T=Wt[0],Wt=Wt[1],D.G==2)if(Wt[0]=="c"){D.K=Wt[1],D.ia=Wt[2];const ri=Wt[3];ri!=null&&(D.la=ri,D.j.info("VER="+D.la));const ni=Wt[4];ni!=null&&(D.Aa=ni,D.j.info("SVER="+D.Aa));const sc=Wt[5];sc!=null&&typeof sc=="number"&&0<sc&&(G=1.5*sc,D.L=G,D.j.info("backChannelRequestTimeoutMs_="+G)),G=D;const $r=d.g;if($r){const Vp=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vp){var ge=G.h;ge.g||Vp.indexOf("spdy")==-1&&Vp.indexOf("quic")==-1&&Vp.indexOf("h2")==-1||(ge.j=ge.l,ge.g=new Set,ge.h&&(To(ge,ge.h),ge.h=null))}if(G.D){const Fv=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;Fv&&(G.ya=Fv,rt(G.I,G.D,Fv))}}D.G=3,D.l&&D.l.ua(),D.ba&&(D.R=Date.now()-d.F,D.j.info("Handshake RTT: "+D.R+"ms")),G=D;var Me=d;if(G.qa=Qx(G,G.J?G.ia:null,G.W),Me.K){mt(G.h,Me);var Zt=Me,qs=G.L;qs&&(Zt.I=qs),Zt.B&&(Nt(Zt),qe(Zt)),G.g=Me}else Ux(G);0<D.i.length&&Op(D)}else Wt[0]!="stop"&&Wt[0]!="close"||Oa(D,7);else D.G==3&&(Wt[0]=="stop"||Wt[0]=="close"?Wt[0]=="stop"?Oa(D,7):Dv(D):Wt[0]!="noop"&&D.l&&D.l.ta(Wt),D.v=0)}}Wr(4)}catch{}}var Lt=class{constructor(d,v){this.g=d,this.map=v}};function Ys(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mi(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function bs(d){return d.h?1:d.g?d.g.size:0}function Cn(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function To(d,v){d.g?d.g.add(v):d.h=v}function mt(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}Ys.prototype.cancel=function(){if(this.i=hs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function hs(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const D of d.g.values())v=v.concat(D.D);return v}return y(d.i)}function zn(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],D=d.length,G=0;G<D;G++)v.push(d[G]);return v}v=[],D=0;for(G in d)v[D++]=d[G];return v}function Rt(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var D=0;D<d;D++)v.push(D);return v}v=[],D=0;for(const G in d)v[D++]=G;return v}}}function vt(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var D=Rt(d),G=zn(d),ee=G.length,ge=0;ge<ee;ge++)v.call(void 0,G[ge],D&&D[ge],d)}var $e=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qe(d,v){if(d){d=d.split("&");for(var D=0;D<d.length;D++){var G=d[D].indexOf("="),ee=null;if(0<=G){var ge=d[D].substring(0,G);ee=d[D].substring(G+1)}else ge=d[D];v(ge,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function He(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof He){this.h=d.h,At(this,d.j),this.o=d.o,this.g=d.g,ys(this,d.s),this.l=d.l;var v=d.i,D=new $u;D.i=v.i,v.g&&(D.g=new Map(v.g),D.h=v.h),Li(this,D),this.m=d.m}else d&&(v=String(d).match($e))?(this.h=!1,At(this,v[1]||"",!0),this.o=Bs(v[2]||""),this.g=Bs(v[3]||"",!0),ys(this,v[4]),this.l=Bs(v[5]||"",!0),Li(this,v[6]||"",!0),this.m=Bs(v[7]||"")):(this.h=!1,this.i=new $u(null,this.h))}He.prototype.toString=function(){var d=[],v=this.j;v&&d.push(Uu(v,Fx,!0),":");var D=this.g;return(D||v=="file")&&(d.push("//"),(v=this.o)&&d.push(Uu(v,Fx,!0),"@"),d.push(encodeURIComponent(String(D)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.s,D!=null&&d.push(":",String(D))),(D=this.l)&&(this.g&&D.charAt(0)!="/"&&d.push("/"),d.push(Uu(D,D.charAt(0)=="/"?rk:ik,!0))),(D=this.i.toString())&&d.push("?",D),(D=this.m)&&d.push("#",Uu(D,ok)),d.join("")};function jt(d){return new He(d)}function At(d,v,D){d.j=D?Bs(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function ys(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function Li(d,v,D){v instanceof $u?(d.i=v,ak(d.i,d.h)):(D||(v=Uu(v,nk)),d.i=new $u(v,d.h))}function rt(d,v,D){d.i.set(v,D)}function Un(d){return rt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Bs(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Uu(d,v,D){return typeof d=="string"?(d=encodeURI(d).replace(v,sk),D&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function sk(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Fx=/[#\/\?@]/g,ik=/[#\?:]/g,rk=/[#\?]/g,nk=/[#\?@]/g,ok=/#/g;function $u(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function Do(d){d.g||(d.g=new Map,d.h=0,d.i&&Qe(d.i,function(v,D){d.add(decodeURIComponent(v.replace(/\+/g," ")),D)}))}e=$u.prototype,e.add=function(d,v){Do(this),this.i=null,d=ec(this,d);var D=this.g.get(d);return D||this.g.set(d,D=[]),D.push(v),this.h+=1,this};function Nx(d,v){Do(d),v=ec(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Ix(d,v){return Do(d),v=ec(d,v),d.g.has(v)}e.forEach=function(d,v){Do(this),this.g.forEach(function(D,G){D.forEach(function(ee){d.call(v,ee,G,this)},this)},this)},e.na=function(){Do(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),D=[];for(let G=0;G<v.length;G++){const ee=d[G];for(let ge=0;ge<ee.length;ge++)D.push(v[G])}return D},e.V=function(d){Do(this);let v=[];if(typeof d=="string")Ix(this,d)&&(v=v.concat(this.g.get(ec(this,d))));else{d=Array.from(this.g.values());for(let D=0;D<d.length;D++)v=v.concat(d[D])}return v},e.set=function(d,v){return Do(this),this.i=null,d=ec(this,d),Ix(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},e.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function _x(d,v,D){Nx(d,v),0<D.length&&(d.i=null,d.g.set(ec(d,v),y(D)),d.h+=D.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var D=0;D<v.length;D++){var G=v[D];const ge=encodeURIComponent(String(G)),Me=this.V(G);for(G=0;G<Me.length;G++){var ee=ge;Me[G]!==""&&(ee+="="+encodeURIComponent(String(Me[G]))),d.push(ee)}}return this.i=d.join("&")};function ec(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function ak(d,v){v&&!d.j&&(Do(d),d.i=null,d.g.forEach(function(D,G){var ee=G.toLowerCase();G!=ee&&(Nx(this,G),_x(this,ee,D))},d)),d.j=v}function lk(d,v){const D=new Ks;if(a.Image){const G=new Image;G.onload=m(Po,D,"TestLoadImage: loaded",!0,v,G),G.onerror=m(Po,D,"TestLoadImage: error",!1,v,G),G.onabort=m(Po,D,"TestLoadImage: abort",!1,v,G),G.ontimeout=m(Po,D,"TestLoadImage: timeout",!1,v,G),a.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=d}else v(!1)}function ck(d,v){const D=new Ks,G=new AbortController,ee=setTimeout(()=>{G.abort(),Po(D,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:G.signal}).then(ge=>{clearTimeout(ee),ge.ok?Po(D,"TestPingServer: ok",!0,v):Po(D,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ee),Po(D,"TestPingServer: error",!1,v)})}function Po(d,v,D,G,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),G(D)}catch{}}function uk(){this.g=new _a}function dk(d,v,D){const G=D||"";try{vt(d,function(ee,ge){let Me=ee;u(ee)&&(Me=Pt(ee)),v.push(G+ge+"="+encodeURIComponent(Me))})}catch(ee){throw v.push(G+"type="+encodeURIComponent("_badmap")),ee}}function _p(d){this.l=d.Ub||null,this.j=d.eb||!1}C(_p,Sr),_p.prototype.g=function(){return new kp(this.l,this.j)},_p.prototype.i=function(d){return function(){return d}}({});function kp(d,v){De.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(kp,De),e=kp.prototype,e.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,Yu(this)},e.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||a).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ku(this)),this.readyState=0},e.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Yu(this)),this.g&&(this.readyState=3,Yu(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kx(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function kx(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}e.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?Ku(this):Yu(this),this.readyState==3&&kx(this)}},e.Ra=function(d){this.g&&(this.response=this.responseText=d,Ku(this))},e.Qa=function(d){this.g&&(this.response=d,Ku(this))},e.ga=function(){this.g&&Ku(this)};function Ku(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Yu(d)}e.setRequestHeader=function(d,v){this.u.append(d,v)},e.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var D=v.next();!D.done;)D=D.value,d.push(D[0]+": "+D[1]),D=v.next();return d.join(`\r
`)};function Yu(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(kp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Mx(d){let v="";return j(d,function(D,G){v+=G,v+=":",v+=D,v+=`\r
`}),v}function Tv(d,v,D){e:{for(G in D){var G=!1;break e}G=!0}G||(D=Mx(D),typeof d=="string"?D!=null&&encodeURIComponent(String(D)):rt(d,v,D))}function Es(d){De.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Es,De);var hk=/^https?$/i,pk=["POST","PUT"];e=Es.prototype,e.Ha=function(d){this.J=d},e.ea=function(d,v,D,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():H.g(),this.v=this.o?_s(this.o):_s(H),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(ge){Lx(this,ge);return}if(d=D||"",D=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var ee in G)D.set(ee,G[ee]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const ge of G.keys())D.set(ge,G.get(ge));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(D.keys()).find(ge=>ge.toLowerCase()=="content-type"),ee=a.FormData&&d instanceof a.FormData,!(0<=Array.prototype.indexOf.call(pk,v,void 0))||G||ee||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ge,Me]of D)this.g.setRequestHeader(ge,Me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Vx(this),this.u=!0,this.g.send(d),this.u=!1}catch(ge){Lx(this,ge)}};function Lx(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,Ox(d),Mp(d)}function Ox(d){d.A||(d.A=!0,Ee(d,"complete"),Ee(d,"error"))}e.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Ee(this,"complete"),Ee(this,"abort"),Mp(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mp(this,!0)),Es.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Gx(this):this.bb())},e.bb=function(){Gx(this)};function Gx(d){if(d.h&&typeof o<"u"&&(!d.v[1]||$n(d)!=4||d.Z()!=2)){if(d.u&&$n(d)==4)Ue(d.Ea,0,d);else if(Ee(d,"readystatechange"),$n(d)==4){d.h=!1;try{const Me=d.Z();e:switch(Me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var D;if(!(D=v)){var G;if(G=Me===0){var ee=String(d.D).match($e)[1]||null;!ee&&a.self&&a.self.location&&(ee=a.self.location.protocol.slice(0,-1)),G=!hk.test(ee?ee.toLowerCase():"")}D=G}if(D)Ee(d,"complete"),Ee(d,"success");else{d.m=6;try{var ge=2<$n(d)?d.g.statusText:""}catch{ge=""}d.l=ge+" ["+d.Z()+"]",Ox(d)}}finally{Mp(d)}}}}function Mp(d,v){if(d.g){Vx(d);const D=d.g,G=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||Ee(d,"ready");try{D.onreadystatechange=G}catch{}}}function Vx(d){d.I&&(a.clearTimeout(d.I),d.I=null)}e.isActive=function(){return!!this.g};function $n(d){return d.g?d.g.readyState:0}e.Z=function(){try{return 2<$n(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),wr(v)}};function Bx(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function gk(d){const v={};d=(d.g&&2<=$n(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<d.length;G++){if(S(d[G]))continue;var D=M(d[G]);const ee=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const ge=v[ee]||[];v[ee]=ge,ge.push(D)}P(v,function(G){return G.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function qu(d,v,D){return D&&D.internalChannelParams&&D.internalChannelParams[d]||v}function Hx(d){this.Aa=0,this.i=[],this.j=new Ks,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=qu("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=qu("baseRetryDelayMs",5e3,d),this.cb=qu("retryDelaySeedMs",1e4,d),this.Wa=qu("forwardChannelMaxRetries",2,d),this.wa=qu("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new Ys(d&&d.concurrentRequestLimit),this.Da=new uk,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Hx.prototype,e.la=8,e.G=1,e.connect=function(d,v,D,G){ds(0),this.W=d,this.H=v||{},D&&G!==void 0&&(this.H.OSID=D,this.H.OAID=G),this.F=this.X,this.I=Qx(this,null,this.W),Op(this)};function Dv(d){if(jx(d),d.G==3){var v=d.U++,D=jt(d.I);if(rt(D,"SID",d.K),rt(D,"RID",v),rt(D,"TYPE","terminate"),Qu(d,D),v=new z(d,d.j,v),v.L=2,v.v=Un(jt(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(v.v.toString(),"")}catch{}!D&&a.Image&&(new Image().src=v.v,D=!0),D||(v.g=Zx(v.j,null),v.g.ea(v.v)),v.F=Date.now(),qe(v)}qx(d)}function Lp(d){d.g&&(Av(d),d.g.cancel(),d.g=null)}function jx(d){Lp(d),d.u&&(a.clearTimeout(d.u),d.u=null),Gp(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&a.clearTimeout(d.s),d.s=null)}function Op(d){if(!mi(d.h)&&!d.s){d.s=!0;var v=d.Ga;me||Ae(),pe||(me(),pe=!0),ye.add(v,d),d.B=0}}function fk(d,v){return bs(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=zr(g(d.Ga,d,v),Yx(d,d.B)),d.B++,!0)}e.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const ee=new z(this,this.j,d);let ge=this.o;if(this.S&&(ge?(ge=N(ge),L(ge,this.S)):ge=this.S),this.m!==null||this.O||(ee.H=ge,ge=null),this.P)e:{for(var v=0,D=0;D<this.i.length;D++){t:{var G=this.i[D];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(v+=G,4096<v){v=D;break e}if(v===4096||D===this.i.length-1){v=D+1;break e}}v=1e3}else v=1e3;v=zx(this,ee,v),D=jt(this.I),rt(D,"RID",d),rt(D,"CVER",22),this.D&&rt(D,"X-HTTP-Session-Id",this.D),Qu(this,D),ge&&(this.O?v="headers="+encodeURIComponent(String(Mx(ge)))+"&"+v:this.m&&Tv(D,this.m,ge)),To(this.h,ee),this.Ua&&rt(D,"TYPE","init"),this.P?(rt(D,"$req",v),rt(D,"SID","null"),ee.T=!0,Te(ee,D,null)):Te(ee,D,v),this.G=2}}else this.G==3&&(d?Wx(this,d):this.i.length==0||mi(this.h)||Wx(this))};function Wx(d,v){var D;v?D=v.l:D=d.U++;const G=jt(d.I);rt(G,"SID",d.K),rt(G,"RID",D),rt(G,"AID",d.T),Qu(d,G),d.m&&d.o&&Tv(G,d.m,d.o),D=new z(d,d.j,D,d.B+1),d.m===null&&(D.H=d.o),v&&(d.i=v.D.concat(d.i)),v=zx(d,D,1e3),D.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),To(d.h,D),Te(D,G,v)}function Qu(d,v){d.H&&j(d.H,function(D,G){rt(v,G,D)}),d.l&&vt({},function(D,G){rt(v,G,D)})}function zx(d,v,D){D=Math.min(d.i.length,D);var G=d.l?g(d.l.Na,d.l,d):null;e:{var ee=d.i;let ge=-1;for(;;){const Me=["count="+D];ge==-1?0<D?(ge=ee[0].g,Me.push("ofs="+ge)):ge=0:Me.push("ofs="+ge);let Zt=!0;for(let qs=0;qs<D;qs++){let Wt=ee[qs].g;const ri=ee[qs].map;if(Wt-=ge,0>Wt)ge=Math.max(0,ee[qs].g-100),Zt=!1;else try{dk(ri,Me,"req"+Wt+"_")}catch{G&&G(ri)}}if(Zt){G=Me.join("&");break e}}}return d=d.i.splice(0,D),v.D=d,G}function Ux(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;me||Ae(),pe||(me(),pe=!0),ye.add(v,d),d.v=0}}function Pv(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=zr(g(d.Fa,d),Yx(d,d.v)),d.v++,!0)}e.Fa=function(){if(this.u=null,$x(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=zr(g(this.ab,this),d)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ds(10),Lp(this),$x(this))};function Av(d){d.A!=null&&(a.clearTimeout(d.A),d.A=null)}function $x(d){d.g=new z(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=jt(d.qa);rt(v,"RID","rpc"),rt(v,"SID",d.K),rt(v,"AID",d.T),rt(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&rt(v,"TO",d.ja),rt(v,"TYPE","xmlhttp"),Qu(d,v),d.m&&d.o&&Tv(v,d.m,d.o),d.L&&(d.g.I=d.L);var D=d.g;d=d.ia,D.L=1,D.v=Un(jt(v)),D.m=null,D.P=!0,Ie(D,d)}e.Za=function(){this.C!=null&&(this.C=null,Lp(this),Pv(this),ds(19))};function Gp(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function Kx(d,v){var D=null;if(d.g==v){Gp(d),Av(d),d.g=null;var G=2}else if(Cn(d.h,v))D=v.D,mt(d.h,v),G=1;else return;if(d.G!=0){if(v.o)if(G==1){D=v.m?v.m.length:0,v=Date.now()-v.F;var ee=d.B;G=Ma(),Ee(G,new sr(G,D)),Op(d)}else Ux(d);else if(ee=v.s,ee==3||ee==0&&0<v.X||!(G==1&&fk(d,v)||G==2&&Pv(d)))switch(D&&0<D.length&&(v=d.h,v.i=v.i.concat(D)),ee){case 1:Oa(d,5);break;case 4:Oa(d,10);break;case 3:Oa(d,6);break;default:Oa(d,2)}}}function Yx(d,v){let D=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(D*=2),D*v}function Oa(d,v){if(d.j.info("Error code "+v),v==2){var D=g(d.fb,d),G=d.Xa;const ee=!G;G=new He(G||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||At(G,"https"),Un(G),ee?lk(G.toString(),D):ck(G.toString(),D)}else ds(2);d.G=0,d.l&&d.l.sa(v),qx(d),jx(d)}e.fb=function(d){d?(this.j.info("Successfully pinged google.com"),ds(2)):(this.j.info("Failed to ping google.com"),ds(1))};function qx(d){if(d.G=0,d.ka=[],d.l){const v=hs(d.h);(v.length!=0||d.i.length!=0)&&(R(d.ka,v),R(d.ka,d.i),d.h.i.length=0,y(d.i),d.i.length=0),d.l.ra()}}function Qx(d,v,D){var G=D instanceof He?jt(D):new He(D);if(G.g!="")v&&(G.g=v+"."+G.g),ys(G,G.s);else{var ee=a.location;G=ee.protocol,v=v?v+"."+ee.hostname:ee.hostname,ee=+ee.port;var ge=new He(null);G&&At(ge,G),v&&(ge.g=v),ee&&ys(ge,ee),D&&(ge.l=D),G=ge}return D=d.D,v=d.ya,D&&v&&rt(G,D,v),rt(G,"VER",d.la),Qu(d,G),G}function Zx(d,v,D){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new Es(new _p({eb:D})):new Es(d.pa),v.Ha(d.J),v}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Jx(){}e=Jx.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function br(d,v){De.call(this),this.g=new Hx(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!S(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!S(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new tc(this)}C(br,De),br.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},br.prototype.close=function(){Dv(this.g)},br.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var D={};D.__data__=d,d=D}else this.u&&(D={},D.__data__=Pt(d),d=D);v.i.push(new Lt(v.Ya++,d)),v.G==3&&Op(v)},br.prototype.N=function(){this.g.l=null,delete this.j,Dv(this.g),delete this.g,br.aa.N.call(this)};function Xx(d){Eo.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const D in v){d=D;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}C(Xx,Eo);function eb(){Ro.call(this),this.status=1}C(eb,Ro);function tc(d){this.g=d}C(tc,Jx),tc.prototype.ua=function(){Ee(this.g,"a")},tc.prototype.ta=function(d){Ee(this.g,new Xx(d))},tc.prototype.sa=function(d){Ee(this.g,new eb)},tc.prototype.ra=function(){Ee(this.g,"b")},br.prototype.send=br.prototype.o,br.prototype.open=br.prototype.m,br.prototype.close=br.prototype.close,zu.NO_ERROR=0,zu.TIMEOUT=8,zu.HTTP_ERROR=6,Rv.COMPLETE="complete",Xl.EventType=vn,vn.OPEN="a",vn.CLOSE="b",vn.ERROR="c",vn.MESSAGE="d",De.prototype.listen=De.prototype.K,Es.prototype.listenOnce=Es.prototype.L,Es.prototype.getLastError=Es.prototype.Ka,Es.prototype.getLastErrorCode=Es.prototype.Ba,Es.prototype.getStatus=Es.prototype.Z,Es.prototype.getResponseJson=Es.prototype.Oa,Es.prototype.getResponseText=Es.prototype.oa,Es.prototype.send=Es.prototype.ea,Es.prototype.setWithCredentials=Es.prototype.Ha}).apply(typeof hg<"u"?hg:typeof self<"u"?self:typeof window<"u"?window:{});const XR="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}yi.UNAUTHENTICATED=new yi(null),yi.GOOGLE_CREDENTIALS=new yi("google-credentials-uid"),yi.FIRST_PARTY=new yi("first-party-uid"),yi.MOCK_USER=new yi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Np="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu=new i_("@firebase/firestore");function an(e,...t){if(gu.logLevel<=Qt.DEBUG){const s=t.map(wx);gu.debug(`Firestore (${Np}): ${e}`,...s)}}function u_(e,...t){if(gu.logLevel<=Qt.ERROR){const s=t.map(wx);gu.error(`Firestore (${Np}): ${e}`,...s)}}function kW(e,...t){if(gu.logLevel<=Qt.WARN){const s=t.map(wx);gu.warn(`Firestore (${Np}): ${e}`,...s)}}function wx(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(s){return JSON.stringify(s)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(e="Unexpected state"){const t=`FIRESTORE (${Np}) INTERNAL ASSERTION FAILED: `+e;throw u_(t),new Error(t)}function Bd(e,t){e||Sx()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class ji extends Vu{constructor(t,s){super(t,s),this.code=t,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(){this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(t,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class MW{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,s){t.enqueueRetryable(()=>s(yi.UNAUTHENTICATED))}shutdown(){}}class LW{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,s){this.changeListener=s,t.enqueueRetryable(()=>s(this.token.user))}shutdown(){this.changeListener=null}}class OW{constructor(t){this.t=t,this.currentUser=yi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,s){Bd(this.o===void 0);let i=this.i;const r=l=>this.i!==i?(i=this.i,s(l)):Promise.resolve();let n=new Hd;this.o=()=>{this.i++,this.currentUser=this.u(),n.resolve(),n=new Hd,t.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=n;t.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{an("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(an("FirebaseAuthCredentialsProvider","Auth not yet detected"),n.resolve(),n=new Hd)}},0),o()}getToken(){const t=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then(i=>this.i!==t?(an("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Bd(typeof i.accessToken=="string"),new d_(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Bd(t===null||typeof t=="string"),new yi(t)}}class GW{constructor(t,s,i){this.l=t,this.h=s,this.P=i,this.type="FirstParty",this.user=yi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class VW{constructor(t,s,i){this.l=t,this.h=s,this.P=i}getToken(){return Promise.resolve(new GW(this.l,this.h,this.P))}start(t,s){t.enqueueRetryable(()=>s(yi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class BW{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HW{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,s){Bd(this.o===void 0);const i=n=>{n.error!=null&&an("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${n.error.message}`);const o=n.token!==this.R;return this.R=n.token,an("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?s(n.token):Promise.resolve()};this.o=n=>{t.enqueueRetryable(()=>i(n))};const r=n=>{an("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=n,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(n=>r(n)),setTimeout(()=>{if(!this.appCheck){const n=this.A.getImmediate({optional:!0});n?r(n):an("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(s=>s?(Bd(typeof s.token=="string"),this.R=s.token,new BW(s.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function jW(e){return e.name==="IndexedDbTransactionError"}class em{constructor(t,s){this.projectId=t,this.database=s||"(default)"}static empty(){return new em("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof em&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eT,Ot;(Ot=eT||(eT={}))[Ot.OK=0]="OK",Ot[Ot.CANCELLED=1]="CANCELLED",Ot[Ot.UNKNOWN=2]="UNKNOWN",Ot[Ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ot[Ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ot[Ot.NOT_FOUND=5]="NOT_FOUND",Ot[Ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ot[Ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ot[Ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ot[Ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ot[Ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ot[Ot.ABORTED=10]="ABORTED",Ot[Ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ot[Ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ot[Ot.INTERNAL=13]="INTERNAL",Ot[Ot.UNAVAILABLE=14]="UNAVAILABLE",Ot[Ot.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new c_([4294967295,4294967295],0);function GC(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WW{constructor(t,s,i=1e3,r=1.5,n=6e4){this.ui=t,this.timerId=s,this.ko=i,this.qo=r,this.Qo=n,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const s=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,s-i);r>0&&an("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${s} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(t,s,i,r,n){this.asyncQueue=t,this.timerId=s,this.targetTimeMs=i,this.op=r,this.removalCallback=n,this.deferred=new Hd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,s,i,r,n){const o=Date.now()+i,a=new xx(t,s,o,r,n);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ji(Hi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var tT,sT;(sT=tT||(tT={})).ea="default",sT.Cache="cache";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zW(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT=new Map;function UW(e,t,s,i){if(t===!0&&i===!0)throw new ji(Hi.INVALID_ARGUMENT,`${e} and ${s} cannot be used together.`)}function $W(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Sx()}function KW(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ji(Hi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=$W(e);throw new ji(Hi.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${s}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(t){var s,i;if(t.host===void 0){if(t.ssl!==void 0)throw new ji(Hi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(s=t.ssl)===null||s===void 0||s;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new ji(Hi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}UW("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zW((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ji(Hi.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ji(Hi.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ji(Hi.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class h_{constructor(t,s,i,r){this._authCredentials=t,this._appCheckCredentials=s,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rT({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ji(Hi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new ji(Hi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rT(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new MW;switch(i.type){case"firstParty":return new VW(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ji(Hi.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(s){const i=iT.get(s);i&&(an("ComponentProvider","Removing Datastore"),iT.delete(s),i.terminate())}(this),Promise.resolve()}}function YW(e,t,s,i={}){var r;const n=(e=KW(e,h_))._getSettings(),o=`${t}:${s}`;if(n.host!=="firestore.googleapis.com"&&n.host!==o&&kW("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},n),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=yi.MOCK_USER;else{a=m4(i.mockUserToken,(r=e._app)===null||r===void 0?void 0:r.options.projectId);const u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new ji(Hi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new yi(u)}e._authCredentials=new LW(new d_(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new WW(this,"async_queue_retry"),this.Vu=()=>{const i=GC();i&&an("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=t;const s=GC();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const s=GC();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const s=new Hd;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(s.resolve,s.reject),s.promise)).then(()=>s.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!jW(t))throw t;an("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const s=this.mu.then(()=>(this.du=!0,t().catch(i=>{this.Eu=i,this.du=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw u_("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=s,s}enqueueAfterDelay(t,s,i){this.fu(),this.Ru.indexOf(t)>-1&&(s=0);const r=xx.createAndSchedule(this,t,s,i,n=>this.yu(n));return this.Tu.push(r),r}fu(){this.Eu&&Sx()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const s of this.Tu)if(s.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((s,i)=>s.targetTimeMs-i.targetTimeMs);for(const s of this.Tu)if(s.skipDelay(),t!=="all"&&s.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const s=this.Tu.indexOf(t);this.Tu.splice(s,1)}}class qW extends h_{constructor(t,s,i,r){super(t,s,i,r),this.type="firestore",this._queue=new nT,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new nT(t),this._firestoreClient=void 0,await t}}}function QW(e,t){const s=typeof e=="object"?e:xW(),i=typeof e=="string"?e:"(default)",r=CW(s,"firestore").getImmediate({identifier:i});if(!r._initialized){const n=g4("firestore");n&&YW(r,...n)}return r}(function(t,s=!0){(function(r){Np=r})(SW),Xf(new Vh("firestore",(i,{instanceIdentifier:r,options:n})=>{const o=i.getProvider("app").getImmediate(),a=new qW(new OW(i.getProvider("auth-internal")),new HW(i.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ji(Hi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new em(u.options.projectId,h)}(o,r),o);return n=Object.assign({useFetchStreams:s},n),a._setSettings(n),a},"PUBLIC").setMultipleInstances(!0)),kc(XR,"4.7.3",t),kc(XR,"4.7.3","esm2017")})();const ZW={apiKey:"AIzaSyD6P4U8D1lOJ-h8-QgQ6GYTp4h9Qy7YQHM",authDomain:"nutrasafe-705c7.firebaseapp.com",projectId:"nutrasafe-705c7",storageBucket:"nutrasafe-705c7.appspot.com",messagingSenderId:"1043273165814",appId:"1:1043273165814:web:c3e98e4d8f5a6b7c8d9e0f"};let pg,oT;function JW(){return pg||(pg=o_(ZW),oT=QW(pg)),{app:pg,db:oT}}const Hh="https://us-central1-nutrasafe-705c7.cloudfunctions.net";async function Ed(e,t){const{objectID:s,_hasFirestoreBacking:i,_firestoreCollection:r,_sourceIndex:n}=e,o={foodId:s,collection:i?r:n,foodName:t.name,brandName:t.brandName,barcode:t.barcode,extractedIngredients:t.ingredientsText,nutritionData:{calories:t.calories,protein:t.protein,carbs:t.carbs,fat:t.fat,saturatedFat:t.saturatedFat,fiber:t.fiber,sugar:t.sugar,sodium:t.sodium,salt:t.salt},servingSize:t.servingDescription,servingSizeG:t.servingSizeG,isPerUnit:t.isPerUnit,source:t.source};try{const l=await(await fetch(`${Hh}/updateVerifiedFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();return l.success?{success:!0}:{success:!1,error:l.error||"Unknown error"}}catch(a){return console.error("Error updating food:",a),{success:!1,error:String(a)}}}async function XW(e){var r,n;const{_sourceIndex:t,objectID:s,barcode:i}=e;try{let o=await fetch(`${Hh}/deleteFoodComprehensive`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:s,indexName:t,barcode:i,deleteFromAllIndices:!0})});o.ok||(console.log("Comprehensive delete unavailable, using single-index delete"),o=await fetch(`${Hh}/deleteFoodFromAlgolia`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:s,indexName:t})}));const a=await o.json();return a.success?(console.log(` Deleted food from ${((r=a.deletedFrom)==null?void 0:r.length)||1} location(s)`),{success:!0,deletedFrom:((n=a.deletedFrom)==null?void 0:n.length)||1}):{success:!1,error:a.error||"Unknown error"}}catch(o){return console.error("Error deleting food:",o),{success:!1,error:String(o)}}}async function ez(e){let t=0,s=0;const i=[],r=5;for(let n=0;n<e.length;n+=r){const o=e.slice(n,n+r);(await Promise.all(o.map(({food:l,updates:u})=>Ed(l,u)))).forEach((l,u)=>{l.success?t++:(s++,i.push(`${o[u].food.name}: ${l.error}`))})}return{success:t,failed:s,errors:i}}async function tz(e){let t=0,s=0;const i=[],r=5;for(let n=0;n<e.length;n+=r){const o=e.slice(n,n+r);(await Promise.all(o.map(l=>XW(l)))).forEach((l,u)=>{l.success?t++:(s++,i.push(`${o[u].name}: ${l.error}`))})}return{success:t,failed:s,errors:i}}async function sz(e){try{const s=await(await fetch(`${Hh}/addVerifiedFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodName:e.name,brandName:e.brandName,barcode:e.barcode,extractedIngredients:e.ingredientsText,nutritionData:{calories:e.calories,protein:e.protein,carbs:e.carbs,fat:e.fat,saturatedFat:e.saturatedFat,fiber:e.fiber,sugar:e.sugar,sodium:e.sodium,salt:e.salt},servingSize:e.servingDescription})})).json();return s.success?{success:!0,foodId:s.foodId}:{success:!1,error:s.error||"Unknown error"}}catch(t){return console.error("Error adding food:",t),{success:!1,error:String(t)}}}async function iz(e,t){const s=new Map;e.forEach(o=>{const a=o._sourceIndex;s.has(a)||s.set(a,[]),s.get(a).push(o.objectID)});let i=0,r=0;const n=[];for(const[o,a]of s.entries()){if(o===t){console.log(`Skipping ${a.length} foods already in ${t}`),i+=a.length;continue}try{const l=await fetch(`${Hh}/moveFoodsBetweenIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodIds:a,fromIndex:o,toIndex:t})});if(!l.ok){const h=await l.text();console.error(` Move failed (HTTP ${l.status}):`,h),r+=a.length,n.push(`${o}  ${t}: HTTP ${l.status} - ${h}`);continue}const u=await l.json();if(console.log("Move result:",u),u.success)i+=u.moved||0,r+=u.failed||0,u.errors&&u.errors.length>0&&n.push(...u.errors),console.log(` Moved ${u.moved} foods from ${o} to ${t}`);else{r+=a.length;const h=u.details||u.error||"Unknown error";console.error(" Move failed:",h),n.push(`${o}  ${t}: ${h}`)}}catch(l){console.error(` Error moving foods from ${o}:`,l),r+=a.length,n.push(`${o}  ${t}: ${String(l)}`)}}return{success:i,failed:r,errors:n}}const rz="modulepreload",nz=function(e){return"/admin-v2/"+e},aT={},lT=function(t,s,i){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(s.map(l=>{if(l=nz(l),l in aT)return;aT[l]=!0;const u=l.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":rz,u||(p.as="script"),p.crossOrigin="",p.href=l,a&&p.setAttribute("nonce",a),document.head.appendChild(p),u)return new Promise((g,m)=>{p.addEventListener("load",g),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return t().catch(n)})};var oz=Object.create,p_=Object.defineProperty,az=Object.getOwnPropertyDescriptor,g_=Object.getOwnPropertyNames,lz=Object.getPrototypeOf,cz=Object.prototype.hasOwnProperty,bx=(e,t)=>function(){return t||(0,e[g_(e)[0]])((t={exports:{}}).exports,t),t.exports},uz=(e,t,s,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of g_(t))!cz.call(e,r)&&r!==s&&p_(e,r,{get:()=>t[r],enumerable:!(i=az(t,r))||i.enumerable});return e},yv=(e,t,s)=>(s=e!=null?oz(lz(e)):{},uz(!e||!e.__esModule?p_(s,"default",{value:e,enumerable:!0}):s,e)),dz=bx({"../../node_modules/.pnpm/iota-array@1.0.0/node_modules/iota-array/iota.js"(e,t){function s(i){for(var r=new Array(i),n=0;n<i;++n)r[n]=n;return r}t.exports=s}}),hz=bx({"../../node_modules/.pnpm/is-buffer@1.1.6/node_modules/is-buffer/index.js"(e,t){t.exports=function(r){return r!=null&&(s(r)||i(r)||!!r._isBuffer)};function s(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function i(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&s(r.slice(0,0))}}}),wv=bx({"../../node_modules/.pnpm/ndarray@1.0.19/node_modules/ndarray/ndarray.js"(e,t){var s=dz(),i=hz(),r=typeof Float64Array<"u";function n(p,g){return p[0]-g[0]}function o(){var p=this.stride,g=new Array(p.length),m;for(m=0;m<g.length;++m)g[m]=[Math.abs(p[m]),m];g.sort(n);var C=new Array(g.length);for(m=0;m<C.length;++m)C[m]=g[m][1];return C}function a(p,g){var m=["View",g,"d",p].join("");g<0&&(m="View_Nil"+p);var C=p==="generic";if(g===-1){var y="function "+m+"(a){this.data=a;};var proto="+m+".prototype;proto.dtype='"+p+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+m+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+m+"(a){return new "+m+"(a);}",L=new Function(y);return L()}else if(g===0){var y="function "+m+"(a,d) {this.data = a;this.offset = d};var proto="+m+".prototype;proto.dtype='"+p+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+m+"_copy() {return new "+m+"(this.data,this.offset)};proto.pick=function "+m+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+m+"_get(){return "+(C?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+m+"_set(v){return "+(C?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+m+"(a,b,c,d){return new "+m+"(a,d)}",L=new Function("TrivialArray",y);return L(u[p][0])}var y=["'use strict'"],R=s(g),x=R.map(function(M){return"i"+M}),S="this.offset+"+R.map(function(M){return"this.stride["+M+"]*i"+M}).join("+"),T=R.map(function(M){return"b"+M}).join(","),I=R.map(function(M){return"c"+M}).join(",");y.push("function "+m+"(a,"+T+","+I+",d){this.data=a","this.shape=["+T+"]","this.stride=["+I+"]","this.offset=d|0}","var proto="+m+".prototype","proto.dtype='"+p+"'","proto.dimension="+g),y.push("Object.defineProperty(proto,'size',{get:function "+m+"_size(){return "+R.map(function(M){return"this.shape["+M+"]"}).join("*"),"}})"),g===1?y.push("proto.order=[0]"):(y.push("Object.defineProperty(proto,'order',{get:"),g<4?(y.push("function "+m+"_order(){"),g===2?y.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):g===3&&y.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):y.push("ORDER})")),y.push("proto.set=function "+m+"_set("+x.join(",")+",v){"),C?y.push("return this.data.set("+S+",v)}"):y.push("return this.data["+S+"]=v}"),y.push("proto.get=function "+m+"_get("+x.join(",")+"){"),C?y.push("return this.data.get("+S+")}"):y.push("return this.data["+S+"]}"),y.push("proto.index=function "+m+"_index(",x.join(),"){return "+S+"}"),y.push("proto.hi=function "+m+"_hi("+x.join(",")+"){return new "+m+"(this.data,"+R.map(function(M){return["(typeof i",M,"!=='number'||i",M,"<0)?this.shape[",M,"]:i",M,"|0"].join("")}).join(",")+","+R.map(function(M){return"this.stride["+M+"]"}).join(",")+",this.offset)}");var V=R.map(function(M){return"a"+M+"=this.shape["+M+"]"}),j=R.map(function(M){return"c"+M+"=this.stride["+M+"]"});y.push("proto.lo=function "+m+"_lo("+x.join(",")+"){var b=this.offset,d=0,"+V.join(",")+","+j.join(","));for(var P=0;P<g;++P)y.push("if(typeof i"+P+"==='number'&&i"+P+">=0){d=i"+P+"|0;b+=c"+P+"*d;a"+P+"-=d}");y.push("return new "+m+"(this.data,"+R.map(function(M){return"a"+M}).join(",")+","+R.map(function(M){return"c"+M}).join(",")+",b)}"),y.push("proto.step=function "+m+"_step("+x.join(",")+"){var "+R.map(function(M){return"a"+M+"=this.shape["+M+"]"}).join(",")+","+R.map(function(M){return"b"+M+"=this.stride["+M+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var P=0;P<g;++P)y.push("if(typeof i"+P+"==='number'){d=i"+P+"|0;if(d<0){c+=b"+P+"*(a"+P+"-1);a"+P+"=ceil(-a"+P+"/d)}else{a"+P+"=ceil(a"+P+"/d)}b"+P+"*=d}");y.push("return new "+m+"(this.data,"+R.map(function(M){return"a"+M}).join(",")+","+R.map(function(M){return"b"+M}).join(",")+",c)}");for(var N=new Array(g),_=new Array(g),P=0;P<g;++P)N[P]="a[i"+P+"]",_[P]="b[i"+P+"]";y.push("proto.transpose=function "+m+"_transpose("+x+"){"+x.map(function(M,E){return M+"=("+M+"===undefined?"+E+":"+M+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+m+"(this.data,"+N.join(",")+","+_.join(",")+",this.offset)}"),y.push("proto.pick=function "+m+"_pick("+x+"){var a=[],b=[],c=this.offset");for(var P=0;P<g;++P)y.push("if(typeof i"+P+"==='number'&&i"+P+">=0){c=(c+this.stride["+P+"]*i"+P+")|0}else{a.push(this.shape["+P+"]);b.push(this.stride["+P+"])}");y.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),y.push("return function construct_"+m+"(data,shape,stride,offset){return new "+m+"(data,"+R.map(function(M){return"shape["+M+"]"}).join(",")+","+R.map(function(M){return"stride["+M+"]"}).join(",")+",offset)}");var L=new Function("CTOR_LIST","ORDER",y.join(`
`));return L(u[p],o)}function l(p){if(i(p))return"buffer";if(r)switch(Object.prototype.toString.call(p)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(p)?"array":"generic"}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function h(p,g,m,C){if(p===void 0){var I=u.array[0];return I([])}else typeof p=="number"&&(p=[p]);g===void 0&&(g=[p.length]);var y=g.length;if(m===void 0){m=new Array(y);for(var R=y-1,x=1;R>=0;--R)m[R]=x,x*=g[R]}if(C===void 0){C=0;for(var R=0;R<y;++R)m[R]<0&&(C-=(g[R]-1)*m[R])}for(var S=l(p),T=u[S];T.length<=y+1;)T.push(a(S,T.length-1));var I=T[y+1];return I(p,g,m,C)}t.exports=h}}),pz=typeof global=="object"&&global&&global.Object===Object&&global,gz=pz,fz=typeof self=="object"&&self&&self.Object===Object&&self,mz=gz||fz||Function("return this")(),Ex=mz,vz=Ex.Symbol,tm=vz,f_=Object.prototype,Cz=f_.hasOwnProperty,yz=f_.toString,od=tm?tm.toStringTag:void 0;function wz(e){var t=Cz.call(e,od),s=e[od];try{e[od]=void 0;var i=!0}catch{}var r=yz.call(e);return i&&(t?e[od]=s:delete e[od]),r}var Sz=wz,xz=Object.prototype,bz=xz.toString;function Ez(e){return bz.call(e)}var Rz=Ez,Tz="[object Null]",Dz="[object Undefined]",cT=tm?tm.toStringTag:void 0;function Pz(e){return e==null?e===void 0?Dz:Tz:cT&&cT in Object(e)?Sz(e):Rz(e)}var Az=Pz;function Fz(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var m_=Fz,Nz="[object AsyncFunction]",Iz="[object Function]",_z="[object GeneratorFunction]",kz="[object Proxy]";function Mz(e){if(!m_(e))return!1;var t=Az(e);return t==Iz||t==_z||t==Nz||t==kz}var Lz=Mz,Oz=Ex["__core-js_shared__"],VC=Oz,uT=function(){var e=/[^.]+$/.exec(VC&&VC.keys&&VC.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Gz(e){return!!uT&&uT in e}var Vz=Gz,Bz=Function.prototype,Hz=Bz.toString;function jz(e){if(e!=null){try{return Hz.call(e)}catch{}try{return e+""}catch{}}return""}var Wz=jz,zz=/[\\^$.*+?()[\]{}|]/g,Uz=/^\[object .+?Constructor\]$/,$z=Function.prototype,Kz=Object.prototype,Yz=$z.toString,qz=Kz.hasOwnProperty,Qz=RegExp("^"+Yz.call(qz).replace(zz,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Zz(e){if(!m_(e)||Vz(e))return!1;var t=Lz(e)?Qz:Uz;return t.test(Wz(e))}var Jz=Zz;function Xz(e,t){return e==null?void 0:e[t]}var eU=Xz;function tU(e,t){var s=eU(e,t);return Jz(s)?s:void 0}var v_=tU,sU=v_(Object,"create"),jh=sU;function iU(){this.__data__=jh?jh(null):{},this.size=0}var rU=iU;function nU(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var oU=nU,aU="__lodash_hash_undefined__",lU=Object.prototype,cU=lU.hasOwnProperty;function uU(e){var t=this.__data__;if(jh){var s=t[e];return s===aU?void 0:s}return cU.call(t,e)?t[e]:void 0}var dU=uU,hU=Object.prototype,pU=hU.hasOwnProperty;function gU(e){var t=this.__data__;return jh?t[e]!==void 0:pU.call(t,e)}var fU=gU,mU="__lodash_hash_undefined__";function vU(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=jh&&t===void 0?mU:t,this}var CU=vU;function Bu(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var i=e[t];this.set(i[0],i[1])}}Bu.prototype.clear=rU;Bu.prototype.delete=oU;Bu.prototype.get=dU;Bu.prototype.has=fU;Bu.prototype.set=CU;var dT=Bu;function yU(){this.__data__=[],this.size=0}var wU=yU;function SU(e,t){return e===t||e!==e&&t!==t}var xU=SU;function bU(e,t){for(var s=e.length;s--;)if(xU(e[s][0],t))return s;return-1}var Sv=bU,EU=Array.prototype,RU=EU.splice;function TU(e){var t=this.__data__,s=Sv(t,e);if(s<0)return!1;var i=t.length-1;return s==i?t.pop():RU.call(t,s,1),--this.size,!0}var DU=TU;function PU(e){var t=this.__data__,s=Sv(t,e);return s<0?void 0:t[s][1]}var AU=PU;function FU(e){return Sv(this.__data__,e)>-1}var NU=FU;function IU(e,t){var s=this.__data__,i=Sv(s,e);return i<0?(++this.size,s.push([e,t])):s[i][1]=t,this}var _U=IU;function Hu(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var i=e[t];this.set(i[0],i[1])}}Hu.prototype.clear=wU;Hu.prototype.delete=DU;Hu.prototype.get=AU;Hu.prototype.has=NU;Hu.prototype.set=_U;var kU=Hu,MU=v_(Ex,"Map"),LU=MU;function OU(){this.size=0,this.__data__={hash:new dT,map:new(LU||kU),string:new dT}}var GU=OU;function VU(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var BU=VU;function HU(e,t){var s=e.__data__;return BU(t)?s[typeof t=="string"?"string":"hash"]:s.map}var xv=HU;function jU(e){var t=xv(this,e).delete(e);return this.size-=t?1:0,t}var WU=jU;function zU(e){return xv(this,e).get(e)}var UU=zU;function $U(e){return xv(this,e).has(e)}var KU=$U;function YU(e,t){var s=xv(this,e),i=s.size;return s.set(e,t),this.size+=s.size==i?0:1,this}var qU=YU;function ju(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var i=e[t];this.set(i[0],i[1])}}ju.prototype.clear=GU;ju.prototype.delete=WU;ju.prototype.get=UU;ju.prototype.has=KU;ju.prototype.set=qU;var C_=ju,QU="Expected a function";function Rx(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(QU);var s=function(){var i=arguments,r=t?t.apply(this,i):i[0],n=s.cache;if(n.has(r))return n.get(r);var o=e.apply(this,i);return s.cache=n.set(r,o)||n,o};return s.cache=new(Rx.Cache||C_),s}Rx.Cache=C_;var ZU=Rx,Tx=yv(wv()),y_=class _w{constructor(t,s){this.type="application/octet-stream",this.params={},this.type=t,this.params=s}toString(){const t=[];for(const s in this.params){const i=this.params[s];t.push(`${s}=${i}`)}return[this.type,...t].join(";")}static create(t,s){return new _w(t,s)}isIdentical(t){return this.type===t.type&&this.params===t.params}isEqual(t){return this.type===t.type}static fromString(t){const[s,...i]=t.split(";"),r={};for(const n of i){const[o,a]=n.split("=");r[o.trim()]=a.trim()}return new _w(s,r)}},BC=yv(wv());async function JU(e){const t=y_.fromString(e.type);switch(t.type){case"image/x-alpha8":{const s=parseInt(t.params.width),i=parseInt(t.params.height);return(0,BC.default)(new Uint8Array(await e.arrayBuffer()),[i,s,1])}case"image/x-rgba8":{const s=parseInt(t.params.width),i=parseInt(t.params.height);return(0,BC.default)(new Uint8Array(await e.arrayBuffer()),[i,s,4])}case"application/octet-stream":case"image/png":case"image/jpeg":case"image/jpg":case"image/webp":{const s=await createImageBitmap(e),i=s5(s);return(0,BC.default)(new Uint8Array(i.data),[i.height,i.width,4])}default:throw new Error(`Invalid format: ${t.type} with params: ${t.params}`)}}async function XU(e,t=.8,s="image/png"){const[i,r,n]=e.shape;switch(s){case"image/x-alpha8":case"image/x-rgba8":{const l=y_.create(s,{width:r.toString(),height:i.toString()});return new Blob([e.data],{type:l.toString()})}case"image/png":case"image/jpeg":case"image/webp":{const l=new ImageData(new Uint8ClampedArray(e.data),r,i);var o=w_(l.width,l.height),a=o.getContext("2d");return a.putImageData(l,0,0),o.convertToBlob({quality:t,type:s})}default:throw new Error(`Invalid format: ${s}`)}}function e5(e){return new RegExp("^(?:[a-z+]+:)?//","i").test(e)}function t5(e,t){return e5(e)?e:new URL(e,t).href}function s5(e){var t=w_(e.width,e.height),s=t.getContext("2d");return s.drawImage(e,0,0),s.getImageData(0,0,t.width,t.height)}function i5(e){if(typeof Uint8Array<"u")return new Uint8Array(e);if(typeof Uint8ClampedArray<"u")return new Uint8ClampedArray(e);if(typeof Uint16Array<"u")return new Uint16Array(e);if(typeof Uint32Array<"u")return new Uint32Array(e);if(typeof Float32Array<"u")return new Float32Array(e);if(typeof Float64Array<"u")return new Float64Array(e);throw new Error("TypedArray not supported")}function hT(e,t,s,i=!1){const[r,n,o]=e.shape;let a=n/t,l=r/s;i&&(a=l=Math.max(a,l)>1?Math.max(a,l):Math.min(a,l));const u=(0,Tx.default)(i5(o*t*s),[s,t,o]);for(let h=0;h<s;h++)for(let p=0;p<t;p++){const g=p*a,m=h*l,C=Math.max(Math.floor(g),0),y=Math.min(Math.ceil(g),n-1),R=Math.max(Math.floor(m),0),x=Math.min(Math.ceil(m),r-1),S=g-C,T=m-R;for(let I=0;I<o;I++){const V=e.get(R,C,I),j=e.get(R,y,I),P=e.get(x,C,I),N=e.get(x,y,I),_=(1-S)*(1-T)*V+S*(1-T)*j+(1-S)*T*P+S*T*N;u.set(h,p,I,_)}}return u}function r5(e,t=[128,128,128],s=[256,256,256]){var i=e.data;const[r,n,o]=e.shape,a=r*n,l=new Float32Array(3*a);for(let u=0,h=0;u<i.length;u+=4,h+=1)l[h]=(i[u]-t[0])/s[0],l[h+a]=(i[u+1]-t[1])/s[1],l[h+a+a]=(i[u+2]-t[2])/s[2];return(0,Tx.default)(l,[1,3,r,n])}async function n5(e,t){return typeof e=="string"&&(e=t5(e,t.publicPath),e=new URL(e)),e instanceof URL&&(e=await(await fetch(e,{})).blob()),(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e=new Blob([e])),e instanceof Blob&&(e=await JU(e)),e}function o5(e){const t=new Uint8Array(e.data.length);for(let s=0;s<e.data.length;s++)t[s]=e.data[s]*255;return(0,Tx.default)(t,e.shape)}function w_(e,t){let s;if(typeof OffscreenCanvas<"u"?s=new OffscreenCanvas(e,t):s=document.createElement("canvas"),!s)throw new Error("Canvas nor OffscreenCanvas are available in the current context.");return s}var a5=yv(wv()),S_=async()=>navigator.gpu===void 0?!1:await navigator.gpu.requestAdapter()!==null,l5=()=>navigator.hardwareConcurrency??4;async function pT(e,t){return URL.createObjectURL(await x_(e,t))}async function x_(e,t){const s=new URL("resources.json",t.publicPath),i=await fetch(s);if(!i.ok)throw new Error("Resource metadata not found. Ensure that the config.publicPath is configured correctly.");const n=(await i.json())[e];if(!n)throw new Error(`Resource ${e} not found. Ensure that the config.publicPath is configured correctly.`);const o=n.chunks;let a=0;const l=o.map(async p=>{const g=p.offsets[1]-p.offsets[0],m=t.publicPath?new URL(p.name,t.publicPath).toString():p.name,y=await(await fetch(m,t.fetchArgs)).blob();if(g!==y.size)throw new Error(`Failed to fetch ${e} with size ${g} but got ${y.size}`);return t.progress&&(a+=g,t.progress(`fetch:${e}`,a,n.size)),y}),u=await Promise.all(l),h=new Blob(u,{type:n.mime});if(h.size!==n.size)throw new Error(`Failed to fetch ${e} with size ${n.size} but got ${h.size}`);return h}var ad=null,b_=async e=>(ad!==null||(e?ad=(await lT(async()=>{const{default:t}=await import("./ort.webgpu.bundle.min-OqVjPHQG.js");return{default:t}},[])).default:ad=(await lT(async()=>{const{default:t}=await import("./ort.bundle.min-fzhtFWcq.js");return{default:t}},[])).default),ad);async function c5(e,t){const s=t.device==="gpu"&&await S_(),i=s&&t.proxyToWorker,r=[s?"webgpu":"wasm"],n=await b_(s);t.debug&&(console.debug("	Using WebGPU:",s),console.debug("	Proxy to Worker:",i),n.env.debug=!0,n.env.logLevel="verbose"),n.env.wasm.numThreads=l5(),n.env.wasm.proxy=i;const o=s?"/onnxruntime-web/ort-wasm-simd-threaded.jsep":"/onnxruntime-web/ort-wasm-simd-threaded",a=await pT(`${o}.wasm`,t),l=await pT(`${o}.mjs`,t);n.env.wasm.wasmPaths={mjs:l,wasm:a},t.debug&&console.debug("ort.env.wasm:",n.env.wasm);const u={executionProviders:r,graphOptimizationLevel:"all",executionMode:"parallel",enableCpuMemArena:!0};return await n.InferenceSession.create(e,u).catch(p=>{throw new Error(`Failed to create session: "${p}". Please check if the publicPath is set correctly.`)})}async function u5(e,t,s,i){const r=i.device==="gpu"&&await S_(),n=await b_(r),o={};for(const[u,h]of t)o[u]=new n.Tensor("float32",new Float32Array(h.data),h.shape);const a=await e.run(o,{}),l=[];for(const u of s){const h=a[u],p=h.dims,g=h.data,m=(0,a5.default)(g,p);l.push(m)}return l}var Gt;(function(e){e.assertEqual=r=>r;function t(r){}e.assertIs=t;function s(r){throw new Error}e.assertNever=s,e.arrayToEnum=r=>{const n={};for(const o of r)n[o]=o;return n},e.getValidEnumValues=r=>{const n=e.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of n)o[a]=r[a];return e.objectValues(o)},e.objectValues=r=>e.objectKeys(r).map(function(n){return r[n]}),e.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const n=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&n.push(o);return n},e.find=(r,n)=>{for(const o of r)if(n(o))return o},e.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function i(r,n=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(n)}e.joinValues=i,e.jsonStringifyReplacer=(r,n)=>typeof n=="bigint"?n.toString():n})(Gt||(Gt={}));var kw;(function(e){e.mergeShapes=(t,s)=>({...t,...s})})(kw||(kw={}));var Ke=Gt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Xn=e=>{switch(typeof e){case"undefined":return Ke.undefined;case"string":return Ke.string;case"number":return isNaN(e)?Ke.nan:Ke.number;case"boolean":return Ke.boolean;case"function":return Ke.function;case"bigint":return Ke.bigint;case"symbol":return Ke.symbol;case"object":return Array.isArray(e)?Ke.array:e===null?Ke.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Ke.promise:typeof Map<"u"&&e instanceof Map?Ke.map:typeof Set<"u"&&e instanceof Set?Ke.set:typeof Date<"u"&&e instanceof Date?Ke.date:Ke.object;default:return Ke.unknown}},_e=Gt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),d5=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),dn=class E_ extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=t}format(t){const s=t||function(n){return n.message},i={_errors:[]},r=n=>{for(const o of n.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)i._errors.push(s(o));else{let a=i,l=0;for(;l<o.path.length;){const u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(s(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return r(this),i}static assert(t){if(!(t instanceof E_))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Gt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=s=>s.message){const s={},i=[];for(const r of this.issues)r.path.length>0?(s[r.path[0]]=s[r.path[0]]||[],s[r.path[0]].push(t(r))):i.push(t(r));return{formErrors:i,fieldErrors:s}}get formErrors(){return this.flatten()}};dn.create=e=>new dn(e);var fu=(e,t)=>{let s;switch(e.code){case _e.invalid_type:e.received===Ke.undefined?s="Required":s=`Expected ${e.expected}, received ${e.received}`;break;case _e.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(e.expected,Gt.jsonStringifyReplacer)}`;break;case _e.unrecognized_keys:s=`Unrecognized key(s) in object: ${Gt.joinValues(e.keys,", ")}`;break;case _e.invalid_union:s="Invalid input";break;case _e.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${Gt.joinValues(e.options)}`;break;case _e.invalid_enum_value:s=`Invalid enum value. Expected ${Gt.joinValues(e.options)}, received '${e.received}'`;break;case _e.invalid_arguments:s="Invalid function arguments";break;case _e.invalid_return_type:s="Invalid function return type";break;case _e.invalid_date:s="Invalid date";break;case _e.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(s=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?s=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?s=`Invalid input: must end with "${e.validation.endsWith}"`:Gt.assertNever(e.validation):e.validation!=="regex"?s=`Invalid ${e.validation}`:s="Invalid";break;case _e.too_small:e.type==="array"?s=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?s=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?s=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?s=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:s="Invalid input";break;case _e.too_big:e.type==="array"?s=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?s=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?s=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?s=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?s=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:s="Invalid input";break;case _e.custom:s="Invalid input";break;case _e.invalid_intersection_types:s="Intersection results could not be merged";break;case _e.not_multiple_of:s=`Number must be a multiple of ${e.multipleOf}`;break;case _e.not_finite:s="Number must be finite";break;default:s=t.defaultError,Gt.assertNever(e)}return{message:s}},R_=fu;function h5(e){R_=e}function sm(){return R_}var im=e=>{const{data:t,path:s,errorMaps:i,issueData:r}=e,n=[...s,...r.path||[]],o={...r,path:n};if(r.message!==void 0)return{...r,path:n,message:r.message};let a="";const l=i.filter(u=>!!u).slice().reverse();for(const u of l)a=u(o,{data:t,defaultError:a}).message;return{...r,path:n,message:a}},p5=[];function Be(e,t){const s=sm(),i=im({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,s,s===fu?void 0:fu].filter(r=>!!r)});e.common.issues.push(i)}var Ji=class T_{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,s){const i=[];for(const r of s){if(r.status==="aborted")return gt;r.status==="dirty"&&t.dirty(),i.push(r.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,s){const i=[];for(const r of s){const n=await r.key,o=await r.value;i.push({key:n,value:o})}return T_.mergeObjectSync(t,i)}static mergeObjectSync(t,s){const i={};for(const r of s){const{key:n,value:o}=r;if(n.status==="aborted"||o.status==="aborted")return gt;n.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),n.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(i[n.value]=o.value)}return{status:t.value,value:i}}},gt=Object.freeze({status:"aborted"}),Ec=e=>({status:"dirty",value:e}),Di=e=>({status:"valid",value:e}),Mw=e=>e.status==="aborted",Lw=e=>e.status==="dirty",Ol=e=>e.status==="valid",Wh=e=>typeof Promise<"u"&&e instanceof Promise;function rm(e,t,s,i){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function D_(e,t,s,i,r){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,s),s}var st;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(st||(st={}));var Rd,Td,Wn=class{constructor(e,t,s,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},gT=(e,t)=>{if(Ol(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new dn(e.common.issues);return this._error=s,this._error}}};function St(e){if(!e)return{};const{errorMap:t,invalid_type_error:s,required_error:i,description:r}=e;if(t&&(s||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:r}:{errorMap:(o,a)=>{var l,u;const{message:h}=e;return o.code==="invalid_enum_value"?{message:h??a.defaultError}:typeof a.data>"u"?{message:(l=h??i)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(u=h??s)!==null&&u!==void 0?u:a.defaultError}},description:r}}var Et=class{get description(){return this._def.description}_getType(e){return Xn(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Xn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ji,ctx:{common:e.parent.common,data:e.data,parsedType:Xn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Wh(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;const i={common:{issues:[],async:(s=t==null?void 0:t.async)!==null&&s!==void 0?s:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Xn(e)},r=this._parseSync({data:e,path:i.path,parent:i});return gT(i,r)}"~validate"(e){var t,s;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Xn(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:i});return Ol(r)?{value:r.value}:{issues:i.common.issues}}catch(r){!((s=(t=r==null?void 0:r.message)===null||t===void 0?void 0:t.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(r=>Ol(r)?{value:r.value}:{issues:i.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Xn(e)},i=this._parse({data:e,path:s.path,parent:s}),r=await(Wh(i)?i:Promise.resolve(i));return gT(s,r)}refine(e,t){const s=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,r)=>{const n=e(i),o=()=>r.addIssue({code:_e.custom,...s(i)});return typeof Promise<"u"&&n instanceof Promise?n.then(a=>a?!0:(o(),!1)):n?!0:(o(),!1)})}refinement(e,t){return this._refinement((s,i)=>e(s)?!0:(i.addIssue(typeof t=="function"?t(s,i):t),!1))}_refinement(e){return new fn({schema:this,typeName:dt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return On.create(this,this._def)}nullable(){return ya.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Gl.create(this)}promise(){return Cu.create(this,this._def)}or(e){return Qh.create([this,e],this._def)}and(e){return Zh.create(this,e,this._def)}transform(e){return new fn({...St(this._def),schema:this,typeName:dt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new tp({...St(this._def),innerType:this,defaultValue:t,typeName:dt.ZodDefault})}brand(){return new Dx({typeName:dt.ZodBranded,type:this,...St(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new sp({...St(this._def),innerType:this,catchValue:t,typeName:dt.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Px.create(this,e)}readonly(){return ip.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},g5=/^c[^\s-]{8,}$/i,f5=/^[0-9a-z]+$/,m5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,v5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,C5=/^[a-z0-9_-]{21}$/i,y5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,w5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,S5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,x5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",HC,b5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,E5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,R5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,T5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,D5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,P5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,P_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",A5=new RegExp(`^${P_}$`);function A_(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function F5(e){return new RegExp(`^${A_(e)}$`)}function F_(e){let t=`${P_}T${A_(e)}`;const s=[];return s.push(e.local?"Z?":"Z"),e.offset&&s.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${s.join("|")})`,new RegExp(`^${t}$`)}function N5(e,t){return!!((t==="v4"||!t)&&b5.test(e)||(t==="v6"||!t)&&R5.test(e))}function I5(e,t){if(!y5.test(e))return!1;try{const[s]=e.split("."),i=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),r=JSON.parse(atob(i));return!(typeof r!="object"||r===null||!r.typ||!r.alg||t&&r.alg!==t)}catch{return!1}}function _5(e,t){return!!((t==="v4"||!t)&&E5.test(e)||(t==="v6"||!t)&&T5.test(e))}var mu=class Dd extends Et{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Ke.string){const n=this._getOrReturnCtx(t);return Be(n,{code:_e.invalid_type,expected:Ke.string,received:n.parsedType}),gt}const i=new Ji;let r;for(const n of this._def.checks)if(n.kind==="min")t.data.length<n.value&&(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),i.dirty());else if(n.kind==="max")t.data.length>n.value&&(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),i.dirty());else if(n.kind==="length"){const o=t.data.length>n.value,a=t.data.length<n.value;(o||a)&&(r=this._getOrReturnCtx(t,r),o?Be(r,{code:_e.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):a&&Be(r,{code:_e.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),i.dirty())}else if(n.kind==="email")S5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"email",code:_e.invalid_string,message:n.message}),i.dirty());else if(n.kind==="emoji")HC||(HC=new RegExp(x5,"u")),HC.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"emoji",code:_e.invalid_string,message:n.message}),i.dirty());else if(n.kind==="uuid")v5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"uuid",code:_e.invalid_string,message:n.message}),i.dirty());else if(n.kind==="nanoid")C5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"nanoid",code:_e.invalid_string,message:n.message}),i.dirty());else if(n.kind==="cuid")g5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"cuid",code:_e.invalid_string,message:n.message}),i.dirty());else if(n.kind==="cuid2")f5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"cuid2",code:_e.invalid_string,message:n.message}),i.dirty());else if(n.kind==="ulid")m5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"ulid",code:_e.invalid_string,message:n.message}),i.dirty());else if(n.kind==="url")try{new URL(t.data)}catch{r=this._getOrReturnCtx(t,r),Be(r,{validation:"url",code:_e.invalid_string,message:n.message}),i.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"regex",code:_e.invalid_string,message:n.message}),i.dirty())):n.kind==="trim"?t.data=t.data.trim():n.kind==="includes"?t.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),i.dirty()):n.kind==="toLowerCase"?t.data=t.data.toLowerCase():n.kind==="toUpperCase"?t.data=t.data.toUpperCase():n.kind==="startsWith"?t.data.startsWith(n.value)||(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.invalid_string,validation:{startsWith:n.value},message:n.message}),i.dirty()):n.kind==="endsWith"?t.data.endsWith(n.value)||(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.invalid_string,validation:{endsWith:n.value},message:n.message}),i.dirty()):n.kind==="datetime"?F_(n).test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.invalid_string,validation:"datetime",message:n.message}),i.dirty()):n.kind==="date"?A5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.invalid_string,validation:"date",message:n.message}),i.dirty()):n.kind==="time"?F5(n).test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.invalid_string,validation:"time",message:n.message}),i.dirty()):n.kind==="duration"?w5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"duration",code:_e.invalid_string,message:n.message}),i.dirty()):n.kind==="ip"?N5(t.data,n.version)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"ip",code:_e.invalid_string,message:n.message}),i.dirty()):n.kind==="jwt"?I5(t.data,n.alg)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"jwt",code:_e.invalid_string,message:n.message}),i.dirty()):n.kind==="cidr"?_5(t.data,n.version)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"cidr",code:_e.invalid_string,message:n.message}),i.dirty()):n.kind==="base64"?D5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"base64",code:_e.invalid_string,message:n.message}),i.dirty()):n.kind==="base64url"?P5.test(t.data)||(r=this._getOrReturnCtx(t,r),Be(r,{validation:"base64url",code:_e.invalid_string,message:n.message}),i.dirty()):Gt.assertNever(n);return{status:i.value,value:t.data}}_regex(t,s,i){return this.refinement(r=>t.test(r),{validation:s,code:_e.invalid_string,...st.errToObj(i)})}_addCheck(t){return new Dd({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...st.errToObj(t)})}url(t){return this._addCheck({kind:"url",...st.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...st.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...st.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...st.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...st.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...st.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...st.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...st.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...st.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...st.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...st.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...st.errToObj(t)})}datetime(t){var s,i;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(s=t==null?void 0:t.offset)!==null&&s!==void 0?s:!1,local:(i=t==null?void 0:t.local)!==null&&i!==void 0?i:!1,...st.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...st.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...st.errToObj(t)})}regex(t,s){return this._addCheck({kind:"regex",regex:t,...st.errToObj(s)})}includes(t,s){return this._addCheck({kind:"includes",value:t,position:s==null?void 0:s.position,...st.errToObj(s==null?void 0:s.message)})}startsWith(t,s){return this._addCheck({kind:"startsWith",value:t,...st.errToObj(s)})}endsWith(t,s){return this._addCheck({kind:"endsWith",value:t,...st.errToObj(s)})}min(t,s){return this._addCheck({kind:"min",value:t,...st.errToObj(s)})}max(t,s){return this._addCheck({kind:"max",value:t,...st.errToObj(s)})}length(t,s){return this._addCheck({kind:"length",value:t,...st.errToObj(s)})}nonempty(t){return this.min(1,st.errToObj(t))}trim(){return new Dd({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Dd({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Dd({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxLength(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}};mu.create=e=>{var t;return new mu({checks:[],typeName:dt.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...St(e)})};function k5(e,t){const s=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,r=s>i?s:i,n=parseInt(e.toFixed(r).replace(".","")),o=parseInt(t.toFixed(r).replace(".",""));return n%o/Math.pow(10,r)}var zh=class Ow extends Et{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Ke.number){const n=this._getOrReturnCtx(t);return Be(n,{code:_e.invalid_type,expected:Ke.number,received:n.parsedType}),gt}let i;const r=new Ji;for(const n of this._def.checks)n.kind==="int"?Gt.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):n.kind==="min"?(n.inclusive?t.data<n.value:t.data<=n.value)&&(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?t.data>n.value:t.data>=n.value)&&(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="multipleOf"?k5(t.data,n.value)!==0&&(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):n.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.not_finite,message:n.message}),r.dirty()):Gt.assertNever(n);return{status:r.value,value:t.data}}gte(t,s){return this.setLimit("min",t,!0,st.toString(s))}gt(t,s){return this.setLimit("min",t,!1,st.toString(s))}lte(t,s){return this.setLimit("max",t,!0,st.toString(s))}lt(t,s){return this.setLimit("max",t,!1,st.toString(s))}setLimit(t,s,i,r){return new Ow({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:i,message:st.toString(r)}]})}_addCheck(t){return new Ow({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:st.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:st.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:st.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:st.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:st.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:st.toString(s)})}finite(t){return this._addCheck({kind:"finite",message:st.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:st.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:st.toString(t)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Gt.isInteger(t.value))}get isFinite(){let t=null,s=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(s===null||i.value>s)&&(s=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(s)&&Number.isFinite(t)}};zh.create=e=>new zh({checks:[],typeName:dt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...St(e)});var Uh=class Gw extends Et{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Ke.bigint)return this._getInvalidInput(t);let i;const r=new Ji;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?t.data<n.value:t.data<=n.value)&&(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?t.data>n.value:t.data>=n.value)&&(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="multipleOf"?t.data%n.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),Be(i,{code:_e.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):Gt.assertNever(n);return{status:r.value,value:t.data}}_getInvalidInput(t){const s=this._getOrReturnCtx(t);return Be(s,{code:_e.invalid_type,expected:Ke.bigint,received:s.parsedType}),gt}gte(t,s){return this.setLimit("min",t,!0,st.toString(s))}gt(t,s){return this.setLimit("min",t,!1,st.toString(s))}lte(t,s){return this.setLimit("max",t,!0,st.toString(s))}lt(t,s){return this.setLimit("max",t,!1,st.toString(s))}setLimit(t,s,i,r){return new Gw({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:i,message:st.toString(r)}]})}_addCheck(t){return new Gw({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:st.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:st.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:st.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:st.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:st.toString(s)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}};Uh.create=e=>{var t;return new Uh({checks:[],typeName:dt.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...St(e)})};var $h=class extends Et{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ke.boolean){const s=this._getOrReturnCtx(e);return Be(s,{code:_e.invalid_type,expected:Ke.boolean,received:s.parsedType}),gt}return Di(e.data)}};$h.create=e=>new $h({typeName:dt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...St(e)});var Kh=class N_ extends Et{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Ke.date){const n=this._getOrReturnCtx(t);return Be(n,{code:_e.invalid_type,expected:Ke.date,received:n.parsedType}),gt}if(isNaN(t.data.getTime())){const n=this._getOrReturnCtx(t);return Be(n,{code:_e.invalid_date}),gt}const i=new Ji;let r;for(const n of this._def.checks)n.kind==="min"?t.data.getTime()<n.value&&(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),i.dirty()):n.kind==="max"?t.data.getTime()>n.value&&(r=this._getOrReturnCtx(t,r),Be(r,{code:_e.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),i.dirty()):Gt.assertNever(n);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new N_({...this._def,checks:[...this._def.checks,t]})}min(t,s){return this._addCheck({kind:"min",value:t.getTime(),message:st.toString(s)})}max(t,s){return this._addCheck({kind:"max",value:t.getTime(),message:st.toString(s)})}get minDate(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t!=null?new Date(t):null}};Kh.create=e=>new Kh({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:dt.ZodDate,...St(e)});var nm=class extends Et{_parse(e){if(this._getType(e)!==Ke.symbol){const s=this._getOrReturnCtx(e);return Be(s,{code:_e.invalid_type,expected:Ke.symbol,received:s.parsedType}),gt}return Di(e.data)}};nm.create=e=>new nm({typeName:dt.ZodSymbol,...St(e)});var Yh=class extends Et{_parse(e){if(this._getType(e)!==Ke.undefined){const s=this._getOrReturnCtx(e);return Be(s,{code:_e.invalid_type,expected:Ke.undefined,received:s.parsedType}),gt}return Di(e.data)}};Yh.create=e=>new Yh({typeName:dt.ZodUndefined,...St(e)});var qh=class extends Et{_parse(e){if(this._getType(e)!==Ke.null){const s=this._getOrReturnCtx(e);return Be(s,{code:_e.invalid_type,expected:Ke.null,received:s.parsedType}),gt}return Di(e.data)}};qh.create=e=>new qh({typeName:dt.ZodNull,...St(e)});var vu=class extends Et{constructor(){super(...arguments),this._any=!0}_parse(e){return Di(e.data)}};vu.create=e=>new vu({typeName:dt.ZodAny,...St(e)});var wl=class extends Et{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Di(e.data)}};wl.create=e=>new wl({typeName:dt.ZodUnknown,...St(e)});var fo=class extends Et{_parse(e){const t=this._getOrReturnCtx(e);return Be(t,{code:_e.invalid_type,expected:Ke.never,received:t.parsedType}),gt}};fo.create=e=>new fo({typeName:dt.ZodNever,...St(e)});var om=class extends Et{_parse(e){if(this._getType(e)!==Ke.undefined){const s=this._getOrReturnCtx(e);return Be(s,{code:_e.invalid_type,expected:Ke.void,received:s.parsedType}),gt}return Di(e.data)}};om.create=e=>new om({typeName:dt.ZodVoid,...St(e)});var Gl=class Ug extends Et{_parse(t){const{ctx:s,status:i}=this._processInputParams(t),r=this._def;if(s.parsedType!==Ke.array)return Be(s,{code:_e.invalid_type,expected:Ke.array,received:s.parsedType}),gt;if(r.exactLength!==null){const o=s.data.length>r.exactLength.value,a=s.data.length<r.exactLength.value;(o||a)&&(Be(s,{code:o?_e.too_big:_e.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&s.data.length<r.minLength.value&&(Be(s,{code:_e.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&s.data.length>r.maxLength.value&&(Be(s,{code:_e.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),s.common.async)return Promise.all([...s.data].map((o,a)=>r.type._parseAsync(new Wn(s,o,s.path,a)))).then(o=>Ji.mergeArray(i,o));const n=[...s.data].map((o,a)=>r.type._parseSync(new Wn(s,o,s.path,a)));return Ji.mergeArray(i,n)}get element(){return this._def.type}min(t,s){return new Ug({...this._def,minLength:{value:t,message:st.toString(s)}})}max(t,s){return new Ug({...this._def,maxLength:{value:t,message:st.toString(s)}})}length(t,s){return new Ug({...this._def,exactLength:{value:t,message:st.toString(s)}})}nonempty(t){return this.min(1,t)}};Gl.create=(e,t)=>new Gl({type:e,minLength:null,maxLength:null,exactLength:null,typeName:dt.ZodArray,...St(t)});function cc(e){if(e instanceof Vr){const t={};for(const s in e.shape){const i=e.shape[s];t[s]=On.create(cc(i))}return new Vr({...e._def,shape:()=>t})}else return e instanceof Gl?new Gl({...e._def,type:cc(e.element)}):e instanceof On?On.create(cc(e.unwrap())):e instanceof ya?ya.create(cc(e.unwrap())):e instanceof Ca?Ca.create(e.items.map(t=>cc(t))):e}var Vr=class Yr extends Et{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),s=Gt.objectKeys(t);return this._cached={shape:t,keys:s}}_parse(t){if(this._getType(t)!==Ke.object){const u=this._getOrReturnCtx(t);return Be(u,{code:_e.invalid_type,expected:Ke.object,received:u.parsedType}),gt}const{status:i,ctx:r}=this._processInputParams(t),{shape:n,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof fo&&this._def.unknownKeys==="strip"))for(const u in r.data)o.includes(u)||a.push(u);const l=[];for(const u of o){const h=n[u],p=r.data[u];l.push({key:{status:"valid",value:u},value:h._parse(new Wn(r,p,r.path,u)),alwaysSet:u in r.data})}if(this._def.catchall instanceof fo){const u=this._def.unknownKeys;if(u==="passthrough")for(const h of a)l.push({key:{status:"valid",value:h},value:{status:"valid",value:r.data[h]}});else if(u==="strict")a.length>0&&(Be(r,{code:_e.unrecognized_keys,keys:a}),i.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const h of a){const p=r.data[h];l.push({key:{status:"valid",value:h},value:u._parse(new Wn(r,p,r.path,h)),alwaysSet:h in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const u=[];for(const h of l){const p=await h.key,g=await h.value;u.push({key:p,value:g,alwaysSet:h.alwaysSet})}return u}).then(u=>Ji.mergeObjectSync(i,u)):Ji.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(t){return st.errToObj,new Yr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(s,i)=>{var r,n,o,a;const l=(o=(n=(r=this._def).errorMap)===null||n===void 0?void 0:n.call(r,s,i).message)!==null&&o!==void 0?o:i.defaultError;return s.code==="unrecognized_keys"?{message:(a=st.errToObj(t).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Yr({...this._def,unknownKeys:"strip"})}passthrough(){return new Yr({...this._def,unknownKeys:"passthrough"})}extend(t){return new Yr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Yr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:dt.ZodObject})}setKey(t,s){return this.augment({[t]:s})}catchall(t){return new Yr({...this._def,catchall:t})}pick(t){const s={};return Gt.objectKeys(t).forEach(i=>{t[i]&&this.shape[i]&&(s[i]=this.shape[i])}),new Yr({...this._def,shape:()=>s})}omit(t){const s={};return Gt.objectKeys(this.shape).forEach(i=>{t[i]||(s[i]=this.shape[i])}),new Yr({...this._def,shape:()=>s})}deepPartial(){return cc(this)}partial(t){const s={};return Gt.objectKeys(this.shape).forEach(i=>{const r=this.shape[i];t&&!t[i]?s[i]=r:s[i]=r.optional()}),new Yr({...this._def,shape:()=>s})}required(t){const s={};return Gt.objectKeys(this.shape).forEach(i=>{if(t&&!t[i])s[i]=this.shape[i];else{let n=this.shape[i];for(;n instanceof On;)n=n._def.innerType;s[i]=n}}),new Yr({...this._def,shape:()=>s})}keyof(){return O_(Gt.objectKeys(this.shape))}};Vr.create=(e,t)=>new Vr({shape:()=>e,unknownKeys:"strip",catchall:fo.create(),typeName:dt.ZodObject,...St(t)});Vr.strictCreate=(e,t)=>new Vr({shape:()=>e,unknownKeys:"strict",catchall:fo.create(),typeName:dt.ZodObject,...St(t)});Vr.lazycreate=(e,t)=>new Vr({shape:e,unknownKeys:"strip",catchall:fo.create(),typeName:dt.ZodObject,...St(t)});var Qh=class extends Et{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function i(r){for(const o of r)if(o.result.status==="valid")return o.result;for(const o of r)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const n=r.map(o=>new dn(o.ctx.common.issues));return Be(t,{code:_e.invalid_union,unionErrors:n}),gt}if(t.common.async)return Promise.all(s.map(async r=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await r._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(i);{let r;const n=[];for(const a of s){const l={...t,common:{...t.common,issues:[]},parent:null},u=a._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!r&&(r={result:u,ctx:l}),l.common.issues.length&&n.push(l.common.issues)}if(r)return t.common.issues.push(...r.ctx.common.issues),r.result;const o=n.map(a=>new dn(a));return Be(t,{code:_e.invalid_union,unionErrors:o}),gt}}get options(){return this._def.options}};Qh.create=(e,t)=>new Qh({options:e,typeName:dt.ZodUnion,...St(t)});var qn=e=>e instanceof Jh?qn(e.schema):e instanceof fn?qn(e.innerType()):e instanceof Xh?[e.value]:e instanceof Ip?e.options:e instanceof ep?Gt.objectValues(e.enum):e instanceof tp?qn(e._def.innerType):e instanceof Yh?[void 0]:e instanceof qh?[null]:e instanceof On?[void 0,...qn(e.unwrap())]:e instanceof ya?[null,...qn(e.unwrap())]:e instanceof Dx||e instanceof ip?qn(e.unwrap()):e instanceof sp?qn(e._def.innerType):[],I_=class __ extends Et{_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==Ke.object)return Be(s,{code:_e.invalid_type,expected:Ke.object,received:s.parsedType}),gt;const i=this.discriminator,r=s.data[i],n=this.optionsMap.get(r);return n?s.common.async?n._parseAsync({data:s.data,path:s.path,parent:s}):n._parseSync({data:s.data,path:s.path,parent:s}):(Be(s,{code:_e.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),gt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,s,i){const r=new Map;for(const n of s){const o=qn(n.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const a of o){if(r.has(a))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(a)}`);r.set(a,n)}}return new __({typeName:dt.ZodDiscriminatedUnion,discriminator:t,options:s,optionsMap:r,...St(i)})}};function Vw(e,t){const s=Xn(e),i=Xn(t);if(e===t)return{valid:!0,data:e};if(s===Ke.object&&i===Ke.object){const r=Gt.objectKeys(t),n=Gt.objectKeys(e).filter(a=>r.indexOf(a)!==-1),o={...e,...t};for(const a of n){const l=Vw(e[a],t[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(s===Ke.array&&i===Ke.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const o=e[n],a=t[n],l=Vw(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return s===Ke.date&&i===Ke.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var Zh=class extends Et{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=(r,n)=>{if(Mw(r)||Mw(n))return gt;const o=Vw(r.value,n.value);return o.valid?((Lw(r)||Lw(n))&&t.dirty(),{status:t.value,value:o.data}):(Be(s,{code:_e.invalid_intersection_types}),gt)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,n])=>i(r,n)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};Zh.create=(e,t,s)=>new Zh({left:e,right:t,typeName:dt.ZodIntersection,...St(s)});var Ca=class k_ extends Et{_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.parsedType!==Ke.array)return Be(i,{code:_e.invalid_type,expected:Ke.array,received:i.parsedType}),gt;if(i.data.length<this._def.items.length)return Be(i,{code:_e.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),gt;!this._def.rest&&i.data.length>this._def.items.length&&(Be(i,{code:_e.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const n=[...i.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Wn(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(n).then(o=>Ji.mergeArray(s,o)):Ji.mergeArray(s,n)}get items(){return this._def.items}rest(t){return new k_({...this._def,rest:t})}};Ca.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ca({items:e,typeName:dt.ZodTuple,rest:null,...St(t)})};var M_=class Bw extends Et{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.parsedType!==Ke.object)return Be(i,{code:_e.invalid_type,expected:Ke.object,received:i.parsedType}),gt;const r=[],n=this._def.keyType,o=this._def.valueType;for(const a in i.data)r.push({key:n._parse(new Wn(i,a,i.path,a)),value:o._parse(new Wn(i,i.data[a],i.path,a)),alwaysSet:a in i.data});return i.common.async?Ji.mergeObjectAsync(s,r):Ji.mergeObjectSync(s,r)}get element(){return this._def.valueType}static create(t,s,i){return s instanceof Et?new Bw({keyType:t,valueType:s,typeName:dt.ZodRecord,...St(i)}):new Bw({keyType:mu.create(),valueType:t,typeName:dt.ZodRecord,...St(s)})}},am=class extends Et{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Ke.map)return Be(s,{code:_e.invalid_type,expected:Ke.map,received:s.parsedType}),gt;const i=this._def.keyType,r=this._def.valueType,n=[...s.data.entries()].map(([o,a],l)=>({key:i._parse(new Wn(s,o,s.path,[l,"key"])),value:r._parse(new Wn(s,a,s.path,[l,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const a of n){const l=await a.key,u=await a.value;if(l.status==="aborted"||u.status==="aborted")return gt;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const a of n){const l=a.key,u=a.value;if(l.status==="aborted"||u.status==="aborted")return gt;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}}}};am.create=(e,t,s)=>new am({valueType:t,keyType:e,typeName:dt.ZodMap,...St(s)});var lm=class Hw extends Et{_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.parsedType!==Ke.set)return Be(i,{code:_e.invalid_type,expected:Ke.set,received:i.parsedType}),gt;const r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(Be(i,{code:_e.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),s.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(Be(i,{code:_e.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),s.dirty());const n=this._def.valueType;function o(l){const u=new Set;for(const h of l){if(h.status==="aborted")return gt;h.status==="dirty"&&s.dirty(),u.add(h.value)}return{status:s.value,value:u}}const a=[...i.data.values()].map((l,u)=>n._parse(new Wn(i,l,i.path,u)));return i.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(t,s){return new Hw({...this._def,minSize:{value:t,message:st.toString(s)}})}max(t,s){return new Hw({...this._def,maxSize:{value:t,message:st.toString(s)}})}size(t,s){return this.min(t,s).max(t,s)}nonempty(t){return this.min(1,t)}};lm.create=(e,t)=>new lm({valueType:e,minSize:null,maxSize:null,typeName:dt.ZodSet,...St(t)});var L_=class $g extends Et{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==Ke.function)return Be(s,{code:_e.invalid_type,expected:Ke.function,received:s.parsedType}),gt;function i(a,l){return im({data:a,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,sm(),fu].filter(u=>!!u),issueData:{code:_e.invalid_arguments,argumentsError:l}})}function r(a,l){return im({data:a,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,sm(),fu].filter(u=>!!u),issueData:{code:_e.invalid_return_type,returnTypeError:l}})}const n={errorMap:s.common.contextualErrorMap},o=s.data;if(this._def.returns instanceof Cu){const a=this;return Di(async function(...l){const u=new dn([]),h=await a._def.args.parseAsync(l,n).catch(m=>{throw u.addIssue(i(l,m)),u}),p=await Reflect.apply(o,this,h);return await a._def.returns._def.type.parseAsync(p,n).catch(m=>{throw u.addIssue(r(p,m)),u})})}else{const a=this;return Di(function(...l){const u=a._def.args.safeParse(l,n);if(!u.success)throw new dn([i(l,u.error)]);const h=Reflect.apply(o,this,u.data),p=a._def.returns.safeParse(h,n);if(!p.success)throw new dn([r(h,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new $g({...this._def,args:Ca.create(t).rest(wl.create())})}returns(t){return new $g({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,s,i){return new $g({args:t||Ca.create([]).rest(wl.create()),returns:s||wl.create(),typeName:dt.ZodFunction,...St(i)})}},Jh=class extends Et{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Jh.create=(e,t)=>new Jh({getter:e,typeName:dt.ZodLazy,...St(t)});var Xh=class extends Et{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Be(t,{received:t.data,code:_e.invalid_literal,expected:this._def.value}),gt}return{status:"valid",value:e.data}}get value(){return this._def.value}};Xh.create=(e,t)=>new Xh({value:e,typeName:dt.ZodLiteral,...St(t)});function O_(e,t){return new Ip({values:e,typeName:dt.ZodEnum,...St(t)})}var Ip=class jw extends Et{constructor(){super(...arguments),Rd.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const s=this._getOrReturnCtx(t),i=this._def.values;return Be(s,{expected:Gt.joinValues(i),received:s.parsedType,code:_e.invalid_type}),gt}if(rm(this,Rd)||D_(this,Rd,new Set(this._def.values)),!rm(this,Rd).has(t.data)){const s=this._getOrReturnCtx(t),i=this._def.values;return Be(s,{received:s.data,code:_e.invalid_enum_value,options:i}),gt}return Di(t.data)}get options(){return this._def.values}get enum(){const t={};for(const s of this._def.values)t[s]=s;return t}get Values(){const t={};for(const s of this._def.values)t[s]=s;return t}get Enum(){const t={};for(const s of this._def.values)t[s]=s;return t}extract(t,s=this._def){return jw.create(t,{...this._def,...s})}exclude(t,s=this._def){return jw.create(this.options.filter(i=>!t.includes(i)),{...this._def,...s})}};Rd=new WeakMap;Ip.create=O_;var ep=class extends Et{constructor(){super(...arguments),Td.set(this,void 0)}_parse(e){const t=Gt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Ke.string&&s.parsedType!==Ke.number){const i=Gt.objectValues(t);return Be(s,{expected:Gt.joinValues(i),received:s.parsedType,code:_e.invalid_type}),gt}if(rm(this,Td)||D_(this,Td,new Set(Gt.getValidEnumValues(this._def.values))),!rm(this,Td).has(e.data)){const i=Gt.objectValues(t);return Be(s,{received:s.data,code:_e.invalid_enum_value,options:i}),gt}return Di(e.data)}get enum(){return this._def.values}};Td=new WeakMap;ep.create=(e,t)=>new ep({values:e,typeName:dt.ZodNativeEnum,...St(t)});var Cu=class extends Et{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ke.promise&&t.common.async===!1)return Be(t,{code:_e.invalid_type,expected:Ke.promise,received:t.parsedType}),gt;const s=t.parsedType===Ke.promise?t.data:Promise.resolve(t.data);return Di(s.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}};Cu.create=(e,t)=>new Cu({type:e,typeName:dt.ZodPromise,...St(t)});var fn=class extends Et{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===dt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:n=>{Be(s,n),n.fatal?t.abort():t.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),i.type==="preprocess"){const n=i.transform(s.data,r);if(s.common.async)return Promise.resolve(n).then(async o=>{if(t.value==="aborted")return gt;const a=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return a.status==="aborted"?gt:a.status==="dirty"||t.value==="dirty"?Ec(a.value):a});{if(t.value==="aborted")return gt;const o=this._def.schema._parseSync({data:n,path:s.path,parent:s});return o.status==="aborted"?gt:o.status==="dirty"||t.value==="dirty"?Ec(o.value):o}}if(i.type==="refinement"){const n=o=>{const a=i.refinement(o,r);if(s.common.async)return Promise.resolve(a);if(a instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?gt:(o.status==="dirty"&&t.dirty(),n(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?gt:(o.status==="dirty"&&t.dirty(),n(o.value).then(()=>({status:t.value,value:o.value}))))}if(i.type==="transform")if(s.common.async===!1){const n=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Ol(n))return n;const o=i.transform(n.value,r);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(n=>Ol(n)?Promise.resolve(i.transform(n.value,r)).then(o=>({status:t.value,value:o})):n);Gt.assertNever(i)}};fn.create=(e,t,s)=>new fn({schema:e,typeName:dt.ZodEffects,effect:t,...St(s)});fn.createWithPreprocess=(e,t,s)=>new fn({schema:t,effect:{type:"preprocess",transform:e},typeName:dt.ZodEffects,...St(s)});var On=class extends Et{_parse(e){return this._getType(e)===Ke.undefined?Di(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};On.create=(e,t)=>new On({innerType:e,typeName:dt.ZodOptional,...St(t)});var ya=class extends Et{_parse(e){return this._getType(e)===Ke.null?Di(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ya.create=(e,t)=>new ya({innerType:e,typeName:dt.ZodNullable,...St(t)});var tp=class extends Et{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===Ke.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};tp.create=(e,t)=>new tp({innerType:e,typeName:dt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...St(t)});var sp=class extends Et{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Wh(i)?i.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new dn(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new dn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};sp.create=(e,t)=>new sp({innerType:e,typeName:dt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...St(t)});var cm=class extends Et{_parse(e){if(this._getType(e)!==Ke.nan){const s=this._getOrReturnCtx(e);return Be(s,{code:_e.invalid_type,expected:Ke.nan,received:s.parsedType}),gt}return{status:"valid",value:e.data}}};cm.create=e=>new cm({typeName:dt.ZodNaN,...St(e)});var M5=Symbol("zod_brand"),Dx=class extends Et{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}},Px=class G_ extends Et{_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const n=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?gt:n.status==="dirty"?(s.dirty(),Ec(n.value)):this._def.out._parseAsync({data:n.value,path:i.path,parent:i})})();{const r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?gt:r.status==="dirty"?(s.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(t,s){return new G_({in:t,out:s,typeName:dt.ZodPipeline})}},ip=class extends Et{_parse(e){const t=this._def.innerType._parse(e),s=i=>(Ol(i)&&(i.value=Object.freeze(i.value)),i);return Wh(t)?t.then(i=>s(i)):s(t)}unwrap(){return this._def.innerType}};ip.create=(e,t)=>new ip({innerType:e,typeName:dt.ZodReadonly,...St(t)});function fT(e,t){const s=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof s=="string"?{message:s}:s}function V_(e,t={},s){return e?vu.create().superRefine((i,r)=>{var n,o;const a=e(i);if(a instanceof Promise)return a.then(l=>{var u,h;if(!l){const p=fT(t,i),g=(h=(u=p.fatal)!==null&&u!==void 0?u:s)!==null&&h!==void 0?h:!0;r.addIssue({code:"custom",...p,fatal:g})}});if(!a){const l=fT(t,i),u=(o=(n=l.fatal)!==null&&n!==void 0?n:s)!==null&&o!==void 0?o:!0;r.addIssue({code:"custom",...l,fatal:u})}}):vu.create()}var L5={object:Vr.lazycreate},dt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(dt||(dt={}));var O5=(e,t={message:`Input not instance of ${e.name}`})=>V_(s=>s instanceof e,t),B_=mu.create,H_=zh.create,G5=cm.create,V5=Uh.create,j_=$h.create,B5=Kh.create,H5=nm.create,j5=Yh.create,W5=qh.create,z5=vu.create,U5=wl.create,$5=fo.create,K5=om.create,Y5=Gl.create,q5=Vr.create,Q5=Vr.strictCreate,Z5=Qh.create,J5=I_.create,X5=Zh.create,e$=Ca.create,t$=M_.create,s$=am.create,i$=lm.create,r$=L_.create,n$=Jh.create,o$=Xh.create,a$=Ip.create,l$=ep.create,c$=Cu.create,mT=fn.create,u$=On.create,d$=ya.create,h$=fn.createWithPreprocess,p$=Px.create,g$=()=>B_().optional(),f$=()=>H_().optional(),m$=()=>j_().optional(),v$={string:e=>mu.create({...e,coerce:!0}),number:e=>zh.create({...e,coerce:!0}),boolean:e=>$h.create({...e,coerce:!0}),bigint:e=>Uh.create({...e,coerce:!0}),date:e=>Kh.create({...e,coerce:!0})},C$=gt,Qs=Object.freeze({__proto__:null,defaultErrorMap:fu,setErrorMap:h5,getErrorMap:sm,makeIssue:im,EMPTY_PATH:p5,addIssueToContext:Be,ParseStatus:Ji,INVALID:gt,DIRTY:Ec,OK:Di,isAborted:Mw,isDirty:Lw,isValid:Ol,isAsync:Wh,get util(){return Gt},get objectUtil(){return kw},ZodParsedType:Ke,getParsedType:Xn,ZodType:Et,datetimeRegex:F_,ZodString:mu,ZodNumber:zh,ZodBigInt:Uh,ZodBoolean:$h,ZodDate:Kh,ZodSymbol:nm,ZodUndefined:Yh,ZodNull:qh,ZodAny:vu,ZodUnknown:wl,ZodNever:fo,ZodVoid:om,ZodArray:Gl,ZodObject:Vr,ZodUnion:Qh,ZodDiscriminatedUnion:I_,ZodIntersection:Zh,ZodTuple:Ca,ZodRecord:M_,ZodMap:am,ZodSet:lm,ZodFunction:L_,ZodLazy:Jh,ZodLiteral:Xh,ZodEnum:Ip,ZodNativeEnum:ep,ZodPromise:Cu,ZodEffects:fn,ZodTransformer:fn,ZodOptional:On,ZodNullable:ya,ZodDefault:tp,ZodCatch:sp,ZodNaN:cm,BRAND:M5,ZodBranded:Dx,ZodPipeline:Px,ZodReadonly:ip,custom:V_,Schema:Et,ZodSchema:Et,late:L5,get ZodFirstPartyTypeKind(){return dt},coerce:v$,any:z5,array:Y5,bigint:V5,boolean:j_,date:B5,discriminatedUnion:J5,effect:mT,enum:a$,function:r$,instanceof:O5,intersection:X5,lazy:n$,literal:o$,map:s$,nan:G5,nativeEnum:l$,never:$5,null:W5,nullable:d$,number:H_,object:q5,oboolean:m$,onumber:f$,optional:u$,ostring:g$,pipeline:p$,preprocess:h$,promise:c$,record:t$,set:i$,strictObject:Q5,string:B_,symbol:H5,transformer:mT,tuple:e$,undefined:j5,union:Z5,unknown:U5,void:K5,NEVER:C$,ZodIssueCode:_e,quotelessJson:d5,ZodError:dn}),vT={name:"@imgly/background-removal",version:"1.7.0"},y$=Qs.object({publicPath:Qs.string().optional().describe("The public path to the wasm files and the onnx model.").default("https://staticimgly.com/@imgly/background-removal-data/${PACKAGE_VERSION}/dist/").transform(e=>e.replace("${PACKAGE_NAME}",vT.name).replace("${PACKAGE_VERSION}",vT.version)),debug:Qs.boolean().default(!1).describe("Whether to enable debug logging."),rescale:Qs.boolean().default(!0).describe("Whether to rescale the image."),device:Qs.enum(["cpu","gpu"]).default("cpu").describe("The device to run the model on."),proxyToWorker:Qs.boolean().default(!1).describe("Whether to proxy inference to a web worker."),fetchArgs:Qs.any().default({}).describe("Arguments to pass to fetch when loading the model."),progress:Qs.function().args(Qs.string(),Qs.number(),Qs.number()).returns(Qs.void()).describe("Progress callback.").optional(),model:Qs.preprocess(e=>{switch(e){case"large":return"isnet";case"small":return"isnet_quint8";case"medium":return"isnet_fp16";default:return e}},Qs.enum(["isnet","isnet_fp16","isnet_quint8"])).default("medium"),output:Qs.object({format:Qs.enum(["image/png","image/jpeg","image/webp","image/x-rgba8","image/x-alpha8"]).default("image/png"),quality:Qs.number().default(.8)}).default({})}).default({}).transform(e=>(e.debug&&console.log("Config:",e),e.debug&&!e.progress&&(e.progress=e.progress??((t,s,i)=>{console.debug(`Downloading ${t}: ${s} of ${i}`)}),crossOriginIsolated||e.debug&&console.debug("Cross-Origin-Isolated is not enabled. Performance will be degraded. Please see  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer.")),e));function w$(e){return y$.parse(e??{})}var S$=yv(wv());async function x$(e){e.debug&&console.debug("Loading model...",e.model);const t=e.model,i=await(await x_(`/models/${t}`,e)).arrayBuffer();return await c5(i,e)}async function b$(e){e=w$(e);const t=await x$(e);return{config:e,session:{base:t}}}async function E$(e,t,s){const[r,n,o]=e.shape,a=!1;let l=hT(e,1024,1024,a);const u=r5(l);let h=await u5(s.base,[["input",u]],["output"],t),p=(0,S$.default)(h[0].data,[1024,1024,1]),g=o5(p);return t.rescale?(g=hT(g,n,r,a),[g,e]):[g,l]}var R$=ZU(b$,e=>JSON.stringify(e));async function T$(e,t){var g,m,C,y;const{config:s,session:i}=await R$(t);s.progress&&s.progress("compute:decode",0,4);const r=await n5(e,s);(g=s.progress)==null||g.call(s,"compute:inference",1,4);const[n,o]=await E$(r,s,i);(m=s.progress)==null||m.call(s,"compute:mask",2,4);const a=o,[l,u]=a.shape,h=l*u;for(let R=0;R<h;R+=1)a.data[4*R+3]=n.data[R];(C=s.progress)==null||C.call(s,"compute:encode",3,4);const p=await XU(a,s.output.quality,s.output.format);return(y=s.progress)==null||y.call(s,"compute:encode",4,4),p}/*! Bundled license information:

is-buffer/index.js:
  (*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/const W_="https://rembg-service-128150759188.us-central1.run.app";async function D$(e){try{const t=await fetch(`${W_}/remove-background`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:e})});if(!t.ok)throw new Error(`Cloud service error: ${t.status}`);const s=await t.json();if(!s.success)throw new Error(s.error||"Unknown error");const i=s.imageData.split(",")[1],r=atob(i),n=new Uint8Array(r.length);for(let l=0;l<r.length;l++)n[l]=r.charCodeAt(l);const o=new Blob([n],{type:"image/png"});return{success:!0,processedUrl:URL.createObjectURL(o),blob:o,method:"cloud"}}catch(t){return console.error("Cloud background removal error:",t),{success:!1,error:t instanceof Error?t.message:String(t),method:"cloud"}}}async function P$(e,t){try{const s=await fetch(e);if(!s.ok)throw new Error(`Failed to fetch image: ${s.status}`);const i=await s.blob(),r=await T$(i,{progress:(o,a,l)=>{t&&l>0&&t(Math.round(a/l*100))}});return{success:!0,processedUrl:URL.createObjectURL(r),blob:r,method:"browser"}}catch(s){return console.error("Browser background removal error:",s),{success:!1,error:s instanceof Error?s.message:String(s),method:"browser"}}}async function z_(e,t,s){{const i=await D$(e);if(i.success)return i;console.warn("Cloud processing failed, falling back to browser:",i.error)}return P$(e,t)}async function A$(){try{return(await(await fetch(W_,{method:"GET"})).json()).status==="healthy"}catch{return!1}}function F$(e){return new Promise((t,s)=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.onerror=s,i.readAsDataURL(e)})}function Va(e,t,s){if(t===null&&s===null)return{field:e,ours:t,theirs:s,difference:null,theirsIsBetter:!1,matches:!0};if(t===null&&s!==null)return{field:e,ours:t,theirs:s,difference:null,theirsIsBetter:!0,matches:!1};if(t!==null&&s===null)return{field:e,ours:t,theirs:s,difference:null,theirsIsBetter:!1,matches:!1};const i=t!==0?Math.abs((s-t)/t*100):s!==0?100:0,r=i<10;return{field:e,ours:t,theirs:s,difference:Math.round(i),theirsIsBetter:!1,matches:r}}function N$(e){const t=["calories","protein","carbs","fat","fiber","sugar","sodium"],s=e.filter(r=>t.includes(r.field));if(s.length===0)return 0;const i=s.filter(r=>r.matches).length;return Math.round(i/s.length*100)}const I$=({onClose:e,onImport:t,selectedFoods:s=[]})=>{const[i,r]=b.useState(""),[n,o]=b.useState(!1),[a,l]=b.useState(null),[u,h]=b.useState(!1),[p,g]=b.useState([]),[m,C]=b.useState(s.length>0),[y,R]=b.useState(0),[x,S]=b.useState(null);b.useEffect(()=>{s.length>0&&T()},[]);const T=async()=>{const E=s.filter(J=>J.barcode);if(E.length===0){g(s.map(J=>({food:J,offResult:null,offTransformed:null,isLoading:!1,error:"No barcode",comparison:[],hasImage:!1,hasBetterImage:!1,nutritionMatches:!1,nutritionScore:0,isApplying:!1,applied:"none",isCleaningImage:!1,cleaningProgress:0,cleanedImageUrl:null,cleanedImageBlob:null})));return}g(s.map(J=>({food:J,offResult:null,offTransformed:null,isLoading:!!J.barcode,error:J.barcode?void 0:"No barcode",comparison:[],hasImage:!1,hasBetterImage:!1,nutritionMatches:!1,nutritionScore:0,isApplying:!1,applied:"none",isCleaningImage:!1,cleaningProgress:0,cleanedImageUrl:null,cleanedImageBlob:null})));let F=0;for(const J of s)if(J.barcode){try{const Y=await HR(J.barcode,"UK");if(Y.product){const fe=_C(Y.product),me=[Va("calories",J.calories,fe.calories),Va("protein",J.protein,fe.protein),Va("carbs",J.carbs,fe.carbs),Va("fat",J.fat,fe.fat),Va("fiber",J.fiber,fe.fiber),Va("sugar",J.sugar,fe.sugar),Va("sodium",J.sodium,fe.sodium)],pe=N$(me),ye=!!Y.bestImageUrl,Ae=ye&&(!J.imageUrl||J.imageUrl.includes("placeholder"));g(te=>te.map(ce=>ce.food._id===J._id?{...ce,offResult:Y,offTransformed:fe,isLoading:!1,comparison:me,hasImage:ye,hasBetterImage:Ae,nutritionMatches:pe>=70,nutritionScore:pe}:ce))}else g(fe=>fe.map(me=>me.food._id===J._id?{...me,offResult:Y,isLoading:!1,error:"Not found in OFF"}:me))}catch(Y){g(fe=>fe.map(me=>me.food._id===J._id?{...me,isLoading:!1,error:String(Y)}:me))}F++,R(Math.round(F/E.length*100))}},I=async E=>{var F;if((F=E.offResult)!=null&&F.bestImageUrl){g(J=>J.map(Y=>Y.food._id===E.food._id?{...Y,isApplying:!0}:Y));try{await Ed(E.food,{imageUrl:E.offResult.bestImageUrl}),g(J=>J.map(Y=>Y.food._id===E.food._id?{...Y,isApplying:!1,applied:"image"}:Y))}catch(J){console.error("Failed to apply image:",J),alert(`Failed to apply image: ${J}`),g(Y=>Y.map(fe=>fe.food._id===E.food._id?{...fe,isApplying:!1}:fe))}}},V=async E=>{if(E.offTransformed){g(F=>F.map(J=>J.food._id===E.food._id?{...J,isApplying:!0}:J));try{await Ed(E.food,{calories:E.offTransformed.calories,protein:E.offTransformed.protein,carbs:E.offTransformed.carbs,fat:E.offTransformed.fat,saturatedFat:E.offTransformed.saturatedFat,fiber:E.offTransformed.fiber,sugar:E.offTransformed.sugar,sodium:E.offTransformed.sodium,salt:E.offTransformed.salt}),g(F=>F.map(J=>J.food._id===E.food._id?{...J,isApplying:!1,applied:"nutrition"}:J))}catch(F){console.error("Failed to apply nutrition:",F),alert(`Failed to apply nutrition: ${F}`),g(J=>J.map(Y=>Y.food._id===E.food._id?{...Y,isApplying:!1}:Y))}}},j=async E=>{if(!(!E.offTransformed||!E.offResult)){g(F=>F.map(J=>J.food._id===E.food._id?{...J,isApplying:!0}:J));try{await Ed(E.food,{imageUrl:E.offResult.bestImageUrl||E.food.imageUrl,calories:E.offTransformed.calories,protein:E.offTransformed.protein,carbs:E.offTransformed.carbs,fat:E.offTransformed.fat,saturatedFat:E.offTransformed.saturatedFat,fiber:E.offTransformed.fiber,sugar:E.offTransformed.sugar,sodium:E.offTransformed.sodium,salt:E.offTransformed.salt,ingredientsText:E.offTransformed.ingredientsText||E.food.ingredientsText}),g(F=>F.map(J=>J.food._id===E.food._id?{...J,isApplying:!1,applied:"all"}:J))}catch(F){console.error("Failed to apply all:",F),alert(`Failed to apply changes: ${F}`),g(J=>J.map(Y=>Y.food._id===E.food._id?{...Y,isApplying:!1}:Y))}}},P=async E=>{var J;const F=((J=E.offResult)==null?void 0:J.bestImageUrl)||E.food.imageUrl;if(F){g(Y=>Y.map(fe=>fe.food._id===E.food._id?{...fe,isCleaningImage:!0,cleaningProgress:0}:fe));try{const Y=await z_(F,fe=>{g(me=>me.map(pe=>pe.food._id===E.food._id?{...pe,cleaningProgress:fe}:pe))});if(Y.success&&Y.processedUrl&&Y.blob)g(fe=>fe.map(me=>me.food._id===E.food._id?{...me,isCleaningImage:!1,cleanedImageUrl:Y.processedUrl,cleanedImageBlob:Y.blob}:me));else throw new Error(Y.error||"Failed to process image")}catch(Y){console.error("Failed to clean image:",Y),alert(`Failed to clean image: ${Y}`),g(fe=>fe.map(me=>me.food._id===E.food._id?{...me,isCleaningImage:!1}:me))}}},N=async E=>{if(E.cleanedImageBlob){g(F=>F.map(J=>J.food._id===E.food._id?{...J,isApplying:!0}:J));try{const F=await F$(E.cleanedImageBlob);await Ed(E.food,{imageUrl:F}),g(J=>J.map(Y=>Y.food._id===E.food._id?{...Y,isApplying:!1,applied:"image"}:Y))}catch(F){console.error("Failed to apply cleaned image:",F),alert(`Failed to apply cleaned image: ${F}`),g(J=>J.map(Y=>Y.food._id===E.food._id?{...Y,isApplying:!1}:Y))}}},_=b.useCallback(async()=>{if(i.trim()){o(!0),l(null);try{const E=await HR(i.trim(),"UK");l(E)}catch(E){console.error("Lookup error:",E),l({product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:String(E)})}finally{o(!1)}}},[i]),L=b.useCallback(async()=>{var E,F,J;if(a!=null&&a.product){h(!0);try{const Y=_C(a.product),fe=await sz({objectID:`off_${a.product.code}`,name:Y.name,brandName:Y.brandName,barcode:Y.barcode,barcodes:[a.product.code],ingredients:((E=Y.ingredientsText)==null?void 0:E.split(/,\s*/))||[],ingredientsText:Y.ingredientsText,calories:Y.calories,protein:Y.protein,carbs:Y.carbs,fat:Y.fat,saturatedFat:Y.saturatedFat,fiber:Y.fiber,sugar:Y.sugar,sodium:Y.sodium,salt:Y.salt,servingDescription:a.product.serving_size||null,servingSizeG:null,isPerUnit:!1,isVerified:!1,verifiedBy:null,verifiedAt:null,imageUrl:a.bestImageUrl,category:((J=(F=a.product.categories)==null?void 0:F.split(",")[0])==null?void 0:J.trim())||null,source:"OpenFoodFacts",createdAt:new Date,updatedAt:new Date});fe.success?(t(),e(),r(""),l(null)):alert(`Failed to import: ${fe.error}`)}catch(Y){console.error("Import error:",Y),alert(`Import error: ${Y}`)}finally{h(!1)}}},[a,t,e]),M=b.useCallback(E=>{E.key==="Enter"&&i.trim()&&_(),E.key==="Escape"&&e()},[i,_,e]);return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"OpenFoodFacts Lookup"}),c.jsx("p",{className:"text-sm text-gray-500",children:m?`Checking ${s.length} selected item${s.length>1?"s":""} for UK products`:"Smart UK product detection"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[s.length>0&&c.jsx("button",{onClick:()=>C(!m),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-lg hover:bg-gray-50",children:m?"Manual Search":`Back to Selected (${s.length})`}),c.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),m?c.jsxs(c.Fragment,{children:[y>0&&y<100&&c.jsx("div",{className:"px-6 py-2 bg-gray-50 border-b border-gray-100",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all",style:{width:`${y}%`}})}),c.jsxs("span",{className:"text-sm text-gray-500",children:[y,"%"]})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-gray-200",children:p.map(E=>{var F,J,Y,fe;return c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Ours"}),E.food.imageUrl?c.jsx("img",{src:E.food.imageUrl,alt:"",className:"w-16 h-16 object-cover rounded border border-gray-200"}):c.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs",children:"None"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"OFF"}),(F=E.offResult)!=null&&F.bestImageUrl?c.jsx("img",{src:E.offResult.bestImageUrl,alt:"",className:"w-16 h-16 object-cover rounded border-2 border-green-400"}):c.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs",children:E.isLoading?"...":"None"})]}),(E.cleanedImageUrl||E.isCleaningImage)&&c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-orange-500 mb-1 font-medium",children:"Cleaned"}),E.cleanedImageUrl?c.jsx("img",{src:E.cleanedImageUrl,alt:"Cleaned",className:"w-16 h-16 object-contain rounded border-2 border-orange-400 bg-white",style:{imageRendering:"auto"}}):c.jsx("div",{className:"w-16 h-16 bg-orange-50 rounded border-2 border-orange-200 flex items-center justify-center",children:c.jsxs("svg",{className:"w-5 h-5 animate-spin text-orange-500",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})})]})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:E.food.name}),E.food.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:E.food.brandName}),c.jsx("p",{className:"text-xs text-gray-400 font-mono mt-1",children:E.food.barcode||"No barcode"})]}),c.jsxs("div",{className:"flex flex-col items-end gap-1",children:[E.isLoading?c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Searching"]}):E.error?c.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:E.error}):(J=E.offResult)!=null&&J.product?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E.offResult.isUKProduct?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:E.offResult.isUKProduct?` UK (${E.offResult.ukConfidenceScore}%)`:` Non-UK (${E.offResult.ukConfidenceScore}%)`}),c.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${E.nutritionScore>=70?"bg-green-100 text-green-700":E.nutritionScore>=40?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:["Nutrition: ",E.nutritionScore,"% match"]}),E.hasBetterImage&&c.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:"Better image available"})]}):c.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-500 rounded-full",children:"Not in OFF"}),E.applied!=="none"&&c.jsxs("span",{className:"px-2 py-1 text-xs bg-green-500 text-white rounded-full",children:[" Applied ",E.applied]})]})]}),((Y=E.offResult)==null?void 0:Y.product)&&E.comparison.length>0&&c.jsxs("div",{className:"mt-3",children:[c.jsxs("button",{onClick:()=>S(x===E.food._id?null:E.food._id),className:"text-xs text-primary-600 hover:underline",children:[x===E.food._id?"Hide":"Show"," nutrition comparison"]}),x===E.food._id&&c.jsxs("div",{className:"mt-2 grid grid-cols-7 gap-1 text-xs",children:[c.jsx("div",{className:"font-medium text-gray-500"}),E.comparison.slice(0,6).map(me=>c.jsx("div",{className:"font-medium text-gray-500 text-center capitalize",children:me.field.slice(0,3)},me.field)),c.jsx("div",{className:"text-gray-500",children:"Ours"}),E.comparison.slice(0,6).map(me=>c.jsx("div",{className:"text-center text-gray-700",children:me.ours!==null?me.ours:"-"},`ours-${me.field}`)),c.jsx("div",{className:"text-gray-500",children:"OFF"}),E.comparison.slice(0,6).map(me=>c.jsx("div",{className:`text-center ${me.matches?"text-green-600":me.difference&&me.difference>20?"text-red-600 font-medium":"text-yellow-600"}`,children:me.theirs!==null?me.theirs:"-"},`theirs-${me.field}`)),c.jsx("div",{className:"text-gray-400",children:"Diff"}),E.comparison.slice(0,6).map(me=>c.jsx("div",{className:`text-center text-xs ${me.matches?"text-green-500":me.difference&&me.difference>20?"text-red-500":"text-yellow-500"}`,children:me.difference!==null?`${me.difference}%`:"-"},`diff-${me.field}`))]})]})]}),((fe=E.offResult)==null?void 0:fe.product)&&E.applied==="none"&&c.jsx("div",{className:"flex flex-col gap-2 flex-shrink-0",children:E.isApplying?c.jsx("div",{className:"flex items-center justify-center p-4",children:c.jsxs("svg",{className:"w-5 h-5 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}):c.jsxs(c.Fragment,{children:[(E.hasImage||E.food.imageUrl)&&!E.cleanedImageUrl&&c.jsx("button",{onClick:()=>P(E),disabled:E.isCleaningImage,className:"px-3 py-1.5 text-xs bg-orange-50 text-orange-700 rounded hover:bg-orange-100 whitespace-nowrap disabled:opacity-50",children:E.isCleaningImage?c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),E.cleaningProgress,"%"]}):"Clean Image"}),E.cleanedImageUrl&&c.jsx("button",{onClick:()=>N(E),className:"px-3 py-1.5 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 whitespace-nowrap font-medium",children:"Apply Cleaned"}),E.hasImage&&!E.cleanedImageUrl&&c.jsx("button",{onClick:()=>I(E),className:"px-3 py-1.5 text-xs bg-blue-50 text-blue-700 rounded hover:bg-blue-100 whitespace-nowrap",children:"Apply Original"}),c.jsx("button",{onClick:()=>V(E),className:"px-3 py-1.5 text-xs bg-purple-50 text-purple-700 rounded hover:bg-purple-100 whitespace-nowrap",children:"Apply Nutrition"}),c.jsx("button",{onClick:()=>j(E),className:"px-3 py-1.5 text-xs bg-green-600 text-white rounded hover:bg-green-700 whitespace-nowrap font-medium",children:"Apply All"})]})})]})},E.food._id)})}),c.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[c.jsxs("span",{className:"text-gray-500",children:["Found: ",c.jsx("span",{className:"font-medium text-green-600",children:p.filter(E=>{var F;return(F=E.offResult)==null?void 0:F.product}).length})]}),c.jsxs("span",{className:"text-gray-500",children:["UK: ",c.jsx("span",{className:"font-medium text-green-600",children:p.filter(E=>{var F;return(F=E.offResult)==null?void 0:F.isUKProduct}).length})]}),c.jsxs("span",{className:"text-gray-500",children:["Better Images: ",c.jsx("span",{className:"font-medium text-blue-600",children:p.filter(E=>E.hasBetterImage).length})]}),c.jsxs("span",{className:"text-gray-500",children:["Applied: ",c.jsx("span",{className:"font-medium text-green-600",children:p.filter(E=>E.applied!=="none").length})]})]}),c.jsx("div",{className:"flex gap-2",children:c.jsx("button",{onClick:()=>{t(),e()},className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Done"})})]})})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"text",value:i,onChange:E=>r(E.target.value),onKeyDown:M,placeholder:"Enter barcode (e.g., 5000128000000)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!m}),c.jsxs("button",{onClick:_,disabled:!i.trim()||n,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[n?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.jsx("span",{children:"Search"})]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[(a==null?void 0:a.error)&&!a.product&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[c.jsx("p",{className:"font-medium",children:"Error"}),c.jsx("p",{className:"text-sm",children:a.error})]}),(a==null?void 0:a.product)&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex gap-6",children:[c.jsxs("div",{className:"flex-shrink-0",children:[a.bestImageUrl?c.jsx("img",{src:a.bestImageUrl,alt:a.product.product_name||"Product",className:"w-32 h-32 object-cover rounded-lg border border-gray-200"}):c.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400",children:c.jsx("span",{className:"text-sm",children:"No image"})}),a.imageConfidenceScore>0&&c.jsxs("div",{className:"mt-2 text-xs text-center text-gray-500",children:["Image score: ",a.imageConfidenceScore,"/10",a.isRegionMatch&&c.jsx("span",{className:"ml-1 text-green-600",children:"UK"})]})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.product.product_name_en||a.product.product_name||"Unknown Product"}),a.product.brands&&c.jsx("p",{className:"text-gray-600",children:a.product.brands}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Barcode: ",a.product.code]}),c.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[c.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${a.isUKProduct?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:a.isUKProduct?" UK Product":" Non-UK Product"}),c.jsxs("span",{className:"text-sm text-gray-500",children:[a.ukConfidenceScore,"% confidence"]})]})]})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"UK Detection Signals"]}),c.jsx("div",{className:"space-y-2",children:a.ukSignals.map((E,F)=>c.jsxs("div",{className:`flex items-start gap-3 p-2 rounded ${E.matched?"bg-green-50":"bg-white"}`,children:[c.jsx("div",{className:`mt-0.5 ${E.matched?"text-green-600":"text-gray-400"}`,children:E.matched?c.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):c.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:`text-sm font-medium ${E.matched?"text-green-800":"text-gray-600"}`,children:E.signal}),c.jsxs("span",{className:"text-xs text-gray-400",children:["Weight: ",E.weight]})]}),E.details&&c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:E.details})]})]},F))})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Nutrition (per 100g)"}),c.jsx("div",{className:"grid grid-cols-4 gap-3",children:(()=>{const E=_C(a.product);return c.jsxs(c.Fragment,{children:[c.jsx(No,{label:"Calories",value:E.calories,unit:"kcal"}),c.jsx(No,{label:"Protein",value:E.protein,unit:"g"}),c.jsx(No,{label:"Carbs",value:E.carbs,unit:"g"}),c.jsx(No,{label:"Fat",value:E.fat,unit:"g"}),c.jsx(No,{label:"Sat. Fat",value:E.saturatedFat,unit:"g"}),c.jsx(No,{label:"Fibre",value:E.fiber,unit:"g"}),c.jsx(No,{label:"Sugar",value:E.sugar,unit:"g"}),c.jsx(No,{label:"Salt",value:E.salt,unit:"g"})]})})()})]}),a.product.ingredients_text_en||a.product.ingredients_text?c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Ingredients"}),c.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:a.product.ingredients_text_en||a.product.ingredients_text})]}):null]}),!a&&!n&&c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),c.jsx("p",{children:"Enter a barcode to search OpenFoodFacts"}),c.jsx("p",{className:"text-sm mt-1",children:"UK products will be automatically detected"})]})]}),(a==null?void 0:a.product)&&c.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[c.jsx("div",{className:"text-sm text-gray-500",children:!a.isUKProduct&&c.jsx("span",{className:"text-yellow-600",children:"This may not be a UK product. Import with caution."})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100",children:"Cancel"}),c.jsxs("button",{onClick:L,disabled:u,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 flex items-center gap-2",children:[u?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),c.jsx("span",{children:"Import to Database"})]})]})]})]})]})})},No=({label:e,value:t,unit:s})=>c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500",children:e}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t!==null?t.toFixed(1):"-"}),c.jsx("p",{className:"text-xs text-gray-400",children:s})]});function mo(e){return Array.isArray?Array.isArray(e):K_(e)==="[object Array]"}function _$(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function k$(e){return e==null?"":_$(e)}function Nn(e){return typeof e=="string"}function U_(e){return typeof e=="number"}function M$(e){return e===!0||e===!1||L$(e)&&K_(e)=="[object Boolean]"}function $_(e){return typeof e=="object"}function L$(e){return $_(e)&&e!==null}function ur(e){return e!=null}function jC(e){return!e.trim().length}function K_(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const O$="Incorrect 'index' type",G$=e=>`Invalid value for key ${e}`,V$=e=>`Pattern length exceeds max of ${e}.`,B$=e=>`Missing ${e} property in key`,H$=e=>`Property 'weight' in key '${e}' must be a positive integer`,CT=Object.prototype.hasOwnProperty;class j${constructor(t){this._keys=[],this._keyMap={};let s=0;t.forEach(i=>{let r=Y_(i);this._keys.push(r),this._keyMap[r.id]=r,s+=r.weight}),this._keys.forEach(i=>{i.weight/=s})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Y_(e){let t=null,s=null,i=null,r=1,n=null;if(Nn(e)||mo(e))i=e,t=yT(e),s=Ww(e);else{if(!CT.call(e,"name"))throw new Error(B$("name"));const o=e.name;if(i=o,CT.call(e,"weight")&&(r=e.weight,r<=0))throw new Error(H$(o));t=yT(o),s=Ww(o),n=e.getFn}return{path:t,id:s,weight:r,src:i,getFn:n}}function yT(e){return mo(e)?e:e.split(".")}function Ww(e){return mo(e)?e.join("."):e}function W$(e,t){let s=[],i=!1;const r=(n,o,a)=>{if(ur(n))if(!o[a])s.push(n);else{let l=o[a];const u=n[l];if(!ur(u))return;if(a===o.length-1&&(Nn(u)||U_(u)||M$(u)))s.push(k$(u));else if(mo(u)){i=!0;for(let h=0,p=u.length;h<p;h+=1)r(u[h],o,a+1)}else o.length&&r(u,o,a+1)}};return r(e,Nn(t)?t.split("."):t,0),i?s:s[0]}const z$={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},U$={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},$$={location:0,threshold:.6,distance:100},K$={useExtendedSearch:!1,getFn:W$,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var pt={...U$,...z$,...$$,...K$};const Y$=/[^ ]+/g;function q$(e=1,t=3){const s=new Map,i=Math.pow(10,t);return{get(r){const n=r.match(Y$).length;if(s.has(n))return s.get(n);const o=1/Math.pow(n,.5*e),a=parseFloat(Math.round(o*i)/i);return s.set(n,a),a},clear(){s.clear()}}}class Ax{constructor({getFn:t=pt.getFn,fieldNormWeight:s=pt.fieldNormWeight}={}){this.norm=q$(s,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((s,i)=>{this._keysMap[s.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Nn(this.docs[0])?this.docs.forEach((t,s)=>{this._addString(t,s)}):this.docs.forEach((t,s)=>{this._addObject(t,s)}),this.norm.clear())}add(t){const s=this.size();Nn(t)?this._addString(t,s):this._addObject(t,s)}removeAt(t){this.records.splice(t,1);for(let s=t,i=this.size();s<i;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(t,s){return t[this._keysMap[s]]}size(){return this.records.length}_addString(t,s){if(!ur(t)||jC(t))return;let i={v:t,i:s,n:this.norm.get(t)};this.records.push(i)}_addObject(t,s){let i={i:s,$:{}};this.keys.forEach((r,n)=>{let o=r.getFn?r.getFn(t):this.getFn(t,r.path);if(ur(o)){if(mo(o)){let a=[];const l=[{nestedArrIndex:-1,value:o}];for(;l.length;){const{nestedArrIndex:u,value:h}=l.pop();if(ur(h))if(Nn(h)&&!jC(h)){let p={v:h,i:u,n:this.norm.get(h)};a.push(p)}else mo(h)&&h.forEach((p,g)=>{l.push({nestedArrIndex:g,value:p})})}i.$[n]=a}else if(Nn(o)&&!jC(o)){let a={v:o,n:this.norm.get(o)};i.$[n]=a}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function q_(e,t,{getFn:s=pt.getFn,fieldNormWeight:i=pt.fieldNormWeight}={}){const r=new Ax({getFn:s,fieldNormWeight:i});return r.setKeys(e.map(Y_)),r.setSources(t),r.create(),r}function Q$(e,{getFn:t=pt.getFn,fieldNormWeight:s=pt.fieldNormWeight}={}){const{keys:i,records:r}=e,n=new Ax({getFn:t,fieldNormWeight:s});return n.setKeys(i),n.setIndexRecords(r),n}function gg(e,{errors:t=0,currentLocation:s=0,expectedLocation:i=0,distance:r=pt.distance,ignoreLocation:n=pt.ignoreLocation}={}){const o=t/e.length;if(n)return o;const a=Math.abs(i-s);return r?o+a/r:a?1:o}function Z$(e=[],t=pt.minMatchCharLength){let s=[],i=-1,r=-1,n=0;for(let o=e.length;n<o;n+=1){let a=e[n];a&&i===-1?i=n:!a&&i!==-1&&(r=n-1,r-i+1>=t&&s.push([i,r]),i=-1)}return e[n-1]&&n-i>=t&&s.push([i,n-1]),s}const Za=32;function J$(e,t,s,{location:i=pt.location,distance:r=pt.distance,threshold:n=pt.threshold,findAllMatches:o=pt.findAllMatches,minMatchCharLength:a=pt.minMatchCharLength,includeMatches:l=pt.includeMatches,ignoreLocation:u=pt.ignoreLocation}={}){if(t.length>Za)throw new Error(V$(Za));const h=t.length,p=e.length,g=Math.max(0,Math.min(i,p));let m=n,C=g;const y=a>1||l,R=y?Array(p):[];let x;for(;(x=e.indexOf(t,C))>-1;){let P=gg(t,{currentLocation:x,expectedLocation:g,distance:r,ignoreLocation:u});if(m=Math.min(P,m),C=x+h,y){let N=0;for(;N<h;)R[x+N]=1,N+=1}}C=-1;let S=[],T=1,I=h+p;const V=1<<h-1;for(let P=0;P<h;P+=1){let N=0,_=I;for(;N<_;)gg(t,{errors:P,currentLocation:g+_,expectedLocation:g,distance:r,ignoreLocation:u})<=m?N=_:I=_,_=Math.floor((I-N)/2+N);I=_;let L=Math.max(1,g-_+1),M=o?p:Math.min(g+_,p)+h,E=Array(M+2);E[M+1]=(1<<P)-1;for(let J=M;J>=L;J-=1){let Y=J-1,fe=s[e.charAt(Y)];if(y&&(R[Y]=+!!fe),E[J]=(E[J+1]<<1|1)&fe,P&&(E[J]|=(S[J+1]|S[J])<<1|1|S[J+1]),E[J]&V&&(T=gg(t,{errors:P,currentLocation:Y,expectedLocation:g,distance:r,ignoreLocation:u}),T<=m)){if(m=T,C=Y,C<=g)break;L=Math.max(1,2*g-C)}}if(gg(t,{errors:P+1,currentLocation:g,expectedLocation:g,distance:r,ignoreLocation:u})>m)break;S=E}const j={isMatch:C>=0,score:Math.max(.001,T)};if(y){const P=Z$(R,a);P.length?l&&(j.indices=P):j.isMatch=!1}return j}function X$(e){let t={};for(let s=0,i=e.length;s<i;s+=1){const r=e.charAt(s);t[r]=(t[r]||0)|1<<i-s-1}return t}const um=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class Q_{constructor(t,{location:s=pt.location,threshold:i=pt.threshold,distance:r=pt.distance,includeMatches:n=pt.includeMatches,findAllMatches:o=pt.findAllMatches,minMatchCharLength:a=pt.minMatchCharLength,isCaseSensitive:l=pt.isCaseSensitive,ignoreDiacritics:u=pt.ignoreDiacritics,ignoreLocation:h=pt.ignoreLocation}={}){if(this.options={location:s,threshold:i,distance:r,includeMatches:n,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:l,ignoreDiacritics:u,ignoreLocation:h},t=l?t:t.toLowerCase(),t=u?um(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const p=(m,C)=>{this.chunks.push({pattern:m,alphabet:X$(m),startIndex:C})},g=this.pattern.length;if(g>Za){let m=0;const C=g%Za,y=g-C;for(;m<y;)p(this.pattern.substr(m,Za),m),m+=Za;if(C){const R=g-Za;p(this.pattern.substr(R),R)}}else p(this.pattern,0)}searchIn(t){const{isCaseSensitive:s,ignoreDiacritics:i,includeMatches:r}=this.options;if(t=s?t:t.toLowerCase(),t=i?um(t):t,this.pattern===t){let y={isMatch:!0,score:0};return r&&(y.indices=[[0,t.length-1]]),y}const{location:n,distance:o,threshold:a,findAllMatches:l,minMatchCharLength:u,ignoreLocation:h}=this.options;let p=[],g=0,m=!1;this.chunks.forEach(({pattern:y,alphabet:R,startIndex:x})=>{const{isMatch:S,score:T,indices:I}=J$(t,y,R,{location:n+x,distance:o,threshold:a,findAllMatches:l,minMatchCharLength:u,includeMatches:r,ignoreLocation:h});S&&(m=!0),g+=T,S&&I&&(p=[...p,...I])});let C={isMatch:m,score:m?g/this.chunks.length:1};return m&&r&&(C.indices=p),C}}class Ia{constructor(t){this.pattern=t}static isMultiMatch(t){return wT(t,this.multiRegex)}static isSingleMatch(t){return wT(t,this.singleRegex)}search(){}}function wT(e,t){const s=e.match(t);return s?s[1]:null}class e3 extends Ia{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const s=t===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class t3 extends Ia{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const i=t.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,t.length-1]}}}class s3 extends Ia{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const s=t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class i3 extends Ia{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const s=!t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class r3 extends Ia{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const s=t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class n3 extends Ia{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const s=!t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class Z_ extends Ia{constructor(t,{location:s=pt.location,threshold:i=pt.threshold,distance:r=pt.distance,includeMatches:n=pt.includeMatches,findAllMatches:o=pt.findAllMatches,minMatchCharLength:a=pt.minMatchCharLength,isCaseSensitive:l=pt.isCaseSensitive,ignoreDiacritics:u=pt.ignoreDiacritics,ignoreLocation:h=pt.ignoreLocation}={}){super(t),this._bitapSearch=new Q_(t,{location:s,threshold:i,distance:r,includeMatches:n,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:l,ignoreDiacritics:u,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class J_ extends Ia{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let s=0,i;const r=[],n=this.pattern.length;for(;(i=t.indexOf(this.pattern,s))>-1;)s=i+n,r.push([i,s-1]);const o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}const zw=[e3,J_,s3,i3,n3,r3,t3,Z_],ST=zw.length,o3=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,a3="|";function l3(e,t={}){return e.split(a3).map(s=>{let i=s.trim().split(o3).filter(n=>n&&!!n.trim()),r=[];for(let n=0,o=i.length;n<o;n+=1){const a=i[n];let l=!1,u=-1;for(;!l&&++u<ST;){const h=zw[u];let p=h.isMultiMatch(a);p&&(r.push(new h(p,t)),l=!0)}if(!l)for(u=-1;++u<ST;){const h=zw[u];let p=h.isSingleMatch(a);if(p){r.push(new h(p,t));break}}}return r})}const c3=new Set([Z_.type,J_.type]);class u3{constructor(t,{isCaseSensitive:s=pt.isCaseSensitive,ignoreDiacritics:i=pt.ignoreDiacritics,includeMatches:r=pt.includeMatches,minMatchCharLength:n=pt.minMatchCharLength,ignoreLocation:o=pt.ignoreLocation,findAllMatches:a=pt.findAllMatches,location:l=pt.location,threshold:u=pt.threshold,distance:h=pt.distance}={}){this.query=null,this.options={isCaseSensitive:s,ignoreDiacritics:i,includeMatches:r,minMatchCharLength:n,findAllMatches:a,ignoreLocation:o,location:l,threshold:u,distance:h},t=s?t:t.toLowerCase(),t=i?um(t):t,this.pattern=t,this.query=l3(this.pattern,this.options)}static condition(t,s){return s.useExtendedSearch}searchIn(t){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:i,isCaseSensitive:r,ignoreDiacritics:n}=this.options;t=r?t:t.toLowerCase(),t=n?um(t):t;let o=0,a=[],l=0;for(let u=0,h=s.length;u<h;u+=1){const p=s[u];a.length=0,o=0;for(let g=0,m=p.length;g<m;g+=1){const C=p[g],{isMatch:y,indices:R,score:x}=C.search(t);if(y){if(o+=1,l+=x,i){const S=C.constructor.type;c3.has(S)?a=[...a,...R]:a.push(R)}}else{l=0,o=0,a.length=0;break}}if(o){let g={isMatch:!0,score:l/o};return i&&(g.indices=a),g}}return{isMatch:!1,score:1}}}const Uw=[];function d3(...e){Uw.push(...e)}function $w(e,t){for(let s=0,i=Uw.length;s<i;s+=1){let r=Uw[s];if(r.condition(e,t))return new r(e,t)}return new Q_(e,t)}const dm={AND:"$and",OR:"$or"},Kw={PATH:"$path",PATTERN:"$val"},Yw=e=>!!(e[dm.AND]||e[dm.OR]),h3=e=>!!e[Kw.PATH],p3=e=>!mo(e)&&$_(e)&&!Yw(e),xT=e=>({[dm.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function X_(e,t,{auto:s=!0}={}){const i=r=>{let n=Object.keys(r);const o=h3(r);if(!o&&n.length>1&&!Yw(r))return i(xT(r));if(p3(r)){const l=o?r[Kw.PATH]:n[0],u=o?r[Kw.PATTERN]:r[l];if(!Nn(u))throw new Error(G$(l));const h={keyId:Ww(l),pattern:u};return s&&(h.searcher=$w(u,t)),h}let a={children:[],operator:n[0]};return n.forEach(l=>{const u=r[l];mo(u)&&u.forEach(h=>{a.children.push(i(h))})}),a};return Yw(e)||(e=xT(e)),i(e)}function g3(e,{ignoreFieldNorm:t=pt.ignoreFieldNorm}){e.forEach(s=>{let i=1;s.matches.forEach(({key:r,norm:n,score:o})=>{const a=r?r.weight:null;i*=Math.pow(o===0&&a?Number.EPSILON:o,(a||1)*(t?1:n))}),s.score=i})}function f3(e,t){const s=e.matches;t.matches=[],ur(s)&&s.forEach(i=>{if(!ur(i.indices)||!i.indices.length)return;const{indices:r,value:n}=i;let o={indices:r,value:n};i.key&&(o.key=i.key.src),i.idx>-1&&(o.refIndex=i.idx),t.matches.push(o)})}function m3(e,t){t.score=e.score}function v3(e,t,{includeMatches:s=pt.includeMatches,includeScore:i=pt.includeScore}={}){const r=[];return s&&r.push(f3),i&&r.push(m3),e.map(n=>{const{idx:o}=n,a={item:t[o],refIndex:o};return r.length&&r.forEach(l=>{l(n,a)}),a})}class Wu{constructor(t,s={},i){this.options={...pt,...s},this.options.useExtendedSearch,this._keyStore=new j$(this.options.keys),this.setCollection(t,i)}setCollection(t,s){if(this._docs=t,s&&!(s instanceof Ax))throw new Error(O$);this._myIndex=s||q_(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){ur(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const s=[];for(let i=0,r=this._docs.length;i<r;i+=1){const n=this._docs[i];t(n,i)&&(this.removeAt(i),i-=1,r-=1,s.push(n))}return s}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:s=-1}={}){const{includeMatches:i,includeScore:r,shouldSort:n,sortFn:o,ignoreFieldNorm:a}=this.options;let l=Nn(t)?Nn(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return g3(l,{ignoreFieldNorm:a}),n&&l.sort(o),U_(s)&&s>-1&&(l=l.slice(0,s)),v3(l,this._docs,{includeMatches:i,includeScore:r})}_searchStringList(t){const s=$w(t,this.options),{records:i}=this._myIndex,r=[];return i.forEach(({v:n,i:o,n:a})=>{if(!ur(n))return;const{isMatch:l,score:u,indices:h}=s.searchIn(n);l&&r.push({item:n,idx:o,matches:[{score:u,value:n,norm:a,indices:h}]})}),r}_searchLogical(t){const s=X_(t,this.options),i=(a,l,u)=>{if(!a.children){const{keyId:p,searcher:g}=a,m=this._findMatches({key:this._keyStore.get(p),value:this._myIndex.getValueForItemAtKeyId(l,p),searcher:g});return m&&m.length?[{idx:u,item:l,matches:m}]:[]}const h=[];for(let p=0,g=a.children.length;p<g;p+=1){const m=a.children[p],C=i(m,l,u);if(C.length)h.push(...C);else if(a.operator===dm.AND)return[]}return h},r=this._myIndex.records,n={},o=[];return r.forEach(({$:a,i:l})=>{if(ur(a)){let u=i(s,a,l);u.length&&(n[l]||(n[l]={idx:l,item:a,matches:[]},o.push(n[l])),u.forEach(({matches:h})=>{n[l].matches.push(...h)}))}}),o}_searchObjectList(t){const s=$w(t,this.options),{keys:i,records:r}=this._myIndex,n=[];return r.forEach(({$:o,i:a})=>{if(!ur(o))return;let l=[];i.forEach((u,h)=>{l.push(...this._findMatches({key:u,value:o[h],searcher:s}))}),l.length&&n.push({idx:a,item:o,matches:l})}),n}_findMatches({key:t,value:s,searcher:i}){if(!ur(s))return[];let r=[];if(mo(s))s.forEach(({v:n,i:o,n:a})=>{if(!ur(n))return;const{isMatch:l,score:u,indices:h}=i.searchIn(n);l&&r.push({score:u,key:t,value:n,idx:o,norm:a,indices:h})});else{const{v:n,n:o}=s,{isMatch:a,score:l,indices:u}=i.searchIn(n);a&&r.push({score:l,key:t,value:n,norm:o,indices:u})}return r}}Wu.version="7.1.0";Wu.createIndex=q_;Wu.parseIndex=Q$;Wu.config=pt;Wu.parseQuery=X_;d3(u3);const C3=["tesco","sainsbury","sainsburys","sainsbury's","asda","morrisons","waitrose","aldi","lidl","co-op","coop","marks & spencer","m&s","iceland","ocado","booths","budgens","costcutter","spar","londis"],y3=[["colour","color"],["flavour","flavor"],["fibre","fiber"],["centre","center"],["litre","liter"],["grey","gray"],["organise","organize"],["recognise","recognize"],["favourite","favorite"],["honour","honor"]],Mo={barcodeExact:50,barcodePresent:10,nameExact:20,nameFuzzy:15,brandExact:10,ukRetailerBrand:5,ingredientOverlap:10,ukSpelling:5};function In(e){return e.toLowerCase().trim().replace(/[^\w\s]/g," ").replace(/\s+/g," ")}function bT(e){if(!e)return!1;const t=In(e);return C3.some(s=>t.includes(s))}function ET(e){const t=In(e);return y3.some(([s])=>t.includes(s))}function w3(e,t){if(e.size===0&&t.size===0)return 0;const s=new Set([...e].filter(r=>t.has(r))),i=new Set([...e,...t]);return s.size/i.size}function S3(e,t){const s=new Set(e.ingredients.map(n=>In(n)).filter(n=>n.length>2)),i=new Set(t.ingredients.map(n=>In(n)).filter(n=>n.length>2));return w3(s,i)*Mo.ingredientOverlap}function x3(e,t){let s=0;const i=[];e.barcode&&t.barcode&&e.barcode===t.barcode&&(s+=Mo.barcodeExact,i.push(`Exact barcode match: ${e.barcode}`)),e.barcode&&t.barcode&&(s+=Mo.barcodePresent);const r=In(e.name),n=In(t.name);if(r===n)s+=Mo.nameExact,i.push("Exact name match");else{const u=new Wu([r],{threshold:.4,includeScore:!0}).search(n);if(u.length>0&&u[0].score!==void 0){const h=(1-u[0].score)*Mo.nameFuzzy;h>5&&(s+=h,i.push(`Fuzzy name match (${Math.round(h)} pts)`))}}if(e.brandName&&t.brandName){const l=In(e.brandName),u=In(t.brandName);l===u&&(s+=Mo.brandExact,i.push("Exact brand match"))}if(bT(e.brandName)&&bT(t.brandName)&&(s+=Mo.ukRetailerBrand,i.push("Both are UK retailer products")),e.ingredients.length>0&&t.ingredients.length>0){const l=S3(e,t);l>2&&(s+=l,i.push(`Ingredient overlap (${Math.round(l)} pts)`))}const o=`${e.name} ${e.ingredientsText||""}`,a=`${t.name} ${t.ingredientsText||""}`;return ET(o)&&ET(a)&&(s+=Mo.ukSpelling,i.push("Both have UK spelling")),{score:s,reasons:i}}function b3(e){const t=new Map;return e.forEach(s=>{if(s.barcode){const i=t.get(s.barcode)||[];i.push(s),t.set(s.barcode,i)}}),t}function E3(e){const t=new Map;return e.forEach(s=>{const i=In(s.name),r=s.brandName?`${i}|${In(s.brandName)}`:i,n=t.get(r)||[];n.push(s),t.set(r,n)}),t}function R3(e,t={}){const{minScore:s=30,maxGroups:i=500}=t,r=[],n=new Set,o=new Set,a=b3(e),l=E3(e);return a.forEach((u,h)=>{if(u.length>1){const p=`barcode-${h}`,g=[...u].sort((y,R)=>y.isVerified!==R.isVerified?y.isVerified?-1:1:R._confidenceScore-y._confidenceScore),m=g[0],C=g.slice(1).map(y=>y._id);r.push({id:p,masterFoodId:m._id,duplicateIds:C,matchScore:100,matchReasons:[`Exact barcode match: ${h}`]}),u.forEach(y=>o.add(y._id))}}),l.forEach(u=>{if(u.length>1){const h=u.filter(p=>!o.has(p._id));if(h.length>1)for(let p=0;p<h.length;p++)for(let g=p+1;g<h.length;g++){const m=h[p],C=h[g];if(m._sourceIndex===C._sourceIndex)continue;const y=[m._id,C._id].sort().join("|");if(n.has(y))continue;n.add(y);const{score:R,reasons:x}=x3(m,C);if(R>=s){const S=m._confidenceScore>=C._confidenceScore?m:C,T=S===m?C:m;r.push({id:`name-${y}`,masterFoodId:S._id,duplicateIds:[T._id],matchScore:Math.min(100,R),matchReasons:x}),o.add(m._id),o.add(C._id)}}}}),r.sort((u,h)=>h.matchScore-u.matchScore),r.slice(0,i)}function T3(e,t){const s={...e},i=new Set;if(e.barcode&&i.add(e.barcode),t.forEach(r=>{r.barcode&&i.add(r.barcode)}),s.barcodes=[...i],s.barcode=s.barcodes[0]||null,!s.imageUrl){const r=t.find(n=>n.imageUrl);r&&(s.imageUrl=r.imageUrl)}if(!s.ingredientsText||s.ingredientsText.length<20){const r=t.find(n=>{var o;return n.ingredientsText&&n.ingredientsText.length>(((o=s.ingredientsText)==null?void 0:o.length)||0)});r&&(s.ingredientsText=r.ingredientsText,s.ingredients=r.ingredients)}return s._isDirty=!0,s}const D3=({onClose:e})=>{const{duplicateGroups:t,setDuplicateGroups:s,getFoodById:i,updateFood:r}=oa(),[n,o]=b.useState(null),[a,l]=b.useState(null),u=async g=>{const m=i(g.masterFoodId);if(!m)return;const C=g.duplicateIds.map(y=>i(y)).filter(y=>y!==void 0);if(C.length!==0){l(g.id);try{const y=T3(m,C);r(m._id,{barcodes:y.barcodes,barcode:y.barcode,imageUrl:y.imageUrl,ingredientsText:y.ingredientsText,ingredients:y.ingredients}),C.forEach(R=>{r(R._id,{_isDeleted:!0})}),s(t.filter(R=>R.id!==g.id)),console.log(`Merged ${C.length} duplicates into ${m.name}`)}catch(y){console.error("Error merging duplicates:",y),alert("Failed to merge duplicates")}finally{l(null)}}},h=g=>{s(t.filter(m=>m.id!==g.id))},p=()=>{confirm("Dismiss all duplicate groups? This cannot be undone.")&&s([])};return t.length===0?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl p-6",children:c.jsxs("div",{className:"text-center py-8",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto text-green-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Duplicates Found"}),c.jsx("p",{className:"text-gray-500 mb-6",children:"Your database looks clean!"}),c.jsx("button",{onClick:e,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Close"})]})})}):c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Duplicate Detection"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Found ",t.length," potential duplicate group",t.length!==1?"s":""]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:p,className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg",children:"Dismiss All"}),c.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-gray-200",children:t.map(g=>{const m=i(g.masterFoodId),C=g.duplicateIds.map(x=>i(x)).filter(x=>x!==void 0);if(!m)return null;const y=n===g.id,R=a===g.id;return c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"flex-shrink-0",children:m.imageUrl?c.jsx("img",{src:m.imageUrl,alt:"",className:"w-16 h-16 object-cover rounded border border-gray-200"}):c.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs",children:"No img"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:m.name}),m.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:m.brandName}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:["Master: ",m._sourceIndex]}),c.jsxs("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded",children:[C.length," duplicate",C.length!==1?"s":""]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:`text-lg font-bold ${g.matchScore>=80?"text-red-600":g.matchScore>=50?"text-yellow-600":"text-gray-600"}`,children:[g.matchScore,"%"]}),c.jsx("div",{className:"text-xs text-gray-400",children:"match"})]})]}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[g.matchReasons.slice(0,y?void 0:2).map((x,S)=>c.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:x},S)),!y&&g.matchReasons.length>2&&c.jsxs("span",{className:"text-xs text-gray-400",children:["+",g.matchReasons.length-2," more"]})]}),c.jsx("button",{onClick:()=>o(y?null:g.id),className:"mt-2 text-xs text-primary-600 hover:underline",children:y?"Hide details":"Show details"}),y&&c.jsxs("div",{className:"mt-3 space-y-2",children:[c.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase",children:"Duplicates:"}),C.map(x=>c.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded",children:[x.imageUrl?c.jsx("img",{src:x.imageUrl,alt:"",className:"w-10 h-10 object-cover rounded"}):c.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded flex items-center justify-center text-gray-400 text-xs",children:"-"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 truncate",children:x.name}),c.jsxs("p",{className:"text-xs text-gray-500",children:[x._sourceIndex,"  ",x.barcode||"No barcode"]})]})]},x._id))]})]}),c.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0",children:[c.jsx("button",{onClick:()=>u(g),disabled:R,className:"px-3 py-1.5 text-xs bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 whitespace-nowrap",children:R?c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Merging"]}):"Merge"}),c.jsx("button",{onClick:()=>h(g),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 whitespace-nowrap",children:"Dismiss"})]})]})},g.id)})}),c.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:[c.jsx("span",{className:"font-medium text-red-600",children:t.filter(g=>g.matchScore>=80).length})," high confidence ",c.jsx("span",{className:"font-medium text-yellow-600 ml-1",children:t.filter(g=>g.matchScore>=50&&g.matchScore<80).length})," medium ",c.jsx("span",{className:"font-medium text-gray-600 ml-1",children:t.filter(g=>g.matchScore<50).length})," low"]}),c.jsx("button",{onClick:e,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Done"})]})})]})})},RT="WK0TIF84M2",P3="577cc4ee3fed660318917bbb54abfb2e";async function A3(e,t,s){try{console.log(`[Upload] Starting upload for ${t} from ${s}`);const i=await new Promise((o,a)=>{const l=new FileReader;l.onloadend=()=>o(l.result),l.onerror=a,l.readAsDataURL(e)}),n=await(await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/uploadFoodImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:t,objectID:t,imageData:i,sourceIndex:s})})).json();return console.log(`[Upload] Result for ${t}:`,n),n}catch(i){return console.error(`[Upload] Error for ${t}:`,i),{success:!1,error:i instanceof Error?i.message:String(i)}}}const F3=({onBack:e})=>{const[t,s]=b.useState([]),[i,r]=b.useState(!1),[n,o]=b.useState(0),[a,l]=b.useState(""),[u,h]=b.useState(!1),[p,g]=b.useState(!1),[m,C]=b.useState(!1),[y,R]=b.useState("with_barcode"),[x,S]=b.useState(0),[T,I]=b.useState({total:0,withBarcode:0,completed:0,failed:0,noImage:0,processing:0,skipped:0}),[V,j]=b.useState([]),[P,N]=b.useState(new Set(Jt)),[_,L]=b.useState(!0),M=b.useRef(!1),E=b.useRef(!1),F=100,[J,Y]=b.useState(null),fe=k=>{console.log(k),j(O=>[...O.slice(-50),`${new Date().toLocaleTimeString()}: ${k}`])};b.useEffect(()=>{A$().then(k=>{C(k),fe(`Cloud rembg available: ${k}`)})},[]),b.useEffect(()=>{const k=O=>{O.key==="Escape"&&J&&Y(null)};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[J]);const me=b.useCallback(async()=>{var ue;if(P.size===0){fe("No indices selected");return}r(!0),L(!1),o(0),fe("Starting to load foods from Algolia...");const k=[],O=new Set,W=Array.from(P);try{for(let ae=0;ae<W.length;ae++){const X=W[ae];l(`Loading ${X}...`),o(Math.round(ae/W.length*100)),fe(`Loading index: ${X}`);const q=`https://${RT}-dsn.algolia.net/1/indexes/${X}/query`;try{const ie=await fetch(q,{method:"POST",headers:{"X-Algolia-Application-Id":RT,"X-Algolia-API-Key":P3,"Content-Type":"application/json"},body:JSON.stringify({query:"",hitsPerPage:1e3,attributesToRetrieve:["objectID","name","foodName","brandName","brand","barcode","barcodes","imageUrl"]})});if(!ie.ok){fe(`Error loading ${X}: ${ie.status}`);continue}const Ne=(await ie.json()).hits||[];fe(`${X}: ${Ne.length} records`);for(const De of Ne){const Ee=De.barcode||((ue=De.barcodes)==null?void 0:ue[0])||null;Ee&&O.has(Ee)||(Ee&&O.add(Ee),k.push({id:`${X}:${De.objectID}`,objectID:De.objectID,name:De.name||De.foodName||"Unknown",brandName:De.brandName||De.brand||null,barcode:Ee,currentImageUrl:De.imageUrl||null,offImageUrl:null,processedBlob:null,status:"pending",sourceIndex:X,selected:!1}))}}catch(ie){fe(`Error loading ${X}: ${ie}`)}}fe(`Total foods loaded: ${k.length}`),fe(`Foods with barcodes: ${k.filter(ae=>ae.barcode).length}`),s(k),pe(k),o(100),l("")}catch(ae){fe(`Error loading foods: ${ae}`)}finally{r(!1)}},[P]),pe=k=>{I({total:k.length,withBarcode:k.filter(O=>O.barcode).length,completed:k.filter(O=>O.status==="completed").length,failed:k.filter(O=>O.status==="failed").length,noImage:k.filter(O=>O.status==="no_image").length,processing:k.filter(O=>["fetching_off","processing","uploading"].includes(O.status)).length,skipped:k.filter(O=>O.status==="skipped").length})},ye=k=>{s(O=>O.map(W=>W.id===k?{...W,selected:!W.selected}:W))},Ae=()=>{const k=se(),O=new Set(k.map(W=>W.id));s(W=>W.map(ue=>O.has(ue.id)?{...ue,selected:!0}:ue))},te=()=>{s(k=>k.map(O=>({...O,selected:!1})))},ce=async k=>{var W,ue,ae,X,q,ie,we,Ne,De,Ee,Oe,Ue,ze,re,_t,Gs,Xt,Pt,wr,_a,Sr,_s,Xl,vn,Eo,Ro,jr,ka;const O=[`https://uk.openfoodfacts.org/api/v0/product/${k}.json`,`https://world.openfoodfacts.org/api/v0/product/${k}.json`];for(const Ma of O)try{const La=await fetch(Ma);if(!La.ok)continue;const Wr=await La.json();if(Wr.status===1&&Wr.product){const fi=Wr.product,ds=((X=(ae=(ue=(W=fi.images)==null?void 0:W.front)==null?void 0:ue.sizes)==null?void 0:ae.full)==null?void 0:X.w)||((Ne=(we=(ie=(q=fi.images)==null?void 0:q.front)==null?void 0:ie.sizes)==null?void 0:we["400"])==null?void 0:Ne.w)||0,sr=((Ue=(Oe=(Ee=(De=fi.images)==null?void 0:De.front)==null?void 0:Ee.sizes)==null?void 0:Oe.full)==null?void 0:Ue.h)||((Gs=(_t=(re=(ze=fi.images)==null?void 0:ze.front)==null?void 0:re.sizes)==null?void 0:_t["400"])==null?void 0:Gs.h)||0;if(ds>0&&sr>0){const Ks=Math.min(ds,sr),Ur=Math.max(ds,sr)/Ks;if(Ks<200){fe(`Skipping ${k}: image too small (${ds}x${sr})`);continue}if(Ur>2.5){fe(`Skipping ${k}: bad aspect ratio ${Ur.toFixed(1)} (likely cropped)`);continue}}const zr=((wr=(Pt=(Xt=fi.selected_images)==null?void 0:Xt.front)==null?void 0:Pt.display)==null?void 0:wr.en)||((_s=(Sr=(_a=fi.selected_images)==null?void 0:_a.front)==null?void 0:Sr.display)==null?void 0:_s.uk)||((Eo=(vn=(Xl=fi.selected_images)==null?void 0:Xl.front)==null?void 0:vn.url)==null?void 0:Eo.en)||((ka=(jr=(Ro=fi.selected_images)==null?void 0:Ro.front)==null?void 0:jr.url)==null?void 0:ka.uk)||fi.image_front_url||fi.image_url;if(zr){try{const Ks=await fetch(zr,{method:"HEAD"});if(!Ks.ok){fe(`Skipping ${k}: image URL returned ${Ks.status}`);continue}const Vs=Ks.headers.get("content-length");if(Vs&&parseInt(Vs)<5e3){fe(`Skipping ${k}: image file too small (${Vs} bytes)`);continue}}catch{}return fe(`Found valid OFF image for ${k} (${ds}x${sr})`),zr}}}catch{continue}return null},be=async k=>{if(E.current)return{...k,status:"pending"};for(;M.current;)if(await new Promise(O=>setTimeout(O,100)),E.current)return{...k,status:"pending"};if(!k.barcode)return fe(`Skipping ${k.name}: no barcode`),{...k,status:"skipped",error:"No barcode"};if(k.currentImageUrl&&k.currentImageUrl.includes("storage.googleapis.com"))return fe(`Skipping ${k.name}: already has processed image`),{...k,status:"skipped",error:"Already processed"};fe(`Processing: ${k.name} (${k.barcode})`);try{s(ae=>ae.map(X=>X.id===k.id?{...X,status:"fetching_off"}:X));const O=await ce(k.barcode);if(!O)return fe(`No OFF image for ${k.barcode}`),{...k,status:"no_image",error:"No image on OpenFoodFacts"};fe(`Removing background for ${k.name}...`),s(ae=>ae.map(X=>X.id===k.id?{...X,offImageUrl:O,status:"processing"}:X));const W=await z_(O);if(!W.success||!W.blob)return fe(`Background removal failed for ${k.name}: ${W.error}`),{...k,offImageUrl:O,status:"failed",error:W.error||"Processing failed"};fe(`Background removed for ${k.name}, uploading...`),s(ae=>ae.map(X=>X.id===k.id?{...X,offImageUrl:O,processedBlob:W.blob,status:"uploading"}:X));const ue=await A3(W.blob,k.objectID,k.sourceIndex);return ue.success?(fe(`Completed: ${k.name}`),{...k,offImageUrl:O,processedBlob:W.blob,currentImageUrl:ue.url??null,status:"completed"}):(fe(`Upload failed for ${k.name}: ${ue.error}`),{...k,offImageUrl:O,processedBlob:W.blob,status:"failed",error:ue.error||"Upload failed"})}catch(O){return fe(`Error processing ${k.name}: ${O}`),{...k,status:"failed",error:O instanceof Error?O.message:String(O)}}},Ze=async()=>{h(!0),M.current=!1,E.current=!1;const k=t.filter(W=>W.selected),O=k.length>0?k.filter(W=>W.barcode):t.filter(W=>W.status==="pending"&&W.barcode);if(fe(`Starting batch processing of ${O.length} foods`),O.length===0){fe("No foods to process!"),h(!1);return}for(let W=0;W<O.length;W++){if(E.current){fe("Processing stopped by user");break}const ue=O[W];fe(`[${W+1}/${O.length}] Processing ${ue.name}`);const ae=await be(ue);s(X=>{const q=X.map(ie=>ie.id===ue.id?ae:ie);return pe(q),q}),await new Promise(X=>setTimeout(X,300))}fe("Batch processing complete"),h(!1),g(!1)},he=()=>{M.current=!0,g(!0),fe("Paused")},et=()=>{M.current=!1,g(!1),fe("Resumed")},We=()=>{E.current=!0,h(!1),g(!1),fe("Stopped")},se=b.useCallback(()=>{switch(y){case"with_barcode":return t.filter(k=>k.barcode);case"no_image":return t.filter(k=>!k.currentImageUrl);case"pending":return t.filter(k=>k.status==="pending"&&k.barcode);case"selected":return t.filter(k=>k.selected);default:return t}},[t,y]),ne=se(),B=ne.slice(x*F,(x+1)*F),$=Math.ceil(ne.length/F),K=t.filter(k=>k.selected).length,Q=t.filter(k=>k.status==="pending"&&k.barcode).length,oe={pending:"bg-gray-100 text-gray-600",fetching_off:"bg-blue-100 text-blue-600",processing:"bg-yellow-100 text-yellow-600",uploading:"bg-purple-100 text-purple-600",completed:"bg-green-100 text-green-600",failed:"bg-red-100 text-red-600",no_image:"bg-gray-200 text-gray-500",skipped:"bg-gray-100 text-gray-400"},Z={pending:"Pending",fetching_off:"Fetching...",processing:"Cleaning...",uploading:"Uploading...",completed:"Done",failed:"Failed",no_image:"No OFF Image",skipped:"Skipped"};return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Batch Image Processing"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Pull from OpenFoodFacts  Remove backgrounds  Upload to Firebase"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[t.length>0&&!u&&c.jsxs("button",{onClick:()=>{s([]),L(!0),I({total:0,withBarcode:0,completed:0,failed:0,noImage:0,processing:0,skipped:0})},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Change Indices"]}),c.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm ${m?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${m?"bg-green-500":"bg-yellow-500"}`}),m?"Cloud rembg":"Browser mode"]}),u?c.jsxs(c.Fragment,{children:[p?c.jsx("button",{onClick:et,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Resume"}):c.jsx("button",{onClick:he,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700",children:"Pause"}),c.jsx("button",{onClick:We,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Stop"})]}):c.jsxs("button",{onClick:Ze,disabled:i||K===0&&Q===0,className:"flex items-center gap-2 px-5 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[c.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),K>0?`Process Selected (${K})`:`Process All (${Q})`]})]})]}),c.jsxs("div",{className:"space-y-3",children:[i&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${n}%`}})}),c.jsx("span",{className:"text-sm text-gray-500",children:a||`Loading... ${n}%`})]}),!i&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden flex",children:[c.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${T.completed/Math.max(T.withBarcode,1)*100}%`}}),c.jsx("div",{className:"h-full bg-red-400 transition-all",style:{width:`${T.failed/Math.max(T.withBarcode,1)*100}%`}}),c.jsx("div",{className:"h-full bg-gray-400 transition-all",style:{width:`${T.noImage/Math.max(T.withBarcode,1)*100}%`}}),c.jsx("div",{className:"h-full bg-yellow-400 animate-pulse",style:{width:`${T.processing/Math.max(T.withBarcode,1)*100}%`}})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[c.jsxs("span",{className:"text-gray-600",children:["Total: ",c.jsx("strong",{children:T.total.toLocaleString()})]}),c.jsxs("span",{className:"text-gray-600",children:["With Barcode: ",c.jsx("strong",{children:T.withBarcode.toLocaleString()})]}),c.jsxs("span",{className:"text-green-600",children:["Completed: ",c.jsx("strong",{children:T.completed.toLocaleString()})]}),c.jsxs("span",{className:"text-red-600",children:["Failed: ",c.jsx("strong",{children:T.failed.toLocaleString()})]}),c.jsxs("span",{className:"text-gray-500",children:["No OFF: ",c.jsx("strong",{children:T.noImage.toLocaleString()})]}),T.processing>0&&c.jsxs("span",{className:"text-yellow-600 animate-pulse",children:["Processing: ",c.jsx("strong",{children:T.processing})]}),K>0&&c.jsxs("span",{className:"text-primary-600",children:["Selected: ",c.jsx("strong",{children:K})]})]})]})]})]}),c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 flex items-center justify-between",children:[c.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All",count:t.length},{value:"with_barcode",label:"With Barcode",count:T.withBarcode},{value:"pending",label:"Pending",count:Q},{value:"no_image",label:"No Image",count:t.filter(k=>!k.currentImageUrl).length},{value:"selected",label:"Selected",count:K}].map(k=>c.jsxs("button",{onClick:()=>{R(k.value),S(0)},className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${y===k.value?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[k.label," (",k.count.toLocaleString(),")"]},k.value))}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:Ae,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Select All"}),c.jsx("button",{onClick:te,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Deselect All"})]})]}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx("div",{className:"flex-1 overflow-auto p-6",children:_&&!i&&t.length===0?c.jsx("div",{className:"max-w-3xl mx-auto",children:c.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 px-6 py-5 text-white",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Batch Image Processing"}),c.jsx("p",{className:"text-primary-100 text-sm mt-1",children:"Fetch images from OpenFoodFacts, remove backgrounds, straighten products, and upload to Firebase"})]}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"1"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Select indices to load foods from"})]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-6",children:Jt.map(k=>c.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${P.has(k)?"border-primary-500 bg-primary-50 shadow-sm":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("input",{type:"checkbox",checked:P.has(k),onChange:()=>{N(O=>{const W=new Set(O);return W.has(k)?W.delete(k):W.add(k),W})},className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"text-sm font-medium text-gray-700 truncate",children:k.replace(/_/g," ")})]},k))}),c.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-6 border-b border-gray-200",children:[c.jsx("button",{onClick:()=>N(new Set(Jt)),className:"px-3 py-1.5 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:"Select All"}),c.jsx("button",{onClick:()=>N(new Set),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear All"}),c.jsxs("span",{className:"text-sm text-gray-400",children:[P.size," of ",Jt.length," selected"]})]}),c.jsxs("button",{onClick:me,disabled:P.size===0,className:"w-full flex items-center justify-center gap-3 px-6 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 rounded-xl shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none",children:[c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Load ",P.size>0?`Foods from ${P.size} ${P.size===1?"Index":"Indices"}`:"Foods"]}),P.size===0&&c.jsx("p",{className:"text-center text-sm text-red-500 mt-3",children:"Select at least one index to continue"})]})]})}):i?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("svg",{className:"w-8 h-8 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),c.jsx("span",{className:"text-gray-500",children:a||"Loading foods..."})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid gap-2",children:B.map(k=>c.jsxs("div",{className:`bg-white rounded-lg border p-3 flex items-center gap-3 cursor-pointer transition-colors ${k.selected?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>ye(k.id),children:[c.jsx("input",{type:"checkbox",checked:k.selected,onChange:()=>ye(k.id),onClick:O=>O.stopPropagation(),className:"w-4 h-4 text-primary-600 rounded"}),c.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[c.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-primary-400 transition-all",onClick:O=>{O.stopPropagation(),k.currentImageUrl&&Y({url:k.currentImageUrl,title:`${k.name} - Current`})},children:k.currentImageUrl?c.jsx("img",{src:k.currentImageUrl,alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-[8px] text-gray-400",children:"None"})}),c.jsx("svg",{className:"w-3 h-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),c.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all",onClick:O=>{O.stopPropagation(),k.offImageUrl&&Y({url:k.offImageUrl,title:`${k.name} - OpenFoodFacts`})},children:k.offImageUrl?c.jsx("img",{src:k.offImageUrl,alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-[8px] text-gray-400",children:"OFF"})}),c.jsx("svg",{className:"w-3 h-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),c.jsx("div",{className:"w-10 h-10 bg-[#e8e8e8] rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-green-400 transition-all",onClick:O=>{O.stopPropagation(),k.processedBlob&&Y({url:URL.createObjectURL(k.processedBlob),title:`${k.name} - Cleaned`})},children:k.processedBlob?c.jsx("img",{src:URL.createObjectURL(k.processedBlob),alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-[8px] text-gray-400",children:"Clean"})})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:k.name}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[k.barcode&&c.jsx("span",{className:"font-mono",children:k.barcode}),c.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px]",children:k.sourceIndex.replace(/_/g," ")})]})]}),c.jsxs("div",{className:"flex-shrink-0 text-right",children:[c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${oe[k.status]}`,children:[["fetching_off","processing","uploading"].includes(k.status)&&c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),Z[k.status]]}),k.error&&c.jsx("div",{className:"text-[10px] text-red-500 mt-0.5 max-w-[100px] truncate",title:k.error,children:k.error})]})]},k.id))}),$>1&&c.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[c.jsx("button",{onClick:()=>S(k=>Math.max(0,k-1)),disabled:x===0,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",x+1," of ",$]}),c.jsx("button",{onClick:()=>S(k=>Math.min($-1,k+1)),disabled:x>=$-1,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})]})}),c.jsxs("div",{className:"w-80 border-l border-gray-200 bg-gray-900 flex flex-col",children:[c.jsx("div",{className:"px-4 py-2 border-b border-gray-700 text-gray-400 text-xs font-medium uppercase",children:"Processing Log"}),c.jsx("div",{className:"flex-1 overflow-auto p-3 font-mono text-xs text-gray-300 space-y-1",children:V.length===0?c.jsx("div",{className:"text-gray-500",children:"No activity yet..."}):V.map((k,O)=>c.jsx("div",{className:"break-all",children:k},O))})]})]}),J&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:()=>Y(null),children:c.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] flex flex-col items-center",children:[c.jsx("button",{onClick:()=>Y(null),className:"absolute -top-12 right-0 p-2 text-white/80 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsx("div",{className:"absolute -top-12 left-0 text-white font-medium",children:J.title}),c.jsx("div",{className:"rounded-lg overflow-hidden shadow-2xl",style:{backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",backgroundColor:"#fff"},onClick:k=>k.stopPropagation(),children:c.jsx("img",{src:J.url,alt:J.title,className:"max-w-[85vw] max-h-[80vh] object-contain"})}),c.jsx("div",{className:"mt-4 text-white/60 text-sm",children:"Click outside or press ESC to close"})]})})]})},qw="gRLnCJAV5rWycCc6PKrAUYHb",N3=["nestle.com","unilever.com","pepsico.com","cocacola.com","kellogs.com","kraftheinz.com","danone.com","generalmills.com","mondelez.com","mars.com","ferrero.com","heinz.com","campbells.com","kelloggs.co.uk","walkers.co.uk","cadbury.co.uk","mcvities.co.uk","weetabix.co.uk","muller.co.uk","warburtons.co.uk","hovis.co.uk","primula.co.uk"],I3=["tesco.com","sainsburys.co.uk","asda.com","morrisons.com","waitrose.com","ocado.com","amazon.co.uk","ebay.co.uk"];async function WC(e,t,s=10){let i="";t&&t.trim()?i=`${t} ${e}`:i=e,i=i.replace(/\b(zero sugar|sugar free|no sugar|caffeine free)\b/gi,"").replace(/\b\d+ml\b/gi,"").replace(/\b\d+g\b/gi,"").replace(/\bpack of \d+\b/gi,"").replace(/\bmultipack\b/gi,"").replace(/\s+/g," ").trim(),console.log(`Original: "${t} ${e}"  Cleaned: "${i}"`);try{console.log("[searchSerpApiImages] About to call searchGoogleImagesViaSearchAPI with query:",i);const r=await _3(i,s);return console.log("[searchSerpApiImages] Got results back:",r.length),r}catch(r){throw console.error("[searchSerpApiImages] SearchAPI search error:",r),r}}async function _3(e,t){var l;console.log("[searchGoogleImagesViaSearchAPI] ENTRY - query:",e,"maxResults:",t),console.log("[searchGoogleImagesViaSearchAPI] API KEY exists:",qw.length>0);const s=new URLSearchParams({api_key:qw,engine:"google_images",q:e,hl:"en",gl:"uk",num:String(Math.min(t,20))});console.log("[searchGoogleImagesViaSearchAPI] URL:",`https://www.searchapi.io/api/v1/search?${s}`);const i=await fetch(`https://www.searchapi.io/api/v1/search?${s}`,{method:"GET",headers:{Accept:"application/json"}});if(!i.ok){let u="SearchAPI request failed";try{const h=await i.json();console.error("SearchAPI error response:",h),u=h.error||h.message||u}catch{u=`HTTP ${i.status}: ${i.statusText}`}throw new Error(u)}const r=await i.json();console.log("SearchAPI response for query:",e),console.log("Response keys:",Object.keys(r)),console.log("Number of results:",((l=r.images)==null?void 0:l.length)||0);const n=r.images||[];return n.length===0&&console.warn("No images found in SearchAPI response:",r),n.map((u,h)=>({...u,position:h+1})).map(u=>{var y,R,x,S,T,I,V,j;const h=((y=u.original)==null?void 0:y.link)||u.thumbnail||"";let p="";try{p=((R=u.source)==null?void 0:R.name)||new URL(((x=u.source)==null?void 0:x.link)||h).hostname.replace("www.","")}catch{p=""}const g=N3.some(P=>p.includes(P)),m=I3.some(P=>p.includes(P));let C=50;return g&&(C+=30),u.position<=3&&(C+=10),((S=u.original)==null?void 0:S.width)>800&&(C+=10),((T=u.original)==null?void 0:T.height)>800&&(C+=10),{url:h,thumbnail:u.thumbnail||h,title:u.title||"",domain:p,width:(I=u.original)==null?void 0:I.width,height:(V=u.original)==null?void 0:V.height,isManufacturerSite:g,qualityScore:C,disqualified:m,disqualifyReason:m?`Retailer site (${p})`:void 0,source:(j=u.source)==null?void 0:j.name}}).sort((u,h)=>h.qualityScore-u.qualityScore)}async function zC(e,t){return new Promise((s,i)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{try{let n=function($,K){const Q=$[K],oe=$[K+1],Z=$[K+2],k=$[K+3];if(T++,k<200){R++;return}if(Q>240&&oe>240&&Z>240){y++;return}if(o(Q,oe,Z)){S++,x++;return}x++},o=function($,K,Q){if($>K&&K>Q){const oe=$/K,Z=$/Q;if(oe>1.05&&oe<1.7&&Z>1.2&&Z<2.5){const k=($+K+Q)/3;if(k>60&&k<220)return!0}}return!1};t==null||t(20);const a=document.createElement("canvas"),l=a.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("Could not get canvas context");const u=Math.min(1,400/Math.max(r.width,r.height));a.width=r.width*u,a.height=r.height*u,l.drawImage(r,0,0,a.width,a.height),t==null||t(30);const p=l.getImageData(0,0,a.width,a.height).data,g=p.length/4,m=Math.floor(a.width*.1),C=Math.floor(a.height*.1);let y=0,R=0,x=0,S=0,T=0;for(let $=0;$<C;$++)for(let K=0;K<a.width;K+=2){const Q=($*a.width+K)*4;n(p,Q)}for(let $=a.height-C;$<a.height;$++)for(let K=0;K<a.width;K+=2){const Q=($*a.width+K)*4;n(p,Q)}for(let $=C;$<a.height-C;$+=2){for(let K=0;K<m;K++){const Q=($*a.width+K)*4;n(p,Q)}for(let K=a.width-m;K<a.width;K++){const Q=($*a.width+K)*4;n(p,Q)}}t==null||t(50);const I=T>0?y/T:0,V=T>0?R/T:0,j=I+V,P=T>0?S/T:0,N=I>.7,_=V>.5,L=j>.75,M=P>.05;t==null||t(60);const E=[];let F=!1,J=0;for(let $=1;$<a.height-1;$+=2)for(let K=1;K<a.width-1;K+=2){const Q=($*a.width+K)*4,oe=(p[Q]+p[Q+1]+p[Q+2])/3,Z=Q+4,k=Q+a.width*4;if(Z<p.length&&k<p.length){const O=(p[Z]+p[Z+1]+p[Z+2])/3,W=(p[k]+p[k+1]+p[k+2])/3;(Math.abs(oe-O)>100||Math.abs(oe-W)>100)&&J++}}J/(g/4)>.08&&(F=!0,E.push("Text detected")),t==null||t(75);let fe=0,me=0,pe=0;for(let $=0;$<p.length;$+=16){const K=p[$],Q=p[$+1],oe=p[$+2],Z=Math.max(K,Q,oe),k=Math.min(K,Q,oe),O=Z>0?(Z-k)/Z:0,W=(K+Q+oe)/3;O>.5&&W>150&&(fe++,K>200&&Q<100&&oe<100&&me++,K>200&&Q>180&&oe<100&&pe++)}const ye=fe/(p.length/16),Ae=(me+pe)/(p.length/16);ye>.1&&(F=!0,E.push("Promotional graphics")),Ae>.02&&(F=!0,E.includes("Promotional banner")||E.push("Promotional banner"));let te=0,ce=0;const be=Math.floor(a.width*.2),Ze=Math.floor(a.width*.8),he=Math.floor(a.height*.2),et=Math.floor(a.height*.8);for(let $=he;$<et;$+=3)for(let K=be;K<Ze;K+=3){const Q=($*a.width+K)*4;ce++,o(p[Q],p[Q+1],p[Q+2])&&te++}const We=ce>0?te/ce:0,se=M||We>.03;se&&(F=!0,E.push("Person/hand detected")),t==null||t(90);let ne=0;N?ne+=50:_?ne+=45:L?ne+=30:ne+=0,F?(E.includes("Text detected")&&(ne-=20),E.includes("Promotional graphics")&&(ne-=15),E.includes("Promotional banner")&&(ne-=15),E.includes("Person/hand detected")&&(ne-=30)):ne+=40,se||(ne+=10),ne=Math.max(0,Math.min(100,ne));const B=L&&!F&&!se;t==null||t(100),s({hasWhiteBackground:N||_,backgroundConfidence:Math.round(j*100),hasOverlay:F,overlayTypes:E,isCleanProductShot:B,qualityScore:Math.round(ne)})}catch(n){i(n)}},r.onerror=()=>{i(new Error("Failed to load image for analysis"))},r.src=e})}function k3(){return qw.length>0}function TT(){return`To use SearchAPI Image Search, you need to:

1. Get a SearchAPI API Key:
   - Go to https://www.searchapi.io/
   - Sign up for an account
   - Copy your API key from the dashboard

2. Update .env.local:
   - Add: VITE_SEARCHAPI_KEY=your_api_key_here

Note: SearchAPI has a free tier of 100 searches/month, then paid plans starting at $20/month.`}const DT=[{us:/\bcolor\b/gi,uk:"colour"},{us:/\bflavor\b/gi,uk:"flavour"},{us:/\bfavorite\b/gi,uk:"favourite"},{us:/\bhonor\b/gi,uk:"honour"},{us:/\btheater\b/gi,uk:"theatre"},{us:/\bcenter\b/gi,uk:"centre"},{us:/\bmeter\b/gi,uk:"metre"},{us:/\bliter\b/gi,uk:"litre"},{us:/\bfiber\b/gi,uk:"fibre"},{us:/\bdefense\b/gi,uk:"defence"},{us:/\bpractice\b/gi,uk:"practise"},{us:/\banalyze\b/gi,uk:"analyse"},{us:/\borganize\b/gi,uk:"organise"},{us:/\brealize\b/gi,uk:"realise"},{us:/\bcriticize\b/gi,uk:"criticise"},{us:/\bspecialize\b/gi,uk:"specialise"},{us:/\bcandy\b/gi,uk:"sweets"},{us:/\bcookies?\b/gi,uk:"biscuits"},{us:/\bfries\b/gi,uk:"chips"},{us:/\bchips\b/gi,uk:"crisps"},{us:/\beggplant\b/gi,uk:"aubergine"},{us:/\bzucchini\b/gi,uk:"courgette"},{us:/\bcilantro\b/gi,uk:"coriander"},{us:/\barugula\b/gi,uk:"rocket"},{us:/\bbell pepper\b/gi,uk:"pepper"}],M3=["kraft singles","jell-o","cool whip","velveeta","cheez whiz","pop tarts","goldfish crackers","cheetos","doritos nacho cheese","mountain dew","dr pepper","root beer","gatorade","big red","saltines","graham crackers","hershey","reese's","butterfinger","twinkie","hostess","wonder bread","hawaiian punch","kool-aid"],L3=["tesco","sainsbury","asda","waitrose","morrisons","co-op","marks & spencer","boots","greggs","pret","costa","walkers","cadbury","mcvitie","hobnob","jaffa cake","penguin","yorkshire","tetley","pg tips","hovis","warburtons","kingsmill","heinz beans","branston","marmite","bovril","oxo","bisto","robinsons","ribena","lucozade","irn-bru","vimto","quorn","linda mccartney","richmond","birds eye","galaxy","wispa","crunchie","dairy milk","flake","curly wurly"],ld={easternEuropean:/[]/gi,asian:/[\u4e00-\u9fff\u3040-\u309f\u30a0-\u30ff\uac00-\ud7af]/g,cyrillic:/[--]/g,arabic:/[\u0600-\u06FF]/g,excessiveAccents:/[]/gi};function O3(e,t,s){const i=`${t||""} ${e}`.toLowerCase(),r=[];let n=50;const o=L3.some(R=>i.includes(R.toLowerCase()));o&&(n+=40,r.push("UK brand detected"));const a=M3.some(R=>i.includes(R.toLowerCase()));a&&(n-=40,r.push("US brand detected"));let l=0;for(const R of DT){const x=i.match(R.us);x&&(l+=x.length,r.push(`US spelling: "${x[0]}" (UK: ${R.uk})`))}if(l>0&&(n-=l*15),s&&typeof s=="string"){const R=s.toLowerCase(),x=R.replace(/[,()[\].:;]/g," ").split(/\s+/).filter(I=>I.length>2);let S=0;const T=[];for(const I of DT){const V=R.match(I.us);V&&(S+=V.length,T.push(...V))}if(x.length>0){const I=S/x.length*100;I>5?(n=0,r.push(`REJECT: ${Math.round(I)}% of ingredients use US spelling (${S}/${x.length} words: ${T.join(", ")})`)):I>2?(n-=25,r.push(`Ingredients contain ${Math.round(I)}% US spelling (${S}/${x.length} words: ${T.join(", ")})`)):S>0&&(n-=10,r.push(`Some US spelling in ingredients: ${T.join(", ")}`))}}let u=0;const h=i.match(ld.easternEuropean);h&&(u+=h.length,r.push(`Eastern European characters: ${h.join(", ")}`));const p=i.match(ld.asian);p&&(u+=p.length*2,r.push("Asian characters detected"));const g=i.match(ld.cyrillic);g&&(u+=g.length*2,r.push("Cyrillic characters detected"));const m=i.match(ld.arabic);m&&(u+=m.length*2,r.push("Arabic characters detected"));const C=i.match(ld.excessiveAccents);if(C){const R=C.length/i.length;R>.15?(u+=C.length,r.push(`Excessive accents (${Math.round(R*100)}% of text)`)):R>.05&&R<=.15&&(n-=10,r.push(`Some French accents (${Math.round(R*100)}% - possibly UK French product)`))}return u>0&&(n-=u*5),/\b(ml|cl|litre|gramme?s?)\b/gi.test(i)&&(n+=5),/\b(fl oz|fluid ounce|oz|ounce)\b/gi.test(i)&&(n-=10,r.push("US measurements detected")),/\b(crisps|biscuits|courgette|aubergine)\b/gi.test(i)&&(n+=10,r.push("UK terminology detected")),n=Math.max(0,Math.min(100,n)),{isLikelyUK:n>=40,confidence:n,flags:r,usSpellingCount:l,foreignCharCount:u,ukBrandMatch:o,usBrandMatch:a}}function jd(e,t=40){const s=[],i=[];for(const a of e)O3(a.name,a.brandName,a.ingredients||null).confidence>=t?s.push(a):i.push(a);const r=e.length,n=s.length,o=i.length;return{ukProducts:s,nonUkProducts:i,stats:{total:r,ukCount:n,nonUkCount:o,ukPercentage:r>0?Math.round(n/r*100):0,nonUkPercentage:r>0?Math.round(o/r*100):0}}}const PT="WK0TIF84M2",G3="577cc4ee3fed660318917bbb54abfb2e",V3=({onBack:e})=>{const[t,s]=b.useState([]),[i,r]=b.useState(!1),[n,o]=b.useState(0),[a,l]=b.useState(""),[u,h]=b.useState(!1),[p,g]=b.useState(!1),[m,C]=b.useState("pending"),[y,R]=b.useState(0),[x,S]=b.useState({total:0,completed:0,failed:0,noResults:0,processing:0}),[T,I]=b.useState([]),[V,j]=b.useState(new Set),[P,N]=b.useState(!0),[_,L]=b.useState(!1),[M,E]=b.useState(!1),[F,J]=b.useState(!1),[Y,fe]=b.useState(!1),[me,pe]=b.useState(!1),[ye,Ae]=b.useState(!1),[te,ce]=b.useState(!1),[be,Ze]=b.useState(!1),[he,et]=b.useState(!1),[We,se]=b.useState(!1),[ne,B]=b.useState(null),[$,K]=b.useState(null),[Q,oe]=b.useState(""),[Z,k]=b.useState(!1),[O,W]=b.useState(""),[ue,ae]=b.useState(!1),[X,q]=b.useState(null),ie=b.useRef(!1),we=b.useRef(!1),Ne=50,De="nutrasafe_image_scraper_progress",Ee=b.useRef(null),Oe=b.useCallback(()=>{if(t.length===0)return;const H={savedAt:new Date().toISOString(),foods:t.map(le=>({id:le.id,objectID:le.objectID,name:le.name,brandName:le.brandName,barcode:le.barcode,currentImageUrl:le.currentImageUrl,sourceIndex:le.sourceIndex,status:le.status,selectedImageUrl:le.selectedImageUrl,confidence:le.confidence,nutritionData:le.nutritionData,nutritionStatus:le.nutritionStatus,error:le.error})),stats:x,processingLog:T.slice(-20)};try{localStorage.setItem(De,JSON.stringify(H)),console.log(` Progress saved: ${t.length} foods`)}catch(le){console.warn("Failed to save progress to localStorage:",le)}},[t,x,T]);b.useEffect(()=>{if(t.length!==0)return Ee.current&&clearTimeout(Ee.current),Ee.current=setTimeout(()=>{Oe()},2e3),()=>{Ee.current&&clearTimeout(Ee.current)}},[t,Oe]),b.useEffect(()=>{var H;try{const le=localStorage.getItem(De);if(le){const z=JSON.parse(le),Re=new Date(z.savedAt);if((Date.now()-Re.getTime())/(1e3*60*60)<24&&((H=z.foods)==null?void 0:H.length)>0&&(console.log(` Found saved progress from ${Re.toLocaleString()} (${z.foods.length} foods)`),window.confirm(`Found saved progress from ${Re.toLocaleString()}:
 ${z.foods.length} foods loaded
 ${z.foods.filter(Te=>Te.status==="ready"||Te.status==="completed").length} ready/completed

Restore this progress?`))){const Te=z.foods.map(Ie=>({...Ie,selected:!1,calories:Ie.calories||void 0,dontShowImage:Ie.dontShowImage||!1,searchResults:[],analysis:null,analysisProgress:0}));s(Te),z.stats&&S(z.stats),z.processingLog&&I(z.processingLog),N(!1),console.log(` Restored ${Te.length} foods from saved progress`)}}}catch(le){console.warn("Failed to load saved progress:",le)}},[]);const Ue=b.useCallback(()=>{localStorage.removeItem(De),console.log(" Cleared saved progress")},[]),ze=H=>{if(!H)return!1;const le=H.toLowerCase();return["water","drink","juice","soda","cola","pepsi","coke","tea","coffee","latte","cappuccino","espresso","mocha","beverage","smoothie","shake","milkshake","frappuccino","lemonade","squash","cordial","pop","fizzy","sprite","fanta","irn bru","ribena","lucozade","energy drink","sports drink","vitamin water","iced tea","green tea","black tea","herbal tea","hot chocolate","cocoa drink","chocolate drink","milk drink","flavoured milk","almond milk","oat milk","soy milk","protein shake","meal replacement drink"].some(Re=>le.includes(Re))},re=H=>{console.log(H),I(le=>[...le.slice(-50),`${new Date().toLocaleTimeString()}: ${H}`])},_t=async H=>{try{if(H.barcode){console.log(` Trying Open Food Facts API with barcode: ${H.barcode}`);try{const Ge=await fetch(`https://world.openfoodfacts.org/api/v2/product/${H.barcode}.json`,{headers:{Accept:"application/json"}});if(Ge.ok){const qe=await Ge.json();if(qe.status===1&&qe.product){const lt=qe.product,Nt=lt.nutriments||{},xt=Nt["energy-kcal_serving"]!==void 0||Nt.energy_serving!==void 0;if(xt||Nt["energy-kcal_100g"]!==void 0){const ht=xt,ct=ht?"_serving":"_100g";let Lt;lt.serving_size?Lt=lt.serving_size:lt.serving_quantity&&(Lt=`${lt.serving_quantity}g`);const Ys={calories:Nt[`energy-kcal${ct}`]||(Nt[`energy${ct}`]?Nt[`energy${ct}`]/4.184:void 0),protein:Nt[`proteins${ct}`],carbs:Nt[`carbohydrates${ct}`],fat:Nt[`fat${ct}`],saturatedFat:Nt[`saturated-fat${ct}`],fiber:Nt[`fiber${ct}`],sugar:Nt[`sugars${ct}`],sodium:Nt[`sodium${ct}`],salt:Nt[`salt${ct}`],servingSize:Lt,ingredients:lt.ingredients_text_en||lt.ingredients_text,source:`Open Food Facts (${ht?"per serving":"per 100g"})`},mi=Object.entries(Ys).filter(([bs,Cn])=>Cn!==void 0&&bs!=="source"&&bs!=="ingredients"&&bs!=="servingSize").length;if(mi>=3)return console.log(` Open Food Facts found ${mi} nutrition fields (${ht?"per serving":"per 100g"})`),Lt&&console.log(`    Serving size: ${Lt}`),Ys}}}console.log(`   Open Food Facts: No data found for barcode ${H.barcode}`)}catch(Ge){console.log("   Open Food Facts API error:",Ge)}}const le="gRLnCJAV5rWycCc6PKrAUYHb";let z=`${H.brandName||""} ${H.name} nutrition serving size site:openfoodfacts.org OR site:asda.com`.trim();const Re=new URLSearchParams({api_key:le,engine:"google",q:z,hl:"en",gl:"uk",num:"5"}),de=await fetch(`https://www.searchapi.io/api/v1/search?${Re}`,{method:"GET",headers:{Accept:"application/json"}});if(!de.ok)return console.error("SearchAPI nutrition request failed:",de.status),null;const Ve=await de.json(),Te=Ve.knowledge_graph,Ie=Ve.answer_box;if(Te&&Te.nutrition_facts){const Ge=Te.nutrition_facts;return{calories:parseFloat(Ge.calories)||void 0,protein:parseFloat(Ge.protein)||void 0,carbs:parseFloat(Ge.carbohydrates)||void 0,fat:parseFloat(Ge.fat)||void 0,saturatedFat:parseFloat(Ge.saturated_fat)||void 0,fiber:parseFloat(Ge.fiber)||void 0,sugar:parseFloat(Ge.sugar)||void 0,sodium:parseFloat(Ge.sodium)||void 0,servingSize:Ge.serving_size,source:"Google Knowledge Graph"}}if(Ie&&Ie.nutrition_info){const Ge=Ie.nutrition_info;return{calories:parseFloat(Ge.calories)||void 0,protein:parseFloat(Ge.protein)||void 0,carbs:parseFloat(Ge.carbs)||void 0,fat:parseFloat(Ge.fat)||void 0,source:"Google Answer Box"}}const Ye=Ve.organic_results||[];if(Ye.length>0){let Ge=null;for(let mt=0;mt<Math.min(3,Ye.length);mt++){const zn=Ye[mt].link;if(zn)try{const Rt=`https://corsproxy.io/?${encodeURIComponent(zn)}`;console.log(`Fetching page ${mt+1}: ${zn}`);const vt=await fetch(Rt,{headers:{Accept:"text/html,application/xhtml+xml,application/xml"}});if(!vt.ok){console.log(`Page fetch failed with status ${vt.status}`);continue}const $e=await vt.text();console.log(`Fetched ${$e.length} bytes from page ${mt+1}`);const Qe=$e.toLowerCase(),He=/per\s*100\s*g/i.test(Qe),jt=[...Qe.matchAll(/per\s+[^\s<]{1,20}/gi)];console.log(` Page ${mt+1} - All "per X" patterns found:`,jt.slice(0,10).map(Un=>Un[0]));const At=/per\s+(?!100\s*g)(\d+\s*g\b|piece|bar|slice|serving|portion|biscuit|pack|sachet|pot|unit|item|cookie|cracker|tablet|capsule|scoop)/i.test(Qe),ys=At,Li=He&&!ys;console.log(` Page ${mt+1} - has100g=${He}, hasOtherPerColumn=${At}, hasOnly100g=${Li}`);const rt=Gs($e);if(rt&&Object.keys(rt).length>2){const Un=new URL(zn).hostname.replace("www.","");if(ys){console.log(` Page ${mt+1} has per-serving data - using this source`);const Bs={source:Un};return te&&(rt.calories!==void 0&&(Bs.calories=rt.calories),rt.protein!==void 0&&(Bs.protein=rt.protein),rt.carbs!==void 0&&(Bs.carbs=rt.carbs),rt.fat!==void 0&&(Bs.fat=rt.fat),rt.saturatedFat!==void 0&&(Bs.saturatedFat=rt.saturatedFat),rt.fiber!==void 0&&(Bs.fiber=rt.fiber),rt.sugar!==void 0&&(Bs.sugar=rt.sugar),rt.sodium!==void 0&&(Bs.sodium=rt.sodium),rt.salt!==void 0&&(Bs.salt=rt.salt)),be&&rt.servingSize&&(Bs.servingSize=rt.servingSize),he&&rt.ingredients&&(Bs.ingredients=rt.ingredients),Bs}Li&&!Ge&&(console.log(` Page ${mt+1} only has per-100g data - saving as fallback, trying next site...`),Ge={data:rt,source:Un})}else console.log(`Insufficient nutrition data from page ${mt+1}: ${Object.keys(rt||{}).length} fields`)}catch(Rt){console.log(`Failed to fetch page ${mt+1}:`,Rt instanceof Error?Rt.message:"Unknown error");continue}}if(Ge){console.log(` No per-serving data found in 3 sites - using per-100g fallback from ${Ge.source}`);const mt={source:Ge.source+" (per 100g)"};if(te){const hs=Ge.data;hs.calories!==void 0&&(mt.calories=hs.calories),hs.protein!==void 0&&(mt.protein=hs.protein),hs.carbs!==void 0&&(mt.carbs=hs.carbs),hs.fat!==void 0&&(mt.fat=hs.fat),hs.saturatedFat!==void 0&&(mt.saturatedFat=hs.saturatedFat),hs.fiber!==void 0&&(mt.fiber=hs.fiber),hs.sugar!==void 0&&(mt.sugar=hs.sugar),hs.sodium!==void 0&&(mt.sodium=hs.sodium),hs.salt!==void 0&&(mt.salt=hs.salt)}return be&&Ge.data.servingSize&&(mt.servingSize=Ge.data.servingSize),he&&Ge.data.ingredients&&(mt.ingredients=Ge.data.ingredients),mt}const qe=Ye.slice(0,3).map(mt=>`${mt.snippet||""} ${mt.title||""}`).join(" "),lt=qe.match(/(\d+(?:\.\d+)?)\s*(?:calories|kcal|cal)/i),Nt=qe.match(/(\d+(?:\.\d+)?)\s*g?\s*protein/i),xt=qe.match(/(\d+(?:\.\d+)?)\s*g?\s*(?:carb(?:ohydrate)?s?|carbs)/i),ht=qe.match(/(\d+(?:\.\d+)?)\s*g?\s*(?:total\s+)?fat/i),ct=qe.match(/(\d+(?:\.\d+)?)\s*g?\s*saturated\s*fat/i),Lt=qe.match(/(\d+(?:\.\d+)?)\s*g?\s*(?:fiber|fibre)/i),Ys=qe.match(/(\d+(?:\.\d+)?)\s*g?\s*sugar/i),mi=qe.match(/(\d+(?:\.\d+)?)\s*(?:mg|g)?\s*sodium/i),bs=qe.match(/(\d+(?:\.\d+)?)\s*g?\s*salt/i),Cn=qe.match(/(?:serving\s+size|per\s+serving):\s*([^.,;\n]*?\d+\s*(?:g|ml|oz|fl\s*oz|cup|tbsp|tsp|litre|liter|l)[^.,;\n]*)/i),To=qe.match(/ingredients?[:\s]+([^.]{30,500})/i);if(lt||Nt||xt||ht){const mt={source:"Google Snippets"};return te&&(lt&&(mt.calories=parseFloat(lt[1])),Nt&&(mt.protein=parseFloat(Nt[1])),xt&&(mt.carbs=parseFloat(xt[1])),ht&&(mt.fat=parseFloat(ht[1])),ct&&(mt.saturatedFat=parseFloat(ct[1])),Lt&&(mt.fiber=parseFloat(Lt[1])),Ys&&(mt.sugar=parseFloat(Ys[1])),mi&&(mt.sodium=parseFloat(mi[1])),bs&&(mt.salt=parseFloat(bs[1]))),be&&Cn&&(mt.servingSize=Cn[1].trim()),he&&To&&(mt.ingredients=To[1].trim()),mt}}return null}catch(le){return console.error("Error scraping nutrition from Google:",le),null}},Gs=H=>{var zn;console.log(` Parsing HTML: ${H.length} bytes`);const le=H.toLowerCase(),z={};console.log(" Step 1: Checking for JSON-LD structured data...");const Re=H.matchAll(/<script[^>]*type=["']application\/ld\+json["'][^>]*>(.*?)<\/script>/gis);for(const Rt of Re)try{const vt=JSON.parse(Rt[1]);if(vt.nutrition||vt["@type"]==="NutritionInformation"){const $e=vt.nutrition||vt;if($e.calories&&(z.calories=parseFloat(String($e.calories).replace(/[^0-9.]/g,""))),$e.proteinContent&&(z.protein=parseFloat(String($e.proteinContent).replace(/[^0-9.]/g,""))),$e.carbohydrateContent&&(z.carbs=parseFloat(String($e.carbohydrateContent).replace(/[^0-9.]/g,""))),$e.fatContent&&(z.fat=parseFloat(String($e.fatContent).replace(/[^0-9.]/g,""))),$e.saturatedFatContent&&(z.saturatedFat=parseFloat(String($e.saturatedFatContent).replace(/[^0-9.]/g,""))),$e.fiberContent&&(z.fiber=parseFloat(String($e.fiberContent).replace(/[^0-9.]/g,""))),$e.sugarContent&&(z.sugar=parseFloat(String($e.sugarContent).replace(/[^0-9.]/g,""))),$e.sodiumContent&&(z.sodium=parseFloat(String($e.sodiumContent).replace(/[^0-9.]/g,""))),$e.servingSize&&(z.servingSize=String($e.servingSize)),Object.keys(z).length>=3)return console.log(` Step 1 success: Found ${Object.keys(z).length} fields from JSON-LD`),z}}catch{}console.log(` Step 1 complete: ${Object.keys(z).length} fields from JSON-LD (need 3+ for early return)`),console.log(" Step 2: Checking for per-serving sections (per piece, per bar, per 30g, etc)...");const de=le.match(/(per\s+(?!100\s*g)(?:\d+\s*g|piece|bar|slice|serving|portion|biscuit|pack|sachet|pot|unit|item)[^<]*?(?:<[^>]+>[^<]*?){0,50}?(?:calories|kcal|energy|protein|fat|carb)[^<]*?(?:<[^>]+>[^<]*?){0,100})/gis),Ve=de?null:le.match(/(per\s*100\s*g[^<]*?(?:<[^>]+>[^<]*?){0,50}?(?:calories|kcal|energy|protein|fat|carb)[^<]*?(?:<[^>]+>[^<]*?){0,100})/gis),Te=de||Ve;if(Te){const vt=Te[0].matchAll(/(\w+)[:\s]*(\d+(?:\.\d+)?)\s*(g|mg|kcal)?/gi);for(const $e of vt){const Qe=$e[1].toLowerCase(),He=parseFloat($e[2]);Qe.includes("calor")||Qe.includes("kcal")||Qe.includes("energy")?z.calories=He:Qe.includes("protein")?z.protein=He:Qe.includes("carb")?z.carbs=He:Qe.includes("fat")&&!Qe.includes("saturat")?z.fat=He:Qe.includes("saturat")?z.saturatedFat=He:Qe.includes("sugar")?z.sugar=He:Qe.includes("fib")?z.fiber=He:Qe.includes("sodium")?z.sodium=He:Qe.includes("salt")&&(z.salt=He)}}console.log(` Step 2 complete: ${Object.keys(z).length} fields total`),console.log(" Step 2.5: Extracting from HTML tables (looking for per-serving column)...");const Ie=[...le.matchAll(/per\s+(\d+\s*g|100\s*g|\w+)/gi)],Ye=[];for(const Rt of Ie){const vt=Rt[0].toLowerCase(),$e=/per\s*100\s*g/i.test(vt);Ye.find(Qe=>Qe.text===vt)||Ye.push({text:vt,is100g:$e})}console.log(`   Found ${Ye.length} "per" headers:`,Ye.map(Rt=>Rt.text));let Ge=-1,qe=-1,lt=!1;const Nt=[...H.matchAll(/<tr[^>]*>(.*?)<\/tr>/gis)];for(const Rt of Nt){const $e=[...Rt[1].matchAll(/<t[dh][^>]*>(.*?)<\/t[dh]>/gis)];for(let Qe=0;Qe<$e.length;Qe++){const He=$e[Qe][1].replace(/<[^>]*>/g," ").toLowerCase().trim();console.log(`      Cell ${Qe}: "${He.substring(0,50)}"`),/(?:per|for)[:\s]*100\s*g/i.test(He)||/\b100\s*g\b/i.test(He)?(qe=Qe,console.log(`   Found "per 100g" in column ${Qe}`)):/(?:per|for)[:\s]+(?!100\s*g)/i.test(He)&&!/per\s*kg/i.test(He)&&!/inspiration/i.test(He)&&(Ge=Qe,lt=!0,console.log(`   Found serving column "${He.substring(0,30)}" in column ${Qe}`))}if(qe>=0&&Ge>=0)break}qe>=0&&Ge<0&&(Ge=qe+1,console.log(`   Inferring serving column as ${Ge} (next after per 100g)`));const xt=qe>=0,ht=Ge>=0&&!lt;console.log(`   Table structure: servingCol=${Ge}, per100gCol=${qe}, isMultiColumn=${xt}, servingColInferred=${ht}`);let ct=!1,Lt=!1;const Ys=H.matchAll(/<tr[^>]*>(.*?)<\/tr>/gis);for(const Rt of Ys){const vt=Rt[1],$e=vt.toLowerCase();if(!/calor|kcal|protein|carb|fat|sugar|fib|sodium|salt/i.test($e))continue;const He=[...vt.matchAll(/<t[dh][^>]*>(.*?)<\/t[dh]>/gis)],jt=[];for(let ys=0;ys<He.length;ys++){const Li=He[ys][1],rt=Li.match(/(\d+(?:\.\d+)?)/);rt&&jt.push({index:ys,value:parseFloat(rt[1]),text:Li})}if(jt.length===0)continue;console.log(`   Row cells: ${jt.map(ys=>`[${ys.index}]=${ys.value}`).join(", ")}`);let At=0;if(Ge>=0){const ys=jt.find(Li=>Li.index===Ge);if(ys)At=ys.value,ct=!0,console.log(`    Using serving column ${Ge}: ${At}`);else{Lt=!0,console.log(`    Serving column ${Ge} doesn't exist in data row (cells: ${jt.map(Li=>Li.index).join(",")}) - skipping row to avoid per-100g`);continue}}else if(qe>=0&&jt.length>=2){const ys=jt.find(Li=>Li.index!==qe);ys&&(At=ys.value,ct=!0,console.log(`    Using non-100g column ${ys.index}: ${At}`))}else if(xt&&jt.length>=2)At=jt[1].value,ct=!0,console.log(`    Fallback: using second value: ${At}`);else{console.log("    Single-column table (likely per-100g only) - skipping to find per-serving data");continue}At===0||At>=1e4||(!z.calories&&/calor|kcal|energy/i.test($e)?At<=2e3&&(z.calories=At):!z.protein&&/protein/i.test($e)?At<=200&&(z.protein=At):!z.carbs&&/carb/i.test($e)&&!/fib/i.test($e)?At<=200&&(z.carbs=At):!z.fat&&/\bfat\b/i.test($e)&&!/saturat/i.test($e)?At<=200&&(z.fat=At):!z.saturatedFat&&/saturat/i.test($e)?At<=100&&(z.saturatedFat=At):!z.sugar&&/sugar/i.test($e)?At<=200&&(z.sugar=At):!z.fiber&&/fib/i.test($e)?At<=100&&(z.fiber=At):!z.sodium&&/sodium/i.test($e)?At<=1e4&&(z.sodium=At):!z.salt&&/\bsalt\b/i.test($e)&&!/unsalt/i.test($e)&&At<=20&&(z.salt=At))}let mi=!1;if(Lt&&!ct?(console.log("    Table has per-100g column but inferred serving column doesn't exist in data rows - NO per-serving data extracted"),mi=!0):ct&&console.log("    Successfully extracted per-serving data from table"),!z.servingSize){const Rt=[/serving\s+size[:\s]*(\d+(?:\.\d+)?)\s*(g|ml|oz|fl\s*oz)/gi,/per\s+serving[:\s]*(\d+(?:\.\d+)?)\s*(g|ml)/gi,/per\s+portion[:\s]*(\d+(?:\.\d+)?)\s*(g|ml)/gi,/recommended\s+serving[:\s]*(\d+(?:\.\d+)?)\s*(g|ml)/gi,/typical\s+serving[:\s]*(\d+(?:\.\d+)?)\s*(g|ml)/gi,/serves?\s+(\d+(?:\.\d+)?)\s*(g|ml)/gi,/per\s+(?:piece|portion|bar|slice|biscuit|serving)\s*\((\d+(?:\.\d+)?)\s*(g|ml)\)/gi];for(const vt of Rt){const $e=le.matchAll(vt);for(const Qe of $e)if(Qe[1]&&Qe[2]){const He=parseFloat(Qe[1]),jt=Qe[2].trim();if(He>=1&&He<=5e3){z.servingSize=`${He}${jt}`;break}}if(z.servingSize)break}}if(console.log(` Step 2.5 complete: ${Object.keys(z).length} fields total`),mi)return console.log(" Step 3: SKIPPED - page appears to have per-100g only, trying next site instead"),console.log(` Returning with ${Object.keys(z).length} fields (may be insufficient to trigger fallback)`),z;if(console.log(" Step 3: Aggressive pattern matching for nutrients..."),!z.calories){const Rt=[/calories[:\s]*(\d+(?:\.\d+)?)/gi,/(\d+(?:\.\d+)?)\s*(?:kcal|calories|cal)(?:\s*\/?\s*100\s*g)?/gi,/energy[:\s]*(\d+(?:\.\d+)?)\s*kcal/gi,/per\s*100\s*g[:\s]*(\d+(?:\.\d+)?)\s*cal/gi,/(\d+(?:\.\d+)?)\s*kj\s*\/\s*(\d+(?:\.\d+)?)\s*kcal/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e){const He=Qe[0].match(/(\d+(?:\.\d+)?)\s*kcal/i)||Qe;if(He&&He[1]){const jt=parseFloat(He[1]);if(jt>0&&jt<=900){z.calories=jt;break}}}if(z.calories)break}}if(!z.protein){const Rt=[/protein[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*protein/gi,/protein[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=100){z.protein=He;break}}if(z.protein)break}}if(!z.carbs){const Rt=[/carbohydrate[s]?[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/carbs[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*carb/gi,/carbohydrate[s]?[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=100){z.carbs=He;break}}if(z.carbs)break}}if(!z.fat){const Rt=[/(?:total\s+)?fat[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*(?:total\s+)?fat/gi,/(?:total\s+)?fat[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(!Qe[0].toLowerCase().includes("saturat")&&Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=100){z.fat=He;break}}if(z.fat)break}}if(!z.saturatedFat){const Rt=[/saturated[s]?\s*fat[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/saturates[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/of\s*which\s*saturates[:\s]*(\d+(?:\.\d+)?)/gi,/saturated[s]?\s*fat[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=100){z.saturatedFat=He;break}}if(z.saturatedFat)break}}if(!z.sugar){const Rt=[/sugar[s]?[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*sugar/gi,/of\s*which\s*sugars[:\s]*(\d+(?:\.\d+)?)/gi,/sugar[s]?[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=100){z.sugar=He;break}}if(z.sugar)break}}if(!z.fiber){const Rt=[/fib[re]{2}[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*fib[re]{2}/gi,/fib[re]{2}[:\s<>]*(\d+(?:\.\d+)?)/gi,/dietary\s*fib[re]{2}[:\s]*(\d+(?:\.\d+)?)/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=50){z.fiber=He;break}}if(z.fiber)break}}if(!z.sodium){const Rt=[/sodium[:\s]*(\d+(?:\.\d+)?)\s*mg/gi,/(\d+(?:\.\d+)?)\s*mg\s*sodium/gi,/sodium[:\s<>]*(\d+(?:\.\d+)?)\s*mg/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=5e3){z.sodium=He;break}}if(z.sodium)break}}if(!z.salt){const Rt=[/salt[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*salt/gi,/salt[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const vt of Rt){const $e=[...le.matchAll(vt)];for(const Qe of $e)if(!(Qe[0].toLowerCase().includes("unsalt")||Qe[0].toLowerCase().includes("no salt"))&&Qe[1]){const He=parseFloat(Qe[1]);if(He>=0&&He<=10){z.salt=He;break}}if(z.salt)break}}if(console.log(" Step 4: Extracting ingredients..."),!z.ingredients){const Rt=[/ingredients?[:\s]*([^<.]*(?:flour|sugar|water|salt|oil|milk|egg|butter|corn|wheat|soy|palm)[^<.]*)/gi,/<[^>]*>ingredients?[:\s]*<\/[^>]*>([^<]+)/gi,/(?:contains?|made with)[:\s]*([^<.]*(?:flour|sugar|water|salt|oil|milk)[^<.]*)/gi];for(const $e of Rt){const Qe=[...le.matchAll($e)];for(const He of Qe){const jt=(zn=He[1])==null?void 0:zn.trim();if(jt&&jt.length>20&&jt.length<2e3){const At=jt.replace(/<[^>]+>/g,"").replace(/&[a-z]+;/gi," ").replace(/\s+/g," ").trim();if(At.length>20){z.ingredients=At,console.log(` Found ingredients: ${At.substring(0,100)}...`);break}}}if(z.ingredients)break}const vt=H.match(/"ingredients":\s*"([^"]+)"/i);!z.ingredients&&vt&&(z.ingredients=vt[1].replace(/\\n/g," ").trim(),console.log(` Found ingredients from JSON: ${z.ingredients.substring(0,100)}...`))}console.log(` Step 4 complete: ${z.ingredients?"Found ingredients":"No ingredients"}`);const bs=Object.keys(z).length,Cn=z.calories!==void 0,To=z.protein!==void 0,mt=z.carbs!==void 0,hs=z.fat!==void 0;return console.log(" Final nutrition data:",z),console.log(` Found fields (${bs}): ${Object.keys(z).join(", ")}`),Cn&&(To||mt||hs)?(console.log(` SUCCESS: Found calories + macros (${bs} fields total)`),z):bs>=3?(console.log(` SUCCESS: Found ${bs} fields total`),z):(console.log(` INSUFFICIENT: Only ${bs} fields found, need calories+macro or 3+ fields`),null)};b.useEffect(()=>{const H=k3();L(H),re(H?" SearchAPI configured":" SearchAPI not configured")},[]),b.useEffect(()=>{const H=le=>{le.key==="Escape"&&X&&q(null)};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[X]);const Xt=b.useCallback(async()=>{if(V.size===0){re("No indices selected");return}r(!0),N(!1),o(0),re(" Loading ALL foods from selected indices (with pagination)...");const H=[],le=Array.from(V),z=5e3,Re="https://us-central1-nutrasafe-705c7.cloudfunctions.net";try{for(let Te=0;Te<le.length;Te++){const Ie=le[Te];re(` Loading ${Ie}...`);let Ye=0,Ge=!0,qe=[],lt=0;const Nt=2e3;let xt=0;for(;Ge&&xt<Nt;){xt++,xt>1&&xt%5===0&&re(`   ${Ie}: ${qe.length.toLocaleString()} products pulled, fetching more...`);const ht=await fetch(`${Re}/browseAllIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indices:[Ie],offset:Ye,pageSize:z})});if(!ht.ok){re(` ${Ie}: HTTP ${ht.status}`);break}const ct=await ht.json();if(ct.success&&ct.products){const Lt=ct.products||[],Ys=ct.pagination||{};if(Lt.length===0){re(`   ${Ie}: Reached end (0 products returned)`),Ge=!1;break}Lt.length<z&&(re(`   ${Ie}: Last page (${Lt.length} products)`),Ge=!1),qe.push(...Lt),lt=(Ys==null?void 0:Ys.total)||qe.length;const mi=Math.floor((Te+qe.length/Math.max(lt,1))/le.length*100);o(mi);const bs=lt>0?Math.round(qe.length/lt*100):0;re(`   Page ${xt}: ${qe.length.toLocaleString()} / ${lt.toLocaleString()} (${bs}%)`),Ys.hasMore?(Ge=!0,Ye+=z):(re(`   ${Ie}: Backend says no more data`),Ge=!1),lt>0&&qe.length>=lt&&(re(`   ${Ie}: Reached total count (${qe.length} >= ${lt})`),Ge=!1)}else{re(` ${Ie}: ${ct.error||"Failed"}`);break}}xt>=Nt&&re(` ${Ie}: Hit safety limit (${Nt} iterations)`),re(` ${Ie}: Loaded ${qe.length.toLocaleString()} products`);for(const ht of qe)H.push({id:`${Ie}:${ht.objectID}`,objectID:ht.objectID,name:ht.name||ht.foodName||"Unknown",brandName:ht.brandName||ht.brand||null,barcode:ht.barcode||null,currentImageUrl:ht.imageUrl||null,sourceIndex:Ie,calories:ht.calories,dontShowImage:ht.dontShowImage||!1,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,nutritionData:null,nutritionStatus:"pending",status:"pending",analysisProgress:0});o(Math.round((Te+1)/le.length*100))}re(` Total foods loaded: ${H.length.toLocaleString()}`);let de=H;if(M){const Te=jd(H,40);de=Te.ukProducts,B(Te.stats),re(` UK filter applied: ${Te.stats.ukCount.toLocaleString()} UK products (${Te.stats.ukPercentage}%), ${Te.stats.nonUkCount.toLocaleString()} filtered out (${Te.stats.nonUkPercentage}%)`)}else B(null);const Ve=de.length;if(F){const Te=de.filter(Ye=>Ye.currentImageUrl),Ie=de.filter(Ye=>!Ye.currentImageUrl);K({total:Ve,withImages:Te.length,withoutImages:Ie.length}),de=Ie,re(` Image filter applied: ${Ie.length.toLocaleString()} without images, ${Te.length.toLocaleString()} with images hidden`)}else K(null);if(Y){const Te=de.length;de=de.filter(Ge=>{const qe=Ge.calories!==void 0&&Ge.calories>=0&&Ge.calories<=5;return qe&&me?!ze(Ge.name):qe});const Ie=Te-de.length;re(`0 Very low calorie filter${me?" (drinks excluded)":""}: ${de.length.toLocaleString()} with 0-5 kcal, ${Ie.toLocaleString()} filtered out`)}if(ye){const Te=de.length;de=de.filter(Ye=>Ye.sourceIndex==="tesco_products"?!Ye.dontShowImage:!0);const Ie=Te-de.length;Ie>0&&re(` Tesco bad images filter: ${de.length.toLocaleString()} kept, ${Ie.toLocaleString()} with bad images filtered out`)}s(de),Sr(de),o(100),l("")}catch(de){re(` Error: ${de}`)}finally{r(!1)}},[V,M,F,Y,me,ye]),Pt=b.useCallback(async()=>{if(!O.trim()){re(" No search query entered");return}if(V.size===0){re(" No indices selected");return}ae(!0),r(!0),N(!1),o(0),re(` Searching for: ${O}`);const H=[],le=Array.from(V);try{for(let Re=0;Re<le.length;Re++){const de=le[Re];l(`Searching ${de}...`),o(Math.round(Re/le.length*100));const Ve=`https://${PT}-dsn.algolia.net/1/indexes/${de}/query`;try{const Te=await fetch(Ve,{method:"POST",headers:{"X-Algolia-Application-Id":PT,"X-Algolia-API-Key":G3,"Content-Type":"application/json"},body:JSON.stringify({query:O.trim(),hitsPerPage:1e3,attributesToRetrieve:["objectID","name","foodName","brandName","brand","barcode","imageUrl","calories","dontShowImage"]})});if(!Te.ok){re(`Error searching ${de}: ${Te.status}`);continue}const Ye=(await Te.json()).hits||[];re(`${de}: ${Ye.length} results`);for(const Ge of Ye)H.push({id:`${de}:${Ge.objectID}`,objectID:Ge.objectID,name:Ge.name||Ge.foodName||"Unknown",brandName:Ge.brandName||Ge.brand||null,barcode:Ge.barcode||null,currentImageUrl:Ge.imageUrl||null,sourceIndex:de,calories:Ge.calories,dontShowImage:Ge.dontShowImage||!1,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,nutritionData:null,nutritionStatus:"pending",status:"pending",analysisProgress:0})}catch(Te){re(`Error searching ${de}: ${Te}`)}}re(` Found ${H.length} foods matching "${O}"`);let z=H;if(M){const Re=jd(H,40);z=Re.ukProducts,B(Re.stats),re(` UK Filter: ${Re.ukProducts.length} kept, ${Re.nonUkProducts.length} filtered`)}if(F){const Re=z.filter(Ve=>Ve.currentImageUrl),de=z.filter(Ve=>!Ve.currentImageUrl);K({total:z.length,withImages:Re.length,withoutImages:de.length}),z=de,re(` Image Filter: ${de.length} without images, ${Re.length} with images hidden`)}else K(null);if(Y){const Re=z.length;z=z.filter(Te=>{const Ie=Te.calories!==void 0&&Te.calories>=0&&Te.calories<=5;return Ie&&me?!ze(Te.name):Ie});const de=Re-z.length;re(`0 Very Low Cal Filter${me?" (drinks excluded)":""}: ${z.length} with 0-5 kcal, ${de} filtered out`)}if(ye){const Re=z.length;z=z.filter(Ve=>Ve.sourceIndex==="tesco_products"?!Ve.dontShowImage:!0);const de=Re-z.length;de>0&&re(` Tesco Filter: ${z.length} kept, ${de} bad images filtered`)}s(z),S({total:z.length,completed:0,failed:0,noResults:0,processing:0})}catch(z){re(` Search failed: ${z}`)}finally{ae(!1),r(!1),o(100)}},[O,V,M,F,Y,me,ye,re]),wr=b.useCallback(async()=>{if(!Q.trim()){re(" No barcode entered");return}k(!0),r(!0),N(!1),o(0),re(` Searching for barcode: ${Q}`);try{const{foods:H}=await ZI(Q.trim(),Array.from(V));if(H.length===0){re(` No foods found with barcode: ${Q}`),r(!1),k(!1);return}re(` Found ${H.length} food(s) with barcode ${Q}`),re(` Will search Google Images using barcode: ${Q}`);const le=H.map(z=>({id:z._id,objectID:z.objectID,name:z.name,brandName:z.brandName,barcode:z.barcode,currentImageUrl:z.imageUrl,sourceIndex:z._sourceIndex,calories:z.calories,dontShowImage:z.dontShowImage||!1,selected:!0,searchResults:[],selectedImageUrl:null,analysis:null,nutritionData:null,nutritionStatus:"pending",status:"pending",analysisProgress:0}));s(le),S({total:le.length,completed:0,failed:0,noResults:0,processing:0}),re(` Loaded ${le.length} food(s) for image scraping`),r(!1),k(!1),setTimeout(()=>{_a(le,Q.trim())},500)}catch(H){re(` Barcode search failed: ${H}`),r(!1),k(!1)}},[Q,V,re]),_a=async(H,le)=>{if(!_){re(" SearchAPI not configured. Please set SERP_API_KEY in .env");return}h(!0),ie.current=!1,we.current=!1;const z=H.filter(Re=>Re.selected);if(z.length===0){re("No foods selected for processing"),h(!1);return}re(` Starting image search for ${z.length} food(s) using barcode: ${le}`);for(const Re of z){if(we.current){re(" Processing aborted");break}for(;ie.current;)await new Promise(de=>setTimeout(de,500));try{_s(Re.id,"searching",0),re(` Searching Google Images for barcode: ${le} (${Re.name})`);const de=await WC(le);if(de.length===0){_s(Re.id,"no_results"),re(` No images found for barcode: ${le}`);continue}re(` Found ${de.length} images for ${le}`),s(Ie=>Ie.map(Ye=>Ye.id===Re.id?{...Ye,searchResults:de,status:"analyzing"}:Ye)),_s(Re.id,"analyzing",0);const Ve=[];for(let Ie=0;Ie<de.length;Ie++){const Ye=de[Ie],Ge=Math.round((Ie+1)/de.length*100);_s(Re.id,"analyzing",Ge);try{const qe=await zC(Ye.url);Ve.push({...Ye,analysis:qe})}catch(qe){console.error("Analysis error:",qe)}}const Te=Ve.map(Ie=>{let Ye=0;return Ie.analysis.backgroundConfidence>=95&&Ie.analysis.hasWhiteBackground?Ye=95:(Ie.analysis.hasWhiteBackground&&(Ye+=40),Ie.analysis.hasOverlay||(Ye+=30),Ye+=Math.min(20,Ie.analysis.backgroundConfidence*.2)),Ie.isManufacturerSite&&(Ye+=5),{...Ie,confidence:Ye}}).sort((Ie,Ye)=>Ye.confidence-Ie.confidence);if(Te.length>0){const Ie=Te[0];s(Ye=>Ye.map(Ge=>Ge.id===Re.id?{...Ge,searchResults:Te,selectedImageUrl:Ie.confidence>=80?Ie.url:null,analysis:Ie.analysis,status:Ie.confidence>=80?"ready":"pending",confidence:Ie.confidence}:Ge)),Ie.confidence>=80?re(` ${Re.name}: Auto-selected image (${Ie.confidence}% confidence)`):re(` ${Re.name}: Manual selection needed (${Ie.confidence}% confidence)`)}}catch(de){_s(Re.id,"failed",0,String(de)),re(` Error processing ${Re.name}: ${de}`)}}h(!1),re(" Processing complete")},Sr=H=>{S({total:H.length,completed:H.filter(le=>le.status==="completed").length,failed:H.filter(le=>le.status==="failed").length,noResults:H.filter(le=>le.status==="no_results").length,processing:H.filter(le=>["searching","analyzing","uploading"].includes(le.status)).length})},_s=(H,le,z,Re)=>{s(de=>{const Ve=de.map(Te=>Te.id===H?{...Te,status:le,analysisProgress:z!==void 0?z:Te.analysisProgress,error:Re}:Te);return Sr(Ve),Ve})},Xl=H=>{s(le=>le.map(z=>z.id===H?{...z,selected:!z.selected}:z))},vn=()=>{const H=ds(),le=new Set(H.map(z=>z.id));s(z=>z.map(Re=>le.has(Re.id)?{...Re,selected:!0}:Re))},Eo=()=>{s(H=>H.map(le=>({...le,selected:!1})))},Ro=async H=>{if(we.current)return{...H,status:"pending"};for(;ie.current;)if(await new Promise(z=>setTimeout(z,100)),we.current)return{...H,status:"pending"};const le=H.brandName?`${H.brandName} ${H.name}`:H.name;re(`Searching SearchAPI for: ${le}`);try{s(xt=>xt.map(ht=>ht.id===H.id?{...ht,status:"searching"}:ht));const z=await WC(H.name,H.brandName,10);if(z.length===0)return re(`No results for ${H.name}`),{...H,status:"no_results",searchResults:[],error:"No images found"};re(`Found ${z.length} images for ${H.name}`);const Re=z.filter(xt=>!xt.disqualified);if(Re.length===0)return re(`All images disqualified for ${H.name}`),{...H,status:"no_results",searchResults:z,error:"All images disqualified"};let de=null,Ve=null,Te=0;for(let xt=0;xt<Math.min(Re.length,8);xt++){const ht=Re[xt];re(`Analyzing result ${xt+1}/${Re.length} for ${H.name} (${ht.domain})`),s(ct=>ct.map(Lt=>Lt.id===H.id?{...Lt,status:"analyzing",searchResults:z,selectedImageUrl:ht.url}:Lt));try{const ct=await zC(ht.url,Ys=>{s(mi=>mi.map(bs=>bs.id===H.id?{...bs,analysisProgress:Ys}:bs))});let Lt=0;if(ct.backgroundConfidence>=95&&ct.hasWhiteBackground?Lt=95:(ct.hasWhiteBackground&&(Lt+=40),ct.hasOverlay||(Lt+=30),Lt+=Math.min(20,ct.backgroundConfidence*.2)),ht.isManufacturerSite&&(Lt+=5),re(`Analysis: ${H.name} - Confidence: ${Math.round(Lt)}% (BG: ${ct.backgroundConfidence}%, Overlay: ${ct.hasOverlay?"Yes":"No"})`),Lt>=80){re(` High confidence (${Math.round(Lt)}%) - Auto-selecting`),de=ht,Ve=ct,Te=Lt;break}Lt>Te&&(de=ht,Ve=ct,Te=Lt)}catch(ct){re(`Failed to analyze image from ${ht.domain}: ${ct instanceof Error?ct.message:"CORS error"}`);continue}}if(!de||!Ve)return re(`Could not analyze any images for ${H.name} (CORS blocked)`),{...H,searchResults:z,status:"failed",error:"All images blocked by CORS"};const Ie=Math.round(Te),Ye=Ie>=80?"ready":"analyzing",Ge=Ie>=80?` High confidence (${Ie}%) - Ready to use`:` Low confidence (${Ie}%) - Review needed`;re(Ge);const qe=z.map(xt=>({...xt,isBestResult:xt.url===de.url}));let lt=null,Nt="pending";if(te||be||he){const xt=[];te&&xt.push("nutrition"),be&&xt.push("serving size"),he&&xt.push("ingredients"),re(` Scraping ${xt.join(", ")} for ${H.name}...`),s(ht=>ht.map(ct=>ct.id===H.id?{...ct,nutritionStatus:"searching"}:ct)),lt=await _t(H),lt?(H.sourceIndex==="fast_foods_database"&&!lt.servingSize&&(lt.servingSize="per unit",re(' Fast food item - defaulting to "per unit" serving size')),Nt="found",re(` Nutrition found for ${H.name} (${lt.source})`)):(Nt="not_found",re(` No nutrition data found for ${H.name}`))}return{...H,searchResults:qe,selectedImageUrl:de.url,analysis:Ve,nutritionData:lt,nutritionStatus:Nt,status:Ye,confidence:Ie,error:Ie<80?`Low confidence (${Ie}%) - ${Ve.overlayTypes.join(", ")||"Check image quality"}`:void 0,analysisProgress:100}}catch(z){return re(`Error searching ${H.name}: ${z}`),{...H,status:"failed",error:z instanceof Error?z.message:String(z)}}},jr=async()=>{h(!0),ie.current=!1,we.current=!1;const H=t.filter(z=>z.selected),le=H.length>0?H:t.filter(z=>z.status==="pending"||z.nutritionStatus==="pending");if(re(` Starting nutrition scraping for ${le.length} foods`),le.length===0){re("No foods to process!"),h(!1);return}for(let z=0;z<le.length;z++){if(we.current){re("Nutrition scraping stopped by user");break}const Re=le[z];re(`[${z+1}/${le.length}] Scraping nutrition for ${Re.name}...`),s(Ve=>Ve.map(Te=>Te.id===Re.id?{...Te,nutritionStatus:"searching"}:Te));const de=await _t(Re);if(de){Re.sourceIndex==="fast_foods_database"&&!de.servingSize&&(de.servingSize="per unit",re(' Fast food item - defaulting to "per unit" serving size')),s(Te=>Te.map(Ie=>Ie.id===Re.id?{...Ie,nutritionData:de,nutritionStatus:"found",status:"uploading"}:Ie));const Ve=[];de.calories!==void 0&&Ve.push("calories"),de.protein!==void 0&&Ve.push("protein"),de.carbs!==void 0&&Ve.push("carbs"),de.fat!==void 0&&Ve.push("fat"),de.sugar!==void 0&&Ve.push("sugar"),de.fiber!==void 0&&Ve.push("fiber"),de.servingSize&&Ve.push(`serving: ${de.servingSize}`),de.ingredients&&Ve.push("ingredients"),re(` ${Re.name}: Found ${Ve.length} fields (${de.source}) ${de.servingSize?"":""}${de.ingredients?"":""}`),de.servingSize&&re(`   Serving size: ${de.servingSize}`),de.ingredients&&re(`   Ingredients: ${de.ingredients.substring(0,100)}...`);try{re(` Saving nutrition for ${Re.name}...`);const Te=Re.sourceIndex==="fast_foods_database";let Ie=null;if(Te){const qe=Re.name.toLowerCase();let lt="item";if(qe.includes("burger")?lt="burger":qe.includes("sandwich")?lt="sandwich":qe.includes("wrap")?lt="wrap":qe.includes("salad")?lt="salad":qe.includes("fries")||qe.includes("chips")||qe.includes("nugget")?lt="serving":qe.includes("pizza")&&(lt="pizza"),de.servingSize){const Nt=typeof de.servingSize=="number"?`${de.servingSize}g`:de.servingSize;Ie=`${lt} (${Nt})`}else Ie=lt}const Ye=Te?{calories:de.calories??null,protein:de.protein??null,carbs:de.carbs??null,fat:de.fat??null,saturatedFat:de.saturatedFat??null,fiber:de.fiber??null,sugar:de.sugar??null,sodium:de.sodium??null,salt:de.salt??null,servingSizeG:1,servingDescription:Ie,isPerUnit:!0,ingredients:de.ingredients??null}:{calories:de.calories,protein:de.protein,carbs:de.carbs,fat:de.fat,saturatedFat:de.saturatedFat,fiber:de.fiber,sugar:de.sugar,sodium:de.sodium,salt:de.salt,...(()=>{const qe=de.servingSize;if(!qe)return{};const lt=String(qe).match(/\((\d+(?:\.\d+)?)\s*g\)/i);if(lt){const xt=parseFloat(lt[1]),ht=String(qe).replace(/\s*\(\d+(?:\.\d+)?\s*g\)\s*/i,"").trim();return{servingSizeG:xt,servingDescription:ht||"per serving"}}const Nt=String(qe).match(/^(\d+(?:\.\d+)?)\s*g$/i);return Nt?{servingSizeG:parseFloat(Nt[1]),servingDescription:"per serving"}:typeof qe=="number"?{servingSizeG:qe,servingDescription:"per serving"}:{servingDescription:String(qe)}})(),ingredients:de.ingredients};Te&&(re(` Fast food mode: Setting isPerUnit=true, servingSizeG=1, description="${Ie}"`),re("   Nutrition values are for FULL UNIT (not per 100g) - won't be multiplied by grams"));const Ge=await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/updateFoodNutrition",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:Re.sourceIndex,objectID:Re.objectID,nutritionData:Ye})});if(!Ge.ok)throw new Error(`HTTP ${Ge.status}`);s(qe=>qe.map(lt=>lt.id===Re.id?{...lt,status:"completed"}:lt)),re(` ${Re.name}: Saved to database`)}catch(Te){re(` ${Re.name}: Nutrition found but save failed - ${Te}`),s(Ie=>Ie.map(Ye=>Ye.id===Re.id?{...Ye,status:"ready",error:"Save failed"}:Ye))}}else s(Ve=>Ve.map(Te=>Te.id===Re.id?{...Te,nutritionStatus:"not_found",status:"failed"}:Te)),re(` ${Re.name}: No nutrition data found`);await new Promise(Ve=>setTimeout(Ve,500))}re(" Nutrition scraping complete"),h(!1),g(!1)},ka=async()=>{if(We)return jr();if(!_){alert("Please configure SearchAPI first. See the console log for instructions."),re(TT());return}h(!0),ie.current=!1,we.current=!1;const H=t.filter(z=>z.selected),le=H.length>0?H:t.filter(z=>z.status==="pending");if(re(`Starting batch search of ${le.length} foods`),le.length===0){re("No foods to process!"),h(!1);return}for(let z=0;z<le.length;z++){if(we.current){re("Search stopped by user");break}const Re=le[z];re(`[${z+1}/${le.length}] Processing ${Re.name}`);const de=await Ro(Re);s(Ve=>{const Te=Ve.map(Ie=>Ie.id===Re.id?de:Ie);return Sr(Te),Te}),await new Promise(Ve=>setTimeout(Ve,1e3))}re("Batch search complete"),h(!1),g(!1)},Ma=()=>{ie.current=!0,g(!0),re("Paused")},La=()=>{ie.current=!1,g(!1),re("Resumed")},Wr=()=>{we.current=!0,h(!1),g(!1),re("Stopped")},fi=b.useCallback(async()=>{if(!_){re(" SearchAPI not configured. Please set SERP_API_KEY in .env");return}h(!0),ie.current=!1,we.current=!1;const H=t.filter(z=>z.selected),le=H.length>0?H:t.filter(z=>z.status==="pending");if(le.length===0){re("No foods to process!"),h(!1);return}re(` Starting barcode-based image search for ${le.length} food(s)`);for(let z=0;z<le.length;z++){if(we.current){re("Search stopped by user");break}const Re=le[z];if(!Re.barcode){re(`[${z+1}/${le.length}]  ${Re.name} - No barcode, skipping`),s(de=>de.map(Ve=>Ve.id===Re.id?{...Ve,status:"failed",error:"No barcode"}:Ve));continue}re(`[${z+1}/${le.length}] ${Re.name} - Using barcode: ${Re.barcode}`),s(de=>de.map(Ve=>Ve.id===Re.id?{...Ve,status:"searching"}:Ve));try{const de=await WC(Re.barcode,Re.brandName||void 0);if(de.length===0)re("   No results found"),s(Ve=>Ve.map(Te=>Te.id===Re.id?{...Te,status:"no_results"}:Te));else{re(`   Found ${de.length} images`),s(Ie=>Ie.map(Ye=>Ye.id===Re.id?{...Ye,status:"analyzing",searchResults:de}:Ye));const Te=(await Promise.all(de.map(Ie=>zC(Ie.url)))).map((Ie,Ye)=>({analysis:Ie,result:de[Ye]})).sort((Ie,Ye)=>Ye.analysis.qualityScore-Ie.analysis.qualityScore)[0];Te&&Te.analysis.qualityScore>=70?(re(`   Best image: ${Te.analysis.qualityScore}% confidence`),s(Ie=>Ie.map(Ye=>Ye.id===Re.id?{...Ye,status:"ready",selectedImageUrl:Te.result.url,analysis:Te.analysis,confidence:Te.analysis.qualityScore}:Ye))):(re(`   Low quality images (best: ${(Te==null?void 0:Te.analysis.qualityScore)||0}%)`),s(Ie=>Ie.map(Ye=>Ye.id===Re.id?{...Ye,status:"ready",analysis:(Te==null?void 0:Te.analysis)||null,confidence:(Te==null?void 0:Te.analysis.qualityScore)||0}:Ye)))}}catch(de){re(`   Error: ${de instanceof Error?de.message:"Unknown error"}`),s(Ve=>Ve.map(Te=>Te.id===Re.id?{...Te,status:"failed",error:"Search failed"}:Te))}s(de=>(Sr(de),de)),await new Promise(de=>setTimeout(de,1e3))}re("Barcode image search complete"),h(!1),g(!1)},[t,_,re]),ds=b.useCallback(()=>{let H=t;switch(m){case"pending":H=H.filter(le=>le.status==="pending");break;case"ready":H=H.filter(le=>le.status==="ready");break;case"selected":H=H.filter(le=>le.selected);break;case"nutrition_found":H=H.filter(le=>le.nutritionStatus==="found");break;case"nutrition_failed":H=H.filter(le=>le.nutritionStatus==="not_found"||le.nutritionStatus==="failed");break}if(O.trim()){const le=O.toLowerCase().trim();H=H.filter(z=>{var Re,de;return z.name.toLowerCase().includes(le)||((Re=z.brandName)==null?void 0:Re.toLowerCase().includes(le))||((de=z.barcode)==null?void 0:de.includes(le))||z.objectID.toLowerCase().includes(le)})}return H},[t,m,O]),sr=ds(),zr=sr.slice(y*Ne,(y+1)*Ne),Ks=Math.ceil(sr.length/Ne),Vs=t.filter(H=>H.selected).length,Ur=t.filter(H=>H.status==="pending").length,xr=t.filter(H=>H.status==="ready").length,bv=t.filter(H=>H.nutritionStatus==="found").length,Ev=t.filter(H=>H.nutritionStatus==="not_found"||H.nutritionStatus==="failed").length,zu={pending:"bg-gray-100 text-gray-600",searching:"bg-blue-100 text-blue-600",analyzing:"bg-yellow-100 text-yellow-600",ready:"bg-green-100 text-green-600",uploading:"bg-purple-100 text-purple-600",completed:"bg-green-500 text-white",failed:"bg-red-100 text-red-600",no_results:"bg-gray-200 text-gray-500"},Rv={pending:"Pending",searching:"Searching...",analyzing:"Analyzing...",ready:"Ready",uploading:"Uploading...",completed:"Done",failed:"Failed",no_results:"No Results"};return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Google Image Scraper"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Find official white background product images from manufacturer sites"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[t.length>0&&!u&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>{s([]),N(!0),S({total:0,completed:0,failed:0,noResults:0,processing:0})},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Change Indices"]}),c.jsxs("button",{onClick:()=>{confirm("Clear saved progress? This will remove your saved state from browser storage.")&&(Ue(),s([]),N(!0),S({total:0,completed:0,failed:0,noResults:0,processing:0}),I([]))},className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg",title:"Clear saved progress from browser storage",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear Saved"]})]}),c.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm ${_?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${_?"bg-green-500":"bg-red-500"}`}),_?"API Configured":"API Not Configured"]}),u?c.jsxs(c.Fragment,{children:[p?c.jsx("button",{onClick:La,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Resume"}):c.jsx("button",{onClick:Ma,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700",children:"Pause"}),c.jsx("button",{onClick:Wr,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Stop"})]}):c.jsxs(c.Fragment,{children:[t.length>0&&c.jsxs("button",{onClick:fi,disabled:i||!_||Vs===0&&Ur===0,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",title:"Search for images using each food's barcode instead of product name",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),Vs>0?`Search by Barcode (${Vs})`:`Search All by Barcode (${Ur})`]}),c.jsxs("button",{onClick:ka,disabled:i||!We&&!_||Vs===0&&Ur===0,className:"flex items-center gap-2 px-5 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[We?c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),We?Vs>0?`Scrape Nutrition (${Vs})`:`Scrape All Nutrition (${Ur})`:Vs>0?`Search Selected (${Vs})`:`Search All (${Ur})`]}),xr>0&&c.jsxs("button",{onClick:async()=>{const H=t.filter(le=>le.status==="ready"&&le.selectedImageUrl);re(`Starting upload of ${H.length} ready items...`);for(const le of H){s(z=>z.map(Re=>Re.id===le.id?{...Re,status:"uploading"}:Re));try{re(`Uploading ${le.name}...`);const z=await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/uploadFoodImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:le.selectedImageUrl,index:le.sourceIndex,objectID:le.objectID})});if(!z.ok){const de=await z.text();throw new Error(`HTTP ${z.status}: ${de}`)}const Re=await z.json();re(` ${le.name}`),s(de=>de.map(Ve=>Ve.id===le.id?{...Ve,status:"completed",currentImageUrl:Re.imageUrl}:Ve)),await new Promise(de=>setTimeout(de,500))}catch(z){re(` ${le.name}: ${z instanceof Error?z.message:"Unknown error"}`),s(Re=>Re.map(de=>de.id===le.id?{...de,status:"failed",error:"Upload failed"}:de))}}re("Upload batch complete")},className:"flex items-center gap-2 px-5 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload All Ready (",xr,")"]})]})]})]}),c.jsxs("div",{className:"space-y-3",children:[i&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${n}%`}})}),c.jsx("span",{className:"text-sm text-gray-500",children:a||`Loading... ${n}%`})]}),!i&&t.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden flex",children:[c.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${x.completed/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-blue-400 transition-all",style:{width:`${xr/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-red-400 transition-all",style:{width:`${x.failed/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-gray-400 transition-all",style:{width:`${x.noResults/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-yellow-400 animate-pulse",style:{width:`${x.processing/Math.max(x.total,1)*100}%`}})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[c.jsxs("span",{className:"text-gray-600",children:["Total: ",c.jsx("strong",{children:x.total.toLocaleString()})]}),c.jsxs("span",{className:"text-green-600",children:["Completed: ",c.jsx("strong",{children:x.completed.toLocaleString()})]}),c.jsxs("span",{className:"text-blue-600",children:["Ready: ",c.jsx("strong",{children:xr.toLocaleString()})]}),c.jsxs("span",{className:"text-red-600",children:["Failed: ",c.jsx("strong",{children:x.failed.toLocaleString()})]}),c.jsxs("span",{className:"text-gray-500",children:["No Results: ",c.jsx("strong",{children:x.noResults.toLocaleString()})]}),x.processing>0&&c.jsxs("span",{className:"text-yellow-600 animate-pulse",children:["Processing: ",c.jsx("strong",{children:x.processing})]}),Vs>0&&c.jsxs("span",{className:"text-primary-600",children:["Selected: ",c.jsx("strong",{children:Vs})]}),ne&&c.jsxs("span",{className:"text-blue-600",children:[" UK Filter: ",c.jsx("strong",{children:ne.ukCount})," kept (",ne.ukPercentage,"%), ",c.jsx("strong",{children:ne.nonUkCount})," filtered (",ne.nonUkPercentage,"%)"]}),$&&c.jsxs("span",{className:"text-purple-600",children:[" Image Filter: ",c.jsx("strong",{children:$.withoutImages.toLocaleString()})," without images, ",c.jsx("strong",{children:$.withImages.toLocaleString()})," with images hidden"]})]})]})]})]}),c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 flex items-center justify-between",children:[c.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All",count:t.length},{value:"pending",label:"Pending",count:Ur},{value:"ready",label:"Ready",count:xr},{value:"selected",label:"Selected",count:Vs},{value:"nutrition_found",label:" Nutrition Found",count:bv},{value:"nutrition_failed",label:" No Nutrition",count:Ev}].map(H=>c.jsxs("button",{onClick:()=>{C(H.value),R(0)},className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m===H.value?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[H.label," (",H.count.toLocaleString(),")"]},H.value))}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Search foods...",value:O,onChange:H=>{W(H.target.value),R(0)},onKeyDown:H=>{H.key==="Enter"&&O.trim()&&t.length===0&&Pt()},className:"w-64 px-3 py-1.5 pl-9 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),c.jsx("svg",{className:"absolute left-2.5 top-2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),O&&c.jsx("button",{onClick:()=>{W(""),R(0)},className:"absolute right-2 top-2 text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.length===0&&c.jsxs("button",{onClick:Pt,disabled:!O.trim()||ue||V.size===0,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[ue?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Algolia"]}),O&&t.length>0&&c.jsxs("span",{className:"text-xs text-gray-500",children:[sr.length," result",sr.length!==1?"s":""," (filtered)"]}),c.jsx("button",{onClick:vn,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Select All"}),c.jsx("button",{onClick:Eo,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Deselect All"})]})]}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx("div",{className:"flex-1 overflow-auto p-6",children:P&&!i&&t.length===0?c.jsx("div",{className:"max-w-3xl mx-auto",children:c.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 px-6 py-5 text-white",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Google Image Scraper"}),c.jsx("p",{className:"text-primary-100 text-sm mt-1",children:"Search Google for official white background product images from manufacturer sites"})]}),!_&&c.jsx("div",{className:"px-6 py-4 bg-yellow-50 border-b border-yellow-100",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("svg",{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Google API Not Configured"}),c.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"You need a Google API key and Custom Search Engine ID. Check the browser console for setup instructions."}),c.jsx("button",{onClick:()=>re(TT()),className:"mt-2 text-xs text-yellow-800 underline hover:text-yellow-900",children:"Show setup instructions in console"})]})]})}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"1"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Select indices to load foods from"})]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-6",children:Jt.map(H=>c.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${V.has(H)?"border-primary-500 bg-primary-50 shadow-sm":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("input",{type:"checkbox",checked:V.has(H),onChange:()=>{j(le=>{const z=new Set(le);return z.has(H)?z.delete(H):z.add(H),z})},className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"text-sm font-medium text-gray-700 truncate",children:H.replace(/_/g," ")})]},H))}),c.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-6 border-b border-gray-200",children:[c.jsx("button",{onClick:()=>j(new Set(Jt)),className:"px-3 py-1.5 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:"Select All"}),c.jsx("button",{onClick:()=>j(new Set),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear All"}),c.jsxs("span",{className:"text-sm text-gray-400",children:[V.size," of ",Jt.length," selected"]})]}),c.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"2"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Filter products by region"})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-blue-200 bg-blue-50 cursor-pointer hover:bg-blue-100 transition-colors",children:[c.jsx("input",{type:"checkbox",checked:M,onChange:H=>E(H.target.checked),className:"w-4 h-4 text-blue-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" UK Products Only"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-blue-700 bg-blue-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Filter out non-UK products before searching images. Detects US spelling (color vs colour), foreign languages, and non-UK brands. Allows up to 10% non-UK content to include French-named UK products (e.g., "crme frache").'})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-purple-200 bg-purple-50 cursor-pointer hover:bg-purple-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:F,onChange:H=>J(H.target.checked),className:"w-4 h-4 text-purple-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Hide Foods With Images"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-purple-700 bg-purple-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Only show foods that are missing images. This helps you focus on products that actually need image scraping, saving time and API calls."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-orange-200 bg-orange-50 cursor-pointer hover:bg-orange-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:Y,onChange:H=>fe(H.target.checked),className:"w-4 h-4 text-orange-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:"0 Very Low Calorie (0-5 kcal)"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Only show foods with 0-5 calories per 100g. Catches zero-calorie sweeteners, diet sodas, condiments, and other ultra-low calorie products (including 1-2 kcal items like sugar-free syrups)."})]})]}),Y&&c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-amber-200 bg-amber-50 cursor-pointer hover:bg-amber-100 transition-colors mt-3 ml-6",children:[c.jsx("input",{type:"checkbox",checked:me,onChange:H=>pe(H.target.checked),className:"w-4 h-4 text-amber-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Exclude Drinks"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"When filtering very low calorie items, exclude beverages like water, diet sodas, tea, coffee, and other drinks. Focus on actual food items only."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-red-200 bg-red-50 cursor-pointer hover:bg-red-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:ye,onChange:H=>Ae(H.target.checked),className:"w-4 h-4 text-red-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Hide Tesco Bad Images"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-red-700 bg-red-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:`Hide Tesco products that are marked with "dontShowImage" flag. These have been identified as having poor quality images that shouldn't be displayed.`})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-green-200 bg-green-50 cursor-pointer hover:bg-green-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:te,onChange:H=>ce(H.target.checked),className:"w-4 h-4 text-green-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Scrape Nutrition Data"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-green-700 bg-green-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Automatically fetch nutrition information from Google during processing. Includes calories, protein, carbs, fat, fiber, sugar, and sodium."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-blue-200 bg-blue-50 cursor-pointer hover:bg-blue-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:be,onChange:H=>Ze(H.target.checked),className:"w-4 h-4 text-blue-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Scrape Serving Size"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Extract serving size information (e.g., "100g", "250ml", "1 slice"). Useful for standardizing portion sizes across different products.'})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-purple-200 bg-purple-50 cursor-pointer hover:bg-purple-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:he,onChange:H=>et(H.target.checked),className:"w-4 h-4 text-purple-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Scrape Ingredients"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Automatically extract ingredient lists from product pages. Essential for allergen detection and dietary restrictions."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-teal-200 bg-teal-50 cursor-pointer hover:bg-teal-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:We,onChange:H=>se(H.target.checked),className:"w-4 h-4 text-teal-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Nutrition Only Mode"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Skip image scraping entirely - only search for nutrition data. Much faster and uses fewer API calls. Great for quickly filling in missing nutrition information."})]})]})]}),c.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"3"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Search by barcode or load all"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("input",{type:"text",placeholder:"Enter barcode (e.g., 5000159407236)",value:Q,onChange:H=>oe(H.target.value),onKeyDown:H=>{H.key==="Enter"&&Q.trim()&&wr()},className:"w-full px-4 py-3 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})}),c.jsxs("button",{onClick:wr,disabled:!Q.trim()||Z||V.size===0,className:"flex items-center gap-2 px-5 py-3 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg",children:[Z?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Search"]})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:" Search for a specific product by barcode, or load all foods from selected indices below"})]}),c.jsxs("button",{onClick:Xt,disabled:V.size===0,className:"w-full flex items-center justify-center gap-3 px-6 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 rounded-xl shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none",children:[c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Load All ",V.size>0?`Foods from ${V.size} ${V.size===1?"Index":"Indices"}`:"Foods"]}),V.size===0&&c.jsx("p",{className:"text-center text-sm text-red-500 mt-3",children:"Select at least one index to continue"})]})]})}):i?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("svg",{className:"w-8 h-8 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),c.jsx("span",{className:"text-gray-500",children:a||"Loading foods..."})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid gap-3",children:zr.map(H=>c.jsx("div",{className:`bg-white rounded-lg border p-4 transition-colors ${H.selected?"border-primary-500 bg-primary-50":"border-gray-200"}`,children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("input",{type:"checkbox",checked:H.selected,onChange:()=>Xl(H.id),className:"w-4 h-4 text-primary-600 rounded mt-1"}),c.jsxs("div",{className:"flex-shrink-0",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1 text-center",children:H.selectedImageUrl?"Selected":"Current"}),c.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-primary-400",onClick:()=>{const le=H.selectedImageUrl||H.currentImageUrl;le&&q({url:le,title:`${H.name}`})},children:H.selectedImageUrl?c.jsx("img",{src:H.selectedImageUrl,alt:"",className:"w-full h-full object-contain"}):H.currentImageUrl?c.jsx("img",{src:H.currentImageUrl,alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-xs text-gray-400",children:"None"})})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900",children:H.name}),H.brandName&&c.jsx("div",{className:"text-sm text-gray-500",children:H.brandName}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-1",children:[c.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded",children:H.sourceIndex.replace(/_/g," ")}),H.calories!==void 0&&c.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded",children:[H.calories," cal"]})]}),H.nutritionData&&c.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded text-xs",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("div",{className:"font-semibold text-green-900 flex items-center gap-1",children:[" Nutrition (per 100g)",H.nutritionData.servingSize&&c.jsx("span",{className:"text-blue-600",children:""})]}),c.jsx("div",{className:"text-[10px] text-green-700",children:H.nutritionData.source})]}),H.nutritionData.servingSize&&c.jsxs("div",{className:"px-2 py-1 bg-blue-50 border border-blue-200 rounded text-[11px] text-blue-900 font-medium mb-1",children:[" Serving: ",H.nutritionData.servingSize]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 text-gray-700",children:[H.nutritionData.calories!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Cal:"})," ",H.nutritionData.calories]}),H.nutritionData.protein!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Protein:"})," ",H.nutritionData.protein,"g"]}),H.nutritionData.carbs!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Carbs:"})," ",H.nutritionData.carbs,"g"]}),H.nutritionData.fat!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Fat:"})," ",H.nutritionData.fat,"g"]}),H.nutritionData.saturatedFat!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Sat Fat:"})," ",H.nutritionData.saturatedFat,"g"]}),H.nutritionData.fiber!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Fiber:"})," ",H.nutritionData.fiber,"g"]}),H.nutritionData.sugar!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Sugar:"})," ",H.nutritionData.sugar,"g"]}),H.nutritionData.sodium!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Sodium:"})," ",H.nutritionData.sodium,"mg"]}),H.nutritionData.salt!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Salt:"})," ",H.nutritionData.salt,"g"]})]})]}),H.nutritionStatus!=="pending"&&!H.nutritionData&&c.jsx("div",{className:"mt-2 text-xs",children:c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded ${H.nutritionStatus==="searching"?"bg-blue-100 text-blue-700":H.nutritionStatus==="not_found"?"bg-yellow-100 text-yellow-700":H.nutritionStatus==="failed"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:[H.nutritionStatus==="searching"&&" Searching nutrition...",H.nutritionStatus==="not_found"&&" No nutrition data found",H.nutritionStatus==="failed"&&" Nutrition search failed"]})}),H.searchResults.length>0&&c.jsxs("div",{className:"mt-3",children:[c.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Found ",H.searchResults.length," images",H.confidence!==void 0&&c.jsxs("span",{className:`ml-2 font-semibold ${H.confidence>=80?"text-green-600":H.confidence>=60?"text-yellow-600":"text-red-600"}`,children:[H.confidence>=80?"":""," ",H.confidence,"% confidence"]})]}),c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:H.searchResults.slice(0,10).map((le,z)=>c.jsxs("div",{className:"flex-shrink-0 relative group",children:[c.jsx("div",{className:`w-20 h-20 bg-gray-100 rounded overflow-hidden cursor-pointer hover:ring-2 hover:ring-blue-400 ${H.selectedImageUrl===le.url?"ring-2 ring-primary-500":""}`,onClick:()=>{q({url:le.url,title:`${H.name} - Result ${z+1} (${le.domain})`})},children:c.jsx("img",{src:le.thumbnail,alt:"",className:"w-full h-full object-cover"})}),le.isManufacturerSite&&c.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-green-500 rounded-full flex items-center justify-center",children:c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),H.selectedImageUrl===le.url&&c.jsx("div",{className:"absolute inset-0 bg-primary-500/20 rounded flex items-center justify-center",children:c.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),c.jsx("button",{onClick:Re=>{Re.stopPropagation(),s(de=>de.map(Ve=>Ve.id===H.id?{...Ve,selectedImageUrl:le.url,status:"ready",error:void 0}:Ve)),re(`Selected image for ${H.name} - ready for upload`)},className:"absolute bottom-0 left-0 right-0 bg-primary-600 text-white text-[9px] py-0.5 hover:bg-primary-700 opacity-0 group-hover:opacity-100 transition-opacity",children:"Select This"}),c.jsx("div",{className:"text-[8px] text-gray-400 mt-0.5 truncate w-20 text-center",children:le.domain})]},z))})]})]}),c.jsxs("div",{className:"flex-shrink-0 text-right",children:[c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${zu[H.status]}`,children:[["searching","analyzing","uploading"].includes(H.status)&&c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),Rv[H.status]]}),H.status==="analyzing"&&c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[H.analysisProgress,"%"]}),H.error&&c.jsx("div",{className:"text-[10px] text-red-500 mt-1 max-w-[120px]",title:H.error,children:H.error})]})]})},H.id))}),Ks>1&&c.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[c.jsx("button",{onClick:()=>R(H=>Math.max(0,H-1)),disabled:y===0,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",y+1," of ",Ks]}),c.jsx("button",{onClick:()=>R(H=>Math.min(Ks-1,H+1)),disabled:y>=Ks-1,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})]})}),c.jsxs("div",{className:"w-80 border-l border-gray-200 bg-gray-900 flex flex-col",children:[c.jsx("div",{className:"px-4 py-2 border-b border-gray-700 text-gray-400 text-xs font-medium uppercase",children:"Processing Log"}),c.jsx("div",{className:"flex-1 overflow-auto p-3 font-mono text-xs text-gray-300 space-y-1",children:T.length===0?c.jsx("div",{className:"text-gray-500",children:"No activity yet..."}):T.map((H,le)=>c.jsx("div",{className:"break-all",children:H},le))})]})]}),X&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:()=>q(null),children:c.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] flex flex-col items-center",children:[c.jsx("button",{onClick:()=>q(null),className:"absolute -top-12 right-0 p-2 text-white/80 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsx("div",{className:"absolute -top-12 left-0 text-white font-medium",children:X.title}),c.jsx("div",{className:"rounded-lg overflow-hidden shadow-2xl",style:{backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",backgroundColor:"#fff"},onClick:H=>H.stopPropagation(),children:c.jsx("img",{src:X.url,alt:X.title,className:"max-w-[85vw] max-h-[80vh] object-contain"})}),X.analysis&&c.jsxs("div",{className:"mt-4 bg-white/10 backdrop-blur-md rounded-lg px-4 py-3 text-white text-sm",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:["Background: ",X.analysis.hasWhiteBackground?"":""," White (",X.analysis.backgroundConfidence,"%)"]}),c.jsxs("span",{children:["Overlay: ",X.analysis.hasOverlay?" Yes":" None"]}),c.jsxs("span",{children:["Quality: ",X.analysis.qualityScore,"/100"]})]}),X.analysis.overlayTypes.length>0&&c.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Issues: ",X.analysis.overlayTypes.join(", ")]})]}),c.jsx("div",{className:"mt-4 text-white/60 text-sm",children:"Click outside or press ESC to close"})]})})]})},Ba="https://us-central1-nutrasafe-705c7.cloudfunctions.net",B3=({onBack:e})=>{var se,ne;const[t,s]=b.useState([]),[i,r]=b.useState(!0),[n,o]=b.useState("pending"),[a,l]=b.useState(null),[u,h]=b.useState(new Set),[p,g]=b.useState(null),[m,C]=b.useState(!1),[y,R]=b.useState(!1),[x,S]=b.useState(null),[T,I]=b.useState("g"),V=Pe.useRef(null),[j,P]=b.useState(null),N=(B,$)=>{S({message:B,type:$}),setTimeout(()=>S(null),3e3)},_=(B,$,K)=>B,L=()=>{const B=T==="g"?"ml":"g";if(I(B),p){const $=parseFloat(p.servingSizeG)||0,K=_($,p.servingUnit,B);g({...p,servingUnit:B,servingSizeG:K.toString()})}N(`Switched to ${B.toUpperCase()} mode`,"info")},M=b.useCallback(async()=>{const B=i;r(!!B);try{const K=await(await fetch(`${Ba}/getUserReports`)).json();if(K.success){const Q=K.reports||[],oe=Q.filter(Z=>Z.status==="pending").length;if(V.current!==null&&oe>V.current){const Z=oe-V.current;N(` ${Z} new report${Z>1?"s":""} received!`,"info")}V.current=oe,s(Q),P(new Date)}else B&&N("Error loading reports","error")}catch($){console.error("Error loading reports:",$),B&&N("Error loading reports","error")}finally{r(!1)}},[i]);b.useEffect(()=>{M()},[M]),b.useEffect(()=>{const B=setInterval(()=>{M()},3e4);return()=>clearInterval(B)},[M]);const E=t.filter(B=>n==="all"?!0:B.status===n),F={all:t.length,pending:t.filter(B=>B.status==="pending").length,in_progress:t.filter(B=>B.status==="in_progress").length,resolved:t.filter(B=>B.status==="resolved").length,dismissed:t.filter(B=>B.status==="dismissed").length},J=async B=>{var O,W,ue,ae,X,q,ie,we,Ne,De,Ee;l(B);const $=((O=B.food)==null?void 0:O.id)||((W=B.food)==null?void 0:W.objectID)||B.foodId;let K=null;if($)try{K=await Yj($)}catch(Oe){console.error("Error fetching full food from Algolia:",Oe)}const Q=K||B.food||{},oe=Q.servingUnit==="ml"?"ml":"g";I(oe);const Z=Q.brandName||Q.brand||B.brandName||"",k=Array.isArray(Q.ingredients)?Q.ingredients.join(", "):Q.ingredientsText||Q.ingredients||"";g({name:Q.name||B.foodName||"",brandName:Z,barcode:Q.barcode||B.barcode||"",servingDescription:Q.servingDescription||"",servingSizeG:((ue=Q.servingSizeG)==null?void 0:ue.toString())||"",servingUnit:oe,category:Q.category||"",ingredients:k,calories:((ae=Q.calories)==null?void 0:ae.toString())||"",protein:((X=Q.protein)==null?void 0:X.toString())||"",carbs:((q=Q.carbs)==null?void 0:q.toString())||"",fat:((ie=Q.fat)==null?void 0:ie.toString())||"",fiber:((we=Q.fiber)==null?void 0:we.toString())||"",sugar:((Ne=Q.sugar)==null?void 0:Ne.toString())||"",salt:((De=Q.salt)==null?void 0:De.toString())||"",saturatedFat:((Ee=Q.saturatedFat)==null?void 0:Ee.toString())||"",imageUrl:Q.imageUrl||""})},Y=()=>{l(null),g(null)},fe=async()=>{if(!(!a||!p)){R(!0);try{const B=p.name,$=p.brandName,Q=await(await fetch(`${Ba}/aiAnalyzeFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:B,brand:$})})).json();if(Q.success&&Q.data){const{suggestions:oe,nutrition:Z}=Q.data;g(k=>k&&{...k,...(oe==null?void 0:oe.foodName)&&{name:oe.foodName},...(oe==null?void 0:oe.brandName)&&{brandName:oe.brandName},...(oe==null?void 0:oe.barcode)&&{barcode:oe.barcode},...(oe==null?void 0:oe.servingSize)&&{servingDescription:oe.servingSize},...(oe==null?void 0:oe.ingredients)&&{ingredients:Array.isArray(oe.ingredients)?oe.ingredients.join(", "):oe.ingredients},...(Z==null?void 0:Z.calories)!==void 0&&{calories:Z.calories.toString()},...(Z==null?void 0:Z.protein)!==void 0&&{protein:Z.protein.toString()},...(Z==null?void 0:Z.carbohydrates)!==void 0&&{carbs:Z.carbohydrates.toString()},...(Z==null?void 0:Z.fat)!==void 0&&{fat:Z.fat.toString()},...(Z==null?void 0:Z.fiber)!==void 0&&{fiber:Z.fiber.toString()},...(Z==null?void 0:Z.sugar)!==void 0&&{sugar:Z.sugar.toString()},...(Z==null?void 0:Z.salt)!==void 0&&{salt:Z.salt.toString()},...(Z==null?void 0:Z.saturatedFat)!==void 0&&{saturatedFat:Z.saturatedFat.toString()}}),N("AI suggestions applied","success")}else N("No AI suggestions available","info")}catch(B){console.error("Error getting AI suggestions:",B),N("Error getting AI suggestions","error")}finally{R(!1)}}},me=async(B=!1)=>{var $,K,Q;if(!(!a||!p)){C(!0);try{const oe=(($=a.food)==null?void 0:$.id)||((K=a.food)==null?void 0:K.objectID)||a.foodId,Z=((Q=a.food)==null?void 0:Q._sourceIndex)||a.sourceIndex||"uk_foods_cleaned",k={foodId:oe,indexName:Z,updates:{foodName:p.name,brandName:p.brandName,barcode:p.barcode,servingSize:p.servingDescription,servingSizeG:parseFloat(p.servingSizeG)||null,servingUnit:p.servingUnit,category:p.category,ingredients:p.ingredients.split(",").map(ue=>ue.trim()).filter(ue=>ue),imageUrl:p.imageUrl||null,nutrition:{calories:parseFloat(p.calories)||null,protein:parseFloat(p.protein)||null,carbs:parseFloat(p.carbs)||null,fat:parseFloat(p.fat)||null,fiber:parseFloat(p.fiber)||null,sugar:parseFloat(p.sugar)||null,salt:parseFloat(p.salt)||null,sodium:Math.round((parseFloat(p.salt)||0)*1e3/2.5)||null,saturatedFat:parseFloat(p.saturatedFat)||null}}},W=await(await fetch(`${Ba}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)})).json();W.success?(N("Food saved successfully","success"),B&&(await pe(a.id,"resolved"),Y())):N(W.error||"Error saving food","error")}catch(oe){console.error("Error saving food:",oe),N("Error saving food","error")}finally{C(!1)}}},pe=async(B,$)=>{try{(await(await fetch(`${Ba}/updateUserReport`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportId:B,status:$})})).json()).success?(s(oe=>oe.map(Z=>Z.id===B?{...Z,status:$}:Z)),N("Report updated","success")):N("Error updating report","error")}catch(K){console.error("Error updating report:",K),N("Error updating report","error")}},ye=async()=>{a&&(await pe(a.id,"dismissed"),Y())},Ae=async B=>{if(confirm("Delete this report? This cannot be undone."))try{(await(await fetch(`${Ba}/deleteUserReport`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportId:B})})).json()).success?(s(Q=>Q.filter(oe=>oe.id!==B)),(a==null?void 0:a.id)===B&&Y(),N("Report deleted","success")):N("Error deleting report","error")}catch($){console.error("Error deleting report:",$),N("Error deleting report","error")}},te=async()=>{var B,$,K;if(a&&confirm("Delete this food from the database? This cannot be undone."))try{const Q=((B=a.food)==null?void 0:B.id)||(($=a.food)==null?void 0:$.objectID)||a.foodId,oe=((K=a.food)==null?void 0:K._sourceIndex)||a.sourceIndex||"uk_foods_cleaned",k=await(await fetch(`${Ba}/deleteFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:Q,indexName:oe})})).json();k.success?(await pe(a.id,"resolved"),Y(),N("Food deleted and report resolved","success")):N(k.error||"Error deleting food","error")}catch(Q){console.error("Error deleting food:",Q),N("Error deleting food","error")}},ce=B=>{h($=>{const K=new Set($);return K.has(B)?K.delete(B):K.add(B),K})},be=()=>{u.size===E.length?h(new Set):h(new Set(E.map(B=>B.id)))},Ze=async()=>{if(u.size===0||!confirm(`Delete ${u.size} report(s)? This cannot be undone.`))return;let B=0;for(const $ of u)try{(await(await fetch(`${Ba}/deleteUserReport`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportId:$})})).json()).success&&(B++,s(oe=>oe.filter(Z=>Z.id!==$)))}catch(K){console.error("Error deleting report:",$,K)}h(new Set),N(`Deleted ${B} reports`,"success")},he=B=>new Date(B).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),et={pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",resolved:"bg-green-100 text-green-800",dismissed:"bg-gray-100 text-gray-600"},We={pending:"Pending",in_progress:"In Progress",resolved:"Resolved",dismissed:"Dismissed"};return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[x&&c.jsx("div",{className:`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg ${x.type==="success"?"bg-green-500 text-white":x.type==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,children:x.message}),c.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"User Reports"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Review and resolve user-submitted food corrections"}),j&&c.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-gray-400",children:[c.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Updated ",j.toLocaleTimeString()]})]})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("button",{onClick:M,disabled:i,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[c.jsx("svg",{className:`w-4 h-4 ${i?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),u.size>0&&c.jsxs("button",{onClick:Ze,className:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-red-600 hover:bg-red-700 rounded-lg",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete (",u.size,")"]})]})]})}),c.jsx("div",{className:"bg-white border-b border-gray-200 px-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex gap-1",children:["all","pending","in_progress","resolved","dismissed"].map(B=>c.jsxs("button",{onClick:()=>o(B),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${n===B?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[B==="all"?"All":B==="in_progress"?"In Progress":B.charAt(0).toUpperCase()+B.slice(1)," ",c.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs ${n===B?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"}`,children:F[B]})]},B))}),E.length>0&&c.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:u.size===E.length&&E.length>0,onChange:be,className:"w-4 h-4 text-primary-600 rounded"}),"Select all"]})]})}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx("div",{className:`flex-1 overflow-auto p-6 transition-all ${a?"w-1/2":"w-full"}`,children:i?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("svg",{className:"w-8 h-8 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),c.jsx("span",{className:"text-gray-500",children:"Loading reports..."})]})}):E.length===0?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[c.jsx("svg",{className:"w-16 h-16 mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("p",{className:"text-lg font-medium",children:"No reports found"}),c.jsxs("p",{className:"text-sm",children:["No ",n==="all"?"":n," reports to display"]})]}):c.jsx("div",{className:"grid gap-3",children:E.map(B=>{var $,K,Q;return c.jsxs("div",{className:`bg-white rounded-xl border p-4 transition-all cursor-pointer hover:shadow-md ${(a==null?void 0:a.id)===B.id?"border-primary-500 ring-2 ring-primary-100":"border-gray-200"}`,onClick:()=>J(B),children:[c.jsxs("div",{className:"flex items-start gap-3",children:[B.status==="pending"&&c.jsxs("div",{className:"relative flex items-center justify-center w-4 h-4 mt-1",children:[c.jsx("span",{className:"animate-ping absolute inline-flex h-3 w-3 rounded-full bg-orange-400 opacity-75"}),c.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-orange-500"})]}),B.status!=="pending"&&c.jsx("div",{className:"w-4 h-4 mt-1"}),c.jsx("input",{type:"checkbox",checked:u.has(B.id),onChange:oe=>{oe.stopPropagation(),ce(B.id)},onClick:oe=>oe.stopPropagation(),className:"mt-1 w-4 h-4 text-primary-600 rounded"}),(($=B.food)==null?void 0:$.imageUrl)&&c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:B.food.imageUrl,alt:B.foodName,className:"w-16 h-16 object-cover rounded-lg border border-gray-200",onError:oe=>{oe.currentTarget.style.display="none"}})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:B.foodName||"Unknown Food"}),B.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:B.brandName})]}),c.jsx("span",{className:`flex-shrink-0 px-2.5 py-1 rounded-full text-xs font-medium ${et[B.status]}`,children:We[B.status]})]}),c.jsxs("div",{className:"mt-2 flex items-center gap-3 text-xs text-gray-500 flex-wrap",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),B.reportType||"General"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),he(B.createdAt)]}),B.barcode&&c.jsx("span",{className:"font-mono",children:B.barcode}),(((K=B.food)==null?void 0:K._sourceIndex)||B.sourceIndex)&&c.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 rounded font-medium",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),((Q=B.food)==null?void 0:Q._sourceIndex)||B.sourceIndex]})]}),c.jsx("p",{className:"mt-2 text-sm text-gray-600 line-clamp-2",children:B.description||"No description provided."})]})]}),c.jsxs("div",{className:"mt-3 flex items-center gap-2 pt-3 border-t border-gray-100",children:[c.jsx("button",{onClick:oe=>{oe.stopPropagation(),J(B)},className:"flex-1 px-3 py-1.5 text-xs font-medium text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:"Review"}),B.status==="pending"&&c.jsx("button",{onClick:oe=>{oe.stopPropagation(),pe(B.id,"dismissed")},className:"px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Dismiss"}),c.jsx("button",{onClick:oe=>{oe.stopPropagation(),Ae(B.id)},className:"px-3 py-1.5 text-xs font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"Delete"})]})]},B.id)})})}),a&&p&&c.jsx("div",{className:"w-1/2 border-l border-gray-200 bg-white overflow-auto",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Review Report"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Edit and verify food information"})]}),c.jsx("button",{onClick:Y,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"mb-6 p-4 bg-yellow-50 rounded-xl border border-yellow-100",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("svg",{className:"w-5 h-5 text-yellow-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("p",{className:"font-medium text-yellow-800",children:a.reportType||"General Report"}),(((se=a.food)==null?void 0:se._sourceIndex)||a.sourceIndex)&&c.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),((ne=a.food)==null?void 0:ne._sourceIndex)||a.sourceIndex]})]}),c.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:a.description||"No description provided."}),c.jsxs("p",{className:"text-xs text-yellow-600 mt-2",children:["Reported ",he(a.createdAt)]})]})]})}),p.imageUrl&&c.jsxs("div",{className:"mb-4 rounded-xl overflow-hidden border border-gray-200",children:[c.jsx("img",{src:p.imageUrl,alt:p.name,className:"w-full h-48 object-cover",onError:B=>{B.currentTarget.style.display="none"}}),c.jsx("div",{className:"p-2 bg-gray-50 text-xs text-gray-600 truncate",title:p.imageUrl,children:p.imageUrl})]}),c.jsxs("button",{onClick:fe,disabled:y,className:"w-full mb-4 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-xl transition-colors disabled:opacity-50",children:[y?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),y?"Analyzing...":"Apply AI Suggestions"]}),c.jsxs("div",{className:"mb-6 flex items-center justify-between p-3 bg-blue-50 rounded-xl border border-blue-100",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Unit Mode"}),c.jsxs("p",{className:"text-xs text-blue-600",children:["Current: ",T.toUpperCase()]})]})]}),c.jsxs("button",{onClick:L,className:"relative inline-flex items-center h-7 w-14 rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",style:{backgroundColor:T==="ml"?"#3b82f6":"#9ca3af"},children:[c.jsx("span",{className:`inline-block w-5 h-5 transform rounded-full bg-white transition-transform ${T==="ml"?"translate-x-8":"translate-x-1"}`}),c.jsx("span",{className:"absolute left-2 text-[10px] font-bold text-white",style:{opacity:T==="g"?1:.3},children:"g"}),c.jsx("span",{className:"absolute right-1.5 text-[10px] font-bold text-white",style:{opacity:T==="ml"?1:.3},children:"ml"})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Food Name"}),c.jsx("input",{type:"text",value:p.name,onChange:B=>g({...p,name:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Brand Name"}),c.jsx("input",{type:"text",value:p.brandName,onChange:B=>g({...p,brandName:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Barcode"}),c.jsx("input",{type:"text",value:p.barcode,onChange:B=>g({...p,barcode:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),c.jsx("input",{type:"text",value:p.category,onChange:B=>g({...p,category:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Image URL"}),c.jsx("input",{type:"url",value:p.imageUrl,onChange:B=>g({...p,imageUrl:B.target.value}),placeholder:"https://example.com/image.jpg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Serving Size"}),c.jsx("input",{type:"text",value:p.servingDescription,onChange:B=>g({...p,servingDescription:B.target.value}),placeholder:"e.g., 1 slice",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Size (g/ml)"}),c.jsx("input",{type:"number",value:p.servingSizeG,onChange:B=>g({...p,servingSizeG:B.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Unit"}),c.jsxs("select",{value:p.servingUnit,onChange:B=>{const $=B.target.value;g({...p,servingUnit:$}),I($)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[c.jsx("option",{value:"g",children:"g"}),c.jsx("option",{value:"ml",children:"ml"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Ingredients"}),c.jsx("textarea",{value:p.ingredients,onChange:B=>g({...p,ingredients:B.target.value}),rows:3,placeholder:"Enter ingredients separated by commas...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("label",{className:"block text-xs font-medium text-gray-500",children:["Nutrition (per 100",T,")"]}),c.jsxs("span",{className:`px-2 py-0.5 text-[10px] font-bold rounded-full ${T==="g"?"bg-gray-100 text-gray-600":"bg-blue-100 text-blue-600"}`,children:[T.toUpperCase()," MODE"]})]}),c.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{key:"calories",label:"Calories",unit:"kcal"},{key:"protein",label:"Protein",unit:"g"},{key:"carbs",label:"Carbs",unit:"g"},{key:"fat",label:"Fat",unit:"g"},{key:"saturatedFat",label:"Sat Fat",unit:"g"},{key:"fiber",label:"Fibre",unit:"g"},{key:"sugar",label:"Sugar",unit:"g"},{key:"salt",label:"Salt",unit:"g"}].map(({key:B,label:$,unit:K})=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] text-gray-400 mb-1",children:$}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",step:"0.1",value:p[B],onChange:Q=>g({...p,[B]:Q.target.value}),className:"w-full px-2 py-1.5 pr-6 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),c.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-gray-400",children:K})]})]},B))})]})]}),c.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 space-y-3",children:[c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:()=>me(!0),disabled:m,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-xl transition-colors disabled:opacity-50",children:[m?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save & Resolve"]}),c.jsx("button",{onClick:()=>me(!1),disabled:m,className:"px-4 py-3 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors disabled:opacity-50",children:"Save Only"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:ye,className:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-xl transition-colors",children:"Dismiss Report"}),c.jsx("button",{onClick:te,className:"px-4 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50 rounded-xl transition-colors",children:"Delete Food"})]})]})]})})]})]})},cd="https://us-central1-nutrasafe-705c7.cloudfunctions.net",H3=({onBack:e})=>{const[t,s]=b.useState(()=>new Set(Jt)),[i,r]=b.useState(!1),[n,o]=b.useState(!1),[a,l]=b.useState(!1),[u,h]=b.useState(!1),[p,g]=b.useState([]),[m,C]=b.useState({totalScanned:0,duplicateGroups:0,productsToMerge:0,filteredForeign:0,finalMasterCount:0,processing:!1}),[y,R]=b.useState([]),[x,S]=b.useState([]),[T,I]=b.useState(0),[V,j]=b.useState(!1),[P,N]=b.useState({}),[_,L]=b.useState(!1),[M,E]=b.useState(""),[F,J]=b.useState(""),[Y,fe]=b.useState("all"),[me,pe]=b.useState(new Set),[ye,Ae]=b.useState(!1),te=b.useCallback(k=>{const O=new Date().toLocaleTimeString();S(W=>[...W.slice(-100),`${O}: ${k}`]),console.log(k)},[]),ce=b.useCallback(()=>{const k=F?p.filter(W=>{const ue=F.toLowerCase().trim(),ae=(W.name||W.foodName||"").toLowerCase(),X=(W.brand||W.brandName||"").toLowerCase(),q=Array.isArray(W.barcode)?W.barcode.join(" ").toLowerCase():(W.barcode||"").toLowerCase();return Y==="all"?ae.includes(ue)||X.includes(ue)||q.includes(ue):Y==="brand"?X.includes(ue):Y==="name"?ae.includes(ue):Y==="barcode"?q.includes(ue):!1}):p,O=new Set(k.map(W=>W.objectID));pe(O)},[F,Y,p]),be=b.useCallback(()=>{pe(new Set)},[]),Ze=b.useCallback(k=>{pe(O=>{const W=new Set(O);return W.has(k)?W.delete(k):W.add(k),W})},[]),he=b.useCallback(async()=>{if(me.size===0){alert("No products selected");return}if(window.confirm(`Are you sure you want to DELETE ${me.size} product(s)? This action CANNOT be undone!`)){Ae(!0),te(` Deleting ${me.size} selected products...`);try{const O=new Map;for(const ae of me){const X=p.find(q=>q.objectID===ae);if(X){const q=X.sourceIndex;O.has(q)||O.set(q,[]),O.get(q).push(ae)}}let W=0,ue=0;for(const[ae,X]of O){te(`   Deleting ${X.length} products from ${ae}...`);const q=await fetch(`${cd}/deleteFromIndex`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexName:ae,objectIDs:X})});if(q.ok){const ie=await q.json();ie.success?(W+=X.length,te(`   Deleted ${X.length} from ${ae}`)):(ue+=X.length,te(`   Failed to delete from ${ae}: ${ie.error}`))}else ue+=X.length,te(`   Failed to delete from ${ae}: HTTP ${q.status}`)}if(W>0){const ae=new Set(me),X=p.filter(q=>!ae.has(q.objectID));g(X),pe(new Set),te(` Successfully deleted ${W} products`),ue>0&&te(` Failed to delete ${ue} products`)}else te(" No products were deleted")}catch(O){te(` Error deleting products: ${O}`),alert("Error deleting products. Check logs for details.")}finally{Ae(!1)}}},[me,p,te]),et=(k,O)=>{try{if(!k||!O||typeof k!="string"||typeof O!="string")return Math.max((k==null?void 0:k.length)||0,(O==null?void 0:O.length)||0);const W=1e3,ue=k.length>W?k.substring(0,W):k,ae=O.length>W?O.substring(0,W):O,X=[];for(let q=0;q<=ae.length;q++)X[q]=[q];for(let q=0;q<=ue.length;q++)X[0][q]=q;for(let q=1;q<=ae.length;q++)for(let ie=1;ie<=ue.length;ie++)ae.charAt(q-1)===ue.charAt(ie-1)?X[q][ie]=X[q-1][ie-1]:X[q][ie]=Math.min(X[q-1][ie-1]+1,X[q][ie-1]+1,X[q-1][ie]+1);return X[ae.length][ue.length]}catch{return Math.max((k==null?void 0:k.length)||0,(O==null?void 0:O.length)||0)}},We=k=>{try{return!k||typeof k!="string"?"":k.toLowerCase().trim().replace(/[^\w\s]/g,"").replace(/\s+/g," ")}catch{return""}},se=(k,O)=>{if(!k||!O)return{score:0,reasons:["Invalid product(s)"]};let W=0;const ue=[];try{const ae=typeof k.barcode=="string"?[k.barcode]:Array.isArray(k.barcode)?k.barcode.filter(ie=>ie&&typeof ie=="string"):[],X=typeof O.barcode=="string"?[O.barcode]:Array.isArray(O.barcode)?O.barcode.filter(ie=>ie&&typeof ie=="string"):[],q=ae.find(ie=>ie&&X.includes(ie));if(q)return W=100,ue.push(`Exact barcode match: ${q}`),{score:W,reasons:ue}}catch{}try{const ae=We(k.brandName||k.brand||""),X=We(O.brandName||O.brand||"");if(ae&&X)if(ae===X)W+=30,ue.push("Exact brand match");else{const q=et(ae,X),ie=Math.max(ae.length,X.length);if(ie>0){const we=1-q/ie;if(we>=.8){const Ne=Math.round(we*30);W+=Ne,ue.push(`Fuzzy brand match (${Math.round(we*100)}% similar)`)}}}}catch{}try{const ae=We(k.name||k.foodName||""),X=We(O.name||O.foodName||"");if(ae&&X)if(ae===X)W+=40,ue.push("Exact name match");else{const q=et(ae,X),ie=Math.max(ae.length,X.length);if(ie>0){const we=1-q/ie;if(we>=.7){const Ne=Math.round(we*40);W+=Ne,ue.push(`Fuzzy name match (${Math.round(we*100)}% similar)`)}}}}catch{}try{const ae=ie=>{try{const we=ie.calories||0,Ne=ie.protein||0,De=ie.carbs||0,Ee=ie.fat||0;if(we>900||Ne>100||De>100||Ee>100)return!1;const Oe=Ne*4+De*4+Ee*9,Ue=Math.abs(we-Oe),ze=Math.max(Oe*.2,1);return Ue<=ze}catch{return!1}},q=((ie,we)=>{try{const Ne=[{key:"calories",tolerance:.1},{key:"protein",tolerance:.1},{key:"carbs",tolerance:.1},{key:"fat",tolerance:.1}];let De=0,Ee=0;for(const Oe of Ne){const Ue=ie[Oe.key]||0,ze=we[Oe.key]||0;if(Ue===0&&ze===0)continue;Ee++;const re=Math.abs(Ue-ze),_t=(Ue+ze)/2;_t>0&&re<=_t*Oe.tolerance&&De++}return Ee>0?De/Ee:0}catch{return 0}})(k,O);if(q>=.75){const ie=Math.round(q*30);W+=ie,ue.push(`Macros match (${Math.round(q*100)}% similar)`)}if(W>=50){const ie=ae(k),we=ae(O);ie&&!we?ue.push("p1 has valid macros, p2 has invalid macros"):!ie&&we&&ue.push("p2 has valid macros, p1 has invalid macros")}}catch{}return{score:W,reasons:ue}},ne=k=>{const O=k.calories||0,W=k.protein||0,ue=k.carbs||0,ae=k.fat||0;if(O>900||W>100||ue>100||ae>100)return!1;const X=W*4+ue*4+ae*9,q=Math.abs(O-X),ie=X*.2;return q<=ie},B=k=>{var O;try{if(!k)return 0;let W=0;try{const ae=jd([{id:k.objectID,objectID:k.objectID,name:k.name||k.foodName||"",brandName:k.brandName||k.brand||null,ingredients:k.ingredients||null,barcode:typeof k.barcode=="string"?k.barcode:((O=k.barcode)==null?void 0:O[0])||null,currentImageUrl:k.imageUrl||null,sourceIndex:k.sourceIndex,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,status:"pending",analysisProgress:0}],0).ukProducts.length>0?30:0;W+=ae}catch{}try{ne(k)&&(W+=20)}catch{}try{const ue=[k.ingredients,k.imageUrl,k.calories,k.protein,k.carbs,k.fat,k.fiber,k.sugar,k.sodium,k.servingSize],ae=ue.filter(X=>X!=null&&X!=="").length;W+=ae/ue.length*20}catch{}try{k.barcode&&(Array.isArray(k.barcode),k.barcode.length>0)&&(W+=10)}catch{}try{k.imageUrl&&typeof k.imageUrl=="string"&&k.imageUrl.trim().length>0&&(W+=10)}catch{}try{W+={verified_foods:10,uk_foods_cleaned:9,tesco_products:8,manual_foods:7,ai_enhanced:6,foods:5,user_added:4,ai_manually_added:3,fast_foods_database:2,generic_database:1}[k.sourceIndex]||0}catch{}return Math.round(W)}catch{return 0}},$=b.useCallback(async()=>{if(_&&!M){te(" No index selected");return}if(!_&&t.size===0){te(" No indices selected");return}r(!0),I(0),g([]),R([]),te(" Starting data pull (one index at a time)..."),te(V?" TEST MODE ENABLED: Limited to 1000 products per index":" FULL SCAN MODE: Pulling ALL products from selected indices");const k=_?[M]:Array.from(t),O=[],W={};try{for(let ae=0;ae<k.length;ae++){const X=k[ae];te(` Pulling ${X}...`);let q=0,ie=!0,we=[],Ne=0;const De=2e3;let Ee=0;for(;ie&&Ee<De;){Ee++,Ee>1&&Ee%5===0&&te(`   ${X}: ${we.length.toLocaleString()} products pulled, fetching more...`);const Oe=await fetch(`${cd}/browseAllIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indices:[X],offset:q,pageSize:5e3,limit:V?1e3:void 0})});if(!Oe.ok){te(` ${X}: HTTP ${Oe.status}`),W[X]={count:Ne,error:`HTTP ${Oe.status}`};break}const Ue=await Oe.json();if(Ue.success&&Ue.products){const ze=Ue.products||[],re=Ue.pagination||{};if(console.log(`[${X}] Page ${Ee}: Got ${ze.length} products, hasMore=${re.hasMore}, total=${re.total}`),ze.length===0){te(`   ${X}: Reached end of index (0 products returned)`),ie=!1;break}ze.length<5e3&&(te(`   ${X}: Last page (${ze.length} products)`),ie=!1),we.push(...ze),Ne=(re==null?void 0:re.total)||we.length;const _t=Math.floor((ae+we.length/Math.max(Ne,1))/k.length*100);I(_t);const Gs=Ne>0?Math.round(we.length/Ne*100):0;te(`   Page ${Ee}: ${we.length.toLocaleString()} / ${Ne.toLocaleString()} (${Gs}%) - hasMore=${re.hasMore}`),re.hasMore?(ie=!0,q+=5e3):(te(`   ${X}: Backend says no more data`),ie=!1),Ne>0&&we.length>=Ne&&(te(`   ${X}: Reached total count (${we.length} >= ${Ne})`),ie=!1)}else{te(` ${X}: ${Ue.error||"Failed"}`),W[X]={count:Ne,error:Ue.error||"Failed"};break}}Ee>=De&&te(` ${X}: Hit safety limit (${De} iterations), stopping pagination`),we.length>0&&(O.push(...we),W[X]={count:we.length},te(` ${X}: ${we.length.toLocaleString()} products`)),I(Math.floor((ae+1)/k.length*100))}te(` Total: ${O.length.toLocaleString()} products`),N(W),g(O),C(ae=>({...ae,totalScanned:O.length})),te(" Data pull complete! Ready to scan for duplicates.")}catch(ue){const ae=ue instanceof Error?ue.message:String(ue);te(` Error: ${ae}`)}finally{r(!1)}},[t,V,_,M,te]),K=b.useCallback(async()=>{if(p.length===0){te(" No data to scan. Pull data first.");return}o(!0),I(0),te(" Scanning for duplicates..."),te(` Analyzing ${p.length.toLocaleString()} products`);try{I(10);const k=_?p:(()=>{te(" Filtering out non-UK products (US spelling, foreign brands, foreign characters)...");const Ee=jd(p.map(Ue=>{var ze;return{id:Ue.objectID,objectID:Ue.objectID,name:Ue.name||Ue.foodName||"",brandName:Ue.brandName||Ue.brand||null,ingredients:Ue.ingredients||null,barcode:typeof Ue.barcode=="string"?Ue.barcode:((ze=Ue.barcode)==null?void 0:ze[0])||null,currentImageUrl:Ue.imageUrl||null,sourceIndex:Ue.sourceIndex,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,status:"pending",analysisProgress:0}}),40),Oe=p.filter(Ue=>Ee.ukProducts.some(ze=>ze.objectID===Ue.objectID));return te(` Kept ${Oe.length} UK products, filtered ${p.length-Oe.length} foreign products`),Oe})();I(70),te(" OPTIMIZED duplicate detection (hash-based bucketing)..."),te("   Building barcode and name indices...");const O=new Set,W=[],ue=Date.now(),ae=new Map,X=new Map;for(const Ee of k){const Oe=typeof Ee.barcode=="string"?[Ee.barcode]:Array.isArray(Ee.barcode)?Ee.barcode:[];for(const ze of Oe)if(ze&&typeof ze=="string"){const re=ze.trim();ae.has(re)||ae.set(re,[]),ae.get(re).push(Ee)}const Ue=We(Ee.name||Ee.foodName||"");if(Ue){const ze=Ue.substring(0,15);X.has(ze)||X.set(ze,[]),X.get(ze).push(Ee)}}te(`   Barcode index: ${ae.size.toLocaleString()} unique codes`),te(`   Name index: ${X.size.toLocaleString()} buckets`),te("   Finding duplicates (compares only similar products)..."),I(75);const q=new Set;let ie=0;const we=ae.size+X.size;for(const[Ee,Oe]of ae){if(Oe.length>1){const Ue=Oe.filter(ze=>ze&&ze.objectID&&!O.has(ze.objectID));if(Ue.length>1){for(const re of Ue)O.add(re.objectID);const ze=Ue.map(re=>({product:re,score:B(re)}));ze.sort((re,_t)=>_t.score-re.score),W.push({key:`barcode-${Ee}`,products:Ue,bestProduct:ze[0].product,allBarcodes:[Ee],score:ze[0].score})}}if(ie++,ie%500===0){const Ue=75+Math.round(ie/we*20);I(Ue);const ze=(Date.now()-ue)/1e3,re=Math.round(ie/ze);te(`   ${ie.toLocaleString()} / ${we.toLocaleString()} buckets (${re}/sec, ${W.length} groups)`),await new Promise(_t=>setTimeout(_t,0))}}for(const[Ee,Oe]of X){if(Oe.length>1)for(let Ue=0;Ue<Oe.length;Ue++){const ze=Oe[Ue];if(!ze||!ze.objectID||O.has(ze.objectID))continue;const re=[ze],_t=[],Gs=typeof ze.barcode=="string"?[ze.barcode]:Array.isArray(ze.barcode)?ze.barcode:[];_t.push(...Gs.filter(Xt=>Xt&&typeof Xt=="string").map(Xt=>Xt.trim()));for(let Xt=Ue+1;Xt<Oe.length;Xt++){const Pt=Oe[Xt];if(!Pt||!Pt.objectID||O.has(Pt.objectID))continue;const wr=[ze.objectID,Pt.objectID].sort().join("|");if(q.has(wr))continue;q.add(wr),se(ze,Pt).score>=80&&(re.push(Pt),O.add(Pt.objectID),(typeof Pt.barcode=="string"?[Pt.barcode]:Array.isArray(Pt.barcode)?Pt.barcode:[]).filter(_s=>_s&&typeof _s=="string").map(_s=>_s.trim()).forEach(_s=>{_t.includes(_s)||_t.push(_s)}))}if(re.length>1){O.add(ze.objectID);const Xt=re.map(Pt=>({product:Pt,score:B(Pt)}));Xt.sort((Pt,wr)=>wr.score-Pt.score),W.push({key:`name-${Ee}-${Ue}`,products:re,bestProduct:Xt[0].product,allBarcodes:[...new Set(_t)],score:Xt[0].score})}}if(ie++,ie%500===0){const Ue=75+Math.round(ie/we*20);I(Ue);const ze=(Date.now()-ue)/1e3,re=Math.round(ie/ze);te(`   ${ie.toLocaleString()} / ${we.toLocaleString()} buckets (${re}/sec, ${W.length} groups)`),await new Promise(_t=>setTimeout(_t,0))}}const Ne=((Date.now()-ue)/1e3).toFixed(1);te(` OPTIMIZED scan: ${Ne}s (vs. 16+ hours with old O(n) algorithm!)`),W.sort((Ee,Oe)=>Oe.products.length-Ee.products.length),te(` Found ${W.length} duplicate groups`);const De=W.reduce((Ee,Oe)=>Ee+Oe.products.length,0);te(` ${De} products will be merged into ${W.length} master products`),R(W),C({totalScanned:p.length,duplicateGroups:W.length,productsToMerge:De,filteredForeign:_?0:p.length-k.length,finalMasterCount:k.length-De+W.length,processing:!1}),I(100),te(" Scan complete!")}catch(k){te(` Error during scan: ${k}`)}finally{o(!1)}},[p,_,te]),Q=b.useCallback(async()=>{if(!_||!M){te(" This function only works in single-index mode");return}if(y.length===0){te(" No duplicates to merge. Scan first.");return}h(!0),I(0),te(" Merging all duplicates and updating database...");try{const k=[],O=new Set,W=[];te(` Processing ${y.length} duplicate groups...`);for(let q=0;q<y.length;q++){const ie=y[q],we=ie.bestProduct;ie.products.forEach(De=>{O.add(De.objectID),De.objectID!==we.objectID&&W.push(De.objectID)});const Ne={...we,objectID:we.objectID,barcodes:ie.allBarcodes,barcode:ie.allBarcodes[0],mergedFrom:ie.products.filter(De=>De.objectID!==we.objectID).map(De=>({objectID:De.objectID,sourceIndex:De.sourceIndex})),isMerged:!0,mergedAt:new Date().toISOString(),qualityScore:ie.score};k.push(Ne),I(Math.round(q/y.length*30))}te(` Created ${k.length} merged products`),te(` Marking ${W.length} duplicates for deletion`),te(" Adding non-duplicate products...");let ue=0;for(const q of p)O.has(q.objectID)||(k.push({...q,objectID:q.objectID,barcodes:q.barcode?Array.isArray(q.barcode)?q.barcode:[q.barcode]:[],barcode:Array.isArray(q.barcode)?q.barcode[0]:q.barcode,isMerged:!1}),ue++);if(te(` Added ${ue} non-duplicate products`),I(50),te(` Updating ${M} index...`),W.length>0){const ie=Math.ceil(W.length/100);for(let we=0;we<ie;we++){const Ne=we*100,De=Math.min((we+1)*100,W.length),Ee=W.slice(Ne,De);(await fetch(`${cd}/deleteFromIndex`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexName:M,objectIDs:Ee})})).ok?te(`   Deleted batch ${we+1}/${ie}`):te(` Failed to delete batch ${we+1}/${ie}`),I(50+Math.round(we/ie*20))}}const ae=100,X=Math.ceil(k.length/ae);for(let q=0;q<X;q++){const ie=q*ae,we=Math.min((q+1)*ae,k.length),Ne=k.slice(ie,we);(await fetch(`${cd}/updateAlgoliaIndex`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexName:M,products:Ne})})).ok?te(`   Uploaded batch ${q+1}/${X}`):te(` Failed to upload batch ${q+1}/${X}`),I(70+Math.round(q/X*30))}I(100),te(` Successfully merged duplicates and updated ${M}!`),te(` Final count: ${k.length.toLocaleString()} products (removed ${W.length} duplicates)`),R([])}catch(k){te(` Error merging duplicates: ${k}`)}finally{h(!1)}},[y,p,_,M,te]),oe=b.useCallback(async()=>{if(p.length===0){te(" No products to build from. Pull data first.");return}l(!0),I(0),te(" Building master database...");try{const k=[],O=new Set;te(` Merging ${y.length} duplicate groups...`);for(let q=0;q<y.length;q++){const ie=y[q],we=ie.bestProduct;ie.products.forEach(De=>O.add(De.objectID));const Ne={...we,objectID:we.objectID,barcodes:ie.allBarcodes,barcode:ie.allBarcodes[0],mergedFrom:ie.products.map(De=>({objectID:De.objectID,sourceIndex:De.sourceIndex})),isMerged:!0,mergedAt:new Date().toISOString(),qualityScore:ie.score};k.push(Ne),I(Math.round(q/y.length*50))}te(` Created ${k.length} merged products from duplicate groups`),te(" Adding non-duplicate products...");const W=p.filter(q=>{var we;return jd([{id:q.objectID,objectID:q.objectID,name:q.name||q.foodName||"",brandName:q.brandName||q.brand||null,ingredients:q.ingredients||null,barcode:typeof q.barcode=="string"?q.barcode:((we=q.barcode)==null?void 0:we[0])||null,currentImageUrl:q.imageUrl||null,sourceIndex:q.sourceIndex,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,status:"pending",analysisProgress:0}],40).ukProducts.length>0});let ue=0;for(let q=0;q<W.length;q++){const ie=W[q];O.has(ie.objectID)||(k.push({...ie,objectID:ie.objectID,barcodes:ie.barcode?Array.isArray(ie.barcode)?ie.barcode:[ie.barcode]:[],barcode:Array.isArray(ie.barcode)?ie.barcode[0]:ie.barcode,isMerged:!1}),ue++,ue%5e3===0&&I(50+Math.round(q/W.length*30)))}te(` Added ${ue} non-duplicate products`),te(" Uploading to Firestore...");const ae=100,X=Math.ceil(k.length/ae);for(let q=0;q<X;q++){const ie=q*ae,we=Math.min((q+1)*ae,k.length),Ne=k.slice(ie,we);(await fetch(`${cd}/uploadMasterDatabase`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({products:Ne})})).ok?te(`   Uploaded batch ${q+1}/${X}`):te(` Failed to upload batch ${q+1}/${X}`),I(Math.round((q+1)/X*100))}I(100),te(" Master database built and uploaded to Firestore!"),te(` Total products in master database: ${k.length.toLocaleString()}`)}catch(k){te(` Error building master database: ${k}`)}finally{l(!1)}},[y,p,te]),Z=Pe.useMemo(()=>{if(!F.trim())return p;const k=F.toLowerCase().trim();return p.filter(O=>{const W=(O.name||O.foodName||"").toLowerCase(),ue=(O.brand||O.brandName||"").toLowerCase(),ae=Array.isArray(O.barcode)?O.barcode.join(" ").toLowerCase():(O.barcode||"").toLowerCase();switch(Y){case"brand":return ue.includes(k);case"name":return W.includes(k);case"barcode":return ae.includes(k);case"all":default:return W.includes(k)||ue.includes(k)||ae.includes(k)}})},[p,F,Y]);return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Master Database Builder"}),c.jsx("p",{className:"text-sm text-gray-500",children:_?"Single-Index Mode: Pull  Scan  Merge duplicates within one index":"Multi-Index Mode: Pull  Scan  Build master database from multiple indices"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-purple-50 text-purple-700 rounded-lg text-sm cursor-pointer hover:bg-purple-100 border border-purple-200",children:[c.jsx("input",{type:"checkbox",checked:_,onChange:()=>{L(!_),g([]),R([]),S([])},className:"w-4 h-4 text-purple-600 rounded"}),c.jsx("span",{className:"font-medium",children:"Single-Index Mode"})]}),c.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm cursor-pointer border-2 transition-all ${V?"bg-yellow-50 text-yellow-800 border-yellow-300 hover:bg-yellow-100":"bg-green-50 text-green-800 border-green-300 hover:bg-green-100"}`,children:[c.jsx("input",{type:"checkbox",checked:V,onChange:()=>j(!V),className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"font-medium",children:V?" Test Mode (1k/index)":" Full Scan (ALL products)"})]}),p.length>0&&!i&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsxs("select",{value:Y,onChange:k=>fe(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[c.jsx("option",{value:"all",children:"All Fields"}),c.jsx("option",{value:"brand",children:"Brand"}),c.jsx("option",{value:"name",children:"Name"}),c.jsx("option",{value:"barcode",children:"Barcode"})]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",value:F,onChange:k=>J(k.target.value),placeholder:`Search by ${Y==="all"?"any field":Y}...`,className:"px-3 py-2 pr-10 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-80"}),F&&c.jsx("button",{onClick:()=>J(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsx("div",{className:"px-3 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:F?c.jsxs(c.Fragment,{children:[Z.length.toLocaleString()," / ",p.length.toLocaleString()," products"]}):c.jsxs(c.Fragment,{children:[p.length.toLocaleString()," products loaded"]})}),F&&Z.length>0&&c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:me.size===Z.length?be:ce,className:"px-3 py-2 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 rounded-lg text-sm font-medium border border-indigo-200",children:me.size===Z.length?"Deselect All":`Select All (${Z.length})`}),me.size>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"px-3 py-2 bg-purple-50 text-purple-700 rounded-lg text-sm font-medium border border-purple-200",children:[me.size," selected"]}),c.jsx("button",{onClick:he,disabled:ye,className:"px-3 py-2 bg-red-600 text-white hover:bg-red-700 disabled:opacity-50 rounded-lg text-sm font-medium flex items-center gap-2",children:ye?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Deleting..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Selected"]})})]})]})]}),c.jsxs("button",{onClick:$,disabled:i||n||a||u||(_?!M:t.size===0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium",children:[i?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),_?"Pull Index":"Pull All Data"]}),c.jsxs("button",{onClick:K,disabled:i||n||a||u||p.length===0,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 font-medium",children:[n?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Scan for Duplicates"]}),_?c.jsxs("button",{onClick:Q,disabled:i||n||a||u||y.length===0,className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 font-medium",children:[u?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Merge All Duplicates"]}):c.jsxs("button",{onClick:oe,disabled:i||n||a||u||y.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:[a?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),"Build Master Database"]})]})]}),(i||n||a||u)&&c.jsx("div",{className:"mt-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${T}%`}})}),c.jsxs("span",{className:"text-sm text-gray-500",children:[T,"%"]})]})})]}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:_?"Select Index to Clean":"Select Indices to Scan"}),_?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("select",{value:M,onChange:k=>E(k.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none font-medium",children:[c.jsx("option",{value:"",children:"-- Select an index --"}),Jt.map(k=>c.jsx("option",{value:k,children:k.replace(/_/g," ")},k))]}),M&&c.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg text-sm text-purple-700",children:[c.jsx("strong",{children:"Selected:"})," ",M.replace(/_/g," ")]})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:Jt.map(k=>c.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${t.has(k)?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsx("input",{type:"checkbox",checked:t.has(k),onChange:()=>{s(O=>{const W=new Set(O);return W.has(k)?W.delete(k):W.add(k),W})},className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:k.replace(/_/g," ")})]},k))}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>s(new Set(Jt)),className:"px-3 py-1.5 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg",children:"Select All"}),c.jsx("button",{onClick:()=>s(new Set),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"Clear All"}),c.jsxs("span",{className:"px-3 py-1.5 text-sm text-gray-500",children:[t.size," of ",Jt.length," selected"]})]})]})]}),Object.keys(P).length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Index Pull Results"}),c.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(P).map(([k,O])=>c.jsxs("div",{className:`rounded-lg p-3 ${O.error?"bg-red-50":"bg-green-50"}`,children:[c.jsx("div",{className:`text-xl font-bold ${O.error?"text-red-900":"text-green-900"}`,children:O.error?"":O.count.toLocaleString()}),c.jsx("div",{className:`text-xs ${O.error?"text-red-700":"text-green-700"}`,children:k.replace(/_/g," ")}),O.error&&c.jsx("div",{className:"text-xs text-red-600 mt-1 truncate",title:O.error,children:O.error})]},k))})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistics"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-blue-900",children:m.totalScanned.toLocaleString()}),c.jsx("div",{className:"text-sm text-blue-700",children:"Total Scanned"})]}),c.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-red-900",children:m.filteredForeign.toLocaleString()}),c.jsx("div",{className:"text-sm text-red-700",children:"Filtered (Foreign)"})]}),c.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-yellow-900",children:m.duplicateGroups.toLocaleString()}),c.jsx("div",{className:"text-sm text-yellow-700",children:"Duplicate Groups"})]}),c.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-purple-900",children:m.productsToMerge.toLocaleString()}),c.jsx("div",{className:"text-sm text-purple-700",children:"Products to Merge"})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-4 col-span-2",children:[c.jsx("div",{className:"text-4xl font-bold text-green-900",children:m.finalMasterCount.toLocaleString()}),c.jsx("div",{className:"text-sm text-green-700",children:"Final Master Database Count"})]})]})]}),F&&Z.length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Search Results (",Z.length.toLocaleString()," products)",c.jsxs("span",{className:"ml-2 text-sm font-normal text-blue-600",children:[Y==="all"?"All Fields":Y.charAt(0).toUpperCase()+Y.slice(1),': "',F,'"']})]}),c.jsxs("div",{className:"space-y-3 max-h-96 overflow-auto",children:[Z.slice(0,100).map((k,O)=>c.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50",children:c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900 truncate",children:k.name||k.foodName}),c.jsx("div",{className:"text-sm text-gray-600 truncate",children:k.brand||k.brandName||"No brand"}),c.jsxs("div",{className:"flex gap-3 mt-1",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Index: ",k.sourceIndex]}),k.calories&&c.jsxs("span",{className:"text-xs text-gray-500",children:[k.calories," kcal"]})]}),k.barcode&&c.jsx("div",{className:"text-xs text-gray-400 mt-1 font-mono",children:Array.isArray(k.barcode)?k.barcode.join(", "):k.barcode})]}),c.jsx("div",{className:"flex-shrink-0",children:k.imageUrl&&c.jsx("img",{src:k.imageUrl,alt:k.name||k.foodName,className:"w-16 h-16 object-cover rounded",onError:W=>{W.target.style.display="none"}})})]})},O)),Z.length>100&&c.jsxs("div",{className:"text-center text-sm text-gray-500 py-3",children:["Showing first 100 of ",Z.length.toLocaleString()," results"]})]})]}),F&&Z.length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Search Results (",Z.length," products)"]}),c.jsx("div",{className:"space-y-2 max-h-96 overflow-auto",children:Z.map(k=>c.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${me.has(k.objectID)?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("input",{type:"checkbox",checked:me.has(k.objectID),onChange:()=>Ze(k.objectID),className:"w-5 h-5 text-indigo-600 rounded mt-0.5 flex-shrink-0"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900 truncate",children:k.name||k.foodName||"Unnamed Product"}),c.jsx("div",{className:"text-sm text-gray-500 truncate",children:k.brandName||k.brand||"No brand"}),c.jsxs("div",{className:"flex gap-2 mt-1 flex-wrap",children:[c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs",children:k.sourceIndex}),(typeof k.barcode=="string"?[k.barcode]:k.barcode||[]).filter(O=>O).map((O,W)=>c.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs font-mono",children:O},W))]})]})]},k.objectID))})]}),y.length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Top Duplicate Groups (",y.length," total)"]}),c.jsx("div",{className:"space-y-4 max-h-96 overflow-auto",children:y.slice(0,20).map((k,O)=>{var W,ue,ae,X,q;return c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-gray-900",children:((W=k.bestProduct)==null?void 0:W.name)||((ue=k.bestProduct)==null?void 0:ue.foodName)}),c.jsx("div",{className:"text-sm text-gray-500",children:((ae=k.bestProduct)==null?void 0:ae.brandName)||((X=k.bestProduct)==null?void 0:X.brand)})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded",children:[k.products.length," duplicates"]}),c.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded",children:["Score: ",k.score]})]})]}),c.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[c.jsxs("div",{children:["Best from: ",(q=k.bestProduct)==null?void 0:q.sourceIndex]}),c.jsxs("div",{children:["All barcodes: ",k.allBarcodes.join(", ")||"None"]}),c.jsx("div",{className:"flex gap-2 flex-wrap mt-2",children:k.products.map((ie,we)=>c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs",children:ie.sourceIndex},we))})]})]},O)})})]})]}),c.jsxs("div",{className:"w-96 border-l border-gray-200 bg-gray-900 flex flex-col",children:[c.jsx("div",{className:"px-4 py-2 border-b border-gray-700 text-gray-400 text-xs font-medium uppercase",children:"Processing Log"}),c.jsx("div",{className:"flex-1 overflow-auto p-3 font-mono text-xs text-gray-300 space-y-1",children:x.length===0?c.jsx("div",{className:"text-gray-500",children:'No activity yet. Click "Scan & Detect Duplicates" to start.'}):x.map((k,O)=>c.jsx("div",{className:"break-all",children:k},O))})]})]})]})},ca=[{id:"milk",name:"Milk & Milk Alternatives",description:"Liquid milk products and plant-based alternatives for drinking",keywords:["milk","semi-skimmed","skimmed","whole milk","oat milk","almond milk","soy milk","soya milk","lactofree"],excludeKeywords:["chocolate","milkshake","milk chocolate","milky bar","milky way","condensed","evaporated","powder","dried"],defaultServingG:200,servingSizes:[{name:"Small glass",grams:150},{name:"Medium glass",grams:200},{name:"Large glass",grams:300}],toleranceMin:100,toleranceMax:500,examples:["Whole Milk","Semi-Skimmed Milk","Oatly Oat Milk","Alpro Soya Milk","Lactofree Semi-Skimmed"],notExamples:["Cadbury Dairy Milk","Milk Chocolate Digestives","Chocolate Milkshake","Milky Bar","Milky Way"]},{id:"cheese",name:"Cheese",description:"Hard and soft cheeses",keywords:["cheese","cheddar","mozzarella","brie","camembert","stilton","parmesan","feta","halloumi","gouda","edam","red leicester","wensleydale"],excludeKeywords:["cheesecake","cheese and onion","cheese sandwich","macaroni cheese","cheese string"],defaultServingG:30,toleranceMin:15,toleranceMax:100,examples:["Cathedral City Mature Cheddar","Philadelphia Cream Cheese","Babybel","Boursin","Grated Mozzarella"],notExamples:["New York Cheesecake","Cheese and Onion Crisps","Cheese Sandwich","Mac and Cheese"]},{id:"yoghurt",name:"Yoghurt & Fromage Frais",description:"Yoghurts, fromage frais, and cultured dairy desserts",keywords:["yoghurt","yogurt","fromage frais","skyr","kefir","activia","muller","yeo valley","fage"],excludeKeywords:["yoghurt coated","yogurt raisins"],defaultServingG:125,servingSizes:[{name:"Small pot",grams:100},{name:"Standard pot",grams:125},{name:"Large pot",grams:150}],toleranceMin:50,toleranceMax:500,examples:["Muller Corner","Activia Strawberry","Fage Total 0%","Yeo Valley Organic","Petits Filous"],notExamples:["Yoghurt Coated Raisins","Yoghurt Covered Nuts"]},{id:"butter_spread",name:"Butter & Spreads",description:'Butter, margarine, spreadable fats, and butter alternatives. Includes "Creamy and Buttery" products like Elmlea which are plant-based butter substitutes.',keywords:["butter","margarine","spread","flora","lurpak","anchor","bertolli","clover","utterly butterly","elmlea","creamy and buttery","buttery salted","buttery unsalted"],excludeKeywords:["peanut butter","almond butter","chocolate spread","jam","marmalade","marmite"],defaultServingG:10,toleranceMin:5,toleranceMax:30,examples:["Lurpak Spreadable","Flora Original","Anchor Butter","Clover","Bertolli","Elmlea Creamy and Buttery Salted","Elmlea Creamy and Buttery Unsalted"],notExamples:["Peanut Butter","Nutella","Biscoff Spread","Marmite","Elmlea Double (cream alternative)","Elmlea Single (cream alternative)"]},{id:"cream",name:"Cream",description:"Single, double, whipping, and clotted cream (REAL dairy cream only)",keywords:["cream","single cream","double cream","whipping cream","clotted cream","soured cream","creme fraiche"],excludeKeywords:["ice cream","cream cheese","cream cracker","cream of","cream liqueur","cream egg","elmlea","cream alternative","plant cream","creamy"],defaultServingG:30,toleranceMin:15,toleranceMax:100,examples:["Rodda's Clotted Cream","Creme Fraiche","Soured Cream","Tesco Double Cream","Sainsbury's Single Cream"],notExamples:["Ice Cream","Cream Crackers","Cream of Tomato Soup","Cream Egg","Irish Cream Liqueur","Elmlea (cream alternative)"]},{id:"cream_alternatives",name:"Cream Alternatives",description:'Plant-based and non-dairy cream for pouring/cooking/whipping (NOT butter substitutes). Elmlea Single/Double are cream alternatives. But "Creamy and Buttery" Elmlea = butter substitute  goes in butter_spreads.',keywords:["cream alternative","plant cream","vegan cream","oat cream","soy cream","elmlea single","elmlea double","elmlea plant"],excludeKeywords:["ice cream","cream cheese","creamy and buttery","buttery salted","buttery unsalted"],defaultServingG:30,toleranceMin:15,toleranceMax:100,examples:["Elmlea Double","Elmlea Single","Elmlea Plant Double","Oatly Oat Cream","Alpro Soya Cream"],notExamples:["Tesco Double Cream","Rodda's Clotted Cream","Real dairy cream","Elmlea Creamy and Buttery (butter substitute)"]},{id:"eggs",name:"Eggs",description:"Whole eggs - chicken, duck, quail",keywords:["egg","eggs","free range","barn eggs","organic eggs"],excludeKeywords:["egg fried rice","egg sandwich","egg mayo","scotch egg","easter egg","cream egg","creme egg"],defaultServingG:60,servingSizes:[{name:"Medium egg",grams:50},{name:"Large egg",grams:60},{name:"Very large egg",grams:70}],toleranceMin:35,toleranceMax:100,examples:["Large Free Range Eggs","Organic Eggs","Clarence Court Eggs","Quail Eggs"],notExamples:["Scotch Egg","Cadbury Creme Egg","Easter Egg","Egg Fried Rice","Egg Mayo Sandwich"]},{id:"bread_sliced",name:"Sliced Bread",description:"Pre-sliced bread loaves - white, wholemeal, seeded",keywords:["bread","loaf","sliced","white bread","wholemeal bread","brown bread","warburtons","hovis","kingsmill"],excludeKeywords:["garlic bread","bread roll","bread stick","naan bread","pitta","flatbread","breadcrumbs","bread sauce"],defaultServingG:38,servingSizes:[{name:"Thin slice",grams:25},{name:"Medium slice",grams:38},{name:"Thick slice",grams:50}],toleranceMin:20,toleranceMax:80,examples:["Warburtons Toastie White","Hovis Best of Both","Kingsmill 50/50","Roberts Bakery Wholemeal"],notExamples:["Garlic Bread","Ciabatta Roll","Breadsticks","Stuffing"]},{id:"bread_rolls",name:"Bread Rolls & Buns",description:"Individual bread rolls, baps, buns, bagels",keywords:["roll","bun","bap","bagel","brioche bun","ciabatta roll","sub roll","hot dog bun","burger bun"],excludeKeywords:["sausage roll","spring roll","swiss roll","cinnamon roll","iced bun"],defaultServingG:60,servingSizes:[{name:"Small roll",grams:45},{name:"Medium roll",grams:60},{name:"Large roll/bagel",grams:85}],toleranceMin:30,toleranceMax:120,examples:["White Bread Rolls","Warburtons Sandwich Thins","New York Bagels","Brioche Burger Buns"],notExamples:["Sausage Roll","Spring Roll","Cinnamon Roll","Chelsea Bun"]},{id:"crumpets",name:"Crumpets & English Muffins",description:"Crumpets, English muffins, pikelet",keywords:["crumpet","english muffin","muffin","pikelet"],excludeKeywords:["muffin chocolate","blueberry muffin","chocolate chip muffin","breakfast muffin"],defaultServingG:55,toleranceMin:40,toleranceMax:80,examples:["Warburtons Crumpets","Kingsmill Crumpets","Warburtons English Muffins"],notExamples:["Chocolate Muffin","Blueberry Muffin","McDonalds McMuffin"]},{id:"wraps_tortillas",name:"Wraps & Tortillas",description:"Flour tortillas, wraps, flatbreads for filling",keywords:["wrap","tortilla","flatbread","naan","pitta","pita","chapati","roti"],excludeKeywords:["tortilla chips","wrap meal","chicken wrap"],defaultServingG:60,servingSizes:[{name:"Small wrap",grams:40},{name:"Medium wrap",grams:60},{name:"Large wrap",grams:80}],toleranceMin:30,toleranceMax:120,examples:["Old El Paso Flour Tortillas","Mission Deli Wraps","Warburtons Wraps","Mini Naans"],notExamples:["Doritos","Tortilla Chips","Chicken Fajita Wrap Meal"]},{id:"croissants_pastries",name:"Croissants & Pastries",description:"Croissants, pain au chocolat, danish pastries",keywords:["croissant","pain au chocolat","danish","pastry","almond croissant"],excludeKeywords:["pastry case","puff pastry","filo pastry","shortcrust"],defaultServingG:60,toleranceMin:40,toleranceMax:120,examples:["All Butter Croissant","Pain au Chocolat","Almond Croissant","Cinnamon Swirl"],notExamples:["Jus-Rol Puff Pastry","Filo Pastry Sheets","Cornish Pasty"]},{id:"cereal_cold",name:"Breakfast Cereals (Cold)",description:"Cold cereals - flakes, puffs, clusters, granola",keywords:["cereal","cornflakes","weetabix","shreddies","cheerios","special k","bran flakes","granola","muesli","crunchy nut","coco pops","frosties","rice krispies","shredded wheat"],excludeKeywords:["cereal bar"],defaultServingG:40,servingSizes:[{name:"Small bowl",grams:30},{name:"Medium bowl",grams:40},{name:"Large bowl",grams:60}],toleranceMin:20,toleranceMax:100,examples:["Kelloggs Corn Flakes","Weetabix","Nestle Shreddies","Jordans Granola","Alpen Muesli"],notExamples:["Nutri-Grain Cereal Bar","Kelloggs Crunchy Nut Bar"]},{id:"porridge_oats",name:"Porridge & Oats",description:"Oats, porridge, overnight oats, instant oats",keywords:["oats","porridge","oatmeal","oat so simple","ready brek","overnight oats","rolled oats","steel cut oats"],excludeKeywords:["oat milk","oat cake","flapjack"],defaultServingG:40,toleranceMin:25,toleranceMax:80,examples:["Quaker Oats","Oat So Simple","Ready Brek","Flahavans Porridge Oats"],notExamples:["Oatly Oat Milk","Nairns Oatcakes","Oat Flapjack"]},{id:"chicken_breast",name:"Chicken Breast",description:"Raw and cooked chicken breast fillets",keywords:["chicken breast","chicken fillet","mini fillets","chicken escalope"],excludeKeywords:["chicken kiev","chicken nugget","chicken burger","chicken pie","stuffed chicken"],defaultServingG:150,servingSizes:[{name:"Small breast",grams:120},{name:"Medium breast",grams:150},{name:"Large breast",grams:200}],toleranceMin:80,toleranceMax:300,examples:["Chicken Breast Fillets","Chargrilled Chicken Breast","Chicken Mini Fillets"],notExamples:["Chicken Kiev","Chicken Nuggets","KFC Chicken","Nandos Chicken"]},{id:"chicken_thigh_drumstick",name:"Chicken Thighs & Drumsticks",description:"Chicken thighs and drumsticks, bone-in or boneless",keywords:["chicken thigh","chicken drumstick","chicken leg","thigh fillet"],excludeKeywords:[],defaultServingG:120,toleranceMin:60,toleranceMax:200,examples:["Chicken Thigh Fillets","Chicken Drumsticks","Skin-On Chicken Thighs"],notExamples:["Chicken Breast","Whole Chicken"]},{id:"beef_mince",name:"Beef Mince",description:"Minced beef of various fat percentages",keywords:["beef mince","minced beef","ground beef","lean mince","extra lean mince","steak mince"],excludeKeywords:["bolognese","lasagne","chilli con carne","burger"],defaultServingG:125,toleranceMin:80,toleranceMax:250,examples:["Lean Beef Mince 5% Fat","Beef Steak Mince","Extra Lean Minced Beef"],notExamples:["Spaghetti Bolognese","Beef Burgers","Beef Lasagne"]},{id:"beef_steak",name:"Beef Steak",description:"Steak cuts - sirloin, ribeye, fillet, rump",keywords:["steak","sirloin","ribeye","fillet steak","rump steak","bavette","onglet"],excludeKeywords:["steak pie","steak slice","steak bake","steak mince"],defaultServingG:225,servingSizes:[{name:"Small steak",grams:170},{name:"Medium steak",grams:225},{name:"Large steak",grams:300}],toleranceMin:120,toleranceMax:450,examples:["Ribeye Steak","Sirloin Steak","Rump Steak","Fillet Steak"],notExamples:["Steak and Kidney Pie","Greggs Steak Bake","Pukka Steak Pie"]},{id:"bacon",name:"Bacon",description:"Streaky and back bacon, smoked and unsmoked",keywords:["bacon","streaky bacon","back bacon","smoked bacon","unsmoked bacon","bacon rashers","pancetta"],excludeKeywords:["bacon sandwich","bacon roll","bacon bits","bacon flavour"],defaultServingG:60,toleranceMin:25,toleranceMax:150,examples:["Smoked Back Bacon","Unsmoked Streaky Bacon","Thick Cut Bacon","Pancetta Cubes"],notExamples:["Bacon Sandwich","Bacon Flavour Crisps","Turkey Bacon"]},{id:"sausages",name:"Sausages",description:"Pork, beef, chicken, and vegetarian sausages",keywords:["sausage","sausages","cumberland","lincolnshire","chipolata","banger"],excludeKeywords:["sausage roll","sausage meat","sausage casserole","hot dog"],defaultServingG:67,servingSizes:[{name:"1 sausage",grams:67},{name:"2 sausages",grams:134},{name:"3 sausages",grams:200}],toleranceMin:40,toleranceMax:250,examples:["Cumberland Sausages","Pork Chipolatas","Richmond Thick Sausages","Linda McCartney Sausages"],notExamples:["Greggs Sausage Roll","Sausage Casserole","Toad in the Hole"]},{id:"ham_sliced",name:"Sliced Ham & Cooked Meats",description:"Sliced ham, turkey, chicken, and deli meats",keywords:["ham","sliced ham","cooked ham","turkey slices","chicken slices","pastrami","salami","chorizo slices","prosciutto"],excludeKeywords:["ham sandwich","ham and cheese","gammon"],defaultServingG:35,toleranceMin:15,toleranceMax:100,examples:["Tesco Honey Roast Ham","Wafer Thin Turkey","Sliced Chicken Breast","Parma Ham"],notExamples:["Ham and Cheese Toastie","Gammon Steak","Christmas Ham"]},{id:"fish_fillets",name:"Fish Fillets (Fresh)",description:"Fresh fish fillets - salmon, cod, haddock, sea bass",keywords:["salmon fillet","cod fillet","haddock fillet","sea bass","trout fillet","mackerel fillet","tuna steak"],excludeKeywords:["fish fingers","fish cake","fish pie","battered fish"],defaultServingG:130,toleranceMin:80,toleranceMax:250,examples:["Salmon Fillet","Cod Loin","Sea Bass Fillets","Smoked Haddock"],notExamples:["Birds Eye Fish Fingers","Fish Cakes","Chip Shop Fish"]},{id:"tinned_fish",name:"Tinned Fish",description:"Canned tuna, salmon, sardines, mackerel",keywords:["tinned","canned","tuna chunks","tuna flakes","sardines","mackerel fillets","salmon pink","salmon red"],excludeKeywords:[],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["John West Tuna Chunks","Princes Salmon","Sardines in Tomato Sauce","Mackerel in Sunflower Oil"],notExamples:["Fresh Tuna Steak","Salmon Fillet"]},{id:"prawns_seafood",name:"Prawns & Seafood",description:"Prawns, shrimp, mussels, squid",keywords:["prawn","shrimp","king prawn","tiger prawn","mussel","squid","calamari","scallop","crab","lobster"],excludeKeywords:["prawn cocktail","prawn cracker","seafood stick"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["King Prawns","Cooked Prawns","Mussels in Garlic","Squid Rings"],notExamples:["Prawn Cocktail Crisps","Prawn Crackers","Seafood Sticks"]},{id:"lasagne",name:"Lasagne",description:"Beef lasagne, vegetable lasagne ready meals",keywords:["lasagne","lasagna"],excludeKeywords:["lasagne sheets","lasagne pasta"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Beef Lasagne","Vegetable Lasagne","Tesco Finest Lasagne","M&S Lasagne"],notExamples:["Lasagne Sheets","Dried Lasagne Pasta"]},{id:"chicken_ready_meal",name:"Chicken Ready Meal",description:"Chicken-based ready meals - satay, kiev, hunter's chicken, etc.",keywords:["satay chicken","hunter's chicken","hunters chicken","chicken kiev","chicken dinner","chicken and rice","chicken with rice","roast chicken meal","chicken casserole ready meal","lemon chicken","teriyaki chicken","honey chicken","garlic chicken"],excludeKeywords:["raw chicken","chicken breast","chicken thigh","chicken drumstick"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Tesco Finest Satay Chicken With Jasmine Rice","Chicken Kiev","Hunter's Chicken","Lemon & Herb Chicken"],notExamples:["Raw Chicken Breast","Chicken Thighs","Fresh Chicken"]},{id:"curry_ready_meal",name:"Curry (Ready Meal)",description:"Indian curry ready meals - tikka masala, korma, jalfrezi",keywords:["curry","tikka masala","korma","madras","vindaloo","jalfrezi","balti","bhuna","rogan josh","butter chicken","biryani"],excludeKeywords:["curry paste","curry sauce","curry powder","curry pot noodle","curry leaves"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Chicken Tikka Masala","Lamb Rogan Josh","Vegetable Korma","M&S Chicken Jalfrezi","Chicken Biryani"],notExamples:["Patak's Curry Paste","Curry Powder","Pot Noodle Chicken Korma"]},{id:"chinese_ready_meal",name:"Chinese Ready Meal",description:"Chinese takeaway style ready meals - chow mein, sweet & sour, etc.",keywords:["chow mein","sweet and sour","sweet & sour","kung pao","crispy chilli","szechuan","cantonese","black bean","oyster sauce","egg fried rice","special fried rice","chinese chicken","chinese pork","chinese beef","char siu","hoisin"],excludeKeywords:["sauce","paste","powder","noodles dry","stir fry sauce"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Chicken Chow Mein","Sweet & Sour Chicken","Beef in Black Bean Sauce","Special Fried Rice","Crispy Chilli Beef"],notExamples:["Chow Mein Noodles Dry","Sweet & Sour Sauce","Hoisin Sauce"]},{id:"cottage_shepherds_pie",name:"Cottage Pie / Shepherd's Pie",description:"Minced meat with mashed potato topping ready meals",keywords:["cottage pie","shepherd pie","shepherds pie","shepherd's pie","beef pie mash","lamb pie mash"],excludeKeywords:[],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Cottage Pie","Shepherd's Pie","M&S Cottage Pie","Tesco Shepherd's Pie"],notExamples:[]},{id:"fish_pie",name:"Fish Pie",description:"Fish pie with mashed potato topping ready meals",keywords:["fish pie","fisherman pie","fishermans pie","fisherman's pie","ocean pie","seafood pie"],excludeKeywords:[],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Fish Pie","Fisherman's Pie","M&S Fish Pie","Charlie Bigham's Fish Pie"],notExamples:[]},{id:"pasta_bake_ready_meal",name:"Pasta Bake / Mac & Cheese",description:"Pasta bake, macaroni cheese ready meals",keywords:["pasta bake","macaroni cheese","mac and cheese","mac & cheese","mac n cheese","tuna pasta bake","chicken pasta bake","carbonara ready meal"],excludeKeywords:["pasta bake sauce","pasta bake mix"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Macaroni Cheese","Tuna Pasta Bake","Chicken Pasta Bake","M&S Mac & Cheese"],notExamples:["Pasta Bake Sauce","Dolmio Pasta Bake"]},{id:"spaghetti_bolognese_ready_meal",name:"Spaghetti Bolognese (Ready Meal)",description:"Spaghetti bolognese, meat sauce pasta ready meals",keywords:["spaghetti bolognese","spag bol","bolognaise","meat sauce pasta","beef ragu"],excludeKeywords:["bolognese sauce","ragu sauce","jar"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Spaghetti Bolognese","Spag Bol Ready Meal","Beef Ragu with Pasta"],notExamples:["Dolmio Bolognese Sauce","Ragu Sauce Jar"]},{id:"chilli_con_carne_ready_meal",name:"Chilli Con Carne (Ready Meal)",description:"Chilli con carne ready meals with rice",keywords:["chilli con carne","chili con carne","beef chilli","beef chili","chilli with rice"],excludeKeywords:["chilli sauce","chilli powder","chilli flakes"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Chilli Con Carne","Beef Chilli with Rice","M&S Chilli Con Carne"],notExamples:["Chilli Sauce","Chilli Powder","Chilli Con Carne Spice Mix"]},{id:"roast_dinner_ready_meal",name:"Roast Dinner (Ready Meal)",description:"Sunday roast style ready meals with meat and veg",keywords:["roast dinner","sunday roast","roast beef dinner","roast chicken dinner","roast pork dinner","carvery","roast lamb"],excludeKeywords:["roast potatoes only","roast chicken breast raw"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:500}],toleranceMin:300,toleranceMax:550,examples:["Roast Beef Dinner","Roast Chicken Dinner","Sunday Roast Ready Meal","Carvery Meal"],notExamples:["Roast Potatoes","Raw Roast Chicken"]},{id:"stew_casserole_ready_meal",name:"Stew / Casserole (Ready Meal)",description:"Beef stew, chicken casserole, hotpot ready meals",keywords:["stew","casserole","hotpot","hot pot","lancashire hotpot","beef stew","lamb stew","chicken casserole","irish stew"],excludeKeywords:["casserole mix","stewing steak raw","casserole dish"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Beef Stew","Lancashire Hotpot","Chicken Casserole","Irish Stew"],notExamples:["Stewing Steak Raw","Casserole Mix Packet"]},{id:"pizza",name:"Pizza",description:"Fresh, frozen, and takeaway pizzas",keywords:["pizza","margherita","pepperoni pizza","pizza express","goodfellas","chicago town","dr oetker"],excludeKeywords:["pizza base","pizza dough","pizza sauce","pizza flavour"],defaultServingG:200,servingSizes:[{name:"1/4 pizza",grams:150},{name:"1/3 pizza",grams:200},{name:"1/2 pizza",grams:300}],toleranceMin:80,toleranceMax:500,examples:["Pepperoni Pizza","Margherita","Chicago Town Deep Dish","Goodfellas Thin"],notExamples:["Pizza Base","Pizza Express Dough Balls","Pizza Flavour Pringles"]},{id:"pie_savoury",name:"Savoury Pies & Pasties",description:"Meat pies, pasties, quiches",keywords:["pie","pasty","pastie","quiche","pukka pie","fray bentos","steak pie","chicken pie","pork pie","cornish pasty"],excludeKeywords:["pie filling","apple pie","cherry pie","banoffee pie","pie crust"],defaultServingG:200,toleranceMin:100,toleranceMax:400,examples:["Pukka Steak Pie","Cornish Pasty","Pork Pie","Quiche Lorraine","Chicken & Mushroom Pie"],notExamples:["Apple Pie","Mr Kipling Pies","Mince Pie"]},{id:"sandwich_prepared",name:"Prepared Sandwiches",description:"Pre-made sandwiches, meal deal sandwiches",keywords:["sandwich","sarnie","blt","club sandwich","triple sandwich","sub"],excludeKeywords:["sandwich thins","sandwich spread","sandwich pickle"],defaultServingG:180,toleranceMin:100,toleranceMax:350,examples:["BLT Sandwich","Chicken & Bacon Triple","Prawn Mayo Sandwich","Tesco Meal Deal Sandwich"],notExamples:["Warburtons Sandwich Thins","Sandwich Spread","Branston Pickle"]},{id:"soup",name:"Soup",description:"Tinned, fresh, and packet soups",keywords:["soup","broth","chowder","heinz soup","baxters","covent garden"],excludeKeywords:["soup mix","soup maker"],defaultServingG:300,servingSizes:[{name:"Cup/mug",grams:200},{name:"Bowl",grams:300},{name:"Large bowl",grams:400}],toleranceMin:150,toleranceMax:500,examples:["Heinz Tomato Soup","Baxters Chicken Broth","New Covent Garden Soup"],notExamples:["Soup and Shake","Dried Soup Mix"]},{id:"pasta_dried",name:"Pasta (Dried)",description:"Dried pasta - spaghetti, penne, fusilli, etc.",keywords:["pasta","spaghetti","penne","fusilli","tagliatelle","rigatoni","farfalle","linguine","macaroni","orzo"],excludeKeywords:["pasta sauce","pasta bake","pot pasta","pasta salad","ready meal"],defaultServingG:75,servingSizes:[{name:"Small portion",grams:60},{name:"Medium portion",grams:75},{name:"Large portion",grams:100}],toleranceMin:40,toleranceMax:150,examples:["Napolina Spaghetti","De Cecco Penne","Barilla Fusilli","Own Brand Pasta"],notExamples:["Dolmio Pasta Sauce","Pot Pasta","Pasta King"]},{id:"rice_dried",name:"Rice (Dried)",description:"Dried rice - basmati, long grain, jasmine, risotto",keywords:["rice","basmati","long grain","jasmine rice","risotto rice","arborio","wild rice","brown rice"],excludeKeywords:["rice pudding","rice cake","rice cracker","microwave rice","rice krispies","fried rice"],defaultServingG:75,servingSizes:[{name:"Small portion",grams:60},{name:"Medium portion",grams:75},{name:"Large portion",grams:100}],toleranceMin:40,toleranceMax:150,examples:["Tilda Basmati Rice","Uncle Bens Long Grain","Arborio Risotto Rice"],notExamples:["Rice Pudding","Rice Cakes","Egg Fried Rice","Ben's Original Microwave Rice"]},{id:"rice_microwave",name:"Microwave Rice (Cooked)",description:"Pre-cooked microwave rice pouches",keywords:["microwave rice","uncle bens","bens original","tilda steamed","express rice"],excludeKeywords:[],defaultServingG:125,toleranceMin:100,toleranceMax:300,examples:["Ben's Original Microwave Rice","Tilda Steamed Rice","Sainsburys Microwave Rice"],notExamples:["Dried Rice","Risotto"]},{id:"noodles",name:"Noodles",description:"Dried and fresh noodles - egg noodles, rice noodles, udon",keywords:["noodle","egg noodle","rice noodle","udon","ramen","chow mein","vermicelli"],excludeKeywords:["pot noodle","noodle pot","super noodles","instant noodles"],defaultServingG:65,toleranceMin:40,toleranceMax:150,examples:["Blue Dragon Egg Noodles","Rice Noodles","Fresh Udon","Straight to Wok Noodles"],notExamples:["Pot Noodle","Super Noodles","Naked Noodle"]},{id:"instant_noodles",name:"Instant Noodles & Pot Noodles",description:"Pot noodles, super noodles, instant ramen",keywords:["pot noodle","super noodles","instant noodle","cup noodle","naked noodle","nissin","kabuto"],excludeKeywords:[],defaultServingG:90,toleranceMin:60,toleranceMax:150,examples:["Pot Noodle Chicken & Mushroom","Batchelors Super Noodles","Kabuto Ramen"],notExamples:["Fresh Noodles","Dried Egg Noodles"]},{id:"apple",name:"Apple",description:"Fresh apples - all varieties",keywords:["apple","granny smith","gala","braeburn","pink lady","jazz apple","cox"],excludeKeywords:["apple juice","apple pie","apple sauce","apple crumble","toffee apple","apple cider"],defaultServingG:150,servingSizes:[{name:"Small apple",grams:120},{name:"Medium apple",grams:150},{name:"Large apple",grams:200}],toleranceMin:80,toleranceMax:250,examples:["Pink Lady Apple","Gala Apple","Granny Smith","Braeburn"],notExamples:["Apple Juice","Apple Pie","Dried Apple"]},{id:"banana",name:"Banana",description:"Fresh bananas",keywords:["banana","fairtrade banana"],excludeKeywords:["banana bread","banana chip","dried banana","banana milkshake","banana split"],defaultServingG:120,servingSizes:[{name:"Small banana",grams:90},{name:"Medium banana",grams:120},{name:"Large banana",grams:150}],toleranceMin:60,toleranceMax:200,examples:["Loose Bananas","Fairtrade Bananas","Organic Bananas"],notExamples:["Banana Bread","Banana Chips","Banana Milkshake"]},{id:"berries",name:"Berries",description:"Strawberries, blueberries, raspberries, blackberries",keywords:["strawberry","strawberries","blueberry","blueberries","raspberry","raspberries","blackberry","blackberries","mixed berries"],excludeKeywords:["jam","compote","yoghurt","smoothie","ice cream"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Fresh Strawberries","Blueberries","Raspberries","Mixed Berry Pack"],notExamples:["Strawberry Jam","Strawberry Yoghurt","Berry Smoothie"]},{id:"citrus",name:"Citrus Fruits",description:"Oranges, lemons, limes, grapefruit, satsumas",keywords:["orange","lemon","lime","grapefruit","satsuma","clementine","tangerine","mandarin"],excludeKeywords:["juice","marmalade","squash","lemon curd","orange chocolate"],defaultServingG:130,servingSizes:[{name:"Small/satsuma",grams:70},{name:"Medium orange",grams:130},{name:"Large orange",grams:180}],toleranceMin:50,toleranceMax:250,examples:["Navel Oranges","Easy Peeler Satsumas","Lemons","Pink Grapefruit"],notExamples:["Orange Juice","Lemon Curd","Terry's Chocolate Orange"]},{id:"grapes",name:"Grapes",description:"Fresh grapes - red, green, black",keywords:["grape","grapes","seedless grapes","red grapes","green grapes","black grapes"],excludeKeywords:["grape juice","raisins","sultanas","wine"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Green Seedless Grapes","Red Grapes","Black Grapes","Cotton Candy Grapes"],notExamples:["Raisins","Sultanas","Grape Juice"]},{id:"melon",name:"Melon",description:"Watermelon, cantaloupe, honeydew, galia",keywords:["melon","watermelon","cantaloupe","honeydew","galia"],excludeKeywords:[],defaultServingG:150,toleranceMin:80,toleranceMax:300,examples:["Watermelon Slices","Cantaloupe Melon","Honeydew Melon","Galia Melon"],notExamples:[]},{id:"tropical_fruit",name:"Tropical Fruits",description:"Mango, pineapple, papaya, kiwi, passion fruit",keywords:["mango","pineapple","papaya","kiwi","passion fruit","coconut","lychee","dragon fruit"],excludeKeywords:["juice","dried","smoothie"],defaultServingG:80,toleranceMin:50,toleranceMax:200,examples:["Fresh Mango","Pineapple Chunks","Kiwi Fruit","Papaya"],notExamples:["Pineapple Juice","Dried Mango","Coconut Milk"]},{id:"dried_fruit",name:"Dried Fruit",description:"Raisins, sultanas, dates, apricots, cranberries",keywords:["dried","raisins","sultanas","currants","dates","dried apricot","dried mango","prunes","cranberries","dried fig"],excludeKeywords:["trail mix","fruit and nut"],defaultServingG:30,toleranceMin:15,toleranceMax:80,examples:["Sun-Maid Raisins","Medjool Dates","Dried Apricots","Dried Cranberries"],notExamples:["Fresh Dates","Fresh Apricots","Trail Mix"]},{id:"potato",name:"Potatoes",description:"Fresh potatoes - baking, mashing, roasting",keywords:["potato","potatoes","maris piper","king edward","jersey royal","new potato","baby potato","baking potato"],excludeKeywords:["chips","crisps","mash","wedges","roast potato","hash brown","potato waffle"],defaultServingG:175,servingSizes:[{name:"Small potato",grams:100},{name:"Medium potato",grams:175},{name:"Large baking potato",grams:300}],toleranceMin:60,toleranceMax:400,examples:["Maris Piper Potatoes","Baking Potatoes","Jersey Royals","Baby New Potatoes"],notExamples:["Oven Chips","Crisps","Mashed Potato","Potato Waffles"]},{id:"chips_frozen",name:"Chips & Wedges (Frozen/Prepared)",description:"Oven chips, frozen chips, potato wedges",keywords:["chips","oven chips","frozen chips","chunky chips","wedges","potato wedges","fries","mccain","aunt bessies"],excludeKeywords:["fish and chips","chip shop","crisps","tortilla chips"],defaultServingG:165,toleranceMin:100,toleranceMax:300,examples:["McCain Oven Chips","Aunt Bessie's Homestyle Chips","Sweet Potato Wedges"],notExamples:["Walkers Crisps","Doritos","Fish and Chips"]},{id:"carrot",name:"Carrots",description:"Fresh carrots - whole, baby, batons",keywords:["carrot","carrots","baby carrot","carrot batons","chantenay"],excludeKeywords:["carrot cake","carrot juice","carrot soup"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Loose Carrots","Baby Carrots","Chantenay Carrots","Carrot Batons"],notExamples:["Carrot Cake","Carrot and Coriander Soup"]},{id:"broccoli",name:"Broccoli",description:"Fresh and frozen broccoli",keywords:["broccoli","tenderstem","broccoli florets"],excludeKeywords:["broccoli soup","broccoli cheese"],defaultServingG:85,toleranceMin:50,toleranceMax:200,examples:["Broccoli Florets","Tenderstem Broccoli","Frozen Broccoli"],notExamples:["Broccoli and Stilton Soup","Broccoli Cheese Bake"]},{id:"onion",name:"Onions",description:"Fresh onions - white, red, spring",keywords:["onion","onions","red onion","white onion","spring onion","shallot","leek"],excludeKeywords:["onion rings","onion bhaji","onion gravy","crispy onion"],defaultServingG:80,toleranceMin:30,toleranceMax:200,examples:["Brown Onions","Red Onions","Spring Onions","Shallots"],notExamples:["Onion Rings","Onion Bhajis","Bisto Onion Gravy"]},{id:"tomato",name:"Tomatoes (Fresh)",description:"Fresh tomatoes - cherry, plum, vine",keywords:["tomato","tomatoes","cherry tomato","plum tomato","vine tomato","beef tomato"],excludeKeywords:["tomato sauce","tomato soup","tinned tomato","chopped tomato","passata","ketchup","puree"],defaultServingG:85,toleranceMin:40,toleranceMax:200,examples:["Cherry Tomatoes","Vine Ripened Tomatoes","Plum Tomatoes","Beef Tomatoes"],notExamples:["Chopped Tomatoes","Tomato Puree","Tomato Ketchup","Tomato Soup"]},{id:"tinned_tomato",name:"Tinned Tomatoes & Passata",description:"Chopped, whole, and passata tomatoes",keywords:["tinned tomato","canned tomato","chopped tomato","plum tomato tin","passata","tomato puree"],excludeKeywords:["tomato soup","tomato sauce"],defaultServingG:100,toleranceMin:50,toleranceMax:400,examples:["Napolina Chopped Tomatoes","Whole Plum Tomatoes","Passata","Tomato Puree"],notExamples:["Fresh Tomatoes","Tomato Soup","Dolmio Sauce"]},{id:"salad_leaves",name:"Salad Leaves & Lettuce",description:"Lettuce, spinach, rocket, mixed leaves",keywords:["lettuce","salad","rocket","spinach","watercress","mixed leaves","iceberg","romaine","cos","little gem"],excludeKeywords:["salad dressing","caesar salad","pasta salad","potato salad","coleslaw"],defaultServingG:35,toleranceMin:15,toleranceMax:100,examples:["Iceberg Lettuce","Baby Spinach","Rocket Salad","Mixed Salad Leaves"],notExamples:["Caesar Salad with Dressing","Pasta Salad","Coleslaw"]},{id:"beans_green",name:"Green Beans & Peas",description:"Green beans, runner beans, peas, mange tout",keywords:["green bean","runner bean","pea","garden pea","petit pois","mange tout","sugar snap","edamame"],excludeKeywords:["baked beans","bean salad","bean chilli"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Fine Beans","Garden Peas","Mange Tout","Sugar Snap Peas","Frozen Peas"],notExamples:["Heinz Baked Beans","Three Bean Salad"]},{id:"baked_beans",name:"Baked Beans",description:"Tinned baked beans in tomato sauce",keywords:["baked beans","heinz beans","branston beans"],excludeKeywords:[],defaultServingG:200,toleranceMin:100,toleranceMax:420,examples:["Heinz Baked Beans","Branston Baked Beans","Reduced Sugar Baked Beans"],notExamples:["Green Beans","Kidney Beans","Bean Salad"]},{id:"sweetcorn",name:"Sweetcorn",description:"Tinned, frozen, and fresh sweetcorn",keywords:["sweetcorn","corn on the cob","corn kernels","baby corn"],excludeKeywords:["cornflakes","corn chips","popcorn"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Green Giant Sweetcorn","Frozen Sweetcorn","Corn on the Cob","Baby Corn"],notExamples:["Popcorn","Corn Flakes","Doritos"]},{id:"mushroom",name:"Mushrooms",description:"Fresh and tinned mushrooms",keywords:["mushroom","button mushroom","chestnut mushroom","portobello","shiitake","oyster mushroom"],excludeKeywords:["mushroom soup","mushroom sauce","mushroom risotto"],defaultServingG:65,toleranceMin:30,toleranceMax:200,examples:["Button Mushrooms","Chestnut Mushrooms","Portobello Mushrooms","Sliced Mushrooms"],notExamples:["Cream of Mushroom Soup","Mushroom Stroganoff"]},{id:"pepper",name:"Peppers",description:"Bell peppers - red, green, yellow, orange",keywords:["pepper","bell pepper","red pepper","green pepper","yellow pepper","mixed pepper","romano pepper"],excludeKeywords:["pepper steak","black pepper","chilli pepper","pepper sauce"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Red Peppers","Mixed Peppers","Yellow Pepper","Romano Peppers"],notExamples:["Black Pepper","Jalapeno Peppers","Pepper Steak"]},{id:"cucumber",name:"Cucumber",description:"Fresh cucumber",keywords:["cucumber","mini cucumber"],excludeKeywords:["tzatziki","cucumber salad"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Whole Cucumber","Mini Cucumbers","Sliced Cucumber"],notExamples:["Tzatziki Dip"]},{id:"courgette",name:"Courgette & Squash",description:"Courgettes, butternut squash, aubergine",keywords:["courgette","zucchini","butternut squash","squash","aubergine","eggplant"],excludeKeywords:["courgette soup","squash soup"],defaultServingG:90,toleranceMin:50,toleranceMax:250,examples:["Courgettes","Butternut Squash","Aubergine","Diced Butternut"],notExamples:["Butternut Squash Soup","Moussaka"]},{id:"cabbage",name:"Cabbage & Kale",description:"White cabbage, red cabbage, savoy, kale",keywords:["cabbage","white cabbage","red cabbage","savoy","kale","cavolo nero","spring greens"],excludeKeywords:["coleslaw","sauerkraut"],defaultServingG:90,toleranceMin:40,toleranceMax:200,examples:["White Cabbage","Red Cabbage","Savoy Cabbage","Curly Kale"],notExamples:["Coleslaw","Sauerkraut"]},{id:"cauliflower",name:"Cauliflower",description:"Fresh and frozen cauliflower",keywords:["cauliflower","cauliflower florets","cauliflower rice"],excludeKeywords:["cauliflower cheese","cauliflower soup"],defaultServingG:85,toleranceMin:50,toleranceMax:200,examples:["Cauliflower Florets","Whole Cauliflower","Cauliflower Rice","Frozen Cauliflower"],notExamples:["Cauliflower Cheese","Cauliflower Soup"]},{id:"avocado",name:"Avocado",description:"Fresh avocados",keywords:["avocado","ripe avocado","hass avocado"],excludeKeywords:["guacamole","avocado oil"],defaultServingG:75,servingSizes:[{name:"Half avocado",grams:75},{name:"Whole avocado",grams:150}],toleranceMin:50,toleranceMax:200,examples:["Ripe Avocado","Ripen at Home Avocado","Hass Avocado"],notExamples:["Guacamole","Avocado Oil"]},{id:"crisps",name:"Crisps & Tortilla Chips",description:"Potato crisps, tortilla chips, vegetable crisps (single bag ~25g)",keywords:["crisps","walkers","pringles","kettle chips","sensations","tyrrells","doritos","tortilla chips","nachos"],excludeKeywords:["oven chips","frozen chips","fish and chips"],defaultServingG:25,toleranceMin:15,toleranceMax:50,examples:["Walkers Ready Salted","Pringles Original","Doritos","Kettle Chips","Sensations"],notExamples:["Oven Chips","McCain Chips"]},{id:"popcorn",name:"Popcorn",description:"Ready-made and microwave popcorn",keywords:["popcorn","butterkist","metcalfe","propercorn","skinny popcorn"],excludeKeywords:["popcorn chicken"],defaultServingG:25,toleranceMin:15,toleranceMax:80,examples:["Butterkist Sweet Popcorn","Propercorn","Metcalfe's Skinny Popcorn"],notExamples:["KFC Popcorn Chicken"]},{id:"nuts_plain",name:"Nuts (Plain & Roasted)",description:"Almonds, cashews, peanuts, mixed nuts",keywords:["nuts","almond","cashew","peanut","walnut","pistachio","brazil nut","macadamia","hazelnut","mixed nuts","dry roasted"],excludeKeywords:["nut butter","chocolate nuts","honey roasted","praline"],defaultServingG:30,toleranceMin:15,toleranceMax:80,examples:["KP Dry Roasted Peanuts","Whole Almonds","Cashew Nuts","Mixed Nuts"],notExamples:["Peanut Butter","Snickers","Chocolate Brazils","Honey Roasted Peanuts"]},{id:"chocolate_bar",name:"Chocolate Bars",description:"Chocolate bars, blocks, and countlines",keywords:["chocolate","dairy milk","galaxy","cadbury","mars","snickers","twix","kitkat","bounty","maltesers","milky way","milkybar","aero","wispa","crunchie","flake","yorkie","toblerone","lindt"],excludeKeywords:["chocolate milk","chocolate milkshake","hot chocolate","chocolate spread","chocolate cake","chocolate biscuit","chocolate ice cream","truffles","box"],defaultServingG:40,toleranceMin:20,toleranceMax:60,examples:["Cadbury Dairy Milk","Galaxy Smooth Milk","Mars Bar","Snickers","KitKat","Maltesers"],notExamples:["Chocolate Milk","Hot Chocolate","Chocolate Spread","Chocolate Digestive","Lindt Lindor Truffles Box"]},{id:"chocolate_sharing",name:"Chocolate (Sharing Bags)",description:"Sharing bags of small chocolates like M&Ms, Maltesers pouches",keywords:["sharing bag","pouch","m&ms","maltesers bag","minstrels","revels","peanut m&m"],excludeKeywords:["box","truffles","lindor","ferrero"],defaultServingG:40,toleranceMin:25,toleranceMax:60,examples:["M&M's Sharing Bag","Maltesers Pouch","Minstrels Bag","Revels"],notExamples:["Lindt Lindor Box","Ferrero Rocher","Celebrations Tub"]},{id:"chocolate_selection_box",name:"Chocolate Selection Boxes",description:"Selection tubs and boxes - Celebrations, Roses, Heroes, Quality Street",keywords:["celebrations","heroes","roses","quality street","selection","tub","miniatures"],excludeKeywords:["truffles","lindor","ferrero"],defaultServingG:30,toleranceMin:20,toleranceMax:50,examples:["Celebrations","Heroes","Quality Street","Cadbury Roses","Cadbury Miniatures"],notExamples:["Lindt Lindor","Ferrero Rocher","Single Bar"]},{id:"chocolate_truffles_box",name:"Boxed Chocolates & Truffles",description:"Premium boxed chocolates - Lindor, Ferrero Rocher, Belgian chocolates",keywords:["truffles","lindor","ferrero","rocher","belgian","praline","boxed chocolate","gift box","assorted chocolate"],excludeKeywords:["sharing bag","multipack"],defaultServingG:25,toleranceMin:12,toleranceMax:40,examples:["Lindt Lindor Truffles","Ferrero Rocher","Belgian Chocolate Selection","Hotel Chocolat"],notExamples:["Celebrations","Heroes","Chocolate Bar","M&Ms"]},{id:"sweets",name:"Sweets & Candy",description:"Boiled sweets, gummies, jellies, mints",keywords:["sweet","candy","gummy","haribo","jelly baby","wine gums","fruit pastille","skittles","starburst","polo","mints","toffee","fudge","chews","bonbon"],excludeKeywords:["sweet potato","sweetcorn","sweet chilli"],defaultServingG:25,toleranceMin:10,toleranceMax:50,examples:["Haribo Starmix","Bassetts Wine Gums","Rowntree's Fruit Pastilles","Skittles"],notExamples:["Sweet Potato","Chocolate Bar"]},{id:"biscuits",name:"Biscuits",description:"Sweet biscuits - digestives, bourbons, custard creams (2 biscuits typical)",keywords:["biscuit","digestive","hobnob","bourbon","custard cream","rich tea","shortbread","oreo","maryland","cookie","jammie dodger","malted milk"],excludeKeywords:["biscuit base","biscuit tin"],defaultServingG:25,toleranceMin:10,toleranceMax:40,examples:["McVitie's Digestives","Chocolate Hobnobs","Bourbon Creams","Oreos","Maryland Cookies"],notExamples:["Cheesecake Biscuit Base"]},{id:"cake",name:"Cakes & Gateaux",description:"Large cakes, sliced cakes, gateaux",keywords:["cake","sponge","victoria sponge","chocolate cake","carrot cake","cheesecake","gateau","birthday cake","coffee cake","lemon drizzle"],excludeKeywords:["cake mix","cake bar","jaffa cake","rice cake","fish cake","potato cake"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Victoria Sponge","Chocolate Fudge Cake","Carrot Cake","New York Cheesecake"],notExamples:["Jaffa Cakes","Rice Cakes","Cake Mix"]},{id:"cake_bars",name:"Cake Bars & Individual Cakes",description:"Mr Kipling cakes, French Fancies, cake bars",keywords:["cake bar","mr kipling","french fancy","fondant fancy","mini roll","swiss roll","jaffa cake","angel slice","bakewell","brownie"],excludeKeywords:[],defaultServingG:35,toleranceMin:20,toleranceMax:100,examples:["Mr Kipling French Fancies","Cadbury Mini Rolls","Jaffa Cakes","Bakewell Tart","Brownie"],notExamples:["Whole Cake","Large Victoria Sponge"]},{id:"muffins_sweet",name:"Muffins (Sweet)",description:"Chocolate chip, blueberry, and other sweet muffins",keywords:["muffin chocolate","blueberry muffin","double chocolate muffin","banana muffin","lemon muffin"],excludeKeywords:["english muffin"],defaultServingG:100,toleranceMin:60,toleranceMax:180,examples:["Chocolate Chip Muffin","Blueberry Muffin","Starbucks Muffin","Costa Muffin"],notExamples:["English Muffin","Warburtons Muffins"]},{id:"doughnuts",name:"Doughnuts",description:"Ring doughnuts, jam doughnuts, filled doughnuts",keywords:["doughnut","donut","jam doughnut","ring doughnut","krispy kreme","dunkin"],excludeKeywords:[],defaultServingG:70,toleranceMin:40,toleranceMax:150,examples:["Krispy Kreme Original","Jam Doughnut","Ring Doughnut","Yum Yums"],notExamples:[]},{id:"soft_drinks",name:"Soft Drinks",description:"Fizzy drinks, cola, lemonade, squash",keywords:["cola","coke","pepsi","fanta","sprite","7up","lemonade","orangeade","fizzy","soda","dr pepper","irn bru","lucozade","energy drink","red bull","monster"],excludeKeywords:["diet","zero","no sugar","sugar free"],defaultServingG:330,servingSizes:[{name:"Small can",grams:250},{name:"Standard can",grams:330},{name:"Large bottle",grams:500}],toleranceMin:150,toleranceMax:750,examples:["Coca-Cola","Pepsi","Fanta Orange","Sprite","Lucozade Original","Red Bull"],notExamples:["Diet Coke","Coke Zero","Pepsi Max"]},{id:"soft_drinks_diet",name:"Diet & Zero Soft Drinks",description:"Sugar-free fizzy drinks",keywords:["diet coke","coke zero","pepsi max","diet pepsi","fanta zero","sprite zero","sugar free","no sugar","zero sugar"],excludeKeywords:[],defaultServingG:330,toleranceMin:150,toleranceMax:750,examples:["Diet Coke","Coke Zero","Pepsi Max","Fanta Zero","7Up Free"],notExamples:["Regular Coca-Cola","Full Sugar Fanta"]},{id:"fruit_juice",name:"Fruit Juice",description:"Orange juice, apple juice, fruit juices",keywords:["juice","orange juice","apple juice","tropicana","innocent","pure juice","freshly squeezed","cranberry juice","grape juice"],excludeKeywords:["squash","cordial","concentrate","juice drink"],defaultServingG:200,toleranceMin:100,toleranceMax:500,examples:["Tropicana Orange Juice","Innocent Apple Juice","Fresh Orange Juice","Cranberry Juice"],notExamples:["Robinsons Squash","Capri Sun","Um Bongo"]},{id:"smoothie",name:"Smoothies",description:"Fruit smoothies, protein smoothies",keywords:["smoothie","innocent smoothie","naked juice","protein smoothie"],excludeKeywords:[],defaultServingG:250,toleranceMin:150,toleranceMax:500,examples:["Innocent Strawberry & Banana","Naked Green Machine","M&S Super Smoothie"],notExamples:["Fruit Juice","Milkshake"]},{id:"milkshake",name:"Milkshakes",description:"Flavoured milkshakes - chocolate, strawberry, banana",keywords:["milkshake","frijj","yazoo","chocolate milk","strawberry milk","banana milkshake"],excludeKeywords:["milkshake powder","milkshake mix"],defaultServingG:400,toleranceMin:200,toleranceMax:600,examples:["Frijj Chocolate Milkshake","Yazoo Strawberry","McDonald's Milkshake"],notExamples:["Semi-Skimmed Milk","Milkshake Powder"]},{id:"hot_drinks",name:"Hot Drinks (Prepared)",description:"Coffee shop drinks - lattes, cappuccinos, hot chocolates (ready to drink)",keywords:["latte","cappuccino","americano","mocha","flat white","macchiato","starbucks","costa","nero"],excludeKeywords:["coffee beans","instant coffee","ground coffee","powder","flakes","drinking chocolate","cocoa","mix","sachet"],defaultServingG:350,toleranceMin:200,toleranceMax:500,examples:["Starbucks Latte","Costa Cappuccino","Caffe Nero Mocha","Costa Hot Chocolate RTD"],notExamples:["Nescafe Instant","Ground Coffee","Coffee Beans","Hot Chocolate Powder","Cadbury Drinking Chocolate","Galaxy Hot Chocolate Flakes"]},{id:"tea_coffee_instant",name:"Tea & Coffee (Instant/Dry)",description:"Tea bags, instant coffee, ground coffee",keywords:["tea bag","instant coffee","nescafe","kenco","pg tips","yorkshire tea","tetley","twinings","ground coffee"],excludeKeywords:[],defaultServingG:2,toleranceMin:1,toleranceMax:10,examples:["PG Tips Tea Bags","Yorkshire Tea","Nescafe Gold","Kenco Millicano"],notExamples:["Costa Latte","Starbucks Iced Coffee"]},{id:"hot_chocolate_powder",name:"Hot Chocolate Powder/Mix",description:"Hot chocolate powder, drinking chocolate, cocoa powder mixes",keywords:["hot chocolate","drinking chocolate","cocoa","chocolate flakes","chocolate powder","options","cadbury hot chocolate","galaxy hot chocolate","ovaltine"],excludeKeywords:["ready to drink","prepared","rtd","carton"],defaultServingG:25,toleranceMin:15,toleranceMax:40,examples:["Cadbury Drinking Chocolate","Galaxy Hot Chocolate","Options Hot Chocolate","Ovaltine","Green & Blacks Cocoa"],notExamples:["Costa Hot Chocolate","Starbucks Hot Chocolate","Ready Made Hot Chocolate"]},{id:"squash_cordial",name:"Squash & Cordial",description:"Concentrated squash and cordials (undiluted)",keywords:["squash","cordial","robinsons","ribena","vimto","dilute","concentrate"],excludeKeywords:["no added sugar","sugar free"],defaultServingG:50,toleranceMin:25,toleranceMax:100,examples:["Robinsons Orange Squash","Ribena","Vimto Cordial","Elderflower Cordial"],notExamples:["Ready to Drink","Carton Drink"]},{id:"alcohol_beer",name:"Beer & Lager",description:"Beer, lager, ale, cider",keywords:["beer","lager","ale","cider","stout","ipa","pilsner","guinness","stella","heineken","carling","fosters","budweiser","corona","peroni","craft beer"],excludeKeywords:["non alcoholic","alcohol free","0%"],defaultServingG:500,servingSizes:[{name:"Half pint",grams:284},{name:"Can/bottle",grams:440},{name:"Pint",grams:568}],toleranceMin:250,toleranceMax:700,examples:["Stella Artois","Heineken","Guinness","Magners Cider","BrewDog Punk IPA"],notExamples:["Heineken 0.0","Alcohol-Free Peroni"]},{id:"alcohol_wine",name:"Wine",description:"Red, white, ros, sparkling wine",keywords:["wine","red wine","white wine","rose","prosecco","champagne","sauvignon","chardonnay","merlot","pinot","rioja","malbec"],excludeKeywords:["wine gums","cooking wine","non alcoholic"],defaultServingG:175,servingSizes:[{name:"Small glass",grams:125},{name:"Medium glass",grams:175},{name:"Large glass",grams:250}],toleranceMin:100,toleranceMax:300,examples:["Sauvignon Blanc","Merlot","Prosecco","Pinot Grigio","House Red"],notExamples:["Wine Gums","Cooking Wine"]},{id:"alcohol_spirits",name:"Spirits",description:"Vodka, gin, rum, whisky, tequila",keywords:["vodka","gin","rum","whisky","whiskey","tequila","brandy","bourbon","cognac","liqueur","baileys","amaretto","sambuca"],excludeKeywords:[],defaultServingG:25,servingSizes:[{name:"Single measure",grams:25},{name:"Double measure",grams:50}],toleranceMin:20,toleranceMax:100,examples:["Smirnoff Vodka","Gordon's Gin","Captain Morgan Rum","Jack Daniel's","Baileys"],notExamples:["Rum and Coke","Cocktail"]},{id:"ketchup_sauces",name:"Ketchup & Table Sauces",description:"Ketchup, brown sauce, BBQ sauce",keywords:["ketchup","tomato ketchup","heinz","brown sauce","hp sauce","bbq sauce","burger sauce"],excludeKeywords:[],defaultServingG:15,toleranceMin:10,toleranceMax:50,examples:["Heinz Tomato Ketchup","HP Brown Sauce","Heinz BBQ Sauce","Nandos Sauce"],notExamples:["Tomato Puree","Pasta Sauce"]},{id:"mayonnaise",name:"Mayonnaise & Salad Cream",description:"Mayonnaise, salad cream, aioli",keywords:["mayonnaise","mayo","hellmanns","salad cream","aioli","garlic mayo"],excludeKeywords:["egg mayo sandwich","prawn mayo"],defaultServingG:15,toleranceMin:10,toleranceMax:50,examples:["Hellmann's Mayonnaise","Heinz Salad Cream","Garlic Aioli","Light Mayo"],notExamples:["Egg Mayo Sandwich","Coleslaw"]},{id:"mustard",name:"Mustard",description:"English mustard, Dijon, wholegrain",keywords:["mustard","english mustard","dijon","wholegrain mustard","french mustard","colmans"],excludeKeywords:["mustard powder"],defaultServingG:10,toleranceMin:5,toleranceMax:30,examples:["Colman's English Mustard","Maille Dijon","Wholegrain Mustard"],notExamples:["Mustard Powder","Honey Mustard Dressing"]},{id:"salad_dressing",name:"Salad Dressings",description:"Caesar dressing, vinaigrette, ranch",keywords:["dressing","caesar dressing","vinaigrette","ranch","thousand island","balsamic glaze","french dressing"],excludeKeywords:["salad cream"],defaultServingG:30,toleranceMin:15,toleranceMax:60,examples:["Newman's Own Caesar","Balsamic Vinaigrette","Ranch Dressing","Blue Cheese Dressing"],notExamples:["Salad Cream","Mayonnaise"]},{id:"cooking_sauce",name:"Cooking Sauces",description:"Pasta sauces, curry sauces, stir fry sauces",keywords:["pasta sauce","dolmio","ragu","curry sauce","korma sauce","tikka sauce","stir fry sauce","oyster sauce","teriyaki","pesto"],excludeKeywords:[],defaultServingG:125,toleranceMin:50,toleranceMax:250,examples:["Dolmio Bolognese Sauce","Loyd Grossman Tomato & Basil","Patak's Tikka Sauce","Blue Dragon Stir Fry"],notExamples:["Tomato Ketchup","Mayonnaise"]},{id:"oil",name:"Cooking Oils",description:"Olive oil, vegetable oil, coconut oil",keywords:["oil","olive oil","vegetable oil","sunflower oil","coconut oil","rapeseed oil","sesame oil","fry light"],excludeKeywords:["oily fish","essential oil"],defaultServingG:15,toleranceMin:5,toleranceMax:30,examples:["Filippo Berio Olive Oil","Crisp n Dry","Fry Light","Coconut Oil"],notExamples:["Fish Oil Capsules","CBD Oil"]},{id:"vinegar",name:"Vinegar",description:"Balsamic, white wine, malt vinegar",keywords:["vinegar","balsamic","white wine vinegar","red wine vinegar","malt vinegar","apple cider vinegar","rice vinegar"],excludeKeywords:[],defaultServingG:15,toleranceMin:5,toleranceMax:30,examples:["Balsamic Vinegar","Sarson's Malt Vinegar","White Wine Vinegar"],notExamples:["Balsamic Glaze","Vinaigrette"]},{id:"jam_honey",name:"Jam, Honey & Sweet Spreads",description:"Jam, marmalade, honey, Nutella, peanut butter",keywords:["jam","marmalade","honey","nutella","chocolate spread","peanut butter","almond butter","lemon curd","biscoff spread","marmite","bovril"],excludeKeywords:["jam doughnut","jammie dodger"],defaultServingG:15,toleranceMin:10,toleranceMax:40,examples:["Bonne Maman Strawberry Jam","Nutella","Sun-Pat Peanut Butter","Rowse Honey","Marmite"],notExamples:["Jam Doughnut","PB&J Sandwich"]},{id:"hummus_dips",name:"Hummus & Dips",description:"Hummus, guacamole, tzatziki, salsa",keywords:["hummus","houmous","guacamole","tzatziki","salsa","sour cream dip","taramasalata","baba ganoush"],excludeKeywords:[],defaultServingG:50,toleranceMin:25,toleranceMax:100,examples:["Sabra Hummus","Fresh Guacamole","Doritos Salsa","Tzatziki"],notExamples:["Avocado","Soured Cream"]},{id:"pickle_chutney",name:"Pickles & Chutneys",description:"Pickled onions, gherkins, mango chutney",keywords:["pickle","pickled","gherkin","chutney","branston","relish","piccalilli","sauerkraut","kimchi"],excludeKeywords:[],defaultServingG:25,toleranceMin:15,toleranceMax:60,examples:["Branston Pickle","Pickled Onions","Mango Chutney","Gherkins"],notExamples:["Fresh Cucumber","Fresh Onion"]},{id:"ice_cream",name:"Ice Cream",description:"Tubs, cones, lollies, magnums (1-2 scoops or 1 lolly)",keywords:["ice cream","gelato","magnum","ben and jerrys","haagen dazs","cornetto","twister","solero","ice lolly","fab","calippo","mini milk"],excludeKeywords:["ice cream maker","ice cream scoop"],defaultServingG:75,servingSizes:[{name:"Small scoop",grams:60},{name:"Standard scoop",grams:75},{name:"Large scoop",grams:100}],toleranceMin:40,toleranceMax:120,examples:["Ben & Jerry's Cookie Dough","Magnum Classic","Haagen-Dazs","Cornetto"],notExamples:["Frozen Yoghurt","Sorbet"]},{id:"frozen_veg",name:"Frozen Vegetables",description:"Frozen peas, sweetcorn, mixed veg",keywords:["frozen pea","frozen sweetcorn","frozen vegetable","birds eye","frozen mixed","frozen spinach","frozen broccoli"],excludeKeywords:[],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Birds Eye Garden Peas","Frozen Sweetcorn","Frozen Mixed Vegetables","Frozen Spinach"],notExamples:["Fresh Peas","Tinned Peas"]},{id:"frozen_fish_products",name:"Frozen Fish Products",description:"Fish fingers, fish cakes, breaded fish",keywords:["fish finger","fish cake","battered fish","breaded fish","fish fillet frozen","birds eye fish","youngs"],excludeKeywords:[],defaultServingG:100,toleranceMin:50,toleranceMax:200,examples:["Birds Eye Fish Fingers","Young's Fish Cakes","Battered Cod","Breaded Haddock"],notExamples:["Fresh Salmon Fillet","Tinned Tuna"]},{id:"frozen_chicken_products",name:"Frozen Chicken Products",description:"Chicken nuggets, chicken kievs, chicken dippers",keywords:["chicken nugget","chicken dipper","chicken kiev","chicken goujons","breaded chicken","southern fried chicken","chicken bites"],excludeKeywords:[],defaultServingG:100,toleranceMin:50,toleranceMax:200,examples:["Birds Eye Chicken Dippers","Chicken Nuggets","Chicken Kievs","Southern Fried Chicken"],notExamples:["Fresh Chicken Breast","Rotisserie Chicken"]},{id:"cereal_bar",name:"Cereal & Protein Bars",description:"Cereal bars, protein bars, flapjacks",keywords:["cereal bar","protein bar","flapjack","nutri-grain","nakd","trek","grenade","fulfil","kind bar","nature valley","belvita"],excludeKeywords:[],defaultServingG:40,toleranceMin:20,toleranceMax:80,examples:["Nature Valley Crunchy","Nakd Cocoa Orange","Grenade Carb Killa","Trek Protein Flapjack"],notExamples:["Chocolate Bar","Cereal Box"]},{id:"baby_food",name:"Baby Food",description:"Baby purees, baby cereals, toddler snacks",keywords:["baby food","baby puree","ella's kitchen","cow and gate","aptamil","hipp organic","baby cereal","baby rice"],excludeKeywords:[],defaultServingG:70,toleranceMin:40,toleranceMax:150,examples:["Ella's Kitchen Pouch","Cow & Gate Jar","Baby Rice","Organix Snacks"],notExamples:[]},{id:"supplements",name:"Supplements & Vitamins",description:"Vitamin tablets, protein powder, supplements",keywords:["vitamin","supplement","protein powder","whey","creatine","omega 3","fish oil capsule","multivitamin","centrum","berocca"],excludeKeywords:[],defaultServingG:30,toleranceMin:1,toleranceMax:100,examples:["Optimum Nutrition Whey","Centrum Multivitamins","Omega 3 Capsules","Berocca"],notExamples:["Fresh Fish","Orange Juice with Vitamins"]},{id:"tofu_meat_alternatives",name:"Tofu & Meat Alternatives",description:"Tofu, tempeh, Quorn, plant-based meat",keywords:["tofu","tempeh","quorn","beyond meat","impossible","this isn't","plant based","meat free","vegan mince","vegan burger","seitan"],excludeKeywords:[],defaultServingG:100,toleranceMin:50,toleranceMax:200,examples:["Cauldron Tofu","Quorn Mince","Beyond Burger","THIS Isn't Chicken"],notExamples:["Chicken Breast","Beef Mince"]},{id:"flour_baking",name:"Flour & Baking Ingredients",description:"Flour, sugar, baking powder, yeast",keywords:["flour","plain flour","self raising","bread flour","sugar","caster sugar","icing sugar","brown sugar","baking powder","yeast","cornflour"],excludeKeywords:["sugar free","no added sugar"],defaultServingG:30,toleranceMin:5,toleranceMax:100,examples:["Allinson Plain Flour","Tate & Lyle Caster Sugar","Baking Powder","Dried Yeast"],notExamples:["Cake","Bread","Biscuits"]},{id:"crackers_crispbreads",name:"Crackers & Crispbreads",description:"Cream crackers, rice cakes, oatcakes, Ryvita",keywords:["cracker","cream cracker","rice cake","ryvita","crispbread","oatcake","water biscuit","carr's","tuc"],excludeKeywords:["prawn cracker","christmas cracker"],defaultServingG:20,toleranceMin:10,toleranceMax:60,examples:["Jacob's Cream Crackers","Ryvita Original","Rice Cakes","Nairn's Oatcakes"],notExamples:["Prawn Crackers","Christmas Crackers"]},{id:"crisps_savoury_snacks",name:"Crisps & Savoury Snacks",description:"Crisps, nuts, pretzels, popcorn",keywords:["crisps","chips","pretzels","twiglets","mini cheddars","pork scratchings","bombay mix","wasabi peas"],excludeKeywords:[],defaultServingG:30,toleranceMin:15,toleranceMax:80,examples:["Walkers Ready Salted","Mini Cheddars","Twiglets","Pretzels"],notExamples:["Oven Chips","Potato Wedges"]},{id:"other",name:"Other / Uncategorized",description:"Foods that don't fit other categories",keywords:[],excludeKeywords:[],defaultServingG:100,toleranceMin:10,toleranceMax:500,examples:[],notExamples:[]}];function Mc(e){const t=e.match(/(\d+)\s*x\s*(\d+)\s*g\b/i);if(t)return parseInt(t[2],10);const s=e.match(/(\d+)\s*g\b/gi);if(s&&s.length>0){const i=s.map(r=>parseInt(r.replace(/[^\d]/g,""),10)).filter(r=>r>50);if(i.length>0)return Math.max(...i)}return null}function j3(){return`You are a food categorization expert for a UK nutrition app. Your job is to categorize food products into the correct category.

CRITICAL RULES:
1. Read the FULL product name carefully. "Cadbury Dairy Milk" is CHOCOLATE, not DAIRY.
2. "Milk Chocolate" means chocolate made with milk, NOT milk. Categorize as chocolate_bar.
3. "Chocolate Milkshake" is a milkshake flavored with chocolate. Categorize as milkshake.
4. Brand names matter: "Galaxy" = chocolate, "Yazoo" = milkshake, "Warburtons" = bread
5. If unsure between two categories, pick the more specific one.
6. Consider UK products and brands specifically.

CATEGORIES:
${ca.map(t=>`
## ${t.name} (ID: ${t.id})
${t.description}
- Default serving: ${t.defaultServingG}g
- Acceptable T0 range: ${t.toleranceMin}g - ${t.toleranceMax}g
- Examples: ${t.examples.join(", ")}
- NOT this category: ${t.notExamples.join(", ")}
`).join(`
`)}

For each food, respond with JSON in this exact format:
{
  "categoryId": "the_category_id",
  "confidence": 85,
  "reasoning": "Brief explanation of why this category"
}`}function W3(e){const t=e.map((s,i)=>{const r=s.brand?` (${s.brand})`:"",n=s.servingSizeG?` [current serving: ${s.servingSizeG}g]`:"";return`${i+1}. ${s.name}${r}${n}`}).join(`
`);return`Categorize these ${e.length} food products. Return a JSON array with one object per food in the same order:

${t}

Respond with ONLY a JSON array, no other text:
[
  {"categoryId": "...", "confidence": 85, "reasoning": "..."},
  ...
]`}async function ek(e,t,s){const i=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":s,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:8e3,system:e,messages:[{role:"user",content:t}]})});if(!i.ok){const n=await i.text();throw new Error(`Claude API error: ${i.status} - ${n}`)}const r=await i.json();return{content:r.content[0].text,inputTokens:r.usage.input_tokens,outputTokens:r.usage.output_tokens}}async function tk(e,t,s){const i=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:e},{role:"user",content:t}],max_tokens:8e3,temperature:.3})});if(!i.ok){const n=await i.text();throw new Error(`OpenAI API error: ${i.status} - ${n}`)}const r=await i.json();return{content:r.choices[0].message.content,inputTokens:r.usage.prompt_tokens,outputTokens:r.usage.completion_tokens}}function z3(e,t){const s=e.match(/\[[\s\S]*\]/);if(!s)throw new Error("Could not find JSON array in response");const i=JSON.parse(s[0]);if(!Array.isArray(i)||i.length!==t.length)throw new Error(`Expected ${t.length} results, got ${i.length}`);return i.map((r,n)=>{const o=t[n],a=ca.find(g=>g.id===r.categoryId)||ca.find(g=>g.id==="other"),l=Mc(o.name),u=o.servingSizeG!==null&&o.servingSizeG>=a.toleranceMin&&o.servingSizeG<=a.toleranceMax;let h,p;return u&&o.servingSizeG!==null?(h=o.servingSizeG,p="validated"):(h=a.defaultServingG,p="category_default"),{foodId:o.id,foodName:o.name,brand:o.brand,categoryId:a.id,categoryName:a.name,confidence:r.confidence||80,reasoning:r.reasoning||"",suggestedServingG:h,currentServingG:o.servingSizeG,servingValidated:u,packSizeG:l,servingSource:p}})}async function U3(e,t,s,i){const r=Date.now(),n=[];let o=0,a=0,l=0;const u=j3(),h=50;for(let C=0;C<e.length;C+=h){const y=e.slice(C,C+h),R=W3(y);try{const x=t==="claude-sonnet"?await ek(u,R,s):await tk(u,R,s);o+=x.inputTokens,a+=x.outputTokens;const S=z3(x.content,y);n.push(...S)}catch(x){console.error(`Batch ${C/h+1} failed:`,x),l+=y.length,y.forEach(S=>{n.push({foodId:S.id,foodName:S.name,brand:S.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:"Categorization failed",suggestedServingG:100,currentServingG:S.servingSizeG,servingValidated:!1,packSizeG:Mc(S.name),servingSource:"category_default"})})}i==null||i(Math.min(C+h,e.length),e.length),C+h<e.length&&await new Promise(x=>setTimeout(x,500))}const p=t==="claude-sonnet"?3:2.5,g=t==="claude-sonnet"?15:10,m=o/1e6*p+a/1e6*g;return{results:n,totalProcessed:e.length,totalSuccessful:e.length-l,totalFailed:l,processingTimeMs:Date.now()-r,model:t,cost:{inputTokens:o,outputTokens:a,estimatedCost:m}}}async function $3(e,t,s,i){const r=Date.now(),n=[];let o=0,a=0,l=0;const h=`You categorize UK food products. Output JSON only.

Categories: ${ca.map(y=>y.id).join(", ")}

Rules:
- CRITICAL: Read the FULL product name carefully - it determines the category, not the brand
- Brands make multiple products: Elmlea makes cream AND butter, Lurpak makes butter AND spreads, etc.
- Product name keywords like "Butter", "Spread", "Cream", "Milk" override any brand assumptions
- Use snake_case category IDs exactly as listed
- Include typical UK serving size in grams
- Confidence 0-100 based on certainty`,p=100;for(let y=0;y<e.length;y+=p){const R=e.slice(y,y+p),x=R.map((T,I)=>{const V=T.brand?` | ${T.brand}`:"";return`${I+1}. ${T.name}${V}`}).join(`
`),S=`Categorize these ${R.length} foods. Return JSON array:
[{"id":1,"cat":"category_id","serv":30,"conf":90,"why":"brief reason"},...]

${x}`;try{const T=t==="claude-sonnet"?await ek(h,S,s):await tk(h,S,s);o+=T.inputTokens,a+=T.outputTokens;const I=K3(T.content,R);n.push(...I)}catch(T){console.error(`Smart batch ${y/p+1} failed:`,T),l+=R.length,R.forEach(I=>{n.push({foodId:I.id,foodName:I.name,brand:I.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:"Smart categorization failed",suggestedServingG:100,currentServingG:I.servingSizeG,servingValidated:!1,packSizeG:Mc(I.name),servingSource:"category_default"})})}i==null||i(Math.min(y+p,e.length),e.length),y+p<e.length&&await new Promise(T=>setTimeout(T,300))}const g=t==="claude-sonnet"?3:2.5,m=t==="claude-sonnet"?15:10,C=o/1e6*g+a/1e6*m;return{results:n,totalProcessed:e.length,totalSuccessful:e.length-l,totalFailed:l,processingTimeMs:Date.now()-r,model:t,cost:{inputTokens:o,outputTokens:a,estimatedCost:C}}}function K3(e,t){const s=[];try{const i=e.match(/\[[\s\S]*\]/);if(!i)throw new Error("No JSON array found in response");const r=JSON.parse(i[0]);for(let n=0;n<t.length;n++){const o=t[n],a=r.find(l=>l.id===n+1)||r[n];if(a){const l=ca.find(y=>y.id===a.cat),u=l?a.cat:"other",h=(l==null?void 0:l.name)||"Other / Uncategorized";l||console.warn(` Unknown category ID from AI: "${a.cat}" for food: ${o.name}`);const p=Mc(o.name);let g=a.serv||100,m=!1,C="category_default";l&&(o.servingSizeG!==null&&o.servingSizeG>=l.toleranceMin&&o.servingSizeG<=l.toleranceMax?(g=o.servingSizeG,m=!0,C="validated"):p!=null&&p<l.defaultServingG&&p>=l.toleranceMin?(g=p,C="pack_size"):(g=a.serv||l.defaultServingG,C="category_default")),s.push({foodId:o.id,foodName:o.name,brand:o.brand,categoryId:u,categoryName:h,confidence:a.conf||50,reasoning:a.why||"AI categorization",suggestedServingG:g,currentServingG:o.servingSizeG,servingValidated:m,packSizeG:p,servingSource:C})}else s.push({foodId:o.id,foodName:o.name,brand:o.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:"No AI response",suggestedServingG:100,currentServingG:o.servingSizeG,servingValidated:!1,packSizeG:Mc(o.name),servingSource:"category_default"})}}catch(i){console.error("Failed to parse smart response:",i,e),t.forEach(r=>{s.push({foodId:r.id,foodName:r.name,brand:r.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:`Parse error: ${i}`,suggestedServingG:100,currentServingG:r.servingSizeG,servingValidated:!1,packSizeG:Mc(r.name),servingSource:"category_default"})})}return s}const AT="https://us-central1-nutrasafe-705c7.cloudfunctions.net",Y3=({onBack:e})=>{const[t,s]=b.useState(localStorage.getItem("claude_api_key")||""),[i,r]=b.useState(localStorage.getItem("openai_api_key")||""),[n,o]=b.useState("claude-sonnet"),[a,l]=b.useState(new Set),[u,h]=b.useState(!1),[p,g]=b.useState([]),[m,C]=b.useState(0),[y,R]=b.useState(!1),[x,S]=b.useState({current:0,total:0}),[T,I]=b.useState([]),[V,j]=b.useState(null),[P,N]=b.useState(!0),[_,L]=b.useState(500),[M,E]=b.useState(!0),[F,J]=b.useState(!0),[Y,fe]=b.useState("all"),[me,pe]=b.useState("all"),[ye,Ae]=b.useState(""),[te,ce]=b.useState(0),be=50;b.useEffect(()=>{t&&localStorage.setItem("claude_api_key",t),i&&localStorage.setItem("openai_api_key",i)},[t,i]);const Ze=b.useCallback(async()=>{if(a.size===0)return;h(!0),C(0);const O=[];try{const W=Array.from(a),ue=5e3,ae=2e3;for(let X=0;X<W.length;X++){const q=W[X];console.log(` Loading ${q}...`);let ie=0,we=!0,Ne=[],De=0,Ee=0;for(;we&&Ee<ae;){Ee++;const Oe=await fetch(`${AT}/browseAllIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indices:[q],offset:ie,pageSize:ue})});if(!Oe.ok){console.error(` ${q}: HTTP ${Oe.status}`);break}const Ue=await Oe.json();if(Ue.success&&Ue.products){const ze=Ue.products||[],re=Ue.pagination||{};if(ze.length===0){console.log(`   ${q}: Reached end (0 products returned)`),we=!1;break}ze.length<ue&&(console.log(`   ${q}: Last page (${ze.length} products)`),we=!1);const _t=ze.map(Pt=>({objectID:Pt.objectID,name:Pt.name||Pt.foodName||"Unknown",brand:Pt.brand||void 0,brandName:Pt.brandName||void 0,servingSizeG:Pt.servingSizeG||void 0,serving_size_g:Pt.serving_size_g||void 0,category:Pt.category||void 0,foodCategory:Pt.foodCategory||void 0,sourceIndex:q}));Ne.push(..._t),De=(re==null?void 0:re.total)||Ne.length;const Gs=X/W.length*100,Xt=De>0?Ne.length/De*100/W.length:0;C(Math.round(Gs+Xt)),console.log(`   ${q}: ${Ne.length.toLocaleString()} / ${De.toLocaleString()}`),re.hasMore?ie+=ue:we=!1,De>0&&Ne.length>=De&&(we=!1)}else{console.error(` ${q}: ${Ue.error||"Failed"}`);break}}Ee>=ae&&console.warn(` ${q}: Hit safety limit`),console.log(` ${q}: Loaded ${Ne.length.toLocaleString()} products`),O.push(...Ne),C(Math.round((X+1)/W.length*100))}g(O),C(100),console.log(` Total foods loaded: ${O.length.toLocaleString()}`)}catch(W){console.error("Error loading foods:",W),alert(`Error loading foods: ${W}`)}finally{h(!1)}},[a]),he=b.useCallback((O,W)=>{const ue=["milk","chocolate","milkshake","dairy","cream","bread","muffin","crumpet","brioche","chicken","nugget","kiev","fruit","juice","smoothie","cake","biscuit","cookie"],ae=[],X=[];O.forEach(we=>{const Ne=we.name.toLowerCase();ue.some(Ee=>Ne.includes(Ee))&&ae.length<W*.4?ae.push(we):X.push(we)});const q=X.sort(()=>Math.random()-.5);return[...ae,...q].slice(0,W)},[]),et=b.useCallback(async()=>{const O=n==="claude-sonnet"?t:i;if(!O){alert(`Please enter your ${n==="claude-sonnet"?"Claude":"OpenAI"} API key`);return}if(p.length===0){alert("Please load foods first");return}R(!0),I([]),j(null);try{let W=p;if(M&&(W=p.filter(Ne=>!Ne.category&&!Ne.foodCategory),console.log(`Skipping ${p.length-W.length} already categorized foods`)),W.length===0){alert("No uncategorized foods found. All foods already have categories."),R(!1);return}const ue=P?he(W,_):W;S({current:0,total:ue.length});const ae=new Map(ue.map(Ne=>[Ne.objectID,Ne.sourceIndex])),X=ue.map(Ne=>({id:Ne.objectID,name:Ne.name,brand:Ne.brand||Ne.brandName||null,servingSizeG:Ne.servingSizeG||Ne.serving_size_g||null})),ie=await(F?$3:U3)(X,n,O,(Ne,De)=>S({current:Ne,total:De})),we=ie.results.map(Ne=>({...Ne,reviewStatus:"pending",sourceIndex:ae.get(Ne.foodId)}));console.log(" Categorization complete:",{totalResults:we.length,sampleResults:we.slice(0,5).map(Ne=>({foodName:Ne.foodName,categoryId:Ne.categoryId,categoryName:Ne.categoryName})),uniqueCategories:[...new Set(we.map(Ne=>Ne.categoryId))]}),I(we),j(ie)}catch(W){console.error("Categorization failed:",W),alert(`Categorization failed: ${W}`)}finally{R(!1)}},[n,t,i,p,P,_,he]),We=b.useCallback((O,W,ue)=>{I(ae=>ae.map(X=>X.foodId===O?{...X,reviewStatus:W,editedCategoryId:ue}:X))},[]),se=b.useCallback(()=>{const O=new Set(T.filter(W=>{var ue;if(Y!=="all"&&W.categoryId!==Y||me!=="all"&&W.reviewStatus!==me)return!1;if(ye){const ae=ye.toLowerCase();if(!W.foodName.toLowerCase().includes(ae)&&!((ue=W.brand)!=null&&ue.toLowerCase().includes(ae)))return!1}return!0}).map(W=>W.foodId));I(W=>W.map(ue=>O.has(ue.foodId)&&ue.reviewStatus==="pending"?{...ue,reviewStatus:"approved"}:ue))},[T,Y,me,ye]),[ne,B]=b.useState(!1),$=b.useCallback(async()=>{const O=T.filter(W=>W.reviewStatus==="approved"||W.reviewStatus==="edited");if(O.length===0){alert("No approved or edited items to save.");return}if(confirm(`Save ${O.length} categorizations to the database?

This will update:
- Category
- Serving size (validated or estimated)`)){B(!0);try{const W=O.map(we=>({objectID:we.foodId,sourceIndex:we.sourceIndex||"unknown",categoryId:we.editedCategoryId||we.categoryId,servingSizeG:we.suggestedServingG,servingValidated:we.servingValidated||!1,servingSource:we.servingSource||"category_default"})),ue=await fetch(`${AT}/batchSaveFoodCategories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foods:W})}),ae=await ue.json();if(!ue.ok)throw new Error(ae.error||"Failed to save");const X=ae.firestoreUpdated>0?`Firestore: ${ae.firestoreUpdated} ( Algolia syncs automatically)`:"",q=ae.algoliaUpdated>0?`Algolia-only: ${ae.algoliaUpdated}`:"",ie=[X,q].filter(Boolean).join(`
`);alert(`Successfully saved ${ae.total} categorizations!

${ie}`),I(we=>we.filter(Ne=>Ne.reviewStatus!=="approved"&&Ne.reviewStatus!=="edited"))}catch(W){console.error("Save failed:",W),alert(`Save failed: ${W}`)}finally{B(!1)}}},[T]),K=T.filter(O=>{var W;if(Y!=="all"&&O.categoryId!==Y||me!=="all"&&O.reviewStatus!==me)return!1;if(ye){const ue=ye.toLowerCase();if(!O.foodName.toLowerCase().includes(ue)&&!((W=O.brand)!=null&&W.toLowerCase().includes(ue)))return!1}return!0}),Q=Math.ceil(K.length/be),oe=K.slice(te*be,(te+1)*be),Z={pending:T.filter(O=>O.reviewStatus==="pending").length,approved:T.filter(O=>O.reviewStatus==="approved").length,rejected:T.filter(O=>O.reviewStatus==="rejected").length,edited:T.filter(O=>O.reviewStatus==="edited").length},k=ca.map(O=>({...O,count:T.filter(W=>W.categoryId===O.id).length})).filter(O=>O.count>0).sort((O,W)=>W.count-O.count);return c.jsxs("div",{style:{padding:"24px",maxWidth:"1600px",margin:"0 auto"},children:[c.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:c.jsxs("div",{children:[c.jsx("button",{onClick:e,style:{padding:"8px 16px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",marginBottom:"8px"},children:" Back"}),c.jsx("h1",{style:{margin:0,fontSize:"28px",fontWeight:"bold"},children:"Food Categorizer"}),c.jsx("p",{style:{margin:"8px 0 0",color:"#6b7280"},children:"AI-powered food categorization with tiered serving sizes"})]})}),c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("h2",{style:{margin:"0 0 16px",fontSize:"18px"},children:"Configuration"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:"AI Model"}),c.jsxs("div",{style:{display:"flex",gap:"12px"},children:[c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[c.jsx("input",{type:"radio",checked:n==="claude-sonnet",onChange:()=>o("claude-sonnet")}),"Claude 3.5 Sonnet"]}),c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[c.jsx("input",{type:"radio",checked:n==="gpt-4o",onChange:()=>o("gpt-4o")}),"GPT-4o"]})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:n==="claude-sonnet"?"Claude API Key":"OpenAI API Key"}),n==="claude-sonnet"?c.jsx("input",{type:"password",value:t,onChange:O=>s(O.target.value),placeholder:"sk-ant-...",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}}):c.jsx("input",{type:"password",value:i,onChange:O=>r(O.target.value),placeholder:"sk-...",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}})]}),c.jsxs("div",{children:[c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:P,onChange:O=>N(O.target.checked)}),c.jsx("span",{style:{fontWeight:"500"},children:"Test Mode"}),c.jsxs("span",{style:{color:"#6b7280",fontSize:"14px"},children:["(Process ",_," foods first)"]})]}),P&&c.jsx("input",{type:"number",value:_,onChange:O=>L(Math.max(50,Math.min(1e3,parseInt(O.target.value)||500))),min:50,max:1e3,style:{marginTop:"8px",width:"120px",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px"}}),c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"12px"},children:[c.jsx("input",{type:"checkbox",checked:M,onChange:O=>E(O.target.checked)}),c.jsx("span",{style:{fontWeight:"500"},children:"Skip Already Categorized"}),c.jsx("span",{style:{color:"#6b7280",fontSize:"14px"},children:"(Ignore foods with existing category)"})]}),c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"12px"},children:[c.jsx("input",{type:"checkbox",checked:F,onChange:O=>J(O.target.checked)}),c.jsx("span",{style:{fontWeight:"500",color:"#059669"},children:" Smart Mode"}),c.jsx("span",{style:{color:"#6b7280",fontSize:"14px"},children:"(Minimal prompts - ~50% cheaper, lets AI use its knowledge)"})]})]})]}),c.jsxs("div",{style:{marginTop:"20px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:"Select Databases"}),c.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:Jt.map(O=>c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",background:a.has(O)?"#dbeafe":"#f3f4f6",borderRadius:"6px",cursor:"pointer",border:a.has(O)?"1px solid #3b82f6":"1px solid transparent"},children:[c.jsx("input",{type:"checkbox",checked:a.has(O),onChange:W=>{const ue=new Set(a);W.target.checked?ue.add(O):ue.delete(O),l(ue)}}),O.replace(/_/g," ")]},O))})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"20px"},children:[c.jsx("button",{onClick:Ze,disabled:u||a.size===0,style:{padding:"12px 24px",background:u?"#9ca3af":"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:u?"not-allowed":"pointer"},children:u?`Loading... ${m}%`:"Load Foods"}),c.jsx("button",{onClick:et,disabled:y||p.length===0,style:{padding:"12px 24px",background:y?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:y?"not-allowed":"pointer"},children:y?`Processing... ${x.current}/${x.total}`:P?`Run Test (${_} foods)`:`Categorize All (${p.length} foods)`}),p.length>0&&c.jsxs("span",{style:{display:"flex",alignItems:"center",color:"#6b7280"},children:[p.length.toLocaleString()," foods loaded"]})]})]}),T.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Total Processed"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold"},children:T.length})]}),c.jsxs("div",{style:{background:"#fef3c7",borderRadius:"12px",padding:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400e"},children:"Pending Review"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#92400e"},children:Z.pending})]}),c.jsxs("div",{style:{background:"#d1fae5",borderRadius:"12px",padding:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#065f46"},children:"Approved"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#065f46"},children:Z.approved})]}),c.jsxs("div",{style:{background:"#fee2e2",borderRadius:"12px",padding:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#991b1b"},children:"Rejected"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#991b1b"},children:Z.rejected})]}),V&&c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Estimated Cost"}),c.jsxs("div",{style:{fontSize:"28px",fontWeight:"bold"},children:["$",V.cost.estimatedCost.toFixed(2)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#9ca3af"},children:[V.cost.inputTokens.toLocaleString()," in / ",V.cost.outputTokens.toLocaleString()," out"]})]})]}),c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("h3",{style:{margin:"0 0 16px",fontSize:"16px"},children:"Category Distribution"}),c.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:k.slice(0,20).map(O=>c.jsxs("span",{onClick:()=>fe(Y===O.id?"all":O.id),style:{padding:"6px 12px",background:Y===O.id?"#3b82f6":"#f3f4f6",color:Y===O.id?"white":"#374151",borderRadius:"16px",fontSize:"13px",cursor:"pointer"},children:[O.name,": ",O.count]},O.id))})]}),c.jsxs("div",{style:{display:"flex",gap:"16px",marginBottom:"16px",alignItems:"center",flexWrap:"wrap"},children:[c.jsx("input",{type:"text",placeholder:"Search foods...",value:ye,onChange:O=>{Ae(O.target.value),ce(0)},style:{padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:"6px",width:"250px"}}),c.jsxs("select",{value:me,onChange:O=>{pe(O.target.value),ce(0)},style:{padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:"6px"},children:[c.jsx("option",{value:"all",children:"All Status"}),c.jsx("option",{value:"pending",children:"Pending"}),c.jsx("option",{value:"approved",children:"Approved"}),c.jsx("option",{value:"rejected",children:"Rejected"}),c.jsx("option",{value:"edited",children:"Edited"})]}),c.jsxs("select",{value:Y,onChange:O=>{fe(O.target.value),ce(0)},style:{padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:"6px"},children:[c.jsx("option",{value:"all",children:"All Categories"}),ca.map(O=>c.jsx("option",{value:O.id,children:O.name},O.id))]}),c.jsxs("button",{onClick:se,style:{padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:["Approve All Visible (",K.filter(O=>O.reviewStatus==="pending").length,")"]}),c.jsx("button",{onClick:$,disabled:ne||Z.approved+Z.edited===0,style:{padding:"10px 16px",background:Z.approved+Z.edited>0?"#3b82f6":"#9ca3af",color:"white",border:"none",borderRadius:"6px",cursor:Z.approved+Z.edited>0?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"8px"},children:ne?c.jsx(c.Fragment,{children:"Saving..."}):c.jsxs(c.Fragment,{children:[" Save to Database (",Z.approved+Z.edited,")"]})}),c.jsxs("span",{style:{color:"#6b7280",marginLeft:"auto"},children:["Showing ",K.length," of ",T.length]})]}),c.jsx("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:[c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Food"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Category"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"center",fontWeight:"600",fontSize:"13px"},children:"Confidence"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Serving"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Reasoning"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"center",fontWeight:"600",fontSize:"13px"},children:"Actions"})]})}),c.jsx("tbody",{children:oe.map((O,W)=>c.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",background:O.reviewStatus==="approved"?"#f0fdf4":O.reviewStatus==="rejected"?"#fef2f2":O.reviewStatus==="edited"?"#fefce8":W%2===0?"white":"#f9fafb"},children:[c.jsxs("td",{style:{padding:"12px 16px"},children:[c.jsx("div",{style:{fontWeight:"500"},children:O.foodName}),O.brand&&c.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:O.brand})]}),c.jsx("td",{style:{padding:"12px 16px"},children:c.jsx("select",{value:O.editedCategoryId||O.categoryId,onChange:ue=>{ue.target.value!==O.categoryId&&We(O.foodId,"edited",ue.target.value)},style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"13px",maxWidth:"200px"},children:ca.map(ue=>c.jsx("option",{value:ue.id,children:ue.name},ue.id))})}),c.jsx("td",{style:{padding:"12px 16px",textAlign:"center"},children:c.jsxs("span",{style:{display:"inline-block",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"500",background:O.confidence>=90?"#d1fae5":O.confidence>=70?"#fef3c7":"#fee2e2",color:O.confidence>=90?"#065f46":O.confidence>=70?"#92400e":"#991b1b"},children:[O.confidence,"%"]})}),c.jsxs("td",{style:{padding:"12px 16px",fontSize:"13px"},children:[c.jsx("div",{children:O.servingSource==="validated"?c.jsxs(c.Fragment,{children:[c.jsx("span",{style:{display:"inline-block",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:"500",background:"#d1fae5",color:"#065f46",marginRight:"6px"},children:"Validated"}),O.suggestedServingG,"g"]}):O.servingSource==="pack_size"?c.jsxs(c.Fragment,{children:[c.jsx("span",{style:{display:"inline-block",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:"500",background:"#dbeafe",color:"#1e40af",marginRight:"4px"},children:"Pack Size"}),c.jsx("span",{title:"Using pack size from product name to prevent over-portioning. The category default was higher than the actual pack size.",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",borderRadius:"50%",background:"#bfdbfe",color:"#1e40af",fontSize:"10px",fontWeight:"600",cursor:"help",marginRight:"6px"},children:"i"}),O.suggestedServingG,"g"]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{style:{display:"inline-block",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:"500",background:"#fef3c7",color:"#92400e",marginRight:"4px"},children:"Estimated"}),c.jsx("span",{title:"We couldn't guarantee the serving size. Check on the label and edit before you add.",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",borderRadius:"50%",background:"#d1d5db",color:"#4b5563",fontSize:"10px",fontWeight:"600",cursor:"help",marginRight:"6px"},children:"i"}),O.suggestedServingG,"g"]})}),O.packSizeG&&O.servingSource!=="pack_size"&&c.jsxs("div",{style:{fontSize:"11px",color:"#6b7280"},children:["Pack: ",O.packSizeG,"g"]}),O.currentServingG&&!O.servingValidated&&c.jsxs("div",{style:{fontSize:"11px",color:"#9ca3af"},children:["DB: ",O.currentServingG,"g (out of range)"]}),!O.currentServingG&&c.jsx("div",{style:{fontSize:"11px",color:"#9ca3af"},children:"No DB serving"})]}),c.jsx("td",{style:{padding:"12px 16px",fontSize:"12px",color:"#6b7280",maxWidth:"250px"},children:O.reasoning}),c.jsx("td",{style:{padding:"12px 16px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>We(O.foodId,"approved"),title:"Approve",style:{padding:"6px 10px",background:O.reviewStatus==="approved"?"#10b981":"#e5e7eb",color:O.reviewStatus==="approved"?"white":"#374151",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:""}),c.jsx("button",{onClick:()=>We(O.foodId,"rejected"),title:"Reject",style:{padding:"6px 10px",background:O.reviewStatus==="rejected"?"#ef4444":"#e5e7eb",color:O.reviewStatus==="rejected"?"white":"#374151",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:""})]})})]},O.foodId))})]})}),Q>1&&c.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",marginTop:"16px"},children:[c.jsx("button",{onClick:()=>ce(O=>Math.max(0,O-1)),disabled:te===0,style:{padding:"8px 16px",background:te===0?"#e5e7eb":"#3b82f6",color:te===0?"#9ca3af":"white",border:"none",borderRadius:"6px",cursor:te===0?"not-allowed":"pointer"},children:"Previous"}),c.jsxs("span",{style:{color:"#6b7280"},children:["Page ",te+1," of ",Q]}),c.jsx("button",{onClick:()=>ce(O=>Math.min(Q-1,O+1)),disabled:te>=Q-1,style:{padding:"8px 16px",background:te>=Q-1?"#e5e7eb":"#3b82f6",color:te>=Q-1?"#9ca3af":"white",border:"none",borderRadius:"6px",cursor:te>=Q-1?"not-allowed":"pointer"},children:"Next"})]})]})]})},q3=new g1({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});JW();const Q3=()=>{const{setFoods:e,setLoading:t,setLoadingProgress:s,setStats:i,setDuplicateGroups:r,getDirtyFoods:n,clearDirty:o,foods:a,isLoading:l,loadingMessage:u,loadingProgress:h,selectedFoodIds:p,getFoodById:g,deselectAll:m,setFoodReportIds:C}=oa(),[y,R]=b.useState(!1),[x,S]=b.useState(!1),[T,I]=b.useState(!1),[V,j]=b.useState(!1),[P,N]=b.useState(!1),[_,L]=b.useState(!1),[M,E]=b.useState("grid"),[F,J]=b.useState(0);b.useEffect(()=>{(async()=>{try{const Ze=await(await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/getUserReports")).json();if(Ze.success){const he=Ze.reports||[],et=he.filter(se=>se.status==="pending").length;J(et);const We=new Set;he.forEach(se=>{var B,$;const ne=((B=se.food)==null?void 0:B.id)||(($=se.food)==null?void 0:$.objectID)||se.foodId;ne&&We.add(ne)}),C(We)}}catch(be){console.error("Error loading reports count:",be)}})()},[C]);const Y=Pe.useRef(!1),fe=b.useCallback(async()=>{if(!Y.current){Y.current=!0,t(!0,"Loading food database..."),s(0);try{console.log("Starting data load..."),t(!0,"Getting index stats...");const ce=await Kj();console.log("Index stats:",ce);let be=0;const Ze={};Jt.forEach(We=>{var se;Ze[We]=((se=ce[We])==null?void 0:se.entries)||0,be+=Ze[We]}),s(10),console.log(`Total foods across indices: ${be}`),t(!0,"Loading foods from indices...");const{foods:he}=await QI("",[...Jt],{hitsPerPage:10});console.log(`Loaded ${he.length} foods`),s(80);const et={totalFoods:be,byIndex:Ze,verified:he.filter(We=>We.isVerified).length,unverified:he.filter(We=>!We.isVerified).length,withIssues:he.filter(We=>We._reviewFlags.length>0).length,duplicateGroups:0,lastUpdated:new Date};i(et),e(he),s(100),console.log("Data load complete")}catch(ce){console.error("Error loading data:",ce),alert(`Error loading data: ${ce instanceof Error?ce.message:String(ce)}`)}finally{t(!1)}}},[t,s,i,e]);b.useEffect(()=>{fe()},[]);const me=b.useCallback(async()=>{const ce=n();if(ce.length!==0){R(!0);try{const be=ce.map(he=>({food:he,updates:{name:he.name,brandName:he.brandName,barcode:he.barcode,ingredientsText:he.ingredientsText,calories:he.calories,protein:he.protein,carbs:he.carbs,fat:he.fat,saturatedFat:he.saturatedFat,fiber:he.fiber,sugar:he.sugar,sodium:he.sodium,salt:he.salt,servingDescription:he.servingDescription,servingSizeG:he.servingSizeG,isPerUnit:he.isPerUnit}})),Ze=await ez(be);Ze.success>0&&(o(),console.log(`Saved ${Ze.success} foods`)),Ze.failed>0&&(console.error(`Failed to save ${Ze.failed} foods:`,Ze.errors),alert(`Failed to save ${Ze.failed} foods. Check console for details.`))}catch(be){console.error("Error saving:",be),alert("Error saving changes. Please try again.")}finally{R(!1)}}},[n,o]),pe=b.useCallback(async()=>{if(!(p.length===0||!window.confirm(`Are you sure you want to delete ${p.length} food(s)? This action cannot be undone.`))){S(!0);try{const be=p.map(he=>g(he)).filter(he=>he!==void 0);if(be.length===0){alert("No foods found to delete.");return}const Ze=await tz(be);if(Ze.success>0){const he=new Set(be.map(We=>We._id)),et=a.filter(We=>!he.has(We._id));e(et),m(),console.log(`Deleted ${Ze.success} foods`)}Ze.failed>0&&(console.error(`Failed to delete ${Ze.failed} foods:`,Ze.errors),alert(`Failed to delete ${Ze.failed} foods. Check console for details.`))}catch(be){console.error("Error deleting:",be),alert("Error deleting foods. Please try again.")}finally{S(!1)}}},[p,g,a,e,m]),ye=b.useCallback(async ce=>{if(!(p.length===0||!window.confirm(`Move ${p.length} food(s) to ${ce}? This will remove them from their current index.`))){I(!0);try{const Ze=p.map(et=>g(et)).filter(et=>et!==void 0);if(Ze.length===0){alert("No foods found to move.");return}console.log(`Moving ${Ze.length} foods to ${ce}`);const he=await iz(Ze,ce);he.success>0&&(console.log(` Moved ${he.success} foods to ${ce}`),await fe(),m(),alert(`Successfully moved ${he.success} food(s) to ${ce}!`)),he.failed>0&&(console.error(`Failed to move ${he.failed} foods:`,he.errors),alert(`Failed to move ${he.failed} foods. Check console for details.`))}catch(Ze){console.error("Error moving:",Ze),alert("Error moving foods. Please try again.")}finally{I(!1)}}},[p,g,m,fe]),Ae=b.useCallback(async()=>{j(!0);try{const ce=R3(a,{minScore:30,maxGroups:500});r(ce),console.log(`Found ${ce.length} duplicate groups`),L(!0)}catch(ce){console.error("Error detecting duplicates:",ce)}finally{j(!1)}},[a,r]),te=b.useCallback(()=>{N(!0)},[]);return M==="image-processing"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(F3,{onBack:()=>E("grid")})}):M==="google-scraper"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(V3,{onBack:()=>E("grid")})}):M==="reports"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(B3,{onBack:()=>{E("grid"),fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/getUserReports").then(ce=>ce.json()).then(ce=>{if(ce.success){const be=ce.reports||[],Ze=be.filter(et=>et.status==="pending").length;J(Ze);const he=new Set;be.forEach(et=>{var se,ne;const We=((se=et.food)==null?void 0:se.id)||((ne=et.food)==null?void 0:ne.objectID)||et.foodId;We&&he.add(We)}),C(he)}}).catch(()=>{})}})}):M==="master-builder"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(H3,{onBack:()=>E("grid")})}):M==="food-categorizer"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(Y3,{onBack:()=>E("grid")})}):c.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[c.jsx(qj,{onSave:me,onRefresh:fe,onDeleteSelected:pe,onMoveSelected:ye,onReports:()=>E("reports"),pendingReportsCount:F,isSaving:y,isDeleting:x,isMoving:T}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx(Qj,{onDetectDuplicates:Ae,onLookupOFF:te,onImageProcessing:()=>E("image-processing"),onGoogleScraper:()=>E("google-scraper"),onReports:()=>E("reports"),onMasterBuilder:()=>E("master-builder"),onFoodCategorizer:()=>E("food-categorizer"),isDetectingDuplicates:V,pendingReportsCount:F}),c.jsx("main",{className:"flex-1 overflow-hidden",children:c.jsx(Bj,{})})]}),l&&c.jsx(Zj,{message:u,progress:h}),P&&c.jsx(I$,{onClose:()=>N(!1),onImport:()=>{fe(),N(!1),console.log("Imported food from OpenFoodFacts")},selectedFoods:p.map(ce=>g(ce)).filter(ce=>ce!==void 0)}),_&&c.jsx(D3,{onClose:()=>L(!1)})]})},Z3=()=>c.jsx(m1,{client:q3,children:c.jsx(Q3,{})});UC.createRoot(document.getElementById("root")).render(c.jsx(Pe.StrictMode,{children:c.jsx(Z3,{})}));
//# sourceMappingURL=index-C6T_T8fS.js.map
