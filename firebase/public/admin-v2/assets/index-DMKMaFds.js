var eE=e=>{throw TypeError(e)};var Fv=(e,t,s)=>t.has(e)||eE("Cannot "+s);var we=(e,t,s)=>(Fv(e,t,"read from private field"),s?s.call(e):t.get(e)),Pt=(e,t,s)=>t.has(e)?eE("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),dt=(e,t,s,i)=>(Fv(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),Qs=(e,t,s)=>(Fv(e,t,"access private method"),s);var Gp=(e,t,s,i)=>({set _(r){dt(e,t,r,s)},get _(){return we(e,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();var fk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function um(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var GT={exports:{}},dm={},VT={exports:{}},Tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sp=Symbol.for("react.element"),mk=Symbol.for("react.portal"),vk=Symbol.for("react.fragment"),Ck=Symbol.for("react.strict_mode"),yk=Symbol.for("react.profiler"),wk=Symbol.for("react.provider"),Sk=Symbol.for("react.context"),xk=Symbol.for("react.forward_ref"),Ek=Symbol.for("react.suspense"),bk=Symbol.for("react.memo"),Rk=Symbol.for("react.lazy"),tE=Symbol.iterator;function Tk(e){return e===null||typeof e!="object"?null:(e=tE&&e[tE]||e["@@iterator"],typeof e=="function"?e:null)}var BT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HT=Object.assign,jT={};function du(e,t,s){this.props=e,this.context=t,this.refs=jT,this.updater=s||BT}du.prototype.isReactComponent={};du.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};du.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function WT(){}WT.prototype=du.prototype;function Qw(e,t,s){this.props=e,this.context=t,this.refs=jT,this.updater=s||BT}var Zw=Qw.prototype=new WT;Zw.constructor=Qw;HT(Zw,du.prototype);Zw.isPureReactComponent=!0;var sE=Array.isArray,zT=Object.prototype.hasOwnProperty,Jw={current:null},UT={key:!0,ref:!0,__self:!0,__source:!0};function $T(e,t,s){var i,r={},n=null,o=null;if(t!=null)for(i in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(n=""+t.key),t)zT.call(t,i)&&!UT.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(a===1)r.children=s;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:sp,type:e,key:n,ref:o,props:r,_owner:Jw.current}}function Dk(e,t){return{$$typeof:sp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Xw(e){return typeof e=="object"&&e!==null&&e.$$typeof===sp}function Pk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var iE=/\/+/g;function Iv(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Pk(""+e.key):t.toString(36)}function pg(e,t,s,i,r){var n=typeof e;(n==="undefined"||n==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(n){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case sp:case mk:o=!0}}if(o)return o=e,r=r(o),e=i===""?"."+Iv(o,0):i,sE(r)?(s="",e!=null&&(s=e.replace(iE,"$&/")+"/"),pg(r,t,s,"",function(u){return u})):r!=null&&(Xw(r)&&(r=Dk(r,s+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(iE,"$&/")+"/")+e)),t.push(r)),1;if(o=0,i=i===""?".":i+":",sE(e))for(var a=0;a<e.length;a++){n=e[a];var l=i+Iv(n,a);o+=pg(n,t,s,l,r)}else if(l=Tk(e),typeof l=="function")for(e=l.call(e),a=0;!(n=e.next()).done;)n=n.value,l=i+Iv(n,a++),o+=pg(n,t,s,l,r);else if(n==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Vp(e,t,s){if(e==null)return e;var i=[],r=0;return pg(e,i,"","",function(n){return t.call(s,n,r++)}),i}function Ak(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var yi={current:null},gg={transition:null},Fk={ReactCurrentDispatcher:yi,ReactCurrentBatchConfig:gg,ReactCurrentOwner:Jw};function KT(){throw Error("act(...) is not supported in production builds of React.")}Tt.Children={map:Vp,forEach:function(e,t,s){Vp(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return Vp(e,function(){t++}),t},toArray:function(e){return Vp(e,function(t){return t})||[]},only:function(e){if(!Xw(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Tt.Component=du;Tt.Fragment=vk;Tt.Profiler=yk;Tt.PureComponent=Qw;Tt.StrictMode=Ck;Tt.Suspense=Ek;Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fk;Tt.act=KT;Tt.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=HT({},e.props),r=e.key,n=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(n=t.ref,o=Jw.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)zT.call(t,l)&&!UT.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=s;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:sp,type:e.type,key:r,ref:n,props:i,_owner:o}};Tt.createContext=function(e){return e={$$typeof:Sk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:wk,_context:e},e.Consumer=e};Tt.createElement=$T;Tt.createFactory=function(e){var t=$T.bind(null,e);return t.type=e,t};Tt.createRef=function(){return{current:null}};Tt.forwardRef=function(e){return{$$typeof:xk,render:e}};Tt.isValidElement=Xw;Tt.lazy=function(e){return{$$typeof:Rk,_payload:{_status:-1,_result:e},_init:Ak}};Tt.memo=function(e,t){return{$$typeof:bk,type:e,compare:t===void 0?null:t}};Tt.startTransition=function(e){var t=gg.transition;gg.transition={};try{e()}finally{gg.transition=t}};Tt.unstable_act=KT;Tt.useCallback=function(e,t){return yi.current.useCallback(e,t)};Tt.useContext=function(e){return yi.current.useContext(e)};Tt.useDebugValue=function(){};Tt.useDeferredValue=function(e){return yi.current.useDeferredValue(e)};Tt.useEffect=function(e,t){return yi.current.useEffect(e,t)};Tt.useId=function(){return yi.current.useId()};Tt.useImperativeHandle=function(e,t,s){return yi.current.useImperativeHandle(e,t,s)};Tt.useInsertionEffect=function(e,t){return yi.current.useInsertionEffect(e,t)};Tt.useLayoutEffect=function(e,t){return yi.current.useLayoutEffect(e,t)};Tt.useMemo=function(e,t){return yi.current.useMemo(e,t)};Tt.useReducer=function(e,t,s){return yi.current.useReducer(e,t,s)};Tt.useRef=function(e){return yi.current.useRef(e)};Tt.useState=function(e){return yi.current.useState(e)};Tt.useSyncExternalStore=function(e,t,s){return yi.current.useSyncExternalStore(e,t,s)};Tt.useTransition=function(){return yi.current.useTransition()};Tt.version="18.3.1";VT.exports=Tt;var E=VT.exports;const Fe=um(E);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ik=E,Nk=Symbol.for("react.element"),_k=Symbol.for("react.fragment"),kk=Object.prototype.hasOwnProperty,Mk=Ik.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lk={key:!0,ref:!0,__self:!0,__source:!0};function YT(e,t,s){var i,r={},n=null,o=null;s!==void 0&&(n=""+s),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(o=t.ref);for(i in t)kk.call(t,i)&&!Lk.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)r[i]===void 0&&(r[i]=t[i]);return{$$typeof:Nk,type:e,key:n,ref:o,props:r,_owner:Mk.current}}dm.Fragment=_k;dm.jsx=YT;dm.jsxs=YT;GT.exports=dm;var c=GT.exports,zC={},qT={exports:{}},lr={},QT={exports:{}},ZT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(de,ye){var pe=de.length;de.push(ye);e:for(;0<pe;){var q=pe-1>>>1,ve=de[q];if(0<r(ve,ye))de[q]=ye,de[pe]=ve,pe=q;else break e}}function s(de){return de.length===0?null:de[0]}function i(de){if(de.length===0)return null;var ye=de[0],pe=de.pop();if(pe!==ye){de[0]=pe;e:for(var q=0,ve=de.length,$=ve>>>1;q<$;){var be=2*(q+1)-1,se=de[be],Ge=be+1,Re=de[Ge];if(0>r(se,pe))Ge<ve&&0>r(Re,se)?(de[q]=Re,de[Ge]=pe,q=Ge):(de[q]=se,de[be]=pe,q=be);else if(Ge<ve&&0>r(Re,pe))de[q]=Re,de[Ge]=pe,q=Ge;else break e}}return ye}function r(de,ye){var pe=de.sortIndex-ye.sortIndex;return pe!==0?pe:de.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;e.unstable_now=function(){return n.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,p=null,g=3,m=!1,C=!1,y=!1,R=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(de){for(var ye=s(u);ye!==null;){if(ye.callback===null)i(u);else if(ye.startTime<=de)i(u),ye.sortIndex=ye.expirationTime,t(l,ye);else break;ye=s(u)}}function I(de){if(y=!1,T(de),!C)if(s(l)!==null)C=!0,ge(V);else{var ye=s(u);ye!==null&&me(I,ye.startTime-de)}}function V(de,ye){C=!1,y&&(y=!1,x(N),N=-1),m=!0;var pe=g;try{for(T(ye),p=s(l);p!==null&&(!(p.expirationTime>ye)||de&&!M());){var q=p.callback;if(typeof q=="function"){p.callback=null,g=p.priorityLevel;var ve=q(p.expirationTime<=ye);ye=e.unstable_now(),typeof ve=="function"?p.callback=ve:p===s(l)&&i(l),T(ye)}else i(l);p=s(l)}if(p!==null)var $=!0;else{var be=s(u);be!==null&&me(I,be.startTime-ye),$=!1}return $}finally{p=null,g=pe,m=!1}}var H=!1,P=null,N=-1,_=5,L=-1;function M(){return!(e.unstable_now()-L<_)}function b(){if(P!==null){var de=e.unstable_now();L=de;var ye=!0;try{ye=P(!0,de)}finally{ye?F():(H=!1,P=null)}}else H=!1}var F;if(typeof S=="function")F=function(){S(b)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,K=Z.port2;Z.port1.onmessage=b,F=function(){K.postMessage(null)}}else F=function(){R(b,0)};function ge(de){P=de,H||(H=!0,F())}function me(de,ye){N=R(function(){de(e.unstable_now())},ye)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(de){de.callback=null},e.unstable_continueExecution=function(){C||m||(C=!0,ge(V))},e.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<de?Math.floor(1e3/de):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return s(l)},e.unstable_next=function(de){switch(g){case 1:case 2:case 3:var ye=3;break;default:ye=g}var pe=g;g=ye;try{return de()}finally{g=pe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(de,ye){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var pe=g;g=de;try{return ye()}finally{g=pe}},e.unstable_scheduleCallback=function(de,ye,pe){var q=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?q+pe:q):pe=q,de){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=pe+ve,de={id:h++,callback:ye,priorityLevel:de,startTime:pe,expirationTime:ve,sortIndex:-1},pe>q?(de.sortIndex=pe,t(u,de),s(l)===null&&de===s(u)&&(y?(x(N),N=-1):y=!0,me(I,pe-q))):(de.sortIndex=ve,t(l,de),C||m||(C=!0,ge(V))),de},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(de){var ye=g;return function(){var pe=g;g=ye;try{return de.apply(this,arguments)}finally{g=pe}}}})(ZT);QT.exports=ZT;var Ok=QT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gk=E,nr=Ok;function Oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var JT=new Set,Gd={};function Al(e,t){Lc(e,t),Lc(e+"Capture",t)}function Lc(e,t){for(Gd[e]=t,e=0;e<t.length;e++)JT.add(t[e])}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),UC=Object.prototype.hasOwnProperty,Vk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rE={},nE={};function Bk(e){return UC.call(nE,e)?!0:UC.call(rE,e)?!1:Vk.test(e)?nE[e]=!0:(rE[e]=!0,!1)}function Hk(e,t,s,i){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function jk(e,t,s,i){if(t===null||typeof t>"u"||Hk(e,t,s,i))return!0;if(i)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function wi(e,t,s,i,r,n,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=o}var Us={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Us[e]=new wi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Us[t]=new wi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Us[e]=new wi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Us[e]=new wi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Us[e]=new wi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Us[e]=new wi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Us[e]=new wi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Us[e]=new wi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Us[e]=new wi(e,5,!1,e.toLowerCase(),null,!1,!1)});var eS=/[\-:]([a-z])/g;function tS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(eS,tS);Us[t]=new wi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(eS,tS);Us[t]=new wi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(eS,tS);Us[t]=new wi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Us[e]=new wi(e,1,!1,e.toLowerCase(),null,!1,!1)});Us.xlinkHref=new wi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Us[e]=new wi(e,1,!1,e.toLowerCase(),null,!0,!0)});function sS(e,t,s,i){var r=Us.hasOwnProperty(t)?Us[t]:null;(r!==null?r.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(jk(t,s,r,i)&&(s=null),i||r===null?Bk(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):r.mustUseProperty?e[r.propertyName]=s===null?r.type===3?!1:"":s:(t=r.attributeName,i=r.attributeNamespace,s===null?e.removeAttribute(t):(r=r.type,s=r===3||r===4&&s===!0?"":""+s,i?e.setAttributeNS(i,t,s):e.setAttribute(t,s))))}var no=Gk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bp=Symbol.for("react.element"),sc=Symbol.for("react.portal"),ic=Symbol.for("react.fragment"),iS=Symbol.for("react.strict_mode"),$C=Symbol.for("react.profiler"),XT=Symbol.for("react.provider"),eD=Symbol.for("react.context"),rS=Symbol.for("react.forward_ref"),KC=Symbol.for("react.suspense"),YC=Symbol.for("react.suspense_list"),nS=Symbol.for("react.memo"),bo=Symbol.for("react.lazy"),tD=Symbol.for("react.offscreen"),oE=Symbol.iterator;function $u(e){return e===null||typeof e!="object"?null:(e=oE&&e[oE]||e["@@iterator"],typeof e=="function"?e:null)}var hs=Object.assign,Nv;function nd(e){if(Nv===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Nv=t&&t[1]||""}return`
`+Nv+e}var _v=!1;function kv(e,t){if(!e||_v)return"";_v=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var i=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){i=u}e.call(t.prototype)}else{try{throw Error()}catch(u){i=u}e()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),n=i.stack.split(`
`),o=r.length-1,a=n.length-1;1<=o&&0<=a&&r[o]!==n[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==n[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==n[a]){var l=`
`+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{_v=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?nd(e):""}function Wk(e){switch(e.tag){case 5:return nd(e.type);case 16:return nd("Lazy");case 13:return nd("Suspense");case 19:return nd("SuspenseList");case 0:case 2:case 15:return e=kv(e.type,!1),e;case 11:return e=kv(e.type.render,!1),e;case 1:return e=kv(e.type,!0),e;default:return""}}function qC(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ic:return"Fragment";case sc:return"Portal";case $C:return"Profiler";case iS:return"StrictMode";case KC:return"Suspense";case YC:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case eD:return(e.displayName||"Context")+".Consumer";case XT:return(e._context.displayName||"Context")+".Provider";case rS:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case nS:return t=e.displayName||null,t!==null?t:qC(e.type)||"Memo";case bo:t=e._payload,e=e._init;try{return qC(e(t))}catch{}}return null}function zk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qC(t);case 8:return t===iS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Jo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sD(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uk(e){var t=sD(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var r=s.get,n=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,n.call(this,o)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hp(e){e._valueTracker||(e._valueTracker=Uk(e))}function iD(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),i="";return e&&(i=sD(e)?e.checked?"true":"false":e.value),e=i,e!==s?(t.setValue(e),!0):!1}function Ug(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function QC(e,t){var s=t.checked;return hs({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function aE(e,t){var s=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;s=Jo(t.value!=null?t.value:s),e._wrapperState={initialChecked:i,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function rD(e,t){t=t.checked,t!=null&&sS(e,"checked",t,!1)}function ZC(e,t){rD(e,t);var s=Jo(t.value),i=t.type;if(s!=null)i==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?JC(e,t.type,s):t.hasOwnProperty("defaultValue")&&JC(e,t.type,Jo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function lE(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function JC(e,t,s){(t!=="number"||Ug(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var od=Array.isArray;function vc(e,t,s,i){if(e=e.options,t){t={};for(var r=0;r<s.length;r++)t["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=t.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&i&&(e[s].defaultSelected=!0)}else{for(s=""+Jo(s),t=null,r=0;r<e.length;r++){if(e[r].value===s){e[r].selected=!0,i&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function XC(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Oe(91));return hs({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cE(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(Oe(92));if(od(s)){if(1<s.length)throw Error(Oe(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:Jo(s)}}function nD(e,t){var s=Jo(t.value),i=Jo(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),i!=null&&(e.defaultValue=""+i)}function uE(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function oD(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ey(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?oD(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var jp,aD=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,i,r){MSApp.execUnsafeLocalFunction(function(){return e(t,s,i,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(jp=jp||document.createElement("div"),jp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=jp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Vd(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var Ed={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$k=["Webkit","ms","Moz","O"];Object.keys(Ed).forEach(function(e){$k.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ed[t]=Ed[e]})});function lD(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||Ed.hasOwnProperty(e)&&Ed[e]?(""+t).trim():t+"px"}function cD(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var i=s.indexOf("--")===0,r=lD(s,t[s],i);s==="float"&&(s="cssFloat"),i?e.setProperty(s,r):e[s]=r}}var Kk=hs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ty(e,t){if(t){if(Kk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Oe(62))}}function sy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iy=null;function oS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ry=null,Cc=null,yc=null;function dE(e){if(e=np(e)){if(typeof ry!="function")throw Error(Oe(280));var t=e.stateNode;t&&(t=mm(t),ry(e.stateNode,e.type,t))}}function uD(e){Cc?yc?yc.push(e):yc=[e]:Cc=e}function dD(){if(Cc){var e=Cc,t=yc;if(yc=Cc=null,dE(e),t)for(e=0;e<t.length;e++)dE(t[e])}}function hD(e,t){return e(t)}function pD(){}var Mv=!1;function gD(e,t,s){if(Mv)return e(t,s);Mv=!0;try{return hD(e,t,s)}finally{Mv=!1,(Cc!==null||yc!==null)&&(pD(),dD())}}function Bd(e,t){var s=e.stateNode;if(s===null)return null;var i=mm(s);if(i===null)return null;s=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(Oe(231,t,typeof s));return s}var ny=!1;if(Yn)try{var Ku={};Object.defineProperty(Ku,"passive",{get:function(){ny=!0}}),window.addEventListener("test",Ku,Ku),window.removeEventListener("test",Ku,Ku)}catch{ny=!1}function Yk(e,t,s,i,r,n,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(s,u)}catch(h){this.onError(h)}}var bd=!1,$g=null,Kg=!1,oy=null,qk={onError:function(e){bd=!0,$g=e}};function Qk(e,t,s,i,r,n,o,a,l){bd=!1,$g=null,Yk.apply(qk,arguments)}function Zk(e,t,s,i,r,n,o,a,l){if(Qk.apply(this,arguments),bd){if(bd){var u=$g;bd=!1,$g=null}else throw Error(Oe(198));Kg||(Kg=!0,oy=u)}}function Fl(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function fD(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hE(e){if(Fl(e)!==e)throw Error(Oe(188))}function Jk(e){var t=e.alternate;if(!t){if(t=Fl(e),t===null)throw Error(Oe(188));return t!==e?null:e}for(var s=e,i=t;;){var r=s.return;if(r===null)break;var n=r.alternate;if(n===null){if(i=r.return,i!==null){s=i;continue}break}if(r.child===n.child){for(n=r.child;n;){if(n===s)return hE(r),e;if(n===i)return hE(r),t;n=n.sibling}throw Error(Oe(188))}if(s.return!==i.return)s=r,i=n;else{for(var o=!1,a=r.child;a;){if(a===s){o=!0,s=r,i=n;break}if(a===i){o=!0,i=r,s=n;break}a=a.sibling}if(!o){for(a=n.child;a;){if(a===s){o=!0,s=n,i=r;break}if(a===i){o=!0,i=n,s=r;break}a=a.sibling}if(!o)throw Error(Oe(189))}}if(s.alternate!==i)throw Error(Oe(190))}if(s.tag!==3)throw Error(Oe(188));return s.stateNode.current===s?e:t}function mD(e){return e=Jk(e),e!==null?vD(e):null}function vD(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=vD(e);if(t!==null)return t;e=e.sibling}return null}var CD=nr.unstable_scheduleCallback,pE=nr.unstable_cancelCallback,Xk=nr.unstable_shouldYield,eM=nr.unstable_requestPaint,Cs=nr.unstable_now,tM=nr.unstable_getCurrentPriorityLevel,aS=nr.unstable_ImmediatePriority,yD=nr.unstable_UserBlockingPriority,Yg=nr.unstable_NormalPriority,sM=nr.unstable_LowPriority,wD=nr.unstable_IdlePriority,hm=null,En=null;function iM(e){if(En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(hm,e,void 0,(e.current.flags&128)===128)}catch{}}var Jr=Math.clz32?Math.clz32:oM,rM=Math.log,nM=Math.LN2;function oM(e){return e>>>=0,e===0?32:31-(rM(e)/nM|0)|0}var Wp=64,zp=4194304;function ad(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function qg(e,t){var s=e.pendingLanes;if(s===0)return 0;var i=0,r=e.suspendedLanes,n=e.pingedLanes,o=s&268435455;if(o!==0){var a=o&~r;a!==0?i=ad(a):(n&=o,n!==0&&(i=ad(n)))}else o=s&~r,o!==0?i=ad(o):n!==0&&(i=ad(n));if(i===0)return 0;if(t!==0&&t!==i&&!(t&r)&&(r=i&-i,n=t&-t,r>=n||r===16&&(n&4194240)!==0))return t;if(i&4&&(i|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)s=31-Jr(t),r=1<<s,i|=e[s],t&=~r;return i}function aM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lM(e,t){for(var s=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,n=e.pendingLanes;0<n;){var o=31-Jr(n),a=1<<o,l=r[o];l===-1?(!(a&s)||a&i)&&(r[o]=aM(a,t)):l<=t&&(e.expiredLanes|=a),n&=~a}}function ay(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function SD(){var e=Wp;return Wp<<=1,!(Wp&4194240)&&(Wp=64),e}function Lv(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function ip(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Jr(t),e[t]=s}function cM(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-Jr(s),n=1<<r;t[r]=0,i[r]=-1,e[r]=-1,s&=~n}}function lS(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var i=31-Jr(s),r=1<<i;r&t|e[i]&t&&(e[i]|=t),s&=~r}}var Ht=0;function xD(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ED,cS,bD,RD,TD,ly=!1,Up=[],Vo=null,Bo=null,Ho=null,Hd=new Map,jd=new Map,To=[],uM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gE(e,t){switch(e){case"focusin":case"focusout":Vo=null;break;case"dragenter":case"dragleave":Bo=null;break;case"mouseover":case"mouseout":Ho=null;break;case"pointerover":case"pointerout":Hd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":jd.delete(t.pointerId)}}function Yu(e,t,s,i,r,n){return e===null||e.nativeEvent!==n?(e={blockedOn:t,domEventName:s,eventSystemFlags:i,nativeEvent:n,targetContainers:[r]},t!==null&&(t=np(t),t!==null&&cS(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function dM(e,t,s,i,r){switch(t){case"focusin":return Vo=Yu(Vo,e,t,s,i,r),!0;case"dragenter":return Bo=Yu(Bo,e,t,s,i,r),!0;case"mouseover":return Ho=Yu(Ho,e,t,s,i,r),!0;case"pointerover":var n=r.pointerId;return Hd.set(n,Yu(Hd.get(n)||null,e,t,s,i,r)),!0;case"gotpointercapture":return n=r.pointerId,jd.set(n,Yu(jd.get(n)||null,e,t,s,i,r)),!0}return!1}function DD(e){var t=ja(e.target);if(t!==null){var s=Fl(t);if(s!==null){if(t=s.tag,t===13){if(t=fD(s),t!==null){e.blockedOn=t,TD(e.priority,function(){bD(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function fg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=cy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var i=new s.constructor(s.type,s);iy=i,s.target.dispatchEvent(i),iy=null}else return t=np(s),t!==null&&cS(t),e.blockedOn=s,!1;t.shift()}return!0}function fE(e,t,s){fg(e)&&s.delete(t)}function hM(){ly=!1,Vo!==null&&fg(Vo)&&(Vo=null),Bo!==null&&fg(Bo)&&(Bo=null),Ho!==null&&fg(Ho)&&(Ho=null),Hd.forEach(fE),jd.forEach(fE)}function qu(e,t){e.blockedOn===t&&(e.blockedOn=null,ly||(ly=!0,nr.unstable_scheduleCallback(nr.unstable_NormalPriority,hM)))}function Wd(e){function t(r){return qu(r,e)}if(0<Up.length){qu(Up[0],e);for(var s=1;s<Up.length;s++){var i=Up[s];i.blockedOn===e&&(i.blockedOn=null)}}for(Vo!==null&&qu(Vo,e),Bo!==null&&qu(Bo,e),Ho!==null&&qu(Ho,e),Hd.forEach(t),jd.forEach(t),s=0;s<To.length;s++)i=To[s],i.blockedOn===e&&(i.blockedOn=null);for(;0<To.length&&(s=To[0],s.blockedOn===null);)DD(s),s.blockedOn===null&&To.shift()}var wc=no.ReactCurrentBatchConfig,Qg=!0;function pM(e,t,s,i){var r=Ht,n=wc.transition;wc.transition=null;try{Ht=1,uS(e,t,s,i)}finally{Ht=r,wc.transition=n}}function gM(e,t,s,i){var r=Ht,n=wc.transition;wc.transition=null;try{Ht=4,uS(e,t,s,i)}finally{Ht=r,wc.transition=n}}function uS(e,t,s,i){if(Qg){var r=cy(e,t,s,i);if(r===null)$v(e,t,i,Zg,s),gE(e,i);else if(dM(r,e,t,s,i))i.stopPropagation();else if(gE(e,i),t&4&&-1<uM.indexOf(e)){for(;r!==null;){var n=np(r);if(n!==null&&ED(n),n=cy(e,t,s,i),n===null&&$v(e,t,i,Zg,s),n===r)break;r=n}r!==null&&i.stopPropagation()}else $v(e,t,i,null,s)}}var Zg=null;function cy(e,t,s,i){if(Zg=null,e=oS(i),e=ja(e),e!==null)if(t=Fl(e),t===null)e=null;else if(s=t.tag,s===13){if(e=fD(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zg=e,null}function PD(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tM()){case aS:return 1;case yD:return 4;case Yg:case sM:return 16;case wD:return 536870912;default:return 16}default:return 16}}var Mo=null,dS=null,mg=null;function AD(){if(mg)return mg;var e,t=dS,s=t.length,i,r="value"in Mo?Mo.value:Mo.textContent,n=r.length;for(e=0;e<s&&t[e]===r[e];e++);var o=s-e;for(i=1;i<=o&&t[s-i]===r[n-i];i++);return mg=r.slice(e,1<i?1-i:void 0)}function vg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $p(){return!0}function mE(){return!1}function cr(e){function t(s,i,r,n,o){this._reactName=s,this._targetInst=r,this.type=i,this.nativeEvent=n,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(s=e[a],this[a]=s?s(n):n[a]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?$p:mE,this.isPropagationStopped=mE,this}return hs(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=$p)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=$p)},persist:function(){},isPersistent:$p}),t}var hu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hS=cr(hu),rp=hs({},hu,{view:0,detail:0}),fM=cr(rp),Ov,Gv,Qu,pm=hs({},rp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pS,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qu&&(Qu&&e.type==="mousemove"?(Ov=e.screenX-Qu.screenX,Gv=e.screenY-Qu.screenY):Gv=Ov=0,Qu=e),Ov)},movementY:function(e){return"movementY"in e?e.movementY:Gv}}),vE=cr(pm),mM=hs({},pm,{dataTransfer:0}),vM=cr(mM),CM=hs({},rp,{relatedTarget:0}),Vv=cr(CM),yM=hs({},hu,{animationName:0,elapsedTime:0,pseudoElement:0}),wM=cr(yM),SM=hs({},hu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xM=cr(SM),EM=hs({},hu,{data:0}),CE=cr(EM),bM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=TM[e])?!!t[e]:!1}function pS(){return DM}var PM=hs({},rp,{key:function(e){if(e.key){var t=bM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?RM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pS,charCode:function(e){return e.type==="keypress"?vg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),AM=cr(PM),FM=hs({},pm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yE=cr(FM),IM=hs({},rp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pS}),NM=cr(IM),_M=hs({},hu,{propertyName:0,elapsedTime:0,pseudoElement:0}),kM=cr(_M),MM=hs({},pm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),LM=cr(MM),OM=[9,13,27,32],gS=Yn&&"CompositionEvent"in window,Rd=null;Yn&&"documentMode"in document&&(Rd=document.documentMode);var GM=Yn&&"TextEvent"in window&&!Rd,FD=Yn&&(!gS||Rd&&8<Rd&&11>=Rd),wE=" ",SE=!1;function ID(e,t){switch(e){case"keyup":return OM.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ND(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var rc=!1;function VM(e,t){switch(e){case"compositionend":return ND(t);case"keypress":return t.which!==32?null:(SE=!0,wE);case"textInput":return e=t.data,e===wE&&SE?null:e;default:return null}}function BM(e,t){if(rc)return e==="compositionend"||!gS&&ID(e,t)?(e=AD(),mg=dS=Mo=null,rc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return FD&&t.locale!=="ko"?null:t.data;default:return null}}var HM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!HM[e.type]:t==="textarea"}function _D(e,t,s,i){uD(i),t=Jg(t,"onChange"),0<t.length&&(s=new hS("onChange","change",null,s,i),e.push({event:s,listeners:t}))}var Td=null,zd=null;function jM(e){zD(e,0)}function gm(e){var t=ac(e);if(iD(t))return e}function WM(e,t){if(e==="change")return t}var kD=!1;if(Yn){var Bv;if(Yn){var Hv="oninput"in document;if(!Hv){var EE=document.createElement("div");EE.setAttribute("oninput","return;"),Hv=typeof EE.oninput=="function"}Bv=Hv}else Bv=!1;kD=Bv&&(!document.documentMode||9<document.documentMode)}function bE(){Td&&(Td.detachEvent("onpropertychange",MD),zd=Td=null)}function MD(e){if(e.propertyName==="value"&&gm(zd)){var t=[];_D(t,zd,e,oS(e)),gD(jM,t)}}function zM(e,t,s){e==="focusin"?(bE(),Td=t,zd=s,Td.attachEvent("onpropertychange",MD)):e==="focusout"&&bE()}function UM(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return gm(zd)}function $M(e,t){if(e==="click")return gm(t)}function KM(e,t){if(e==="input"||e==="change")return gm(t)}function YM(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sn=typeof Object.is=="function"?Object.is:YM;function Ud(e,t){if(sn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(i=0;i<s.length;i++){var r=s[i];if(!UC.call(t,r)||!sn(e[r],t[r]))return!1}return!0}function RE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function TE(e,t){var s=RE(e);e=0;for(var i;s;){if(s.nodeType===3){if(i=e+s.textContent.length,e<=t&&i>=t)return{node:s,offset:t-e};e=i}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=RE(s)}}function LD(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?LD(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function OD(){for(var e=window,t=Ug();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=Ug(e.document)}return t}function fS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qM(e){var t=OD(),s=e.focusedElem,i=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&LD(s.ownerDocument.documentElement,s)){if(i!==null&&fS(s)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=s.textContent.length,n=Math.min(i.start,r);i=i.end===void 0?n:Math.min(i.end,r),!e.extend&&n>i&&(r=i,i=n,n=r),r=TE(s,n);var o=TE(s,i);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),n>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var QM=Yn&&"documentMode"in document&&11>=document.documentMode,nc=null,uy=null,Dd=null,dy=!1;function DE(e,t,s){var i=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;dy||nc==null||nc!==Ug(i)||(i=nc,"selectionStart"in i&&fS(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Dd&&Ud(Dd,i)||(Dd=i,i=Jg(uy,"onSelect"),0<i.length&&(t=new hS("onSelect","select",null,t,s),e.push({event:t,listeners:i}),t.target=nc)))}function Kp(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var oc={animationend:Kp("Animation","AnimationEnd"),animationiteration:Kp("Animation","AnimationIteration"),animationstart:Kp("Animation","AnimationStart"),transitionend:Kp("Transition","TransitionEnd")},jv={},GD={};Yn&&(GD=document.createElement("div").style,"AnimationEvent"in window||(delete oc.animationend.animation,delete oc.animationiteration.animation,delete oc.animationstart.animation),"TransitionEvent"in window||delete oc.transitionend.transition);function fm(e){if(jv[e])return jv[e];if(!oc[e])return e;var t=oc[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in GD)return jv[e]=t[s];return e}var VD=fm("animationend"),BD=fm("animationiteration"),HD=fm("animationstart"),jD=fm("transitionend"),WD=new Map,PE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function la(e,t){WD.set(e,t),Al(t,[e])}for(var Wv=0;Wv<PE.length;Wv++){var zv=PE[Wv],ZM=zv.toLowerCase(),JM=zv[0].toUpperCase()+zv.slice(1);la(ZM,"on"+JM)}la(VD,"onAnimationEnd");la(BD,"onAnimationIteration");la(HD,"onAnimationStart");la("dblclick","onDoubleClick");la("focusin","onFocus");la("focusout","onBlur");la(jD,"onTransitionEnd");Lc("onMouseEnter",["mouseout","mouseover"]);Lc("onMouseLeave",["mouseout","mouseover"]);Lc("onPointerEnter",["pointerout","pointerover"]);Lc("onPointerLeave",["pointerout","pointerover"]);Al("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Al("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Al("onBeforeInput",["compositionend","keypress","textInput","paste"]);Al("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Al("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Al("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XM=new Set("cancel close invalid load scroll toggle".split(" ").concat(ld));function AE(e,t,s){var i=e.type||"unknown-event";e.currentTarget=s,Zk(i,t,void 0,e),e.currentTarget=null}function zD(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var i=e[s],r=i.event;i=i.listeners;e:{var n=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==n&&r.isPropagationStopped())break e;AE(r,a,u),n=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==n&&r.isPropagationStopped())break e;AE(r,a,u),n=l}}}if(Kg)throw e=oy,Kg=!1,oy=null,e}function ts(e,t){var s=t[my];s===void 0&&(s=t[my]=new Set);var i=e+"__bubble";s.has(i)||(UD(t,e,2,!1),s.add(i))}function Uv(e,t,s){var i=0;t&&(i|=4),UD(s,e,i,t)}var Yp="_reactListening"+Math.random().toString(36).slice(2);function $d(e){if(!e[Yp]){e[Yp]=!0,JT.forEach(function(s){s!=="selectionchange"&&(XM.has(s)||Uv(s,!1,e),Uv(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yp]||(t[Yp]=!0,Uv("selectionchange",!1,t))}}function UD(e,t,s,i){switch(PD(t)){case 1:var r=pM;break;case 4:r=gM;break;default:r=uS}s=r.bind(null,t,s,e),r=void 0,!ny||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),i?r!==void 0?e.addEventListener(t,s,{capture:!0,passive:r}):e.addEventListener(t,s,!0):r!==void 0?e.addEventListener(t,s,{passive:r}):e.addEventListener(t,s,!1)}function $v(e,t,s,i,r){var n=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=ja(a),o===null)return;if(l=o.tag,l===5||l===6){i=n=o;continue e}a=a.parentNode}}i=i.return}gD(function(){var u=n,h=oS(s),p=[];e:{var g=WD.get(e);if(g!==void 0){var m=hS,C=e;switch(e){case"keypress":if(vg(s)===0)break e;case"keydown":case"keyup":m=AM;break;case"focusin":C="focus",m=Vv;break;case"focusout":C="blur",m=Vv;break;case"beforeblur":case"afterblur":m=Vv;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=vE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=vM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=NM;break;case VD:case BD:case HD:m=wM;break;case jD:m=kM;break;case"scroll":m=fM;break;case"wheel":m=LM;break;case"copy":case"cut":case"paste":m=xM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=yE}var y=(t&4)!==0,R=!y&&e==="scroll",x=y?g!==null?g+"Capture":null:g;y=[];for(var S=u,T;S!==null;){T=S;var I=T.stateNode;if(T.tag===5&&I!==null&&(T=I,x!==null&&(I=Bd(S,x),I!=null&&y.push(Kd(S,I,T)))),R)break;S=S.return}0<y.length&&(g=new m(g,C,null,s,h),p.push({event:g,listeners:y}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",g&&s!==iy&&(C=s.relatedTarget||s.fromElement)&&(ja(C)||C[qn]))break e;if((m||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,m?(C=s.relatedTarget||s.toElement,m=u,C=C?ja(C):null,C!==null&&(R=Fl(C),C!==R||C.tag!==5&&C.tag!==6)&&(C=null)):(m=null,C=u),m!==C)){if(y=vE,I="onMouseLeave",x="onMouseEnter",S="mouse",(e==="pointerout"||e==="pointerover")&&(y=yE,I="onPointerLeave",x="onPointerEnter",S="pointer"),R=m==null?g:ac(m),T=C==null?g:ac(C),g=new y(I,S+"leave",m,s,h),g.target=R,g.relatedTarget=T,I=null,ja(h)===u&&(y=new y(x,S+"enter",C,s,h),y.target=T,y.relatedTarget=R,I=y),R=I,m&&C)t:{for(y=m,x=C,S=0,T=y;T;T=ql(T))S++;for(T=0,I=x;I;I=ql(I))T++;for(;0<S-T;)y=ql(y),S--;for(;0<T-S;)x=ql(x),T--;for(;S--;){if(y===x||x!==null&&y===x.alternate)break t;y=ql(y),x=ql(x)}y=null}else y=null;m!==null&&FE(p,g,m,y,!1),C!==null&&R!==null&&FE(p,R,C,y,!0)}}e:{if(g=u?ac(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var V=WM;else if(xE(g))if(kD)V=KM;else{V=UM;var H=zM}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(V=$M);if(V&&(V=V(e,u))){_D(p,V,s,h);break e}H&&H(e,g,u),e==="focusout"&&(H=g._wrapperState)&&H.controlled&&g.type==="number"&&JC(g,"number",g.value)}switch(H=u?ac(u):window,e){case"focusin":(xE(H)||H.contentEditable==="true")&&(nc=H,uy=u,Dd=null);break;case"focusout":Dd=uy=nc=null;break;case"mousedown":dy=!0;break;case"contextmenu":case"mouseup":case"dragend":dy=!1,DE(p,s,h);break;case"selectionchange":if(QM)break;case"keydown":case"keyup":DE(p,s,h)}var P;if(gS)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else rc?ID(e,s)&&(N="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(N="onCompositionStart");N&&(FD&&s.locale!=="ko"&&(rc||N!=="onCompositionStart"?N==="onCompositionEnd"&&rc&&(P=AD()):(Mo=h,dS="value"in Mo?Mo.value:Mo.textContent,rc=!0)),H=Jg(u,N),0<H.length&&(N=new CE(N,e,null,s,h),p.push({event:N,listeners:H}),P?N.data=P:(P=ND(s),P!==null&&(N.data=P)))),(P=GM?VM(e,s):BM(e,s))&&(u=Jg(u,"onBeforeInput"),0<u.length&&(h=new CE("onBeforeInput","beforeinput",null,s,h),p.push({event:h,listeners:u}),h.data=P))}zD(p,t)})}function Kd(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Jg(e,t){for(var s=t+"Capture",i=[];e!==null;){var r=e,n=r.stateNode;r.tag===5&&n!==null&&(r=n,n=Bd(e,s),n!=null&&i.unshift(Kd(e,n,r)),n=Bd(e,t),n!=null&&i.push(Kd(e,n,r))),e=e.return}return i}function ql(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function FE(e,t,s,i,r){for(var n=t._reactName,o=[];s!==null&&s!==i;){var a=s,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Bd(s,n),l!=null&&o.unshift(Kd(s,l,a))):r||(l=Bd(s,n),l!=null&&o.push(Kd(s,l,a)))),s=s.return}o.length!==0&&e.push({event:t,listeners:o})}var eL=/\r\n?/g,tL=/\u0000|\uFFFD/g;function IE(e){return(typeof e=="string"?e:""+e).replace(eL,`
`).replace(tL,"")}function qp(e,t,s){if(t=IE(t),IE(e)!==t&&s)throw Error(Oe(425))}function Xg(){}var hy=null,py=null;function gy(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var fy=typeof setTimeout=="function"?setTimeout:void 0,sL=typeof clearTimeout=="function"?clearTimeout:void 0,NE=typeof Promise=="function"?Promise:void 0,iL=typeof queueMicrotask=="function"?queueMicrotask:typeof NE<"u"?function(e){return NE.resolve(null).then(e).catch(rL)}:fy;function rL(e){setTimeout(function(){throw e})}function Kv(e,t){var s=t,i=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(i===0){e.removeChild(r),Wd(t);return}i--}else s!=="$"&&s!=="$?"&&s!=="$!"||i++;s=r}while(s);Wd(t)}function jo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function _E(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var pu=Math.random().toString(36).slice(2),yn="__reactFiber$"+pu,Yd="__reactProps$"+pu,qn="__reactContainer$"+pu,my="__reactEvents$"+pu,nL="__reactListeners$"+pu,oL="__reactHandles$"+pu;function ja(e){var t=e[yn];if(t)return t;for(var s=e.parentNode;s;){if(t=s[qn]||s[yn]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=_E(e);e!==null;){if(s=e[yn])return s;e=_E(e)}return t}e=s,s=e.parentNode}return null}function np(e){return e=e[yn]||e[qn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ac(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Oe(33))}function mm(e){return e[Yd]||null}var vy=[],lc=-1;function ca(e){return{current:e}}function is(e){0>lc||(e.current=vy[lc],vy[lc]=null,lc--)}function Qt(e,t){lc++,vy[lc]=e.current,e.current=t}var Xo={},ti=ca(Xo),Vi=ca(!1),dl=Xo;function Oc(e,t){var s=e.type.contextTypes;if(!s)return Xo;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r={},n;for(n in s)r[n]=t[n];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Bi(e){return e=e.childContextTypes,e!=null}function ef(){is(Vi),is(ti)}function kE(e,t,s){if(ti.current!==Xo)throw Error(Oe(168));Qt(ti,t),Qt(Vi,s)}function $D(e,t,s){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return s;i=i.getChildContext();for(var r in i)if(!(r in t))throw Error(Oe(108,zk(e)||"Unknown",r));return hs({},s,i)}function tf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xo,dl=ti.current,Qt(ti,e),Qt(Vi,Vi.current),!0}function ME(e,t,s){var i=e.stateNode;if(!i)throw Error(Oe(169));s?(e=$D(e,t,dl),i.__reactInternalMemoizedMergedChildContext=e,is(Vi),is(ti),Qt(ti,e)):is(Vi),Qt(Vi,s)}var Bn=null,vm=!1,Yv=!1;function KD(e){Bn===null?Bn=[e]:Bn.push(e)}function aL(e){vm=!0,KD(e)}function ua(){if(!Yv&&Bn!==null){Yv=!0;var e=0,t=Ht;try{var s=Bn;for(Ht=1;e<s.length;e++){var i=s[e];do i=i(!0);while(i!==null)}Bn=null,vm=!1}catch(r){throw Bn!==null&&(Bn=Bn.slice(e+1)),CD(aS,ua),r}finally{Ht=t,Yv=!1}}return null}var cc=[],uc=0,sf=null,rf=0,vr=[],Cr=0,hl=null,zn=1,Un="";function Ia(e,t){cc[uc++]=rf,cc[uc++]=sf,sf=e,rf=t}function YD(e,t,s){vr[Cr++]=zn,vr[Cr++]=Un,vr[Cr++]=hl,hl=e;var i=zn;e=Un;var r=32-Jr(i)-1;i&=~(1<<r),s+=1;var n=32-Jr(t)+r;if(30<n){var o=r-r%5;n=(i&(1<<o)-1).toString(32),i>>=o,r-=o,zn=1<<32-Jr(t)+r|s<<r|i,Un=n+e}else zn=1<<n|s<<r|i,Un=e}function mS(e){e.return!==null&&(Ia(e,1),YD(e,1,0))}function vS(e){for(;e===sf;)sf=cc[--uc],cc[uc]=null,rf=cc[--uc],cc[uc]=null;for(;e===hl;)hl=vr[--Cr],vr[Cr]=null,Un=vr[--Cr],vr[Cr]=null,zn=vr[--Cr],vr[Cr]=null}var ir=null,sr=null,ls=!1,Kr=null;function qD(e,t){var s=wr(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function LE(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ir=e,sr=jo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ir=e,sr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=hl!==null?{id:zn,overflow:Un}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=wr(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,ir=e,sr=null,!0):!1;default:return!1}}function Cy(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yy(e){if(ls){var t=sr;if(t){var s=t;if(!LE(e,t)){if(Cy(e))throw Error(Oe(418));t=jo(s.nextSibling);var i=ir;t&&LE(e,t)?qD(i,s):(e.flags=e.flags&-4097|2,ls=!1,ir=e)}}else{if(Cy(e))throw Error(Oe(418));e.flags=e.flags&-4097|2,ls=!1,ir=e}}}function OE(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ir=e}function Qp(e){if(e!==ir)return!1;if(!ls)return OE(e),ls=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!gy(e.type,e.memoizedProps)),t&&(t=sr)){if(Cy(e))throw QD(),Error(Oe(418));for(;t;)qD(e,t),t=jo(t.nextSibling)}if(OE(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){sr=jo(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}sr=null}}else sr=ir?jo(e.stateNode.nextSibling):null;return!0}function QD(){for(var e=sr;e;)e=jo(e.nextSibling)}function Gc(){sr=ir=null,ls=!1}function CS(e){Kr===null?Kr=[e]:Kr.push(e)}var lL=no.ReactCurrentBatchConfig;function Zu(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Oe(309));var i=s.stateNode}if(!i)throw Error(Oe(147,e));var r=i,n=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===n?t.ref:(t=function(o){var a=r.refs;o===null?delete a[n]:a[n]=o},t._stringRef=n,t)}if(typeof e!="string")throw Error(Oe(284));if(!s._owner)throw Error(Oe(290,e))}return e}function Zp(e,t){throw e=Object.prototype.toString.call(t),Error(Oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function GE(e){var t=e._init;return t(e._payload)}function ZD(e){function t(x,S){if(e){var T=x.deletions;T===null?(x.deletions=[S],x.flags|=16):T.push(S)}}function s(x,S){if(!e)return null;for(;S!==null;)t(x,S),S=S.sibling;return null}function i(x,S){for(x=new Map;S!==null;)S.key!==null?x.set(S.key,S):x.set(S.index,S),S=S.sibling;return x}function r(x,S){return x=$o(x,S),x.index=0,x.sibling=null,x}function n(x,S,T){return x.index=T,e?(T=x.alternate,T!==null?(T=T.index,T<S?(x.flags|=2,S):T):(x.flags|=2,S)):(x.flags|=1048576,S)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function a(x,S,T,I){return S===null||S.tag!==6?(S=tC(T,x.mode,I),S.return=x,S):(S=r(S,T),S.return=x,S)}function l(x,S,T,I){var V=T.type;return V===ic?h(x,S,T.props.children,I,T.key):S!==null&&(S.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===bo&&GE(V)===S.type)?(I=r(S,T.props),I.ref=Zu(x,S,T),I.return=x,I):(I=bg(T.type,T.key,T.props,null,x.mode,I),I.ref=Zu(x,S,T),I.return=x,I)}function u(x,S,T,I){return S===null||S.tag!==4||S.stateNode.containerInfo!==T.containerInfo||S.stateNode.implementation!==T.implementation?(S=sC(T,x.mode,I),S.return=x,S):(S=r(S,T.children||[]),S.return=x,S)}function h(x,S,T,I,V){return S===null||S.tag!==7?(S=sl(T,x.mode,I,V),S.return=x,S):(S=r(S,T),S.return=x,S)}function p(x,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return S=tC(""+S,x.mode,T),S.return=x,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Bp:return T=bg(S.type,S.key,S.props,null,x.mode,T),T.ref=Zu(x,null,S),T.return=x,T;case sc:return S=sC(S,x.mode,T),S.return=x,S;case bo:var I=S._init;return p(x,I(S._payload),T)}if(od(S)||$u(S))return S=sl(S,x.mode,T,null),S.return=x,S;Zp(x,S)}return null}function g(x,S,T,I){var V=S!==null?S.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return V!==null?null:a(x,S,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Bp:return T.key===V?l(x,S,T,I):null;case sc:return T.key===V?u(x,S,T,I):null;case bo:return V=T._init,g(x,S,V(T._payload),I)}if(od(T)||$u(T))return V!==null?null:h(x,S,T,I,null);Zp(x,T)}return null}function m(x,S,T,I,V){if(typeof I=="string"&&I!==""||typeof I=="number")return x=x.get(T)||null,a(S,x,""+I,V);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Bp:return x=x.get(I.key===null?T:I.key)||null,l(S,x,I,V);case sc:return x=x.get(I.key===null?T:I.key)||null,u(S,x,I,V);case bo:var H=I._init;return m(x,S,T,H(I._payload),V)}if(od(I)||$u(I))return x=x.get(T)||null,h(S,x,I,V,null);Zp(S,I)}return null}function C(x,S,T,I){for(var V=null,H=null,P=S,N=S=0,_=null;P!==null&&N<T.length;N++){P.index>N?(_=P,P=null):_=P.sibling;var L=g(x,P,T[N],I);if(L===null){P===null&&(P=_);break}e&&P&&L.alternate===null&&t(x,P),S=n(L,S,N),H===null?V=L:H.sibling=L,H=L,P=_}if(N===T.length)return s(x,P),ls&&Ia(x,N),V;if(P===null){for(;N<T.length;N++)P=p(x,T[N],I),P!==null&&(S=n(P,S,N),H===null?V=P:H.sibling=P,H=P);return ls&&Ia(x,N),V}for(P=i(x,P);N<T.length;N++)_=m(P,x,N,T[N],I),_!==null&&(e&&_.alternate!==null&&P.delete(_.key===null?N:_.key),S=n(_,S,N),H===null?V=_:H.sibling=_,H=_);return e&&P.forEach(function(M){return t(x,M)}),ls&&Ia(x,N),V}function y(x,S,T,I){var V=$u(T);if(typeof V!="function")throw Error(Oe(150));if(T=V.call(T),T==null)throw Error(Oe(151));for(var H=V=null,P=S,N=S=0,_=null,L=T.next();P!==null&&!L.done;N++,L=T.next()){P.index>N?(_=P,P=null):_=P.sibling;var M=g(x,P,L.value,I);if(M===null){P===null&&(P=_);break}e&&P&&M.alternate===null&&t(x,P),S=n(M,S,N),H===null?V=M:H.sibling=M,H=M,P=_}if(L.done)return s(x,P),ls&&Ia(x,N),V;if(P===null){for(;!L.done;N++,L=T.next())L=p(x,L.value,I),L!==null&&(S=n(L,S,N),H===null?V=L:H.sibling=L,H=L);return ls&&Ia(x,N),V}for(P=i(x,P);!L.done;N++,L=T.next())L=m(P,x,N,L.value,I),L!==null&&(e&&L.alternate!==null&&P.delete(L.key===null?N:L.key),S=n(L,S,N),H===null?V=L:H.sibling=L,H=L);return e&&P.forEach(function(b){return t(x,b)}),ls&&Ia(x,N),V}function R(x,S,T,I){if(typeof T=="object"&&T!==null&&T.type===ic&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Bp:e:{for(var V=T.key,H=S;H!==null;){if(H.key===V){if(V=T.type,V===ic){if(H.tag===7){s(x,H.sibling),S=r(H,T.props.children),S.return=x,x=S;break e}}else if(H.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===bo&&GE(V)===H.type){s(x,H.sibling),S=r(H,T.props),S.ref=Zu(x,H,T),S.return=x,x=S;break e}s(x,H);break}else t(x,H);H=H.sibling}T.type===ic?(S=sl(T.props.children,x.mode,I,T.key),S.return=x,x=S):(I=bg(T.type,T.key,T.props,null,x.mode,I),I.ref=Zu(x,S,T),I.return=x,x=I)}return o(x);case sc:e:{for(H=T.key;S!==null;){if(S.key===H)if(S.tag===4&&S.stateNode.containerInfo===T.containerInfo&&S.stateNode.implementation===T.implementation){s(x,S.sibling),S=r(S,T.children||[]),S.return=x,x=S;break e}else{s(x,S);break}else t(x,S);S=S.sibling}S=sC(T,x.mode,I),S.return=x,x=S}return o(x);case bo:return H=T._init,R(x,S,H(T._payload),I)}if(od(T))return C(x,S,T,I);if($u(T))return y(x,S,T,I);Zp(x,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,S!==null&&S.tag===6?(s(x,S.sibling),S=r(S,T),S.return=x,x=S):(s(x,S),S=tC(T,x.mode,I),S.return=x,x=S),o(x)):s(x,S)}return R}var Vc=ZD(!0),JD=ZD(!1),nf=ca(null),of=null,dc=null,yS=null;function wS(){yS=dc=of=null}function SS(e){var t=nf.current;is(nf),e._currentValue=t}function wy(e,t,s){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===s)break;e=e.return}}function Sc(e,t){of=e,yS=dc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ki=!0),e.firstContext=null)}function Tr(e){var t=e._currentValue;if(yS!==e)if(e={context:e,memoizedValue:t,next:null},dc===null){if(of===null)throw Error(Oe(308));dc=e,of.dependencies={lanes:0,firstContext:e}}else dc=dc.next=e;return t}var Wa=null;function xS(e){Wa===null?Wa=[e]:Wa.push(e)}function XD(e,t,s,i){var r=t.interleaved;return r===null?(s.next=s,xS(t)):(s.next=r.next,r.next=s),t.interleaved=s,Qn(e,i)}function Qn(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Ro=!1;function ES(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function eP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Wo(e,t,s){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,kt&2){var r=i.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Qn(e,s)}return r=i.interleaved,r===null?(t.next=t,xS(i)):(t.next=r.next,r.next=t),i.interleaved=t,Qn(e,s)}function Cg(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,s|=i,t.lanes=s,lS(e,s)}}function VE(e,t){var s=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,s===i)){var r=null,n=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};n===null?r=n=o:n=n.next=o,s=s.next}while(s!==null);n===null?r=n=t:n=n.next=t}else r=n=t;s={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:n,shared:i.shared,effects:i.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function af(e,t,s,i){var r=e.updateQueue;Ro=!1;var n=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?n=u:o.next=u,o=l;var h=e.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(n!==null){var p=r.baseState;o=0,h=u=l=null,a=n;do{var g=a.lane,m=a.eventTime;if((i&g)===g){h!==null&&(h=h.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var C=e,y=a;switch(g=t,m=s,y.tag){case 1:if(C=y.payload,typeof C=="function"){p=C.call(m,p,g);break e}p=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=y.payload,g=typeof C=="function"?C.call(m,p,g):C,g==null)break e;p=hs({},p,g);break e;case 2:Ro=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,g=r.effects,g===null?r.effects=[a]:g.push(a))}else m={eventTime:m,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=m,l=p):h=h.next=m,o|=g;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;g=a,a=g.next,g.next=null,r.lastBaseUpdate=g,r.shared.pending=null}}while(!0);if(h===null&&(l=p),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=h,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else n===null&&(r.shared.lanes=0);gl|=o,e.lanes=o,e.memoizedState=p}}function BE(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(r!==null){if(i.callback=null,i=s,typeof r!="function")throw Error(Oe(191,r));r.call(i)}}}var op={},bn=ca(op),qd=ca(op),Qd=ca(op);function za(e){if(e===op)throw Error(Oe(174));return e}function bS(e,t){switch(Qt(Qd,t),Qt(qd,e),Qt(bn,op),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ey(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ey(t,e)}is(bn),Qt(bn,t)}function Bc(){is(bn),is(qd),is(Qd)}function tP(e){za(Qd.current);var t=za(bn.current),s=ey(t,e.type);t!==s&&(Qt(qd,e),Qt(bn,s))}function RS(e){qd.current===e&&(is(bn),is(qd))}var us=ca(0);function lf(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qv=[];function TS(){for(var e=0;e<qv.length;e++)qv[e]._workInProgressVersionPrimary=null;qv.length=0}var yg=no.ReactCurrentDispatcher,Qv=no.ReactCurrentBatchConfig,pl=0,ds=null,Ds=null,_s=null,cf=!1,Pd=!1,Zd=0,cL=0;function Zs(){throw Error(Oe(321))}function DS(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!sn(e[s],t[s]))return!1;return!0}function PS(e,t,s,i,r,n){if(pl=n,ds=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,yg.current=e===null||e.memoizedState===null?pL:gL,e=s(i,r),Pd){n=0;do{if(Pd=!1,Zd=0,25<=n)throw Error(Oe(301));n+=1,_s=Ds=null,t.updateQueue=null,yg.current=fL,e=s(i,r)}while(Pd)}if(yg.current=uf,t=Ds!==null&&Ds.next!==null,pl=0,_s=Ds=ds=null,cf=!1,t)throw Error(Oe(300));return e}function AS(){var e=Zd!==0;return Zd=0,e}function fn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _s===null?ds.memoizedState=_s=e:_s=_s.next=e,_s}function Dr(){if(Ds===null){var e=ds.alternate;e=e!==null?e.memoizedState:null}else e=Ds.next;var t=_s===null?ds.memoizedState:_s.next;if(t!==null)_s=t,Ds=e;else{if(e===null)throw Error(Oe(310));Ds=e,e={memoizedState:Ds.memoizedState,baseState:Ds.baseState,baseQueue:Ds.baseQueue,queue:Ds.queue,next:null},_s===null?ds.memoizedState=_s=e:_s=_s.next=e}return _s}function Jd(e,t){return typeof t=="function"?t(e):t}function Zv(e){var t=Dr(),s=t.queue;if(s===null)throw Error(Oe(311));s.lastRenderedReducer=e;var i=Ds,r=i.baseQueue,n=s.pending;if(n!==null){if(r!==null){var o=r.next;r.next=n.next,n.next=o}i.baseQueue=r=n,s.pending=null}if(r!==null){n=r.next,i=i.baseState;var a=o=null,l=null,u=n;do{var h=u.lane;if((pl&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=i):l=l.next=p,ds.lanes|=h,gl|=h}u=u.next}while(u!==null&&u!==n);l===null?o=i:l.next=a,sn(i,t.memoizedState)||(ki=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=l,s.lastRenderedState=i}if(e=s.interleaved,e!==null){r=e;do n=r.lane,ds.lanes|=n,gl|=n,r=r.next;while(r!==e)}else r===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function Jv(e){var t=Dr(),s=t.queue;if(s===null)throw Error(Oe(311));s.lastRenderedReducer=e;var i=s.dispatch,r=s.pending,n=t.memoizedState;if(r!==null){s.pending=null;var o=r=r.next;do n=e(n,o.action),o=o.next;while(o!==r);sn(n,t.memoizedState)||(ki=!0),t.memoizedState=n,t.baseQueue===null&&(t.baseState=n),s.lastRenderedState=n}return[n,i]}function sP(){}function iP(e,t){var s=ds,i=Dr(),r=t(),n=!sn(i.memoizedState,r);if(n&&(i.memoizedState=r,ki=!0),i=i.queue,FS(oP.bind(null,s,i,e),[e]),i.getSnapshot!==t||n||_s!==null&&_s.memoizedState.tag&1){if(s.flags|=2048,Xd(9,nP.bind(null,s,i,r,t),void 0,null),Ms===null)throw Error(Oe(349));pl&30||rP(s,t,r)}return r}function rP(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=ds.updateQueue,t===null?(t={lastEffect:null,stores:null},ds.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function nP(e,t,s,i){t.value=s,t.getSnapshot=i,aP(t)&&lP(e)}function oP(e,t,s){return s(function(){aP(t)&&lP(e)})}function aP(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!sn(e,s)}catch{return!0}}function lP(e){var t=Qn(e,1);t!==null&&Xr(t,e,1,-1)}function HE(e){var t=fn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jd,lastRenderedState:e},t.queue=e,e=e.dispatch=hL.bind(null,ds,e),[t.memoizedState,e]}function Xd(e,t,s,i){return e={tag:e,create:t,destroy:s,deps:i,next:null},t=ds.updateQueue,t===null?(t={lastEffect:null,stores:null},ds.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(i=s.next,s.next=e,e.next=i,t.lastEffect=e)),e}function cP(){return Dr().memoizedState}function wg(e,t,s,i){var r=fn();ds.flags|=e,r.memoizedState=Xd(1|t,s,void 0,i===void 0?null:i)}function Cm(e,t,s,i){var r=Dr();i=i===void 0?null:i;var n=void 0;if(Ds!==null){var o=Ds.memoizedState;if(n=o.destroy,i!==null&&DS(i,o.deps)){r.memoizedState=Xd(t,s,n,i);return}}ds.flags|=e,r.memoizedState=Xd(1|t,s,n,i)}function jE(e,t){return wg(8390656,8,e,t)}function FS(e,t){return Cm(2048,8,e,t)}function uP(e,t){return Cm(4,2,e,t)}function dP(e,t){return Cm(4,4,e,t)}function hP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function pP(e,t,s){return s=s!=null?s.concat([e]):null,Cm(4,4,hP.bind(null,t,e),s)}function IS(){}function gP(e,t){var s=Dr();t=t===void 0?null:t;var i=s.memoizedState;return i!==null&&t!==null&&DS(t,i[1])?i[0]:(s.memoizedState=[e,t],e)}function fP(e,t){var s=Dr();t=t===void 0?null:t;var i=s.memoizedState;return i!==null&&t!==null&&DS(t,i[1])?i[0]:(e=e(),s.memoizedState=[e,t],e)}function mP(e,t,s){return pl&21?(sn(s,t)||(s=SD(),ds.lanes|=s,gl|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ki=!0),e.memoizedState=s)}function uL(e,t){var s=Ht;Ht=s!==0&&4>s?s:4,e(!0);var i=Qv.transition;Qv.transition={};try{e(!1),t()}finally{Ht=s,Qv.transition=i}}function vP(){return Dr().memoizedState}function dL(e,t,s){var i=Uo(e);if(s={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null},CP(e))yP(t,s);else if(s=XD(e,t,s,i),s!==null){var r=gi();Xr(s,e,i,r),wP(s,t,i)}}function hL(e,t,s){var i=Uo(e),r={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null};if(CP(e))yP(t,r);else{var n=e.alternate;if(e.lanes===0&&(n===null||n.lanes===0)&&(n=t.lastRenderedReducer,n!==null))try{var o=t.lastRenderedState,a=n(o,s);if(r.hasEagerState=!0,r.eagerState=a,sn(a,o)){var l=t.interleaved;l===null?(r.next=r,xS(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}s=XD(e,t,r,i),s!==null&&(r=gi(),Xr(s,e,i,r),wP(s,t,i))}}function CP(e){var t=e.alternate;return e===ds||t!==null&&t===ds}function yP(e,t){Pd=cf=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function wP(e,t,s){if(s&4194240){var i=t.lanes;i&=e.pendingLanes,s|=i,t.lanes=s,lS(e,s)}}var uf={readContext:Tr,useCallback:Zs,useContext:Zs,useEffect:Zs,useImperativeHandle:Zs,useInsertionEffect:Zs,useLayoutEffect:Zs,useMemo:Zs,useReducer:Zs,useRef:Zs,useState:Zs,useDebugValue:Zs,useDeferredValue:Zs,useTransition:Zs,useMutableSource:Zs,useSyncExternalStore:Zs,useId:Zs,unstable_isNewReconciler:!1},pL={readContext:Tr,useCallback:function(e,t){return fn().memoizedState=[e,t===void 0?null:t],e},useContext:Tr,useEffect:jE,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,wg(4194308,4,hP.bind(null,t,e),s)},useLayoutEffect:function(e,t){return wg(4194308,4,e,t)},useInsertionEffect:function(e,t){return wg(4,2,e,t)},useMemo:function(e,t){var s=fn();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var i=fn();return t=s!==void 0?s(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=dL.bind(null,ds,e),[i.memoizedState,e]},useRef:function(e){var t=fn();return e={current:e},t.memoizedState=e},useState:HE,useDebugValue:IS,useDeferredValue:function(e){return fn().memoizedState=e},useTransition:function(){var e=HE(!1),t=e[0];return e=uL.bind(null,e[1]),fn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var i=ds,r=fn();if(ls){if(s===void 0)throw Error(Oe(407));s=s()}else{if(s=t(),Ms===null)throw Error(Oe(349));pl&30||rP(i,t,s)}r.memoizedState=s;var n={value:s,getSnapshot:t};return r.queue=n,jE(oP.bind(null,i,n,e),[e]),i.flags|=2048,Xd(9,nP.bind(null,i,n,s,t),void 0,null),s},useId:function(){var e=fn(),t=Ms.identifierPrefix;if(ls){var s=Un,i=zn;s=(i&~(1<<32-Jr(i)-1)).toString(32)+s,t=":"+t+"R"+s,s=Zd++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=cL++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},gL={readContext:Tr,useCallback:gP,useContext:Tr,useEffect:FS,useImperativeHandle:pP,useInsertionEffect:uP,useLayoutEffect:dP,useMemo:fP,useReducer:Zv,useRef:cP,useState:function(){return Zv(Jd)},useDebugValue:IS,useDeferredValue:function(e){var t=Dr();return mP(t,Ds.memoizedState,e)},useTransition:function(){var e=Zv(Jd)[0],t=Dr().memoizedState;return[e,t]},useMutableSource:sP,useSyncExternalStore:iP,useId:vP,unstable_isNewReconciler:!1},fL={readContext:Tr,useCallback:gP,useContext:Tr,useEffect:FS,useImperativeHandle:pP,useInsertionEffect:uP,useLayoutEffect:dP,useMemo:fP,useReducer:Jv,useRef:cP,useState:function(){return Jv(Jd)},useDebugValue:IS,useDeferredValue:function(e){var t=Dr();return Ds===null?t.memoizedState=e:mP(t,Ds.memoizedState,e)},useTransition:function(){var e=Jv(Jd)[0],t=Dr().memoizedState;return[e,t]},useMutableSource:sP,useSyncExternalStore:iP,useId:vP,unstable_isNewReconciler:!1};function Br(e,t){if(e&&e.defaultProps){t=hs({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function Sy(e,t,s,i){t=e.memoizedState,s=s(i,t),s=s==null?t:hs({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var ym={isMounted:function(e){return(e=e._reactInternals)?Fl(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var i=gi(),r=Uo(e),n=$n(i,r);n.payload=t,s!=null&&(n.callback=s),t=Wo(e,n,r),t!==null&&(Xr(t,e,r,i),Cg(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var i=gi(),r=Uo(e),n=$n(i,r);n.tag=1,n.payload=t,s!=null&&(n.callback=s),t=Wo(e,n,r),t!==null&&(Xr(t,e,r,i),Cg(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=gi(),i=Uo(e),r=$n(s,i);r.tag=2,t!=null&&(r.callback=t),t=Wo(e,r,i),t!==null&&(Xr(t,e,i,s),Cg(t,e,i))}};function WE(e,t,s,i,r,n,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,n,o):t.prototype&&t.prototype.isPureReactComponent?!Ud(s,i)||!Ud(r,n):!0}function SP(e,t,s){var i=!1,r=Xo,n=t.contextType;return typeof n=="object"&&n!==null?n=Tr(n):(r=Bi(t)?dl:ti.current,i=t.contextTypes,n=(i=i!=null)?Oc(e,r):Xo),t=new t(s,n),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ym,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=n),t}function zE(e,t,s,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,i),t.state!==e&&ym.enqueueReplaceState(t,t.state,null)}function xy(e,t,s,i){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},ES(e);var n=t.contextType;typeof n=="object"&&n!==null?r.context=Tr(n):(n=Bi(t)?dl:ti.current,r.context=Oc(e,n)),r.state=e.memoizedState,n=t.getDerivedStateFromProps,typeof n=="function"&&(Sy(e,t,n,s),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&ym.enqueueReplaceState(r,r.state,null),af(e,s,r,i),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Hc(e,t){try{var s="",i=t;do s+=Wk(i),i=i.return;while(i);var r=s}catch(n){r=`
Error generating stack: `+n.message+`
`+n.stack}return{value:e,source:t,stack:r,digest:null}}function Xv(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function Ey(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var mL=typeof WeakMap=="function"?WeakMap:Map;function xP(e,t,s){s=$n(-1,s),s.tag=3,s.payload={element:null};var i=t.value;return s.callback=function(){hf||(hf=!0,_y=i),Ey(e,t)},s}function EP(e,t,s){s=$n(-1,s),s.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var r=t.value;s.payload=function(){return i(r)},s.callback=function(){Ey(e,t)}}var n=e.stateNode;return n!==null&&typeof n.componentDidCatch=="function"&&(s.callback=function(){Ey(e,t),typeof i!="function"&&(zo===null?zo=new Set([this]):zo.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),s}function UE(e,t,s){var i=e.pingCache;if(i===null){i=e.pingCache=new mL;var r=new Set;i.set(t,r)}else r=i.get(t),r===void 0&&(r=new Set,i.set(t,r));r.has(s)||(r.add(s),e=FL.bind(null,e,t,s),t.then(e,e))}function $E(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function KE(e,t,s,i,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=$n(-1,1),t.tag=2,Wo(s,t,1))),s.lanes|=1),e)}var vL=no.ReactCurrentOwner,ki=!1;function ci(e,t,s,i){t.child=e===null?JD(t,null,s,i):Vc(t,e.child,s,i)}function YE(e,t,s,i,r){s=s.render;var n=t.ref;return Sc(t,r),i=PS(e,t,s,i,n,r),s=AS(),e!==null&&!ki?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zn(e,t,r)):(ls&&s&&mS(t),t.flags|=1,ci(e,t,i,r),t.child)}function qE(e,t,s,i,r){if(e===null){var n=s.type;return typeof n=="function"&&!VS(n)&&n.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=n,bP(e,t,n,i,r)):(e=bg(s.type,null,i,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(n=e.child,!(e.lanes&r)){var o=n.memoizedProps;if(s=s.compare,s=s!==null?s:Ud,s(o,i)&&e.ref===t.ref)return Zn(e,t,r)}return t.flags|=1,e=$o(n,i),e.ref=t.ref,e.return=t,t.child=e}function bP(e,t,s,i,r){if(e!==null){var n=e.memoizedProps;if(Ud(n,i)&&e.ref===t.ref)if(ki=!1,t.pendingProps=i=n,(e.lanes&r)!==0)e.flags&131072&&(ki=!0);else return t.lanes=e.lanes,Zn(e,t,r)}return by(e,t,s,i,r)}function RP(e,t,s){var i=t.pendingProps,r=i.children,n=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(pc,Qi),Qi|=s;else{if(!(s&1073741824))return e=n!==null?n.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qt(pc,Qi),Qi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=n!==null?n.baseLanes:s,Qt(pc,Qi),Qi|=i}else n!==null?(i=n.baseLanes|s,t.memoizedState=null):i=s,Qt(pc,Qi),Qi|=i;return ci(e,t,r,s),t.child}function TP(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function by(e,t,s,i,r){var n=Bi(s)?dl:ti.current;return n=Oc(t,n),Sc(t,r),s=PS(e,t,s,i,n,r),i=AS(),e!==null&&!ki?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zn(e,t,r)):(ls&&i&&mS(t),t.flags|=1,ci(e,t,s,r),t.child)}function QE(e,t,s,i,r){if(Bi(s)){var n=!0;tf(t)}else n=!1;if(Sc(t,r),t.stateNode===null)Sg(e,t),SP(t,s,i),xy(t,s,i,r),i=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=s.contextType;typeof u=="object"&&u!==null?u=Tr(u):(u=Bi(s)?dl:ti.current,u=Oc(t,u));var h=s.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&zE(t,o,i,u),Ro=!1;var g=t.memoizedState;o.state=g,af(t,i,o,r),l=t.memoizedState,a!==i||g!==l||Vi.current||Ro?(typeof h=="function"&&(Sy(t,s,h,i),l=t.memoizedState),(a=Ro||WE(t,s,a,i,g,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,eP(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:Br(t.type,a),o.props=u,p=t.pendingProps,g=o.context,l=s.contextType,typeof l=="object"&&l!==null?l=Tr(l):(l=Bi(s)?dl:ti.current,l=Oc(t,l));var m=s.getDerivedStateFromProps;(h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||g!==l)&&zE(t,o,i,l),Ro=!1,g=t.memoizedState,o.state=g,af(t,i,o,r);var C=t.memoizedState;a!==p||g!==C||Vi.current||Ro?(typeof m=="function"&&(Sy(t,s,m,i),C=t.memoizedState),(u=Ro||WE(t,s,u,i,g,C,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,C,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,C,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=C),o.props=i,o.state=C,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),i=!1)}return Ry(e,t,s,i,n,r)}function Ry(e,t,s,i,r,n){TP(e,t);var o=(t.flags&128)!==0;if(!i&&!o)return r&&ME(t,s,!1),Zn(e,t,n);i=t.stateNode,vL.current=t;var a=o&&typeof s.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&o?(t.child=Vc(t,e.child,null,n),t.child=Vc(t,null,a,n)):ci(e,t,a,n),t.memoizedState=i.state,r&&ME(t,s,!0),t.child}function DP(e){var t=e.stateNode;t.pendingContext?kE(e,t.pendingContext,t.pendingContext!==t.context):t.context&&kE(e,t.context,!1),bS(e,t.containerInfo)}function ZE(e,t,s,i,r){return Gc(),CS(r),t.flags|=256,ci(e,t,s,i),t.child}var Ty={dehydrated:null,treeContext:null,retryLane:0};function Dy(e){return{baseLanes:e,cachePool:null,transitions:null}}function PP(e,t,s){var i=t.pendingProps,r=us.current,n=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(r&2)!==0),a?(n=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Qt(us,r&1),e===null)return yy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=i.children,e=i.fallback,n?(i=t.mode,n=t.child,o={mode:"hidden",children:o},!(i&1)&&n!==null?(n.childLanes=0,n.pendingProps=o):n=xm(o,i,0,null),e=sl(e,i,s,null),n.return=t,e.return=t,n.sibling=e,t.child=n,t.child.memoizedState=Dy(s),t.memoizedState=Ty,e):NS(t,o));if(r=e.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return CL(e,t,o,i,a,r,s);if(n){n=i.fallback,o=t.mode,r=e.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&t.child!==r?(i=t.child,i.childLanes=0,i.pendingProps=l,t.deletions=null):(i=$o(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?n=$o(a,n):(n=sl(n,o,s,null),n.flags|=2),n.return=t,i.return=t,i.sibling=n,t.child=i,i=n,n=t.child,o=e.child.memoizedState,o=o===null?Dy(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},n.memoizedState=o,n.childLanes=e.childLanes&~s,t.memoizedState=Ty,i}return n=e.child,e=n.sibling,i=$o(n,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=s),i.return=t,i.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=i,t.memoizedState=null,i}function NS(e,t){return t=xm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Jp(e,t,s,i){return i!==null&&CS(i),Vc(t,e.child,null,s),e=NS(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function CL(e,t,s,i,r,n,o){if(s)return t.flags&256?(t.flags&=-257,i=Xv(Error(Oe(422))),Jp(e,t,o,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(n=i.fallback,r=t.mode,i=xm({mode:"visible",children:i.children},r,0,null),n=sl(n,r,o,null),n.flags|=2,i.return=t,n.return=t,i.sibling=n,t.child=i,t.mode&1&&Vc(t,e.child,null,o),t.child.memoizedState=Dy(o),t.memoizedState=Ty,n);if(!(t.mode&1))return Jp(e,t,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,n=Error(Oe(419)),i=Xv(n,i,void 0),Jp(e,t,o,i)}if(a=(o&e.childLanes)!==0,ki||a){if(i=Ms,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==n.retryLane&&(n.retryLane=r,Qn(e,r),Xr(i,e,r,-1))}return GS(),i=Xv(Error(Oe(421))),Jp(e,t,o,i)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=IL.bind(null,e),r._reactRetry=t,null):(e=n.treeContext,sr=jo(r.nextSibling),ir=t,ls=!0,Kr=null,e!==null&&(vr[Cr++]=zn,vr[Cr++]=Un,vr[Cr++]=hl,zn=e.id,Un=e.overflow,hl=t),t=NS(t,i.children),t.flags|=4096,t)}function JE(e,t,s){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),wy(e.return,t,s)}function eC(e,t,s,i,r){var n=e.memoizedState;n===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:s,tailMode:r}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=i,n.tail=s,n.tailMode=r)}function AP(e,t,s){var i=t.pendingProps,r=i.revealOrder,n=i.tail;if(ci(e,t,i.children,s),i=us.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&JE(e,s,t);else if(e.tag===19)JE(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Qt(us,i),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(s=t.child,r=null;s!==null;)e=s.alternate,e!==null&&lf(e)===null&&(r=s),s=s.sibling;s=r,s===null?(r=t.child,t.child=null):(r=s.sibling,s.sibling=null),eC(t,!1,r,s,n);break;case"backwards":for(s=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&lf(e)===null){t.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}eC(t,!0,s,null,n);break;case"together":eC(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sg(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zn(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),gl|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Oe(153));if(t.child!==null){for(e=t.child,s=$o(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=$o(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function yL(e,t,s){switch(t.tag){case 3:DP(t),Gc();break;case 5:tP(t);break;case 1:Bi(t.type)&&tf(t);break;case 4:bS(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Qt(nf,i._currentValue),i._currentValue=r;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Qt(us,us.current&1),t.flags|=128,null):s&t.child.childLanes?PP(e,t,s):(Qt(us,us.current&1),e=Zn(e,t,s),e!==null?e.sibling:null);Qt(us,us.current&1);break;case 19:if(i=(s&t.childLanes)!==0,e.flags&128){if(i)return AP(e,t,s);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Qt(us,us.current),i)break;return null;case 22:case 23:return t.lanes=0,RP(e,t,s)}return Zn(e,t,s)}var FP,Py,IP,NP;FP=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Py=function(){};IP=function(e,t,s,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,za(bn.current);var n=null;switch(s){case"input":r=QC(e,r),i=QC(e,i),n=[];break;case"select":r=hs({},r,{value:void 0}),i=hs({},i,{value:void 0}),n=[];break;case"textarea":r=XC(e,r),i=XC(e,i),n=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Xg)}ty(s,i);var o;s=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Gd.hasOwnProperty(u)?n||(n=[]):(n=n||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(s||(s={}),s[o]=l[o])}else s||(n||(n=[]),n.push(u,s)),s=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(n=n||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(n=n||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Gd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ts("scroll",e),n||a===l||(n=[])):(n=n||[]).push(u,l))}s&&(n=n||[]).push("style",s);var u=n;(t.updateQueue=u)&&(t.flags|=4)}};NP=function(e,t,s,i){s!==i&&(t.flags|=4)};function Ju(e,t){if(!ls)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var i=null;s!==null;)s.alternate!==null&&(i=s),s=s.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Js(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,i=0;if(t)for(var r=e.child;r!==null;)s|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)s|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=s,t}function wL(e,t,s){var i=t.pendingProps;switch(vS(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Js(t),null;case 1:return Bi(t.type)&&ef(),Js(t),null;case 3:return i=t.stateNode,Bc(),is(Vi),is(ti),TS(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(Qp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Kr!==null&&(Ly(Kr),Kr=null))),Py(e,t),Js(t),null;case 5:RS(t);var r=za(Qd.current);if(s=t.type,e!==null&&t.stateNode!=null)IP(e,t,s,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Oe(166));return Js(t),null}if(e=za(bn.current),Qp(t)){i=t.stateNode,s=t.type;var n=t.memoizedProps;switch(i[yn]=t,i[Yd]=n,e=(t.mode&1)!==0,s){case"dialog":ts("cancel",i),ts("close",i);break;case"iframe":case"object":case"embed":ts("load",i);break;case"video":case"audio":for(r=0;r<ld.length;r++)ts(ld[r],i);break;case"source":ts("error",i);break;case"img":case"image":case"link":ts("error",i),ts("load",i);break;case"details":ts("toggle",i);break;case"input":aE(i,n),ts("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!n.multiple},ts("invalid",i);break;case"textarea":cE(i,n),ts("invalid",i)}ty(s,n),r=null;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];o==="children"?typeof a=="string"?i.textContent!==a&&(n.suppressHydrationWarning!==!0&&qp(i.textContent,a,e),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(n.suppressHydrationWarning!==!0&&qp(i.textContent,a,e),r=["children",""+a]):Gd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ts("scroll",i)}switch(s){case"input":Hp(i),lE(i,n,!0);break;case"textarea":Hp(i),uE(i);break;case"select":case"option":break;default:typeof n.onClick=="function"&&(i.onclick=Xg)}i=r,t.updateQueue=i,i!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=oD(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=o.createElement(s,{is:i.is}):(e=o.createElement(s),s==="select"&&(o=e,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):e=o.createElementNS(e,s),e[yn]=t,e[Yd]=i,FP(e,t,!1,!1),t.stateNode=e;e:{switch(o=sy(s,i),s){case"dialog":ts("cancel",e),ts("close",e),r=i;break;case"iframe":case"object":case"embed":ts("load",e),r=i;break;case"video":case"audio":for(r=0;r<ld.length;r++)ts(ld[r],e);r=i;break;case"source":ts("error",e),r=i;break;case"img":case"image":case"link":ts("error",e),ts("load",e),r=i;break;case"details":ts("toggle",e),r=i;break;case"input":aE(e,i),r=QC(e,i),ts("invalid",e);break;case"option":r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=hs({},i,{value:void 0}),ts("invalid",e);break;case"textarea":cE(e,i),r=XC(e,i),ts("invalid",e);break;default:r=i}ty(s,r),a=r;for(n in a)if(a.hasOwnProperty(n)){var l=a[n];n==="style"?cD(e,l):n==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&aD(e,l)):n==="children"?typeof l=="string"?(s!=="textarea"||l!=="")&&Vd(e,l):typeof l=="number"&&Vd(e,""+l):n!=="suppressContentEditableWarning"&&n!=="suppressHydrationWarning"&&n!=="autoFocus"&&(Gd.hasOwnProperty(n)?l!=null&&n==="onScroll"&&ts("scroll",e):l!=null&&sS(e,n,l,o))}switch(s){case"input":Hp(e),lE(e,i,!1);break;case"textarea":Hp(e),uE(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Jo(i.value));break;case"select":e.multiple=!!i.multiple,n=i.value,n!=null?vc(e,!!i.multiple,n,!1):i.defaultValue!=null&&vc(e,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=Xg)}switch(s){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Js(t),null;case 6:if(e&&t.stateNode!=null)NP(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Oe(166));if(s=za(Qd.current),za(bn.current),Qp(t)){if(i=t.stateNode,s=t.memoizedProps,i[yn]=t,(n=i.nodeValue!==s)&&(e=ir,e!==null))switch(e.tag){case 3:qp(i.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qp(i.nodeValue,s,(e.mode&1)!==0)}n&&(t.flags|=4)}else i=(s.nodeType===9?s:s.ownerDocument).createTextNode(i),i[yn]=t,t.stateNode=i}return Js(t),null;case 13:if(is(us),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ls&&sr!==null&&t.mode&1&&!(t.flags&128))QD(),Gc(),t.flags|=98560,n=!1;else if(n=Qp(t),i!==null&&i.dehydrated!==null){if(e===null){if(!n)throw Error(Oe(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Oe(317));n[yn]=t}else Gc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Js(t),n=!1}else Kr!==null&&(Ly(Kr),Kr=null),n=!0;if(!n)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||us.current&1?As===0&&(As=3):GS())),t.updateQueue!==null&&(t.flags|=4),Js(t),null);case 4:return Bc(),Py(e,t),e===null&&$d(t.stateNode.containerInfo),Js(t),null;case 10:return SS(t.type._context),Js(t),null;case 17:return Bi(t.type)&&ef(),Js(t),null;case 19:if(is(us),n=t.memoizedState,n===null)return Js(t),null;if(i=(t.flags&128)!==0,o=n.rendering,o===null)if(i)Ju(n,!1);else{if(As!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=lf(e),o!==null){for(t.flags|=128,Ju(n,!1),i=o.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=s,s=t.child;s!==null;)n=s,e=i,n.flags&=14680066,o=n.alternate,o===null?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,e=o.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Qt(us,us.current&1|2),t.child}e=e.sibling}n.tail!==null&&Cs()>jc&&(t.flags|=128,i=!0,Ju(n,!1),t.lanes=4194304)}else{if(!i)if(e=lf(o),e!==null){if(t.flags|=128,i=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),Ju(n,!0),n.tail===null&&n.tailMode==="hidden"&&!o.alternate&&!ls)return Js(t),null}else 2*Cs()-n.renderingStartTime>jc&&s!==1073741824&&(t.flags|=128,i=!0,Ju(n,!1),t.lanes=4194304);n.isBackwards?(o.sibling=t.child,t.child=o):(s=n.last,s!==null?s.sibling=o:t.child=o,n.last=o)}return n.tail!==null?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=Cs(),t.sibling=null,s=us.current,Qt(us,i?s&1|2:s&1),t):(Js(t),null);case 22:case 23:return OS(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?Qi&1073741824&&(Js(t),t.subtreeFlags&6&&(t.flags|=8192)):Js(t),null;case 24:return null;case 25:return null}throw Error(Oe(156,t.tag))}function SL(e,t){switch(vS(t),t.tag){case 1:return Bi(t.type)&&ef(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bc(),is(Vi),is(ti),TS(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return RS(t),null;case 13:if(is(us),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Oe(340));Gc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return is(us),null;case 4:return Bc(),null;case 10:return SS(t.type._context),null;case 22:case 23:return OS(),null;case 24:return null;default:return null}}var Xp=!1,Xs=!1,xL=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function hc(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(i){gs(e,t,i)}else s.current=null}function Ay(e,t,s){try{s()}catch(i){gs(e,t,i)}}var XE=!1;function EL(e,t){if(hy=Qg,e=OD(),fS(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var i=s.getSelection&&s.getSelection();if(i&&i.rangeCount!==0){s=i.anchorNode;var r=i.anchorOffset,n=i.focusNode;i=i.focusOffset;try{s.nodeType,n.nodeType}catch{s=null;break e}var o=0,a=-1,l=-1,u=0,h=0,p=e,g=null;t:for(;;){for(var m;p!==s||r!==0&&p.nodeType!==3||(a=o+r),p!==n||i!==0&&p.nodeType!==3||(l=o+i),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===e)break t;if(g===s&&++u===r&&(a=o),g===n&&++h===i&&(l=o),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}s=a===-1||l===-1?null:{start:a,end:l}}else s=null}s=s||{start:0,end:0}}else s=null;for(py={focusedElem:e,selectionRange:s},Qg=!1,Ze=t;Ze!==null;)if(t=Ze,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ze=e;else for(;Ze!==null;){t=Ze;try{var C=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var y=C.memoizedProps,R=C.memoizedState,x=t.stateNode,S=x.getSnapshotBeforeUpdate(t.elementType===t.type?y:Br(t.type,y),R);x.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var T=t.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Oe(163))}}catch(I){gs(t,t.return,I)}if(e=t.sibling,e!==null){e.return=t.return,Ze=e;break}Ze=t.return}return C=XE,XE=!1,C}function Ad(e,t,s){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&e)===e){var n=r.destroy;r.destroy=void 0,n!==void 0&&Ay(t,s,n)}r=r.next}while(r!==i)}}function wm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var i=s.create;s.destroy=i()}s=s.next}while(s!==t)}}function Fy(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function _P(e){var t=e.alternate;t!==null&&(e.alternate=null,_P(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[yn],delete t[Yd],delete t[my],delete t[nL],delete t[oL])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kP(e){return e.tag===5||e.tag===3||e.tag===4}function eb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Iy(e,t,s){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Xg));else if(i!==4&&(e=e.child,e!==null))for(Iy(e,t,s),e=e.sibling;e!==null;)Iy(e,t,s),e=e.sibling}function Ny(e,t,s){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(Ny(e,t,s),e=e.sibling;e!==null;)Ny(e,t,s),e=e.sibling}var Hs=null,zr=!1;function vo(e,t,s){for(s=s.child;s!==null;)MP(e,t,s),s=s.sibling}function MP(e,t,s){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(hm,s)}catch{}switch(s.tag){case 5:Xs||hc(s,t);case 6:var i=Hs,r=zr;Hs=null,vo(e,t,s),Hs=i,zr=r,Hs!==null&&(zr?(e=Hs,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Hs.removeChild(s.stateNode));break;case 18:Hs!==null&&(zr?(e=Hs,s=s.stateNode,e.nodeType===8?Kv(e.parentNode,s):e.nodeType===1&&Kv(e,s),Wd(e)):Kv(Hs,s.stateNode));break;case 4:i=Hs,r=zr,Hs=s.stateNode.containerInfo,zr=!0,vo(e,t,s),Hs=i,zr=r;break;case 0:case 11:case 14:case 15:if(!Xs&&(i=s.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var n=r,o=n.destroy;n=n.tag,o!==void 0&&(n&2||n&4)&&Ay(s,t,o),r=r.next}while(r!==i)}vo(e,t,s);break;case 1:if(!Xs&&(hc(s,t),i=s.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=s.memoizedProps,i.state=s.memoizedState,i.componentWillUnmount()}catch(a){gs(s,t,a)}vo(e,t,s);break;case 21:vo(e,t,s);break;case 22:s.mode&1?(Xs=(i=Xs)||s.memoizedState!==null,vo(e,t,s),Xs=i):vo(e,t,s);break;default:vo(e,t,s)}}function tb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new xL),t.forEach(function(i){var r=NL.bind(null,e,i);s.has(i)||(s.add(i),i.then(r,r))})}}function Gr(e,t){var s=t.deletions;if(s!==null)for(var i=0;i<s.length;i++){var r=s[i];try{var n=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Hs=a.stateNode,zr=!1;break e;case 3:Hs=a.stateNode.containerInfo,zr=!0;break e;case 4:Hs=a.stateNode.containerInfo,zr=!0;break e}a=a.return}if(Hs===null)throw Error(Oe(160));MP(n,o,r),Hs=null,zr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){gs(r,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)LP(t,e),t=t.sibling}function LP(e,t){var s=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Gr(t,e),cn(e),i&4){try{Ad(3,e,e.return),wm(3,e)}catch(y){gs(e,e.return,y)}try{Ad(5,e,e.return)}catch(y){gs(e,e.return,y)}}break;case 1:Gr(t,e),cn(e),i&512&&s!==null&&hc(s,s.return);break;case 5:if(Gr(t,e),cn(e),i&512&&s!==null&&hc(s,s.return),e.flags&32){var r=e.stateNode;try{Vd(r,"")}catch(y){gs(e,e.return,y)}}if(i&4&&(r=e.stateNode,r!=null)){var n=e.memoizedProps,o=s!==null?s.memoizedProps:n,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&n.type==="radio"&&n.name!=null&&rD(r,n),sy(a,o);var u=sy(a,n);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?cD(r,p):h==="dangerouslySetInnerHTML"?aD(r,p):h==="children"?Vd(r,p):sS(r,h,p,u)}switch(a){case"input":ZC(r,n);break;case"textarea":nD(r,n);break;case"select":var g=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!n.multiple;var m=n.value;m!=null?vc(r,!!n.multiple,m,!1):g!==!!n.multiple&&(n.defaultValue!=null?vc(r,!!n.multiple,n.defaultValue,!0):vc(r,!!n.multiple,n.multiple?[]:"",!1))}r[Yd]=n}catch(y){gs(e,e.return,y)}}break;case 6:if(Gr(t,e),cn(e),i&4){if(e.stateNode===null)throw Error(Oe(162));r=e.stateNode,n=e.memoizedProps;try{r.nodeValue=n}catch(y){gs(e,e.return,y)}}break;case 3:if(Gr(t,e),cn(e),i&4&&s!==null&&s.memoizedState.isDehydrated)try{Wd(t.containerInfo)}catch(y){gs(e,e.return,y)}break;case 4:Gr(t,e),cn(e);break;case 13:Gr(t,e),cn(e),r=e.child,r.flags&8192&&(n=r.memoizedState!==null,r.stateNode.isHidden=n,!n||r.alternate!==null&&r.alternate.memoizedState!==null||(MS=Cs())),i&4&&tb(e);break;case 22:if(h=s!==null&&s.memoizedState!==null,e.mode&1?(Xs=(u=Xs)||h,Gr(t,e),Xs=u):Gr(t,e),cn(e),i&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(Ze=e,h=e.child;h!==null;){for(p=Ze=h;Ze!==null;){switch(g=Ze,m=g.child,g.tag){case 0:case 11:case 14:case 15:Ad(4,g,g.return);break;case 1:hc(g,g.return);var C=g.stateNode;if(typeof C.componentWillUnmount=="function"){i=g,s=g.return;try{t=i,C.props=t.memoizedProps,C.state=t.memoizedState,C.componentWillUnmount()}catch(y){gs(i,s,y)}}break;case 5:hc(g,g.return);break;case 22:if(g.memoizedState!==null){ib(p);continue}}m!==null?(m.return=g,Ze=m):ib(p)}h=h.sibling}e:for(h=null,p=e;;){if(p.tag===5){if(h===null){h=p;try{r=p.stateNode,u?(n=r.style,typeof n.setProperty=="function"?n.setProperty("display","none","important"):n.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=lD("display",o))}catch(y){gs(e,e.return,y)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(y){gs(e,e.return,y)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Gr(t,e),cn(e),i&4&&tb(e);break;case 21:break;default:Gr(t,e),cn(e)}}function cn(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(kP(s)){var i=s;break e}s=s.return}throw Error(Oe(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Vd(r,""),i.flags&=-33);var n=eb(e);Ny(e,n,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=eb(e);Iy(e,a,o);break;default:throw Error(Oe(161))}}catch(l){gs(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bL(e,t,s){Ze=e,OP(e)}function OP(e,t,s){for(var i=(e.mode&1)!==0;Ze!==null;){var r=Ze,n=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Xp;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Xs;a=Xp;var u=Xs;if(Xp=o,(Xs=l)&&!u)for(Ze=r;Ze!==null;)o=Ze,l=o.child,o.tag===22&&o.memoizedState!==null?rb(r):l!==null?(l.return=o,Ze=l):rb(r);for(;n!==null;)Ze=n,OP(n),n=n.sibling;Ze=r,Xp=a,Xs=u}sb(e)}else r.subtreeFlags&8772&&n!==null?(n.return=r,Ze=n):sb(e)}}function sb(e){for(;Ze!==null;){var t=Ze;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xs||wm(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!Xs)if(s===null)i.componentDidMount();else{var r=t.elementType===t.type?s.memoizedProps:Br(t.type,s.memoizedProps);i.componentDidUpdate(r,s.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var n=t.updateQueue;n!==null&&BE(t,n,i);break;case 3:var o=t.updateQueue;if(o!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}BE(t,o,s)}break;case 5:var a=t.stateNode;if(s===null&&t.flags&4){s=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&s.focus();break;case"img":l.src&&(s.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Wd(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Oe(163))}Xs||t.flags&512&&Fy(t)}catch(g){gs(t,t.return,g)}}if(t===e){Ze=null;break}if(s=t.sibling,s!==null){s.return=t.return,Ze=s;break}Ze=t.return}}function ib(e){for(;Ze!==null;){var t=Ze;if(t===e){Ze=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Ze=s;break}Ze=t.return}}function rb(e){for(;Ze!==null;){var t=Ze;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{wm(4,t)}catch(l){gs(t,s,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var r=t.return;try{i.componentDidMount()}catch(l){gs(t,r,l)}}var n=t.return;try{Fy(t)}catch(l){gs(t,n,l)}break;case 5:var o=t.return;try{Fy(t)}catch(l){gs(t,o,l)}}}catch(l){gs(t,t.return,l)}if(t===e){Ze=null;break}var a=t.sibling;if(a!==null){a.return=t.return,Ze=a;break}Ze=t.return}}var RL=Math.ceil,df=no.ReactCurrentDispatcher,_S=no.ReactCurrentOwner,Er=no.ReactCurrentBatchConfig,kt=0,Ms=null,bs=null,Ws=0,Qi=0,pc=ca(0),As=0,eh=null,gl=0,Sm=0,kS=0,Fd=null,Ii=null,MS=0,jc=1/0,Vn=null,hf=!1,_y=null,zo=null,eg=!1,Lo=null,pf=0,Id=0,ky=null,xg=-1,Eg=0;function gi(){return kt&6?Cs():xg!==-1?xg:xg=Cs()}function Uo(e){return e.mode&1?kt&2&&Ws!==0?Ws&-Ws:lL.transition!==null?(Eg===0&&(Eg=SD()),Eg):(e=Ht,e!==0||(e=window.event,e=e===void 0?16:PD(e.type)),e):1}function Xr(e,t,s,i){if(50<Id)throw Id=0,ky=null,Error(Oe(185));ip(e,s,i),(!(kt&2)||e!==Ms)&&(e===Ms&&(!(kt&2)&&(Sm|=s),As===4&&Do(e,Ws)),Hi(e,i),s===1&&kt===0&&!(t.mode&1)&&(jc=Cs()+500,vm&&ua()))}function Hi(e,t){var s=e.callbackNode;lM(e,t);var i=qg(e,e===Ms?Ws:0);if(i===0)s!==null&&pE(s),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(s!=null&&pE(s),t===1)e.tag===0?aL(nb.bind(null,e)):KD(nb.bind(null,e)),iL(function(){!(kt&6)&&ua()}),s=null;else{switch(xD(i)){case 1:s=aS;break;case 4:s=yD;break;case 16:s=Yg;break;case 536870912:s=wD;break;default:s=Yg}s=UP(s,GP.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function GP(e,t){if(xg=-1,Eg=0,kt&6)throw Error(Oe(327));var s=e.callbackNode;if(xc()&&e.callbackNode!==s)return null;var i=qg(e,e===Ms?Ws:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=gf(e,i);else{t=i;var r=kt;kt|=2;var n=BP();(Ms!==e||Ws!==t)&&(Vn=null,jc=Cs()+500,tl(e,t));do try{PL();break}catch(a){VP(e,a)}while(!0);wS(),df.current=n,kt=r,bs!==null?t=0:(Ms=null,Ws=0,t=As)}if(t!==0){if(t===2&&(r=ay(e),r!==0&&(i=r,t=My(e,r))),t===1)throw s=eh,tl(e,0),Do(e,i),Hi(e,Cs()),s;if(t===6)Do(e,i);else{if(r=e.current.alternate,!(i&30)&&!TL(r)&&(t=gf(e,i),t===2&&(n=ay(e),n!==0&&(i=n,t=My(e,n))),t===1))throw s=eh,tl(e,0),Do(e,i),Hi(e,Cs()),s;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(Oe(345));case 2:Na(e,Ii,Vn);break;case 3:if(Do(e,i),(i&130023424)===i&&(t=MS+500-Cs(),10<t)){if(qg(e,0)!==0)break;if(r=e.suspendedLanes,(r&i)!==i){gi(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=fy(Na.bind(null,e,Ii,Vn),t);break}Na(e,Ii,Vn);break;case 4:if(Do(e,i),(i&4194240)===i)break;for(t=e.eventTimes,r=-1;0<i;){var o=31-Jr(i);n=1<<o,o=t[o],o>r&&(r=o),i&=~n}if(i=r,i=Cs()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*RL(i/1960))-i,10<i){e.timeoutHandle=fy(Na.bind(null,e,Ii,Vn),i);break}Na(e,Ii,Vn);break;case 5:Na(e,Ii,Vn);break;default:throw Error(Oe(329))}}}return Hi(e,Cs()),e.callbackNode===s?GP.bind(null,e):null}function My(e,t){var s=Fd;return e.current.memoizedState.isDehydrated&&(tl(e,t).flags|=256),e=gf(e,t),e!==2&&(t=Ii,Ii=s,t!==null&&Ly(t)),e}function Ly(e){Ii===null?Ii=e:Ii.push.apply(Ii,e)}function TL(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var i=0;i<s.length;i++){var r=s[i],n=r.getSnapshot;r=r.value;try{if(!sn(n(),r))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Do(e,t){for(t&=~kS,t&=~Sm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Jr(t),i=1<<s;e[s]=-1,t&=~i}}function nb(e){if(kt&6)throw Error(Oe(327));xc();var t=qg(e,0);if(!(t&1))return Hi(e,Cs()),null;var s=gf(e,t);if(e.tag!==0&&s===2){var i=ay(e);i!==0&&(t=i,s=My(e,i))}if(s===1)throw s=eh,tl(e,0),Do(e,t),Hi(e,Cs()),s;if(s===6)throw Error(Oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Na(e,Ii,Vn),Hi(e,Cs()),null}function LS(e,t){var s=kt;kt|=1;try{return e(t)}finally{kt=s,kt===0&&(jc=Cs()+500,vm&&ua())}}function fl(e){Lo!==null&&Lo.tag===0&&!(kt&6)&&xc();var t=kt;kt|=1;var s=Er.transition,i=Ht;try{if(Er.transition=null,Ht=1,e)return e()}finally{Ht=i,Er.transition=s,kt=t,!(kt&6)&&ua()}}function OS(){Qi=pc.current,is(pc)}function tl(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,sL(s)),bs!==null)for(s=bs.return;s!==null;){var i=s;switch(vS(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&ef();break;case 3:Bc(),is(Vi),is(ti),TS();break;case 5:RS(i);break;case 4:Bc();break;case 13:is(us);break;case 19:is(us);break;case 10:SS(i.type._context);break;case 22:case 23:OS()}s=s.return}if(Ms=e,bs=e=$o(e.current,null),Ws=Qi=t,As=0,eh=null,kS=Sm=gl=0,Ii=Fd=null,Wa!==null){for(t=0;t<Wa.length;t++)if(s=Wa[t],i=s.interleaved,i!==null){s.interleaved=null;var r=i.next,n=s.pending;if(n!==null){var o=n.next;n.next=r,i.next=o}s.pending=i}Wa=null}return e}function VP(e,t){do{var s=bs;try{if(wS(),yg.current=uf,cf){for(var i=ds.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}cf=!1}if(pl=0,_s=Ds=ds=null,Pd=!1,Zd=0,_S.current=null,s===null||s.return===null){As=1,eh=t,bs=null;break}e:{var n=e,o=s.return,a=s,l=t;if(t=Ws,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=$E(o);if(m!==null){m.flags&=-257,KE(m,o,a,n,t),m.mode&1&&UE(n,u,t),t=m,l=u;var C=t.updateQueue;if(C===null){var y=new Set;y.add(l),t.updateQueue=y}else C.add(l);break e}else{if(!(t&1)){UE(n,u,t),GS();break e}l=Error(Oe(426))}}else if(ls&&a.mode&1){var R=$E(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),KE(R,o,a,n,t),CS(Hc(l,a));break e}}n=l=Hc(l,a),As!==4&&(As=2),Fd===null?Fd=[n]:Fd.push(n),n=o;do{switch(n.tag){case 3:n.flags|=65536,t&=-t,n.lanes|=t;var x=xP(n,l,t);VE(n,x);break e;case 1:a=l;var S=n.type,T=n.stateNode;if(!(n.flags&128)&&(typeof S.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(zo===null||!zo.has(T)))){n.flags|=65536,t&=-t,n.lanes|=t;var I=EP(n,a,t);VE(n,I);break e}}n=n.return}while(n!==null)}jP(s)}catch(V){t=V,bs===s&&s!==null&&(bs=s=s.return);continue}break}while(!0)}function BP(){var e=df.current;return df.current=uf,e===null?uf:e}function GS(){(As===0||As===3||As===2)&&(As=4),Ms===null||!(gl&268435455)&&!(Sm&268435455)||Do(Ms,Ws)}function gf(e,t){var s=kt;kt|=2;var i=BP();(Ms!==e||Ws!==t)&&(Vn=null,tl(e,t));do try{DL();break}catch(r){VP(e,r)}while(!0);if(wS(),kt=s,df.current=i,bs!==null)throw Error(Oe(261));return Ms=null,Ws=0,As}function DL(){for(;bs!==null;)HP(bs)}function PL(){for(;bs!==null&&!Xk();)HP(bs)}function HP(e){var t=zP(e.alternate,e,Qi);e.memoizedProps=e.pendingProps,t===null?jP(e):bs=t,_S.current=null}function jP(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=SL(s,t),s!==null){s.flags&=32767,bs=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{As=6,bs=null;return}}else if(s=wL(s,t,Qi),s!==null){bs=s;return}if(t=t.sibling,t!==null){bs=t;return}bs=t=e}while(t!==null);As===0&&(As=5)}function Na(e,t,s){var i=Ht,r=Er.transition;try{Er.transition=null,Ht=1,AL(e,t,s,i)}finally{Er.transition=r,Ht=i}return null}function AL(e,t,s,i){do xc();while(Lo!==null);if(kt&6)throw Error(Oe(327));s=e.finishedWork;var r=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(Oe(177));e.callbackNode=null,e.callbackPriority=0;var n=s.lanes|s.childLanes;if(cM(e,n),e===Ms&&(bs=Ms=null,Ws=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||eg||(eg=!0,UP(Yg,function(){return xc(),null})),n=(s.flags&15990)!==0,s.subtreeFlags&15990||n){n=Er.transition,Er.transition=null;var o=Ht;Ht=1;var a=kt;kt|=4,_S.current=null,EL(e,s),LP(s,e),qM(py),Qg=!!hy,py=hy=null,e.current=s,bL(s),eM(),kt=a,Ht=o,Er.transition=n}else e.current=s;if(eg&&(eg=!1,Lo=e,pf=r),n=e.pendingLanes,n===0&&(zo=null),iM(s.stateNode),Hi(e,Cs()),t!==null)for(i=e.onRecoverableError,s=0;s<t.length;s++)r=t[s],i(r.value,{componentStack:r.stack,digest:r.digest});if(hf)throw hf=!1,e=_y,_y=null,e;return pf&1&&e.tag!==0&&xc(),n=e.pendingLanes,n&1?e===ky?Id++:(Id=0,ky=e):Id=0,ua(),null}function xc(){if(Lo!==null){var e=xD(pf),t=Er.transition,s=Ht;try{if(Er.transition=null,Ht=16>e?16:e,Lo===null)var i=!1;else{if(e=Lo,Lo=null,pf=0,kt&6)throw Error(Oe(331));var r=kt;for(kt|=4,Ze=e.current;Ze!==null;){var n=Ze,o=n.child;if(Ze.flags&16){var a=n.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ze=u;Ze!==null;){var h=Ze;switch(h.tag){case 0:case 11:case 15:Ad(8,h,n)}var p=h.child;if(p!==null)p.return=h,Ze=p;else for(;Ze!==null;){h=Ze;var g=h.sibling,m=h.return;if(_P(h),h===u){Ze=null;break}if(g!==null){g.return=m,Ze=g;break}Ze=m}}}var C=n.alternate;if(C!==null){var y=C.child;if(y!==null){C.child=null;do{var R=y.sibling;y.sibling=null,y=R}while(y!==null)}}Ze=n}}if(n.subtreeFlags&2064&&o!==null)o.return=n,Ze=o;else e:for(;Ze!==null;){if(n=Ze,n.flags&2048)switch(n.tag){case 0:case 11:case 15:Ad(9,n,n.return)}var x=n.sibling;if(x!==null){x.return=n.return,Ze=x;break e}Ze=n.return}}var S=e.current;for(Ze=S;Ze!==null;){o=Ze;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,Ze=T;else e:for(o=S;Ze!==null;){if(a=Ze,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:wm(9,a)}}catch(V){gs(a,a.return,V)}if(a===o){Ze=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,Ze=I;break e}Ze=a.return}}if(kt=r,ua(),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(hm,e)}catch{}i=!0}return i}finally{Ht=s,Er.transition=t}}return!1}function ob(e,t,s){t=Hc(s,t),t=xP(e,t,1),e=Wo(e,t,1),t=gi(),e!==null&&(ip(e,1,t),Hi(e,t))}function gs(e,t,s){if(e.tag===3)ob(e,e,s);else for(;t!==null;){if(t.tag===3){ob(t,e,s);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(zo===null||!zo.has(i))){e=Hc(s,e),e=EP(t,e,1),t=Wo(t,e,1),e=gi(),t!==null&&(ip(t,1,e),Hi(t,e));break}}t=t.return}}function FL(e,t,s){var i=e.pingCache;i!==null&&i.delete(t),t=gi(),e.pingedLanes|=e.suspendedLanes&s,Ms===e&&(Ws&s)===s&&(As===4||As===3&&(Ws&130023424)===Ws&&500>Cs()-MS?tl(e,0):kS|=s),Hi(e,t)}function WP(e,t){t===0&&(e.mode&1?(t=zp,zp<<=1,!(zp&130023424)&&(zp=4194304)):t=1);var s=gi();e=Qn(e,t),e!==null&&(ip(e,t,s),Hi(e,s))}function IL(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),WP(e,s)}function NL(e,t){var s=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;r!==null&&(s=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Oe(314))}i!==null&&i.delete(t),WP(e,s)}var zP;zP=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vi.current)ki=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return ki=!1,yL(e,t,s);ki=!!(e.flags&131072)}else ki=!1,ls&&t.flags&1048576&&YD(t,rf,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Sg(e,t),e=t.pendingProps;var r=Oc(t,ti.current);Sc(t,s),r=PS(null,t,i,e,r,s);var n=AS();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Bi(i)?(n=!0,tf(t)):n=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,ES(t),r.updater=ym,t.stateNode=r,r._reactInternals=t,xy(t,i,e,s),t=Ry(null,t,i,!0,n,s)):(t.tag=0,ls&&n&&mS(t),ci(null,t,r,s),t=t.child),t;case 16:i=t.elementType;e:{switch(Sg(e,t),e=t.pendingProps,r=i._init,i=r(i._payload),t.type=i,r=t.tag=kL(i),e=Br(i,e),r){case 0:t=by(null,t,i,e,s);break e;case 1:t=QE(null,t,i,e,s);break e;case 11:t=YE(null,t,i,e,s);break e;case 14:t=qE(null,t,i,Br(i.type,e),s);break e}throw Error(Oe(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Br(i,r),by(e,t,i,r,s);case 1:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Br(i,r),QE(e,t,i,r,s);case 3:e:{if(DP(t),e===null)throw Error(Oe(387));i=t.pendingProps,n=t.memoizedState,r=n.element,eP(e,t),af(t,i,null,s);var o=t.memoizedState;if(i=o.element,n.isDehydrated)if(n={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=n,t.memoizedState=n,t.flags&256){r=Hc(Error(Oe(423)),t),t=ZE(e,t,i,s,r);break e}else if(i!==r){r=Hc(Error(Oe(424)),t),t=ZE(e,t,i,s,r);break e}else for(sr=jo(t.stateNode.containerInfo.firstChild),ir=t,ls=!0,Kr=null,s=JD(t,null,i,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Gc(),i===r){t=Zn(e,t,s);break e}ci(e,t,i,s)}t=t.child}return t;case 5:return tP(t),e===null&&yy(t),i=t.type,r=t.pendingProps,n=e!==null?e.memoizedProps:null,o=r.children,gy(i,r)?o=null:n!==null&&gy(i,n)&&(t.flags|=32),TP(e,t),ci(e,t,o,s),t.child;case 6:return e===null&&yy(t),null;case 13:return PP(e,t,s);case 4:return bS(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Vc(t,null,i,s):ci(e,t,i,s),t.child;case 11:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Br(i,r),YE(e,t,i,r,s);case 7:return ci(e,t,t.pendingProps,s),t.child;case 8:return ci(e,t,t.pendingProps.children,s),t.child;case 12:return ci(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,n=t.memoizedProps,o=r.value,Qt(nf,i._currentValue),i._currentValue=o,n!==null)if(sn(n.value,o)){if(n.children===r.children&&!Vi.current){t=Zn(e,t,s);break e}}else for(n=t.child,n!==null&&(n.return=t);n!==null;){var a=n.dependencies;if(a!==null){o=n.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(n.tag===1){l=$n(-1,s&-s),l.tag=2;var u=n.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}n.lanes|=s,l=n.alternate,l!==null&&(l.lanes|=s),wy(n.return,s,t),a.lanes|=s;break}l=l.next}}else if(n.tag===10)o=n.type===t.type?null:n.child;else if(n.tag===18){if(o=n.return,o===null)throw Error(Oe(341));o.lanes|=s,a=o.alternate,a!==null&&(a.lanes|=s),wy(o,s,t),o=n.sibling}else o=n.child;if(o!==null)o.return=n;else for(o=n;o!==null;){if(o===t){o=null;break}if(n=o.sibling,n!==null){n.return=o.return,o=n;break}o=o.return}n=o}ci(e,t,r.children,s),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Sc(t,s),r=Tr(r),i=i(r),t.flags|=1,ci(e,t,i,s),t.child;case 14:return i=t.type,r=Br(i,t.pendingProps),r=Br(i.type,r),qE(e,t,i,r,s);case 15:return bP(e,t,t.type,t.pendingProps,s);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:Br(i,r),Sg(e,t),t.tag=1,Bi(i)?(e=!0,tf(t)):e=!1,Sc(t,s),SP(t,i,r),xy(t,i,r,s),Ry(null,t,i,!0,e,s);case 19:return AP(e,t,s);case 22:return RP(e,t,s)}throw Error(Oe(156,t.tag))};function UP(e,t){return CD(e,t)}function _L(e,t,s,i){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(e,t,s,i){return new _L(e,t,s,i)}function VS(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kL(e){if(typeof e=="function")return VS(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rS)return 11;if(e===nS)return 14}return 2}function $o(e,t){var s=e.alternate;return s===null?(s=wr(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function bg(e,t,s,i,r,n){var o=2;if(i=e,typeof e=="function")VS(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ic:return sl(s.children,r,n,t);case iS:o=8,r|=8;break;case $C:return e=wr(12,s,t,r|2),e.elementType=$C,e.lanes=n,e;case KC:return e=wr(13,s,t,r),e.elementType=KC,e.lanes=n,e;case YC:return e=wr(19,s,t,r),e.elementType=YC,e.lanes=n,e;case tD:return xm(s,r,n,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case XT:o=10;break e;case eD:o=9;break e;case rS:o=11;break e;case nS:o=14;break e;case bo:o=16,i=null;break e}throw Error(Oe(130,e==null?e:typeof e,""))}return t=wr(o,s,t,r),t.elementType=e,t.type=i,t.lanes=n,t}function sl(e,t,s,i){return e=wr(7,e,i,t),e.lanes=s,e}function xm(e,t,s,i){return e=wr(22,e,i,t),e.elementType=tD,e.lanes=s,e.stateNode={isHidden:!1},e}function tC(e,t,s){return e=wr(6,e,null,t),e.lanes=s,e}function sC(e,t,s){return t=wr(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ML(e,t,s,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lv(0),this.expirationTimes=Lv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lv(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function BS(e,t,s,i,r,n,o,a,l){return e=new ML(e,t,s,a,l),t===1?(t=1,n===!0&&(t|=8)):t=0,n=wr(3,null,null,t),e.current=n,n.stateNode=e,n.memoizedState={element:i,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},ES(n),e}function LL(e,t,s){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sc,key:i==null?null:""+i,children:e,containerInfo:t,implementation:s}}function $P(e){if(!e)return Xo;e=e._reactInternals;e:{if(Fl(e)!==e||e.tag!==1)throw Error(Oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Bi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Oe(171))}if(e.tag===1){var s=e.type;if(Bi(s))return $D(e,s,t)}return t}function KP(e,t,s,i,r,n,o,a,l){return e=BS(s,i,!0,e,r,n,o,a,l),e.context=$P(null),s=e.current,i=gi(),r=Uo(s),n=$n(i,r),n.callback=t??null,Wo(s,n,r),e.current.lanes=r,ip(e,r,i),Hi(e,i),e}function Em(e,t,s,i){var r=t.current,n=gi(),o=Uo(r);return s=$P(s),t.context===null?t.context=s:t.pendingContext=s,t=$n(n,o),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=Wo(r,t,o),e!==null&&(Xr(e,r,o,n),Cg(e,r,o)),o}function ff(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ab(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function HS(e,t){ab(e,t),(e=e.alternate)&&ab(e,t)}function OL(){return null}var YP=typeof reportError=="function"?reportError:function(e){console.error(e)};function jS(e){this._internalRoot=e}bm.prototype.render=jS.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Oe(409));Em(e,t,null,null)};bm.prototype.unmount=jS.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fl(function(){Em(null,e,null,null)}),t[qn]=null}};function bm(e){this._internalRoot=e}bm.prototype.unstable_scheduleHydration=function(e){if(e){var t=RD();e={blockedOn:null,target:e,priority:t};for(var s=0;s<To.length&&t!==0&&t<To[s].priority;s++);To.splice(s,0,e),s===0&&DD(e)}};function WS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function lb(){}function GL(e,t,s,i,r){if(r){if(typeof i=="function"){var n=i;i=function(){var u=ff(o);n.call(u)}}var o=KP(t,i,e,0,null,!1,!1,"",lb);return e._reactRootContainer=o,e[qn]=o.current,$d(e.nodeType===8?e.parentNode:e),fl(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=ff(l);a.call(u)}}var l=BS(e,0,!1,null,null,!1,!1,"",lb);return e._reactRootContainer=l,e[qn]=l.current,$d(e.nodeType===8?e.parentNode:e),fl(function(){Em(t,l,s,i)}),l}function Tm(e,t,s,i,r){var n=s._reactRootContainer;if(n){var o=n;if(typeof r=="function"){var a=r;r=function(){var l=ff(o);a.call(l)}}Em(t,o,e,r)}else o=GL(s,t,e,r,i);return ff(o)}ED=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ad(t.pendingLanes);s!==0&&(lS(t,s|1),Hi(t,Cs()),!(kt&6)&&(jc=Cs()+500,ua()))}break;case 13:fl(function(){var i=Qn(e,1);if(i!==null){var r=gi();Xr(i,e,1,r)}}),HS(e,1)}};cS=function(e){if(e.tag===13){var t=Qn(e,134217728);if(t!==null){var s=gi();Xr(t,e,134217728,s)}HS(e,134217728)}};bD=function(e){if(e.tag===13){var t=Uo(e),s=Qn(e,t);if(s!==null){var i=gi();Xr(s,e,t,i)}HS(e,t)}};RD=function(){return Ht};TD=function(e,t){var s=Ht;try{return Ht=e,t()}finally{Ht=s}};ry=function(e,t,s){switch(t){case"input":if(ZC(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var i=s[t];if(i!==e&&i.form===e.form){var r=mm(i);if(!r)throw Error(Oe(90));iD(i),ZC(i,r)}}}break;case"textarea":nD(e,s);break;case"select":t=s.value,t!=null&&vc(e,!!s.multiple,t,!1)}};hD=LS;pD=fl;var VL={usingClientEntryPoint:!1,Events:[np,ac,mm,uD,dD,LS]},Xu={findFiberByHostInstance:ja,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BL={bundleType:Xu.bundleType,version:Xu.version,rendererPackageName:Xu.rendererPackageName,rendererConfig:Xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:no.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=mD(e),e===null?null:e.stateNode},findFiberByHostInstance:Xu.findFiberByHostInstance||OL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tg.isDisabled&&tg.supportsFiber)try{hm=tg.inject(BL),En=tg}catch{}}lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=VL;lr.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!WS(t))throw Error(Oe(200));return LL(e,t,null,s)};lr.createRoot=function(e,t){if(!WS(e))throw Error(Oe(299));var s=!1,i="",r=YP;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=BS(e,1,!1,null,null,s,!1,i,r),e[qn]=t.current,$d(e.nodeType===8?e.parentNode:e),new jS(t)};lr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Oe(188)):(e=Object.keys(e).join(","),Error(Oe(268,e)));return e=mD(t),e=e===null?null:e.stateNode,e};lr.flushSync=function(e){return fl(e)};lr.hydrate=function(e,t,s){if(!Rm(t))throw Error(Oe(200));return Tm(null,e,t,!0,s)};lr.hydrateRoot=function(e,t,s){if(!WS(e))throw Error(Oe(405));var i=s!=null&&s.hydratedSources||null,r=!1,n="",o=YP;if(s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(n=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),t=KP(t,null,e,1,s??null,r,!1,n,o),e[qn]=t.current,$d(e),i)for(e=0;e<i.length;e++)s=i[e],r=s._getVersion,r=r(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,r]:t.mutableSourceEagerHydrationData.push(s,r);return new bm(t)};lr.render=function(e,t,s){if(!Rm(t))throw Error(Oe(200));return Tm(null,e,t,!1,s)};lr.unmountComponentAtNode=function(e){if(!Rm(e))throw Error(Oe(40));return e._reactRootContainer?(fl(function(){Tm(null,null,e,!1,function(){e._reactRootContainer=null,e[qn]=null})}),!0):!1};lr.unstable_batchedUpdates=LS;lr.unstable_renderSubtreeIntoContainer=function(e,t,s,i){if(!Rm(s))throw Error(Oe(200));if(e==null||e._reactInternals===void 0)throw Error(Oe(38));return Tm(e,t,s,!1,i)};lr.version="18.3.1-next-f1338f8080-20240426";function qP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qP)}catch(e){console.error(e)}}qP(),qT.exports=lr;var Dm=qT.exports;const Oy=um(Dm);var cb=Dm;zC.createRoot=cb.createRoot,zC.hydrateRoot=cb.hydrateRoot;var Pm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},HL={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Ao,qw,AT,jL=(AT=class{constructor(){Pt(this,Ao,HL);Pt(this,qw,!1)}setTimeoutProvider(e){dt(this,Ao,e)}setTimeout(e,t){return we(this,Ao).setTimeout(e,t)}clearTimeout(e){we(this,Ao).clearTimeout(e)}setInterval(e,t){return we(this,Ao).setInterval(e,t)}clearInterval(e){we(this,Ao).clearInterval(e)}},Ao=new WeakMap,qw=new WeakMap,AT),Gy=new jL;function WL(e){setTimeout(e,0)}var Am=typeof window>"u"||"Deno"in globalThis;function Hr(){}function zL(e,t){return typeof e=="function"?e(t):e}function UL(e){return typeof e=="number"&&e>=0&&e!==1/0}function $L(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Vy(e,t){return typeof e=="function"?e(t):e}function KL(e,t){return typeof e=="function"?e(t):e}function ub(e,t){const{type:s="all",exact:i,fetchStatus:r,predicate:n,queryKey:o,stale:a}=e;if(o){if(i){if(t.queryHash!==zS(o,t.options))return!1}else if(!sh(t.queryKey,o))return!1}if(s!=="all"){const l=t.isActive();if(s==="active"&&!l||s==="inactive"&&l)return!1}return!(typeof a=="boolean"&&t.isStale()!==a||r&&r!==t.state.fetchStatus||n&&!n(t))}function db(e,t){const{exact:s,status:i,predicate:r,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(s){if(th(t.options.mutationKey)!==th(n))return!1}else if(!sh(t.options.mutationKey,n))return!1}return!(i&&t.state.status!==i||r&&!r(t))}function zS(e,t){return((t==null?void 0:t.queryKeyHashFn)||th)(e)}function th(e){return JSON.stringify(e,(t,s)=>By(s)?Object.keys(s).sort().reduce((i,r)=>(i[r]=s[r],i),{}):s)}function sh(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(s=>sh(e[s],t[s])):!1}var YL=Object.prototype.hasOwnProperty;function QP(e,t,s=0){if(e===t)return e;if(s>500)return t;const i=hb(e)&&hb(t);if(!i&&!(By(e)&&By(t)))return t;const n=(i?e:Object.keys(e)).length,o=i?t:Object.keys(t),a=o.length,l=i?new Array(a):{};let u=0;for(let h=0;h<a;h++){const p=i?h:o[h],g=e[p],m=t[p];if(g===m){l[p]=g,(i?h<n:YL.call(e,p))&&u++;continue}if(g===null||m===null||typeof g!="object"||typeof m!="object"){l[p]=m;continue}const C=QP(g,m,s+1);l[p]=C,C===g&&u++}return n===a&&u===n?e:l}function hb(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function By(e){if(!pb(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!pb(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function pb(e){return Object.prototype.toString.call(e)==="[object Object]"}function qL(e){return new Promise(t=>{Gy.setTimeout(t,e)})}function QL(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?QP(e,t):t}function ZL(e,t,s=0){const i=[...e,t];return s&&i.length>s?i.slice(1):i}function JL(e,t,s=0){const i=[t,...e];return s&&i.length>s?i.slice(0,-1):i}var US=Symbol();function ZP(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===US?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function XL(e,t,s){let i=!1,r;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(r??(r=t()),i||(i=!0,r.aborted?s():r.addEventListener("abort",s,{once:!0})),r)}),e}var qa,Fo,Pc,FT,e1=(FT=class extends Pm{constructor(){super();Pt(this,qa);Pt(this,Fo);Pt(this,Pc);dt(this,Pc,t=>{if(!Am&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){we(this,Fo)||this.setEventListener(we(this,Pc))}onUnsubscribe(){var t;this.hasListeners()||((t=we(this,Fo))==null||t.call(this),dt(this,Fo,void 0))}setEventListener(t){var s;dt(this,Pc,t),(s=we(this,Fo))==null||s.call(this),dt(this,Fo,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){we(this,qa)!==t&&(dt(this,qa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof we(this,qa)=="boolean"?we(this,qa):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},qa=new WeakMap,Fo=new WeakMap,Pc=new WeakMap,FT),JP=new e1;function t1(){let e,t;const s=new Promise((r,n)=>{e=r,t=n});s.status="pending",s.catch(()=>{});function i(r){Object.assign(s,r),delete s.resolve,delete s.reject}return s.resolve=r=>{i({status:"fulfilled",value:r}),e(r)},s.reject=r=>{i({status:"rejected",reason:r}),t(r)},s}var s1=WL;function i1(){let e=[],t=0,s=a=>{a()},i=a=>{a()},r=s1;const n=a=>{t?e.push(a):r(()=>{s(a)})},o=()=>{const a=e;e=[],a.length&&r(()=>{i(()=>{a.forEach(l=>{s(l)})})})};return{batch:a=>{let l;t++;try{l=a()}finally{t--,t||o()}return l},batchCalls:a=>(...l)=>{n(()=>{a(...l)})},schedule:n,setNotifyFunction:a=>{s=a},setBatchNotifyFunction:a=>{i=a},setScheduler:a=>{r=a}}}var di=i1(),Ac,Io,Fc,IT,r1=(IT=class extends Pm{constructor(){super();Pt(this,Ac,!0);Pt(this,Io);Pt(this,Fc);dt(this,Fc,t=>{if(!Am&&window.addEventListener){const s=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",i)}}})}onSubscribe(){we(this,Io)||this.setEventListener(we(this,Fc))}onUnsubscribe(){var t;this.hasListeners()||((t=we(this,Io))==null||t.call(this),dt(this,Io,void 0))}setEventListener(t){var s;dt(this,Fc,t),(s=we(this,Io))==null||s.call(this),dt(this,Io,t(this.setOnline.bind(this)))}setOnline(t){we(this,Ac)!==t&&(dt(this,Ac,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return we(this,Ac)}},Ac=new WeakMap,Io=new WeakMap,Fc=new WeakMap,IT),mf=new r1;function n1(e){return Math.min(1e3*2**e,3e4)}function XP(e){return(e??"online")==="online"?mf.isOnline():!0}var Hy=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function eA(e){let t=!1,s=0,i;const r=t1(),n=()=>r.status!=="pending",o=y=>{var R;if(!n()){const x=new Hy(y);g(x),(R=e.onCancel)==null||R.call(e,x)}},a=()=>{t=!0},l=()=>{t=!1},u=()=>JP.isFocused()&&(e.networkMode==="always"||mf.isOnline())&&e.canRun(),h=()=>XP(e.networkMode)&&e.canRun(),p=y=>{n()||(i==null||i(),r.resolve(y))},g=y=>{n()||(i==null||i(),r.reject(y))},m=()=>new Promise(y=>{var R;i=x=>{(n()||u())&&y(x)},(R=e.onPause)==null||R.call(e)}).then(()=>{var y;i=void 0,n()||(y=e.onContinue)==null||y.call(e)}),C=()=>{if(n())return;let y;const R=s===0?e.initialPromise:void 0;try{y=R??e.fn()}catch(x){y=Promise.reject(x)}Promise.resolve(y).then(p).catch(x=>{var H;if(n())return;const S=e.retry??(Am?0:3),T=e.retryDelay??n1,I=typeof T=="function"?T(s,x):T,V=S===!0||typeof S=="number"&&s<S||typeof S=="function"&&S(s,x);if(t||!V){g(x);return}s++,(H=e.onFail)==null||H.call(e,s,x),qL(I).then(()=>u()?void 0:m()).then(()=>{t?g(x):C()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(i==null||i(),r),cancelRetry:a,continueRetry:l,canStart:h,start:()=>(h()?C():m().then(C),r)}}var Qa,NT,tA=(NT=class{constructor(){Pt(this,Qa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),UL(this.gcTime)&&dt(this,Qa,Gy.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Am?1/0:5*60*1e3))}clearGcTimeout(){we(this,Qa)&&(Gy.clearTimeout(we(this,Qa)),dt(this,Qa,void 0))}},Qa=new WeakMap,NT),Za,Ic,mr,Ja,Ns,Xh,Xa,jr,On,_T,o1=(_T=class extends tA{constructor(t){super();Pt(this,jr);Pt(this,Za);Pt(this,Ic);Pt(this,mr);Pt(this,Ja);Pt(this,Ns);Pt(this,Xh);Pt(this,Xa);dt(this,Xa,!1),dt(this,Xh,t.defaultOptions),this.setOptions(t.options),this.observers=[],dt(this,Ja,t.client),dt(this,mr,we(this,Ja).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,dt(this,Za,fb(this.options)),this.state=t.state??we(this,Za),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=we(this,Ns))==null?void 0:t.promise}setOptions(t){if(this.options={...we(this,Xh),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=fb(this.options);s.data!==void 0&&(this.setState(gb(s.data,s.dataUpdatedAt)),dt(this,Za,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&we(this,mr).remove(this)}setData(t,s){const i=QL(this.state.data,t,this.options);return Qs(this,jr,On).call(this,{data:i,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),i}setState(t,s){Qs(this,jr,On).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){var i,r;const s=(i=we(this,Ns))==null?void 0:i.promise;return(r=we(this,Ns))==null||r.cancel(t),s?s.then(Hr).catch(Hr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(we(this,Za))}isActive(){return this.observers.some(t=>KL(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===US||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Vy(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!$L(this.state.dataUpdatedAt,t)}onFocus(){var s;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(s=we(this,Ns))==null||s.continue()}onOnline(){var s;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(s=we(this,Ns))==null||s.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),we(this,mr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(we(this,Ns)&&(we(this,Xa)?we(this,Ns).cancel({revert:!0}):we(this,Ns).cancelRetry()),this.scheduleGc()),we(this,mr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Qs(this,jr,On).call(this,{type:"invalidate"})}async fetch(t,s){var l,u,h,p,g,m,C,y,R,x,S,T;if(this.state.fetchStatus!=="idle"&&((l=we(this,Ns))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(we(this,Ns))return we(this,Ns).continueRetry(),we(this,Ns).promise}if(t&&this.setOptions(t),!this.options.queryFn){const I=this.observers.find(V=>V.options.queryFn);I&&this.setOptions(I.options)}const i=new AbortController,r=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(dt(this,Xa,!0),i.signal)})},n=()=>{const I=ZP(this.options,s),H=(()=>{const P={client:we(this,Ja),queryKey:this.queryKey,meta:this.meta};return r(P),P})();return dt(this,Xa,!1),this.options.persister?this.options.persister(I,H,this):I(H)},a=(()=>{const I={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:we(this,Ja),state:this.state,fetchFn:n};return r(I),I})();(u=this.options.behavior)==null||u.onFetch(a,this),dt(this,Ic,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=a.fetchOptions)==null?void 0:h.meta))&&Qs(this,jr,On).call(this,{type:"fetch",meta:(p=a.fetchOptions)==null?void 0:p.meta}),dt(this,Ns,eA({initialPromise:s==null?void 0:s.initialPromise,fn:a.fetchFn,onCancel:I=>{I instanceof Hy&&I.revert&&this.setState({...we(this,Ic),fetchStatus:"idle"}),i.abort()},onFail:(I,V)=>{Qs(this,jr,On).call(this,{type:"failed",failureCount:I,error:V})},onPause:()=>{Qs(this,jr,On).call(this,{type:"pause"})},onContinue:()=>{Qs(this,jr,On).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const I=await we(this,Ns).start();if(I===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(I),(m=(g=we(this,mr).config).onSuccess)==null||m.call(g,I,this),(y=(C=we(this,mr).config).onSettled)==null||y.call(C,I,this.state.error,this),I}catch(I){if(I instanceof Hy){if(I.silent)return we(this,Ns).promise;if(I.revert){if(this.state.data===void 0)throw I;return this.state.data}}throw Qs(this,jr,On).call(this,{type:"error",error:I}),(x=(R=we(this,mr).config).onError)==null||x.call(R,I,this),(T=(S=we(this,mr).config).onSettled)==null||T.call(S,this.state.data,I,this),I}finally{this.scheduleGc()}}},Za=new WeakMap,Ic=new WeakMap,mr=new WeakMap,Ja=new WeakMap,Ns=new WeakMap,Xh=new WeakMap,Xa=new WeakMap,jr=new WeakSet,On=function(t){const s=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...a1(i.data,this.options),fetchMeta:t.meta??null};case"success":const r={...i,...gb(t.data,t.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return dt(this,Ic,t.manual?r:void 0),r;case"error":const n=t.error;return{...i,error:n,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=s(this.state),di.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),we(this,mr).notify({query:this,type:"updated",action:t})})},_T);function a1(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:XP(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function gb(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function fb(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=t!==void 0,i=s?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}function mb(e){return{onFetch:(t,s)=>{var h,p,g,m,C;const i=t.options,r=(g=(p=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:p.fetchMore)==null?void 0:g.direction,n=((m=t.state.data)==null?void 0:m.pages)||[],o=((C=t.state.data)==null?void 0:C.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const u=async()=>{let y=!1;const R=T=>{XL(T,()=>t.signal,()=>y=!0)},x=ZP(t.options,t.fetchOptions),S=async(T,I,V)=>{if(y)return Promise.reject();if(I==null&&T.pages.length)return Promise.resolve(T);const P=(()=>{const M={client:t.client,queryKey:t.queryKey,pageParam:I,direction:V?"backward":"forward",meta:t.options.meta};return R(M),M})(),N=await x(P),{maxPages:_}=t.options,L=V?JL:ZL;return{pages:L(T.pages,N,_),pageParams:L(T.pageParams,I,_)}};if(r&&n.length){const T=r==="backward",I=T?l1:vb,V={pages:n,pageParams:o},H=I(i,V);a=await S(V,H,T)}else{const T=e??n.length;do{const I=l===0?o[0]??i.initialPageParam:vb(i,a);if(l>0&&I==null)break;a=await S(a,I),l++}while(l<T)}return a};t.options.persister?t.fetchFn=()=>{var y,R;return(R=(y=t.options).persister)==null?void 0:R.call(y,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=u}}}function vb(e,{pages:t,pageParams:s}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,s[i],s):void 0}function l1(e,{pages:t,pageParams:s}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,s[0],s):void 0}var ep,mn,li,el,vn,wo,kT,c1=(kT=class extends tA{constructor(t){super();Pt(this,vn);Pt(this,ep);Pt(this,mn);Pt(this,li);Pt(this,el);dt(this,ep,t.client),this.mutationId=t.mutationId,dt(this,li,t.mutationCache),dt(this,mn,[]),this.state=t.state||u1(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){we(this,mn).includes(t)||(we(this,mn).push(t),this.clearGcTimeout(),we(this,li).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){dt(this,mn,we(this,mn).filter(s=>s!==t)),this.scheduleGc(),we(this,li).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){we(this,mn).length||(this.state.status==="pending"?this.scheduleGc():we(this,li).remove(this))}continue(){var t;return((t=we(this,el))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,a,l,u,h,p,g,m,C,y,R,x,S,T,I,V,H,P,N,_;const s=()=>{Qs(this,vn,wo).call(this,{type:"continue"})},i={client:we(this,ep),meta:this.options.meta,mutationKey:this.options.mutationKey};dt(this,el,eA({fn:()=>this.options.mutationFn?this.options.mutationFn(t,i):Promise.reject(new Error("No mutationFn found")),onFail:(L,M)=>{Qs(this,vn,wo).call(this,{type:"failed",failureCount:L,error:M})},onPause:()=>{Qs(this,vn,wo).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>we(this,li).canRun(this)}));const r=this.state.status==="pending",n=!we(this,el).canStart();try{if(r)s();else{Qs(this,vn,wo).call(this,{type:"pending",variables:t,isPaused:n}),await((a=(o=we(this,li).config).onMutate)==null?void 0:a.call(o,t,this,i));const M=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,t,i));M!==this.state.context&&Qs(this,vn,wo).call(this,{type:"pending",context:M,variables:t,isPaused:n})}const L=await we(this,el).start();return await((p=(h=we(this,li).config).onSuccess)==null?void 0:p.call(h,L,t,this.state.context,this,i)),await((m=(g=this.options).onSuccess)==null?void 0:m.call(g,L,t,this.state.context,i)),await((y=(C=we(this,li).config).onSettled)==null?void 0:y.call(C,L,null,this.state.variables,this.state.context,this,i)),await((x=(R=this.options).onSettled)==null?void 0:x.call(R,L,null,t,this.state.context,i)),Qs(this,vn,wo).call(this,{type:"success",data:L}),L}catch(L){try{await((T=(S=we(this,li).config).onError)==null?void 0:T.call(S,L,t,this.state.context,this,i))}catch(M){Promise.reject(M)}try{await((V=(I=this.options).onError)==null?void 0:V.call(I,L,t,this.state.context,i))}catch(M){Promise.reject(M)}try{await((P=(H=we(this,li).config).onSettled)==null?void 0:P.call(H,void 0,L,this.state.variables,this.state.context,this,i))}catch(M){Promise.reject(M)}try{await((_=(N=this.options).onSettled)==null?void 0:_.call(N,void 0,L,t,this.state.context,i))}catch(M){Promise.reject(M)}throw Qs(this,vn,wo).call(this,{type:"error",error:L}),L}finally{we(this,li).runNext(this)}}},ep=new WeakMap,mn=new WeakMap,li=new WeakMap,el=new WeakMap,vn=new WeakSet,wo=function(t){const s=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),di.batch(()=>{we(this,mn).forEach(i=>{i.onMutationUpdate(t)}),we(this,li).notify({mutation:this,type:"updated",action:t})})},kT);function u1(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Wn,Wr,tp,MT,d1=(MT=class extends Pm{constructor(t={}){super();Pt(this,Wn);Pt(this,Wr);Pt(this,tp);this.config=t,dt(this,Wn,new Set),dt(this,Wr,new Map),dt(this,tp,0)}build(t,s,i){const r=new c1({client:t,mutationCache:this,mutationId:++Gp(this,tp)._,options:t.defaultMutationOptions(s),state:i});return this.add(r),r}add(t){we(this,Wn).add(t);const s=sg(t);if(typeof s=="string"){const i=we(this,Wr).get(s);i?i.push(t):we(this,Wr).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(we(this,Wn).delete(t)){const s=sg(t);if(typeof s=="string"){const i=we(this,Wr).get(s);if(i)if(i.length>1){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}else i[0]===t&&we(this,Wr).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=sg(t);if(typeof s=="string"){const i=we(this,Wr).get(s),r=i==null?void 0:i.find(n=>n.state.status==="pending");return!r||r===t}else return!0}runNext(t){var i;const s=sg(t);if(typeof s=="string"){const r=(i=we(this,Wr).get(s))==null?void 0:i.find(n=>n!==t&&n.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){di.batch(()=>{we(this,Wn).forEach(t=>{this.notify({type:"removed",mutation:t})}),we(this,Wn).clear(),we(this,Wr).clear()})}getAll(){return Array.from(we(this,Wn))}find(t){const s={exact:!0,...t};return this.getAll().find(i=>db(s,i))}findAll(t={}){return this.getAll().filter(s=>db(t,s))}notify(t){di.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return di.batch(()=>Promise.all(t.map(s=>s.continue().catch(Hr))))}},Wn=new WeakMap,Wr=new WeakMap,tp=new WeakMap,MT);function sg(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Cn,LT,h1=(LT=class extends Pm{constructor(t={}){super();Pt(this,Cn);this.config=t,dt(this,Cn,new Map)}build(t,s,i){const r=s.queryKey,n=s.queryHash??zS(r,s);let o=this.get(n);return o||(o=new o1({client:t,queryKey:r,queryHash:n,options:t.defaultQueryOptions(s),state:i,defaultOptions:t.getQueryDefaults(r)}),this.add(o)),o}add(t){we(this,Cn).has(t.queryHash)||(we(this,Cn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=we(this,Cn).get(t.queryHash);s&&(t.destroy(),s===t&&we(this,Cn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){di.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return we(this,Cn).get(t)}getAll(){return[...we(this,Cn).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(i=>ub(s,i))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(i=>ub(t,i)):s}notify(t){di.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){di.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){di.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Cn=new WeakMap,LT),ps,No,_o,Nc,_c,ko,kc,Mc,OT,p1=(OT=class{constructor(e={}){Pt(this,ps);Pt(this,No);Pt(this,_o);Pt(this,Nc);Pt(this,_c);Pt(this,ko);Pt(this,kc);Pt(this,Mc);dt(this,ps,e.queryCache||new h1),dt(this,No,e.mutationCache||new d1),dt(this,_o,e.defaultOptions||{}),dt(this,Nc,new Map),dt(this,_c,new Map),dt(this,ko,0)}mount(){Gp(this,ko)._++,we(this,ko)===1&&(dt(this,kc,JP.subscribe(async e=>{e&&(await this.resumePausedMutations(),we(this,ps).onFocus())})),dt(this,Mc,mf.subscribe(async e=>{e&&(await this.resumePausedMutations(),we(this,ps).onOnline())})))}unmount(){var e,t;Gp(this,ko)._--,we(this,ko)===0&&((e=we(this,kc))==null||e.call(this),dt(this,kc,void 0),(t=we(this,Mc))==null||t.call(this),dt(this,Mc,void 0))}isFetching(e){return we(this,ps).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return we(this,No).findAll({...e,status:"pending"}).length}getQueryData(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=we(this,ps).get(t.queryHash))==null?void 0:s.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=we(this,ps).build(this,t),i=s.state.data;return i===void 0?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(Vy(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return we(this,ps).findAll(e).map(({queryKey:t,state:s})=>{const i=s.data;return[t,i]})}setQueryData(e,t,s){const i=this.defaultQueryOptions({queryKey:e}),r=we(this,ps).get(i.queryHash),n=r==null?void 0:r.state.data,o=zL(t,n);if(o!==void 0)return we(this,ps).build(this,i).setData(o,{...s,manual:!0})}setQueriesData(e,t,s){return di.batch(()=>we(this,ps).findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,t,s)]))}getQueryState(e){var s;const t=this.defaultQueryOptions({queryKey:e});return(s=we(this,ps).get(t.queryHash))==null?void 0:s.state}removeQueries(e){const t=we(this,ps);di.batch(()=>{t.findAll(e).forEach(s=>{t.remove(s)})})}resetQueries(e,t){const s=we(this,ps);return di.batch(()=>(s.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},i=di.batch(()=>we(this,ps).findAll(e).map(r=>r.cancel(s)));return Promise.all(i).then(Hr).catch(Hr)}invalidateQueries(e,t={}){return di.batch(()=>(we(this,ps).findAll(e).forEach(s=>{s.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},i=di.batch(()=>we(this,ps).findAll(e).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let n=r.fetch(void 0,s);return s.throwOnError||(n=n.catch(Hr)),r.state.fetchStatus==="paused"?Promise.resolve():n}));return Promise.all(i).then(Hr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const s=we(this,ps).build(this,t);return s.isStaleByTime(Vy(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Hr).catch(Hr)}fetchInfiniteQuery(e){return e.behavior=mb(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Hr).catch(Hr)}ensureInfiniteQueryData(e){return e.behavior=mb(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return mf.isOnline()?we(this,No).resumePausedMutations():Promise.resolve()}getQueryCache(){return we(this,ps)}getMutationCache(){return we(this,No)}getDefaultOptions(){return we(this,_o)}setDefaultOptions(e){dt(this,_o,e)}setQueryDefaults(e,t){we(this,Nc).set(th(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...we(this,Nc).values()],s={};return t.forEach(i=>{sh(e,i.queryKey)&&Object.assign(s,i.defaultOptions)}),s}setMutationDefaults(e,t){we(this,_c).set(th(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...we(this,_c).values()],s={};return t.forEach(i=>{sh(e,i.mutationKey)&&Object.assign(s,i.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...we(this,_o).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=zS(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===US&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...we(this,_o).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){we(this,ps).clear(),we(this,No).clear()}},ps=new WeakMap,No=new WeakMap,_o=new WeakMap,Nc=new WeakMap,_c=new WeakMap,ko=new WeakMap,kc=new WeakMap,Mc=new WeakMap,OT),g1=E.createContext(void 0),f1=({client:e,children:t})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(g1.Provider,{value:e,children:t})),$S=Object.defineProperty,m1=Object.defineProperties,v1=Object.getOwnPropertyDescriptor,C1=Object.getOwnPropertyDescriptors,vf=Object.getOwnPropertySymbols,sA=Object.prototype.hasOwnProperty,iA=Object.prototype.propertyIsEnumerable,Cb=(e,t,s)=>t in e?$S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Je=(e,t)=>{for(var s in t||(t={}))sA.call(t,s)&&Cb(e,s,t[s]);if(vf)for(var s of vf(t))iA.call(t,s)&&Cb(e,s,t[s]);return e},Jt=(e,t)=>m1(e,C1(t)),y1=(e,t)=>{var s={};for(var i in e)sA.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(e!=null&&vf)for(var i of vf(e))t.indexOf(i)<0&&iA.call(e,i)&&(s[i]=e[i]);return s},Os=(e,t)=>{for(var s in t)$S(e,s,{get:t[s],enumerable:!0})},f=(e,t,s,i)=>{for(var r=i>1?void 0:i?v1(t,s):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(i?o(t,s,r):o(r))||r);return i&&r&&$S(t,s,r),r},Yr=(e,t)=>(s,i)=>t(s,i,e),rA={};Os(rA,{attrToBoolean:()=>Cf,attrToNumber:()=>Ko,attrToString:()=>w1,defaultComparator:()=>S1,exists:()=>Ce,jsonEquals:()=>jy,makeNull:()=>Rn,missing:()=>nt,missingOrEmpty:()=>yr,toStringOrNull:()=>ih,values:()=>il});function Rn(e){return e==null||e===""?null:e}function Ce(e,t=!1){return e!=null&&(e!==""||t)}function nt(e){return!Ce(e)}function yr(e){return e==null||e.length===0}function ih(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function Ko(e){if(e===void 0)return;if(e===null||e==="")return null;if(typeof e=="number")return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function Cf(e){if(e!==void 0)return e===null||e===""?!1:typeof e=="boolean"?e:/true/i.test(e)}function w1(e){if(!(e==null||e===""))return e}function jy(e,t){const s=e?JSON.stringify(e):null,i=t?JSON.stringify(t):null;return s===i}function S1(e,t,s=!1){const i=e==null,r=t==null;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),i&&r)return 0;if(i)return-1;if(r)return 1;function n(o,a){return o>a?1:o<a?-1:0}if(typeof e!="string"||!s)return n(e,t);try{return e.localeCompare(t)}catch{return n(e,t)}}function il(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach(s=>t.push(s)),t}return Object.values(e)}var x1=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=ih(e);let s=0;for(;;){let i;if(e?(i=e,s!==0&&(i+="_"+s)):t?(i=t,s!==0&&(i+="_"+s)):i=s,!this.existingKeys[i])return this.existingKeys[i]=!0,String(i);s++}}},nA={};Os(nA,{SKIP_JS_BUILTINS:()=>Fm,cloneObject:()=>KS,deepCloneDefinition:()=>yf,getAllValuesInObject:()=>ea,getValueUsingField:()=>Ec,isNonNullObject:()=>wf,iterateObject:()=>ei,mergeDeep:()=>Mi,removeAllReferences:()=>oA});var Fm=new Set(["__proto__","constructor","prototype"]);function ei(e,t){if(e!=null){if(Array.isArray(e)){for(let s=0;s<e.length;s++)t(s.toString(),e[s]);return}for(const[s,i]of Object.entries(e))t(s,i)}}function KS(e){const t={},s=Object.keys(e);for(let i=0;i<s.length;i++){if(Fm.has(s[i]))continue;const r=s[i],n=e[r];t[r]=n}return t}function yf(e,t){if(!e)return;const s=e,i={};return Object.keys(s).forEach(r=>{if(t&&t.indexOf(r)>=0||Fm.has(r))return;const n=s[r];wf(n)&&n.constructor===Object?i[r]=yf(n):i[r]=n}),i}function ea(e){if(!e)return[];const t=Object;if(typeof t.values=="function")return t.values(e);const s=[];for(const i in e)e.hasOwnProperty(i)&&e.propertyIsEnumerable(i)&&s.push(e[i]);return s}function Mi(e,t,s=!0,i=!1){Ce(t)&&ei(t,(r,n)=>{if(Fm.has(r))return;let o=e[r];o!==n&&(i&&o==null&&n!=null&&typeof n=="object"&&n.constructor===Object&&(o={},e[r]=o),wf(n)&&wf(o)&&!Array.isArray(o)?Mi(o,n,s,i):(s||n!==void 0)&&(e[r]=n))})}function Ec(e,t,s){if(!t||!e)return;if(!s)return e[t];const i=t.split(".");let r=e;for(let n=0;n<i.length;n++){if(r==null)return;r=r[i[n]]}return r}function oA(e,t=[],s){Object.keys(e).forEach(o=>{typeof e[o]=="object"&&!t.includes(o)&&(e[o]=void 0)});const i=Object.getPrototypeOf(e),r={},n=o=>`AG Grid: Grid API function ${o}() cannot be called as the grid has been destroyed.
    It is recommended to remove local references to the grid api. Alternatively, check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
    To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${s}`;Object.getOwnPropertyNames(i).forEach(o=>{if(typeof i[o]=="function"&&!t.includes(o)){const l=()=>{console.warn(n(o))};r[o]={value:l,writable:!0}}}),Object.defineProperties(e,r)}function wf(e){return typeof e=="object"&&e!==null}var aA={};Os(aA,{compose:()=>E1,debounce:()=>pi,doOnce:()=>Wc,errorOnce:()=>Ua,executeAfter:()=>cA,executeInAWhile:()=>lA,executeNextVMTurn:()=>Wy,getFunctionName:()=>Im,isFunction:()=>Nm,noop:()=>b1,throttle:()=>zy,waitUntil:()=>YS,warnOnce:()=>tt});var yb={};function Wc(e,t){yb[t]||(e(),yb[t]=!0)}function tt(e){Wc(()=>console.warn("AG Grid: "+e),e)}function Ua(e){Wc(()=>console.error("AG Grid: "+e),e)}function Im(e){if(e.name)return e.name;const t=/function\s+([^\(]+)/.exec(e.toString());return t&&t.length===2?t[1].trim():null}function Nm(e){return!!(e&&e.constructor&&e.call&&e.apply)}function lA(e){cA(e,400)}var iC=[],rC=!1;function Wy(e){iC.push(e),!rC&&(rC=!0,window.setTimeout(()=>{const t=iC.slice();iC.length=0,rC=!1,t.forEach(s=>s())},0))}function cA(e,t=0){e.length>0&&window.setTimeout(()=>e.forEach(s=>s()),t)}function pi(e,t){let s;return function(...i){const r=this;window.clearTimeout(s),s=window.setTimeout(function(){e.apply(r,i)},t)}}function zy(e,t){let s=0;return function(...i){const r=this,n=new Date().getTime();n-s<t||(s=n,e.apply(r,i))}}function YS(e,t,s=100,i){const r=new Date().getTime();let n=null,o=!1;const a=()=>{const l=new Date().getTime()-r>s;(e()||l)&&(t(),o=!0,n!=null&&(window.clearInterval(n),n=null),l&&i&&console.warn(i))};a(),o||(n=window.setInterval(a,10))}function E1(...e){return t=>e.reduce((s,i)=>i(s),t)}var b1=()=>{},uA=(e=>(e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue",e))(uA||{}),_m=class Ot{static register(t){Ot.__register(t,!0,void 0)}static registerModules(t){Ot.__registerModules(t,!0,void 0)}static __register(t,s,i){Ot.runVersionChecks(t),i!==void 0?(Ot.areGridScopedModules=!0,Ot.gridModulesMap[i]===void 0&&(Ot.gridModulesMap[i]={}),Ot.gridModulesMap[i][t.moduleName]=t):Ot.globalModulesMap[t.moduleName]=t,Ot.setModuleBased(s)}static __unRegisterGridModules(t){delete Ot.gridModulesMap[t]}static __registerModules(t,s,i){Ot.setModuleBased(s),t&&t.forEach(r=>Ot.__register(r,s,i))}static isValidModuleVersion(t){const[s,i]=t.version.split(".")||[],[r,n]=Ot.currentModuleVersion.split(".")||[];return s===r&&i===n}static runVersionChecks(t){if(Ot.currentModuleVersion||(Ot.currentModuleVersion=t.version),t.version?Ot.isValidModuleVersion(t)||console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is version ${t.version} but the other modules are version ${this.currentModuleVersion}. Please update all modules to the same version.`):console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${t.moduleName}' is incompatible. Please update all modules to the same version.`),t.validate){const s=t.validate();s.isValid||console.error(`AG Grid: ${s.message}`)}}static setModuleBased(t){Ot.moduleBased===void 0?Ot.moduleBased=t:Ot.moduleBased!==t&&Wc(()=>{console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information.")},"ModulePackageCheck")}static __setIsBundled(){Ot.isBundled=!0}static __assertRegistered(t,s,i){var r;if(this.__isRegistered(t,i))return!0;const n=s+t;let o;if(Ot.isBundled)o=`AG Grid: unable to use ${s} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:
        
        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>
        
For more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(Ot.moduleBased||Ot.moduleBased===void 0){let a=(r=Object.entries(uA).find(([l,u])=>u===t))==null?void 0:r[0];o=`AG Grid: unable to use ${s} as the ${a} is not registered${Ot.areGridScopedModules?` for gridId: ${i}`:""}. Check if you have registered the module:
           
    import { ModuleRegistry } from '@ag-grid-community/core';
    import { ${a} } from '${t}';
    
    ModuleRegistry.registerModules([ ${a} ]);

For more info see: https://www.ag-grid.com/javascript-grid/modules/`}else o=`AG Grid: unable to use ${s} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:
            
    import 'ag-grid-enterprise';`;return Wc(()=>{console.warn(o)},n),!1}static __isRegistered(t,s){var i;return!!Ot.globalModulesMap[t]||!!((i=Ot.gridModulesMap[s])!=null&&i[t])}static __getRegisteredModules(t){return[...il(Ot.globalModulesMap),...il(Ot.gridModulesMap[t]||{})]}static __getGridRegisteredModules(t){var s;return il((s=Ot.gridModulesMap[t])!=null?s:{})||[]}static __isPackageBased(){return!Ot.moduleBased}};_m.globalModulesMap={};_m.gridModulesMap={};_m.areGridScopedModules=!1;var Nt=_m,R1=class{constructor(e,t){if(this.beanWrappers={},this.destroyed=!1,!e||!e.beanClasses)return;this.contextParams=e,this.logger=t,this.logger.log(">> creating ag-Application Context"),this.createBeans();const s=this.getBeanInstances();this.wireBeans(s),this.logger.log(">> ag-Application Context ready - component is alive")}getBeanInstances(){return il(this.beanWrappers).map(e=>e.beanInstance)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.wireBeans([e],t),e}wireBeans(e,t){this.autoWireBeans(e),this.methodWireBeans(e),this.callLifeCycleMethods(e,"preConstructMethods"),Ce(t)&&e.forEach(t),this.callLifeCycleMethods(e,"postConstructMethods")}createBeans(){this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),ei(this.beanWrappers,(t,s)=>{let i;s.bean.__agBeanMetaData&&s.bean.__agBeanMetaData.autowireMethods&&s.bean.__agBeanMetaData.autowireMethods.agConstructor&&(i=s.bean.__agBeanMetaData.autowireMethods.agConstructor);const r=this.getBeansForParameters(i,s.bean.name),n=new(s.bean.bind.apply(s.bean,[null,...r]));s.beanInstance=n});const e=Object.keys(this.beanWrappers).join(", ");this.logger.log(`created beans: ${e}`)}createBeanWrapper(e){const t=e.__agBeanMetaData;if(!t){let i;e.prototype.constructor?i=Im(e.prototype.constructor):i=""+e,console.error(`Context item ${i} is not a bean`);return}const s={bean:e,beanInstance:null,beanName:t.beanName};this.beanWrappers[t.beanName]=s}autoWireBeans(e){e.forEach(t=>{this.forEachMetaDataInHierarchy(t,(s,i)=>{const r=s.agClassAttributes;r&&r.forEach(n=>{const o=this.lookupBeanInstance(i,n.beanName,n.optional);t[n.attributeName]=o})})})}methodWireBeans(e){e.forEach(t=>{this.forEachMetaDataInHierarchy(t,(s,i)=>{ei(s.autowireMethods,(r,n)=>{if(r==="agConstructor")return;const o=this.getBeansForParameters(n,i);t[r].apply(t,o)})})})}forEachMetaDataInHierarchy(e,t){let s=Object.getPrototypeOf(e);for(;s!=null;){const i=s.constructor;if(i.hasOwnProperty("__agBeanMetaData")){const r=i.__agBeanMetaData,n=this.getBeanName(i);t(r,n)}s=Object.getPrototypeOf(s)}}getBeanName(e){if(e.__agBeanMetaData&&e.__agBeanMetaData.beanName)return e.__agBeanMetaData.beanName;const t=e.toString();return t.substring(9,t.indexOf("("))}getBeansForParameters(e,t){const s=[];return e&&ei(e,(i,r)=>{const n=this.lookupBeanInstance(t,r);s[Number(i)]=n}),s}lookupBeanInstance(e,t,s=!1){if(this.destroyed)return this.logger.log(`AG Grid: bean reference ${t} is used after the grid is destroyed!`),null;if(t==="context")return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(t))return this.contextParams.providedBeanInstances[t];const i=this.beanWrappers[t];return i?i.beanInstance:(s||console.error(`AG Grid: unable to find bean reference ${t} while initialising ${e}`),null)}callLifeCycleMethods(e,t){e.forEach(s=>this.callLifeCycleMethodsOnBean(s,t))}callLifeCycleMethodsOnBean(e,t,s){const i={};this.forEachMetaDataInHierarchy(e,n=>{const o=n[t];o&&o.forEach(a=>{a!=s&&(i[a]=!0)})}),Object.keys(i).forEach(n=>e[n]())}getBean(e){return this.lookupBeanInstance("getBean",e,!0)}destroy(){if(this.destroyed)return;this.destroyed=!0,this.logger.log(">> Shutting down ag-Application Context");const e=this.getBeanInstances();this.destroyBeans(e),this.contextParams.providedBeanInstances=null,Nt.__unRegisterGridModules(this.contextParams.gridId),this.logger.log(">> ag-Application Context shut down - component is dead")}destroyBean(e){e&&this.destroyBeans([e])}destroyBeans(e){return e?(e.forEach(t=>{this.callLifeCycleMethodsOnBean(t,"preDestroyMethods","destroy");const s=t;typeof s.destroy=="function"&&s.destroy()}),[]):[]}isDestroyed(){return this.destroyed}getGridId(){return this.contextParams.gridId}};function dA(e,t,s){const i=ml(e.constructor);i.preConstructMethods||(i.preConstructMethods=[]),i.preConstructMethods.push(t)}function Ee(e,t,s){const i=ml(e.constructor);i.postConstructMethods||(i.postConstructMethods=[]),i.postConstructMethods.push(t)}function Si(e,t,s){const i=ml(e.constructor);i.preDestroyMethods||(i.preDestroyMethods=[]),i.preDestroyMethods.push(t)}function je(e){return t=>{const s=ml(t);s.beanName=e}}function A(e){return(t,s,i)=>{hA(t,e,!1,t,s)}}function Lt(e){return(t,s,i)=>{hA(t,e,!0,t,s)}}function hA(e,t,s,i,r,n){if(t===null){console.error("AG Grid: Autowired name should not be null");return}const o=ml(e.constructor);o.agClassAttributes||(o.agClassAttributes=[]),o.agClassAttributes.push({attributeName:r,beanName:t,optional:s})}function Sr(e){return(t,s,i)=>{const r=typeof t=="function"?t:t.constructor;let n;if(typeof i=="number"){let o;s?(n=ml(r),o=s):(n=ml(r),o="agConstructor"),n.autowireMethods||(n.autowireMethods={}),n.autowireMethods[o]||(n.autowireMethods[o]={}),n.autowireMethods[o][i]=e}}}function ml(e){return e.hasOwnProperty("__agBeanMetaData")||(e.__agBeanMetaData={}),e.__agBeanMetaData}var rn=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setBeans(e,t,s=null,i=null){if(this.frameworkOverrides=t,this.gos=e,s){const r=e.useAsyncEvents();this.addGlobalListener(s,r)}i&&this.addGlobalListener(i,!1)}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,s){const i=t?this.allAsyncListeners:this.allSyncListeners;let r=i.get(e);return!r&&s&&(r=new Set,i.set(e,r)),r}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,s=!1){this.getListeners(e,s,!0).add(t)}removeEventListener(e,t,s=!1){const i=this.getListeners(e,s,!1);i&&(i.delete(t),i.size===0&&(s?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e,t=!1){(t?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){let t=e;this.gos&&this.gos.addGridCommonParams(t),this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){var s;const i=e.type;if(t&&"event"in e){const l=e.event;l instanceof Event&&(e.eventPath=l.composedPath())}const r=(l,u)=>l.forEach(h=>{if(!u.has(h))return;const p=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>h(e)):()=>h(e);t?this.dispatchAsync(p):p()}),n=(s=this.getListeners(i,t,!1))!=null?s:new Set,o=new Set(n);o.size>0&&r(o,n),new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(l=>{const u=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>l(i,e)):()=>l(i,e);t?this.dispatchAsync(u):u()})}dispatchAsync(e){this.asyncFunctionsQueue.push(e),this.scheduled||(this.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)}),this.scheduled=!0)}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(t=>t())}};f([Yr(0,Sr("gridOptionsService")),Yr(1,Sr("frameworkOverrides")),Yr(2,Sr("globalEventListener")),Yr(3,Sr("globalSyncEventListener"))],rn.prototype,"setBeans",1);rn=f([je("eventService")],rn);var qS=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=s=>{this.frameworkOverrides.wrapOutgoing(()=>e(s))},this.wrappedListeners.set(e,t)),t}wrapGlobal(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=(s,i)=>{this.frameworkOverrides.wrapOutgoing(()=>e(s,i))},this.wrappedGlobalListeners.set(e,t)),t}unwrap(e){var t;return(t=this.wrappedListeners.get(e))!=null?t:e}unwrapGlobal(e){var t;return(t=this.wrappedGlobalListeners.get(e))!=null?t:e}},T1={resizable:!0,sortable:!0},D1=0;function pA(){return D1++}var Ss=class gA{constructor(t,s,i,r){this.instanceId=pA(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.eventService=new rn,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=t,this.userProvidedColDef=s,this.colId=i,this.primary=r,this.setState(t)}getInstanceId(){return this.instanceId}setState(t){t.sort!==void 0?(t.sort==="asc"||t.sort==="desc")&&(this.sort=t.sort):(t.initialSort==="asc"||t.initialSort==="desc")&&(this.sort=t.initialSort);const s=t.sortIndex,i=t.initialSortIndex;s!==void 0?s!==null&&(this.sortIndex=s):i!==null&&(this.sortIndex=i);const r=t.hide,n=t.initialHide;r!==void 0?this.visible=!r:this.visible=!n,t.pinned!==void 0?this.setPinned(t.pinned):this.setPinned(t.initialPinned);const o=t.flex,a=t.initialFlex;o!==void 0?this.flex=o:a!==void 0&&(this.flex=a)}setColDef(t,s,i){this.colDef=t,this.userProvidedColDef=s,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged",i))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(t){this.parent=t}getParent(){return this.parent}setOriginalParent(t){this.originalParent=t}getOriginalParent(){return this.originalParent}initialise(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const t=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=Ce(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!t,this.tooltipFieldContainsDots=Ce(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!t}initMinAndMaxWidths(){var t,s;const i=this.colDef;this.minWidth=(t=i.minWidth)!=null?t:this.environment.getMinColWidth(),this.maxWidth=(s=i.maxWidth)!=null?s:Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=Ce(this.colDef.tooltipField)||Ce(this.colDef.tooltipValueGetter)||Ce(this.colDef.tooltipComponent)}resetActualWidth(t){const s=this.calculateColInitialWidth(this.colDef);this.setActualWidth(s,t,!0)}calculateColInitialWidth(t){var s,i;const r=(s=t.minWidth)!=null?s:this.environment.getMinColWidth(),n=(i=t.maxWidth)!=null?i:Number.MAX_SAFE_INTEGER;let o;const a=Ko(t.width),l=Ko(t.initialWidth);return a!=null?o=a:l!=null?o=l:o=200,Math.max(Math.min(o,n),r)}isEmptyGroup(){return!1}isRowGroupDisplayed(t){if(nt(this.colDef)||nt(this.colDef.showRowGroup))return!1;const s=this.colDef.showRowGroup===!0,i=this.colDef.showRowGroup===t;return s||i}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}addEventListener(t,s){var i,r;this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new qS(this.frameworkOverrides));const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.wrap(s))!=null?r:s;this.eventService.addEventListener(t,n)}removeEventListener(t,s){var i,r;const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.unwrap(s))!=null?r:s;this.eventService.removeEventListener(t,n)}createColumnFunctionCallbackParams(t){return this.gos.addGridCommonParams({node:t,data:t.data,column:this,colDef:this.colDef})}isSuppressNavigable(t){if(typeof this.colDef.suppressNavigable=="boolean")return this.colDef.suppressNavigable;if(typeof this.colDef.suppressNavigable=="function"){const s=this.createColumnFunctionCallbackParams(t),i=this.colDef.suppressNavigable;return i(s)}return!1}isCellEditable(t){return t.group&&!this.gos.get("enableGroupEdit")?!1:this.isColumnFunc(t,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(t){return this.isColumnFunc(t,this.colDef.rowDrag)}isDndSource(t){return this.isColumnFunc(t,this.colDef.dndSource)}isCellCheckboxSelection(t){return this.isColumnFunc(t,this.colDef.checkboxSelection)}isSuppressPaste(t){return this.isColumnFunc(t,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(t){var s;return(s=this.colDef[t])!=null?s:T1[t]}isColumnFunc(t,s){if(typeof s=="boolean")return s;if(typeof s=="function"){const i=this.createColumnFunctionCallbackParams(t);return s(i)}return!1}setMoving(t,s){this.moving=t,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",s))}createColumnEvent(t,s){return this.gos.addGridCommonParams({type:t,column:this,columns:[this],source:s})}isMoving(){return this.moving}getSort(){return this.sort}setSort(t,s){this.sort!==t&&(this.sort=t,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",s))),this.dispatchStateUpdatedEvent("sort")}setMenuVisible(t,s){this.menuVisible!==t&&(this.menuVisible=t,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",s)))}isMenuVisible(){return this.menuVisible}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return nt(this.sort)}isSorting(){return Ce(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(t){this.sortIndex=t,this.dispatchStateUpdatedEvent("sortIndex")}setAggFunc(t){this.aggFunc=t,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(t,s){this.oldLeft=this.left,this.left!==t&&(this.left=t,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",s)))}isFilterActive(){return this.filterActive}setFilterActive(t,s,i){this.filterActive!==t&&(this.filterActive=t,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",s)));const r=this.createColumnEvent("filterChanged",s);i&&Mi(r,i),this.eventService.dispatchEvent(r)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(t){t===!0||t==="left"?this.pinned="left":t==="right"?this.pinned="right":this.pinned=null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(t,s){this.firstRightPinned!==t&&(this.firstRightPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",s)))}setLastLeftPinned(t,s){this.lastLeftPinned!==t&&(this.lastLeftPinned=t,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",s)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(t,s){const i=t===!0;this.visible!==i&&(this.visible=i,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",s))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const t=this.getColDef();return!t.suppressSpanHeaderHeight&&!t.autoHeaderHeight}getColumnGroupPaddingInfo(){let t=this.getParent();if(!t||!t.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const s=t.getPaddingLevel()+1;let i=!0;for(;t;){if(!t.isPadding()){i=!1;break}t=t.getParent()}return{numberOfParents:s,isSpanningTotal:i}}getColDef(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getDefinition(){return this.colDef}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(t){const s=t!==this.autoHeaderHeight;return this.autoHeaderHeight=t,s}createBaseColDefParams(t){return this.gos.addGridCommonParams({node:t,data:t.data,colDef:this.colDef,column:this})}getColSpan(t){if(nt(this.colDef.colSpan))return 1;const s=this.createBaseColDefParams(t),i=this.colDef.colSpan(s);return Math.max(i,1)}getRowSpan(t){if(nt(this.colDef.rowSpan))return 1;const s=this.createBaseColDefParams(t),i=this.colDef.rowSpan(s);return Math.max(i,1)}setActualWidth(t,s,i=!1){this.minWidth!=null&&(t=Math.max(t,this.minWidth)),this.maxWidth!=null&&(t=Math.min(t,this.maxWidth)),this.actualWidth!==t&&(this.actualWidth=t,this.flex&&s!=="flex"&&s!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(s)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(t){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",t))}isGreaterThanMax(t){return this.maxWidth!=null?t>this.maxWidth:!1}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(t){this.flex!==t&&(this.flex=t),this.dispatchStateUpdatedEvent("flex")}setMinimum(t){Ce(this.minWidth)&&this.setActualWidth(this.minWidth,t)}setRowGroupActive(t,s){this.rowGroupActive!==t&&(this.rowGroupActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",s))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(t,s){this.pivotActive!==t&&(this.pivotActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",s))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(t,s){this.aggregationActive!==t&&(this.aggregationActive=t,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",s)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}getMenuTabs(t){tt("As of v31.1, 'getMenuTabs' is deprecated. Use 'getColDef().menuTabs ?? defaultValues' instead.");let s=this.getColDef().menuTabs;return s==null&&(s=t),s}dispatchStateUpdatedEvent(t){this.eventService.dispatchEvent({type:gA.EVENT_STATE_UPDATED,key:t})}};Ss.EVENT_MOVING_CHANGED="movingChanged";Ss.EVENT_LEFT_CHANGED="leftChanged";Ss.EVENT_WIDTH_CHANGED="widthChanged";Ss.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged";Ss.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged";Ss.EVENT_VISIBLE_CHANGED="visibleChanged";Ss.EVENT_FILTER_CHANGED="filterChanged";Ss.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged";Ss.EVENT_SORT_CHANGED="sortChanged";Ss.EVENT_COL_DEF_CHANGED="colDefChanged";Ss.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged";Ss.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged";Ss.EVENT_PIVOT_CHANGED="columnPivotChanged";Ss.EVENT_VALUE_CHANGED="columnValueChanged";Ss.EVENT_STATE_UPDATED="columnStateUpdated";f([A("gridOptionsService")],Ss.prototype,"gos",2);f([A("environment")],Ss.prototype,"environment",2);f([A("columnHoverService")],Ss.prototype,"columnHoverService",2);f([A("frameworkOverrides")],Ss.prototype,"frameworkOverrides",2);f([Ee],Ss.prototype,"initialise",1);var Vt=Ss,km=class cd{constructor(t,s,i,r){this.localEventService=new rn,this.expandable=!1,this.instanceId=pA(),this.expandableListenerRemoveCallback=null,this.colGroupDef=t,this.groupId=s,this.expanded=!!t&&!!t.openByDefault,this.padding=i,this.level=r}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}reset(t,s){this.colGroupDef=t,this.level=s,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(t){this.originalParent=t}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(t=>t.isVisible()):!1}isPadding(){return this.padding}setExpanded(t){this.expanded=t===void 0?!1:t;const s={type:cd.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(s)}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(t){this.children=t}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const t=[];return this.addLeafColumns(t),t}addLeafColumns(t){this.children&&this.children.forEach(s=>{s instanceof Vt?t.push(s):s instanceof cd&&s.addLeafColumns(t)})}getColumnGroupShow(){const t=this.colGroupDef;if(t)return t.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const t=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(s=>s.addEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(s=>s.removeEventListener("visibleChanged",t)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let t=!1,s=!1,i=!1;const r=this.findChildrenRemovingPadding();for(let o=0,a=r.length;o<a;o++){const l=r[o];if(!l.isVisible())continue;const u=l.getColumnGroupShow();u==="open"?(t=!0,i=!0):u==="closed"?(s=!0,i=!0):(t=!0,s=!0)}const n=t&&s&&i;if(this.expandable!==n){this.expandable=n;const o={type:cd.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(o)}}findChildrenRemovingPadding(){const t=[],s=i=>{i.forEach(r=>{r instanceof cd&&r.isPadding()?s(r.children):t.push(r)})};return s(this.children),t}onColumnVisibilityChanged(){this.setExpandable()}addEventListener(t,s){this.localEventService.addEventListener(t,s)}removeEventListener(t,s){this.localEventService.removeEventListener(t,s)}};km.EVENT_EXPANDED_CHANGED="expandedChanged";km.EVENT_EXPANDABLE_CHANGED="expandableChanged";f([Si],km.prototype,"destroy",1);var vs=km,P1={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},fA={};Os(fA,{addSafePassiveEventListener:()=>RA,createEventPath:()=>EA,getCtrlForEventTarget:()=>Sf,getEventPath:()=>bA,isElementInEventPath:()=>xf,isEventSupported:()=>ZS,isStopPropagationForAgGrid:()=>en,stopPropagationForAgGrid:()=>nn});var mA={};Os(mA,{areEqual:()=>wn,existsAndNotEmpty:()=>vA,flatten:()=>SA,forEachReverse:()=>N1,includes:()=>rr,insertArrayIntoArray:()=>Uy,insertIntoArray:()=>rh,last:()=>At,moveInArray:()=>$y,pushAll:()=>Ky,removeAllFromArray:()=>wA,removeAllFromUnorderedArray:()=>yA,removeFromArray:()=>Fi,removeFromUnorderedArray:()=>QS,removeRepeatsFromArray:()=>F1,shallowCompare:()=>A1,sortNumerically:()=>CA,toStrings:()=>I1});function vA(e){return e!=null&&e.length>0}function At(e){if(!(!e||!e.length))return e[e.length-1]}function wn(e,t,s){return e==null&&t==null?!0:e!=null&&t!=null&&e.length===t.length&&e.every((i,r)=>s?s(i,t[r]):t[r]===i)}function A1(e,t){return wn(e,t)}function CA(e){return e.sort((t,s)=>t-s)}function F1(e,t){if(e)for(let s=e.length-2;s>=0;s--){const i=e[s]===t,r=e[s+1]===t;i&&r&&e.splice(s+1,1)}}function QS(e,t){const s=e.indexOf(t);s>=0&&(e[s]=e[e.length-1],e.pop())}function Fi(e,t){const s=e.indexOf(t);s>=0&&e.splice(s,1)}function yA(e,t){for(let s=0;s<t.length;s++)QS(e,t[s])}function wA(e,t){for(let s=0;s<t.length;s++)Fi(e,t[s])}function rh(e,t,s){e.splice(s,0,t)}function Uy(e,t,s){if(!(e==null||t==null))for(let i=t.length-1;i>=0;i--){const r=t[i];rh(e,r,s)}}function $y(e,t,s){wA(e,t),t.slice().reverse().forEach(i=>rh(e,i,s))}function rr(e,t){return e.indexOf(t)>-1}function SA(e){return[].concat.apply([],e)}function Ky(e,t){t==null||e==null||t.forEach(s=>e.push(s))}function I1(e){return e.map(ih)}function N1(e,t){if(e!=null)for(let s=e.length-1;s>=0;s--)t(e[s],s)}var xA="__ag_Grid_Stop_Propagation",_1=["touchstart","touchend","touchmove","touchcancel","scroll"],nC={};function nn(e){e[xA]=!0}function en(e){return e[xA]===!0}var ZS=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return s=>{if(typeof nC[s]=="boolean")return nC[s];const i=document.createElement(e[s]||"div");return s="on"+s,nC[s]=s in i}})();function Sf(e,t,s){let i=t;for(;i;){const r=e.getDomData(i,s);if(r)return r;i=i.parentElement}return null}function xf(e,t){return!t||!e?!1:bA(t).indexOf(e)>=0}function EA(e){const t=[];let s=e.target;for(;s;)t.push(s),s=s.parentElement;return t}function bA(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():EA(t)}function RA(e,t,s,i){const n=rr(_1,s)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,s,i,n)}var oo=class TA{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.lastChangeSetIdLookup={},this.propertyListenerId=0,this.isAlive=()=>!this.destroyed}getFrameworkOverrides(){return this.frameworkOverrides}getContext(){return this.context}destroy(){for(let t=0;t<this.destroyFunctions.length;t++)this.destroyFunctions[t]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:TA.EVENT_DESTROYED})}addEventListener(t,s){this.localEventService||(this.localEventService=new rn),this.localEventService.addEventListener(t,s)}removeEventListener(t,s){this.localEventService&&this.localEventService.removeEventListener(t,s)}dispatchEvent(t){this.localEventService&&this.localEventService.dispatchEvent(t)}addManagedListener(t,s,i){if(this.destroyed)return;t instanceof HTMLElement?RA(this.getFrameworkOverrides(),t,s,i):t.addEventListener(s,i);const r=()=>(t.removeEventListener(s,i),null);return this.destroyFunctions.push(r),()=>(r(),this.destroyFunctions=this.destroyFunctions.filter(n=>n!==r),null)}setupGridOptionListener(t,s){this.gos.addEventListener(t,s);const i=()=>(this.gos.removeEventListener(t,s),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter(r=>r!==i),null)}addManagedPropertyListener(t,s){return this.destroyed?()=>null:this.setupGridOptionListener(t,s)}addManagedPropertyListeners(t,s){if(this.destroyed)return;const i=t.join("-")+this.propertyListenerId++,r=n=>{if(n.changeSet){if(n.changeSet&&n.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=n.changeSet.id}const o={type:"gridPropertyChanged",changeSet:n.changeSet,source:n.source};s(o)};t.forEach(n=>this.setupGridOptionListener(n,r))}addDestroyFunc(t){this.isAlive()?this.destroyFunctions.push(t):t()}createManagedBean(t,s){const i=this.createBean(t,s);return this.addDestroyFunc(this.destroyBean.bind(this,t,s)),i}createBean(t,s,i){return(s||this.getContext()).createBean(t,i)}destroyBean(t,s){return(s||this.getContext()).destroyBean(t)}destroyBeans(t,s){if(t)for(let i=0;i<t.length;i++)this.destroyBean(t[i],s);return[]}};oo.EVENT_DESTROYED="destroyed";f([A("frameworkOverrides")],oo.prototype,"frameworkOverrides",2);f([A("context")],oo.prototype,"context",2);f([A("eventService")],oo.prototype,"eventService",2);f([A("gridOptionsService")],oo.prototype,"gos",2);f([A("localeService")],oo.prototype,"localeService",2);f([A("environment")],oo.prototype,"environment",2);f([Si],oo.prototype,"destroy",1);var xe=oo,nh=class extends xe{setBeans(e){this.logger=e.create("ColumnFactory")}createColumnTree(e,t,s,i){const r=new x1,{existingCols:n,existingGroups:o,existingColKeys:a}=this.extractExistingTreeData(s);r.addExistingKeys(a);const l=this.recursivelyCreateColumns(e,0,t,n,r,o,i),u=this.findMaxDept(l,0);this.logger.log("Number of levels for grouped columns is "+u);const h=this.balanceColumnTree(l,0,u,r);return Hn(null,h,(g,m)=>{g instanceof vs&&g.setupExpandable(),g.setOriginalParent(m)}),{columnTree:h,treeDept:u}}extractExistingTreeData(e){const t=[],s=[],i=[];return e&&Hn(null,e,r=>{if(r instanceof vs){const n=r;s.push(n)}else{const n=r;i.push(n.getId()),t.push(n)}}),{existingCols:t,existingGroups:s,existingColKeys:i}}createForAutoGroups(e,t){return e.map(s=>this.createAutoGroupTreeItem(t,s))}createAutoGroupTreeItem(e,t){const s=this.findDepth(e);let i=t;for(let r=s-1;r>=0;r--){const n=new vs(null,`FAKE_PATH_${t.getId()}}_${r}`,!0,r);this.createBean(n),n.setChildren([i]),i.setOriginalParent(n),i=n}return s===0&&t.setOriginalParent(null),i}findDepth(e){let t=0,s=e;for(;s&&s[0]&&s[0]instanceof vs;)t++,s=s[0].getChildren();return t}balanceColumnTree(e,t,s,i){const r=[];for(let n=0;n<e.length;n++){const o=e[n];if(o instanceof vs){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,s,i);a.setChildren(l),r.push(a)}else{let a,l;for(let u=s-1;u>=t;u--){const h=i.getUniqueKey(null,null),p=this.createMergedColGroupDef(null),g=new vs(p,h,!0,t);this.createBean(g),l&&l.setChildren([g]),l=g,a||(a=l)}if(a&&l)if(r.push(a),e.some(h=>h instanceof vs)){l.setChildren([o]);continue}else{l.setChildren(e);break}r.push(o)}}return r}findMaxDept(e,t){let s=t;for(let i=0;i<e.length;i++){const r=e[i];if(r instanceof vs){const n=r,o=this.findMaxDept(n.getChildren(),t+1);s<o&&(s=o)}}return s}recursivelyCreateColumns(e,t,s,i,r,n,o){if(!e)return[];const a=new Array(e.length);for(let l=0;l<a.length;l++){const u=e[l];this.isColumnGroup(u)?a[l]=this.createColumnGroup(s,u,t,i,r,n,o):a[l]=this.createColumn(s,u,i,r,o)}return a}createColumnGroup(e,t,s,i,r,n,o){const a=this.createMergedColGroupDef(t),l=r.getUniqueKey(a.groupId||null,null),u=new vs(a,l,!1,s);this.createBean(u);const h=this.findExistingGroup(t,n);h&&n.splice(h.idx,1);let p=h==null?void 0:h.group;p&&u.setExpanded(p.isExpanded());const g=this.recursivelyCreateColumns(a.children,s+1,e,i,r,n,o);return u.setChildren(g),u}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gos.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(e,t,s,i,r){const n=this.findExistingColumn(t,s);n&&(s==null||s.splice(n.idx,1));let o=n==null?void 0:n.column;if(o){const a=this.addColumnDefaultAndTypes(t,o.getColId());o.setColDef(a,t,r),this.applyColumnState(o,a,r)}else{const a=i.getUniqueKey(t.colId,t.field),l=this.addColumnDefaultAndTypes(t,a);o=new Vt(l,t,a,e),this.context.createBean(o)}return this.dataTypeService.addColumnListeners(o),o}applyColumnState(e,t,s){const i=Ko(t.flex);if(i!==void 0&&e.setFlex(i),e.getFlex()<=0){const a=Ko(t.width);if(a!=null)e.setActualWidth(a,s);else{const l=e.getActualWidth();e.setActualWidth(l,s)}}t.sort!==void 0&&(t.sort=="asc"||t.sort=="desc"?e.setSort(t.sort,s):e.setSort(void 0,s));const n=Ko(t.sortIndex);n!==void 0&&e.setSortIndex(n);const o=Cf(t.hide);o!==void 0&&e.setVisible(!o,s),t.pinned!==void 0&&e.setPinned(t.pinned)}findExistingColumn(e,t){if(t)for(let s=0;s<t.length;s++){const i=t[s].getUserProvidedColDef();if(!i)continue;if(e.colId!=null){if(t[s].getId()===e.colId)return{idx:s,column:t[s]};continue}if(e.field!=null){if(i.field===e.field)return{idx:s,column:t[s]};continue}if(i===e)return{idx:s,column:t[s]}}}findExistingGroup(e,t){if(e.groupId!=null)for(let i=0;i<t.length;i++){const r=t[i];if(r.getColGroupDef()&&r.getId()===e.groupId)return{idx:i,group:r}}}addColumnDefaultAndTypes(e,t){const s={},i=this.gos.get("defaultColDef");Mi(s,i,!1,!0);const r=this.dataTypeService.updateColDefAndGetColumnType(s,e,t);r&&this.assignColumnTypes(r,s),Mi(s,e,!1,!0);const n=this.gos.get("autoGroupColumnDef"),o=this.gos.isColumnsSortingCoupledToGroup();return e.rowGroup&&n&&o&&Mi(s,{sort:n.sort,initialSort:n.initialSort},!1,!0),this.dataTypeService.validateColDef(s),s}assignColumnTypes(e,t){if(!e.length)return;const s=Object.assign({},P1),i=this.gos.get("columnTypes")||{};ei(i,(r,n)=>{r in s?console.warn(`AG Grid: the column type '${r}' is a default column type and cannot be overridden.`):(n.type&&tt("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),s[r]=n)}),e.forEach(r=>{const n=s[r.trim()];n?Mi(t,n,!1,!0):console.warn("AG Grid: colDef.type '"+r+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(e){return e.children!==void 0}};f([A("dataTypeService")],nh.prototype,"dataTypeService",2);f([Yr(0,Sr("loggerFactory"))],nh.prototype,"setBeans",1);nh=f([je("columnFactory")],nh);function Hn(e,t,s){if(t)for(let i=0;i<t.length;i++){const r=t[i];r instanceof vs&&Hn(r,r.getChildren(),s),s(r,e)}}var Mm=class un{constructor(t,s,i,r){this.displayedChildren=[],this.localEventService=new rn,this.groupId=s,this.partId=i,this.providedColumnGroup=t,this.pinned=r}static createUniqueId(t,s){return t+"_"+s}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(t){this.parent=t}getUniqueId(){return un.createUniqueId(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const t=this.getProvidedColumnGroup().getLeafColumns();return!t||t.length===0?!1:t.every(s=>s.isMoving())}checkLeft(){if(this.displayedChildren.forEach(t=>{t instanceof un&&t.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const s=At(this.displayedChildren).getLeft();this.setLeft(s)}else{const t=this.displayedChildren[0].getLeft();this.setLeft(t)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(t){this.oldLeft=this.left,this.left!==t&&(this.left=t,this.localEventService.dispatchEvent(this.createAgEvent(un.EVENT_LEFT_CHANGED)))}getPinned(){return this.pinned}createAgEvent(t){return{type:t}}addEventListener(t,s){this.localEventService.addEventListener(t,s)}removeEventListener(t,s){this.localEventService.removeEventListener(t,s)}getGroupId(){return this.groupId}getPartId(){return this.partId}isChildInThisGroupDeepSearch(t){let s=!1;return this.children.forEach(i=>{t===i&&(s=!0),i instanceof un&&i.isChildInThisGroupDeepSearch(t)&&(s=!0)}),s}getActualWidth(){let t=0;return this.displayedChildren&&this.displayedChildren.forEach(s=>{t+=s.getActualWidth()}),t}isResizable(){if(!this.displayedChildren)return!1;let t=!1;return this.displayedChildren.forEach(s=>{s.isResizable()&&(t=!0)}),t}getMinWidth(){let t=0;return this.displayedChildren.forEach(s=>{t+=s.getMinWidth()||0}),t}addChild(t){this.children||(this.children=[]),this.children.push(t)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const t=[];return this.addLeafColumns(t),t}getDisplayedLeafColumns(){const t=[];return this.addDisplayedLeafColumns(t),t}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(t){this.providedColumnGroup.setExpanded(t)}addDisplayedLeafColumns(t){this.displayedChildren.forEach(s=>{s instanceof Vt?t.push(s):s instanceof un&&s.addDisplayedLeafColumns(t)})}addLeafColumns(t){this.children.forEach(s=>{s instanceof Vt?t.push(s):s instanceof un&&s.addLeafColumns(t)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const t=this.getParent();return!this.isPadding()||!t||!t.isPadding()?0:1+t.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let t=this;for(;t!=null&&t.isPadding();)t=t.getParent();if(!(t?t.providedColumnGroup.isExpandable():!1)){this.displayedChildren=this.children,this.localEventService.dispatchEvent(this.createAgEvent(un.EVENT_DISPLAYED_CHILDREN_CHANGED));return}this.children.forEach(i=>{if(i instanceof un&&(!i.displayedChildren||!i.displayedChildren.length))return;switch(i.getColumnGroupShow()){case"open":t.providedColumnGroup.isExpanded()&&this.displayedChildren.push(i);break;case"closed":t.providedColumnGroup.isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}),this.localEventService.dispatchEvent(this.createAgEvent(un.EVENT_DISPLAYED_CHILDREN_CHANGED))}};Mm.EVENT_LEFT_CHANGED="leftChanged";Mm.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged";f([A("gridOptionsService")],Mm.prototype,"gos",2);var Ps=Mm,w=class{};w.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged";w.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded";w.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged";w.EVENT_PIVOT_MAX_COLUMNS_EXCEEDED="pivotMaxColumnsExceeded";w.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged";w.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll";w.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged";w.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged";w.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged";w.EVENT_COLUMN_MOVED="columnMoved";w.EVENT_COLUMN_VISIBLE="columnVisible";w.EVENT_COLUMN_PINNED="columnPinned";w.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened";w.EVENT_COLUMN_RESIZED="columnResized";w.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged";w.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED="suppressMovableColumns";w.EVENT_SUPPRESS_MENU_HIDE_CHANGED="suppressMenuHide";w.EVENT_SUPPRESS_FIELD_DOT_NOTATION="suppressFieldDotNotation";w.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged";w.EVENT_COLUMN_HEADER_MOUSE_OVER="columnHeaderMouseOver";w.EVENT_COLUMN_HEADER_MOUSE_LEAVE="columnHeaderMouseLeave";w.EVENT_COLUMN_HEADER_CLICKED="columnHeaderClicked";w.EVENT_COLUMN_HEADER_CONTEXT_MENU="columnHeaderContextMenu";w.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed";w.EVENT_ROW_GROUP_OPENED="rowGroupOpened";w.EVENT_ROW_DATA_UPDATED="rowDataUpdated";w.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged";w.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged";w.EVENT_CHART_CREATED="chartCreated";w.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged";w.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged";w.EVENT_CHART_DESTROYED="chartDestroyed";w.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged";w.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged";w.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart";w.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd";w.EVENT_MODEL_UPDATED="modelUpdated";w.EVENT_CUT_START="cutStart";w.EVENT_CUT_END="cutEnd";w.EVENT_PASTE_START="pasteStart";w.EVENT_PASTE_END="pasteEnd";w.EVENT_FILL_START="fillStart";w.EVENT_FILL_END="fillEnd";w.EVENT_RANGE_DELETE_START="rangeDeleteStart";w.EVENT_RANGE_DELETE_END="rangeDeleteEnd";w.EVENT_UNDO_STARTED="undoStarted";w.EVENT_UNDO_ENDED="undoEnded";w.EVENT_REDO_STARTED="redoStarted";w.EVENT_REDO_ENDED="redoEnded";w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart";w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd";w.EVENT_CELL_CLICKED="cellClicked";w.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked";w.EVENT_CELL_MOUSE_DOWN="cellMouseDown";w.EVENT_CELL_CONTEXT_MENU="cellContextMenu";w.EVENT_CELL_VALUE_CHANGED="cellValueChanged";w.EVENT_CELL_EDIT_REQUEST="cellEditRequest";w.EVENT_ROW_VALUE_CHANGED="rowValueChanged";w.EVENT_CELL_FOCUSED="cellFocused";w.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared";w.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused";w.EVENT_ROW_SELECTED="rowSelected";w.EVENT_SELECTION_CHANGED="selectionChanged";w.EVENT_TOOLTIP_SHOW="tooltipShow";w.EVENT_TOOLTIP_HIDE="tooltipHide";w.EVENT_CELL_KEY_DOWN="cellKeyDown";w.EVENT_CELL_MOUSE_OVER="cellMouseOver";w.EVENT_CELL_MOUSE_OUT="cellMouseOut";w.EVENT_FILTER_CHANGED="filterChanged";w.EVENT_FILTER_MODIFIED="filterModified";w.EVENT_FILTER_OPENED="filterOpened";w.EVENT_ADVANCED_FILTER_BUILDER_VISIBLE_CHANGED="advancedFilterBuilderVisibleChanged";w.EVENT_SORT_CHANGED="sortChanged";w.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved";w.EVENT_ROW_CLICKED="rowClicked";w.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked";w.EVENT_GRID_READY="gridReady";w.EVENT_GRID_PRE_DESTROYED="gridPreDestroyed";w.EVENT_GRID_SIZE_CHANGED="gridSizeChanged";w.EVENT_VIEWPORT_CHANGED="viewportChanged";w.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged";w.EVENT_FIRST_DATA_RENDERED="firstDataRendered";w.EVENT_DRAG_STARTED="dragStarted";w.EVENT_DRAG_STOPPED="dragStopped";w.EVENT_CHECKBOX_CHANGED="checkboxChanged";w.EVENT_ROW_EDITING_STARTED="rowEditingStarted";w.EVENT_ROW_EDITING_STOPPED="rowEditingStopped";w.EVENT_CELL_EDITING_STARTED="cellEditingStarted";w.EVENT_CELL_EDITING_STOPPED="cellEditingStopped";w.EVENT_BODY_SCROLL="bodyScroll";w.EVENT_BODY_SCROLL_END="bodyScrollEnd";w.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged";w.EVENT_PAGINATION_CHANGED="paginationChanged";w.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged";w.EVENT_STORE_REFRESHED="storeRefreshed";w.EVENT_STATE_UPDATED="stateUpdated";w.EVENT_COLUMN_MENU_VISIBLE_CHANGED="columnMenuVisibleChanged";w.EVENT_CONTEXT_MENU_VISIBLE_CHANGED="contextMenuVisibleChanged";w.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged";w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED="columnContainerWidthChanged";w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged";w.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged";w.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged";w.EVENT_FLASH_CELLS="flashCells";w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged";w.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged";w.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged";w.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged";w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged";w.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged";w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged";w.EVENT_ROW_DRAG_ENTER="rowDragEnter";w.EVENT_ROW_DRAG_MOVE="rowDragMove";w.EVENT_ROW_DRAG_LEAVE="rowDragLeave";w.EVENT_ROW_DRAG_END="rowDragEnd";w.EVENT_GRID_STYLES_CHANGED="gridStylesChanged";w.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest";w.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest";w.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest";w.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest";w.EVENT_STORE_UPDATED="storeUpdated";w.EVENT_FILTER_DESTROYED="filterDestroyed";w.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted";w.EVENT_ROW_COUNT_READY="rowCountReady";w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED="advancedFilterEnabledChanged";w.EVENT_DATA_TYPES_INFERRED="dataTypesInferred";w.EVENT_FIELD_VALUE_CHANGED="fieldValueChanged";w.EVENT_FIELD_PICKER_VALUE_SELECTED="fieldPickerValueSelected";w.EVENT_SIDE_BAR_UPDATED="sideBarUpdated";var Rg=new Set([w.EVENT_GRID_PRE_DESTROYED,w.EVENT_FILL_START]),DA=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let s;return typeof t!="number"?s=0:s=t+1,this.existingIds[e]=s,s}},zc="ag-Grid-AutoColumn",oh=class extends xe{createAutoGroupColumns(e){const t=[],s=this.gos.get("treeData");let i=this.gos.isGroupMultiAutoColumn();return s&&i&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),i=!1),i?e.forEach((r,n)=>{t.push(this.createOneAutoGroupColumn(r,n))}):t.push(this.createOneAutoGroupColumn()),t}updateAutoGroupColumns(e,t){e.forEach((s,i)=>this.updateOneAutoGroupColumn(s,i,t))}createOneAutoGroupColumn(e,t){let s;e?s=`${zc}-${e.getId()}`:s=zc;const i=this.createAutoGroupColDef(s,e,t);i.colId=s;const r=new Vt(i,null,s,!0);return this.context.createBean(r),r}updateOneAutoGroupColumn(e,t,s){const i=e.getColDef(),r=typeof i.showRowGroup=="string"?i.showRowGroup:void 0,n=r!=null?this.columnModel.getPrimaryColumn(r):void 0,o=this.createAutoGroupColDef(e.getId(),n??void 0,t);e.setColDef(o,null,s),this.columnFactory.applyColumnState(e,o,s)}createAutoGroupColDef(e,t,s){let i=this.createBaseColDef(t);const r=this.gos.get("autoGroupColumnDef");Mi(i,r),i=this.columnFactory.addColumnDefaultAndTypes(i,e),this.gos.get("treeData")||nt(i.field)&&nt(i.valueGetter)&&nt(i.filterValueGetter)&&i.filter!=="agGroupColumnFilter"&&(i.filter=!1),s&&s>0&&(i.headerCheckboxSelection=!1);const n=this.gos.isColumnsSortingCoupledToGroup(),o=i.valueGetter||i.field!=null;return n&&!o&&(i.sortIndex=void 0,i.initialSort=void 0),i}createBaseColDef(e){const t=this.gos.get("autoGroupColumnDef"),i={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(t&&(t.cellRenderer||t.cellRendererSelector)||(i.cellRenderer="agGroupCellRenderer"),e){const n=e.getColDef();Object.assign(i,{headerName:this.columnModel.getDisplayNameForColumn(e,"header"),headerValueGetter:n.headerValueGetter}),n.cellRenderer&&Object.assign(i,{cellRendererParams:{innerRenderer:n.cellRenderer,innerRendererParams:n.cellRendererParams}}),i.showRowGroup=e.getColId()}else i.showRowGroup=!0;return i}};f([A("columnModel")],oh.prototype,"columnModel",2);f([A("columnFactory")],oh.prototype,"columnFactory",2);oh=f([je("autoGroupColService")],oh);var PA={};Os(PA,{camelCaseToHumanText:()=>AA,camelCaseToHyphenated:()=>FA,capitalise:()=>O1,escapeString:()=>ys,utf8_encode:()=>L1});var k1=/[&<>"']/g,M1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function L1(e){const t=String.fromCharCode;function s(p){const g=[];if(!p)return[];const m=p.length;let C=0,y,R;for(;C<m;)y=p.charCodeAt(C++),y>=55296&&y<=56319&&C<m?(R=p.charCodeAt(C++),(R&64512)==56320?g.push(((y&1023)<<10)+(R&1023)+65536):(g.push(y),C--)):g.push(y);return g}function i(p){if(p>=55296&&p<=57343)throw Error("Lone surrogate U+"+p.toString(16).toUpperCase()+" is not a scalar value")}function r(p,g){return t(p>>g&63|128)}function n(p){if(p>=0&&p<=31&&p!==10)return`_x${p.toString(16).toUpperCase().padStart(4,"0")}_`;if(!(p&4294967168))return t(p);let g="";return p&4294965248?p&4294901760?p&4292870144||(g=t(p>>18&7|240),g+=r(p,12),g+=r(p,6)):(i(p),g=t(p>>12&15|224),g+=r(p,6)):g=t(p>>6&31|192),g+=t(p&63|128),g}const o=s(e),a=o.length;let l=-1,u,h="";for(;++l<a;)u=o[l],h+=n(u);return h}function O1(e){return e[0].toUpperCase()+e.substring(1).toLowerCase()}function ys(e,t){if(e==null)return null;const s=e.toString().toString();return t?s:s.replace(k1,i=>M1[i])}function AA(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,s=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(s,"$1 $2$3").replace(/\./g," ").split(" ").map(r=>r.substring(0,1).toUpperCase()+(r.length>1?r.substring(1,r.length):"")).join(" ")}function FA(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}var IA={};Os(IA,{convertToMap:()=>Po,keys:()=>V1,mapById:()=>G1});function Po(e){const t=new Map;return e.forEach(s=>t.set(s[0],s[1])),t}function G1(e,t){const s=new Map;return e.forEach(i=>s.set(t(i),i)),s}function V1(e){const t=[];return e.forEach((s,i)=>t.push(i)),t}var Ls=class extends xe{constructor(){super(...arguments),this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.gridHeaderRowCount=0,this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.displayedColumnsAndGroupsMap={},this.viewportColumns=[],this.viewportColumnsHash="",this.headerViewportColumns=[],this.viewportColumnsCenter=[],this.headerViewportColumnsCenter=[],this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.autoHeightActiveAtLeastOnce=!1,this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.changeEventsDispatching=!1,this.autoGroupsNeedBuilding=!1,this.forceRecreateAutoGroups=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}init(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation");const e=this.gos.get("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],t=>this.buildAutoGroupColumns(gc(t.source))),this.addManagedPropertyListener("autoGroupColumnDef",t=>this.onAutoGroupColumnDefChanged(gc(t.source))),this.addManagedPropertyListeners(["defaultColDef","columnTypes","suppressFieldDotNotation"],t=>this.onSharedColDefChanged(gc(t.source))),this.addManagedPropertyListener("pivotMode",t=>this.setPivotMode(this.gos.get("pivotMode"),gc(t.source))),this.addManagedListener(this.eventService,w.EVENT_FIRST_DATA_RENDERED,()=>this.onFirstDataRendered())}buildAutoGroupColumns(e){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns(e))}onAutoGroupColumnDefChanged(e){this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,e)}onSharedColDefChanged(e){this.gridColumns&&(this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,e),this.createColumnsFromColumnDefs(!0,e))}setColumnDefs(e,t){const s=!!this.columnDefs;this.columnDefs=e,this.createColumnsFromColumnDefs(s,t)}recreateColumnDefs(e){this.onSharedColDefChanged(e)}destroyOldColumns(e,t){const s={};if(!e)return;Hn(null,e,r=>{s[r.getInstanceId()]=r}),t&&Hn(null,t,r=>{s[r.getInstanceId()]=null});const i=Object.values(s).filter(r=>r!=null);this.destroyBeans(i)}destroyColumns(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}createColumnsFromColumnDefs(e,t){const s=e?this.compareColumnStatesAndDispatchEvents(t):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;const i=this.primaryColumns,r=this.primaryColumnTree,n=this.columnFactory.createColumnTree(this.columnDefs,!0,r,t);this.destroyOldColumns(this.primaryColumnTree,n.columnTree),this.primaryColumnTree=n.columnTree,this.primaryHeaderRowCount=n.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(l=>this.primaryColumnsMap[l.getId()]=l),this.extractRowGroupColumns(t,i),this.extractPivotColumns(t,i),this.extractValueColumns(t,i),this.ready=!0;const o=this.gridColsArePrimary===void 0;(this.gridColsArePrimary||o||this.autoGroupsNeedBuilding)&&(this.updateGridColumns(),e&&this.gridColsArePrimary&&!this.gos.get("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(t),this.checkViewportColumns()),this.dispatchEverythingChanged(t),this.changeEventsDispatching=!0,s&&s(),this.changeEventsDispatching=!1,this.dispatchNewColumnsLoaded(t)}shouldRowModelIgnoreRefresh(){return this.changeEventsDispatching}dispatchNewColumnsLoaded(e){const t={type:w.EVENT_NEW_COLUMNS_LOADED,source:e};this.eventService.dispatchEvent(t),e==="gridInitializing"&&this.onColumnsReady()}dispatchEverythingChanged(e){const t={type:w.EVENT_COLUMN_EVERYTHING_CHANGED,source:e};this.eventService.dispatchEvent(t)}orderGridColumnsLikePrimary(){const e=this.primaryColumns;if(!e)return;const t=e.filter(i=>this.gridColumns.indexOf(i)>=0),s=this.gridColumns.filter(i=>t.indexOf(i)<0);this.gridColumns=[...s,...t],this.gridColumns=this.placeLockedColumns(this.gridColumns)}getAllDisplayedAutoHeightCols(){return this.displayedAutoHeightCols}setViewport(){this.gos.get("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}checkViewportColumns(e=!1){if(this.displayedColumnsCenter==null||!this.extractViewport())return;const s={type:w.EVENT_VIRTUAL_COLUMNS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(s)}setViewportPosition(e,t,s=!1){(e!==this.scrollWidth||t!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=e,this.scrollPosition=t,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns(s))}isPivotMode(){return this.pivotMode}isPivotSettingAllowed(e){return e&&this.gos.get("treeData")?(tt("Pivot mode not available with treeData."),!1):!0}setPivotMode(e,t){if(e===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode)||(this.pivotMode=e,!this.gridColumns))return;this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(t);const s={type:w.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(s)}getSecondaryPivotColumn(e,t){if(nt(this.secondaryColumns))return null;const s=this.getPrimaryColumn(t);let i=null;return this.secondaryColumns.forEach(r=>{const n=r.getColDef().pivotKeys,o=r.getColDef().pivotValueColumn;wn(n,e)&&o===s&&(i=r)}),i}setBeans(e){this.logger=e.create("columnModel")}setFirstRightAndLastLeftPinned(e){let t,s;this.gos.get("enableRtl")?(t=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,s=this.displayedColumnsRight?At(this.displayedColumnsRight):null):(t=this.displayedColumnsLeft?At(this.displayedColumnsLeft):null,s=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(i=>{i.setLastLeftPinned(i===t,e),i.setFirstRightPinned(i===s,e)})}autoSizeColumns(e){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeColumns(e));return}const{columns:t,skipHeader:s,skipHeaderGroups:i,stopAtGroup:r,source:n="api"}=e;this.animationFrameService.flushAllFrames();const o=[];let a=-1;const l=s??this.gos.get("skipHeaderOnAutoSize"),u=i??l;for(;a!==0;)a=0,this.actionOnGridColumns(t,h=>{if(o.indexOf(h)>=0)return!1;const p=this.autoWidthCalculator.getPreferredWidthForColumn(h,l);if(p>0){const g=this.normaliseColumnWidth(h,p);h.setActualWidth(g,n),o.push(h),a++}return!0},n);u||this.autoSizeColumnGroupsByColumns(t,n,r),this.dispatchColumnResizedEvent(o,!0,"autosizeColumns")}dispatchColumnResizedEvent(e,t,s,i=null){if(e&&e.length){const r={type:w.EVENT_COLUMN_RESIZED,columns:e,column:e.length===1?e[0]:null,flexColumns:i,finished:t,source:s};this.eventService.dispatchEvent(r)}}dispatchColumnChangedEvent(e,t,s){const i={type:e,columns:t,column:t&&t.length==1?t[0]:null,source:s};this.eventService.dispatchEvent(i)}dispatchColumnMovedEvent(e){const{movedColumns:t,source:s,toIndex:i,finished:r}=e,n={type:w.EVENT_COLUMN_MOVED,columns:t,column:t&&t.length===1?t[0]:null,toIndex:i,finished:r,source:s};this.eventService.dispatchEvent(n)}dispatchColumnPinnedEvent(e,t){if(!e.length)return;const s=e.length===1?e[0]:null,i=this.getCommonValue(e,n=>n.getPinned()),r={type:w.EVENT_COLUMN_PINNED,pinned:i??null,columns:e,column:s,source:t};this.eventService.dispatchEvent(r)}dispatchColumnVisibleEvent(e,t){if(!e.length)return;const s=e.length===1?e[0]:null,i=this.getCommonValue(e,n=>n.isVisible()),r={type:w.EVENT_COLUMN_VISIBLE,visible:i,columns:e,column:s,source:t};this.eventService.dispatchEvent(r)}autoSizeColumn(e,t,s){e&&this.autoSizeColumns({columns:[e],skipHeader:s,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,s){const i=new Set;this.getGridColumns(e).forEach(a=>{let l=a.getParent();for(;l&&l!=s;)l.isPadding()||i.add(l),l=l.getParent()});let n;const o=[];for(const a of i){for(const l of this.ctrlsService.getHeaderRowContainerCtrls())if(n=l.getHeaderCtrlForColumn(a),n)break;n&&n.resizeLeafColumnsToFit(t)}return o}autoSizeAllColumns(e,t){if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.autoSizeAllColumns(e,t));return}const s=this.getAllDisplayedColumns();this.autoSizeColumns({columns:s,skipHeader:t,source:e})}getColumnsFromTree(e){const t=[],s=i=>{for(let r=0;r<i.length;r++){const n=i[r];n instanceof Vt?t.push(n):n instanceof vs&&s(n.getChildren())}};return s(e),t}getAllDisplayedTrees(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}getPrimaryColumnTree(){return this.primaryColumnTree}getHeaderRowCount(){return this.gridHeaderRowCount}getDisplayedTreeLeft(){return this.displayedTreeLeft}getDisplayedTreeRight(){return this.displayedTreeRight}getDisplayedTreeCentre(){return this.displayedTreeCentre}isColumnDisplayed(e){return this.getAllDisplayedColumns().indexOf(e)>=0}getAllDisplayedColumns(){return this.displayedColumns}getViewportColumns(){return this.viewportColumns}getDisplayedLeftColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsLeft):this.displayedColumnsLeft}getDisplayedRightColumnsForRow(e){return this.colSpanActive?this.getDisplayedColumnsForRow(e,this.displayedColumnsRight):this.displayedColumnsRight}isColSpanActive(){return this.colSpanActive}getDisplayedColumnsForRow(e,t,s,i){const r=[];let n=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,u=Math.min(a.getColSpan(e),l),h=[a];if(u>1){const g=u-1;for(let m=1;m<=g;m++)h.push(t[o+m]);o+=g}let p;s?(p=!1,h.forEach(g=>{s(g)&&(p=!0)})):p=!0,p&&(r.length===0&&n&&(i&&i(a))&&r.push(n),r.push(a)),n=a}return r}getViewportCenterColumnsForRow(e){if(!this.colSpanActive)return this.viewportColumnsCenter;const t=i=>{const r=i.getLeft();return Ce(r)&&r>this.viewportLeft},s=this.isColumnVirtualisationSuppressed()?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(e,this.displayedColumnsCenter,s,t)}isColumnAtEdge(e,t){const s=this.getAllDisplayedColumns();if(!s.length)return!1;const i=t==="first";let r;if(e instanceof Ps){const n=e.getDisplayedLeafColumns();if(!n.length)return!1;r=i?n[0]:At(n)}else r=e;return(i?s[0]:At(s))===r}getAriaColumnIndex(e){let t;return e instanceof Ps?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,s=t+e.getActualWidth(),i=this.viewportLeft-200,r=this.viewportRight+200,n=t<i&&s<i,o=t>r&&s>r;return!n&&!o}getDisplayedColumnsLeftWidth(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}getDisplayedColumnsRightWidth(){return this.getWidthOfColsInList(this.displayedColumnsRight)}updatePrimaryColumnList(e,t,s,i,r,n){if(!e||yr(e))return;let o=!1;if(e.forEach(l=>{if(!l)return;const u=this.getPrimaryColumn(l);if(u){if(s){if(t.indexOf(u)>=0)return;t.push(u)}else{if(t.indexOf(u)<0)return;Fi(t,u)}i(u),o=!0}}),!o)return;this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(n);const a={type:r,columns:t,column:t.length===1?t[0]:null,source:n};this.eventService.dispatchEvent(a)}setRowGroupColumns(e,t){this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(e,this.rowGroupColumns,w.EVENT_COLUMN_ROW_GROUP_CHANGED,!0,this.setRowGroupActive.bind(this),t)}setRowGroupActive(e,t,s){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,s),e&&!this.gos.get("suppressRowGroupHidesColumns")&&this.setColumnsVisible([t],!1,s),!e&&!this.gos.get("suppressMakeColumnVisibleAfterUnGroup")&&this.setColumnsVisible([t],!0,s))}addRowGroupColumns(e,t){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),w.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}removeRowGroupColumns(e,t){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(e,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),w.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}addPivotColumns(e,t){this.updatePrimaryColumnList(e,this.pivotColumns,!0,s=>s.setPivotActive(!0,t),w.EVENT_COLUMN_PIVOT_CHANGED,t)}setPivotColumns(e,t){this.setPrimaryColumnList(e,this.pivotColumns,w.EVENT_COLUMN_PIVOT_CHANGED,!0,(s,i)=>{i.setPivotActive(s,t)},t)}removePivotColumns(e,t){this.updatePrimaryColumnList(e,this.pivotColumns,!1,s=>s.setPivotActive(!1,t),w.EVENT_COLUMN_PIVOT_CHANGED,t)}setPrimaryColumnList(e,t,s,i,r,n){if(!this.gridColumns)return;const o=new Map;t.forEach((a,l)=>o.set(a,l)),t.length=0,Ce(e)&&e.forEach(a=>{const l=this.getPrimaryColumn(a);l&&t.push(l)}),t.forEach((a,l)=>{const u=o.get(a);if(u===void 0){o.set(a,0);return}i&&u!==l||o.delete(a)}),(this.primaryColumns||[]).forEach(a=>{const l=t.indexOf(a)>=0;r(l,a)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(n),this.dispatchColumnChangedEvent(s,[...o.keys()],n)}setValueColumns(e,t){this.setPrimaryColumnList(e,this.valueColumns,w.EVENT_COLUMN_VALUE_CHANGED,!1,this.setValueActive.bind(this),t)}setValueActive(e,t,s){if(e!==t.isValueActive()&&(t.setValueActive(e,s),e&&!t.getAggFunc()&&this.aggFuncService)){const i=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(i)}}addValueColumns(e,t){this.updatePrimaryColumnList(e,this.valueColumns,!0,this.setValueActive.bind(this,!0),w.EVENT_COLUMN_VALUE_CHANGED,t)}removeValueColumns(e,t){this.updatePrimaryColumnList(e,this.valueColumns,!1,this.setValueActive.bind(this,!1),w.EVENT_COLUMN_VALUE_CHANGED,t)}normaliseColumnWidth(e,t){const s=e.getMinWidth();Ce(s)&&t<s&&(t=s);const i=e.getMaxWidth();return Ce(i)&&e.isGreaterThanMax(t)&&(t=i),t}getPrimaryOrGridColumn(e){return this.getPrimaryColumn(e)||this.getGridColumn(e)}setColumnWidths(e,t,s,i){const r=[];e.forEach(n=>{const o=this.getPrimaryOrGridColumn(n.key);if(!o)return;if(r.push({width:n.newWidth,ratios:[1],columns:[o]}),this.gos.get("colResizeDefault")==="shift"&&(t=!t),t){const l=this.getDisplayedColAfter(o);if(!l)return;const u=o.getActualWidth()-n.newWidth,h=l.getActualWidth()+u;r.push({width:h,ratios:[1],columns:[l]})}}),r.length!==0&&this.resizeColumnSets({resizeSets:r,finished:s,source:i})}checkMinAndMaxWidthsForSet(e){const{columns:t,width:s}=e;let i=0,r=0,n=!0;t.forEach(l=>{const u=l.getMinWidth();i+=u||0;const h=l.getMaxWidth();Ce(h)&&h>0?r+=h:n=!1});const o=s>=i,a=!n||s<=r;return o&&a}resizeColumnSets(e){const{resizeSets:t,finished:s,source:i}=e;if(!(!t||t.every(h=>this.checkMinAndMaxWidthsForSet(h)))){if(s){const h=t&&t.length>0?t[0].columns:null;this.dispatchColumnResizedEvent(h,s,i)}return}const n=[],o=[];t.forEach(h=>{const{width:p,columns:g,ratios:m}=h,C={},y={};g.forEach(S=>o.push(S));let R=!0,x=0;for(;R;){if(x++,x>1e3){console.error("AG Grid: infinite loop in resizeColumnSets");break}R=!1;const S=[];let T=0,I=p;g.forEach((H,P)=>{if(y[H.getId()])I-=C[H.getId()];else{S.push(H);const _=m[P];T+=_}});const V=1/T;S.forEach((H,P)=>{const N=P===S.length-1;let _;N?_=I:(_=Math.round(m[P]*p*V),I-=_);const L=H.getMinWidth(),M=H.getMaxWidth();Ce(L)&&_<L?(_=L,y[H.getId()]=!0,R=!0):Ce(M)&&M>0&&_>M&&(_=M,y[H.getId()]=!0,R=!0),C[H.getId()]=_})}g.forEach(S=>{const T=C[S.getId()];S.getActualWidth()!==T&&(S.setActualWidth(T,i),n.push(S))})});const a=n.length>0;let l=[];a&&(l=this.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}),this.setLeftValues(i),this.updateBodyWidths(),this.checkViewportColumns());const u=o.concat(l);(a||s)&&this.dispatchColumnResizedEvent(u,s,i,l)}setColumnAggFunc(e,t,s){if(!e)return;const i=this.getPrimaryColumn(e);i&&(i.setAggFunc(t),this.dispatchColumnChangedEvent(w.EVENT_COLUMN_VALUE_CHANGED,[i],s))}moveRowGroupColumn(e,t,s){if(this.isRowGroupEmpty())return;const i=this.rowGroupColumns[e],r=this.rowGroupColumns.slice(e,t);this.rowGroupColumns.splice(e,1),this.rowGroupColumns.splice(t,0,i);const n={type:w.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:r,column:r.length===1?r[0]:null,source:s};this.eventService.dispatchEvent(n)}moveColumns(e,t,s,i=!0){if(!this.gridColumns)return;if(this.columnAnimationService.start(),t>this.gridColumns.length-e.length){console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+t),console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");return}const r=this.getGridColumns(e);this.doesMovePassRules(r,t)&&($y(this.gridColumns,r,t),this.updateDisplayedColumns(s),this.dispatchColumnMovedEvent({movedColumns:r,source:s,toIndex:t,finished:i}),this.columnAnimationService.finish())}doesMovePassRules(e,t){const s=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(s)}doesOrderPassRules(e){return!(!this.doesMovePassMarryChildren(e)||!this.doesMovePassLockedPositions(e))}getProposedColumnOrder(e,t){const s=this.gridColumns.slice();return $y(s,e,t),s}sortColumnsLikeGridColumns(e){!e||e.length<=1||e.filter(s=>this.gridColumns.indexOf(s)<0).length>0||e.sort((s,i)=>{const r=this.gridColumns.indexOf(s),n=this.gridColumns.indexOf(i);return r-n})}doesMovePassLockedPositions(e){let t=0,s=!0;const i=r=>r?r===!0||r==="left"?0:2:1;return e.forEach(r=>{const n=i(r.getColDef().lockPosition);n<t&&(s=!1),t=n}),s}doesMovePassMarryChildren(e){let t=!0;return Hn(null,this.gridBalancedTree,s=>{if(!(s instanceof vs))return;const i=s,r=i.getColGroupDef();if(!(r&&r.marryChildren))return;const o=[];i.getLeafColumns().forEach(p=>{const g=e.indexOf(p);o.push(g)});const a=Math.max.apply(Math,o),l=Math.min.apply(Math,o),u=a-l,h=i.getLeafColumns().length-1;u>h&&(t=!1)}),t}moveColumnByIndex(e,t,s){if(!this.gridColumns)return;const i=this.gridColumns[e];this.moveColumns([i],t,s)}getColumnDefs(){if(!this.primaryColumns)return;const e=this.primaryColumns.slice();return this.gridColsArePrimary?e.sort((t,s)=>this.gridColumns.indexOf(t)-this.gridColumns.indexOf(s)):this.lastPrimaryOrder&&e.sort((t,s)=>this.lastPrimaryOrder.indexOf(t)-this.lastPrimaryOrder.indexOf(s)),this.columnDefFactory.buildColumnDefs(e,this.rowGroupColumns,this.pivotColumns)}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}updateBodyWidths(){const e=this.getWidthOfColsInList(this.displayedColumnsCenter),t=this.getWidthOfColsInList(this.displayedColumnsLeft),s=this.getWidthOfColsInList(this.displayedColumnsRight);if(this.bodyWidthDirty=this.bodyWidth!==e,this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==s){this.bodyWidth=e,this.leftWidth=t,this.rightWidth=s;const r={type:w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED};this.eventService.dispatchEvent(r);const n={type:w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(n)}}getValueColumns(){return this.valueColumns?this.valueColumns:[]}getPivotColumns(){return this.pivotColumns?this.pivotColumns:[]}isPivotActive(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}getRowGroupColumns(){return this.rowGroupColumns?this.rowGroupColumns:[]}getDisplayedCenterColumns(){return this.displayedColumnsCenter}getDisplayedLeftColumns(){return this.displayedColumnsLeft}getDisplayedRightColumns(){return this.displayedColumnsRight}getAllPrimaryColumns(){return this.primaryColumns?this.primaryColumns:null}getSecondaryColumns(){return this.secondaryColumns?this.secondaryColumns:null}getAllColumnsForQuickFilter(){return this.columnsForQuickFilter}getAllGridColumns(){var e;return(e=this.gridColumns)!=null?e:[]}isRowGroupEmpty(){return yr(this.rowGroupColumns)}setColumnsVisible(e,t=!1,s){this.applyColumnState({state:e.map(i=>({colId:typeof i=="string"?i:i.getColId(),hide:!t}))},s)}setColumnsPinned(e,t,s){if(!this.gridColumns)return;if(this.gos.isDomLayout("print")){console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");return}this.columnAnimationService.start();let i;t===!0||t==="left"?i="left":t==="right"?i="right":i=null,this.actionOnGridColumns(e,r=>r.getPinned()!==i?(r.setPinned(i),!0):!1,s,()=>({type:w.EVENT_COLUMN_PINNED,pinned:i,column:null,columns:null,source:s})),this.columnAnimationService.finish()}actionOnGridColumns(e,t,s,i){if(yr(e))return;const r=[];if(e.forEach(n=>{if(!n)return;const o=this.getGridColumn(n);if(!o)return;t(o)!==!1&&r.push(o)}),!!r.length&&(this.updateDisplayedColumns(s),Ce(i)&&i)){const n=i();n.columns=r,n.column=r.length===1?r[0]:null,this.eventService.dispatchEvent(n)}}getDisplayedColBefore(e){const t=this.getAllDisplayedColumns(),s=t.indexOf(e);return s>0?t[s-1]:null}getDisplayedColAfter(e){const t=this.getAllDisplayedColumns(),s=t.indexOf(e);return s<t.length-1?t[s+1]:null}getDisplayedGroupAtDirection(e,t){const s=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),i=e.getDisplayedLeafColumns(),r=t==="After"?At(i):i[0],n=`getDisplayedCol${t}`;for(;;){const o=this[n](r);if(!o)return null;const a=this.getColumnGroupAtLevel(o,s);if(a!==e)return a}}getColumnGroupAtLevel(e,t){let s=e.getParent(),i,r;for(;i=s.getProvidedColumnGroup().getLevel(),r=s.getPaddingLevel(),!(i+r<=t);)s=s.getParent();return s}isPinningLeft(){return this.displayedColumnsLeft.length>0}isPinningRight(){return this.displayedColumnsRight.length>0}getPrimaryAndSecondaryAndAutoColumns(){return[].concat(this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[])}createStateItemFromColumn(e){const t=e.isRowGroupActive()?this.rowGroupColumns.indexOf(e):null,s=e.isPivotActive()?this.pivotColumns.indexOf(e):null,i=e.isValueActive()?e.getAggFunc():null,r=e.getSort()!=null?e.getSort():null,n=e.getSortIndex()!=null?e.getSortIndex():null,o=e.getFlex()!=null&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:r,sortIndex:n,aggFunc:i,rowGroup:e.isRowGroupActive(),rowGroupIndex:t,pivot:e.isPivotActive(),pivotIndex:s,flex:o}}getColumnState(){if(nt(this.primaryColumns)||!this.isAlive())return[];const t=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(t),t}orderColumnStateList(e){const t=Po(this.gridColumns.map((s,i)=>[s.getColId(),i]));e.sort((s,i)=>{const r=t.has(s.colId)?t.get(s.colId):-1,n=t.has(i.colId)?t.get(i.colId):-1;return r-n})}resetColumnState(e){if(yr(this.primaryColumns))return;const t=this.getColumnsFromTree(this.primaryColumnTree),s=[];let i=1e3,r=1e3,n=[];this.groupAutoColumns&&(n=n.concat(this.groupAutoColumns)),t&&(n=n.concat(t)),n.forEach(o=>{const a=this.getColumnStateFromColDef(o);nt(a.rowGroupIndex)&&a.rowGroup&&(a.rowGroupIndex=i++),nt(a.pivotIndex)&&a.pivot&&(a.pivotIndex=r++),s.push(a)}),this.applyColumnState({state:s,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(C,y)=>C??y??null,s=e.getColDef(),i=t(s.sort,s.initialSort),r=t(s.sortIndex,s.initialSortIndex),n=t(s.hide,s.initialHide),o=t(s.pinned,s.initialPinned),a=t(s.width,s.initialWidth),l=t(s.flex,s.initialFlex);let u=t(s.rowGroupIndex,s.initialRowGroupIndex),h=t(s.rowGroup,s.initialRowGroup);u==null&&(h==null||h==!1)&&(u=null,h=null);let p=t(s.pivotIndex,s.initialPivotIndex),g=t(s.pivot,s.initialPivot);p==null&&(g==null||g==!1)&&(p=null,g=null);const m=t(s.aggFunc,s.initialAggFunc);return{colId:e.getColId(),sort:i,sortIndex:r,hide:n,pinned:o,width:a,flex:l,rowGroup:h,rowGroupIndex:u,pivot:g,pivotIndex:p,aggFunc:m}}applyColumnState(e,t){if(yr(this.primaryColumns))return!1;if(e&&e.state&&!e.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const s=(n,o,a)=>{const l=this.compareColumnStatesAndDispatchEvents(t);this.autoGroupsNeedBuilding=!0;const u=o.slice(),h={},p={},g=[],m=[];let C=0;const y=this.rowGroupColumns.slice(),R=this.pivotColumns.slice();n.forEach(I=>{const V=I.colId||"";if(V.startsWith(zc)){g.push(I),m.push(I);return}const P=a(V);P?(this.syncColumnWithStateItem(P,I,e.defaultState,h,p,!1,t),Fi(u,P)):(m.push(I),C+=1)});const x=I=>this.syncColumnWithStateItem(I,null,e.defaultState,h,p,!1,t);u.forEach(x);const S=(I,V,H,P)=>{const N=I[H.getId()],_=I[P.getId()],L=N!=null,M=_!=null;if(L&&M)return N-_;if(L)return-1;if(M)return 1;const b=V.indexOf(H),F=V.indexOf(P),Z=b>=0,K=F>=0;return Z&&K?b-F:Z?-1:1};this.rowGroupColumns.sort(S.bind(this,h,y)),this.pivotColumns.sort(S.bind(this,p,R)),this.updateGridColumns();const T=this.groupAutoColumns?this.groupAutoColumns.slice():[];return g.forEach(I=>{const V=this.getAutoColumn(I.colId);Fi(T,V),this.syncColumnWithStateItem(V,I,e.defaultState,null,null,!0,t)}),T.forEach(x),this.applyOrderAfterApplyState(e),this.updateDisplayedColumns(t),this.dispatchEverythingChanged(t),l(),{unmatchedAndAutoStates:m,unmatchedCount:C}};this.columnAnimationService.start();let{unmatchedAndAutoStates:i,unmatchedCount:r}=s(e.state||[],this.primaryColumns||[],n=>this.getPrimaryColumn(n));return(i.length>0||Ce(e.defaultState))&&(r=s(i,this.secondaryColumns||[],n=>this.getSecondaryColumn(n)).unmatchedCount),this.columnAnimationService.finish(),r===0}applyOrderAfterApplyState(e){if(!e.applyOrder||!e.state)return;let t=[];const s={};e.state.forEach(r=>{if(!r.colId||s[r.colId])return;const n=this.gridColumnsMap[r.colId];n&&(t.push(n),s[r.colId]=!0)});let i=0;if(this.gridColumns.forEach(r=>{const n=r.getColId();if(s[n]!=null)return;n.startsWith(zc)?rh(t,r,i++):t.push(r)}),t=this.placeLockedColumns(t),!this.doesMovePassMarryChildren(t)){console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.");return}this.gridColumns=t}compareColumnStatesAndDispatchEvents(e){const t={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},s=this.getColumnState(),i={};return s.forEach(r=>{i[r.colId]=r}),()=>{const r=this.getPrimaryAndSecondaryAndAutoColumns(),n=(y,R,x,S)=>{const T=R.map(S),I=x.map(S);if(wn(T,I))return;const H=new Set(R);x.forEach(_=>{H.delete(_)||H.add(_)});const P=[...H],N={type:y,columns:P,column:P.length===1?P[0]:null,source:e};this.eventService.dispatchEvent(N)},o=y=>{const R=[];return r.forEach(x=>{const S=i[x.getColId()];S&&y(S,x)&&R.push(x)}),R},a=y=>y.getColId();n(w.EVENT_COLUMN_ROW_GROUP_CHANGED,t.rowGroupColumns,this.rowGroupColumns,a),n(w.EVENT_COLUMN_PIVOT_CHANGED,t.pivotColumns,this.pivotColumns,a);const u=o((y,R)=>{const x=y.aggFunc!=null,S=x!=R.isValueActive(),T=x&&y.aggFunc!=R.getAggFunc();return S||T});u.length>0&&this.dispatchColumnChangedEvent(w.EVENT_COLUMN_VALUE_CHANGED,u,e);const h=(y,R)=>y.width!=R.getActualWidth();this.dispatchColumnResizedEvent(o(h),!0,e);const p=(y,R)=>y.pinned!=R.getPinned();this.dispatchColumnPinnedEvent(o(p),e);const g=(y,R)=>y.hide==R.isVisible();this.dispatchColumnVisibleEvent(o(g),e);const C=o((y,R)=>y.sort!=R.getSort()||y.sortIndex!=R.getSortIndex());C.length>0&&this.sortController.dispatchSortChangedEvents(e,C),this.normaliseColumnMovedEventForColumnState(s,e)}}getCommonValue(e,t){if(!e||e.length==0)return;const s=t(e[0]);for(let i=1;i<e.length;i++)if(s!==t(e[i]))return;return s}normaliseColumnMovedEventForColumnState(e,t){const s=this.getColumnState(),i={};s.forEach(l=>i[l.colId]=l);const r={};e.forEach(l=>{i[l.colId]&&(r[l.colId]=!0)});const n=e.filter(l=>r[l.colId]),o=s.filter(l=>r[l.colId]),a=[];o.forEach((l,u)=>{const h=n&&n[u];if(h&&h.colId!==l.colId){const p=this.getGridColumn(h.colId);p&&a.push(p)}}),a.length&&this.dispatchColumnMovedEvent({movedColumns:a,source:t,finished:!0})}syncColumnWithStateItem(e,t,s,i,r,n,o){var a;if(!e)return;const l=(I,V)=>{const H={value1:void 0,value2:void 0};let P=!1;return t&&(t[I]!==void 0&&(H.value1=t[I],P=!0),Ce(V)&&t[V]!==void 0&&(H.value2=t[V],P=!0)),!P&&s&&(s[I]!==void 0&&(H.value1=s[I]),Ce(V)&&s[V]!==void 0&&(H.value2=s[V])),H},u=l("hide").value1;u!==void 0&&e.setVisible(!u,o);const h=l("pinned").value1;h!==void 0&&e.setPinned(h);const p=(a=e.getColDef().minWidth)!=null?a:this.environment.getMinColWidth(),g=l("flex").value1;if(g!==void 0&&e.setFlex(g),g==null){const I=l("width").value1;I!=null&&p!=null&&I>=p&&e.setActualWidth(I,o)}const m=l("sort").value1;m!==void 0&&(m==="desc"||m==="asc"?e.setSort(m,o):e.setSort(void 0,o));const C=l("sortIndex").value1;if(C!==void 0&&e.setSortIndex(C),n||!e.isPrimary())return;const y=l("aggFunc").value1;y!==void 0&&(typeof y=="string"?(e.setAggFunc(y),e.isValueActive()||(e.setValueActive(!0,o),this.valueColumns.push(e))):(Ce(y)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,o),Fi(this.valueColumns,e))));const{value1:R,value2:x}=l("rowGroup","rowGroupIndex");(R!==void 0||x!==void 0)&&(typeof x=="number"||R?(e.isRowGroupActive()||(e.setRowGroupActive(!0,o),this.rowGroupColumns.push(e)),i&&typeof x=="number"&&(i[e.getId()]=x)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,o),Fi(this.rowGroupColumns,e)));const{value1:S,value2:T}=l("pivot","pivotIndex");(S!==void 0||T!==void 0)&&(typeof T=="number"||S?(e.isPivotActive()||(e.setPivotActive(!0,o),this.pivotColumns.push(e)),r&&typeof T=="number"&&(r[e.getId()]=T)):e.isPivotActive()&&(e.setPivotActive(!1,o),Fi(this.pivotColumns,e)))}getGridColumns(e){return this.getColumns(e,this.getGridColumn.bind(this))}getColumns(e,t){const s=[];return e&&e.forEach(i=>{const r=t(i);r&&s.push(r)}),s}getColumnWithValidation(e){if(e==null)return null;const t=this.getGridColumn(e);return t||console.warn("AG Grid: could not find column "+e),t}getPrimaryColumn(e){return this.primaryColumns?this.getColumn(e,this.primaryColumns,this.primaryColumnsMap):null}getGridColumn(e){return this.getColumn(e,this.gridColumns,this.gridColumnsMap)}lookupGridColumn(e){return this.gridColumnsMap[e]}getSecondaryColumn(e){return this.secondaryColumns?this.getColumn(e,this.secondaryColumns,this.secondaryColumnsMap):null}getColumn(e,t,s){if(!e||!s)return null;if(typeof e=="string"&&s[e])return s[e];for(let i=0;i<t.length;i++)if(this.columnsMatch(t[i],e))return t[i];return this.getAutoColumn(e)}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(t===!0)return this.rowGroupColumns.slice(0);const s=this.getPrimaryColumn(t);return s?[s]:null}getAutoColumn(e){return!this.groupAutoColumns||!Ce(this.groupAutoColumns)||nt(this.groupAutoColumns)?null:this.groupAutoColumns.find(t=>this.columnsMatch(t,e))||null}columnsMatch(e,t){const s=e===t,i=e.getColDef()===t,r=e.getColId()==t;return s||i||r}getDisplayNameForColumn(e,t,s=!1){if(!e)return null;const i=this.getHeaderName(e.getColDef(),e,null,null,t);return s?this.wrapHeaderNameWithAggFunc(e,i):i}getDisplayNameForProvidedColumnGroup(e,t,s){const i=t?t.getColGroupDef():null;return i?this.getHeaderName(i,null,e,t,s):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,s,i,r){const n=e.headerValueGetter;if(n){const o=this.gos.addGridCommonParams({colDef:e,column:t,columnGroup:s,providedColumnGroup:i,location:r});return typeof n=="function"?n(o):typeof n=="string"?this.expressionService.evaluate(n,o):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}else{if(e.headerName!=null)return e.headerName;if(e.field)return AA(e.field)}return""}wrapHeaderNameWithAggFunc(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const s=e.getColDef().pivotValueColumn,i=Ce(s);let r=null,n;if(i){const o=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&this.valueColumns.length===1,a=e.getColDef().pivotTotalColumnIds!==void 0;if(o&&!a)return t;r=s?s.getAggFunc():null,n=!0}else{const o=e.isValueActive(),a=this.pivotMode||!this.isRowGroupEmpty();o&&a?(r=e.getAggFunc(),n=!0):n=!1}if(n){const o=typeof r=="string"?r:"func";return`${this.localeService.getLocaleTextFunc()(o,o)}(${t})`}return t}getColumnGroup(e,t){if(!e)return null;if(e instanceof Ps)return e;const s=this.getAllDisplayedTrees(),i=typeof t=="number";let r=null;return _a(s,!1,n=>{if(n instanceof Ps){const o=n;let a;i?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(r=o)}}),r}isReady(){return this.ready}extractValueColumns(e,t){this.valueColumns=this.extractColumns(t,this.valueColumns,(s,i)=>s.setValueActive(i,e),()=>{},()=>{},s=>{const i=s.aggFunc;if(i===null||i==="")return null;if(i!==void 0)return!!i},s=>s.initialAggFunc!=null&&s.initialAggFunc!=""),this.valueColumns.forEach(s=>{const i=s.getColDef();i.aggFunc!=null&&i.aggFunc!=""?s.setAggFunc(i.aggFunc):s.getAggFunc()||s.setAggFunc(i.initialAggFunc)})}extractRowGroupColumns(e,t){this.rowGroupColumns=this.extractColumns(t,this.rowGroupColumns,(s,i)=>s.setRowGroupActive(i,e),s=>s.rowGroupIndex,s=>s.initialRowGroupIndex,s=>s.rowGroup,s=>s.initialRowGroup)}extractColumns(e=[],t=[],s,i,r,n,o){const a=[],l=[];(this.primaryColumns||[]).forEach(p=>{const g=e.indexOf(p)<0,m=p.getColDef(),C=Cf(n(m)),y=Cf(o(m)),R=Ko(i(m)),x=Ko(r(m));let S;C!==void 0?S=C:R!==void 0?R===null?S=!1:S=R>=0:g?y!==void 0?S=y:x!==void 0?S=x!=null&&x>=0:S=!1:S=t.indexOf(p)>=0,S&&((g?R!=null||x!=null:R!=null)?a.push(p):l.push(p))});const u=p=>{const g=i(p.getColDef()),m=r(p.getColDef());return g??m};a.sort((p,g)=>{const m=u(p),C=u(g);return m===C?0:m<C?-1:1});const h=[].concat(a);return t.forEach(p=>{l.indexOf(p)>=0&&h.push(p)}),l.forEach(p=>{h.indexOf(p)<0&&h.push(p)}),t.forEach(p=>{h.indexOf(p)<0&&s(p,!1)}),h.forEach(p=>{t.indexOf(p)<0&&s(p,!0)}),h}extractPivotColumns(e,t){this.pivotColumns=this.extractColumns(t,this.pivotColumns,(s,i)=>s.setPivotActive(i,e),s=>s.pivotIndex,s=>s.initialPivotIndex,s=>s.pivot,s=>s.initialPivot)}resetColumnGroupState(e){if(!this.primaryColumnTree)return;const t=[];Hn(null,this.primaryColumnTree,s=>{if(s instanceof vs){const i=s.getColGroupDef(),r={groupId:s.getGroupId(),open:i?i.openByDefault:void 0};t.push(r)}}),this.setColumnGroupState(t,e)}getColumnGroupState(){const e=[];return Hn(null,this.gridBalancedTree,t=>{t instanceof vs&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})}),e}setColumnGroupState(e,t){if(!this.gridBalancedTree)return;this.columnAnimationService.start();const s=[];if(e.forEach(i=>{const r=i.groupId,n=i.open,o=this.getProvidedColumnGroup(r);o&&o.isExpanded()!==n&&(this.logger.log("columnGroupOpened("+o.getGroupId()+","+n+")"),o.setExpanded(n),s.push(o))}),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t),s.length){const i={type:w.EVENT_COLUMN_GROUP_OPENED,columnGroup:vs.length===1?s[0]:void 0,columnGroups:s};this.eventService.dispatchEvent(i)}this.columnAnimationService.finish()}setColumnGroupOpened(e,t,s){let i;e instanceof vs?i=e.getId():i=e||"",this.setColumnGroupState([{groupId:i,open:t}],s)}getProvidedColumnGroup(e){typeof e!="string"&&console.error("AG Grid: group key must be a string");let t=null;return Hn(null,this.gridBalancedTree,s=>{s instanceof vs&&s.getId()===e&&(t=s)}),t}calculateColumnsForDisplay(){let e;return this.pivotMode&&nt(this.secondaryColumns)?e=this.gridColumns.filter(t=>{const s=this.groupAutoColumns&&rr(this.groupAutoColumns,t),i=this.valueColumns&&rr(this.valueColumns,t);return s||i}):e=this.gridColumns.filter(t=>this.groupAutoColumns&&rr(this.groupAutoColumns,t)||t.isVisible()),e}checkColSpanActiveInCols(e){let t=!1;return e.forEach(s=>{Ce(s.getColDef().colSpan)&&(t=!0)}),t}calculateColumnsForGroupDisplay(){this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};const e=t=>{const s=t.getColDef(),i=s.showRowGroup;s&&Ce(i)&&(this.groupDisplayColumns.push(t),typeof i=="string"?this.groupDisplayColumnsMap[i]=t:i===!0&&this.getRowGroupColumns().forEach(r=>{this.groupDisplayColumnsMap[r.getId()]=t}))};this.gridColumns.forEach(e)}getGroupDisplayColumns(){return this.groupDisplayColumns}getGroupDisplayColumnForGroup(e){return this.groupDisplayColumnsMap[e]}updateDisplayedColumns(e){const t=this.calculateColumnsForDisplay();this.buildDisplayedTrees(t),this.updateGroupsAndDisplayedColumns(e),this.setFirstRightAndLastLeftPinned(e)}isSecondaryColumnsPresent(){return Ce(this.secondaryColumns)}setSecondaryColumns(e,t){if(!this.gridColumns)return;const s=e;if(!(!s&&nt(this.secondaryColumns))){if(s){this.processSecondaryColumnDefinitions(e);const i=this.columnFactory.createColumnTree(e,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0,t);this.destroyOldColumns(this.secondaryBalancedTree,i.columnTree),this.secondaryBalancedTree=i.columnTree,this.secondaryHeaderRowCount=i.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(r=>this.secondaryColumnsMap[r.getId()]=r),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(t)}}processSecondaryColumnDefinitions(e){const t=this.gos.get("processPivotResultColDef"),s=this.gos.get("processPivotResultColGroupDef");if(!t&&!s)return;const i=r=>{r.forEach(n=>{if(Ce(n.children)){const a=n;s&&s(a),i(a.children)}else t&&t(n)})};e&&i(e)}updateGridColumns(){const e=this.gridBalancedTree;if(this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns,this.createGroupAutoColumnsIfNeeded()){const i=Po(this.groupAutoColumns.map(r=>[r,!0]));this.lastPrimaryOrder&&(this.lastPrimaryOrder=this.lastPrimaryOrder.filter(r=>!i.has(r)),this.lastPrimaryOrder=[...this.groupAutoColumns,...this.lastPrimaryOrder]),this.lastSecondaryOrder&&(this.lastSecondaryOrder=this.lastSecondaryOrder.filter(r=>!i.has(r)),this.lastSecondaryOrder=[...this.groupAutoColumns,...this.lastSecondaryOrder])}let s;if(this.secondaryColumns&&this.secondaryBalancedTree){const i=this.secondaryColumns.some(r=>this.gridColumnsMap[r.getColId()]!==void 0);this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,i&&(s=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,s=this.lastPrimaryOrder);if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(s),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(i=>this.gridColumnsMap[i.getId()]=i),this.setAutoHeightActive(),!wn(e,this.gridBalancedTree)){const i={type:w.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(i)}}setAutoHeightActive(){this.autoHeightActive=this.gridColumns.filter(e=>e.isAutoHeight()).length>0,this.autoHeightActive&&(this.autoHeightActiveAtLeastOnce=!0,this.gos.isRowModelType("clientSide")||this.gos.isRowModelType("serverSide")||tt("autoHeight columns only work with Client Side Row Model and Server Side Row Model."))}orderGridColsLike(e){if(nt(e))return;const t=Po(e.map((l,u)=>[l,u]));let s=!0;if(this.gridColumns.forEach(l=>{t.has(l)&&(s=!1)}),s)return;const i=Po(this.gridColumns.map(l=>[l,!0])),r=e.filter(l=>i.has(l)),n=Po(r.map(l=>[l,!0])),o=this.gridColumns.filter(l=>!n.has(l)),a=r.slice();o.forEach(l=>{let u=l.getOriginalParent();if(!u){a.push(l);return}const h=[];for(;!h.length&&u;)u.getLeafColumns().forEach(C=>{const y=a.indexOf(C)>=0,R=h.indexOf(C)<0;y&&R&&h.push(C)}),u=u.getOriginalParent();if(!h.length){a.push(l);return}const p=h.map(m=>a.indexOf(m)),g=Math.max(...p);rh(a,l,g+1)}),this.gridColumns=a}isPrimaryColumnGroupsPresent(){return this.primaryHeaderRowCount>1}refreshQuickFilterColumns(){var e;let t=(e=this.isPivotMode()&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?this.secondaryColumns:this.primaryColumns)!=null?e:[];this.groupAutoColumns&&(t=t.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?t:t.filter(s=>s.isVisible()||s.isRowGroupActive())}placeLockedColumns(e){const t=[],s=[],i=[];return e.forEach(r=>{const n=r.getColDef().lockPosition;n==="right"?i.push(r):n==="left"||n===!0?t.push(r):s.push(r)}),[...t,...s,...i]}addAutoGroupToGridColumns(){if(nt(this.groupAutoColumns)){this.destroyOldColumns(this.groupAutoColsBalancedTree),this.groupAutoColsBalancedTree=null;return}this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;const e=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,e),this.groupAutoColsBalancedTree=e,this.gridBalancedTree=e.concat(this.gridBalancedTree)}clearDisplayedAndViewportColumns(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.ariaOrderColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}updateGroupsAndDisplayedColumns(e){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(e),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();const t={type:w.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(t)}deriveDisplayedColumns(e){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinColumnsAriaOrder(),this.joinDisplayedColumns(),this.setLeftValues(e),this.displayedAutoHeightCols=this.displayedColumns.filter(t=>t.isAutoHeight())}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}joinColumnsAriaOrder(){const e=this.getAllGridColumns(),t=[],s=[],i=[];for(const r of e){const n=r.getPinned();n?n===!0||n==="left"?t.push(r):i.push(r):s.push(r)}this.ariaOrderColumns=t.concat(s).concat(i)}joinDisplayedColumns(){this.gos.get("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}setLeftValues(e){this.setLeftValuesOfColumns(e),this.setLeftValuesOfGroups()}setLeftValuesOfColumns(e){if(!this.primaryColumns)return;const t=this.getPrimaryAndSecondaryAndAutoColumns().slice(0),s=this.gos.get("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(i=>{if(s){let r=this.getWidthOfColsInList(i);i.forEach(n=>{r-=n.getActualWidth(),n.setLeft(r,e)})}else{let r=0;i.forEach(n=>{n.setLeft(r,e),r+=n.getActualWidth()})}yA(t,i)}),t.forEach(i=>{i.setLeft(null,e)})}setLeftValuesOfGroups(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(e=>{e.forEach(t=>{t instanceof Ps&&t.checkLeft()})})}derivedDisplayedColumnsFromDisplayedTree(e,t){t.length=0,_a(e,!0,s=>{s instanceof Vt&&t.push(s)})}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}extractViewportColumns(){this.isColumnVirtualisationSuppressed()?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}getVirtualHeaderGroupRow(e,t){let s;switch(e){case"left":s=this.viewportRowLeft[t];break;case"right":s=this.viewportRowRight[t];break;default:s=this.viewportRowCenter[t];break}return nt(s)&&(s=[]),s}calculateHeaderRows(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};const e={};this.headerViewportColumns.forEach(s=>e[s.getId()]=!0);const t=(s,i,r)=>{let n=!1;for(let o=0;o<s.length;o++){const a=s[o];let l=!1;if(a instanceof Vt)l=e[a.getId()]===!0;else{const h=a.getDisplayedChildren();h&&(l=t(h,i,r+1))}l&&(n=!0,i[r]||(i[r]=[]),i[r].push(a))}return n};t(this.displayedTreeLeft,this.viewportRowLeft,0),t(this.displayedTreeRight,this.viewportRowRight,0),t(this.displayedTreeCentre,this.viewportRowCenter,0)}extractViewport(){const e=i=>`${i.getId()}-${i.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.viewportColumns.map(e).join("#"),s=this.viewportColumnsHash!==t;return s&&(this.viewportColumnsHash=t,this.calculateHeaderRows()),s}refreshFlexedColumns(e={}){var t;const s=e.source?e.source:"flex";if(e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];let i=-1;if(e.resizingCols){const g=new Set(e.resizingCols);let m=this.displayedColumnsCenter;for(let C=m.length-1;C>=0;C--)if(g.has(m[C])){i=C;break}}let r=0,n=[],o=0,a=0;for(let g=0;g<this.displayedColumnsCenter.length;g++)this.displayedColumnsCenter[g].getFlex()&&g>i?(n.push(this.displayedColumnsCenter[g]),a+=this.displayedColumnsCenter[g].getFlex(),o+=(t=this.displayedColumnsCenter[g].getMinWidth())!=null?t:0):r+=this.displayedColumnsCenter[g].getActualWidth();if(!n.length)return[];let l=[];r+o>this.flexViewportWidth&&(n.forEach(g=>{var m;return g.setActualWidth((m=g.getMinWidth())!=null?m:0,s)}),l=n,n=[]);const u=[];let h;e:for(;;){h=this.flexViewportWidth-r;const g=h/a;for(let m=0;m<n.length;m++){const C=n[m],y=g*C.getFlex();let R=0;const x=C.getMinWidth(),S=C.getMaxWidth();if(Ce(x)&&y<x?R=x:Ce(S)&&y>S&&(R=S),R){C.setActualWidth(R,s),QS(n,C),a-=C.getFlex(),l.push(C),r+=C.getActualWidth();continue e}u[m]=Math.round(y)}break}let p=h;return n.forEach((g,m)=>{g.setActualWidth(Math.min(u[m],p),s),l.push(g),p-=u[m]}),e.skipSetLeft||this.setLeftValues(s),e.updateBodyWidths&&this.updateBodyWidths(),e.fireResizedEvent&&this.dispatchColumnResizedEvent(l,!0,s,n),n}sizeColumnsToFit(e,t="sizeColumnsToFit",s,i){var r,n,o,a,l;if(this.shouldQueueResizeOperations){this.resizeOperationQueue.push(()=>this.sizeColumnsToFit(e,t,s,i));return}const u={};i&&((r=i==null?void 0:i.columnLimits)==null||r.forEach(x=>{var S=x,{key:T}=S,I=y1(S,["key"]);u[typeof T=="string"?T:T.getColId()]=I}));const h=this.getAllDisplayedColumns(),p=e===this.getWidthOfColsInList(h);if(e<=0||!h.length||p)return;const g=[],m=[];h.forEach(x=>{x.getColDef().suppressSizeToFit===!0?m.push(x):g.push(x)});const C=g.slice(0);let y=!1;const R=x=>{Fi(g,x),m.push(x)};for(g.forEach(x=>{var S,T;x.resetActualWidth(t);const I=u==null?void 0:u[x.getId()],V=(S=I==null?void 0:I.minWidth)!=null?S:i==null?void 0:i.defaultMinWidth,H=(T=I==null?void 0:I.maxWidth)!=null?T:i==null?void 0:i.defaultMaxWidth,P=x.getActualWidth();typeof V=="number"&&P<V?x.setActualWidth(V,t,!0):typeof H=="number"&&P>H&&x.setActualWidth(H,t,!0)});!y;){y=!0;const x=e-this.getWidthOfColsInList(m);if(x<=0)g.forEach(S=>{var T,I;const V=(I=(T=u==null?void 0:u[S.getId()])==null?void 0:T.minWidth)!=null?I:i==null?void 0:i.defaultMinWidth;if(typeof V=="number"){S.setActualWidth(V,t,!0);return}S.setMinimum(t)});else{const S=x/this.getWidthOfColsInList(g);let T=x;for(let I=g.length-1;I>=0;I--){const V=g[I],H=u==null?void 0:u[V.getId()],P=(n=H==null?void 0:H.minWidth)!=null?n:i==null?void 0:i.defaultMinWidth,N=(o=H==null?void 0:H.maxWidth)!=null?o:i==null?void 0:i.defaultMaxWidth,_=(a=V.getMinWidth())!=null?a:0,L=(l=V.getMaxWidth())!=null?l:Number.MAX_VALUE,M=typeof P=="number"&&P>_?P:V.getMinWidth(),b=typeof N=="number"&&N<L?N:V.getMaxWidth();let F=Math.round(V.getActualWidth()*S);Ce(M)&&F<M?(F=M,R(V),y=!1):Ce(b)&&F>b?(F=b,R(V),y=!1):I===0&&(F=T),V.setActualWidth(F,t,!0),T-=F}}}C.forEach(x=>{x.fireColumnWidthChangedEvent(t)}),this.setLeftValues(t),this.updateBodyWidths(),!s&&this.dispatchColumnResizedEvent(C,!0,t)}buildDisplayedTrees(e){const t=[],s=[],i=[];e.forEach(n=>{switch(n.getPinned()){case"left":t.push(n);break;case"right":s.push(n);break;default:i.push(n);break}});const r=new DA;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(t,r,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(s,r,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(i,r,null,this.displayedTreeCentre),this.updateDisplayedMap()}updateDisplayedMap(){this.displayedColumnsAndGroupsMap={};const e=t=>{this.displayedColumnsAndGroupsMap[t.getUniqueId()]=t};_a(this.displayedTreeCentre,!1,e),_a(this.displayedTreeLeft,!1,e),_a(this.displayedTreeRight,!1,e)}isDisplayed(e){return this.displayedColumnsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){const e=this.getAllDisplayedTrees();_a(e,!1,t=>{t instanceof Ps&&t.calculateDisplayedColumns()})}getGroupAutoColumns(){return this.groupAutoColumns}createGroupAutoColumnsIfNeeded(){const e=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;const t=this.gos.isGroupUseEntireRow(this.pivotMode),s=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.gos.get("treeData"))&&!s&&!t){const n=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);if(!this.autoColsEqual(n,this.groupAutoColumns)||e)return this.groupAutoColumns=n,!0}else this.groupAutoColumns=null;return!1}isGroupSuppressAutoColumn(){return this.gos.get("groupDisplayType")==="custom"?!0:this.gos.get("treeDataDisplayType")==="custom"}autoColsEqual(e,t){return wn(e,t,(s,i)=>s.getColId()===i.getColId())}getWidthOfColsInList(e){return e.reduce((t,s)=>t+s.getActualWidth(),0)}getFirstDisplayedColumn(){const e=this.gos.get("enableRtl"),t=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];e&&t.reverse();for(let s=0;s<t.length;s++){const i=this[t[s]]();if(i.length)return e?At(i):i[0]}return null}setColumnHeaderHeight(e,t){if(e.setAutoHeaderHeight(t)){const i={type:w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:e,columns:[e],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(i)}}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.getAllDisplayedColumns().filter(s=>s.isAutoHeaderHeight()).map(s=>s.getAutoHeaderHeight()||0);return Math.max(e,...t)}getHeaderHeight(){var e;return(e=this.gos.get("headerHeight"))!=null?e:this.environment.getFromTheme(25,"headerHeight")}getFloatingFiltersHeight(){var e;return(e=this.gos.get("floatingFiltersHeight"))!=null?e:this.getHeaderHeight()}getGroupHeaderHeight(){var e;return(e=this.gos.get("groupHeaderHeight"))!=null?e:this.getHeaderHeight()}getPivotHeaderHeight(){var e;return(e=this.gos.get("pivotHeaderHeight"))!=null?e:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var e;return(e=this.gos.get("pivotGroupHeaderHeight"))!=null?e:this.getGroupHeaderHeight()}queueResizeOperations(){this.shouldQueueResizeOperations=!0}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}resetColumnDefIntoColumn(e,t){const s=e.getUserProvidedColDef();if(!s)return!1;const i=this.columnFactory.addColumnDefaultAndTypes(s,e.getColId());return e.setColDef(i,s,t),!0}isColumnGroupingLocked(e){const t=this.gos.get("groupLockGroupColumns");if(!e.isRowGroupActive()||t===0)return!1;if(t===-1)return!0;const s=this.rowGroupColumns.findIndex(i=>i.getColId()===e.getColId());return t>s}generateColumnStateForRowGroupAndPivotIndexes(e,t){let s={};const i=(r,n,o,a,l,u)=>{if(!n.length||!this.primaryColumns)return[];const h=Object.keys(r),p=new Set(h),g=new Set(h),m=new Set(n.map(V=>{const H=V.getColId();return g.delete(H),H}).concat(h)),C=[],y={};let R=0;for(let V=0;V<this.primaryColumns.length;V++){const H=this.primaryColumns[V].getColId();m.has(H)&&(C.push(H),y[H]=R++)}let x=1e3,S=!1,T=0;const I=V=>{const H=y[V];for(let P=T;P<H;P++){const N=C[P];g.has(N)&&(r[N][l]=x++,g.delete(N))}T=H};n.forEach(V=>{const H=V.getColId();if(p.has(H))I(H),r[H][l]=x++;else{const P=V.getColDef();(P[l]===null||P[l]===void 0&&P[u]==null)&&(S||(P[o]||P[o]===void 0&&P[a]?I(H):(g.forEach(L=>{r[L][l]=x+y[L]}),x+=C.length,S=!0)),s[H]||(s[H]={colId:H}),s[H][l]=x++)}})};return i(e,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(s)}onColumnsReady(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout(()=>{if(t==="fitGridWidth"){const{columnLimits:s,defaultMinWidth:i,defaultMaxWidth:r}=e,n=s==null?void 0:s.map(({colId:o,minWidth:a,maxWidth:l})=>({key:o,minWidth:a,maxWidth:l}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:i,defaultMaxWidth:r,columnLimits:n})}else t==="fitProvidedWidth"&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")})}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if((e==null?void 0:e.type)!=="fitCellContents")return;const{colIds:t,skipHeader:s}=e;setTimeout(()=>{t?this.autoSizeColumns({columns:t,skipHeader:s,source:"autosizeColumns"}):this.autoSizeAllColumns("autosizeColumns",s)})}};f([A("expressionService")],Ls.prototype,"expressionService",2);f([A("columnFactory")],Ls.prototype,"columnFactory",2);f([A("displayedGroupCreator")],Ls.prototype,"displayedGroupCreator",2);f([A("ctrlsService")],Ls.prototype,"ctrlsService",2);f([A("autoWidthCalculator")],Ls.prototype,"autoWidthCalculator",2);f([A("columnAnimationService")],Ls.prototype,"columnAnimationService",2);f([A("autoGroupColService")],Ls.prototype,"autoGroupColService",2);f([A("valueCache")],Ls.prototype,"valueCache",2);f([A("animationFrameService")],Ls.prototype,"animationFrameService",2);f([A("sortController")],Ls.prototype,"sortController",2);f([A("columnDefFactory")],Ls.prototype,"columnDefFactory",2);f([Lt("aggFuncService")],Ls.prototype,"aggFuncService",2);f([Ee],Ls.prototype,"init",1);f([Si],Ls.prototype,"destroyColumns",1);f([Yr(0,Sr("loggerFactory"))],Ls.prototype,"setBeans",1);Ls=f([je("columnModel")],Ls);function gc(e){return e==="gridOptionsUpdated"?"gridOptionsChanged":e}function _a(e,t,s){if(e)for(let i=0;i<e.length;i++){const r=e[i];if(r instanceof Ps){const n=t?r.getDisplayedChildren():r.getChildren();_a(n,t,s)}s(r)}}var Yy=class extends xe{createDisplayedGroups(e,t,s,i){const r=this.mapOldGroupsById(i),n=[];let o=e;for(;o.length;){const a=o;o=[];let l=0;const u=h=>{const p=l;l=h;const g=a[p],C=(g instanceof Ps?g.getProvidedColumnGroup():g).getOriginalParent();if(C==null){for(let R=p;R<h;R++)n.push(a[R]);return}const y=this.createColumnGroup(C,t,r,s);for(let R=p;R<h;R++)y.addChild(a[R]);o.push(y)};for(let h=1;h<a.length;h++){const p=a[h],m=(p instanceof Ps?p.getProvidedColumnGroup():p).getOriginalParent(),C=a[l],R=(C instanceof Ps?C.getProvidedColumnGroup():C).getOriginalParent();m!==R&&u(h)}l<a.length&&u(a.length)}return this.setupParentsIntoColumns(n,null),n}createColumnGroup(e,t,s,i){const r=e.getGroupId(),n=t.getInstanceIdForKey(r),o=Ps.createUniqueId(r,n);let a=s[o];return a&&a.getProvidedColumnGroup()!==e&&(a=null),Ce(a)?a.reset():(a=new Ps(e,r,n,i),this.context.createBean(a)),a}mapOldGroupsById(e){const t={},s=i=>{i.forEach(r=>{if(r instanceof Ps){const n=r;t[r.getUniqueId()]=n,s(n.getChildren())}})};return e&&s(e),t}setupParentsIntoColumns(e,t){e.forEach(s=>{if(s.setParent(t),s instanceof Ps){const i=s;this.setupParentsIntoColumns(i.getChildren(),i)}})}};Yy=f([je("displayedGroupCreator")],Yy);var B1={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,excludeHiddenColumnsFromQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,enableChartToolPanelsButton:!0,suppressChartToolPanelsButton:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressParentsInRowNodes:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,suppressAggAtRootLevel:!0,removePivotHeaderRowWhenSingleValueColumn:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,functionsPassive:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0},Es=class{};Es.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"];Es.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy"];Es.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"];Es.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"];Es.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilterAllLevels","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval"];Es.OTHER_PROPERTIES=["suppressStickyTotalRow"];Es.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher"];Es.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"];Es.FUNCTION_PROPERTIES=[...Es.FUNCTIONAL_PROPERTIES,...Es.CALLBACK_PROPERTIES];Es.ALL_PROPERTIES=[...Es.ARRAY_PROPERTIES,...Es.OBJECT_PROPERTIES,...Es.STRING_PROPERTIES,...Es.NUMBER_PROPERTIES,...Es.FUNCTION_PROPERTIES,...Es.BOOLEAN_PROPERTIES,...Es.OTHER_PROPERTIES];var ah=Es,zs=class Tg{static getCallbackForEvent(t){return!t||t.length<2?t:"on"+t[0].toUpperCase()+t.substring(1)}static getGridOptionKeys(){return this.ALL_PROPERTIES_AND_CALLBACKS}static combineAttributesAndGridOptions(t,s){typeof t!="object"&&(t={});const i=Je({},t);return Tg.getGridOptionKeys().forEach(n=>{const o=s[n];typeof o<"u"&&o!==Tg.VUE_OMITTED_PROPERTY&&(i[n]=o)}),i}static processOnChange(t,s,i){if(!t)return;const r={};let n=!1;if(Object.keys(t).filter(a=>Tg.ALL_PROPERTIES_AND_CALLBACKS_SET.has(a)).forEach(a=>{r[a]=t[a],n=!0}),!n)return;s.__internalUpdateGridOptions(r,!0);const o={type:w.EVENT_COMPONENT_STATE_CHANGED};ei(r,(a,l)=>{o[a]=l}),s.dispatchEvent(o)}};zs.EVENTS=il(w);zs.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY";zs.EXCLUDED_INTERNAL_EVENTS=[w.EVENT_SCROLLBAR_WIDTH_CHANGED,w.EVENT_CHECKBOX_CHANGED,w.EVENT_HEIGHT_SCALE_CHANGED,w.EVENT_BODY_HEIGHT_CHANGED,w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,w.EVENT_SCROLL_VISIBILITY_CHANGED,w.EVENT_COLUMN_HOVER_CHANGED,w.EVENT_FLASH_CELLS,w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,w.EVENT_DISPLAYED_ROWS_CHANGED,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,w.EVENT_STORE_UPDATED,w.EVENT_COLUMN_PANEL_ITEM_DRAG_START,w.EVENT_COLUMN_PANEL_ITEM_DRAG_END,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,w.EVENT_FULL_WIDTH_ROW_FOCUSED,w.EVENT_HEADER_HEIGHT_CHANGED,w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,w.EVENT_CELL_FOCUS_CLEARED,w.EVENT_GRID_STYLES_CHANGED,w.EVENT_FILTER_DESTROYED,w.EVENT_ROW_DATA_UPDATE_STARTED,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,w.EVENT_DATA_TYPES_INFERRED,w.EVENT_FIELD_VALUE_CHANGED,w.EVENT_FIELD_PICKER_VALUE_SELECTED,w.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,w.EVENT_SUPPRESS_MENU_HIDE_CHANGED,w.EVENT_SUPPRESS_FIELD_DOT_NOTATION,w.EVENT_ROW_COUNT_READY,w.EVENT_SIDE_BAR_UPDATED];zs.PUBLIC_EVENTS=zs.EVENTS.filter(e=>!rr(zs.EXCLUDED_INTERNAL_EVENTS,e));zs.EVENT_CALLBACKS=zs.EVENTS.map(e=>zs.getCallbackForEvent(e));zs.BOOLEAN_PROPERTIES=ah.BOOLEAN_PROPERTIES;zs.ALL_PROPERTIES=ah.ALL_PROPERTIES;zs.ALL_PROPERTIES_AND_CALLBACKS=[...zs.ALL_PROPERTIES,...zs.EVENT_CALLBACKS];zs.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(zs.ALL_PROPERTIES_AND_CALLBACKS);var Ef=zs,qy=class extends xe{constructor(){super(...arguments),this.componentsMappedByName={}}setupComponents(e){e&&e.forEach(t=>this.addComponent(t))}addComponent(e){const s=e.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[s]=e.componentClass}getComponentClass(e){return this.componentsMappedByName[e]}};qy=f([je("agStackComponentsRegistry")],qy);var NA={};Os(NA,{getAriaCheckboxStateName:()=>Gm,getAriaLabel:()=>LA,getAriaLevel:()=>H1,getAriaPosInSet:()=>MA,getAriaSortState:()=>kA,removeAriaExpanded:()=>BA,removeAriaSort:()=>$A,setAriaActiveDescendant:()=>t0,setAriaAtomic:()=>OA,setAriaChecked:()=>W1,setAriaColCount:()=>WA,setAriaColIndex:()=>i0,setAriaColSpan:()=>zA,setAriaControls:()=>r0,setAriaDescribedBy:()=>j1,setAriaDisabled:()=>e0,setAriaExpanded:()=>Jn,setAriaHidden:()=>ap,setAriaLabel:()=>or,setAriaLabelledBy:()=>Uc,setAriaLevel:()=>VA,setAriaLive:()=>XS,setAriaMultiSelectable:()=>HA,setAriaPosInSet:()=>Om,setAriaRelevant:()=>GA,setAriaRole:()=>cs,setAriaRowCount:()=>jA,setAriaRowIndex:()=>s0,setAriaSelected:()=>$c,setAriaSetSize:()=>Lm,setAriaSort:()=>UA});function Ir(e,t,s){s==null||typeof s=="string"&&s==""?JS(e,t):Nr(e,t,s)}function Nr(e,t,s){e.setAttribute(_A(t),s.toString())}function JS(e,t){e.removeAttribute(_A(t))}function _A(e){return`aria-${e}`}function cs(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function kA(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function H1(e){return parseInt(e.getAttribute("aria-level"),10)}function MA(e){return parseInt(e.getAttribute("aria-posinset"),10)}function LA(e){return e.getAttribute("aria-label")}function or(e,t){Ir(e,"label",t)}function Uc(e,t){Ir(e,"labelledby",t)}function j1(e,t){Ir(e,"describedby",t)}function XS(e,t){Ir(e,"live",t)}function OA(e,t){Ir(e,"atomic",t)}function GA(e,t){Ir(e,"relevant",t)}function VA(e,t){Ir(e,"level",t)}function e0(e,t){Ir(e,"disabled",t)}function ap(e,t){Ir(e,"hidden",t)}function t0(e,t){Ir(e,"activedescendant",t)}function Jn(e,t){Nr(e,"expanded",t)}function BA(e){JS(e,"expanded")}function Lm(e,t){Nr(e,"setsize",t)}function Om(e,t){Nr(e,"posinset",t)}function HA(e,t){Nr(e,"multiselectable",t)}function jA(e,t){Nr(e,"rowcount",t)}function s0(e,t){Nr(e,"rowindex",t)}function WA(e,t){Nr(e,"colcount",t)}function i0(e,t){Nr(e,"colindex",t)}function zA(e,t){Nr(e,"colspan",t)}function UA(e,t){Nr(e,"sort",t)}function $A(e){JS(e,"sort")}function $c(e,t){Ir(e,"selected",t)}function W1(e,t){Nr(e,"checked",t===void 0?"mixed":t)}function r0(e,t){Ir(e,"controls",t.id),Uc(t,e.id)}function Gm(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var KA={};Os(KA,{browserSupportsPreventScroll:()=>l0,getBodyHeight:()=>QA,getBodyWidth:()=>qA,getMaxDivHeight:()=>YA,getSafariVersion:()=>n0,getScrollbarWidth:()=>ZA,getTabIndex:()=>bf,isBrowserChrome:()=>Vm,isBrowserFirefox:()=>o0,isBrowserSafari:()=>Pn,isIOSUserAgent:()=>ao,isInvisibleScrollbar:()=>c0,isMacOsUserAgent:()=>a0});var oC,ig,aC,lC,cC,uC,Qy,Zy;function Pn(){return oC===void 0&&(oC=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),oC}function n0(){if(ig===void 0)if(Pn()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(ig=e[1]!=null?parseFloat(e[1]):0)}else ig=0;return ig}function Vm(){if(aC===void 0){const e=window;aC=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return aC}function o0(){return lC===void 0&&(lC=/(firefox)/i.test(navigator.userAgent)),lC}function a0(){return cC===void 0&&(cC=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),cC}function ao(){return uC===void 0&&(uC=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),uC}function l0(){return!Pn()||n0()>=15}function bf(e){if(!e)return null;const t=e.tabIndex,s=e.getAttribute("tabIndex");return t===-1&&(s===null||s===""&&!o0())?null:t.toString()}function YA(){if(!document.body)return-1;let e=1e6;const t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,s=document.createElement("div");for(document.body.appendChild(s);;){const i=e*2;if(s.style.height=i+"px",i>t||s.clientHeight!==i)break;e=i}return document.body.removeChild(s),e}function qA(){var e,t,s;return(s=(e=document.body)==null?void 0:e.clientWidth)!=null?s:window.innerHeight||((t=document.documentElement)==null?void 0:t.clientWidth)||-1}function QA(){var e,t,s;return(s=(e=document.body)==null?void 0:e.clientHeight)!=null?s:window.innerHeight||((t=document.documentElement)==null?void 0:t.clientHeight)||-1}function ZA(){return Zy==null&&JA(),Zy}function JA(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let s=t.offsetWidth-t.clientWidth;s===0&&t.clientWidth===0&&(s=null),t.parentNode&&t.parentNode.removeChild(t),s!=null&&(Zy=s,Qy=s===0)}function c0(){return Qy==null&&JA(),Qy}var XA={};Os(XA,{dateToFormattedString:()=>Rc,parseDateTimeFromString:()=>Li,serialiseDate:()=>br});var eF={};Os(eF,{cleanNumber:()=>z1,createArrayOfNumbers:()=>tF,decToHex:()=>U1,formatNumberCommas:()=>u0,formatNumberTwoDecimalPlacesAndCommas:()=>$1,padStartWidthZeros:()=>bc,sum:()=>K1});function bc(e,t){return e.toString().padStart(t,"0")}function tF(e,t){const s=[];for(let i=e;i<=t;i++)s.push(i);return s}function z1(e){return typeof e=="string"&&(e=parseInt(e,10)),typeof e=="number"?Math.floor(e):null}function U1(e,t){let s="";for(let i=0;i<t;i++)s+=String.fromCharCode(e&255),e>>>=8;return s}function $1(e,t,s){return typeof e!="number"?"":u0(Math.round(e*100)/100,t,s)}function u0(e,t,s){return typeof e!="number"?"":e.toString().replace(".",s).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${t}`)}function K1(e){return e==null?null:e.reduce((t,s)=>t+s,0)}function br(e,t=!0,s="-"){if(!e)return null;let i=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(r=>bc(r,2)).join(s);return t&&(i+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(r=>bc(r,2)).join(":")),i}var dC=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function Rc(e,t="YYYY-MM-DD"){const s=bc(e.getFullYear(),4),i=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={YYYY:()=>s.slice(s.length-4,s.length),YY:()=>s.slice(s.length-2,s.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>i[e.getMonth()],MMM:()=>i[e.getMonth()].slice(0,3),MM:()=>bc(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${dC(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${dC(e.getDate())}`,DD:()=>bc(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>r[e.getDay()],ddd:()=>r[e.getDay()].slice(0,3),dd:()=>r[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${dC(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(n).join("|"),"g");return t.replace(o,a=>a in n?n[a]():a)}function Li(e){if(!e)return null;const[t,s]=e.split(" ");if(!t)return null;const i=t.split("-").map(p=>parseInt(p,10));if(i.filter(p=>!isNaN(p)).length!==3)return null;const[r,n,o]=i,a=new Date(r,n-1,o);if(a.getFullYear()!==r||a.getMonth()!==n-1||a.getDate()!==o)return null;if(!s||s==="00:00:00")return a;const[l,u,h]=s.split(":").map(p=>parseInt(p,10));return l>=0&&l<24&&a.setHours(l),u>=0&&u<60&&a.setMinutes(u),h>=0&&h<60&&a.setSeconds(h),a}var sF={};Os(sF,{FOCUSABLE_EXCLUDE:()=>d0,FOCUSABLE_SELECTOR:()=>iF,addOrRemoveAttribute:()=>Tn,addStylesToElement:()=>C0,bindCellRendererToHtmlElement:()=>w0,clearElement:()=>fs,copyNodeList:()=>lF,ensureDomOrder:()=>m0,formatSize:()=>Bm,getAbsoluteHeight:()=>p0,getAbsoluteWidth:()=>lh,getElementRectWithOffset:()=>g0,getElementSize:()=>da,getInnerHeight:()=>lp,getInnerWidth:()=>Il,getScrollLeft:()=>uh,insertWithDomOrder:()=>nF,isElementChildOfClass:()=>rl,isFocusableFormField:()=>h0,isHorizontalScrollShowing:()=>oF,isInDOM:()=>f0,isNodeOrElement:()=>cp,isRtlNegativeScroll:()=>ch,isVerticalScrollShowing:()=>aF,isVisible:()=>ji,iterateNamedNodeMap:()=>cF,loadTemplate:()=>Oi,nodeListForEach:()=>y0,radioCssClass:()=>Jy,removeFromParent:()=>qr,setDisabled:()=>Kc,setDisplayed:()=>Et,setDomChildOrder:()=>v0,setElementHeight:()=>Y1,setElementWidth:()=>hh,setFixedHeight:()=>nl,setFixedWidth:()=>Rr,setScrollLeft:()=>dh,setVisible:()=>rF});var rg;function Jy(e,t,s){const i=e.parentElement;let r=i&&i.firstChild;for(;r;)t&&r.classList.toggle(t,r===e),s&&r.classList.toggle(s,r!==e),r=r.nextSibling}var iF="[tabindex], input, select, button, textarea, [href]",d0="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function h0(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),r=t.call(e,d0),n=ji(e);return i&&!r&&n}function Et(e,t,s={}){const{skipAriaHidden:i}=s;e.classList.toggle("ag-hidden",!t),i||ap(e,!t)}function rF(e,t,s={}){const{skipAriaHidden:i}=s;e.classList.toggle("ag-invisible",!t),i||ap(e,!t)}function Kc(e,t){const s="disabled",i=t?r=>r.setAttribute(s,""):r=>r.removeAttribute(s);i(e),y0(e.querySelectorAll("input"),r=>i(r))}function rl(e,t,s){let i=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof s=="number"){if(++i>s)break}else if(e===s)break}return!1}function da(e){const{height:t,width:s,borderTopWidth:i,borderRightWidth:r,borderBottomWidth:n,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:u,paddingLeft:h,marginTop:p,marginRight:g,marginBottom:m,marginLeft:C,boxSizing:y}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(s||"0"),borderTopWidth:parseFloat(i||"0"),borderRightWidth:parseFloat(r||"0"),borderBottomWidth:parseFloat(n||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(u||"0"),paddingLeft:parseFloat(h||"0"),marginTop:parseFloat(p||"0"),marginRight:parseFloat(g||"0"),marginBottom:parseFloat(m||"0"),marginLeft:parseFloat(C||"0"),boxSizing:y}}function lp(e){const t=da(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom:t.height}function Il(e){const t=da(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight:t.width}function p0(e){const t=da(e),s=t.marginBottom+t.marginTop;return Math.ceil(e.offsetHeight+s)}function lh(e){const t=da(e),s=t.marginLeft+t.marginRight;return Math.ceil(e.offsetWidth+s)}function g0(e){const t=e.getBoundingClientRect(),{borderTopWidth:s,borderLeftWidth:i,borderRightWidth:r,borderBottomWidth:n}=da(e);return{top:t.top+(s||0),left:t.left+(i||0),right:t.right+(r||0),bottom:t.bottom+(n||0)}}function ch(){if(typeof rg=="boolean")return rg;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML=`<div style="width: 2px">
            <span style="display: inline-block; width: 1px"></span>
            <span style="display: inline-block; width: 1px"></span>
        </div>`,document.body.appendChild(e),e.scrollLeft=1,rg=Math.floor(e.scrollLeft)===0,document.body.removeChild(e),rg}function uh(e,t){let s=e.scrollLeft;return t&&(s=Math.abs(s),Vm()&&!ch()&&(s=e.scrollWidth-e.clientWidth-s)),s}function dh(e,t,s){s&&(ch()?t*=-1:(Pn()||Vm())&&(t=e.scrollWidth-e.clientWidth-t)),e.scrollLeft=t}function fs(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function qr(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function f0(e){return!!e.offsetParent}function ji(e){const t=e;return t.checkVisibility?t.checkVisibility({checkVisibilityCSS:!0}):!(!f0(e)||window.getComputedStyle(e).visibility!=="visible")}function Oi(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function m0(e,t,s){s&&s.nextSibling===t||(s?s.nextSibling?e.insertBefore(t,s.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t))}function v0(e,t){for(let s=0;s<t.length;s++){const i=t[s],r=e.children[s];r!==i&&e.insertBefore(i,r)}}function nF(e,t,s){s?s.insertAdjacentElement("afterend",t):e.firstChild?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}function C0(e,t){if(t)for(const[s,i]of Object.entries(t)){if(!s||!s.length||i==null)continue;const r=FA(s),n=i.toString(),o=n.replace(/\s*!important/g,""),a=o.length!=n.length?"important":void 0;e.style.setProperty(r,o,a)}}function oF(e){return e.clientWidth<e.scrollWidth}function aF(e){return e.clientHeight<e.scrollHeight}function hh(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Rr(e,t)}function Rr(e,t){t=Bm(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function Y1(e,t){t==="flex"?(e.style.removeProperty("height"),e.style.removeProperty("minHeight"),e.style.removeProperty("maxHeight"),e.style.flex="1 1 auto"):nl(e,t)}function nl(e,t){t=Bm(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function Bm(e){return typeof e=="number"?`${e}px`:e}function cp(e){return e instanceof Node||e instanceof HTMLElement}function lF(e){if(e==null)return[];const t=[];return y0(e,s=>t.push(s)),t}function cF(e,t){if(e)for(let s=0;s<e.length;s++){const i=e[s];t(i.name,i.value)}}function Tn(e,t,s){s==null?e.removeAttribute(t):e.setAttribute(t,s.toString())}function y0(e,t){if(e!=null)for(let s=0;s<e.length;s++)t(e[s])}function w0(e,t){e.then(s=>{const i=s.getGui();i!=null&&(typeof i=="object"?t.appendChild(i):t.innerHTML=i)})}var uF={};Os(uF,{fuzzyCheckStrings:()=>dF,fuzzySuggestions:()=>up});function dF(e,t,s){const i={},r=e.filter(n=>!t.some(o=>o===n));return r.length>0&&r.forEach(n=>i[n]=up(n,s).values),i}function up(e,t,s,i){let r=t.map((a,l)=>({value:a,relevance:q1(e.toLowerCase(),a.toLocaleLowerCase()),idx:l}));if(r.sort((a,l)=>l.relevance-a.relevance),s&&(r=r.filter(a=>a.relevance!==0)),r.length>0&&i&&i>0){const l=r[0].relevance*i;r=r.filter(u=>l-u.relevance<0)}const n=[],o=[];for(const a of r)n.push(a.value),o.push(a.idx);return{values:n,indices:o}}function q1(e,t){const s=e.replace(/\s/g,""),i=t.replace(/\s/g,"");let r=0,n=-1;for(let o=0;o<s.length;o++){const a=i.indexOf(s[o],n+1);a!==-1&&(n=a,r+=100-n*100/1e4*100)}return r}var hF={};Os(hF,{createIcon:()=>fr,createIconNoSpan:()=>rs,iconNameClassMap:()=>pF});var pF={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus"};function fr(e,t,s){const i=rs(e,t,s);if(i){const{className:n}=i;if(typeof n=="string"&&n.indexOf("ag-icon")>-1||typeof n=="object"&&n["ag-icon"])return i}const r=document.createElement("span");return r.appendChild(i),r}function rs(e,t,s,i){let r=null;const n=s&&s.getColDef().icons;if(n&&(r=n[e]),t&&!r){const o=t.get("icons");o&&(r=o[e])}if(r){let o;if(typeof r=="function")o=r();else if(typeof r=="string")o=r;else throw new Error("icon from grid options needs to be a string or a function");if(typeof o=="string")return Oi(o);if(cp(o))return o;console.warn("AG Grid: iconRenderer should return back a string or a dom object")}else{const o=document.createElement("span");let a=pF[e];return a||(i?a=e:(console.warn(`AG Grid: Did not find icon ${e}`),a="")),o.setAttribute("class",`ag-icon ag-icon-${a}`),o.setAttribute("unselectable","on"),cs(o,"presentation"),o}}var gF={};Os(gF,{isDeleteKey:()=>vF,isEventFromPrintableCharacter:()=>Hm,isUserSuppressingHeaderKeyboardEvent:()=>fF,isUserSuppressingKeyboardEvent:()=>Rf,normaliseQwertyAzerty:()=>mF});var z=class{};z.BACKSPACE="Backspace";z.TAB="Tab";z.ENTER="Enter";z.ESCAPE="Escape";z.SPACE=" ";z.LEFT="ArrowLeft";z.UP="ArrowUp";z.RIGHT="ArrowRight";z.DOWN="ArrowDown";z.DELETE="Delete";z.F2="F2";z.PAGE_UP="PageUp";z.PAGE_DOWN="PageDown";z.PAGE_HOME="Home";z.PAGE_END="End";z.A="KeyA";z.C="KeyC";z.D="KeyD";z.V="KeyV";z.X="KeyX";z.Y="KeyY";z.Z="KeyZ";var Q1=65,Z1=67,J1=86,X1=68,eO=90,tO=89;function Hm(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key.length===1}function Rf(e,t,s,i,r){const n=i?i.getColDef().suppressKeyboardEvent:void 0;if(!n)return!1;const o=e.addGridCommonParams({event:t,editing:r,column:i,node:s,data:s.data,colDef:i.getColDef()});return!!(n&&n(o))}function fF(e,t,s,i){const r=i.getDefinition(),n=r&&r.suppressHeaderKeyboardEvent;if(!Ce(n))return!1;const o=e.addGridCommonParams({colDef:r,column:i,headerRowIndex:s,event:t});return!!n(o)}function mF(e){const{keyCode:t}=e;let s;switch(t){case Q1:s=z.A;break;case Z1:s=z.C;break;case J1:s=z.V;break;case X1:s=z.D;break;case eO:s=z.Z;break;case tO:s=z.Y;break;default:s=e.code}return s}function vF(e,t=!1){return e===z.DELETE?!0:!t&&e===z.BACKSPACE?a0():!1}var CF={};Os(CF,{areEventsNear:()=>S0});function S0(e,t,s){if(s===0)return!1;const i=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(i,r)<=s}var yF={};Os(yF,{sortRowNodesByOrder:()=>sO});function sO(e,t){if(!e)return!1;const s=(o,a)=>{const l=t[o.id],u=t[a.id],h=l!==void 0,p=u!==void 0,g=h&&p,m=!h&&!p;return g?l-u:m?o.__objectId-a.__objectId:h?1:-1};let i,r,n=!1;for(let o=0;o<e.length-1;o++)if(i=e[o],r=e[o+1],s(i,r)>0){n=!0;break}return n?(e.sort(s),!0):!1}var wF={};Os(wF,{convertToSet:()=>x0});function x0(e){const t=new Set;return e.forEach(s=>t.add(s)),t}var iO=Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je(Je({},NA),mA),KA),XA),sF),fA),aA),uF),rA),hF),gF),IA),CF),eF),nA),yF),wF),PA),rt=iO,Yc=class{constructor(e=0,t=1){this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}},ws=class Dg{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(s=>this.onDone(s),s=>this.onReject(s))}static all(t){return new Dg(s=>{let i=t.length;const r=new Array(i);t.forEach((n,o)=>{n.then(a=>{r[o]=a,i--,i===0&&s(r)})})})}static resolve(t=null){return new Dg(s=>s(t))}then(t){return new Dg(s=>{this.status===1?s(t(this.resolution)):this.waiters.push(i=>s(t(i)))})}resolveNow(t,s){return this.status===1?s(this.resolution):t}onDone(t){this.status=1,this.resolution=t,this.waiters.forEach(s=>s(t))}onReject(t){console.warn("TBI")}},dp=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1){t.forEach(i=>this.addCssClass(i));return}if(this.cssClassStates[e]!==!0&&e.length){const i=this.getGui();i&&i.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1){t.forEach(i=>this.removeCssClass(i));return}if(this.cssClassStates[e]!==!1&&e.length){const i=this.getGui();i&&i.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return t?t.classList.contains(e):!1}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const i=(e||"").split(" ");if(i.length>1){i.forEach(r=>this.addOrRemoveCssClass(r,t));return}}if(this.cssClassStates[e]!==t&&e.length){const i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}},hp=class ka extends xe{constructor(t,s,i,r){super(),this.parentComp=t,this.tooltipShowDelayOverride=s,this.tooltipHideDelayOverride=i,this.shouldDisplayTooltip=r,this.SHOW_QUICK_TOOLTIP_DIFF=1e3,this.FADE_OUT_TOOLTIP_TIMEOUT=1e3,this.INTERACTIVE_HIDE_DELAY=100,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const t=this.parentComp.getGui();this.tooltipTrigger===0&&(this.addManagedListener(t,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(t,"mouseleave",this.onMouseLeave.bind(this))),this.tooltipTrigger===1&&(this.addManagedListener(t,"focusin",this.onFocusIn.bind(this)),this.addManagedListener(t,"focusout",this.onFocusOut.bind(this))),this.addManagedListener(t,"mousemove",this.onMouseMove.bind(this)),this.interactionEnabled||(this.addManagedListener(t,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(t,"keydown",this.onKeyDown.bind(this)))}getGridOptionsTooltipDelay(t){const s=this.gos.get(t);return s<0&&tt(`${t} should not be lower than 0`),Math.max(200,s)}getTooltipDelay(t){var s,i;return t==="show"?(s=this.tooltipShowDelayOverride)!=null?s:this.getGridOptionsTooltipDelay("tooltipShowDelay"):(i=this.tooltipHideDelayOverride)!=null?i:this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const t=this.gos.get("tooltipTrigger");return!t||t==="hover"?0:1}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!ao()&&(ka.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(t)},this.INTERACTIVE_HIDE_DELAY):this.prepareToShowTooltip(t))}onMouseMove(t){this.lastMouseEvent&&(this.lastMouseEvent=t),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(t){var s;const i=t.relatedTarget,r=this.parentComp.getGui(),n=(s=this.tooltipComp)==null?void 0:s.getGui();this.isInteractingWithTooltip||r.contains(i)||this.interactionEnabled&&(n!=null&&n.contains(i))||this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}prepareToShowTooltip(t){if(this.state!=0||ka.isLocked)return;let s=0;t&&(s=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),s),this.state=1}isLastTooltipHiddenRecently(){const t=new Date().getTime(),s=ka.lastTooltipHideTime;return t-s<this.SHOW_QUICK_TOOLTIP_DIFF}setToDoNothing(){this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const t=Je({},this.parentComp.getTooltipParams());if(!Ce(t.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip()){this.setToDoNothing();return}this.state=2,this.tooltipInstanceCount++;const s=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(t).newAgStackInstance().then(s)}hideTooltip(t){if(!t&&this.isInteractingWithTooltip)return;this.tooltipComp&&(this.destroyTooltipComp(),ka.lastTooltipHideTime=new Date().getTime());const s={type:w.EVENT_TOOLTIP_HIDE,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(s),this.state=0}newTooltipComponentCallback(t,s){if(this.state!==2||this.tooltipInstanceCount!==t){this.getContext().destroyBean(s);return}const r=s.getGui();this.tooltipComp=s,r.classList.contains("ag-tooltip")||r.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&r.classList.add("ag-tooltip-animate"),this.interactionEnabled&&r.classList.add("ag-tooltip-interactive");const n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({eChild:r,ariaLabel:n("ariaLabelTooltip","Tooltip")});o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1&&(this.onBodyScrollEventCallback=this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,this.setToDoNothing.bind(this)),this.onColumnMovedEventCallback=this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,this.setToDoNothing.bind(this))),this.interactionEnabled&&(this.tooltipTrigger===0?(this.tooltipMouseEnterListener=this.addManagedListener(r,"mouseenter",this.onTooltipMouseEnter.bind(this))||null,this.tooltipMouseLeaveListener=this.addManagedListener(r,"mouseleave",this.onTooltipMouseLeave.bind(this))||null):(this.tooltipFocusInListener=this.addManagedListener(r,"focusin",this.onTooltipFocusIn.bind(this))||null,this.tooltipFocusOutListener=this.addManagedListener(r,"focusout",this.onTooltipFocusOut.bind(this))||null));const a={type:w.EVENT_TOOLTIP_SHOW,tooltipGui:r,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(a),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isInteractingWithTooltip=!1,this.lockService()}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}onTooltipFocusOut(t){var s;const i=this.parentComp.getGui(),r=(s=this.tooltipComp)==null?void 0:s.getGui(),n=t.relatedTarget;r!=null&&r.contains(n)||(this.isInteractingWithTooltip=!1,i.contains(n)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const t={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(Jt(Je({},t),{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(Jt(Je({},t),{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const t=this.tooltipPopupDestroyFunc,s=this.tooltipComp,i=this.tooltipTrigger===0?this.FADE_OUT_TOOLTIP_TIMEOUT:0;window.setTimeout(()=>{t(),this.getContext().destroyBean(s)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(t=>{t&&t()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){ka.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},this.INTERACTIVE_HIDE_DELAY)}unlockService(){ka.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};hp.isLocked=!1;f([A("popupService")],hp.prototype,"popupService",2);f([A("userComponentFactory")],hp.prototype,"userComponentFactory",2);f([Ee],hp.prototype,"postConstruct",1);var rO=hp,lo=class extends xe{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshToolTip()}setBrowserTooltip(e){const t="title",s=this.ctrl.getGui();s&&(e!=null&&e!=""?s.setAttribute(t,e):s.removeAttribute(t))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){var e,t,s,i;if(this.tooltipManager!=null)return;const r={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new rO(r,(t=(e=this.ctrl).getTooltipShowDelayOverride)==null?void 0:t.call(e),(i=(s=this.ctrl).getTooltipHideDelayOverride)==null?void 0:i.call(s),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const e=this.ctrl,t=e.getColumn?e.getColumn():void 0,s=e.getColDef?e.getColDef():void 0,i=e.getRowNode?e.getRowNode():void 0;return{location:e.getLocation(),colDef:s,column:t,rowIndex:e.getRowIndex?e.getRowIndex():void 0,node:i,data:i?i.data:void 0,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?e.getValueFormatted():void 0,hideTooltipCallback:()=>{var r;return(r=this.tooltipManager)==null?void 0:r.hideTooltip(!0)}}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}};f([A("beans")],lo.prototype,"beans",2);f([Ee],lo.prototype,"postConstruct",1);var nO=new Yc,pp=class Xy extends xe{constructor(t){super(),this.displayed=!0,this.visible=!0,this.compId=nO.next(),this.cssClassManager=new dp(()=>this.eGui),t&&this.setTemplate(t)}preConstructOnComponent(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips")}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(t){const{newTooltipText:s,showDelayOverride:i,hideDelayOverride:r,location:n,shouldDisplayTooltip:o}=t||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==s&&(this.tooltipText=s);const a=()=>this.tooltipText;s!=null&&(this.tooltipFeature=this.createBean(new lo({getTooltipValue:a,getGui:()=>this.getGui(),getLocation:()=>n??"UNKNOWN",getColDef:t==null?void 0:t.getColDef,getColumn:t==null?void 0:t.getColumn,getTooltipShowDelayOverride:i!=null?()=>i:void 0,getTooltipHideDelayOverride:r!=null?()=>r:void 0,shouldDisplayTooltip:o})))}createChildComponentsFromTags(t,s){lF(t.childNodes).forEach(r=>{if(!(r instanceof HTMLElement))return;const n=this.createComponentFromElement(r,o=>{o.getGui()&&this.copyAttributesFromNode(r,o.getGui())},s);if(n){if(n.addItems&&r.children.length){this.createChildComponentsFromTags(r,s);const o=Array.prototype.slice.call(r.children);n.addItems(o)}this.swapComponentForNode(n,t,r)}else r.childNodes&&this.createChildComponentsFromTags(r,s)})}createComponentFromElement(t,s,i){const r=t.nodeName,n=i?i[t.getAttribute("ref")]:void 0,o=this.agStackComponentsRegistry.getComponentClass(r);if(o){Xy.elementGettingCreated=t;const a=new o(n);return a.setParentComponent(this),this.createBean(a,null,s),a}return null}copyAttributesFromNode(t,s){cF(t.attributes,(i,r)=>s.setAttribute(i,r))}swapComponentForNode(t,s,i){const r=t.getGui();s.replaceChild(r,i),s.insertBefore(document.createComment(i.nodeName),r),this.addDestroyFunc(this.destroyBean.bind(this,t)),this.swapInComponentForQuerySelectors(t,i)}swapInComponentForQuerySelectors(t,s){const i=this;this.iterateOverQuerySelectors(r=>{i[r.attributeName]===s&&(i[r.attributeName]=t)})}iterateOverQuerySelectors(t){let s=Object.getPrototypeOf(this);for(;s!=null;){const i=s.__agComponentMetaData,r=Im(s.constructor);i&&i[r]&&i[r].querySelectors&&i[r].querySelectors.forEach(n=>t(n)),s=Object.getPrototypeOf(s)}}activateTabIndex(t){const s=this.gos.get("tabIndex");t||(t=[]),t.length||t.push(this.getGui()),t.forEach(i=>i.setAttribute("tabindex",s.toString()))}setTemplate(t,s){const i=Oi(t);this.setTemplateFromElement(i,s)}setTemplateFromElement(t,s){this.eGui=t,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),s)}createChildComponentsPreConstruct(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}wireQuerySelectors(){if(!this.eGui)return;const t=this;this.iterateOverQuerySelectors(s=>{const i=n=>t[s.attributeName]=n;if(s.refSelector&&this.getAttribute("ref")===s.refSelector)i(this.eGui);else{const n=this.eGui.querySelector(s.querySelector);n&&i(n.__agComponent||n)}})}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(t){this.parentComponent=t}getParentComponent(){return this.parentComponent}setGui(t){this.eGui=t}queryForHtmlElement(t){return this.eGui.querySelector(t)}queryForHtmlInputElement(t){return this.eGui.querySelector(t)}appendChild(t,s){if(t!=null)if(s||(s=this.eGui),cp(t))s.appendChild(t);else{const i=t;s.appendChild(i.getGui())}}isDisplayed(){return this.displayed}setVisible(t,s={}){if(t!==this.visible){this.visible=t;const{skipAriaHidden:i}=s;rF(this.eGui,t,{skipAriaHidden:i})}}setDisplayed(t,s={}){if(t!==this.displayed){this.displayed=t;const{skipAriaHidden:i}=s;Et(this.eGui,t,{skipAriaHidden:i});const r={type:Xy.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(r)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const t=this.eGui;t&&t.__agComponent&&(t.__agComponent=void 0),super.destroy()}addGuiEventListener(t,s,i){this.eGui.addEventListener(t,s,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(t,s))}addCssClass(t){this.cssClassManager.addCssClass(t)}removeCssClass(t){this.cssClassManager.removeCssClass(t)}containsCssClass(t){return this.cssClassManager.containsCssClass(t)}addOrRemoveCssClass(t,s){this.cssClassManager.addOrRemoveCssClass(t,s)}getAttribute(t){const{eGui:s}=this;return s?s.getAttribute(t):null}getRefElement(t){return this.queryForHtmlElement(`[ref="${t}"]`)}};pp.EVENT_DISPLAYED_CHANGED="displayedChanged";f([A("agStackComponentsRegistry")],pp.prototype,"agStackComponentsRegistry",2);f([dA],pp.prototype,"preConstructOnComponent",1);f([dA],pp.prototype,"createChildComponentsPreConstruct",1);var ot=pp;function Ie(e){return oO.bind(this,`[ref=${e}]`,e)}function oO(e,t,s,i,r){if(e===null){console.error("AG Grid: QuerySelector selector should not be null");return}if(typeof r=="number"){console.error("AG Grid: QuerySelector should be on an attribute");return}aO(s,"querySelectors",{attributeName:i,querySelector:e,refSelector:t})}function aO(e,t,s){const i=lO(e,Im(e.constructor));i[t]||(i[t]=[]),i[t].push(s)}function lO(e,t){return e.__agComponentMetaData||(e.__agComponentMetaData={}),e.__agComponentMetaData[t]||(e.__agComponentMetaData[t]={}),e.__agComponentMetaData[t]}var E0=class extends ot{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),s=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${s("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const s=t.getModelAsString(e);this.eFloatingFilterText.setValue(s)}})}onParamsUpdated(e){this.refresh(e)}refresh(e){this.init(e)}};f([Ie("eFloatingFilterText")],E0.prototype,"eFloatingFilterText",2);f([A("columnModel")],E0.prototype,"columnModel",2);var SF=class{constructor(e,t,s,i,r){this.alive=!0,this.context=e,this.eParent=i,t.getDateCompDetails(s).newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}this.dateComp=a,a&&(i.appendChild(a.getGui()),a.afterGuiAttached&&a.afterGuiAttached(),this.tempValue&&a.setDate(this.tempValue),this.disabled!=null&&this.setDateCompDisabled(this.disabled),r==null||r(this))})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){Et(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&typeof this.dateComp.afterGuiAttached=="function"&&this.dateComp.afterGuiAttached(e)}updateParams(e){var t,s;let i=!1;(t=this.dateComp)!=null&&t.refresh&&typeof this.dateComp.refresh=="function"&&this.dateComp.refresh(e)!==null&&(i=!0),!i&&((s=this.dateComp)!=null&&s.onParamsUpdated)&&typeof this.dateComp.onParamsUpdated=="function"&&this.dateComp.onParamsUpdated(e)!==null&&tt("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}setDateCompDisabled(e){this.dateComp!=null&&this.dateComp.setDisabled!=null&&this.dateComp.setDisabled(e)}},xF=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(e=>{if(typeof e=="string")return;const t=[["displayKey"],["displayName"],["predicate","test"]],s=i=>i.some(r=>e[r]!=null)?!0:(console.warn(`AG Grid: ignoring FilterOptionDef as it doesn't contain one of '${i}'`),!1);if(!t.every(s)){this.filterOptions=this.filterOptions.filter(i=>i===e)||[];return}this.customFilterOptions[e.displayKey]=e})}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const t=this.filterOptions[0];typeof t=="string"?this.defaultOption=t:t.displayKey?this.defaultOption=t.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}},EF={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},jm=class bF extends xe{constructor(t,s={}){super(),this.eFocusableElement=t,this.callbacks=s,this.callbacks=Je({shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;const r=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,i.shiftKey);r&&(r.focus(),i.preventDefault())}},s)}postConstruct(){this.eFocusableElement.classList.add(bF.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}addKeyDownListeners(t){this.addManagedListener(t,"keydown",s=>{if(!(s.defaultPrevented||en(s))){if(this.callbacks.shouldStopEventPropagation(s)){nn(s);return}s.key===z.TAB?this.callbacks.onTabKeyDown(s):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(s)}})}};jm.FOCUS_MANAGED_CLASS="ag-focus-managed";f([A("focusService")],jm.prototype,"focusService",2);f([Ee],jm.prototype,"postConstruct",1);var ha=jm,RF="ag-resizer-wrapper",cO=`<div class="${RF}">
        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>
        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>
        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>
        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>
        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>
        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>
        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>
        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>
    </div>`,gu=class extends xe{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,s=t/2-this.getWidth()/2,i=e/2-this.getHeight()/2;this.offsetElement(s,i)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:s,width:i,minHeight:r,height:n,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,u=0;const h=ji(this.element);if(h){const p=this.findBoundaryElement(),g=window.getComputedStyle(p);if(g.minWidth!=null){const m=p.offsetWidth-this.element.offsetWidth;u=parseInt(g.minWidth,10)-m}if(g.minHeight!=null){const m=p.offsetHeight-this.element.offsetHeight;l=parseInt(g.minHeight,10)-m}}if(this.minHeight=r||l,this.minWidth=s||u,i&&this.setWidth(i),n&&this.setHeight(n),(!i||!n)&&this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(h&&t){let p=this.boundaryEl,g=!0;if(p||(p=this.findBoundaryElement(),g=!1),p){const m=parseFloat(p.style.top),C=parseFloat(p.style.left);g?this.offsetElement(isNaN(C)?0:C,isNaN(m)?0:m):this.setPosition(C,m)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const s=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(s),this.moveElementDragListener=s):(this.dragService.removeDragSource(s),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const i=!!e[t],r=this.getResizerElement(t),n={dragStartPixels:0,eElement:r,onDragStart:o=>this.onResizeStart(o,t),onDragging:this.onResize.bind(this),onDragStop:o=>this.onResizeEnd(o,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragService.addDragSource(n),this.resizeListeners.push(n),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[t]=i)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,s=this.element;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)nl(s,e),e=p0(s),i=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const r=this.getAvailableHeight();r&&e>r&&(e=r)}this.getHeight()!==e&&(i?(s.style.maxHeight="unset",s.style.minHeight="unset"):t?nl(s,e):(s.style.height=`${e}px`,s.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:s}=this.offsetParent;if(!s)return null;const i=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),n=e?this.position.y:i.top,o=e?0:r.top;let a=0;if(t){const u=this.element.parentElement;if(u){const{bottom:h}=u.getBoundingClientRect();a=h-i.bottom}}return s+o-n-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:s}=this.config;let i=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)Rr(t,e),e=lh(t),i=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:r}=this.offsetParent,n=s?this.position.x:this.element.getBoundingClientRect().left;r&&e+n>r&&(e=r-n)}this.getWidth()!==e&&(i?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Rr(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:parseFloat(e)))}offsetElement(e=0,t=0){const{forcePopupParentAsOffsetParent:s}=this.config,i=s?this.boundaryEl:this.element;i&&(this.popupService.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const s=this.getAvailableHeight();this.element.style.setProperty("max-height",`${s}px`)};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:s,isTop:i,anywhereWithin:r,topBuffer:n}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!s,!!r,o)?0:o,u=this.shouldSkipY(t,!!i,n,a)?0:a;return{movementX:l,movementY:u}}shouldSkipX(e,t,s,i){const r=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&n.left>=e.clientX||n.right<=e.clientX&&n.right<=o.right;return l?!0:(t?l=i<0&&e.clientX>a+n.left||i>0&&e.clientX<a+n.left:s?l=i<0&&e.clientX>o.right||i>0&&e.clientX<a+n.left:l=i<0&&e.clientX>o.right||i>0&&e.clientX<o.right,l)}shouldSkipY(e,t,s=0,i){const r=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&n.top>=e.clientY||n.bottom<=e.clientY&&n.bottom<=o.bottom;return l?!0:(t?l=i<0&&e.clientY>a+n.top+s||i>0&&e.clientY<a+n.top:l=i<0&&e.clientY>o.bottom||i>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[ref=eTopLeftResizer]")},top:{element:e.querySelector("[ref=eTopResizer]")},topRight:{element:e.querySelector("[ref=eTopRightResizer]")},right:{element:e.querySelector("[ref=eRightResizer]")},bottomRight:{element:e.querySelector("[ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[ref=eBottomLeftResizer]")},left:{element:e.querySelector("[ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const s=new DOMParser().parseFromString(cO,"text/html").body;e.appendChild(s.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${RF}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:s,forcePopupParentAsOffsetParent:i}=this.config;!s&&!i&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(s=>!s.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,s=0;for(let i=0;i<e.length;i++){const r=e[i],n=!!r.style.flex&&r.style.flex!=="0 0 auto";if(r===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(n){const l=window.getComputedStyle(r);l.minHeight&&(o=parseInt(l.minHeight,10)),l.minWidth&&(a=parseInt(l.minWidth,10))}else o=r.offsetHeight,a=r.offsetWidth;t+=o,s+=a}return{height:t,width:s}}applySizeToSiblings(e){let t=null;const s=this.getSiblings();if(s){for(let i=0;i<s.length;i++){const r=s[i];r!==t&&(e?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(t=s[i+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:s}=this.config,{isTop:i,isRight:r,isBottom:n,isLeft:o}=this.currentResizer,a=r||o,l=n||i,{movementX:u,movementY:h}=this.calculateMouseMovement({e,isLeft:o,isTop:i}),p=this.position.x,g=this.position.y;let m=0,C=0;if(a&&u){const y=o?-1:1,R=this.getWidth(),x=R+u*y;let S=!1;o&&(m=R-x,(p+m<=0||x<=this.minWidth)&&(S=!0,m=0)),S||this.setWidth(x)}if(l&&h){const y=i?-1:1,R=this.getHeight(),x=R+h*y;let S=!1;i?(C=R-x,(g+C<=0||x<=this.minHeight)&&(S=!0,C=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&R<x&&this.getMinSizeOfSiblings().height+x>this.element.parentElement.offsetHeight&&(S=!0),S||this.setHeight(x)}this.updateDragStartPosition(e.clientX,e.clientY),((t||s)&&m||C)&&this.offsetElement(p+m,g+C)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;const s={type:"resize"};this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchEvent(s)}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:s}=this.position;let i;this.config.calculateTopBuffer&&(i=this.config.calculateTopBuffer());const{movementX:r,movementY:n}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:i});this.offsetElement(t+r,s+n),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}};f([A("popupService")],gu.prototype,"popupService",2);f([A("resizeObserverService")],gu.prototype,"resizeObserverService",2);f([A("dragService")],gu.prototype,"dragService",2);var Wm=class ud extends ot{constructor(t){super(),this.filterNameKey=t,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.buttonListeners=[]}postConstruct(){this.resetTemplate(),this.createManagedBean(new ha(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new gu(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(t){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(t){let s=this.getGui();s&&s.removeEventListener("submit",this.onFormSubmit);const i=`
            <form class="ag-filter-wrapper">
                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" ref="eFilterBody">
                    ${this.createBodyTemplate()}
                </div>
            </form>`;this.setTemplate(i,t),s=this.getGui(),s&&s.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(t){this.setParams(t),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(t){this.providedFilterParams=t,this.applyActive=ud.isUseApplyButton(t),this.resetButtonsPanel()}updateParams(t){this.providedFilterParams=t,this.applyActive=ud.isUseApplyButton(t),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(){const{buttons:t}=this.providedFilterParams,s=t&&t.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(fs(this.eButtonsPanel),this.buttonListeners.forEach(n=>n==null?void 0:n()),this.buttonListeners=[]):s&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!s){this.eButtonsPanel&&qr(this.eButtonsPanel);return}const i=document.createDocumentFragment(),r=n=>{let o,a;switch(n){case"apply":o=this.translate("applyFilter"),a=h=>this.onBtApply(!1,!1,h);break;case"clear":o=this.translate("clearFilter"),a=()=>this.onBtClear();break;case"reset":o=this.translate("resetFilter"),a=()=>this.onBtReset();break;case"cancel":o=this.translate("cancelFilter"),a=h=>{this.onBtCancel(h)};break;default:console.warn("AG Grid: Unknown button type specified");return}const u=Oi(`<button
                    type="${n==="apply"?"submit":"button"}"
                    ref="${n}FilterButton"
                    class="ag-button ag-standard-button ag-filter-apply-panel-button"
                >${o}
                </button>`);this.buttonListeners.push(this.addManagedListener(u,"click",a)),i.append(u)};x0(t).forEach(n=>r(n)),this.eButtonsPanel.append(i),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const t=ud.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),s=pi(this.checkApplyDebounce.bind(this),t);this.onBtApplyDebounce=()=>{this.debouncePending=!0,s()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(t){return(t!=null?this.setModelIntoUi(t):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(t){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(t)})}handleCancelEnd(t){this.providedFilterParams.closeOnApply&&this.close(t)}resetUiToActiveModel(t,s){const i=()=>{this.onUiChanged(!1,"prevent"),s==null||s()};t!=null?this.setModelIntoUi(t).then(i):this.resetUiToDefaults().then(i)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(t="api"){const s=this.getModelFromUi();if(!this.isModelValid(s))return!1;const i=this.appliedModel;return this.appliedModel=s,!this.areModelsEqual(i,s)}isModelValid(t){return!0}onFormSubmit(t){t.preventDefault()}onBtApply(t=!1,s=!1,i){i&&i.preventDefault(),this.applyModel(s?"rowDataUpdated":"ui")&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:t,afterDataChange:s,source:"columnFilter"});const{closeOnApply:r}=this.providedFilterParams;r&&this.applyActive&&!t&&!s&&this.close(i)}onNewRowsLoaded(){}close(t){if(!this.hidePopup)return;const s=t,i=s&&s.key;let r;(i==="Enter"||i==="Space")&&(r={keyboardEvent:s}),this.hidePopup(r),this.hidePopup=null}onUiChanged(t=!1,s){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const i=this.isModelValid(this.getModelFromUi()),r=this.getRefElement("applyFilterButton");r&&Kc(r,!i)}t&&!s||s==="immediately"?this.onBtApply(t):(!this.applyActive&&!s||s==="debounce")&&this.onBtApplyDebounce()}afterGuiAttached(t){t&&(this.hidePopup=t.hidePopup),this.refreshFilterResizer(t==null?void 0:t.container)}refreshFilterResizer(t){if(!this.positionableFeature||t==="toolPanel")return;const s=t==="floatingFilter"||t==="columnFilter",{positionableFeature:i,gos:r}=this;s?(i.restoreLastSize(),i.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}static getDebounceMs(t,s){return ud.isUseApplyButton(t)?(t.debounceMs!=null&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):t.debounceMs!=null?t.debounceMs:s}static isUseApplyButton(t){return!!t.buttons&&t.buttons.indexOf("apply")>=0}refresh(t){return this.providedFilterParams=t,!0}destroy(){const t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(t){return this.localeService.getLocaleTextFunc()(t,EF[t])}getCellValue(t){return this.providedFilterParams.getValue(t)}getPositionableElement(){return this.eFilterBody}};f([A("rowModel")],Wm.prototype,"rowModel",2);f([Ie("eFilterBody")],Wm.prototype,"eFilterBody",2);f([Ee],Wm.prototype,"postConstruct",1);var Tf=Wm,b0=class extends ot{constructor(e,t){super(t),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:s,labelAlignment:i,disabled:r}=this.config;r!=null&&this.setDisabled(r),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),s!=null&&this.setLabelWidth(s),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}refreshLabel(){fs(this.eLabel),typeof this.label=="string"?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),this.label===""?(Et(this.eLabel,!1),cs(this.eLabel,"presentation")):(Et(this.eLabel,!0),cs(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const s=this.getGui().classList;return s.toggle("ag-label-align-left",e==="left"),s.toggle("ag-label-align-right",e==="right"),s.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(hh(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return Kc(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}};f([Ee],b0.prototype,"postConstruct",1);var TF=class extends b0{constructor(e,t,s){super(e,t),this.className=s}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:s}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),s!=null&&this.onValueChange(s),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId();LA(e)!==null?Uc(e,""):Uc(e,t??"")}setAriaLabel(e){return or(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListener(this,w.EVENT_FIELD_VALUE_CHANGED,()=>e(this.getValue())),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Rr(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED}),this)}},uO=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,Nl=class extends TF{constructor(e){if(super(e,(e==null?void 0:e.template)||uO,e==null?void 0:e.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.ariaRole=e==null?void 0:e.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:s,variableWidth:i,minPickerWidth:r,maxPickerWidth:n}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!i,s!=null&&this.setPickerMaxHeight(s),r!=null&&this.setPickerMinWidth(r),n!=null&&this.setPickerMaxWidth(n)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedListener(t,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(this.eLabel,"mousedown",this.onLabelOrWrapperMouseDown.bind(this)),this.addManagedListener(this.eWrapper,"mousedown",this.onLabelOrWrapperMouseDown.bind(this));const{pickerIcon:s,inputWidth:i}=this.config;if(s){const r=rs(s,this.gos);r&&this.eIcon.appendChild(r)}i!=null&&this.setInputWidth(i)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),Jn(e,!1),this.ariaRole&&cs(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&(e==null?void 0:e.target)===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case z.UP:case z.DOWN:case z.ENTER:case z.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case z.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.gos.getDocument(),t=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||(this.destroyMouseWheelFunc=this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,()=>{this.hidePicker()}));const s=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:i,pickerAriaLabelValue:r,modalPicker:n=!0}=this.config,o={modal:n,eChild:t,closeOnEsc:!0,closedCallback:()=>{const m=this.gos.getActiveDomElement(),C=!m||m===e.body;this.beforeHidePicker(),C&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:s(i,r)},a=this.popupService.addPopup(o),{maxPickerHeight:l,minPickerWidth:u,maxPickerWidth:h,variableWidth:p}=this;p?(u&&(t.style.minWidth=u),t.style.width=Bm(lh(this.eWrapper)),h&&(t.style.maxWidth=h)):hh(t,h??lh(this.eWrapper));const g=l??`${lp(this.popupService.getPopupParent())}px`;return t.style.setProperty("max-height",g),t.style.position="absolute",this.alignPickerToComponent(),a.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:e}=this.config,{pickerGap:t}=this,s=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:e,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:s,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();Jn(t,e),this.eWrapper.classList.toggle("ag-picker-expanded",e),this.eWrapper.classList.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var t;(t=this.pickerComponent)!=null&&t.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(e){return hh(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}};f([A("popupService")],Nl.prototype,"popupService",2);f([Ie("eLabel")],Nl.prototype,"eLabel",2);f([Ie("eWrapper")],Nl.prototype,"eWrapper",2);f([Ie("eDisplayField")],Nl.prototype,"eDisplayField",2);f([Ie("eIcon")],Nl.prototype,"eIcon",2);var zm=class Pg extends ot{constructor(t="default",s=!1){super(`<div class="ag-list ag-${t}-list" role="listbox"></div>`),this.cssIdentifier=t,this.unFocusable=s,this.options=[],this.itemEls=[]}init(){const t=this.getGui();this.addManagedListener(t,"mouseleave",()=>this.clearHighlighted()),!this.unFocusable&&this.addManagedListener(t,"keydown",this.handleKeyDown.bind(this))}handleKeyDown(t){const s=t.key;switch(s){case z.ENTER:if(!this.highlightedEl)this.setValue(this.getValue());else{const i=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(i)}break;case z.DOWN:case z.UP:t.preventDefault(),this.navigate(s);break;case z.PAGE_DOWN:case z.PAGE_UP:case z.PAGE_HOME:case z.PAGE_END:t.preventDefault(),this.navigateToPage(s);break}}navigate(t){const s=t===z.DOWN;let i;if(!this.highlightedEl)i=this.itemEls[s?0:this.itemEls.length-1];else{let n=this.itemEls.indexOf(this.highlightedEl)+(s?1:-1);n=Math.min(Math.max(n,0),this.itemEls.length-1),i=this.itemEls[n]}this.highlightItem(i)}navigateToPage(t){if(!this.highlightedEl||this.itemEls.length===0)return;const s=this.itemEls.indexOf(this.highlightedEl),i=this.options.length-1,r=this.itemEls[0].clientHeight,n=Math.floor(this.getGui().clientHeight/r);let o=-1;t===z.PAGE_HOME?o=0:t===z.PAGE_END?o=i:t===z.PAGE_DOWN?o=Math.min(s+n,i):t===z.PAGE_UP&&(o=Math.max(s-n,0)),o!==-1&&this.highlightItem(this.itemEls[o])}addOptions(t){return t.forEach(s=>this.addOption(s)),this}addOption(t){const{value:s,text:i}=t,r=i||s;return this.options.push({value:s,text:r}),this.renderOption(s,r),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(t=>{qr(t)}),this.itemEls=[]}updateIndices(){const t=this.getGui().querySelectorAll(".ag-list-item");t.forEach((s,i)=>{Om(s,i+1),Lm(s,t.length)})}renderOption(t,s){const i=this.gos.getDocument(),r=i.createElement("div");cs(r,"option"),r.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const n=i.createElement("span");r.appendChild(n),n.textContent=s,this.unFocusable||(r.tabIndex=-1),this.itemEls.push(r),this.addManagedListener(r,"mousemove",()=>this.highlightItem(r)),this.addManagedListener(r,"mousedown",o=>{o.preventDefault(),this.setValue(t)}),this.createManagedBean(new lo({getTooltipValue:()=>s,getGui:()=>r,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>n.scrollWidth>n.clientWidth})),this.getGui().appendChild(r)}setValue(t,s){if(this.value===t)return this.fireItemSelected(),this;if(t==null)return this.reset(s),this;const i=this.options.findIndex(r=>r.value===t);if(i!==-1){const r=this.options[i];this.value=r.value,this.displayValue=r.text,this.highlightItem(this.itemEls[i]),s||this.fireChangeEvent()}return this}setValueByIndex(t){return this.setValue(this.options[t].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const t=this.options.findIndex(s=>s.value===this.value);t!==-1&&this.highlightItem(this.itemEls[t])}reset(t){this.value=null,this.displayValue=null,this.clearHighlighted(),t||this.fireChangeEvent()}highlightItem(t){if(!ji(t))return;this.clearHighlighted(),this.highlightedEl=t,this.highlightedEl.classList.add(Pg.ACTIVE_CLASS),$c(this.highlightedEl,!0);const s=this.getGui(),{scrollTop:i,clientHeight:r}=s,{offsetTop:n,offsetHeight:o}=t;(n+o>i+r||n<i)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){!this.highlightedEl||!ji(this.highlightedEl)||(this.highlightedEl.classList.remove(Pg.ACTIVE_CLASS),$c(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED}),this.fireItemSelected()}fireItemSelected(){this.dispatchEvent({type:Pg.EVENT_ITEM_SELECTED})}};zm.EVENT_ITEM_SELECTED="selectedItem";zm.ACTIVE_CLASS="ag-active-item";f([Ee],zm.prototype,"init",1);var wb=zm,DF=class PF extends Nl{constructor(t){super(Je({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox"},t))}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:t,value:s,placeholder:i}=this.config;t!=null&&this.addOptions(t),s!=null&&this.setValue(s,!0),i&&s==null&&(this.eDisplayField.textContent=i),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}onWrapperFocusOut(t){this.eWrapper.contains(t.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new wb("select",!0)),this.listComponent.setParentComponent(this);const t=this.listComponent.getAriaElement(),s=`ag-select-list-${this.listComponent.getCompId()}`;t.setAttribute("id",s),r0(this.getAriaElement(),t),this.listComponent.addManagedListener(this.listComponent,wb.EVENT_ITEM_SELECTED,()=>{this.hidePicker(),this.dispatchEvent({type:PF.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,w.EVENT_FIELD_VALUE_CHANGED,()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())})}createPickerComponent(){return this.listComponent}onKeyDown(t){var s;const{key:i}=t;switch(i===z.TAB&&this.hidePicker(),i){case z.ENTER:case z.UP:case z.DOWN:case z.PAGE_UP:case z.PAGE_DOWN:case z.PAGE_HOME:case z.PAGE_END:t.preventDefault(),this.isPickerDisplayed?(s=this.listComponent)==null||s.handleKeyDown(t):super.onKeyDown(t);break;case z.ESCAPE:super.onKeyDown(t);break}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(t){return t.forEach(s=>this.addOption(s)),this}addOption(t){return this.listComponent.addOption(t),this}clearOptions(){var t;return(t=this.listComponent)==null||t.clearOptions(),this}setValue(t,s,i){if(this.value===t||!this.listComponent)return this;if(i||this.listComponent.setValue(t,!0),this.listComponent.getValue()===this.getValue())return this;let n=this.listComponent.getDisplayValue();return n==null&&this.config.placeholder&&(n=this.config.placeholder),this.eDisplayField.textContent=n,this.setTooltip({newTooltipText:n??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(t,s)}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),super.destroy()}};DF.EVENT_ITEM_SELECTED="selectedItem";var Um=DF,Qr=class extends TF{constructor(e,t,s="text",i="input"){super(e,`
            <div role="presentation">
                <div ref="eLabel" class="ag-input-field-label"></div>
                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">
                    <${i} ref="eInput" class="ag-input-field-input"></${i}>
                </div>
            </div>`,t),this.inputType=s,this.displayFieldTag=i}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName:e,inputWidth:t}=this.config;e!=null&&this.setInputName(e),t!=null&&this.setInputWidth(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>this.setValue(e.target.value))}setInputType(){this.displayFieldTag==="input"&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return hh(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return Tn(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return or(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Kc(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)Tn(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";Tn(this.eInput,"autocomplete",t)}return this}};f([Ie("eLabel")],Qr.prototype,"eLabel",2);f([Ie("eWrapper")],Qr.prototype,"eWrapper",2);f([Ie("eInput")],Qr.prototype,"eInput",2);var $m=class extends Qr{constructor(e,t="ag-checkbox",s="checkbox"){super(e,t,s),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,s){this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED,selected:e,previousValue:t,event:s});const i=this.getInputElement(),r={type:w.EVENT_CHECKBOX_CHANGED,id:i.id,name:i.name,selected:e,previousValue:t};this.eventService.dispatchEvent(r)}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),s=this.selected=e.target.checked;this.refreshSelectedClass(s),this.dispatchChange(s,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",e===!0),this.eWrapper.classList.toggle("ag-indeterminate",e==null)}},AF=class extends $m{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedListener(this.eventService,w.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}},R0=class{constructor(e,t,s){this.localeService=e,this.optionsFactory=t,this.valueFormatter=s}getModelAsString(e){if(!e)return null;const t=e.operator!=null,s=this.localeService.getLocaleTextFunc();if(t){const i=e;let{conditions:r}=i;if(!r){const{condition1:a,condition2:l}=i;r=[a,l]}const n=r.map(a=>this.getModelAsString(a)),o=i.operator==="AND"?"andCondition":"orCondition";return n.join(` ${s(o,EF[o])} `)}else{if(e.type===as.BLANK||e.type===as.NOT_BLANK)return s(e.type,e.type);{const i=e,r=this.optionsFactory.getCustomOption(i.type),{displayKey:n,displayName:o,numberOfInputs:a}=r||{};return n&&o&&a===0?(s(n,o),o):this.conditionToString(i,r)}}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){var t;return this.valueFormatter?(t=this.valueFormatter(e??null))!=null?t:"":String(e)}},xi=class Ql extends Tf{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(t){const s=this.optionsFactory.getCustomOption(t);if(s){const{numberOfInputs:r}=s;return r??1}const i=[Ql.EMPTY,Ql.NOT_BLANK,Ql.BLANK];return t&&i.indexOf(t)>=0?0:t===Ql.IN_RANGE?2:1}onFloatingFilterChanged(t,s){this.setTypeFromFloatingFilter(t),this.setValueFromFloatingFilter(s),this.onUiChanged(!0)}setTypeFromFloatingFilter(t){this.eTypes.forEach((s,i)=>{i===0?s.setValue(t,!0):s.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const t=this.getUiCompleteConditions();return t.length===0?null:this.maxNumConditions>1&&t.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:t[0],condition2:t[1],conditions:t}:t[0]}getConditionTypes(){return this.eTypes.map(t=>t.getValue())}getConditionType(t){return this.eTypes[t].getValue()}getJoinOperator(){return this.eJoinOperatorsOr.length===0?this.defaultJoinOperator:this.eJoinOperatorsOr[0].getValue()===!0?"OR":"AND"}areModelsEqual(t,s){if(!t&&!s)return!0;if(!t&&s||t&&!s)return!1;const i=!t.operator,r=!s.operator;if(!i&&r||i&&!r)return!1;let o;if(i){const a=t,l=s;o=this.areSimpleModelsEqual(a,l)}else{const a=t,l=s;o=a.operator===l.operator&&wn(a.conditions,l.conditions,(u,h)=>this.areSimpleModelsEqual(u,h))}return o}shouldRefresh(t){var s,i,r;const n=this.getModel(),o=n?(s=n.conditions)!=null?s:[n]:null,a=(r=(i=t.filterOptions)==null?void 0:i.map(u=>typeof u=="string"?u:u.displayKey))!=null?r:this.getDefaultFilterOptions();return!(!(!o||o.every(u=>a.find(h=>h===u.type)!==void 0))||typeof t.maxNumConditions=="number"&&o&&o.length>t.maxNumConditions)}refresh(t){return!this.shouldRefresh(t)||!super.refresh(t)?!1:(this.setParams(t),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(t){if(t.operator){let i=t;i.conditions||(i.conditions=[i.condition1,i.condition2]);const r=this.validateAndUpdateConditions(i.conditions),n=this.getNumConditions();if(r<n)this.removeConditionsAndOperators(r);else if(r>n)for(let a=n;a<r;a++)this.createJoinOperatorPanel(),this.createOption();const o=i.operator==="OR";this.eJoinOperatorsAnd.forEach(a=>a.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(a=>a.setValue(o,!0)),i.conditions.forEach((a,l)=>{this.eTypes[l].setValue(a.type,!0),this.setConditionIntoUi(a,l)})}else{const i=t;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(i.type,!0),this.setConditionIntoUi(i,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),ws.resolve()}validateAndUpdateConditions(t){let s=t.length;return s>this.maxNumConditions&&(t.splice(this.maxNumConditions),tt('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),s=this.maxNumConditions),s}doesFilterPass(t){var s;const i=this.getModel();if(i==null)return!0;const{operator:r}=i,n=[];if(r){const a=i;n.push(...(s=a.conditions)!=null?s:[])}else n.push(i);return n[r&&r==="OR"?"some":"every"](a=>this.individualConditionPasses(t,a))}setParams(t){super.setParams(t),this.setNumConditions(t),this.defaultJoinOperator=this.getDefaultJoinOperator(t.defaultJoinOperator),this.filterPlaceholder=t.filterPlaceholder,this.optionsFactory=new xF,this.optionsFactory.init(t,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(t){var s,i;t.suppressAndOrCondition!=null&&tt('Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.'),t.alwaysShowBothConditions!=null&&tt('Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.'),this.maxNumConditions=(s=t.maxNumConditions)!=null?s:t.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(tt('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=(i=t.numAlwaysVisibleConditions)!=null?i:t.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(tt('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(tt('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const t=this.createManagedBean(new Um);this.eTypes.push(t),t.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(t.getGui());const s=this.createValueElement();this.eConditionBodies.push(s),this.eFilterBody.appendChild(s),this.putOptionsIntoDropdown(t),this.resetType(t);const i=this.getNumConditions()-1;this.forEachPositionInput(i,r=>this.resetInput(r)),this.addChangedListeners(t,i)}createJoinOperatorPanel(){const t=document.createElement("div");this.eJoinOperatorPanels.push(t),t.classList.add("ag-filter-condition");const s=this.createJoinOperator(this.eJoinOperatorsAnd,t,"and"),i=this.createJoinOperator(this.eJoinOperatorsOr,t,"or");this.eFilterBody.appendChild(t);const r=this.eJoinOperatorPanels.length-1,n=this.joinOperatorId++;this.resetJoinOperatorAnd(s,r,n),this.resetJoinOperatorOr(i,r,n),this.isReadOnly()||(s.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(t,s,i){const r=this.createManagedBean(new AF);return t.push(r),r.addCssClass("ag-filter-condition-operator"),r.addCssClass(`ag-filter-condition-operator-${i}`),s.appendChild(r.getGui()),r}getDefaultJoinOperator(t){return t==="AND"||t==="OR"?t:"AND"}createFilterListOptions(){const t=this.optionsFactory.getFilterOptions();this.filterListOptions=t.map(s=>typeof s=="string"?this.createBoilerplateListOption(s):this.createCustomListOption(s))}putOptionsIntoDropdown(t){this.filterListOptions.forEach(s=>{t.addOption(s)}),t.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(t){return{value:t,text:this.translate(t)}}createCustomListOption(t){const{displayKey:s}=t,i=this.optionsFactory.getCustomOption(t.displayKey);return{value:s,text:i?this.localeService.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(s)}}isAllowTwoConditions(){return this.maxNumConditions>=2}createBodyTemplate(){return""}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const t=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,t)}updateNumConditions(){var t;let s=-1,i=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?s=r:i=!1;if(this.shouldAddNewConditionAtEnd(i))this.createJoinOperatorPanel(),this.createOption();else{const r=(t=this.lastUiCompletePosition)!=null?t:this.getNumConditions()-2;if(s<r){this.removeConditionsAndOperators(r+1);const n=s+1,o=r-n;o>0&&this.removeConditionsAndOperators(n,o),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=s}updateConditionStatusesAndValues(t,s){this.eTypes.forEach((r,n)=>{const o=this.isConditionDisabled(n,t);r.setDisabled(o||this.filterListOptions.length<=1),n===1&&(Kc(this.eJoinOperatorPanels[0],o),this.eJoinOperatorsAnd[0].setDisabled(o),this.eJoinOperatorsOr[0].setDisabled(o))}),this.eConditionBodies.forEach((r,n)=>{Et(r,this.isConditionBodyVisible(n))});const i=(s??this.getJoinOperator())==="OR";this.eJoinOperatorsAnd.forEach((r,n)=>{r.setValue(!i,!0)}),this.eJoinOperatorsOr.forEach((r,n)=>{r.setValue(i,!0)}),this.forEachInput((r,n,o,a)=>{this.setElementDisplayed(r,n<a),this.setElementDisabled(r,this.isConditionDisabled(o,t))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(t){return t&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(t,s){if(t>=this.getNumConditions())return;this.removeComponents(this.eTypes,t,s),this.removeElements(this.eConditionBodies,t,s),this.removeValueElements(t,s);const i=Math.max(t-1,0);this.removeElements(this.eJoinOperatorPanels,i,s),this.removeComponents(this.eJoinOperatorsAnd,i,s),this.removeComponents(this.eJoinOperatorsOr,i,s)}removeElements(t,s,i){this.removeItems(t,s,i).forEach(n=>qr(n))}removeComponents(t,s,i){this.removeItems(t,s,i).forEach(n=>{qr(n.getGui()),this.destroyBean(n)})}removeItems(t,s,i){return i==null?t.splice(s):t.splice(s,i)}afterGuiAttached(t){if(super.afterGuiAttached(t),this.resetPlaceholder(),!(t!=null&&t.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{const s=this.getInputs(0)[0];if(!s)return;s instanceof Qr&&s.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const t=this.getModel();this.resetUiToActiveModel(t);let s=-1,i=-1,r=!1;const n=this.getJoinOperator();for(let a=this.getNumConditions()-1;a>=0;a--)if(this.isConditionUiComplete(a))s===-1&&(s=a,i=a);else{const l=a>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(a-1),u=a<s;(l||u)&&(this.removeConditionsAndOperators(a,1),r=!0,u&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,n),r&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getPlaceholderText(t,s){let i=this.translate(t);if(Nm(this.filterPlaceholder)){const r=this.filterPlaceholder,n=this.eTypes[s].getValue(),o=this.translate(n);i=r({filterOptionKey:n,filterOption:o,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){const t=this.localeService.getLocaleTextFunc();this.forEachInput((s,i,r,n)=>{if(!(s instanceof Qr))return;const o=i===0&&n>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",a=i===0&&n>1?t("ariaFilterFromValue","Filter from value"):i===0?t("ariaFilterValue","Filter Value"):t("ariaFilterToValue","Filter to Value");s.setInputPlaceholder(this.getPlaceholderText(o,r)),s.setInputAriaLabel(a)})}setElementValue(t,s,i){t instanceof Qr&&t.setValue(s!=null?String(s):null,!0)}setElementDisplayed(t,s){t instanceof ot&&Et(t.getGui(),s)}setElementDisabled(t,s){t instanceof ot&&Kc(t.getGui(),s)}attachElementOnChange(t,s){t instanceof Qr&&t.onValueChange(s)}forEachInput(t){this.getConditionTypes().forEach((s,i)=>{this.forEachPositionTypeInput(i,s,t)})}forEachPositionInput(t,s){const i=this.getConditionType(t);this.forEachPositionTypeInput(t,i,s)}forEachPositionTypeInput(t,s,i){const r=this.getNumberOfInputs(s),n=this.getInputs(t);for(let o=0;o<n.length;o++){const a=n[o];a!=null&&i(a,o,t,r)}}isConditionDisabled(t,s){return this.isReadOnly()?!0:t===0?!1:t>s+1}isConditionBodyVisible(t){const s=this.getConditionType(t);return this.getNumberOfInputs(s)>0}isConditionUiComplete(t){return!(t>=this.getNumConditions()||this.getConditionType(t)===Ql.EMPTY||this.getValues(t).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const t=[];for(let s=0;s<this.getNumConditions();s++)this.isConditionUiComplete(s)&&t.push(this.createCondition(s));return t}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let t=this.getNumConditions();t<this.numAlwaysVisibleConditions;t++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(t){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(s=>this.resetType(s)),this.eJoinOperatorsAnd.forEach((s,i)=>this.resetJoinOperatorAnd(s,i,this.joinOperatorId+i)),this.eJoinOperatorsOr.forEach((s,i)=>this.resetJoinOperatorOr(s,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(s=>this.resetInput(s)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,t||this.onUiChanged(),ws.resolve()}resetType(t){const i=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");t.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(t,s,i){this.resetJoinOperator(t,s,this.isDefaultOperator("AND"),this.translate("andCondition"),i)}resetJoinOperatorOr(t,s,i){this.resetJoinOperator(t,s,this.isDefaultOperator("OR"),this.translate("orCondition"),i)}resetJoinOperator(t,s,i,r,n){this.updateJoinOperatorDisabled(t.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${n}`).setLabel(r),s)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((t,s)=>this.updateJoinOperatorDisabled(t,s)),this.eJoinOperatorsOr.forEach((t,s)=>this.updateJoinOperatorDisabled(t,s))}updateJoinOperatorDisabled(t,s){t.setDisabled(this.isReadOnly()||s>0)}resetInput(t){this.setElementValue(t,null),this.setElementDisabled(t,this.isReadOnly())}setConditionIntoUi(t,s){const i=this.mapValuesFromModel(t);this.forEachInput((r,n,o,a)=>{o===s&&this.setElementValue(r,i[n]!=null?i[n]:null)})}setValueFromFloatingFilter(t){this.forEachInput((s,i,r,n)=>{this.setElementValue(s,i===0&&r===0?t:null,!0)})}isDefaultOperator(t){return t===this.defaultJoinOperator}addChangedListeners(t,s){this.isReadOnly()||(t.onValueChange(this.listener),this.forEachPositionInput(s,i=>{this.attachElementOnChange(i,this.listener)}))}individualConditionPasses(t,s){const i=this.getCellValue(t.node),r=this.mapValuesFromModel(s),n=this.optionsFactory.getCustomOption(s.type),o=this.evaluateCustomFilter(n,r,i);return o??(i==null?this.evaluateNullValue(s.type):this.evaluateNonNullValue(r,i,s,t))}evaluateCustomFilter(t,s,i){if(t==null)return;const{predicate:r}=t;if(r!=null&&!s.some(n=>n==null))return r(s,i)}isBlank(t){return t==null||typeof t=="string"&&t.trim().length===0}hasInvalidInputs(){return!1}};xi.EMPTY="empty";xi.BLANK="blank";xi.NOT_BLANK="notBlank";xi.EQUALS="equals";xi.NOT_EQUAL="notEqual";xi.LESS_THAN="lessThan";xi.LESS_THAN_OR_EQUAL="lessThanOrEqual";xi.GREATER_THAN="greaterThan";xi.GREATER_THAN_OR_EQUAL="greaterThanOrEqual";xi.IN_RANGE="inRange";xi.CONTAINS="contains";xi.NOT_CONTAINS="notContains";xi.STARTS_WITH="startsWith";xi.ENDS_WITH="endsWith";var as=xi,xs=class Ts extends as{setParams(t){super.setParams(t),this.scalarFilterParams=t}evaluateNullValue(t){switch(t){case Ts.EQUALS:case Ts.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case Ts.GREATER_THAN:case Ts.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case Ts.LESS_THAN:case Ts.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case Ts.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case Ts.BLANK:return!0;case Ts.NOT_BLANK:return!1}return!1}evaluateNonNullValue(t,s,i){const r=this.comparator(),n=t[0]!=null?r(t[0],s):0;switch(i.type){case Ts.EQUALS:return n===0;case Ts.NOT_EQUAL:return n!==0;case Ts.GREATER_THAN:return n>0;case Ts.GREATER_THAN_OR_EQUAL:return n>=0;case Ts.LESS_THAN:return n<0;case Ts.LESS_THAN_OR_EQUAL:return n<=0;case Ts.IN_RANGE:{const o=r(t[1],s);return this.scalarFilterParams.inRangeInclusive?n>=0&&o<=0:n>0&&o<0}case Ts.BLANK:return this.isBlank(s);case Ts.NOT_BLANK:return!this.isBlank(s);default:return console.warn('AG Grid: Unexpected type of filter "'+i.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}},Sb=1e3,xb=1/0,FF=class extends R0{constructor(e,t,s){super(t,s),this.dateFilterParams=e}conditionToString(e,t){const{type:s}=e,{numberOfInputs:i}=t||{},r=s==as.IN_RANGE||i===2,n=Li(e.dateFrom),o=Li(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){const l=n!==null?Rc(n,a):"null",u=o!==null?Rc(o,a):"null";return`${l}-${u}`}return n!=null?Rc(n,a):`${s}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},T0=class IF extends xs{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=Sb,this.maxValidYear=xb,this.minValidDate=null,this.maxValidDate=null}afterGuiAttached(t){super.afterGuiAttached(t),this.dateConditionFromComps[0].afterGuiAttached(t)}mapValuesFromModel(t){const{dateFrom:s,dateTo:i,type:r}=t||{};return[s&&Li(s)||null,i&&Li(i)||null].slice(0,this.getNumberOfInputs(r))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(t,s){const i=s;return s==null||i<t?-1:i>t?1:0}setParams(t){this.dateFilterParams=t,super.setParams(t);const s=(i,r)=>{if(t[i]!=null)if(isNaN(t[i]))console.warn(`AG Grid: DateFilter ${i} is not a number`);else return t[i]==null?r:Number(t[i]);return r};this.minValidYear=s("minValidYear",Sb),this.maxValidYear=s("maxValidYear",xb),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),t.minValidDate?this.minValidDate=t.minValidDate instanceof Date?t.minValidDate:Li(t.minValidDate):this.minValidDate=null,t.maxValidDate?this.maxValidDate=t.maxValidDate instanceof Date?t.maxValidDate:Li(t.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&console.warn("AG Grid: DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new FF(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(t){const s=new SF(this.getContext(),this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},t);return this.addDestroyFunc(()=>s.destroy()),s}setElementValue(t,s){t.setDate(s)}setElementDisplayed(t,s){t.setDisplayed(s)}setElementDisabled(t,s){t.setDisabled(s)}getDefaultFilterOptions(){return IF.DEFAULT_FILTER_OPTIONS}createValueElement(){const s=this.gos.getDocument().createElement("div");return s.classList.add("ag-filter-body"),this.createFromToElement(s,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(s,this.eConditionPanelsTo,this.dateConditionToComps,"to"),s}createFromToElement(t,s,i,r){const o=this.gos.getDocument().createElement("div");o.classList.add(`ag-filter-${r}`),o.classList.add(`ag-filter-date-${r}`),s.push(o),t.appendChild(o),i.push(this.createDateCompWrapper(o))}removeValueElements(t,s){this.removeDateComps(this.dateConditionFromComps,t,s),this.removeDateComps(this.dateConditionToComps,t,s),this.removeItems(this.eConditionPanelsFrom,t,s),this.removeItems(this.eConditionPanelsTo,t,s)}removeDateComps(t,s,i){this.removeItems(t,s,i).forEach(n=>n.destroy())}isValidDateValue(t){if(t===null)return!1;if(this.minValidDate){if(t<this.minValidDate)return!1}else if(t.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(t>this.maxValidDate)return!1}else if(t.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(t){if(!super.isConditionUiComplete(t))return!1;let s=!0;return this.forEachInput((i,r,n,o)=>{n!==t||!s||r>=o||(s=s&&this.isValidDateValue(i.getDate()))}),s}areSimpleModelsEqual(t,s){return t.dateFrom===s.dateFrom&&t.dateTo===s.dateTo&&t.type===s.type}getFilterType(){return"date"}createCondition(t){const s=this.getConditionType(t),i={},r=this.getValues(t);return r.length>0&&(i.dateFrom=br(r[0])),r.length>1&&(i.dateTo=br(r[1])),Je({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:s},i)}resetPlaceholder(){const t=this.localeService.getLocaleTextFunc(),s=this.translate("dateFormatOoo"),i=t("ariaFilterValue","Filter Value");this.forEachInput(r=>{r.setInputPlaceholder(s),r.setInputAriaLabel(i)})}getInputs(t){return t>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[t],this.dateConditionToComps[t]]}getValues(t){const s=[];return this.forEachPositionInput(t,(i,r,n,o)=>{r<o&&s.push(i.getDate())}),s}translate(t){return t===xs.LESS_THAN?super.translate("before"):t===xs.GREATER_THAN?super.translate("after"):super.translate(t)}getModelAsString(t){var s;return(s=this.filterModelFormatter.getModelAsString(t))!=null?s:""}};T0.DEFAULT_FILTER_OPTIONS=[xs.EQUALS,xs.NOT_EQUAL,xs.LESS_THAN,xs.GREATER_THAN,xs.IN_RANGE,xs.BLANK,xs.NOT_BLANK];f([A("userComponentFactory")],T0.prototype,"userComponentFactory",2);var NF=T0,D0=class extends ot{getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return e==null?void 0:e.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.getDefaultOption();return}const t=e.operator;let s;t?s=e.conditions[0]:s=e,this.lastType=s.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const s=e;return this.isTypeEditable(s.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){this.optionsFactory=new xF,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),t||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!e.filterParams.readOnly;const s=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(s)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.setSimpleParams(e)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:s}=t||{};return s==null||s==1}isTypeEditable(e){const t=[as.IN_RANGE,as.EMPTY,as.BLANK,as.NOT_BLANK];return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){const t=this.columnModel.getDisplayNameForColumn(e.column,"header",!0),s=this.localeService.getLocaleTextFunc();return`${t} ${s("ariaFilterInput","Filter Input")}`}};f([A("columnModel")],D0.prototype,"columnModel",2);var Km=class extends D0{constructor(){super(`
            <div class="ag-floating-filter-input" role="presentation">
                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>
                <div ref="eDateWrapper" style="display: flex;"></div>
            </div>`)}getDefaultFilterOptions(){return NF.DEFAULT_FILTER_OPTIONS}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new FF(this.filterParams,this.localeService,this.optionsFactory);const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){if(e){const s=e;this.dateComp.setDate(Li(s.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Et(this.eDateWrapper,e),Et(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=this.dateComp.getDate(),t=br(e);this.params.parentFilterInstance(s=>{if(s){const i=Li(t);s.onFloatingFilterChanged(this.getLastType()||null,i)}})}getDateComponentParams(){const e=Tf.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:pi(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new SF(this.getContext(),this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,e=>{e.setInputAriaLabel(this.getAriaLabel(this.params))}),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const e=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(e)}getFilterModelFormatter(){return this.filterModelFormatter}};f([A("userComponentFactory")],Km.prototype,"userComponentFactory",2);f([Ie("eReadOnlyText")],Km.prototype,"eReadOnlyText",2);f([Ie("eDateWrapper")],Km.prototype,"eDateWrapper",2);var _F=class extends ot{constructor(){super(`
            <div class="ag-filter-filter">
                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>
            </div>`)}destroy(){super.destroy()}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListener(t,"mousedown",()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus()}),this.addManagedListener(t,"input",s=>{s.target===this.gos.getActiveDomElement()&&(this.eDateInput.isDisabled()||this.params.onDateChanged())})}setParams(e){const t=this.eDateInput.getInputElement(),s=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=s&&Pn(),t.type=s?"date":"text";const{minValidYear:i,maxValidYear:r,minValidDate:n,maxValidDate:o}=e.filterParams||{};if(n&&i&&tt("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),o&&r&&tt("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),n&&o){const[a,l]=[n,o].map(u=>u instanceof Date?u:Li(u));a&&l&&a.getTime()>l.getTime()&&tt("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}n?n instanceof Date?t.min=Rc(n):t.min=n:i&&(t.min=`${i}-01-01`),o?o instanceof Date?t.max=Rc(o):t.max=o:r&&(t.max=`${r}-12-31`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}getDate(){return Li(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(br(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&e.filterParams.browserDatePicker!=null?e.filterParams.browserDatePicker:Vm()||o0()||Pn()&&n0()>=14.1}};f([Ie("eDateInput")],_F.prototype,"eDateInput",2);var _l=class extends Qr{constructor(e,t="ag-text-field",s="text"){super(e,t,s)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){return this.eInput.value!==e&&(this.eInput.value=Ce(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=s=>{Hm(s)&&s.key&&!e.test(s.key)&&s.preventDefault()};this.addManagedListener(this.eInput,"keydown",t),this.addManagedListener(this.eInput,"paste",s=>{var i;const r=(i=s.clipboardData)==null?void 0:i.getData("text");r&&r.split("").some(n=>!e.test(n))&&s.preventDefault()})}},P0=class extends _l{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"blur",()=>{const r=parseFloat(this.eInput.value),n=isNaN(r)?"":this.normalizeValue(r.toString());this.value!==n&&this.setValue(n)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any";const{precision:e,min:t,max:s,step:i}=this.config;typeof e=="number"&&this.setPrecision(e),typeof t=="number"&&this.setMin(t),typeof s=="number"&&this.setMax(s),typeof i=="number"&&this.setStep(i)}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}normalizeValue(e){if(e==="")return"";this.precision!=null&&(e=this.adjustPrecision(e));const t=parseFloat(e);return this.min!=null&&t<this.min?e=this.min.toString():this.max!=null&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(this.precision==null)return e;if(t){const i=parseFloat(e).toFixed(this.precision);return parseFloat(i).toString()}const s=String(e).split(".");if(s.length>1){if(s[1].length<=this.precision)return e;if(this.precision>0)return`${s[0]}.${s[1].slice(0,this.precision)}`}return s[0]}setMin(e){return this.min===e?this:(this.min=e,Tn(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,Tn(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,Tn(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(s=>super.setValue(s,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,s){if(Ce(s)){let i=this.isScientificNotation(s);if(i&&this.eInput.validity.valid)return e(s);if(!i){s=this.adjustPrecision(s);const r=this.normalizeValue(s);i=s!=r}if(i)return t(s)}return e(s)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},kF=class extends R0{conditionToString(e,t){const{numberOfInputs:s}=t||{};return e.type==as.IN_RANGE||s===2?`${this.formatValue(e.filter)}-${this.formatValue(e.filterTo)}`:e.filter!=null?this.formatValue(e.filter):`${e.type}`}};function ew(e){const{allowedCharPattern:t}=e??{};return t??null}var MF=class LF extends xs{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(t){return this.numberFilterParams.allowedCharPattern!==t.allowedCharPattern?!1:super.refresh(t)}mapValuesFromModel(t){const{filter:s,filterTo:i,type:r}=t||{};return[this.processValue(s),this.processValue(i)].slice(0,this.getNumberOfInputs(r))}getDefaultDebounceMs(){return 500}comparator(){return(t,s)=>t===s?0:t<s?1:-1}setParams(t){this.numberFilterParams=t,super.setParams(t),this.filterModelFormatter=new kF(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return LF.DEFAULT_FILTER_OPTIONS}setElementValue(t,s,i){const r=!i&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(s??null):s;super.setElementValue(t,r)}createValueElement(){const t=ew(this.numberFilterParams),s=document.createElement("div");return s.classList.add("ag-filter-body"),cs(s,"presentation"),this.createFromToElement(s,this.eValuesFrom,"from",t),this.createFromToElement(s,this.eValuesTo,"to",t),s}createFromToElement(t,s,i,r){const n=this.createManagedBean(r?new _l({allowedCharPattern:r}):new P0);n.addCssClass(`ag-filter-${i}`),n.addCssClass("ag-filter-filter"),s.push(n),t.appendChild(n.getGui())}removeValueElements(t,s){this.removeComponents(this.eValuesFrom,t,s),this.removeComponents(this.eValuesTo,t,s)}getValues(t){const s=[];return this.forEachPositionInput(t,(i,r,n,o)=>{r<o&&s.push(this.processValue(this.stringToFloat(i.getValue())))}),s}areSimpleModelsEqual(t,s){return t.filter===s.filter&&t.filterTo===s.filterTo&&t.type===s.type}getFilterType(){return"number"}processValue(t){return t==null||isNaN(t)?null:t}stringToFloat(t){if(typeof t=="number")return t;let s=Rn(t);return s!=null&&s.trim()===""&&(s=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(s):s==null||s.trim()==="-"?null:parseFloat(s)}createCondition(t){const s=this.getConditionType(t),i={filterType:this.getFilterType(),type:s},r=this.getValues(t);return r.length>0&&(i.filter=r[0]),r.length>1&&(i.filterTo=r[1]),i}getInputs(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]}getModelAsString(t){var s;return(s=this.filterModelFormatter.getModelAsString(t))!=null?s:""}hasInvalidInputs(){let t=!1;return this.forEachInput(s=>{if(!s.getInputElement().validity.valid){t=!0;return}}),t}};MF.DEFAULT_FILTER_OPTIONS=[xs.EQUALS,xs.NOT_EQUAL,xs.GREATER_THAN,xs.GREATER_THAN_OR_EQUAL,xs.LESS_THAN,xs.LESS_THAN_OR_EQUAL,xs.IN_RANGE,xs.BLANK,xs.NOT_BLANK];var OF=MF,GF=class extends R0{conditionToString(e,t){const{numberOfInputs:s}=t||{};return e.type==as.IN_RANGE||s===2?`${e.filter}-${e.filterTo}`:e.filter!=null?`${e.filter}`:`${e.type}`}},Ur=class Zl extends as{constructor(){super("textFilter"),this.eValuesFrom=[],this.eValuesTo=[]}static trimInput(t){const s=t&&t.trim();return s===""?t:s}getDefaultDebounceMs(){return 500}setParams(t){this.textFilterParams=t,super.setParams(t),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?Zl.DEFAULT_FORMATTER:Zl.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new GF(this.localeService,this.optionsFactory)}getTextMatcher(){const t=this.textFilterParams.textCustomComparator;return t?(rt.warnOnce("textCustomComparator is deprecated, use textMatcher instead."),({filterOption:s,value:i,filterText:r})=>t(s,i,r)):this.textFilterParams.textMatcher||Zl.DEFAULT_MATCHER}createCondition(t){const s=this.getConditionType(t),i={filterType:this.getFilterType(),type:s},r=this.getValuesWithSideEffects(t,!0);return r.length>0&&(i.filter=r[0]),r.length>1&&(i.filterTo=r[1]),i}getFilterType(){return"text"}areSimpleModelsEqual(t,s){return t.filter===s.filter&&t.filterTo===s.filterTo&&t.type===s.type}getInputs(t){return t>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[t],this.eValuesTo[t]]}getValues(t){return this.getValuesWithSideEffects(t,!1)}getValuesWithSideEffects(t,s){const i=[];return this.forEachPositionInput(t,(r,n,o,a)=>{var l;if(n<a){let u=Rn(r.getValue());s&&this.textFilterParams.trimInput&&(u=(l=Zl.trimInput(u))!=null?l:null,r.setValue(u,!0)),i.push(u)}}),i}getDefaultFilterOptions(){return Zl.DEFAULT_FILTER_OPTIONS}createValueElement(){const t=document.createElement("div");return t.classList.add("ag-filter-body"),cs(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from"),this.createFromToElement(t,this.eValuesTo,"to"),t}createFromToElement(t,s,i){const r=this.createManagedBean(new _l);r.addCssClass(`ag-filter-${i}`),r.addCssClass("ag-filter-filter"),s.push(r),t.appendChild(r.getGui())}removeValueElements(t,s){this.removeComponents(this.eValuesFrom,t,s),this.removeComponents(this.eValuesTo,t,s)}mapValuesFromModel(t){const{filter:s,filterTo:i,type:r}=t||{};return[s||null,i||null].slice(0,this.getNumberOfInputs(r))}evaluateNullValue(t){const s=[as.NOT_EQUAL,as.NOT_CONTAINS,as.BLANK];return t?s.indexOf(t)>=0:!1}evaluateNonNullValue(t,s,i,r){const n=t.map(C=>this.formatter(C))||[],o=this.formatter(s),{api:a,colDef:l,column:u,columnApi:h,context:p,textFormatter:g}=this.textFilterParams;if(i.type===as.BLANK)return this.isBlank(s);if(i.type===as.NOT_BLANK)return!this.isBlank(s);const m={api:a,colDef:l,column:u,columnApi:h,context:p,node:r.node,data:r.data,filterOption:i.type,value:o,textFormatter:g};return n.some(C=>this.matcher(Jt(Je({},m),{filterText:C})))}getModelAsString(t){var s;return(s=this.filterModelFormatter.getModelAsString(t))!=null?s:""}};Ur.DEFAULT_FILTER_OPTIONS=[as.CONTAINS,as.NOT_CONTAINS,as.EQUALS,as.NOT_EQUAL,as.STARTS_WITH,as.ENDS_WITH,as.BLANK,as.NOT_BLANK];Ur.DEFAULT_FORMATTER=e=>e;Ur.DEFAULT_LOWERCASE_FORMATTER=e=>e==null?null:e.toString().toLowerCase();Ur.DEFAULT_MATCHER=({filterOption:e,value:t,filterText:s})=>{if(s==null)return!1;switch(e){case Ur.CONTAINS:return t.indexOf(s)>=0;case Ur.NOT_CONTAINS:return t.indexOf(s)<0;case Ur.EQUALS:return t===s;case Ur.NOT_EQUAL:return t!=s;case Ur.STARTS_WITH:return t.indexOf(s)===0;case Ur.ENDS_WITH:const i=t.lastIndexOf(s);return i>=0&&i===t.length-s.length;default:return!1}};var A0=Ur,VF=class extends xe{constructor(e){super(),this.params=e,this.valueChangedListener=()=>{}}setupGui(e){var t;this.eFloatingFilterTextInput=this.createManagedBean(new _l((t=this.params)==null?void 0:t.config));const s=this.eFloatingFilterTextInput.getGui();e.appendChild(s),this.addManagedListener(s,"input",i=>this.valueChangedListener(i)),this.addManagedListener(s,"keydown",i=>this.valueChangedListener(i))}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}setAutoComplete(e){this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}setValueChangedListener(e){this.valueChangedListener=e}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterTextInput.setInputAriaLabel(e)}},Ym=class extends D0{postConstruct(){this.setTemplate(`
            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>
        `)}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.floatingFilterInputService=this.createFloatingFilterInputService(e),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){var t;this.params=e;const s=(t=e.browserAutoComplete)!=null?t:!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:s}),this.applyActive=Tf.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){const i=Tf.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),r=pi(this.syncUpWithParentFilter.bind(this),i);this.floatingFilterInputService.setValueChangedListener(r)}}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const t=this.floatingFilterInputService.getValue();fs(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(e),this.floatingFilterInputService.setValue(t,!0)}syncUpWithParentFilter(e){const t=e.key===z.ENTER;if(this.applyActive&&!t)return;let s=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(s=A0.trimInput(s),this.floatingFilterInputService.setValue(s,!0)),this.params.parentFilterInstance(i=>{i&&i.onFloatingFilterChanged(this.getLastType()||null,s||null)})}setEditable(e){this.floatingFilterInputService.setEditable(e)}};f([Ie("eFloatingFilterInputContainer")],Ym.prototype,"eFloatingFilterInputContainer",2);f([Ee],Ym.prototype,"postConstruct",1);var dO=class extends xe{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new P0),this.eFloatingFilterTextInput=this.createManagedBean(new _l),this.eFloatingFilterTextInput.setDisabled(!0);const t=this.eFloatingFilterNumberInput.getGui(),s=this.eFloatingFilterTextInput.getGui();e.appendChild(t),e.appendChild(s),this.setupListeners(t,i=>this.valueChangedListener(i)),this.setupListeners(s,i=>this.valueChangedListener(i))}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eFloatingFilterNumberInput.setAutoComplete(e),this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(e){this.valueChangedListener=e}setupListeners(e,t){this.addManagedListener(e,"input",t),this.addManagedListener(e,"keydown",t)}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterNumberInput.setInputAriaLabel(e),this.eFloatingFilterTextInput.setInputAriaLabel(e)}},hO=class extends Ym{init(e){var t;super.init(e),this.filterModelFormatter=new kF(this.localeService,this.optionsFactory,(t=e.filterParams)==null?void 0:t.numberFormatter)}onParamsUpdated(e){this.refresh(e)}refresh(e){ew(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return OF.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.allowedCharPattern=ew(e.filterParams),this.allowedCharPattern?this.createManagedBean(new VF({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new dO)}},pO=class extends Ym{init(e){super.init(e),this.filterModelFormatter=new GF(this.localeService,this.optionsFactory)}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return A0.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new VF)}},gp=class dd{constructor(t,s=!1){this.destroyFuncs=[],this.touching=!1,this.eventService=new rn,this.eElement=t,this.preventMouseClick=s;const i=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),n=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",i,{passive:!0}),this.eElement.addEventListener("touchmove",r,{passive:!0}),this.eElement.addEventListener("touchend",n,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",i,{passive:!0}),this.eElement.removeEventListener("touchmove",r,{passive:!0}),this.eElement.removeEventListener("touchend",n,{passive:!1})})}getActiveTouch(t){for(let s=0;s<t.length;s++)if(t[s].identifier===this.touchStart.identifier)return t[s];return null}addEventListener(t,s){this.eventService.addEventListener(t,s)}removeEventListener(t,s){this.eventService.removeEventListener(t,s)}onTouchStart(t){if(this.touching)return;this.touchStart=t.touches[0],this.touching=!0,this.moved=!1;const s=this.touchStart;window.setTimeout(()=>{const i=this.touchStart===s;if(this.touching&&i&&!this.moved){this.moved=!0;const r={type:dd.EVENT_LONG_TAP,touchStart:this.touchStart,touchEvent:t};this.eventService.dispatchEvent(r)}},500)}onTouchMove(t){if(!this.touching)return;const s=this.getActiveTouch(t.touches);if(!s)return;!S0(s,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(t){if(this.touching){if(!this.moved){const s={type:dd.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(s),this.checkForDoubleTap()}this.preventMouseClick&&t.cancelable&&t.preventDefault(),this.touching=!1}}checkForDoubleTap(){const t=new Date().getTime();if(this.lastTapTime&&this.lastTapTime>0)if(t-this.lastTapTime>dd.DOUBLE_TAP_MILLIS){const i={type:dd.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(i),this.lastTapTime=null}else this.lastTapTime=t;else this.lastTapTime=t}destroy(){this.destroyFuncs.forEach(t=>t())}};gp.EVENT_TAP="tap";gp.EVENT_DOUBLE_TAP="doubleTap";gp.EVENT_LONG_TAP="longTap";gp.DOUBLE_TAP_MILLIS=500;var ks=gp,co=class BF extends ot{constructor(t){super(),t||this.setTemplate(BF.TEMPLATE)}attachCustomElements(t,s,i,r,n){this.eSortOrder=t,this.eSortAsc=s,this.eSortDesc=i,this.eSortMixed=r,this.eSortNone=n}setupSort(t,s=!1){this.column=t,this.suppressOrder=s,this.setupMultiSortIndicator(),!(!this.column.isSortable()&&!this.column.getColDef().showRowGroup)&&(this.addInIcon("sortAscending",this.eSortAsc,t),this.addInIcon("sortDescending",this.eSortDesc,t),this.addInIcon("sortUnSort",this.eSortNone,t),this.addManagedPropertyListener("unSortIcon",()=>this.updateIcons()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.updateIcons()),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,()=>this.onSortChanged()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.onSortChanged()),this.onSortChanged())}addInIcon(t,s,i){if(s==null)return;const r=rs(t,this.gos,i);r&&s.appendChild(r)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const t=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const s=t==="asc";Et(this.eSortAsc,s,{skipAriaHidden:!0})}if(this.eSortDesc){const s=t==="desc";Et(this.eSortDesc,s,{skipAriaHidden:!0})}if(this.eSortNone){const s=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),i=t==null;Et(this.eSortNone,!s&&i,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const t=this.column.getColDef().showRowGroup;this.gos.isColumnsSortingCoupledToGroup()&&t&&(this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,()=>this.updateMultiSortIndicator()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateMultiSortIndicator()),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const t=this.sortController.getDisplaySortForColumn(this.column)==="mixed";Et(this.eSortMixed,t,{skipAriaHidden:!0})}}updateSortOrder(){var t;if(!this.eSortOrder)return;const s=this.sortController.getColumnsWithSortingOrdered(),i=(t=this.sortController.getDisplaySortIndexForColumn(this.column))!=null?t:-1,r=s.some(o=>{var a;return(a=this.sortController.getDisplaySortIndexForColumn(o))!=null?a:!1}),n=i>=0&&r;Et(this.eSortOrder,n,{skipAriaHidden:!0}),i>=0?this.eSortOrder.textContent=(i+1).toString():fs(this.eSortOrder)}};co.TEMPLATE=`<span class="ag-sort-indicator-container">
            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>
            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>
            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>
        </span>`;f([Ie("eSortOrder")],co.prototype,"eSortOrder",2);f([Ie("eSortAsc")],co.prototype,"eSortAsc",2);f([Ie("eSortDesc")],co.prototype,"eSortDesc",2);f([Ie("eSortMixed")],co.prototype,"eSortMixed",2);f([Ie("eSortNone")],co.prototype,"eSortNone",2);f([A("columnModel")],co.prototype,"columnModel",2);f([A("sortController")],co.prototype,"sortController",2);var F0=co,ii=class HF extends ot{constructor(){super(...arguments),this.lastMovingChanged=0}destroy(){super.destroy()}refresh(t){const s=this.params;return this.params=t,this.workOutTemplate()!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||this.workOutSort()!=this.currentSort||this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||s.enableFilterButton!=t.enableFilterButton||s.enableFilterIcon!=t.enableFilterIcon?!1:(this.setDisplayName(t),!0)}workOutTemplate(){var t;let s=(t=this.params.template)!=null?t:HF.TEMPLATE;return s=s&&s.trim?s.trim():s,s}init(t){this.params=t,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(t)}setDisplayName(t){if(this.currentDisplayName!=t.displayName){this.currentDisplayName=t.displayName;const s=ys(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=s)}}addInIcon(t,s,i){if(s==null)return;const r=rs(t,this.gos,i);r&&s.appendChild(r)}setupTap(){const{gos:t}=this;if(t.get("suppressTouch"))return;const s=new ks(this.getGui(),!0),i=this.shouldSuppressMenuHide(),r=i&&Ce(this.eMenu),n=r?new ks(this.eMenu,!0):s;if(this.params.enableMenu){const o=r?"EVENT_TAP":"EVENT_LONG_TAP",a=l=>this.params.showColumnMenuAfterMouseClick(l.touchStart);this.addManagedListener(n,ks[o],a)}if(this.params.enableSorting){const o=a=>{var l,u;const h=a.touchStart.target;i&&((l=this.eMenu)!=null&&l.contains(h)||(u=this.eFilterButton)!=null&&u.contains(h))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListener(s,ks.EVENT_TAP,o)}if(this.params.enableFilterButton){const o=new ks(this.eFilterButton,!0);this.addManagedListener(o,"tap",()=>this.params.showFilter(this.eFilterButton)),this.addDestroyFunc(()=>o.destroy())}this.addDestroyFunc(()=>s.destroy()),r&&this.addDestroyFunc(()=>n.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){qr(this.eMenu),this.eMenu=void 0;return}const t=this.menuService.isLegacyMenuEnabled();this.addInIcon(t?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!t),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedListener(this.eMenu,"click",()=>this.params.showColumnMenu(this.eMenu)),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(t){var s,i,r,n;const{column:o}=this.params,a=this.menuService.isLegacyMenuEnabled();if(t&&!a){if(this.menuService.isFilterMenuInHeaderEnabled(o))return this.params.showFilter((i=(s=this.eFilterButton)!=null?s:this.eMenu)!=null?i:this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu((n=(r=this.eMenu)!=null?r:this.eFilterButton)!=null?n:this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new F0(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListener(this.params.column,Vt.EVENT_MOVING_CHANGED,()=>{this.lastMovingChanged=new Date().getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",s=>{const i=this.params.column.isMoving(),n=new Date().getTime()-this.lastMovingChanged<50;if(!(i||n)){const l=this.gos.get("multiSortKey")==="ctrl"?s.ctrlKey||s.metaKey:s.shiftKey;this.params.progressSort(l)}});const t=()=>{if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",this.params.column.isSortAscending()),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",this.params.column.isSortDescending()),this.addOrRemoveCssClass("ag-header-cell-sorted-none",this.params.column.isSortNone()),this.params.column.getColDef().showRowGroup){const s=this.columnModel.getSourceColumnsForGroupColumn(this.params.column),r=!(s==null?void 0:s.every(n=>this.params.column.getSort()==n.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",r)}};this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,t),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,t)}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedListener(this.eFilterButton,"click",()=>this.params.showFilter(this.eFilterButton)):this.eFilterButton=void 0}configureFilter(t,s,i){if(!t)return qr(s),!1;const{column:r}=this.params;return this.addInIcon("filter",s,r),this.addManagedListener(r,Vt.EVENT_FILTER_CHANGED,i),i(),!0}onFilterChangedIcon(){const t=this.params.column.isFilterActive();Et(this.eFilter,t,{skipAriaHidden:!0})}onFilterChangedButton(){const t=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",t)}getAnchorElementForMenu(t){var s,i,r,n;return t?(i=(s=this.eFilterButton)!=null?s:this.eMenu)!=null?i:this.getGui():(n=(r=this.eMenu)!=null?r:this.eFilterButton)!=null?n:this.getGui()}};ii.TEMPLATE=`<div class="ag-cell-label-container" role="presentation">
            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>
            <span ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>
            <div ref="eLabel" class="ag-header-cell-label" role="presentation">
                <span ref="eText" class="ag-header-cell-text"></span>
                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>
                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>
            </div>
        </div>`;f([A("sortController")],ii.prototype,"sortController",2);f([A("menuService")],ii.prototype,"menuService",2);f([A("columnModel")],ii.prototype,"columnModel",2);f([Ie("eFilter")],ii.prototype,"eFilter",2);f([Ie("eFilterButton")],ii.prototype,"eFilterButton",2);f([Ie("eSortIndicator")],ii.prototype,"eSortIndicator",2);f([Ie("eMenu")],ii.prototype,"eMenu",2);f([Ie("eLabel")],ii.prototype,"eLabel",2);f([Ie("eText")],ii.prototype,"eText",2);f([Ie("eSortOrder")],ii.prototype,"eSortOrder",2);f([Ie("eSortAsc")],ii.prototype,"eSortAsc",2);f([Ie("eSortDesc")],ii.prototype,"eSortDesc",2);f([Ie("eSortMixed")],ii.prototype,"eSortMixed",2);f([Ie("eSortNone")],ii.prototype,"eSortNone",2);var tw=ii,fp=class jF extends ot{constructor(){super(jF.TEMPLATE)}destroy(){super.destroy()}init(t){this.params=t,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&tt("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");const t=r=>{if(en(r))return;const n=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),n,"uiColumnExpanded")};this.addTouchAndClickListeners(this.eCloseIcon,t),this.addTouchAndClickListeners(this.eOpenIcon,t);const s=r=>{nn(r)};this.addManagedListener(this.eCloseIcon,"dblclick",s),this.addManagedListener(this.eOpenIcon,"dblclick",s),this.addManagedListener(this.getGui(),"dblclick",t),this.updateIconVisibility();const i=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(i,vs.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(i,vs.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}addTouchAndClickListeners(t,s){const i=new ks(t,!0);this.addManagedListener(i,ks.EVENT_TAP,s),this.addDestroyFunc(()=>i.destroy()),this.addManagedListener(t,"click",s)}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const s=this.params.columnGroup.isExpanded();Et(this.eOpenIcon,s),Et(this.eCloseIcon,!s)}else Et(this.eOpenIcon,!1),Et(this.eCloseIcon,!1)}addInIcon(t,s){const i=rs(t,this.gos,null);i&&this.getRefElement(s).appendChild(i)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable()){Et(this.eOpenIcon,!1),Et(this.eCloseIcon,!1);return}}setupLabel(){var t;const{displayName:s,columnGroup:i}=this.params;if(Ce(s)){const r=ys(s,!0);this.getRefElement("agLabel").textContent=r}this.addOrRemoveCssClass("ag-sticky-label",!((t=i.getColGroupDef())!=null&&t.suppressStickyLabel))}};fp.TEMPLATE=`<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">
            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>
            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>
            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>
        </div>`;f([A("columnModel")],fp.prototype,"columnModel",2);f([Ie("agOpened")],fp.prototype,"eOpenIcon",2);f([Ie("agClosed")],fp.prototype,"eCloseIcon",2);var gO=fp,kl=class extends ot{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},I0=class WF extends kl{constructor(){super(WF.TEMPLATE)}init(t){this.params=t,this.focusAfterAttached=t.cellStartedEdit,this.eTextArea.setMaxLength(t.maxLength||200).setCols(t.cols||60).setRows(t.rows||10),Ce(t.value,!0)&&this.eTextArea.setValue(t.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(t){const s=t.key;(s===z.LEFT||s===z.UP||s===z.RIGHT||s===z.DOWN||t.shiftKey&&s===z.ENTER)&&t.stopPropagation()}afterGuiAttached(){const t=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(t("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const t=this.eTextArea.getValue();return!Ce(t)&&!Ce(this.params.value)?this.params.value:this.params.parseValue(t)}};I0.TEMPLATE=`<div class="ag-large-text">
            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>
        </div>`;f([Ie("eTextArea")],I0.prototype,"eTextArea",2);var fO=I0,N0=class extends kl{constructor(){super(`<div class="ag-cell-edit-wrapper">
                <ag-select class="ag-cell-editor" ref="eSelect"></ag-select>
            </div>`),this.startedByEnter=!1}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueService:s,gos:i}=this,{values:r,value:n,eventKey:o}=e;if(nt(r)){console.warn("AG Grid: no values found for select cellEditor");return}this.startedByEnter=o!=null?o===z.ENTER:!1;let a=!1;r.forEach(p=>{const g={value:p},m=s.formatValue(e.column,null,p),C=m!=null;g.text=C?m:p,t.addOption(g),a=a||n===p}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:u,valueListMaxHeight:h}=e;l!=null&&t.setPickerGap(l),h!=null&&t.setPickerMaxHeight(h),u!=null&&t.setPickerMaxWidth(u),i.get("editType")!=="fullRow"&&this.addManagedListener(this.eSelect,Um.EVENT_ITEM_SELECTED,()=>e.stopEditing())}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}};f([A("valueService")],N0.prototype,"valueService",2);f([Ie("eSelect")],N0.prototype,"eSelect",2);var mp=class extends kl{constructor(e){super(`
            <div class="ag-cell-edit-wrapper">
                ${e.getTemplate()}
            </div>`),this.cellEditorInput=e}init(e){this.params=e;const t=this.eInput;this.cellEditorInput.init(t,e);let s;if(e.cellStartedEdit){this.focusAfterAttached=!0;const i=e.eventKey;i===z.BACKSPACE||e.eventKey===z.DELETE?s="":i&&i.length===1?s=i:(s=this.cellEditorInput.getStartValue(),i!==z.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,s=this.cellEditorInput.getStartValue();s!=null&&t.setStartValue(s),this.addManagedListener(t.getGui(),"keydown",i=>{const{key:r}=i;(r===z.PAGE_UP||r===z.PAGE_DOWN)&&i.preventDefault()})}afterGuiAttached(){var e,t;const s=this.localeService.getLocaleTextFunc(),i=this.eInput;if(i.setInputAriaLabel(s("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Pn()||i.getFocusableElement().focus();const r=i.getInputElement();this.highlightAllOnFocus?r.select():(t=(e=this.cellEditorInput).setCaret)==null||t.call(e)}focusIn(){const e=this.eInput,t=e.getFocusableElement(),s=e.getInputElement();t.focus(),s.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}};f([Ie("eInput")],mp.prototype,"eInput",2);var mO=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}init(e,t){this.eInput=e,this.params=t,t.maxLength!=null&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return!Ce(e)&&!Ce(this.params.value)?this.params.value:this.params.parseValue(e)}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=Ce(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}},Eb=class extends mp{constructor(){super(new mO)}},vO="",CO="",zF=class extends ot{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-change-delta");const s=document.createElement("span");s.setAttribute("class","ag-value-change-value"),e.appendChild(t),e.appendChild(s),this.setTemplateFromElement(e)}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e,!0)}showDelta(e,t){const s=Math.abs(t),i=e.formatValue(s),r=Ce(i)?i:s,n=t>=0;n?this.eDelta.textContent=vO+r:this.eDelta.textContent=CO+r,this.eDelta.classList.toggle("ag-value-change-delta-up",n),this.eDelta.classList.toggle("ag-value-change-delta-down",!n)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),fs(this.eDelta)}refresh(e,t=!1){const s=e.value;if(s===this.lastValue||(Ce(e.valueFormatted)?this.eValue.textContent=e.valueFormatted:Ce(e.value)?this.eValue.textContent=s:fs(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering()))return!1;if(typeof s=="number"&&typeof this.lastValue=="number"){const i=s-this.lastValue;this.showDelta(e,i)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=s,!0}};f([A("filterManager")],zF.prototype,"filterManager",2);var UF=class extends ot{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-slide-current"),e.appendChild(t),this.setTemplateFromElement(e),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const t=document.createElement("span");t.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=t,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let s=e.value;return nt(s)&&(s=""),s===this.lastValue||this.filterManager.isSuppressFlashingCellsBecauseFiltering()?!1:(t||this.addSlideAnimation(),this.lastValue=s,Ce(e.valueFormatted)?this.eCurrent.textContent=e.valueFormatted:Ce(e.value)?this.eCurrent.textContent=s:fs(this.eCurrent),!0)}};f([A("filterManager")],UF.prototype,"filterManager",2);var Xt=class Wt{constructor(t){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=Wt.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}setData(t){this.setDataCommon(t,!1)}updateData(t){this.setDataCommon(t,!0)}setDataCommon(t,s){const i=this.data;this.data=t,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const r=this.createDataChangedEvent(t,i,s);this.dispatchLocalEvent(r)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(t,s,i){return{type:Wt.EVENT_DATA_CHANGED,node:this,oldData:s,newData:t,update:i}}createLocalRowEvent(t){return{type:t,node:this}}getRowIndexString(){return this.rowPinned==="top"?"t-"+this.rowIndex:this.rowPinned==="bottom"?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const t=new Wt(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}setDataAndId(t,s){const i=Ce(this.id)?this.createDaemonNode():null,r=this.data;this.data=t,this.updateDataOnDetailNode(),this.setId(s),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,i);const n=this.createDataChangedEvent(t,r,!1);this.dispatchLocalEvent(n)}checkRowSelectable(){const t=this.beans.gos.get("isRowSelectable");this.setRowSelectable(t?t(this):!0)}setRowSelectable(t,s){if(this.selectable!==t){if(this.selectable=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_SELECTABLE_CHANGED)),s)return;if(this.beans.gos.get("groupSelectsChildren")){const r=this.calculateSelectedFromChildren();this.setSelectedParams({newValue:r??!1,source:"selectableChanged"});return}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(t){const s=this.beans.gos.getCallback("getRowId");if(s)if(this.data){const i=this.getGroupKeys(!0);this.id=s({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level}),this.id!==null&&typeof this.id=="string"&&this.id.startsWith(Wt.ID_PREFIX_ROW_GROUP)&&console.error(`AG Grid: Row IDs cannot start with ${Wt.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`),this.id!==null&&typeof this.id!="string"&&(this.id=""+this.id)}else this.id=void 0;else this.id=t}getGroupKeys(t=!1){const s=[];let i=this;for(t&&(i=i.parent);i&&i.level>=0;)s.push(i.key),i=i.parent;return s.reverse(),s}isPixelInRange(t){return!Ce(this.rowTop)||!Ce(this.rowHeight)?!1:t>=this.rowTop&&t<this.rowTop+this.rowHeight}setFirstChild(t){this.firstChild!==t&&(this.firstChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_FIRST_CHILD_CHANGED)))}setLastChild(t){this.lastChild!==t&&(this.lastChild=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_LAST_CHILD_CHANGED)))}setChildIndex(t){this.childIndex!==t&&(this.childIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_CHILD_INDEX_CHANGED)))}setRowTop(t){this.oldRowTop=this.rowTop,this.rowTop!==t&&(this.rowTop=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_TOP_CHANGED)),this.setDisplayed(t!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(t){this.displayed!==t&&(this.displayed=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_DISPLAYED_CHANGED)))}setDragging(t){this.dragging!==t&&(this.dragging=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_DRAGGING_CHANGED)))}setHighlighted(t){t!==this.highlighted&&(this.highlighted=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_HIGHLIGHT_CHANGED)))}setHovered(t){this.hovered!==t&&(this.hovered=t)}isHovered(){return this.hovered}setAllChildrenCount(t){this.allChildrenCount!==t&&(this.allChildrenCount=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}setMaster(t){this.master!==t&&(this.master&&!t&&(this.expanded=!1),this.master=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_MASTER_CHANGED)))}setGroup(t){this.group!==t&&(this.group&&!t&&(this.expanded=!1),this.group=t,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_GROUP_CHANGED)))}setRowHeight(t,s=!1){this.rowHeight=t,this.rowHeightEstimated=s,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_HEIGHT_CHANGED))}setRowAutoHeight(t,s){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[s.getId()]=t,t!=null&&(this.checkAutoHeightsDebounced==null&&(this.checkAutoHeightsDebounced=pi(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let t=!1,s=!0,i=0;const r=this.__autoHeights;if(r==null||(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(a=>{let l=r[a.getId()];if(l==null)if(this.beans.columnModel.isColSpanActive()){let u=[];switch(a.getPinned()){case"left":u=this.beans.columnModel.getDisplayedLeftColumnsForRow(this);break;case"right":u=this.beans.columnModel.getDisplayedRightColumnsForRow(this);break;case null:u=this.beans.columnModel.getViewportCenterColumnsForRow(this);break}if(u.includes(a)){t=!0;return}l=-1}else{t=!0;return}else s=!1;l>i&&(i=l)}),t)||((s||i<10)&&(i=this.beans.gos.getRowHeightForNode(this).height),i==this.rowHeight))return;this.setRowHeight(i);const o=this.beans.rowModel;o.onRowHeightChangedDebounced&&o.onRowHeightChangedDebounced()}setRowIndex(t){this.rowIndex!==t&&(this.rowIndex=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_ROW_INDEX_CHANGED)))}setUiLevel(t){this.uiLevel!==t&&(this.uiLevel=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_UI_LEVEL_CHANGED)))}setExpanded(t,s,i){if(this.expanded===t)return;this.expanded=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_EXPANDED_CHANGED));const r=Object.assign({},this.createGlobalRowEvent(w.EVENT_ROW_GROUP_OPENED),{expanded:t,event:s||null});this.beans.rowNodeEventThrottle.dispatchExpanded(r,i),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(t){return this.beans.gos.addGridCommonParams({type:t,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}dispatchLocalEvent(t){this.eventService&&this.eventService.dispatchEvent(t)}setDataValue(t,s,i){const n=(()=>{var l;return typeof t!="string"?t:(l=this.beans.columnModel.getGridColumn(t))!=null?l:this.beans.columnModel.getPrimaryColumn(t)})(),o=this.getValueFromValueService(n);if(this.beans.gos.get("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(n,o,s,i),!1;const a=this.beans.valueService.setValue(this,n,s,i);return this.dispatchCellChangedEvent(n,s,o),this.checkRowSelectable(),a}getValueFromValueService(t){var s,i;const r=this.leafGroup&&this.beans.columnModel.isPivotMode(),n=this.group&&this.expanded&&!this.footer&&!r;let o=!1;const a=(s=this.beans.gos.get("groupTotalRow"))!=null?s:this.beans.gos.get("groupIncludeFooter");typeof a!="function"?o=!!a:o=!!((i=this.beans.gos.getCallback("groupTotalRow"))!=null?i:this.beans.gos.getCallback("groupIncludeFooter"))({node:this});const l=this.beans.gos.get("groupSuppressBlankHeader"),u=n&&o&&!l;return this.beans.valueService.getValue(t,this,!1,u)}dispatchEventForSaveValueReadOnly(t,s,i,r){const n=this.beans.gos.addGridCommonParams({type:w.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:t,colDef:t.getColDef(),data:this.data,node:this,oldValue:s,newValue:i,value:i,source:r});this.beans.eventService.dispatchEvent(n)}setGroupValue(t,s){const i=this.beans.columnModel.getGridColumn(t);nt(this.groupData)&&(this.groupData={});const r=i.getColId(),n=this.groupData[r];n!==s&&(this.groupData[r]=s,this.dispatchCellChangedEvent(i,s,n))}setAggData(t){const s=this.aggData;if(this.aggData=t,this.eventService){const i=r=>{const n=this.aggData?this.aggData[r]:void 0,o=s?s[r]:void 0;if(n===o)return;const a=this.beans.columnModel.lookupGridColumn(r);a&&this.dispatchCellChangedEvent(a,n,o)};for(const r in this.aggData)i(r);for(const r in t)r in this.aggData||i(r)}}updateHasChildren(){let t=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gos.isRowModelType("serverSide")){const i=this.beans.gos.get("treeData"),r=this.beans.gos.get("isServerSideGroup");t=!this.stub&&!this.footer&&(i?!!r&&r(this.data):!!this.group)}t!==this.__hasChildren&&(this.__hasChildren=!!t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(Wt.EVENT_HAS_CHILDREN_CHANGED)))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return this.group&&yr(this.childrenAfterGroup)}dispatchCellChangedEvent(t,s,i){const r={type:Wt.EVENT_CELL_CHANGED,node:this,column:t,newValue:s,oldValue:i};this.dispatchLocalEvent(r)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.footer?!1:this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(t){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(s=>s.depthFirstSearch(t)),t(this)}calculateSelectedFromChildren(){var t;let s=!1,i=!1,r=!1;if(!((t=this.childrenAfterGroup)!=null&&t.length))return this.selectable?this.selected:null;for(let n=0;n<this.childrenAfterGroup.length;n++){const o=this.childrenAfterGroup[n];let a=o.isSelected();if(!o.selectable){const l=o.calculateSelectedFromChildren();if(l===null)continue;a=l}switch(a){case!0:s=!0;break;case!1:i=!0;break;default:r=!0;break}}if(!(r||s&&i))return s?!0:i?!1:this.selectable?this.selected:null}setSelectedInitialValue(t){this.selected=t}selectThisNode(t,s,i="api"){const r=!this.selectable&&t,n=this.selected===t;if(r||n)return!1;this.selected=t,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(Wt.EVENT_ROW_SELECTED));const o=this.sibling;o&&o.footer&&o.eventService&&o.dispatchLocalEvent(o.createLocalRowEvent(Wt.EVENT_ROW_SELECTED));const a=Jt(Je({},this.createGlobalRowEvent(w.EVENT_ROW_SELECTED)),{event:s||null,source:i});return this.beans.eventService.dispatchEvent(a),!0}setSelected(t,s=!1,i="api"){if(typeof i=="boolean"){console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.");return}this.setSelectedParams({newValue:t,clearSelection:s,rangeSelect:!1,source:i})}setSelectedParams(t){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):this.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(Jt(Je({},t),{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return this.rowPinned==="top"||this.rowPinned==="bottom"}isParentOfNode(t){let s=this.parent;for(;s;){if(s===t)return!0;s=s.parent}return!1}addEventListener(t,s){var i,r;this.eventService||(this.eventService=new rn),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new qS(this.beans.frameworkOverrides));const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.wrap(s))!=null?r:s;this.eventService.addEventListener(t,n)}removeEventListener(t,s){var i,r;if(!this.eventService)return;const n=(r=(i=this.frameworkEventListenerService)==null?void 0:i.unwrap(s))!=null?r:s;this.eventService.removeEventListener(t,n),this.eventService.noRegisteredListenersExist()&&(this.eventService=null)}onMouseEnter(){this.dispatchLocalEvent(this.createLocalRowEvent(Wt.EVENT_MOUSE_ENTER))}onMouseLeave(){this.dispatchLocalEvent(this.createLocalRowEvent(Wt.EVENT_MOUSE_LEAVE))}getFirstChildOfFirstChild(t){let s=this,i=!0,r=!1,n=null;for(;i&&!r;){const o=s.parent;Ce(o)&&s.firstChild?o.rowGroupColumn===t&&(r=!0,n=o):i=!1,s=o}return r?n:null}isFullWidthCell(){if(this.detail)return!0;const t=this.beans.gos.getCallback("isFullWidthRow");return t?t({rowNode:this}):!1}getRoute(){if(this.key==null)return;const t=[];let s=this;for(;s.key!=null;)t.push(s.key),s=s.parent;return t.reverse()}createFooter(){if(this.sibling)return;const t=new Set(["eventService","__objectId","sticky"]),s=new Wt(this.beans);Object.keys(this).forEach(i=>{t.has(i)||(s[i]=this[i])}),s.footer=!0,s.setRowTop(null),s.setRowIndex(null),s.oldRowTop=null,s.id="rowGroupFooter_"+this.id,s.sibling=this,this.sibling=s}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}};Xt.ID_PREFIX_ROW_GROUP="row-group-";Xt.ID_PREFIX_TOP_PINNED="t-";Xt.ID_PREFIX_BOTTOM_PINNED="b-";Xt.OBJECT_ID_SEQUENCE=0;Xt.EVENT_ROW_SELECTED="rowSelected";Xt.EVENT_DATA_CHANGED="dataChanged";Xt.EVENT_CELL_CHANGED="cellChanged";Xt.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged";Xt.EVENT_MASTER_CHANGED="masterChanged";Xt.EVENT_GROUP_CHANGED="groupChanged";Xt.EVENT_MOUSE_ENTER="mouseEnter";Xt.EVENT_MOUSE_LEAVE="mouseLeave";Xt.EVENT_HEIGHT_CHANGED="heightChanged";Xt.EVENT_TOP_CHANGED="topChanged";Xt.EVENT_DISPLAYED_CHANGED="displayedChanged";Xt.EVENT_FIRST_CHILD_CHANGED="firstChildChanged";Xt.EVENT_LAST_CHILD_CHANGED="lastChildChanged";Xt.EVENT_CHILD_INDEX_CHANGED="childIndexChanged";Xt.EVENT_ROW_INDEX_CHANGED="rowIndexChanged";Xt.EVENT_EXPANDED_CHANGED="expandedChanged";Xt.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged";Xt.EVENT_SELECTABLE_CHANGED="selectableChanged";Xt.EVENT_UI_LEVEL_CHANGED="uiLevelChanged";Xt.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged";Xt.EVENT_DRAGGING_CHANGED="draggingChanged";var ft=Xt,qm=class extends ot{constructor(){super(`
            <div class="ag-selection-checkbox" role="presentation">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),s=Gm(e,t),[i,r]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],n=e(i,r);this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${n} (${s})`)}onClicked(e,t,s){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:s.shiftKey,groupSelectsFiltered:t,event:s,source:"checkboxSelected"})}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",i=>{nn(i)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",i=>{nn(i);const r=this.gos.get("groupSelectsFiltered"),n=this.eCheckbox.getValue();this.shouldHandleIndeterminateState(n,r)?this.onClicked(!0,r,i||{})===0&&this.onClicked(!1,r,i):n?this.onClicked(!1,r,i):this.onClicked(!0,r,i||{})}),this.addManagedListener(this.rowNode,ft.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gos.get("isRowSelectable")||typeof this.getIsVisible()=="function"){const i=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,i),this.addManagedListener(this.rowNode,ft.EVENT_DATA_CHANGED,i),this.addManagedListener(this.rowNode,ft.EVENT_CELL_CHANGED,i),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(this.eCheckbox.getPreviousValue()===void 0||e===void 0)&&this.gos.isRowModelType("clientSide")}showOrHideSelect(){var e,t,s;let i=this.rowNode.selectable;const r=this.getIsVisible();if(i)if(typeof r=="function"){const o=(e=this.overrides)==null?void 0:e.callbackParams;if(!this.column)i=r(Jt(Je({},o),{node:this.rowNode,data:this.rowNode.data}));else{const a=this.column.createColumnFunctionCallbackParams(this.rowNode);i=r(Je(Je({},o),a))}}else i=r??!1;if((t=this.column)==null?void 0:t.getColDef().showDisabledCheckboxes){this.eCheckbox.setDisabled(!i),this.setVisible(!0),this.setDisplayed(!0);return}if((s=this.overrides)!=null&&s.removeHidden){this.setDisplayed(i);return}this.setVisible(i)}getIsVisible(){var e,t;return this.overrides?this.overrides.isVisible:(t=(e=this.column)==null?void 0:e.getColDef())==null?void 0:t.checkboxSelection}};f([Ie("eCheckbox")],qm.prototype,"eCheckbox",2);f([Ee],qm.prototype,"postConstruct",1);var $F=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))($F||{}),at=class extends xe{constructor(){super(...arguments),this.dragSourceAndParamsList=[],this.dropTargets=[]}init(){this.ePinnedIcon=fr("columnMovePin",this.gos,null),this.eHideIcon=fr("columnMoveHide",this.gos,null),this.eMoveIcon=fr("columnMoveMove",this.gos,null),this.eLeftIcon=fr("columnMoveLeft",this.gos,null),this.eRightIcon=fr("columnMoveRight",this.gos,null),this.eGroupIcon=fr("columnMoveGroup",this.gos,null),this.eAggregateIcon=fr("columnMoveValue",this.gos,null),this.ePivotIcon=fr("columnMovePivot",this.gos,null),this.eDropNotAllowedIcon=fr("dropNotAllowed",this.gos,null)}addDragSource(e,t=!1){const s={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:s,dragSource:e}),this.dragService.addDragSource(s)}removeDragSource(e){const t=this.dragSourceAndParamsList.find(s=>s.dragSource===e);t&&(this.dragService.removeDragSource(t.params),Fi(this.dragSourceAndParamsList,t))}clearDragSourceParamsList(){this.dragSourceAndParamsList.forEach(e=>this.dragService.removeDragSource(e.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=void 0,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(e){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}onDragging(e,t){var s,i,r,n;const o=this.getHorizontalDirection(e),a=this.getVerticalDirection(e);this.eventLastTime=e,this.positionGhost(e);const l=this.dropTargets.filter(h=>this.isMouseOnDropTarget(e,h)),u=this.findCurrentDropTarget(e,l);if(u!==this.lastDropTarget)this.leaveLastTargetIfExists(e,o,a,t),this.lastDropTarget!==null&&u===null&&((i=(s=this.dragSource).onGridExit)==null||i.call(s,this.dragItem)),this.lastDropTarget===null&&u!==null&&((n=(r=this.dragSource).onGridEnter)==null||n.call(r,this.dragItem)),this.enterDragTargetIfExists(u,e,o,a,t),this.lastDropTarget=u;else if(u&&u.onDragging){const h=this.createDropTargetEvent(u,e,o,a,t);u.onDragging(h)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,s=[[e.getContainer()]];return t?s.concat(t):s}allContainersIntersect(e,t){for(const s of t){const i=s.getBoundingClientRect();if(i.width===0||i.height===0)return!1;const r=e.clientX>=i.left&&e.clientX<i.right,n=e.clientY>=i.top&&e.clientY<i.bottom;if(!r||!n)return!1}return!0}isMouseOnDropTarget(e,t){const s=this.getAllContainersFromDropTarget(t);let i=!1;for(const r of s)if(this.allContainersIntersect(e,r)){i=!0;break}return t.targetContainsSource&&!t.getContainer().contains(this.dragSource.eElement)?!1:i&&t.isInterestedIn(this.dragSource.type,this.dragSource.eElement)}findCurrentDropTarget(e,t){const s=t.length;if(s===0)return null;if(s===1)return t[0];const r=this.gos.getRootNode().elementsFromPoint(e.clientX,e.clientY);for(const n of r)for(const o of t)if(SA(this.getAllContainersFromDropTarget(o)).indexOf(n)!==-1)return o;return null}enterDragTargetIfExists(e,t,s,i,r){if(e){if(e.onDragEnter){const n=this.createDropTargetEvent(e,t,s,i,r);e.onDragEnter(n)}this.setGhostIcon(e.getIconName?e.getIconName():null)}}leaveLastTargetIfExists(e,t,s,i){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const r=this.createDropTargetEvent(this.lastDropTarget,e,t,s,i);this.lastDropTarget.onDragLeave(r)}this.setGhostIcon(null)}}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.filter(s=>s.external).find(s=>s.getContainer()===e.getContainer())||null}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,s=e.clientX;return t===s?null:t>s?0:1}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,s=e.clientY;return t===s?null:t>s?0:1}createDropTargetEvent(e,t,s,i,r){const n=e.getContainer(),o=n.getBoundingClientRect(),{gridApi:a,columnApi:l,dragItem:u,dragSource:h}=this,p=t.clientX-o.left,g=t.clientY-o.top;return{event:t,x:p,y:g,vDirection:i,hDirection:s,dragSource:h,fromNudge:r,dragItem:u,api:a,columnApi:l,dropZoneTarget:n}}positionGhost(e){const t=this.eGhost;if(!t)return;const i=t.getBoundingClientRect().height,r=qA()-2,n=QA()-2,o=g0(t.offsetParent),{clientY:a,clientX:l}=e;let u=a-o.top-i/2,h=l-o.left-10;const p=this.gos.getDocument(),g=p.defaultView||window,m=g.pageYOffset||p.documentElement.scrollTop,C=g.pageXOffset||p.documentElement.scrollLeft;r>0&&h+t.clientWidth>r+C&&(h=r+C-t.clientWidth),h<0&&(h=0),n>0&&u+t.clientHeight>n+m&&(u=n+m-t.clientHeight),u<0&&(u=0),t.style.left=`${h}px`,t.style.top=`${u}px`}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=Oi(at.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);const{theme:e}=this.environment.getTheme();e&&this.eGhost.classList.add(e),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const t=this.eGhost.querySelector(".ag-dnd-ghost-label");let s=this.dragSource.dragItemName;Nm(s)&&(s=s()),t.innerHTML=ys(s)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const i=this.gos.getDocument();let r=null,n=null;try{r=i.fullscreenElement}catch{}finally{r||(r=this.gos.getRootNode());const o=r.querySelector("body");o?n=o:r instanceof ShadowRoot?n=r:r instanceof Document?n=r==null?void 0:r.documentElement:n=r}this.eGhostParent=n,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}setGhostIcon(e,t=!1){fs(this.eGhostIcon);let s=null;switch(e||(e=this.dragSource.getDefaultIconName?this.dragSource.getDefaultIconName():at.ICON_NOT_ALLOWED),e){case at.ICON_PINNED:s=this.ePinnedIcon;break;case at.ICON_MOVE:s=this.eMoveIcon;break;case at.ICON_LEFT:s=this.eLeftIcon;break;case at.ICON_RIGHT:s=this.eRightIcon;break;case at.ICON_GROUP:s=this.eGroupIcon;break;case at.ICON_AGGREGATE:s=this.eAggregateIcon;break;case at.ICON_PIVOT:s=this.ePivotIcon;break;case at.ICON_NOT_ALLOWED:s=this.eDropNotAllowedIcon;break;case at.ICON_HIDE:s=this.eHideIcon;break}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",t),!(s===this.eHideIcon&&this.gos.get("suppressDragLeaveHidesColumns"))&&s&&this.eGhostIcon.appendChild(s)}};at.ICON_PINNED="pinned";at.ICON_MOVE="move";at.ICON_LEFT="left";at.ICON_RIGHT="right";at.ICON_GROUP="group";at.ICON_AGGREGATE="aggregate";at.ICON_PIVOT="pivot";at.ICON_NOT_ALLOWED="notAllowed";at.ICON_HIDE="hide";at.GHOST_TEMPLATE=`<div class="ag-dnd-ghost ag-unselectable">
            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>
            <div class="ag-dnd-ghost-label"></div>
        </div>`;f([A("dragService")],at.prototype,"dragService",2);f([A("mouseEventService")],at.prototype,"mouseEventService",2);f([A("columnApi")],at.prototype,"columnApi",2);f([A("gridApi")],at.prototype,"gridApi",2);f([Ee],at.prototype,"init",1);f([Si],at.prototype,"clearDragSourceParamsList",1);at=f([je("dragAndDropService")],at);var vl=class extends ot{constructor(e,t,s,i,r,n){super(),this.cellValueFn=e,this.rowNode=t,this.column=s,this.customGui=i,this.dragStartPixels=r,this.suppressVisibilityChange=n,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(rs("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gos.get("rowDragManaged")?new qF(this,this.beans,this.rowNode,this.column):new YF(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e),this.addDragSource(t)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const t=this.beans.selectionService.getSelectedNodes();return t.indexOf(this.rowNode)!==-1?t:[this.rowNode]}checkCompatibility(){const e=this.gos.get("rowDragManaged");this.gos.get("treeData")&&e&&tt("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){this.dragSource&&this.removeDragSource();const t=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:this.getGui(),dragItemName:()=>{var s;const i=this.getDragItem(),r=((s=i.rowNodes)==null?void 0:s.length)||1,n=this.getRowDragText(this.column);return n?n(i,r):r===1?this.cellValueFn():`${r} ${t("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}removeDragSource(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}};f([A("beans")],vl.prototype,"beans",2);f([Ee],vl.prototype,"postConstruct",1);f([Si],vl.prototype,"removeDragSource",1);var KF=class extends xe{constructor(e,t,s){super(),this.parent=e,this.rowNode=t,this.column=s}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let s=!0,i=!1;this.column&&(s=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),i=Nm(this.column.getColDef().rowDrag)),i?(this.parent.setDisplayed(!0,t),this.parent.setVisible(s,t)):(this.parent.setDisplayed(s,t),this.parent.setVisible(!0,t))}}},YF=class extends KF{constructor(e,t,s,i){super(e,s,i),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}};f([Ee],YF.prototype,"postConstruct",1);var qF=class extends KF{constructor(e,t,s,i){super(e,s,i),this.beans=t}postConstruct(){this.addManagedListener(this.beans.eventService,w.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const t=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),s=t&&t.shouldPreventRowMove(),i=this.gos.get("suppressRowDrag"),r=this.beans.dragAndDropService.hasExternalDropZones(),n=s&&!r||i;this.setDisplayedOrVisible(n)}};f([Ee],qF.prototype,"postConstruct",1);var Ml=class extends xe{init(e,t,s,i,r,n,o){var a,l,u,h;this.params=o,this.eGui=t,this.eCheckbox=s,this.eExpanded=i,this.eContracted=r,this.comp=e,this.compClass=n;const{node:p,value:g,colDef:m}=o,C=this.isTopLevelFooter();if(!C){if(this.isEmbeddedRowMismatch())return;if(p.footer&&this.gos.get("groupHideOpenParents")){const R=m&&m.showRowGroup,x=p.rowGroupColumn&&p.rowGroupColumn.getColId();if(R!==x)return}}if(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),!C){const y=o.node.footer&&o.node.rowGroupIndex===this.columnModel.getRowGroupColumns().findIndex(H=>{var P;return H.getColId()===((P=o.colDef)==null?void 0:P.showRowGroup)}),x=this.gos.get("groupDisplayType")!="multipleColumns"||this.gos.get("treeData")||this.gos.get("showOpenedGroup")&&!o.node.footer&&(!o.node.group||o.node.rowGroupIndex!=null&&o.node.rowGroupIndex>this.columnModel.getRowGroupColumns().findIndex(H=>{var P;return H.getColId()===((P=o.colDef)==null?void 0:P.showRowGroup)})),S=!p.group&&(((a=this.params.colDef)==null?void 0:a.field)||((l=this.params.colDef)==null?void 0:l.valueGetter)),T=this.isExpandable(),I=this.columnModel.isPivotMode()&&p.leafGroup&&((u=p.rowGroupColumn)==null?void 0:u.getColId())===((h=o.column)==null?void 0:h.getColDef().showRowGroup);if(!this.showingValueForOpenedParent&&!T&&!S&&!x&&!y&&!I)return}this.addExpandAndContract(),this.addFullWidthRowDraggerIfNeeded(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded()}getCellAriaRole(){var e,t;const s=(e=this.params.colDef)==null?void 0:e.cellAriaRole,i=(t=this.params.column)==null?void 0:t.getColDef().cellAriaRole;return s||i||"gridcell"}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node:e,eGridCell:t}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable()){BA(t);return}const s=()=>{Jn(t,!!e.expanded)};this.expandListener=this.addManagedListener(e,ft.EVENT_EXPANDED_CHANGED,s)||null,s()}isTopLevelFooter(){if(!this.gos.getGrandTotalRow()||this.params.value!=null||this.params.node.level!=-1)return!1;const t=this.params.colDef;if(t==null||t.showRowGroup===!0)return!0;const i=this.columnModel.getRowGroupColumns();return!i||i.length===0?!0:i[0].getId()===t.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gos.get("embedFullWidthRows"))return!1;const e=this.params.pinned==="left",t=this.params.pinned==="right",s=!e&&!t;return this.gos.get("enableRtl")?this.columnModel.isPinningLeft()?!t:!s:this.columnModel.isPinningLeft()?!e:!s}findDisplayedGroupNode(){const e=this.params.column,t=this.params.node;if(this.showingValueForOpenedParent){let s=t.parent;for(;s!=null;){if(s.rowGroupColumn&&e.isRowGroupDisplayed(s.rowGroupColumn.getId())){this.displayedGroupNode=s;break}s=s.parent}}nt(this.displayedGroupNode)&&(this.displayedGroupNode=t)}setupShowingValueForOpenedParent(){const e=this.params.node,t=this.params.column;if(!this.gos.get("groupHideOpenParents")){this.showingValueForOpenedParent=!1;return}if(!e.groupData){this.showingValueForOpenedParent=!1;return}if(e.rowGroupColumn!=null){const r=e.rowGroupColumn.getId();if(t.isRowGroupDisplayed(r)){this.showingValueForOpenedParent=!1;return}}const i=e.groupData[t.getId()]!=null;this.showingValueForOpenedParent=i}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){var e;const t=this.adjustParamsWithDetailsFromRelatedColumn(),s=this.getInnerCompDetails(t),{valueFormatted:i,value:r}=t;let n=i;if(n==null){const o=this.displayedGroupNode.rowGroupColumn&&((e=this.params.column)==null?void 0:e.isRowGroupDisplayed(this.displayedGroupNode.rowGroupColumn.getId()));this.displayedGroupNode.key===""&&this.displayedGroupNode.group&&o?n=this.localeService.getLocaleTextFunc()("blanks","(Blanks)"):n=r??null}this.comp.setInnerRenderer(s,n)}adjustParamsWithDetailsFromRelatedColumn(){const e=this.displayedGroupNode.rowGroupColumn,t=this.params.column;if(!e)return this.params;if(t!=null&&!t.isRowGroupDisplayed(e.getId()))return this.params;const i=this.params,{value:r,node:n}=this.params,o=this.valueService.formatValue(e,n,r);return Jt(Je({},i),{valueFormatted:o})}addFooterValue(){let e=this.params.totalValueGetter;if(!e){const i=this.params.footerValueGetter;i&&(e=i,tt("As of v31.3, footerValueGetter is deprecated. Use `totalValueGetter` instead."))}let t="";if(e){const i=KS(this.params);i.value=this.params.value,typeof e=="function"?t=e(i):typeof e=="string"?t=this.expressionService.evaluate(e,i):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else t=this.localeService.getLocaleTextFunc()("footerTotal","Total")+" "+(this.params.value!=null?this.params.value:"");const s=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(s,t)}getInnerCompDetails(e){if(e.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gos.get("groupRowRendererParams"),e);const t=this.userComponentFactory.getInnerRendererDetails(e,e),s=o=>o&&o.componentClass==this.compClass;if(t&&!s(t))return t;const i=this.displayedGroupNode.rowGroupColumn,r=i?i.getColDef():void 0;if(!r)return;const n=this.userComponentFactory.getCellRendererDetails(r,e);if(n&&!s(n))return n;if(s(n)&&r.cellRendererParams&&r.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(r.cellRendererParams,e)}addChildCount(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,ft.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}updateChildCount(){const e=this.displayedGroupNode.allChildrenCount,i=this.isShowRowGroupForThisRow()&&e!=null&&e>=0?`(${e})`:"";this.comp.setChildCount(i)}isShowRowGroupForThisRow(){if(this.gos.get("treeData"))return!0;const e=this.displayedGroupNode.rowGroupColumn;if(!e)return!1;const t=this.params.column;return t==null||t.isRowGroupDisplayed(e.getId())}addExpandAndContract(){var e;const t=this.params,s=rs("groupExpanded",this.gos,null),i=rs("groupContracted",this.gos,null);s&&this.eExpanded.appendChild(s),i&&this.eContracted.appendChild(i);const r=t.eGridCell;!(((e=this.params.column)==null?void 0:e.isCellEditable(t.node))&&this.gos.get("enableGroupEdit"))&&this.isExpandable()&&!t.suppressDoubleClickExpand&&this.addManagedListener(r,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(r,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(t.node,ft.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();const o=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,ft.EVENT_ALL_CHILDREN_COUNT_CHANGED,o),this.addManagedListener(this.displayedGroupNode,ft.EVENT_MASTER_CHANGED,o),this.addManagedListener(this.displayedGroupNode,ft.EVENT_GROUP_CHANGED,o),this.addManagedListener(this.displayedGroupNode,ft.EVENT_HAS_CHILDREN_CHANGED,o)}onExpandClicked(e){en(e)||(nn(e),this.onExpandOrContract(e))}onExpandOrContract(e){const t=this.displayedGroupNode,s=!t.expanded;!s&&t.sticky&&this.scrollToStickyNode(t),t.setExpanded(s,e)}scrollToStickyNode(e){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(e.rowTop-e.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const e=this.displayedGroupNode,t=this.columnModel.isPivotMode()&&e.leafGroup;if(!(e.isExpandable()&&!e.footer&&!t))return!1;const i=this.params.column;return i!=null&&typeof i.getColDef().showRowGroup=="string"?this.isShowRowGroupForThisRow():!0}showExpandAndContractIcons(){const{params:e,displayedGroupNode:t,columnModel:s}=this,{node:i}=e,r=this.isExpandable();if(r){const u=this.showingValueForOpenedParent?!0:i.expanded;this.comp.setExpandedDisplayed(u),this.comp.setContractedDisplayed(!u)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const n=s.isPivotMode(),o=n&&t.leafGroup,a=r&&!o,l=i.footer&&i.level===-1;this.comp.addOrRemoveCssClass("ag-cell-expandable",a),this.comp.addOrRemoveCssClass("ag-row-group",a),n?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",o):l||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!a)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const e=this.params.node;this.params.suppressPadding||(this.addManagedListener(e,ft.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}setIndent(){if(this.gos.get("groupHideOpenParents"))return;const e=this.params,t=e.node,s=!!e.colDef,i=this.gos.get("treeData"),n=!s||i||e.colDef.showRowGroup===!0?t.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+n,this.comp.addOrRemoveCssClass(this.indentClass,!0)}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const e=new vl(()=>this.params.value,this.params.node);this.createManagedBean(e,this.context),this.eGui.insertAdjacentElement("afterbegin",e.getGui())}isUserWantsSelected(){const e=this.params.checkbox;return typeof e=="function"||e===!0}addCheckboxIfNeeded(){const e=this.displayedGroupNode,t=this.isUserWantsSelected()&&!e.footer&&!e.rowPinned&&!e.detail;if(t){const s=new qm;this.getContext().createBean(s),s.init({rowNode:this.params.node,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(s.getGui()),this.addDestroyFunc(()=>this.getContext().destroyBean(s))}this.comp.setCheckboxVisible(t)}onKeyDown(e){!(e.key===z.ENTER)||this.params.suppressEnterExpand||this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(e)}onCellDblClicked(e){if(en(e))return;xf(this.eExpanded,e)||xf(this.eContracted,e)||this.onExpandOrContract(e)}};f([A("expressionService")],Ml.prototype,"expressionService",2);f([A("valueService")],Ml.prototype,"valueService",2);f([A("columnModel")],Ml.prototype,"columnModel",2);f([A("userComponentFactory")],Ml.prototype,"userComponentFactory",2);f([A("ctrlsService")],Ml.prototype,"ctrlsService",2);var Ll=class QF extends ot{constructor(){super(QF.TEMPLATE)}init(t){const s={setInnerRenderer:(o,a)=>this.setRenderDetails(o,a),setChildCount:o=>this.eChildCount.textContent=o,addOrRemoveCssClass:(o,a)=>this.addOrRemoveCssClass(o,a),setContractedDisplayed:o=>Et(this.eContracted,o),setExpandedDisplayed:o=>Et(this.eExpanded,o),setCheckboxVisible:o=>this.eCheckbox.classList.toggle("ag-invisible",!o)},i=this.createManagedBean(new Ml),r=!t.colDef,n=this.getGui();i.init(s,n,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,t),r&&cs(n,i.getCellAriaRole())}setRenderDetails(t,s){if(t){const i=t.newAgStackInstance();if(!i)return;i.then(r=>{if(!r)return;const n=()=>this.context.destroyBean(r);this.isAlive()?(this.eValue.appendChild(r.getGui()),this.addDestroyFunc(n)):n()})}else this.eValue.innerText=s}destroy(){this.getContext().destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}};Ll.TEMPLATE=`<span class="ag-cell-wrapper">
            <span class="ag-group-expanded" ref="eExpanded"></span>
            <span class="ag-group-contracted" ref="eContracted"></span>
            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>
            <span class="ag-group-value" ref="eValue"></span>
            <span class="ag-group-child-count" ref="eChildCount"></span>
        </span>`;f([Ie("eExpanded")],Ll.prototype,"eExpanded",2);f([Ie("eContracted")],Ll.prototype,"eContracted",2);f([Ie("eCheckbox")],Ll.prototype,"eCheckbox",2);f([Ie("eValue")],Ll.prototype,"eValue",2);f([Ie("eChildCount")],Ll.prototype,"eChildCount",2);var bb=Ll,Qm=class ZF extends ot{constructor(){super(ZF.TEMPLATE)}init(t){t.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingError","ERR")}setupLoading(){const t=rs("groupLoading",this.gos,null);t&&this.eLoadingIcon.appendChild(t);const s=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=s("loadingOoo","Loading")}refresh(t){return!1}destroy(){super.destroy()}};Qm.TEMPLATE=`<div class="ag-loading">
            <span class="ag-loading-icon" ref="eLoadingIcon"></span>
            <span class="ag-loading-text" ref="eLoadingText"></span>
        </div>`;f([Ie("eLoadingIcon")],Qm.prototype,"eLoadingIcon",2);f([Ie("eLoadingText")],Qm.prototype,"eLoadingText",2);var yO=Qm,JF=class XF extends ot{constructor(){super(XF.TEMPLATE)}init(t){const s=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",s),this.addDestroyFunc(()=>Uc(t.eParentOfValue)),Uc(t.eParentOfValue,s),t.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const t=this.localeService.getLocaleTextFunc();this.getGui().innerText=t("loadingError","ERR");const s=t("ariaSkeletonCellLoadingFailed","Row failed to load");or(this.getGui(),s)}setupLoading(){const s=this.gos.getDocument().createElement("div");s.classList.add("ag-skeleton-effect"),this.getGui().appendChild(s);const r=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");or(this.getGui(),r)}refresh(t){return!1}destroy(){super.destroy()}};JF.TEMPLATE='<div class="ag-skeleton-container"></div>';var wO=JF,eI=class tI extends ot{constructor(){super()}destroy(){super.destroy()}init(t){const s=this.gos.get("overlayLoadingTemplate");if(this.setTemplate(s??tI.DEFAULT_LOADING_OVERLAY_TEMPLATE),!s){const i=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=i("loadingOoo","Loading...")})}}};eI.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>';var SO=eI,sI=class iI extends ot{constructor(){super()}destroy(){super.destroy()}init(t){const s=this.gos.get("overlayNoRowsTemplate");if(this.setTemplate(s??iI.DEFAULT_NO_ROWS_TEMPLATE),!s){const i=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=i("noRowsToShow","No Rows To Show")})}}};sI.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center"></span>';var xO=sI,EO=class extends kl{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().textContent=ys(t,!0)}},bO=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}init(e,t){this.eInput=e,this.params=t,t.max!=null&&e.setMax(t.max),t.min!=null&&e.setMin(t.min),t.precision!=null&&e.setPrecision(t.precision),t.step!=null&&e.setStep(t.step);const s=e.getInputElement();t.preventStepping?e.addManagedListener(s,"keydown",this.preventStepping):t.showStepperButtons&&s.classList.add("ag-number-field-input-stepper")}preventStepping(e){(e.key===z.UP||e.key===z.DOWN)&&e.preventDefault()}getValue(){const e=this.eInput.getValue();if(!Ce(e)&&!Ce(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(t==null)return t;if(typeof t=="string"){if(t==="")return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}},RO=class extends mp{constructor(){super(new bO)}},TO=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,t.min!=null&&e.setMin(t.min),t.max!=null&&e.setMax(t.max),t.step!=null&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return!Ce(e)&&!Ce(this.params.value)?this.params.value:e??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return br(e,!1)}},DO=class extends mp{constructor(){super(new TO)}},PO=class{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(e,t){this.eInput=e,this.params=t,t.min!=null&&e.setMin(t.min),t.max!=null&&e.setMax(t.max),t.step!=null&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return!Ce(e)&&!Ce(this.params.value)?this.params.value:this.params.parseValue(e??"")}getStartValue(){var e,t;return br((t=this.parseDate((e=this.params.value)!=null?e:void 0))!=null?t:null,!1)}parseDate(e){return this.getDataTypeService().getDateParserFunction(this.params.column)(e)}formatDate(e){return this.getDataTypeService().getDateFormatterFunction(this.params.column)(e)}},rI=class extends mp{constructor(){super(new PO(()=>this.dataTypeService))}};f([A("dataTypeService")],rI.prototype,"dataTypeService",2);var _0=class nI extends ot{constructor(){super(nI.TEMPLATE)}init(t){this.params=t,this.updateCheckbox(t);const s=this.eCheckbox.getInputElement();s.setAttribute("tabindex","-1"),XS(s,"polite"),this.addManagedListener(s,"click",i=>{if(nn(i),this.eCheckbox.isDisabled())return;const r=this.eCheckbox.getValue();this.onCheckboxChanged(r)}),this.addManagedListener(s,"dblclick",i=>{nn(i)}),this.addManagedListener(this.params.eGridCell,"keydown",i=>{if(i.key===z.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===this.gos.getActiveDomElement()&&this.eCheckbox.toggle();const r=this.eCheckbox.getValue();this.onCheckboxChanged(r),i.preventDefault()}})}refresh(t){return this.params=t,this.updateCheckbox(t),!0}updateCheckbox(t){var s,i,r;let n,o=!0;if(t.node.group&&t.column){const p=t.column.getColId();p.startsWith(zc)?n=t.value==null||t.value===""?void 0:t.value==="true":t.node.aggData&&t.node.aggData[p]!==void 0?n=(s=t.value)!=null?s:void 0:o=!1}else n=(i=t.value)!=null?i:void 0;if(!o){this.eCheckbox.setDisplayed(!1);return}this.eCheckbox.setValue(n);const a=t.disabled!=null?t.disabled:!((r=t.column)!=null&&r.isCellEditable(t.node));this.eCheckbox.setDisabled(a);const l=this.localeService.getLocaleTextFunc(),u=Gm(l,n),h=a?u:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${u})`;this.eCheckbox.setInputAriaLabel(h)}onCheckboxChanged(t){const{column:s,node:i,rowIndex:r,value:n}=this.params,o={type:w.EVENT_CELL_EDITING_STARTED,column:s,colDef:s==null?void 0:s.getColDef(),data:i.data,node:i,rowIndex:r,rowPinned:i.rowPinned,value:n};this.eventService.dispatchEvent(o);const a=this.params.node.setDataValue(this.params.column,t,"edit"),l={type:w.EVENT_CELL_EDITING_STOPPED,column:s,colDef:s==null?void 0:s.getColDef(),data:i.data,node:i,rowIndex:r,rowPinned:i.rowPinned,value:n,oldValue:n,newValue:t,valueChanged:a};this.eventService.dispatchEvent(l)}};_0.TEMPLATE=`
        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">
            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
        </div>`;f([Ie("eCheckbox")],_0.prototype,"eCheckbox",2);var AO=_0,oI=class extends kl{constructor(){super(`
            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">
                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>
            </div>`)}init(e){var t;this.params=e;const s=(t=e.value)!=null?t:void 0;this.eCheckbox.setValue(s),this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(s),this.addManagedListener(this.eCheckbox,w.EVENT_FIELD_VALUE_CHANGED,r=>this.setAriaLabel(r.selected))}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),s=Gm(t,e),i=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${i} (${s})`)}};f([Ie("eCheckbox")],oI.prototype,"eCheckbox",2);var FO=class extends ot{constructor(){super(),this.setTemplate("<div></div>")}init(e){var t;this.params=e,this.cssClassPrefix=(t=this.params.cssClassPrefix)!=null?t:"ag-menu-option",this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu()}configureDefaults(){return!0}addIcon(){if(this.params.isCompact)return;const e=Oi(`<span ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`);this.params.checked?e.appendChild(rs("check",this.gos)):this.params.icon&&(cp(this.params.icon)?e.appendChild(this.params.icon):typeof this.params.icon=="string"?e.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(e)}addName(){const e=Oi(`<span ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(e)}addShortcut(){if(this.params.isCompact)return;const e=Oi(`<span ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(e)}addSubMenu(){const e=Oi(`<span ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),t=this.getGui();if(this.params.subMenu){const s=this.gos.get("enableRtl")?"smallLeft":"smallRight";Jn(t,!1),e.appendChild(rs(s,this.gos))}t.appendChild(e)}getClassName(e){return`${this.cssClassPrefix}-${e}`}destroy(){super.destroy()}},Df=class extends xe{constructor(){super(...arguments),this.agGridDefaults={agDateInput:_F,agColumnHeader:tw,agColumnGroupHeader:gO,agSortIndicator:F0,agTextColumnFloatingFilter:pO,agNumberColumnFloatingFilter:hO,agDateColumnFloatingFilter:Km,agReadOnlyFloatingFilter:E0,agAnimateShowChangeCellRenderer:zF,agAnimateSlideCellRenderer:UF,agGroupCellRenderer:bb,agGroupRowRenderer:bb,agLoadingCellRenderer:yO,agSkeletonCellRenderer:wO,agCheckboxCellRenderer:AO,agCellEditor:Eb,agTextCellEditor:Eb,agNumberCellEditor:RO,agDateCellEditor:DO,agDateStringCellEditor:rI,agSelectCellEditor:N0,agLargeTextCellEditor:fO,agCheckboxCellEditor:oI,agTextColumnFilter:A0,agNumberColumnFilter:OF,agDateColumnFilter:NF,agLoadingOverlay:SO,agNoRowsOverlay:xO,agTooltipComponent:EO,agMenuItem:FO},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}init(){const e=this.gos.get("components");e!=null&&ei(e,(t,s)=>this.registerJsComponent(t,s))}registerDefaultComponent(e,t){if(this.agGridDefaults[e]){console.error("Trying to overwrite a default component. You should call registerComponent");return}this.agGridDefaults[e]=t}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const s=(a,l)=>({componentFromFramework:l,component:a}),i=this.getFrameworkOverrides().frameworkComponent(t,this.gos.get("components"));if(i!=null)return s(i,!0);const r=this.jsComps[t];if(r){const a=this.getFrameworkOverrides().isFrameworkComponent(r);return s(r,a)}const n=this.agGridDefaults[t];if(n)return s(n,!1);const o=this.enterpriseAgDefaultCompsModule[t];return o?Nt.__assertRegistered(o,`AG Grid '${e}' component: ${t}`,this.context.getGridId()):Wc(()=>{this.warnAboutMissingComponent(e,t)},"MissingComp"+t),null}warnAboutMissingComponent(e,t){const s=[...Object.keys(this.agGridDefaults).filter(r=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(r)),...Object.keys(this.jsComps)],i=up(t,s,!0,.8).values;console.warn(`AG Grid: Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),i.length>0&&console.warn(`         Did you mean: [${i.slice(0,3)}]?`),console.warn(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}};f([Ee],Df.prototype,"init",1);Df=f([je("userComponentRegistry")],Df);var IO={propertyName:"dateComponent",cellRenderer:!1},NO={propertyName:"headerComponent",cellRenderer:!1},_O={propertyName:"headerGroupComponent",cellRenderer:!1},Rb={propertyName:"cellRenderer",cellRenderer:!0},kO={propertyName:"loadingCellRenderer",cellRenderer:!0},MO={propertyName:"cellEditor",cellRenderer:!1},Tb={propertyName:"innerRenderer",cellRenderer:!0},LO={propertyName:"loadingOverlayComponent",cellRenderer:!1},OO={propertyName:"noRowsOverlayComponent",cellRenderer:!1},GO={propertyName:"tooltipComponent",cellRenderer:!1},sw={propertyName:"filter",cellRenderer:!1},VO={propertyName:"floatingFilterComponent",cellRenderer:!1},BO={propertyName:"toolPanel",cellRenderer:!1},HO={propertyName:"statusPanel",cellRenderer:!1},jO={propertyName:"fullWidthCellRenderer",cellRenderer:!0},WO={propertyName:"loadingCellRenderer",cellRenderer:!0},zO={propertyName:"groupRowRenderer",cellRenderer:!0},UO={propertyName:"detailCellRenderer",cellRenderer:!0},$O={propertyName:"menuItem",cellRenderer:!1},aI=class{static getFloatingFilterType(e){return this.filterToFloatingFilterMapping[e]}};aI.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var ta=class extends xe{getHeaderCompDetails(e,t){return this.getCompDetails(e,NO,"agColumnHeader",t)}getHeaderGroupCompDetails(e){const t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,_O,"agColumnGroupHeader",e)}getFullWidthCellRendererDetails(e){return this.getCompDetails(this.gridOptions,jO,null,e,!0)}getFullWidthLoadingCellRendererDetails(e){return this.getCompDetails(this.gridOptions,WO,"agLoadingCellRenderer",e,!0)}getFullWidthGroupCellRendererDetails(e){return this.getCompDetails(this.gridOptions,zO,"agGroupRowRenderer",e,!0)}getFullWidthDetailCellRendererDetails(e){return this.getCompDetails(this.gridOptions,UO,"agDetailCellRenderer",e,!0)}getInnerRendererDetails(e,t){return this.getCompDetails(e,Tb,null,t)}getFullWidthGroupRowInnerCellRenderer(e,t){return this.getCompDetails(e,Tb,null,t)}getCellRendererDetails(e,t){return this.getCompDetails(e,Rb,null,t)}getLoadingCellRendererDetails(e,t){return this.getCompDetails(e,kO,"agSkeletonCellRenderer",t,!0)}getCellEditorDetails(e,t){return this.getCompDetails(e,MO,"agCellEditor",t,!0)}getFilterDetails(e,t,s){return this.getCompDetails(e,sw,s,t,!0)}getDateCompDetails(e){return this.getCompDetails(this.gridOptions,IO,"agDateInput",e,!0)}getLoadingOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,LO,"agLoadingOverlay",e,!0)}getNoRowsOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,OO,"agNoRowsOverlay",e,!0)}getTooltipCompDetails(e){return this.getCompDetails(e.colDef,GO,"agTooltipComponent",e,!0)}getSetFilterCellRendererDetails(e,t){return this.getCompDetails(e,Rb,null,t)}getFloatingFilterCompDetails(e,t,s){return this.getCompDetails(e,VO,s,t)}getToolPanelCompDetails(e,t){return this.getCompDetails(e,BO,null,t,!0)}getStatusPanelCompDetails(e,t){return this.getCompDetails(e,HO,null,t,!0)}getMenuItemCompDetails(e,t){return this.getCompDetails(e,$O,"agMenuItem",t,!0)}getCompDetails(e,t,s,i,r=!1){const{propertyName:n,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:u,paramsFromSelector:h,popupFromSelector:p,popupPositionFromSelector:g}=this.getCompKeys(e,t,i);const m=x=>{const S=this.userComponentRegistry.retrieve(n,x);S&&(l=S.componentFromFramework?void 0:S.component,u=S.componentFromFramework?S.component:void 0)};if(a!=null&&m(a),l==null&&u==null&&s!=null&&m(s),l&&o&&!this.agComponentUtils.doesImplementIComponent(l)&&(l=this.agComponentUtils.adaptFunction(n,l)),!l&&!u){r&&console.error(`AG Grid: Could not find component ${a}, did you forget to configure this component?`);return}const C=this.mergeParamsWithApplicationProvidedParams(e,t,i,h),y=l==null,R=l||u;return{componentFromFramework:y,componentClass:R,params:C,type:t,popupFromSelector:p,popupPositionFromSelector:g,newAgStackInstance:()=>this.newAgStackInstance(R,y,C,t)}}getCompKeys(e,t,s){const{propertyName:i}=t;let r,n,o,a,l,u;if(e){const h=e,p=h[i+"Selector"],g=p?p(s):null,m=C=>{typeof C=="string"?r=C:C!=null&&C!==!0&&(this.getFrameworkOverrides().isFrameworkComponent(C)?o=C:n=C)};g?(m(g.component),a=g.params,l=g.popup,u=g.popupPosition):m(h[i])}return{compName:r,jsComp:n,fwComp:o,paramsFromSelector:a,popupFromSelector:l,popupPositionFromSelector:u}}newAgStackInstance(e,t,s,i){const r=i.propertyName,n=!t;let o;if(n)o=new e;else{const l=this.componentMetadataProvider.retrieve(r);o=this.frameworkComponentWrapper.wrap(e,l.mandatoryMethodList,l.optionalMethodList,i)}const a=this.initComponent(o,s);return a==null?ws.resolve(o):a.then(()=>o)}mergeParamsWithApplicationProvidedParams(e,t,s,i=null){const r=this.gos.getGridCommonParams();Mi(r,s);const n=e,o=n&&n[t.propertyName+"Params"];if(typeof o=="function"){const a=o(s);Mi(r,a)}else typeof o=="object"&&Mi(r,o);return Mi(r,i),r}initComponent(e,t){if(this.context.createBean(e),e.init!=null)return e.init(t)}getDefaultFloatingFilterType(e,t){if(e==null)return null;let s=null,{compName:i,jsComp:r,fwComp:n}=this.getCompKeys(e,sw);return i?s=aI.getFloatingFilterType(i):r==null&&n==null&&e.filter===!0&&(s=t()),s}};f([A("gridOptions")],ta.prototype,"gridOptions",2);f([A("agComponentUtils")],ta.prototype,"agComponentUtils",2);f([A("componentMetadataProvider")],ta.prototype,"componentMetadataProvider",2);f([A("userComponentRegistry")],ta.prototype,"userComponentRegistry",2);f([Lt("frameworkComponentWrapper")],ta.prototype,"frameworkComponentWrapper",2);ta=f([je("userComponentFactory")],ta);var lI=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.indexOf("x")!==-1,this.scrollVertically=e.scrollAxis.indexOf("y")!==-1,this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){const s=t||this.shouldSkipVerticalScroll();if(s&&this.shouldSkipHorizontalScroll())return;const i=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<i.left+r,this.tickRight=e.clientX>i.right-r,this.tickUp=e.clientY<i.top+r&&!s,this.tickDown=e.clientY>i.bottom-r&&!s,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let e;if(e=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},ur=class extends xe{constructor(e){super(),this.eContainer=e}postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(e=>{const t=e.gridBodyCtrl;this.autoScrollService=new lI({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:s=>t.getScrollFeature().setVerticalScrollPosition(s),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?at.ICON_NOT_ALLOWED:at.ICON_MOVE}shouldPreventRowMove(){return!!(this.columnModel.getRowGroupColumns().length||this.filterManager.isAnyFilterPresent()||this.sortController.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const i=[...this.selectionService.getSelectedNodes()].sort((r,n)=>r.rowIndex==null||n.rowIndex==null?0:this.getRowIndexNumber(r)-this.getRowIndexNumber(n));if(i.indexOf(t)!==-1)return i}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent(w.EVENT_ROW_DRAG_ENTER,e),this.getRowNodes(e).forEach(t=>{t.setDragging(!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}isDropZoneWithinThisGrid(e){const s=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:i}=e;return!s.contains(i)}onEnterOrDragging(e){this.dispatchGridEvent(w.EVENT_ROW_DRAG_MOVE,e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const s=this.isFromThisGrid(e),i=this.gos.get("rowDragManaged"),r=e.dragItem.rowNodes;i&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!s?this.isDropZoneWithinThisGrid(e)||this.clientSideRowModel.highlightRowAtPixel(r[0],t):this.moveRows(r,t))}getRowIndexNumber(e){return parseInt(At(e.getRowIndexString().split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel.getLastHighlightedRowNode(),s=t&&t.highlighted===1,i=this.mouseEventService.getNormalisedPosition(e).y,r=e.dragItem.rowNodes;let n=s?1:0;if(this.isFromThisGrid(e))r.forEach(o=>{o.rowTop<i&&(n-=1)}),this.moveRows(r,i,n);else{const o=this.gos.getCallback("getRowId");let a=this.clientSideRowModel.getRowIndexAtPixel(i)+1;this.clientSideRowModel.getHighlightPosition(i)===0&&a--,this.clientSideRowModel.updateRowData({add:r.map(l=>l.data).filter(l=>!this.clientSideRowModel.getRowNode(o?o({data:l,level:0}):l.id)),addIndex:a})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t,s=0){var i;this.clientSideRowModel.ensureRowsAtPixel(e,t,s)&&(this.focusService.clearFocusedCell(),(i=this.rangeService)==null||i.removeAllCellRanges())}addRowDropZone(e){if(!e.getContainer()){tt("addRowDropZone - A container target needs to be provided");return}if(this.dragAndDropService.findExternalZone(e)){console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");return}let t={getContainer:e.getContainer};e.fromGrid?t=e:(e.onDragEnter&&(t.onDragEnter=s=>{e.onDragEnter(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_ENTER,s))}),e.onDragLeave&&(t.onDragLeave=s=>{e.onDragLeave(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_LEAVE,s))}),e.onDragging&&(t.onDragging=s=>{e.onDragging(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_MOVE,s))}),e.onDragStop&&(t.onDragStop=s=>{e.onDragStop(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_END,s))})),this.dragAndDropService.addDropTarget(Je({isInterestedIn:s=>s===2,getIconName:()=>at.ICON_MOVE,external:!0},t))}getRowDropZone(e){const t=this.getContainer.bind(this),s=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),r=this.onDragging.bind(this),n=this.onDragStop.bind(this);return e?{getContainer:t,onDragEnter:e.onDragEnter?o=>{s(o),e.onDragEnter(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_ENTER,o))}:s,onDragLeave:e.onDragLeave?o=>{i(o),e.onDragLeave(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_LEAVE,o))}:i,onDragging:e.onDragging?o=>{r(o),e.onDragging(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_MOVE,o))}:r,onDragStop:e.onDragStop?o=>{n(o),e.onDragStop(this.draggingToRowDragEvent(w.EVENT_ROW_DRAG_END,o))}:n,fromGrid:!0}:{getContainer:t,onDragEnter:s,onDragLeave:i,onDragging:r,onDragStop:n,fromGrid:!0}}draggingToRowDragEvent(e,t){const s=this.mouseEventService.getNormalisedPosition(t).y,i=s>this.paginationProxy.getCurrentPageHeight();let r=-1,n;i||(r=this.rowModel.getRowIndexAtPixel(s),n=this.rowModel.getRow(r));let o;switch(t.vDirection){case 1:o="down";break;case 0:o="up";break;default:o=null;break}return this.gos.addGridCommonParams({type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:r,overNode:n,y:s,vDirection:o})}dispatchGridEvent(e,t){const s=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(s)}onDragLeave(e){this.dispatchGridEvent(w.EVENT_ROW_DRAG_LEAVE,e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent(w.EVENT_ROW_DRAG_END,e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&!this.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(t=>{t.setDragging(!1)})}};f([A("dragAndDropService")],ur.prototype,"dragAndDropService",2);f([A("rowModel")],ur.prototype,"rowModel",2);f([A("paginationProxy")],ur.prototype,"paginationProxy",2);f([A("columnModel")],ur.prototype,"columnModel",2);f([A("focusService")],ur.prototype,"focusService",2);f([A("sortController")],ur.prototype,"sortController",2);f([A("filterManager")],ur.prototype,"filterManager",2);f([A("selectionService")],ur.prototype,"selectionService",2);f([A("mouseEventService")],ur.prototype,"mouseEventService",2);f([A("ctrlsService")],ur.prototype,"ctrlsService",2);f([Lt("rangeService")],ur.prototype,"rangeService",2);f([Ee],ur.prototype,"postConstruct",1);var ph=class extends xe{constructor(){super(...arguments),this.dragEndFunctions=[],this.dragSources=[]}removeAllListeners(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}removeListener(e){const t=e.dragSource.eElement,s=e.mouseDownListener;if(t.removeEventListener("mousedown",s),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(e){const t=this.dragSources.find(s=>s.dragSource===e);t&&(this.removeListener(t),Fi(this.dragSources,t))}isDragging(){return this.dragging}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:s,includeTouch:i,stopPropagationForTouch:r}=e;s.addEventListener("mousedown",t);let n=null;const o=this.gos.get("suppressTouch");i&&!o&&(n=a=>{h0(a.target)||(a.cancelable&&(a.preventDefault(),r&&a.stopPropagation()),this.onTouchStart(e,a))},s.addEventListener("touchstart",n,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:n,touchEnabled:!!i})}getStartTarget(){return this.startTarget}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const s=t.touches[0];this.touchLastTime=s,this.touchStart=s;const i=l=>this.onTouchMove(l,e.eElement),r=l=>this.onTouchUp(l,e.eElement),n=l=>{l.cancelable&&l.preventDefault()},o=t.target,a=[{target:this.gos.getRootNode(),type:"touchmove",listener:n,options:{passive:!1}},{target:o,type:"touchmove",listener:i,options:{passive:!0}},{target:o,type:"touchend",listener:r,options:{passive:!0}},{target:o,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onCommonMove(s,this.touchStart,e.eElement)}onMouseDown(e,t){const s=t;if(e.skipMouseEvent&&e.skipMouseEvent(t)||s._alreadyProcessedByDragService||(s._alreadyProcessedByDragService=!0,t.button!==0))return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const i=l=>this.onMouseMove(l,e.eElement),r=l=>this.onMouseUp(l,e.eElement),n=l=>l.preventDefault(),o=this.gos.getRootNode(),a=[{target:o,type:"mousemove",listener:i},{target:o,type:"mouseup",listener:r},{target:o,type:"contextmenu",listener:n}];this.addTemporaryEvents(a),e.dragStartPixels===0&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(t=>{const{target:s,type:i,listener:r,options:n}=t;s.addEventListener(i,r,n)}),this.dragEndFunctions.push(()=>{e.forEach(t=>{const{target:s,type:i,listener:r,options:n}=t;s.removeEventListener(i,r,n)})})}isEventNearStartEvent(e,t){const{dragStartPixels:s}=this.currentDragParams,i=Ce(s)?s:4;return S0(e,t,i)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,s){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(e,t))return;this.dragging=!0;const i={type:w.EVENT_DRAG_STARTED,target:s};this.eventService.dispatchEvent(i),this.currentDragParams.onDragStart(t),this.currentDragParams.onDragging(t)}this.currentDragParams.onDragging(e)}onTouchMove(e,t){const s=this.getFirstActiveTouch(e.touches);s&&this.onCommonMove(s,this.touchStart,t)}onMouseMove(e,t){var s;Pn()&&((s=this.gos.getDocument().getSelection())==null||s.removeAllRanges()),this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gos.get("enableCellTextSelection"),s=e.type==="mousemove";return t&&s&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,s=t==null?void 0:t.tagName.toLocaleLowerCase();return!!(s!=null&&s.match("^a$|textarea|input|select|button"))}onTouchUp(e,t){let s=this.getFirstActiveTouch(e.changedTouches);s||(s=this.touchLastTime),this.onUpCommon(s,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(e);const s={type:w.EVENT_DRAG_STOPPED,target:t};this.eventService.dispatchEvent(s)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(s=>s()),this.dragEndFunctions.length=0}};f([A("mouseEventService")],ph.prototype,"mouseEventService",2);f([Si],ph.prototype,"removeAllListeners",1);ph=f([je("dragService")],ph);var hC="ag-list-item-hovered",cI=class extends xe{constructor(e,t,s){super(),this.comp=e,this.virtualList=t,this.params=s,this.currentDragValue=null,this.lastHoveredListItem=null}postConstruct(){this.addManagedListener(this.params.eventSource,this.params.listItemDragStartEvent,this.listItemDragStart.bind(this)),this.addManagedListener(this.params.eventSource,this.params.listItemDragEndEvent,this.listItemDragEnd.bind(this)),this.createDropTarget(),this.createAutoScrollService()}listItemDragStart(e){this.currentDragValue=this.params.getCurrentDragValue(e),this.moveBlocked=this.params.isMoveBlocked(this.currentDragValue)}listItemDragEnd(){window.setTimeout(()=>{this.currentDragValue=null,this.moveBlocked=!1},10)}createDropTarget(){const e={isInterestedIn:t=>t===this.params.dragSourceType,getIconName:()=>this.moveBlocked?at.ICON_PINNED:at.ICON_MOVE,getContainer:()=>this.comp.getGui(),onDragging:t=>this.onDragging(t),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave()};this.dragAndDropService.addDropTarget(e)}createAutoScrollService(){const e=this.virtualList.getGui();this.autoScrollService=new lI({scrollContainer:e,scrollAxis:"y",getVerticalPosition:()=>e.scrollTop,setVerticalPosition:t=>e.scrollTop=t})}onDragging(e){if(!this.currentDragValue||this.moveBlocked)return;const t=this.getListDragItem(e),s=this.virtualList.getComponentAt(t.rowIndex);if(!s)return;const i=s.getGui().parentElement;this.lastHoveredListItem&&this.lastHoveredListItem.rowIndex===t.rowIndex&&this.lastHoveredListItem.position===t.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredListItem=t,Jy(i,hC),Jy(i,`ag-item-highlight-${t.position}`))}getListDragItem(e){const t=this.virtualList.getGui(),s=parseFloat(window.getComputedStyle(t).paddingTop),i=this.virtualList.getRowHeight(),r=this.virtualList.getScrollTop(),n=Math.max(0,(e.y-s+r)/i),o=this.params.getNumRows(this.comp)-1,a=Math.min(o,n)|0;return{rowIndex:a,position:Math.round(n)>n||n>o?"bottom":"top",component:this.virtualList.getComponentAt(a)}}onDragStop(){this.moveBlocked||(this.params.moveItem(this.currentDragValue,this.lastHoveredListItem),this.clearHoveredItems(),this.autoScrollService.ensureCleared())}onDragLeave(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll(`.${hC}`).forEach(t=>{[hC,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(s=>{t.classList.remove(s)})}),this.lastHoveredListItem=null}};f([A("dragAndDropService")],cI.prototype,"dragAndDropService",2);f([Ee],cI.prototype,"postConstruct",1);function $a(e){const t=e;return t!=null&&t.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}var yt=class{constructor(){this.detailGridInfoMap={},this.destroyCalled=!1}init(){switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel;break}this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl})}__getAlignedGridService(){return this.alignedGridsService}getGridId(){return this.context.getGridId()}addDetailGridInfo(e,t){this.detailGridInfoMap[e]=t}removeDetailGridInfo(e){delete this.detailGridInfoMap[e]}getDetailGridInfo(e){return this.detailGridInfoMap[e]}forEachDetailGridInfo(e){let t=0;ei(this.detailGridInfoMap,(s,i)=>{Ce(i)&&(e(i,t),t++)})}getDataAsCsv(e){if(Nt.__assertRegistered("@ag-grid-community/csv-export","api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(e)}exportDataAsCsv(e){Nt.__assertRegistered("@ag-grid-community/csv-export","api.exportDataAsCsv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(e)}assertNotExcelMultiSheet(e,t){return Nt.__assertRegistered("@ag-grid-enterprise/excel-export","api."+e,this.context.getGridId())?this.excelCreator.getFactoryMode()===1?(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1):!0:!1}getDataAsExcel(e){if(this.assertNotExcelMultiSheet("getDataAsExcel",e))return this.excelCreator.getDataAsExcel(e)}exportDataAsExcel(e){this.assertNotExcelMultiSheet("exportDataAsExcel",e)&&this.excelCreator.exportDataAsExcel(e)}getSheetDataForExcel(e){if(Nt.__assertRegistered("@ag-grid-enterprise/excel-export","api.getSheetDataForExcel",this.context.getGridId()))return this.excelCreator.setFactoryMode(1),this.excelCreator.getSheetDataForExcel(e)}getMultipleSheetsAsExcel(e){if(Nt.__assertRegistered("@ag-grid-enterprise/excel-export","api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(e)}exportMultipleSheetsAsExcel(e){Nt.__assertRegistered("@ag-grid-enterprise/excel-export","api.exportMultipleSheetsAsExcel",this.context.getGridId())&&this.excelCreator.exportMultipleSheetsAsExcel(e)}setGridAriaProperty(e,t){if(!e)return;const s=this.ctrlsService.getGridBodyCtrl().getGui(),i=`aria-${e}`;t===null?s.removeAttribute(i):s.setAttribute(i,t)}logMissingRowModel(e,...t){console.error(`AG Grid: api.${e} can only be called when gridOptions.rowModelType is ${t.join(" or ")}`)}logDeprecation(e,t,s,i){tt(`Since ${e} api.${t} is deprecated. Please use ${s} instead. ${i??""}`)}getPinnedTopRowCount(){return this.pinnedRowModel.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.pinnedRowModel.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.pinnedRowModel.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.pinnedRowModel.getPinnedBottomRow(e)}expireValueCache(){this.valueCache.expire()}getVerticalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}getHorizontalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}refreshCells(e={}){this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.refreshCells(e))}flashCells(e={}){const t=s=>tt(`Since v31.1 api.flashCells parameter '${s}Delay' is deprecated. Please use '${s}Duration' instead.`);Ce(e.fadeDelay)&&t("fade"),Ce(e.flashDelay)&&t("flash"),this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.flashCells(e))}redrawRows(e={}){const t=e?e.rowNodes:void 0;this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.redrawRows(t))}refreshHeader(){this.frameworkOverrides.wrapIncoming(()=>this.ctrlsService.getHeaderRowContainerCtrls().forEach(e=>e.refresh()))}isAnyFilterPresent(){return this.filterManager.isAnyFilterPresent()}isColumnFilterPresent(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}isQuickFilterPresent(){return this.filterManager.isQuickFilterPresent()}getModel(){return tt("Since v31.1 getModel() is deprecated. Please use the appropriate grid API methods instead."),this.rowModel}setRowNodeExpanded(e,t,s,i){this.expansionService.setRowNodeExpanded(e,t,s,i)}onGroupExpandedOrCollapsed(){if(nt(this.clientSideRowModel)){this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide");return}this.expansionService.onGroupExpandedOrCollapsed()}refreshClientSideRowModel(e){if(nt(this.clientSideRowModel)){this.logMissingRowModel("refreshClientSideRowModel","clientSide");return}this.clientSideRowModel.refreshModel(e)}isAnimationFrameQueueEmpty(){return this.animationFrameService.isQueueEmpty()}flushAllAnimationFrames(){this.animationFrameService.flushAllFrames()}getRowNode(e){return this.rowModel.getRowNode(e)}getSizesForCurrentTheme(){return{rowHeight:this.gos.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}expandAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}collapseAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!1):this.logMissingRowModel("collapseAll","clientSide","serverSide")}addRenderedRowListener(e,t,s){this.rowRenderer.addRenderedRowListener(e,t,s)}getQuickFilter(){return this.gos.get("quickFilterText")}getAdvancedFilterModel(){return Nt.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.getAdvancedFilterModel",this.context.getGridId())?this.filterManager.getAdvancedFilterModel():null}setAdvancedFilterModel(e){this.filterManager.setAdvancedFilterModel(e)}showAdvancedFilterBuilder(){Nt.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.setAdvancedFilterModel",this.context.getGridId())&&this.filterManager.showAdvancedFilterBuilder("api")}setNodesSelected(e){if(!e.nodes.every(o=>o.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):o.id===void 0?(console.warn("AG Grid: cannot select node until id for node is known"),!1):!0))return;const{nodes:s,source:i,newValue:r}=e,n=s;this.selectionService.setNodesSelected({nodes:n,source:i??"api",newValue:r})}selectAll(e="apiSelectAll"){this.selectionService.selectAllRowNodes({source:e})}deselectAll(e="apiSelectAll"){this.selectionService.deselectAllRowNodes({source:e})}selectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.selectAllRowNodes({source:e,justFiltered:!0})}deselectAllFiltered(e="apiSelectAllFiltered"){this.selectionService.deselectAllRowNodes({source:e,justFiltered:!0})}getServerSideSelectionState(){return nt(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getSelectionState()}setServerSideSelectionState(e){if(nt(this.serverSideRowModel)){this.logMissingRowModel("setServerSideSelectionState","serverSide");return}this.selectionService.setSelectionState(e,"api")}selectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.selectAllRowNodes({source:e,justCurrentPage:!0})}deselectAllOnCurrentPage(e="apiSelectAllCurrentPage"){this.selectionService.deselectAllRowNodes({source:e,justCurrentPage:!0})}showLoadingOverlay(){this.overlayService.showLoadingOverlay()}showNoRowsOverlay(){this.overlayService.showNoRowsOverlay()}hideOverlay(){this.overlayService.hideOverlay()}getSelectedNodes(){return this.selectionService.getSelectedNodes()}getSelectedRows(){return this.selectionService.getSelectedRows()}getBestCostNodeSelection(){if(nt(this.clientSideRowModel)){this.logMissingRowModel("getBestCostNodeSelection","clientSide");return}return this.selectionService.getBestCostNodeSelection()}getRenderedNodes(){return this.rowRenderer.getRenderedNodes()}ensureColumnVisible(e,t="auto"){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(e,t),"ensureVisible")}ensureIndexVisible(e,t){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(e,t),"ensureVisible")}ensureNodeVisible(e,t=null){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(e,t),"ensureVisible")}forEachLeafNode(e){if(nt(this.clientSideRowModel)){this.logMissingRowModel("forEachLeafNode","clientSide");return}this.clientSideRowModel.forEachLeafNode(e)}forEachNode(e,t){this.rowModel.forEachNode(e,t)}forEachNodeAfterFilter(e){if(nt(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilter","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilter(e)}forEachNodeAfterFilterAndSort(e){if(nt(this.clientSideRowModel)){this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide");return}this.clientSideRowModel.forEachNodeAfterFilterAndSort(e)}getFilterInstance(e,t){return tt("'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."),this.filterManager.getFilterInstance(e,t)}getColumnFilterInstance(e){return this.filterManager.getColumnFilterInstance(e)}destroyFilter(e){const t=this.columnModel.getPrimaryColumn(e);if(t)return this.filterManager.destroyFilter(t,"api")}getStatusPanel(e){if(!Nt.__assertRegistered("@ag-grid-enterprise/status-bar","api.getStatusPanel",this.context.getGridId()))return;const t=this.statusBarService.getStatusPanel(e);return $a(t)}getColumnDef(e){const t=this.columnModel.getPrimaryColumn(e);return t?t.getColDef():null}getColumnDefs(){return this.columnModel.getColumnDefs()}onFilterChanged(e="api"){this.filterManager.onFilterChanged({source:e})}onSortChanged(){this.sortController.onSortChanged("api")}setFilterModel(e){this.frameworkOverrides.wrapIncoming(()=>this.filterManager.setFilterModel(e))}getFilterModel(){return this.filterManager.getFilterModel()}getColumnFilterModel(e){return this.filterManager.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.filterManager.setColumnFilterModel(e,t)}getFocusedCell(){return this.focusService.getFocusedCell()}clearFocusedCell(){return this.focusService.clearFocusedCell()}setFocusedCell(e,t,s){this.focusService.setFocusedCell({rowIndex:e,column:t,rowPinned:s,forceBrowserFocus:!0})}addRowDropZone(e){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(e)}removeRowDropZone(e){const t=this.dragAndDropService.findExternalZone(e);t&&this.dragAndDropService.removeDropTarget(t)}getRowDropZoneParams(e){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(e)}assertSideBarLoaded(e){return Nt.__assertRegistered("@ag-grid-enterprise/side-bar","api."+e,this.context.getGridId())}isSideBarVisible(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarService.getSideBarComp().isDisplayed()}setSideBarVisible(e){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarService.getSideBarComp().setDisplayed(e)}setSideBarPosition(e){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarService.getSideBarComp().setSideBarPosition(e)}openToolPanel(e){this.assertSideBarLoaded("openToolPanel")&&this.sideBarService.getSideBarComp().openToolPanel(e,"api")}closeToolPanel(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarService.getSideBarComp().close("api")}getOpenedToolPanel(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarService.getSideBarComp().openedItem():null}refreshToolPanel(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarService.getSideBarComp().refresh()}isToolPanelShowing(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarService.getSideBarComp().isToolPanelShowing()}getToolPanelInstance(e){if(this.assertSideBarLoaded("getToolPanelInstance")){const t=this.sideBarService.getSideBarComp().getToolPanelInstance(e);return $a(t)}}getSideBar(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarService.getSideBarComp().getDef()}resetRowHeights(){if(Ce(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive()){console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");return}this.clientSideRowModel.resetRowHeights()}}setRowCount(e,t){if(this.serverSideRowModel){if(this.columnModel.isRowGroupEmpty()){this.serverSideRowModel.setRowCount(e,t);return}console.error("AG Grid: setRowCount cannot be used while using row grouping.");return}if(this.infiniteRowModel){this.infiniteRowModel.setRowCount(e,t);return}this.logMissingRowModel("setRowCount","infinite","serverSide")}onRowHeightChanged(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}getValue(e,t){return this.logDeprecation("31.3","getValue","getCellValue"),this.getCellValue({colKey:e,rowNode:t})}getCellValue(e){var t;const{colKey:s,rowNode:i,useFormatter:r}=e;let n=(t=this.columnModel.getPrimaryColumn(s))!=null?t:this.columnModel.getGridColumn(s);if(nt(n))return null;const o=this.valueService.getValue(n,i);if(r){const a=this.valueService.formatValue(n,i,o);return a??ys(o,!0)}return o}addEventListener(e,t){this.apiEventService.addEventListener(e,t)}addGlobalListener(e){this.apiEventService.addGlobalListener(e)}removeEventListener(e,t){this.apiEventService.removeEventListener(e,t)}removeGlobalListener(e){this.apiEventService.removeGlobalListener(e)}dispatchEvent(e){this.eventService.dispatchEvent(e)}destroy(){var e;const t=`See ${this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}`;if(this.destroyCalled)return;const s={type:w.EVENT_GRID_PRE_DESTROYED,state:this.getState()};this.dispatchEvent(s),this.destroyCalled=!0,(e=this.ctrlsService.get("gridCtrl"))==null||e.destroyGridUi(),this.context.destroy(),this.detailGridInfoMap={},oA(this,["isDestroyed"],t)}isDestroyed(){return this.destroyCalled}resetQuickFilter(){this.filterManager.resetQuickFilterCache()}getCellRanges(){return this.rangeService?this.rangeService.getCellRanges():(Nt.__assertRegistered("@ag-grid-enterprise/range-selection","api.getCellRanges",this.context.getGridId()),null)}addCellRange(e){if(this.rangeService){this.rangeService.addCellRange(e);return}Nt.__assertRegistered("@ag-grid-enterprise/range-selection","api.addCellRange",this.context.getGridId())}clearRangeSelection(){this.rangeService&&this.rangeService.removeAllCellRanges(),Nt.__assertRegistered("@ag-grid-enterprise/range-selection","gridApi.clearRangeSelection",this.context.getGridId())}undoCellEditing(){this.undoRedoService.undo("api")}redoCellEditing(){this.undoRedoService.redo("api")}getCurrentUndoSize(){return this.undoRedoService.getCurrentUndoStackSize()}getCurrentRedoSize(){return this.undoRedoService.getCurrentRedoStackSize()}assertChart(e,t){if(Nt.__assertRegistered("@ag-grid-enterprise/charts","api."+e,this.context.getGridId()))return this.frameworkOverrides.wrapIncoming(()=>t())}getChartModels(){return this.assertChart("getChartModels",()=>this.chartService.getChartModels())}getChartRef(e){return this.assertChart("getChartRef",()=>this.chartService.getChartRef(e))}getChartImageDataURL(e){return this.assertChart("getChartImageDataURL",()=>this.chartService.getChartImageDataURL(e))}downloadChart(e){return this.assertChart("downloadChart",()=>this.chartService.downloadChart(e))}openChartToolPanel(e){return this.assertChart("openChartToolPanel",()=>this.chartService.openChartToolPanel(e))}closeChartToolPanel(e){return this.assertChart("closeChartToolPanel",()=>this.chartService.closeChartToolPanel(e.chartId))}createRangeChart(e){return this.assertChart("createRangeChart",()=>this.chartService.createRangeChart(e))}createPivotChart(e){return this.assertChart("createPivotChart",()=>this.chartService.createPivotChart(e))}createCrossFilterChart(e){return this.assertChart("createCrossFilterChart",()=>this.chartService.createCrossFilterChart(e))}updateChart(e){return this.assertChart("updateChart",()=>this.chartService.updateChart(e))}restoreChart(e,t){return this.assertChart("restoreChart",()=>this.chartService.restoreChart(e,t))}assertClipboard(e,t){Nt.__assertRegistered("@ag-grid-enterprise/clipboard","api"+e,this.context.getGridId())&&t()}copyToClipboard(e){this.assertClipboard("copyToClipboard",()=>this.clipboardService.copyToClipboard(e))}cutToClipboard(e){this.assertClipboard("cutToClipboard",()=>this.clipboardService.cutToClipboard(e))}copySelectedRowsToClipboard(e){this.assertClipboard("copySelectedRowsToClipboard",()=>this.clipboardService.copySelectedRowsToClipboard(e))}copySelectedRangeToClipboard(e){this.assertClipboard("copySelectedRangeToClipboard",()=>this.clipboardService.copySelectedRangeToClipboard(e))}copySelectedRangeDown(){this.assertClipboard("copySelectedRangeDown",()=>this.clipboardService.copyRangeDown())}pasteFromClipboard(){this.assertClipboard("pasteFromClipboard",()=>this.clipboardService.pasteFromClipboard())}showColumnMenuAfterButtonClick(e,t){tt("'showColumnMenuAfterButtonClick' is deprecated. Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere.");const s=this.columnModel.getGridColumn(e);this.menuService.showColumnMenu({column:s,buttonElement:t,positionBy:"button"})}showColumnMenuAfterMouseClick(e,t){tt("'showColumnMenuAfterMouseClick' is deprecated. Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere.");let s=this.columnModel.getGridColumn(e);if(s||(s=this.columnModel.getPrimaryColumn(e)),!s){console.error(`AG Grid: column '${e}' not found`);return}this.menuService.showColumnMenu({column:s,mouseEvent:t,positionBy:"mouse"})}showContextMenu(e){const{rowNode:t,column:s,value:i,x:r,y:n}=e||{};let{x:o,y:a}=this.menuService.getContextMenuPosition(t,s);r!=null&&(o=r),n!=null&&(a=n),this.menuService.showContextMenu({mouseEvent:new MouseEvent("mousedown",{clientX:o,clientY:a}),rowNode:t,column:s,value:i})}showColumnChooser(e){this.menuService.showColumnChooser({chooserParams:e})}showColumnFilter(e){const t=this.columnModel.getGridColumn(e);if(!t){console.error(`AG Grid: column '${e}' not found`);return}this.menuService.showFilterMenu({column:t,containerType:"columnFilter",positionBy:"auto"})}showColumnMenu(e){const t=this.columnModel.getGridColumn(e);if(!t){console.error(`AG Grid: column '${e}' not found`);return}this.menuService.showColumnMenu({column:t,positionBy:"auto"})}hidePopupMenu(){this.menuService.hidePopupMenu()}hideColumnChooser(){this.menuService.hideColumnChooser()}tabToNextCell(e){return this.navigationService.tabToNextCell(!1,e)}tabToPreviousCell(e){return this.navigationService.tabToNextCell(!0,e)}getCellRendererInstances(e={}){return this.rowRenderer.getCellRendererInstances(e).map($a)}getCellEditorInstances(e={}){return this.rowRenderer.getCellEditorInstances(e).map($a)}getEditingCells(){return this.rowRenderer.getEditingCells()}stopEditing(e=!1){this.rowRenderer.stopEditing(e)}startEditingCell(e){const t=this.columnModel.getGridColumn(e.colKey);if(!t){console.warn(`AG Grid: no column found for ${e.colKey}`);return}const s={rowIndex:e.rowIndex,rowPinned:e.rowPinned||null,column:t};e.rowPinned==null&&this.ensureIndexVisible(e.rowIndex),this.ensureColumnVisible(e.colKey);const r=this.navigationService.getCellByPosition(s);r&&(this.focusService.isCellFocused(s)||this.focusService.setFocusedCell(s),r.startRowOrCellEdit(e.key))}addAggFunc(e,t){this.logDeprecation("v31.1","addAggFunc(key, func)","addAggFuncs({ key: func })"),this.aggFuncService&&this.aggFuncService.addAggFuncs({key:t})}addAggFuncs(e){this.aggFuncService&&this.aggFuncService.addAggFuncs(e)}clearAggFuncs(){this.aggFuncService&&this.aggFuncService.clear()}applyServerSideTransaction(e){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransaction","serverSide");return}return this.serverSideTransactionManager.applyTransaction(e)}applyServerSideTransactionAsync(e,t){if(!this.serverSideTransactionManager){this.logMissingRowModel("applyServerSideTransactionAsync","serverSide");return}return this.serverSideTransactionManager.applyTransactionAsync(e,t)}applyServerSideRowData(e){var t,s;const i=(t=e.startRow)!=null?t:0,r=(s=e.route)!=null?s:[];if(i<0){console.warn(`AG Grid: invalid value ${e.startRow} for startRow, the value should be >= 0`);return}this.serverSideRowModel?this.serverSideRowModel.applyRowData(e.successParams,i,r):this.logMissingRowModel("setServerSideDatasource","serverSide")}retryServerSideLoads(){if(!this.serverSideRowModel){this.logMissingRowModel("retryServerSideLoads","serverSide");return}this.serverSideRowModel.retryLoads()}flushServerSideAsyncTransactions(){if(!this.serverSideTransactionManager){this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide");return}return this.serverSideTransactionManager.flushAsyncTransactions()}applyTransaction(e){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransaction","clientSide");return}return this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.updateRowData(e))}applyTransactionAsync(e,t){if(!this.clientSideRowModel){this.logMissingRowModel("applyTransactionAsync","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.batchUpdateRowData(e,t))}flushAsyncTransactions(){if(!this.clientSideRowModel){this.logMissingRowModel("flushAsyncTransactions","clientSide");return}this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.flushAsyncTransactions())}refreshInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}purgeInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}refreshServerSide(e){if(!this.serverSideRowModel){this.logMissingRowModel("refreshServerSide","serverSide");return}this.serverSideRowModel.refreshStore(e)}getServerSideGroupLevelState(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}getInfiniteRowCount(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}isLastRowIndexKnown(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}getCacheBlockState(){return this.rowNodeBlockLoader.getBlockState()}getFirstDisplayedRow(){return this.logDeprecation("v31.1","getFirstDisplayedRow","getFirstDisplayedRowIndex"),this.getFirstDisplayedRowIndex()}getFirstDisplayedRowIndex(){return this.rowRenderer.getFirstVirtualRenderedRow()}getLastDisplayedRow(){return this.logDeprecation("v31.1","getLastDisplayedRow","getLastDisplayedRowIndex"),this.getLastDisplayedRowIndex()}getLastDisplayedRowIndex(){return this.rowRenderer.getLastVirtualRenderedRow()}getDisplayedRowAtIndex(e){return this.rowModel.getRow(e)}getDisplayedRowCount(){return this.rowModel.getRowCount()}paginationIsLastPageFound(){return this.paginationProxy.isLastPageFound()}paginationGetPageSize(){return this.paginationProxy.getPageSize()}paginationGetCurrentPage(){return this.paginationProxy.getCurrentPage()}paginationGetTotalPages(){return this.paginationProxy.getTotalPages()}paginationGetRowCount(){return this.paginationProxy.getMasterRowCount()}paginationGoToNextPage(){this.paginationProxy.goToNextPage()}paginationGoToPreviousPage(){this.paginationProxy.goToPreviousPage()}paginationGoToFirstPage(){this.paginationProxy.goToFirstPage()}paginationGoToLastPage(){this.paginationProxy.goToLastPage()}paginationGoToPage(e){this.paginationProxy.goToPage(e)}sizeColumnsToFit(e){typeof e=="number"?this.columnModel.sizeColumnsToFit(e,"api"):this.gridBodyCtrl.sizeColumnsToFit(e)}setColumnGroupOpened(e,t){this.columnModel.setColumnGroupOpened(e,t,"api")}getColumnGroup(e,t){return this.columnModel.getColumnGroup(e,t)}getProvidedColumnGroup(e){return this.columnModel.getProvidedColumnGroup(e)}getDisplayNameForColumn(e,t){return this.columnModel.getDisplayNameForColumn(e,t)||""}getDisplayNameForColumnGroup(e,t){return this.columnModel.getDisplayNameForColumnGroup(e,t)||""}getColumn(e){return this.columnModel.getPrimaryColumn(e)}getColumns(){return this.columnModel.getAllPrimaryColumns()}applyColumnState(e){return this.columnModel.applyColumnState(e,"api")}getColumnState(){return this.columnModel.getColumnState()}resetColumnState(){this.columnModel.resetColumnState("api")}getColumnGroupState(){return this.columnModel.getColumnGroupState()}setColumnGroupState(e){this.columnModel.setColumnGroupState(e,"api")}resetColumnGroupState(){this.columnModel.resetColumnGroupState("api")}isPinning(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}isPinningLeft(){return this.columnModel.isPinningLeft()}isPinningRight(){return this.columnModel.isPinningRight()}getDisplayedColAfter(e){return this.columnModel.getDisplayedColAfter(e)}getDisplayedColBefore(e){return this.columnModel.getDisplayedColBefore(e)}setColumnVisible(e,t){this.logDeprecation("v31.1","setColumnVisible(key,visible)","setColumnsVisible([key],visible)"),this.columnModel.setColumnsVisible([e],t,"api")}setColumnsVisible(e,t){this.columnModel.setColumnsVisible(e,t,"api")}setColumnPinned(e,t){this.logDeprecation("v31.1","setColumnPinned(key,pinned)","setColumnsPinned([key],pinned)"),this.columnModel.setColumnsPinned([e],t,"api")}setColumnsPinned(e,t){this.columnModel.setColumnsPinned(e,t,"api")}getAllGridColumns(){return this.columnModel.getAllGridColumns()}getDisplayedLeftColumns(){return this.columnModel.getDisplayedLeftColumns()}getDisplayedCenterColumns(){return this.columnModel.getDisplayedCenterColumns()}getDisplayedRightColumns(){return this.columnModel.getDisplayedRightColumns()}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getAllDisplayedVirtualColumns(){return this.columnModel.getViewportColumns()}moveColumn(e,t){this.logDeprecation("v31.1","moveColumn(key, toIndex)","moveColumns([key], toIndex)"),this.columnModel.moveColumns([e],t,"api")}moveColumnByIndex(e,t){this.columnModel.moveColumnByIndex(e,t,"api")}moveColumns(e,t){this.columnModel.moveColumns(e,t,"api")}moveRowGroupColumn(e,t){this.columnModel.moveRowGroupColumn(e,t,"api")}setColumnAggFunc(e,t){this.columnModel.setColumnAggFunc(e,t,"api")}setColumnWidth(e,t,s=!0,i="api"){this.logDeprecation("v31.1","setColumnWidth(col, width)","setColumnWidths([{key: col, newWidth: width}])"),this.columnModel.setColumnWidths([{key:e,newWidth:t}],!1,s,i)}setColumnWidths(e,t=!0,s="api"){this.columnModel.setColumnWidths(e,!1,t,s)}isPivotMode(){return this.columnModel.isPivotMode()}getPivotResultColumn(e,t){return this.columnModel.getSecondaryPivotColumn(e,t)}setValueColumns(e){this.columnModel.setValueColumns(e,"api")}getValueColumns(){return this.columnModel.getValueColumns()}removeValueColumn(e){this.logDeprecation("v31.1","removeValueColumn(colKey)","removeValueColumns([colKey])"),this.columnModel.removeValueColumns([e],"api")}removeValueColumns(e){this.columnModel.removeValueColumns(e,"api")}addValueColumn(e){this.logDeprecation("v31.1","addValueColumn(colKey)","addValueColumns([colKey])"),this.columnModel.addValueColumns([e],"api")}addValueColumns(e){this.columnModel.addValueColumns(e,"api")}setRowGroupColumns(e){this.columnModel.setRowGroupColumns(e,"api")}removeRowGroupColumn(e){this.logDeprecation("v31.1","removeRowGroupColumn(colKey)","removeRowGroupColumns([colKey])"),this.columnModel.removeRowGroupColumns([e],"api")}removeRowGroupColumns(e){this.columnModel.removeRowGroupColumns(e,"api")}addRowGroupColumn(e){this.logDeprecation("v31.1","addRowGroupColumn(colKey)","addRowGroupColumns([colKey])"),this.columnModel.addRowGroupColumns([e],"api")}addRowGroupColumns(e){this.columnModel.addRowGroupColumns(e,"api")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}setPivotColumns(e){this.columnModel.setPivotColumns(e,"api")}removePivotColumn(e){this.logDeprecation("v31.1","removePivotColumn(colKey)","removePivotColumns([colKey])"),this.columnModel.removePivotColumns([e],"api")}removePivotColumns(e){this.columnModel.removePivotColumns(e,"api")}addPivotColumn(e){this.logDeprecation("v31.1","addPivotColumn(colKey)","addPivotColumns([colKey])"),this.columnModel.addPivotColumns([e],"api")}addPivotColumns(e){this.columnModel.addPivotColumns(e,"api")}getPivotColumns(){return this.columnModel.getPivotColumns()}getLeftDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeLeft()}getCenterDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeCentre()}getRightDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeRight()}getAllDisplayedColumnGroups(){return this.columnModel.getAllDisplayedTrees()}autoSizeColumn(e,t){return this.logDeprecation("v31.1","autoSizeColumn(key, skipHeader)","autoSizeColumns([key], skipHeader)"),this.columnModel.autoSizeColumns({columns:[e],skipHeader:t,source:"api"})}autoSizeColumns(e,t){this.columnModel.autoSizeColumns({columns:e,skipHeader:t,source:"api"})}autoSizeAllColumns(e){this.columnModel.autoSizeAllColumns("api",e)}setPivotResultColumns(e){this.columnModel.setSecondaryColumns(e,"api")}getPivotResultColumns(){return this.columnModel.getSecondaryColumns()}getState(){return this.stateService.getState()}getGridOption(e){return this.gos.get(e)}setGridOption(e,t){this.updateGridOptions({[e]:t})}updateGridOptions(e){this.gos.updateGridOptions({options:e})}__internalUpdateGridOptions(e,t){this.gos.updateGridOptions({options:e,force:t,source:"gridOptionsUpdated"})}deprecatedUpdateGridOption(e,t){tt(`set${e.charAt(0).toUpperCase()}${e.slice(1,e.length)} is deprecated. Please use 'api.setGridOption('${e}', newValue)' or 'api.updateGridOptions({ ${e}: newValue })' instead.`),this.setGridOption(e,t)}setPivotMode(e){this.deprecatedUpdateGridOption("pivotMode",e)}setPinnedTopRowData(e){this.deprecatedUpdateGridOption("pinnedTopRowData",e)}setPinnedBottomRowData(e){this.deprecatedUpdateGridOption("pinnedBottomRowData",e)}setPopupParent(e){this.deprecatedUpdateGridOption("popupParent",e)}setSuppressModelUpdateAfterUpdateTransaction(e){this.deprecatedUpdateGridOption("suppressModelUpdateAfterUpdateTransaction",e)}setDataTypeDefinitions(e){this.deprecatedUpdateGridOption("dataTypeDefinitions",e)}setPagination(e){this.deprecatedUpdateGridOption("pagination",e)}paginationSetPageSize(e){this.deprecatedUpdateGridOption("paginationPageSize",e)}setSideBar(e){this.deprecatedUpdateGridOption("sideBar",e)}setSuppressClipboardPaste(e){this.deprecatedUpdateGridOption("suppressClipboardPaste",e)}setGroupRemoveSingleChildren(e){this.deprecatedUpdateGridOption("groupRemoveSingleChildren",e)}setGroupRemoveLowestSingleChildren(e){this.deprecatedUpdateGridOption("groupRemoveLowestSingleChildren",e)}setGroupDisplayType(e){this.deprecatedUpdateGridOption("groupDisplayType",e)}setGroupIncludeFooter(e){this.deprecatedUpdateGridOption("groupIncludeFooter",e)}setGroupIncludeTotalFooter(e){this.deprecatedUpdateGridOption("groupIncludeTotalFooter",e)}setRowClass(e){this.deprecatedUpdateGridOption("rowClass",e)}setDeltaSort(e){this.deprecatedUpdateGridOption("deltaSort",e)}setSuppressRowDrag(e){this.deprecatedUpdateGridOption("suppressRowDrag",e)}setSuppressMoveWhenRowDragging(e){this.deprecatedUpdateGridOption("suppressMoveWhenRowDragging",e)}setSuppressRowClickSelection(e){this.deprecatedUpdateGridOption("suppressRowClickSelection",e)}setEnableAdvancedFilter(e){this.deprecatedUpdateGridOption("enableAdvancedFilter",e)}setIncludeHiddenColumnsInAdvancedFilter(e){this.deprecatedUpdateGridOption("includeHiddenColumnsInAdvancedFilter",e)}setAdvancedFilterParent(e){this.deprecatedUpdateGridOption("advancedFilterParent",e)}setAdvancedFilterBuilderParams(e){this.deprecatedUpdateGridOption("advancedFilterBuilderParams",e)}setQuickFilter(e){tt("setQuickFilter is deprecated. Please use 'api.setGridOption('quickFilterText', newValue)' or 'api.updateGridOptions({ quickFilterText: newValue })' instead."),this.gos.updateGridOptions({options:{quickFilterText:e}})}setExcludeHiddenColumnsFromQuickFilter(e){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",!e)}setIncludeHiddenColumnsInQuickFilter(e){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",e)}setQuickFilterParser(e){this.deprecatedUpdateGridOption("quickFilterParser",e)}setQuickFilterMatcher(e){this.deprecatedUpdateGridOption("quickFilterMatcher",e)}setAlwaysShowHorizontalScroll(e){this.deprecatedUpdateGridOption("alwaysShowHorizontalScroll",e)}setAlwaysShowVerticalScroll(e){this.deprecatedUpdateGridOption("alwaysShowVerticalScroll",e)}setFunctionsReadOnly(e){this.deprecatedUpdateGridOption("functionsReadOnly",e)}setColumnDefs(e,t="api"){tt("setColumnDefs is deprecated. Please use 'api.setGridOption('columnDefs', newValue)' or 'api.updateGridOptions({ columnDefs: newValue })' instead."),this.gos.updateGridOptions({options:{columnDefs:e},source:t})}setAutoGroupColumnDef(e,t="api"){tt("setAutoGroupColumnDef is deprecated. Please use 'api.setGridOption('autoGroupColumnDef', newValue)' or 'api.updateGridOptions({ autoGroupColumnDef: newValue })' instead."),this.gos.updateGridOptions({options:{autoGroupColumnDef:e},source:t})}setDefaultColDef(e,t="api"){tt("setDefaultColDef is deprecated. Please use 'api.setGridOption('defaultColDef', newValue)' or 'api.updateGridOptions({ defaultColDef: newValue })' instead."),this.gos.updateGridOptions({options:{defaultColDef:e},source:t})}setColumnTypes(e,t="api"){tt("setColumnTypes is deprecated. Please use 'api.setGridOption('columnTypes', newValue)' or 'api.updateGridOptions({ columnTypes: newValue })' instead."),this.gos.updateGridOptions({options:{columnTypes:e},source:t})}setTreeData(e){this.deprecatedUpdateGridOption("treeData",e)}setServerSideDatasource(e){this.deprecatedUpdateGridOption("serverSideDatasource",e)}setCacheBlockSize(e){this.deprecatedUpdateGridOption("cacheBlockSize",e)}setDatasource(e){this.deprecatedUpdateGridOption("datasource",e)}setViewportDatasource(e){this.deprecatedUpdateGridOption("viewportDatasource",e)}setRowData(e){this.deprecatedUpdateGridOption("rowData",e)}setEnableCellTextSelection(e){this.deprecatedUpdateGridOption("enableCellTextSelection",e)}setHeaderHeight(e){this.deprecatedUpdateGridOption("headerHeight",e)}setDomLayout(e){this.deprecatedUpdateGridOption("domLayout",e)}setFillHandleDirection(e){this.deprecatedUpdateGridOption("fillHandleDirection",e)}setGroupHeaderHeight(e){this.deprecatedUpdateGridOption("groupHeaderHeight",e)}setFloatingFiltersHeight(e){this.deprecatedUpdateGridOption("floatingFiltersHeight",e)}setPivotHeaderHeight(e){this.deprecatedUpdateGridOption("pivotHeaderHeight",e)}setPivotGroupHeaderHeight(e){this.deprecatedUpdateGridOption("pivotGroupHeaderHeight",e)}setAnimateRows(e){this.deprecatedUpdateGridOption("animateRows",e)}setIsExternalFilterPresent(e){this.deprecatedUpdateGridOption("isExternalFilterPresent",e)}setDoesExternalFilterPass(e){this.deprecatedUpdateGridOption("doesExternalFilterPass",e)}setNavigateToNextCell(e){this.deprecatedUpdateGridOption("navigateToNextCell",e)}setTabToNextCell(e){this.deprecatedUpdateGridOption("tabToNextCell",e)}setTabToNextHeader(e){this.deprecatedUpdateGridOption("tabToNextHeader",e)}setNavigateToNextHeader(e){this.deprecatedUpdateGridOption("navigateToNextHeader",e)}setRowGroupPanelShow(e){this.deprecatedUpdateGridOption("rowGroupPanelShow",e)}setGetGroupRowAgg(e){this.deprecatedUpdateGridOption("getGroupRowAgg",e)}setGetBusinessKeyForNode(e){this.deprecatedUpdateGridOption("getBusinessKeyForNode",e)}setGetChildCount(e){this.deprecatedUpdateGridOption("getChildCount",e)}setProcessRowPostCreate(e){this.deprecatedUpdateGridOption("processRowPostCreate",e)}setGetRowId(e){tt("getRowId is a static property and can no longer be updated.")}setGetRowClass(e){this.deprecatedUpdateGridOption("getRowClass",e)}setIsFullWidthRow(e){this.deprecatedUpdateGridOption("isFullWidthRow",e)}setIsRowSelectable(e){this.deprecatedUpdateGridOption("isRowSelectable",e)}setIsRowMaster(e){this.deprecatedUpdateGridOption("isRowMaster",e)}setPostSortRows(e){this.deprecatedUpdateGridOption("postSortRows",e)}setGetDocument(e){this.deprecatedUpdateGridOption("getDocument",e)}setGetContextMenuItems(e){this.deprecatedUpdateGridOption("getContextMenuItems",e)}setGetMainMenuItems(e){this.deprecatedUpdateGridOption("getMainMenuItems",e)}setProcessCellForClipboard(e){this.deprecatedUpdateGridOption("processCellForClipboard",e)}setSendToClipboard(e){this.deprecatedUpdateGridOption("sendToClipboard",e)}setProcessCellFromClipboard(e){this.deprecatedUpdateGridOption("processCellFromClipboard",e)}setProcessPivotResultColDef(e){this.deprecatedUpdateGridOption("processPivotResultColDef",e)}setProcessPivotResultColGroupDef(e){this.deprecatedUpdateGridOption("processPivotResultColGroupDef",e)}setPostProcessPopup(e){this.deprecatedUpdateGridOption("postProcessPopup",e)}setInitialGroupOrderComparator(e){this.deprecatedUpdateGridOption("initialGroupOrderComparator",e)}setGetChartToolbarItems(e){this.deprecatedUpdateGridOption("getChartToolbarItems",e)}setPaginationNumberFormatter(e){this.deprecatedUpdateGridOption("paginationNumberFormatter",e)}setGetServerSideGroupLevelParams(e){this.deprecatedUpdateGridOption("getServerSideGroupLevelParams",e)}setIsServerSideGroupOpenByDefault(e){this.deprecatedUpdateGridOption("isServerSideGroupOpenByDefault",e)}setIsApplyServerSideTransaction(e){this.deprecatedUpdateGridOption("isApplyServerSideTransaction",e)}setIsServerSideGroup(e){this.deprecatedUpdateGridOption("isServerSideGroup",e)}setGetServerSideGroupKey(e){this.deprecatedUpdateGridOption("getServerSideGroupKey",e)}setGetRowStyle(e){this.deprecatedUpdateGridOption("getRowStyle",e)}setGetRowHeight(e){this.deprecatedUpdateGridOption("getRowHeight",e)}};f([A("rowRenderer")],yt.prototype,"rowRenderer",2);f([A("navigationService")],yt.prototype,"navigationService",2);f([A("filterManager")],yt.prototype,"filterManager",2);f([A("columnModel")],yt.prototype,"columnModel",2);f([A("selectionService")],yt.prototype,"selectionService",2);f([A("gridOptionsService")],yt.prototype,"gos",2);f([A("valueService")],yt.prototype,"valueService",2);f([A("alignedGridsService")],yt.prototype,"alignedGridsService",2);f([A("eventService")],yt.prototype,"eventService",2);f([A("pinnedRowModel")],yt.prototype,"pinnedRowModel",2);f([A("context")],yt.prototype,"context",2);f([A("rowModel")],yt.prototype,"rowModel",2);f([A("sortController")],yt.prototype,"sortController",2);f([A("paginationProxy")],yt.prototype,"paginationProxy",2);f([A("focusService")],yt.prototype,"focusService",2);f([A("dragAndDropService")],yt.prototype,"dragAndDropService",2);f([A("menuService")],yt.prototype,"menuService",2);f([A("valueCache")],yt.prototype,"valueCache",2);f([A("animationFrameService")],yt.prototype,"animationFrameService",2);f([A("ctrlsService")],yt.prototype,"ctrlsService",2);f([A("overlayService")],yt.prototype,"overlayService",2);f([A("stateService")],yt.prototype,"stateService",2);f([A("expansionService")],yt.prototype,"expansionService",2);f([A("apiEventService")],yt.prototype,"apiEventService",2);f([A("frameworkOverrides")],yt.prototype,"frameworkOverrides",2);f([A("undoRedoService")],yt.prototype,"undoRedoService",2);f([A("rowNodeBlockLoader")],yt.prototype,"rowNodeBlockLoader",2);f([Lt("csvCreator")],yt.prototype,"csvCreator",2);f([Lt("excelCreator")],yt.prototype,"excelCreator",2);f([Lt("rangeService")],yt.prototype,"rangeService",2);f([Lt("clipboardService")],yt.prototype,"clipboardService",2);f([Lt("aggFuncService")],yt.prototype,"aggFuncService",2);f([Lt("statusBarService")],yt.prototype,"statusBarService",2);f([Lt("chartService")],yt.prototype,"chartService",2);f([Lt("ssrmTransactionManager")],yt.prototype,"serverSideTransactionManager",2);f([Lt("sideBarService")],yt.prototype,"sideBarService",2);f([Ee],yt.prototype,"init",1);yt=f([je("gridApi")],yt);var Gi=class extends xe{constructor(){super(...arguments),this.quickFilter=null,this.quickFilterParts=null}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",e=>this.setQuickFilter(e.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onQuickFilterColumnConfigChanged()),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}isQuickFilterPresent(){return this.quickFilter!==null}doesRowPassQuickFilter(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(t,e):this.quickFilterParts.every(s=>t?this.doesRowPassQuickFilterCache(e,s):this.doesRowPassQuickFilterNoCache(e,s))}resetQuickFilterCache(){this.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseQuickFilter(e){return Ce(e)?this.gos.isRowModelType("clientSide")?e.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(e!=null&&typeof e!="string"){console.warn(`AG Grid - Grid option quickFilterText only supports string inputs, received: ${typeof e}`);return}const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.dispatchEvent({type:Gi.EVENT_QUICK_FILTER_CHANGED}))}setQuickFilterParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),s=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,s&&(this.setQuickFilterParts(),this.dispatchEvent({type:Gi.EVENT_QUICK_FILTER_CHANGED}))}onQuickFilterColumnConfigChanged(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchEvent({type:Gi.EVENT_QUICK_FILTER_CHANGED})}doesRowPassQuickFilterNoCache(e,t){return this.columnModel.getAllColumnsForQuickFilter().some(i=>{const r=this.getQuickFilterTextForColumn(i,e);return Ce(r)&&r.indexOf(t)>=0})}doesRowPassQuickFilterCache(e,t){return this.checkGenerateQuickFilterAggregateText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilterMatcher(e,t){let s;e?(this.checkGenerateQuickFilterAggregateText(t),s=t.quickFilterAggregateText):s=this.getQuickFilterAggregateText(t);const{quickFilterParts:i,matcher:r}=this;return r(i,s)}checkGenerateQuickFilterAggregateText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getQuickFilterAggregateText(e))}getQuickFilterTextForColumn(e,t){let s=this.valueService.getValue(e,t,!0);const i=e.getColDef();if(i.getQuickFilterText){const r=this.gos.addGridCommonParams({value:s,node:t,data:t.data,column:e,colDef:i});s=i.getQuickFilterText(r)}return Ce(s)?s.toString().toUpperCase():null}getQuickFilterAggregateText(e){const t=[];return this.columnModel.getAllColumnsForQuickFilter().forEach(i=>{const r=this.getQuickFilterTextForColumn(i,e);Ce(r)&&t.push(r)}),t.join(Gi.QUICK_FILTER_SEPARATOR)}};Gi.EVENT_QUICK_FILTER_CHANGED="quickFilterChanged";Gi.QUICK_FILTER_SEPARATOR=`
`;f([A("valueService")],Gi.prototype,"valueService",2);f([A("columnModel")],Gi.prototype,"columnModel",2);f([A("rowModel")],Gi.prototype,"rowModel",2);f([Ee],Gi.prototype,"postConstruct",1);Gi=f([je("quickFilterService")],Gi);var Pr=class extends xe{constructor(){super(...arguments),this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue=[]}init(){var e,t,s;this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,()=>this.onColumnsChanged()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,w.EVENT_ROW_DATA_UPDATED,()=>this.onNewRowsLoaded("rowDataUpdated")),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",i=>this.setAdvancedFilterModel(i.currentValue)),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,({enabled:i})=>this.onAdvancedFilterEnabledChanged(i)),this.addManagedListener(this.eventService,w.EVENT_DATA_TYPES_INFERRED,()=>this.processFilterModelUpdateQueue()),this.addManagedListener(this.quickFilterService,Gi.EVENT_QUICK_FILTER_CHANGED,()=>this.onFilterChanged({source:"quickFilter"})),this.initialFilterModel=Je({},(s=(t=(e=this.gos.get("initialState"))==null?void 0:e.filter)==null?void 0:t.filterModel)!=null?s:{})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"?e({}):!1}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"?t(e):!1}setFilterModel(e,t="api"){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}if(this.dataTypeService.isPendingInference()){this.filterModelUpdateQueue.push({model:e,source:t});return}const s=[],i=this.getFilterModel();if(e){const r=x0(Object.keys(e));this.allColumnFilters.forEach((n,o)=>{const a=e[o];s.push(this.setModelOnFilterWrapper(n.filterPromise,a)),r.delete(o)}),r.forEach(n=>{const o=this.columnModel.getPrimaryColumn(n)||this.columnModel.getGridColumn(n);if(!o){console.warn("AG Grid: setFilterModel() - no column found for colId: "+n);return}if(!o.isFilterAllowed()){console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+n);return}const a=this.getOrCreateFilterWrapper(o,"NO_UI");if(!a){console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+n);return}s.push(this.setModelOnFilterWrapper(a.filterPromise,e[n]))})}else this.allColumnFilters.forEach(r=>{s.push(this.setModelOnFilterWrapper(r.filterPromise,null))});ws.all(s).then(()=>{const r=this.getFilterModel(),n=[];this.allColumnFilters.forEach((o,a)=>{const l=i?i[a]:null,u=r?r[a]:null;rt.jsonEquals(l,u)||n.push(o.column)}),n.length>0&&this.onFilterChanged({columns:n,source:t})})}setModelOnFilterWrapper(e,t){return new ws(s=>{e.then(i=>{typeof i.setModel!="function"&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),s()),(i.setModel(t)||ws.resolve()).then(()=>s())})})}getFilterModel(){const e={};return this.allColumnFilters.forEach((t,s)=>{const i=this.getModelFromFilterWrapper(t);Ce(i)&&(e[s]=i)}),e}getModelFromFilterWrapper(e){var t;const i=e.filterPromise.resolveNow(null,r=>r);return i==null?(t=this.initialFilterModel[e.column.getColId()])!=null?t:null:typeof i.getModel!="function"?(console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel"),null):i.getModel()}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(e){var t;e?this.allColumnFilters.size&&(this.allColumnFilters.forEach(s=>this.disposeFilterWrapper(s,"advancedFilterEnabled")),this.onFilterChanged({source:"advancedFilter"})):(t=this.advancedFilterService)!=null&&t.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){var e;return!!((e=this.advancedFilterService)!=null&&e.isEnabled())}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;const e=i=>i?i.isFilterActive?i.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1):!1,t=!!this.gos.getGroupAggFiltering(),s=i=>{if(!i.isPrimary())return!0;const n=!this.columnModel.isPivotActive();return!i.isValueActive()||!n?!1:this.columnModel.isPivotMode()?!0:t};this.allColumnFilters.forEach(i=>{if(i.filterPromise.resolveNow(!1,e)){const r=i.filterPromise.resolveNow(null,n=>n);s(i.column)?this.activeAggregateFilters.push(r):this.activeColumnFilters.push(r)}})}updateFilterFlagInColumns(e,t){this.allColumnFilters.forEach(s=>{const i=s.filterPromise.resolveNow(!1,r=>r.isFilterActive());s.column.setFilterActive(i,e,t)})}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}doColumnFiltersPass(e,t,s){const{data:i,aggData:r}=e,n=s?this.activeAggregateFilters:this.activeColumnFilters,o=s?r:i;for(let a=0;a<n.length;a++){const l=n[a];if(!(l==null||l===t)){if(typeof l.doesFilterPass!="function")throw new Error("Filter is missing method doesFilterPass");if(!l.doesFilterPass({node:e,data:o}))return!1}}return!0}resetQuickFilterCache(){this.quickFilterService.resetQuickFilterCache()}refreshFiltersForAggregations(){this.gos.getGroupAggFiltering()&&this.onFilterChanged()}callOnFilterChangedOutsideRenderCycle(e){const t=()=>this.onFilterChanged(e);this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}onFilterChanged(e={}){const{source:t,filterInstance:s,additionalEventAttributes:i,columns:r}=e;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",i),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(o=>{o.filterPromise&&o.filterPromise.then(a=>{a&&a!==s&&a.onAnyFilterChanged&&a.onAnyFilterChanged()})});const n={source:t,type:w.EVENT_FILTER_CHANGED,columns:r||[]};i&&Mi(n,i),this.processingFilterChange=!0,this.eventService.dispatchEvent(n),this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){var e;return!((e=this.gos.get("allowShowChangeAfterFilter"))!=null?e:!1)&&this.processingFilterChange}isQuickFilterPresent(){return this.quickFilterService.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!this.gos.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode)||this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode)||this.isColumnFilterPresent()&&!this.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip)||this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(e.rowNode))}onNewRowsLoaded(e){this.allColumnFilters.forEach(t=>{t.filterPromise.then(s=>{s.onNewRowsLoaded&&s.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(e,{afterDataChange:!0}),this.updateActiveFilters()}createValueGetter(e){return({node:t})=>this.valueService.getValue(e,t,!0)}createGetValue(e){return(t,s)=>{const i=s?this.columnModel.getGridColumn(s):e;return i?this.valueService.getValue(i,t,!0):void 0}}getFilterComponent(e,t,s=!0){var i;if(s)return((i=this.getOrCreateFilterWrapper(e,t))==null?void 0:i.filterPromise)||null;const r=this.cachedFilter(e);return r?r.filterPromise:null}isFilterActive(e){const t=this.cachedFilter(e);return!!t&&t.filterPromise.resolveNow(!1,s=>s.isFilterActive())}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return null;let s=this.cachedFilter(e);return s||(s=this.createFilterWrapper(e,t),this.setColumnFilterWrapper(e,s)),s}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;if(Nt.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))t="agSetColumnFilter";else{const s=this.dataTypeService.getBaseDataType(e);s==="number"?t="agNumberColumnFilter":s==="date"||s==="dateString"?t="agDateColumnFilter":t="agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;if(Nt.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))t="agSetColumnFloatingFilter";else{const s=this.dataTypeService.getBaseDataType(e);s==="number"?t="agNumberColumnFloatingFilter":s==="date"||s==="dateString"?t="agDateColumnFloatingFilter":t="agTextColumnFloatingFilter"}return t}createFilterInstance(e){const t=this.getDefaultFilter(e),s=e.getColDef();let i;const r=Jt(Je({},this.createFilterParams(e,s)),{filterModifiedCallback:()=>this.filterModifiedCallbackFactory(i,e)(),filterChangedCallback:o=>this.filterChangedCallbackFactory(i,e)(o),doesRowPassOtherFilter:o=>this.doesRowPassOtherFilters(i,o)}),n=this.userComponentFactory.getFilterDetails(s,r,t);return n?{filterPromise:()=>{const o=n.newAgStackInstance();return o&&o.then(a=>i=a),o},compDetails:n}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return this.gos.addGridCommonParams({column:e,colDef:KS(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e,t){var s;const i={column:e,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:r,compDetails:n}=this.createFilterInstance(e);return i.filterPromise=(s=r==null?void 0:r())!=null?s:null,i.compDetails=n,i}onColumnsChanged(){const e=[];this.allColumnFilters.forEach((t,s)=>{let i;t.column.isPrimary()?i=this.columnModel.getPrimaryColumn(s):i=this.columnModel.getGridColumn(s),!(i&&i===t.column)&&(e.push(t.column),this.disposeFilterWrapper(t,"columnChanged"),this.disposeColumnListener(s))}),e.length>0?this.onFilterChanged({columns:e,source:"api"}):this.updateDependantFilters()}updateDependantFilters(){const e=this.columnModel.getGroupAutoColumns();e==null||e.forEach(t=>{t.getColDef().filter==="agGroupColumnFilter"&&this.getOrCreateFilterWrapper(t,"NO_UI")})}isFilterAllowed(e){var t,s;if(this.isAdvancedFilterEnabled()||!e.isFilterAllowed())return!1;const r=this.allColumnFilters.get(e.getColId());return(s=(t=r==null?void 0:r.filterPromise)==null?void 0:t.resolveNow(!0,n=>typeof(n==null?void 0:n.isFilterAllowed)=="function"?n==null?void 0:n.isFilterAllowed():!0))!=null?s:!0}getFloatingFilterCompDetails(e,t){const s=l=>{const u=this.getFilterComponent(e,"NO_UI");u!=null&&u.then(h=>{l($a(h))})},i=e.getColDef(),r=Jt(Je({},this.createFilterParams(e,i)),{filterChangedCallback:()=>s(l=>this.filterChangedCallbackFactory(l,e)())}),n=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(i,sw,r);let o=this.userComponentFactory.getDefaultFloatingFilterType(i,()=>this.getDefaultFloatingFilter(e));o==null&&(o="agReadOnlyFloatingFilter");const a={column:e,filterParams:n,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:s,showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(i,a,o)}getCurrentFloatingFilterParentModel(e){const t=this.getFilterComponent(e,"NO_UI",!1);return t?t.resolveNow(null,s=>s&&s.getModel()):null}destroyFilter(e,t="api"){const s=e.getColId(),i=this.allColumnFilters.get(s);this.disposeColumnListener(s),delete this.initialFilterModel[s],i&&(this.disposeFilterWrapper(i,t),this.onFilterChanged({columns:[e],source:"api"}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){e.filterPromise.then(s=>{this.getContext().destroyBean(s),e.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId());const i={type:w.EVENT_FILTER_DESTROYED,source:t,column:e.column};this.eventService.dispatchEvent(i)})}filterModifiedCallbackFactory(e,t){return()=>{const s={type:w.EVENT_FILTER_MODIFIED,column:t,filterInstance:e};this.eventService.dispatchEvent(s)}}filterChangedCallbackFactory(e,t){return s=>{var i;const r=(i=s==null?void 0:s.source)!=null?i:"api",n={filter:e,additionalEventAttributes:s,columns:[t],source:r};this.callOnFilterChangedOutsideRenderCycle(n)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const s=t.column,{compDetails:i}=s.isFilterAllowed()?this.createFilterInstance(s):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,i)){this.destroyFilter(s,"paramsUpdated");return}const r=s.getColDef().filterParams;if(!t.filterPromise){this.destroyFilter(s,"paramsUpdated");return}t.filterPromise.then(n=>{(n!=null&&n.refresh?n.refresh(Je(Jt(Je({},this.createFilterParams(s,s.getColDef())),{filterModifiedCallback:this.filterModifiedCallbackFactory(n,s),filterChangedCallback:this.filterChangedCallbackFactory(n,s),doesRowPassOtherFilter:a=>this.doesRowPassOtherFilters(n,a)}),r)):!0)===!1&&this.destroyFilter(s,"paramsUpdated")})}setColumnFilterWrapper(e,t){const s=e.getColId();this.allColumnFilters.set(s,t),this.allColumnListeners.set(s,this.addManagedListener(e,Vt.EVENT_COL_DEF_CHANGED,()=>this.checkDestroyFilter(s)))}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:s}=e,{componentClass:i}=t;return!(s===i||(s==null?void 0:s.render)&&(i==null?void 0:i.render)&&s.render===i.render)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(e){if(this.isAdvancedFilterEnabled()){if(this.dataTypeService.isPendingInference()){this.advancedFilterModelUpdateQueue.push(e);return}this.advancedFilterService.setModel(e??null),this.onFilterChanged({source:"advancedFilter"})}}showAdvancedFilterBuilder(e){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder(e,!0)}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvancedFilterEnabled()?!1:this.columnModel.getAllGridColumns().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e,t){if(this.isAdvancedFilterEnabled()){this.warnAdvancedFilters();return}const s=this.getFilterInstanceImpl(e,r=>{if(!t)return;const n=$a(r);t(n)});return $a(s)}getColumnFilterInstance(e){return new Promise(t=>{this.getFilterInstance(e,s=>{t(s)})})}getFilterInstanceImpl(e,t){const s=this.columnModel.getPrimaryColumn(e);if(!s)return;const i=this.getFilterComponent(s,"NO_UI"),r=i&&i.resolveNow(null,n=>n);return r?setTimeout(t,0,r):i&&i.then(n=>{t(n)}),r}warnAdvancedFilters(){tt("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(e){var t;(t=this.advancedFilterService)==null||t.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model:e,source:t})=>this.setFilterModel(e,t)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key:e,model:t,resolve:s})=>{this.setColumnFilterModel(e,t).then(()=>s())}),this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue.forEach(e=>this.setAdvancedFilterModel(e)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){if(this.isAdvancedFilterEnabled())return this.warnAdvancedFilters(),Promise.resolve();if(this.dataTypeService.isPendingInference()){let n=()=>{};const o=new Promise(a=>{n=a});return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:n}),o}const s=this.columnModel.getPrimaryColumn(e),i=s?this.getOrCreateFilterWrapper(s,"NO_UI"):null;return i?(n=>new Promise(o=>{n.then(a=>o(a))}))(this.setModelOnFilterWrapper(i.filterPromise,t)):Promise.resolve()}getFilterWrapper(e){var t;const s=this.columnModel.getPrimaryColumn(e);return s&&(t=this.cachedFilter(s))!=null?t:null}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}};f([A("valueService")],Pr.prototype,"valueService",2);f([A("columnModel")],Pr.prototype,"columnModel",2);f([A("rowModel")],Pr.prototype,"rowModel",2);f([A("userComponentFactory")],Pr.prototype,"userComponentFactory",2);f([A("rowRenderer")],Pr.prototype,"rowRenderer",2);f([A("dataTypeService")],Pr.prototype,"dataTypeService",2);f([A("quickFilterService")],Pr.prototype,"quickFilterService",2);f([Lt("advancedFilterService")],Pr.prototype,"advancedFilterService",2);f([Ee],Pr.prototype,"init",1);Pr=f([je("filterManager")],Pr);var Zm=class extends ot{constructor(e,t){super('<div class="ag-filter"></div>'),this.column=e,this.source=t,this.filterWrapper=null}postConstruct(){this.createFilter(!0),this.addManagedListener(this.eventService,w.EVENT_FILTER_DESTROYED,this.onFilterDestroyed.bind(this))}hasFilter(){return!!this.filterWrapper}getFilter(){var e,t;return(t=(e=this.filterWrapper)==null?void 0:e.filterPromise)!=null?t:null}afterInit(){var e,t,s;return(s=(t=(e=this.filterWrapper)==null?void 0:e.filterPromise)==null?void 0:t.then(()=>{}))!=null?s:ws.resolve()}afterGuiAttached(e){var t,s;(s=(t=this.filterWrapper)==null?void 0:t.filterPromise)==null||s.then(i=>{var r;(r=i==null?void 0:i.afterGuiAttached)==null||r.call(i,e)})}afterGuiDetached(){var e,t;(t=(e=this.filterWrapper)==null?void 0:e.filterPromise)==null||t.then(s=>{var i;(i=s==null?void 0:s.afterGuiDetached)==null||i.call(s)})}createFilter(e){var t;const{column:s,source:i}=this;this.filterWrapper=this.filterManager.getOrCreateFilterWrapper(s,i),(t=this.filterWrapper)!=null&&t.filterPromise&&this.filterWrapper.filterPromise.then(r=>{let n=r.getGui();if(Ce(n)||console.warn(`AG Grid: getGui method from filter returned ${n}, it should be a DOM element or an HTML template string.`),typeof n=="string"&&(n=Oi(n)),this.appendChild(n),e){const o={type:w.EVENT_FILTER_OPENED,column:s,source:i,eGui:this.getGui()};this.eventService.dispatchEvent(o)}})}onFilterDestroyed(e){(e.source==="api"||e.source==="paramsUpdated")&&e.column.getId()===this.column.getId()&&this.columnModel.getPrimaryColumn(this.column)&&(fs(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}};f([A("filterManager")],Zm.prototype,"filterManager",2);f([A("columnModel")],Zm.prototype,"columnModel",2);f([Ee],Zm.prototype,"postConstruct",1);var k0=class extends ot{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},Ol=class uI extends k0{constructor(t){super(uI.TEMPLATE,t)}postConstruct(){const t=this.getGui(),s={addOrRemoveCssClass:(i,r)=>this.addOrRemoveCssClass(i,r),addOrRemoveBodyCssClass:(i,r)=>this.eFloatingFilterBody.classList.toggle(i,r),setButtonWrapperDisplayed:i=>Et(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>t.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(s,t,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(t){if(!t){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=t.newAgStackInstance(),this.compPromise.then(s=>this.afterCompCreated(s))}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(t){if(t){if(!this.isAlive()){this.destroyBean(t);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=t,this.eFloatingFilterBody.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached()}}};Ol.TEMPLATE=`<div class="ag-header-cell ag-floating-filter" role="gridcell">
            <div ref="eFloatingFilterBody" role="presentation"></div>
            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">
                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>
            </div>
        </div>`;f([Ie("eFloatingFilterBody")],Ol.prototype,"eFloatingFilterBody",2);f([Ie("eButtonWrapper")],Ol.prototype,"eButtonWrapper",2);f([Ie("eButtonShowMainFilter")],Ol.prototype,"eButtonShowMainFilter",2);f([Ee],Ol.prototype,"postConstruct",1);f([Si],Ol.prototype,"destroyFloatingFilterComp",1);var KO=Ol,Jm=class extends xe{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},s=t.autoHeight?"ag-layout-auto-height":t.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(s,t)}getDomLayout(){var e;const t=(e=this.gos.get("domLayout"))!=null?e:"normal";return["normal","print","autoHeight"].indexOf(t)===-1?(tt(`${t} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):t}};f([Ee],Jm.prototype,"postConstruct",1);var uo=class extends xe{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=pi(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=pi(()=>this.lastScrollSource[0]=null,500)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const{fakeHScrollComp:e,fakeVScrollComp:t}=this.ctrlsService.getParams();this.addManagedListener(this.centerRowsCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),e.onScrollCallback(this.onFakeHScroll.bind(this));const s=this.gos.get("debounceVerticalScrollbar"),i=s?pi(this.onVScroll.bind(this),100):this.onVScroll.bind(this),r=s?pi(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",i),t.onScrollCallback(r)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){if(this.centerRowsCtrl==null)return;e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft());const s=this.enableRtl?e:-e,{topCenter:i,stickyTopCenter:r,stickyBottomCenter:n,centerHeader:o,bottomCenter:a,fakeHScrollComp:l}=this.ctrlsService.getParams();o.setHorizontalScroll(-s),a.setContainerTranslateX(s),i.setContainerTranslateX(s),r.setContainerTranslateX(s),n.setContainerTranslateX(s);const u=this.centerRowsCtrl.getViewportElement(),h=this.lastScrollSource[1]===0;e=Math.abs(e),h?l.setScrollPosition(e):dh(u,e,this.enableRtl)}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(this.lastScrollSource[t]=e,!0):this.lastScrollSource[t]===e}onFakeHScroll(){this.isControllingScroll(1,1)&&this.onHScrollCommon(1)}onHScroll(){this.isControllingScroll(0,1)&&this.onHScrollCommon(0)}onHScrollCommon(e){const t=this.centerRowsCtrl.getViewportElement(),{scrollLeft:s}=t;if(this.shouldBlockScrollUpdate(1,s,!0))return;let i;e===0?i=uh(t,this.enableRtl):i=this.ctrlsService.get("fakeHScrollComp").getScrollPosition(),this.doHorizontalScroll(Math.round(i)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(1,0)&&this.onVScrollCommon(1)}onVScroll(){this.isControllingScroll(0,0)&&this.onVScrollCommon(0)}onVScrollCommon(e){let t;e===0?t=this.eBodyViewport.scrollTop:t=this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),!this.shouldBlockScrollUpdate(0,t,!0)&&(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,e===0?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:w.EVENT_BODY_SCROLL,direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const s=Jt(Je({},t),{type:w.EVENT_BODY_SCROLL_END});this.eventService.dispatchEvent(s)},100)}shouldBlockScrollUpdate(e,t,s=!1){return s&&!ao()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=lp(this.eBodyViewport),{scrollHeight:s}=this.eBodyViewport;return e<0||e+t>s}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:s}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&ch()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>s}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(0)}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e,t=!1){const i=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl&&ch()?e=e>0?0:i:e=Math.min(Math.max(e,0),i)),dh(this.centerRowsCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){return this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight,{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const s=this.rowModel.getRowCount();let i=-1;for(let r=0;r<s;r++){const n=this.rowModel.getRow(r);if(typeof e=="function"){if(n&&e(n)){i=r;break}}else if(e===n||e===n.data){i=r;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t){if(this.gos.isDomLayout("print"))return;const s=this.paginationProxy.getRowCount();if(typeof e!="number"||e<0||e>=s){console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+e);return}const r=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{r||this.paginationProxy.goToPageWithIndex(e);const n=this.ctrlsService.getGridBodyCtrl(),o=n.getStickyTopHeight(),a=n.getStickyBottomHeight(),l=this.paginationProxy.getRow(e);let u;do{const h=l.rowTop,p=l.rowHeight,g=this.paginationProxy.getPixelOffset(),m=l.rowTop-g,C=m+l.rowHeight,y=this.getVScrollPosition(),R=this.heightScaler.getDivStretchOffset(),x=y.top+R,S=y.bottom+R,T=S-x,I=this.heightScaler.getScrollPositionForPixel(m),V=this.heightScaler.getScrollPositionForPixel(C-T),H=Math.min((I+V)/2,m),P=x+o>m,N=S-a<C;let _=null;t==="top"?_=I:t==="bottom"?_=V:t==="middle"?_=H:P?_=I-o:N&&(_=V+a),_!==null&&(this.setVerticalScrollPosition(_),this.rowRenderer.redraw({afterScroll:!0})),u=h!==l.rowTop||p!==l.rowHeight}while(u);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(e,t="auto"){const s=this.columnModel.getGridColumn(e);if(!s||s.isPinned()||!this.columnModel.isColumnDisplayed(s))return;const i=this.getPositionedHorizontalScroll(s,t);this.getFrameworkOverrides().wrapIncoming(()=>{i!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(i),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(e,t){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(t),this.setVerticalScrollPosition(e),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:s,columnAfterEnd:i}=this.isColumnOutsideViewport(e),r=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),n=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?s:i)||r,l=o?i:s;t!=="auto"&&(a=t==="start",l=t==="end");const u=t==="middle";if(a||l||u){const{colLeft:h,colMiddle:p,colRight:g}=this.getColumnBounds(e);return u?p-n/2:a?o?g:h:o?h-n:g-n}return null}isColumnOutsideViewport(e){const{start:t,end:s}=this.getViewportBounds(),{colLeft:i,colRight:r}=this.getColumnBounds(e),n=this.enableRtl,o=n?t>r:s<r,a=n?s<i:t>i;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,s=this.columnModel.getBodyContainerWidth(),i=e.getActualWidth(),r=e.getLeft(),n=t?-1:1,o=t?s-r:r,a=o+i*n,l=o+i/2*n;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),s=t,i=e+t;return{start:s,end:i,width:e}}};f([A("ctrlsService")],uo.prototype,"ctrlsService",2);f([A("animationFrameService")],uo.prototype,"animationFrameService",2);f([A("paginationProxy")],uo.prototype,"paginationProxy",2);f([A("rowModel")],uo.prototype,"rowModel",2);f([A("rowContainerHeightService")],uo.prototype,"heightScaler",2);f([A("rowRenderer")],uo.prototype,"rowRenderer",2);f([A("columnModel")],uo.prototype,"columnModel",2);f([Ee],uo.prototype,"postConstruct",1);var dI="ag-force-vertical-scroll",YO="ag-selectable",qO="ag-column-moving",ri=class extends xe{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,s,i,r,n,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=s,this.eTop=i,this.eBottom=r,this.eStickyTop=n,this.eStickyBottom=o,this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new Jm(this.comp)),this.bodyScrollFeature=this.createManagedBean(new uo(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([i,s,r,n,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.filterManager.setupAdvancedFilterHeaderComp(i),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addFocusListeners(e){e.forEach(t=>{this.addManagedListener(t,"focusin",s=>{const{target:i}=s,r=rl(i,"ag-root",t);t.classList.toggle("ag-has-focus",!r)}),this.addManagedListener(t,"focusout",s=>{const{target:i,relatedTarget:r}=s,n=t.contains(r),o=rl(r,"ag-root",t);rl(i,"ag-root",t)||(!n||o)&&t.classList.remove("ag-has-focus")})})}setColumnMovingCss(e){this.comp.setColumnMovingCss(qO,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(YO,e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();const t=e&&this.gos.getScrollbarWidth()||0,s=c0()?16:0,i=`calc(100% + ${t+s}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(i))}onGridColumnsChanged(){const e=this.columnModel.getAllGridColumns();this.comp.setColumnCount(e.length)}disableBrowserDragging(){this.addManagedListener(this.eGridBody,"dragstart",e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const e=s=>{const i=s.relatedTarget;if(bf(i)===null){this.rowRenderer.stopEditing();return}let r=t.some(n=>n.contains(i))&&this.mouseEventService.isElementInThisGrid(i);if(!r){const n=this.popupService;r=n.getActivePopups().some(o=>o.contains(i))||n.isElementWithinCustomPopup(i)}r||this.rowRenderer.stopEditing()},t=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];t.forEach(s=>this.addManagedListener(s,"focusout",e))}updateRowCount(){const e=this.headerNavigationService.getHeaderRowCount()+this.filterManager.getHeaderRowCount(),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,s=t===-1?-1:e+t;this.comp.setRowCount(s)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?dI:null,s=this.gos.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||s&&aF(this.eBodyViewport)}setupRowAnimationCssClass(){const e=()=>{const t=this.gos.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),s=t?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(s,t)};e(),this.addManagedListener(this.eventService,w.EVENT_HEIGHT_SCALE_CHANGED,e),this.addManagedPropertyListener("animateRows",e)}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",e),this.mockContextMenuForIPad(e),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyWheel.bind(this)),this.addManagedListener(this.eStickyBottom,"wheel",this.onStickyWheel.bind(this)),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const e=this.eBodyViewport.querySelector(".ag-full-width-container"),t=this.eBodyViewport.querySelector(".ag-center-cols-viewport");e&&t&&this.addManagedListener(e,"wheel",s=>this.onFullWidthContainerWheel(s,t))}onFullWidthContainerWheel(e,t){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),t.scrollBy({left:e.deltaX}))}onBodyViewportContextMenu(e,t,s){if(!e&&!s)return;this.gos.get("preventDefaultOnContextMenu")&&(e||s).preventDefault();const{target:i}=e||t;(i===this.eBodyViewport||i===this.ctrlsService.get("center").getViewportElement())&&this.menuService.showContextMenu({mouseEvent:e,touchEvent:s,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(e){if(!ao())return;const t=new ks(this.eBodyViewport),s=i=>{e(void 0,i.touchStart,i.touchEvent)};this.addManagedListener(t,ks.EVENT_LONG_TAP,s),this.addDestroyFunc(()=>t.destroy())}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}onStickyWheel(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new ur(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}onPinnedRowDataChanged(){this.setFloatingHeights()}setFloatingHeights(){const{pinnedRowModel:e}=this;let t=e.getPinnedTopTotalHeight(),s=e.getPinnedBottomTotalHeight();this.comp.setTopHeight(t),this.comp.setBottomHeight(s),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(s?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.gos.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const t=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+this.filterManager.getHeaderHeight(),s=this.pinnedRowModel.getPinnedTopTotalHeight();let i=0;t>0&&(i+=t),s>0&&(i+=s),i>0&&(i+=1),this.comp.setStickyTopTop(`${i}px`)}setStickyBottomOffsetBottom(){const e=this.pinnedRowModel.getPinnedBottomTotalHeight(),s=this.scrollVisibleService.isHorizontalScrollShowing()&&this.gos.getScrollbarWidth()||0,i=e+s;this.comp.setStickyBottomBottom(`${i}px`)}sizeColumnsToFit(e,t){const i=this.isVerticalScrollShowing()?this.gos.getScrollbarWidth():0,n=Il(this.eGridBody)-i;if(n>0){this.columnModel.sizeColumnsToFit(n,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFit(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFit(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFit(e,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}};f([A("animationFrameService")],ri.prototype,"animationFrameService",2);f([A("rowContainerHeightService")],ri.prototype,"rowContainerHeightService",2);f([A("ctrlsService")],ri.prototype,"ctrlsService",2);f([A("columnModel")],ri.prototype,"columnModel",2);f([A("scrollVisibleService")],ri.prototype,"scrollVisibleService",2);f([A("menuService")],ri.prototype,"menuService",2);f([A("headerNavigationService")],ri.prototype,"headerNavigationService",2);f([A("dragAndDropService")],ri.prototype,"dragAndDropService",2);f([A("pinnedRowModel")],ri.prototype,"pinnedRowModel",2);f([A("rowRenderer")],ri.prototype,"rowRenderer",2);f([A("popupService")],ri.prototype,"popupService",2);f([A("mouseEventService")],ri.prototype,"mouseEventService",2);f([A("rowModel")],ri.prototype,"rowModel",2);f([A("filterManager")],ri.prototype,"filterManager",2);var ed="ag-cell-range-selected",QO="ag-cell-range-chart",ZO="ag-cell-range-single-cell",JO="ag-cell-range-chart-category",XO="ag-cell-range-handle",eG="ag-cell-range-top",tG="ag-cell-range-right",sG="ag-cell-range-bottom",iG="ag-cell-range-left",rG=class{constructor(e,t){this.beans=e,this.rangeService=e.rangeService,this.selectionHandleFactory=e.selectionHandleFactory,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(ed,this.rangeCount!==0),this.cellComp.addOrRemoveCssClass(`${ed}-1`,this.rangeCount===1),this.cellComp.addOrRemoveCssClass(`${ed}-2`,this.rangeCount===2),this.cellComp.addOrRemoveCssClass(`${ed}-3`,this.rangeCount===3),this.cellComp.addOrRemoveCssClass(`${ed}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass(QO,this.hasChartRange),$c(this.eGui,this.rangeCount>0?!0:void 0),this.cellComp.addOrRemoveCssClass(ZO,this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),s=!t&&e.top,i=!t&&e.right,r=!t&&e.bottom,n=!t&&e.left;this.cellComp.addOrRemoveCssClass(eG,s),this.cellComp.addOrRemoveCssClass(tG,i),this.cellComp.addOrRemoveCssClass(sG,r),this.cellComp.addOrRemoveCssClass(iG,n)}isSingleCell(){const{rangeService:e}=this.beans;return this.rangeCount===1&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(s=>rr([1,0],s.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,s=!1,i=!1,r=!1;const n=this.cellCtrl.getCellPosition().column,o=this.beans.columnModel;let a,l;e?(a=o.getDisplayedColAfter(n),l=o.getDisplayedColBefore(n)):(a=o.getDisplayedColBefore(n),l=o.getDisplayedColAfter(n));const u=this.rangeService.getCellRanges().filter(h=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),h));a||(r=!0),l||(s=!0);for(let h=0;h<u.length&&!(t&&s&&i&&r);h++){const p=u[h],g=this.rangeService.getRangeStartRow(p),m=this.rangeService.getRangeEndRow(p);!t&&this.beans.rowPositionUtils.sameRow(g,this.cellCtrl.getCellPosition())&&(t=!0),!i&&this.beans.rowPositionUtils.sameRow(m,this.cellCtrl.getCellPosition())&&(i=!0),!r&&a&&p.columns.indexOf(a)<0&&(r=!0),!s&&l&&p.columns.indexOf(l)<0&&(s=!0)}return{top:t,right:s,bottom:i,left:r}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass(XO,!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeService.getCellRanges(),s=t.length;if(this.rangeCount<1||s<1)return!1;const i=At(t),r=this.cellCtrl.getCellPosition(),n=e.get("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),o=e.get("enableRangeHandle");let a=s===1&&!this.cellCtrl.isEditing()&&(n||o);if(this.hasChartRange){const u=t[0].type===1&&this.rangeService.isCellInSpecificRange(r,t[0]);this.cellComp.addOrRemoveCssClass(JO,u),a=i.type===0}return a&&i.endRow!=null&&this.rangeService.isContiguousRange(i)&&this.rangeService.isBottomRightCell(i,r)}addSelectionHandle(){const e=this.beans.gos,t=At(this.rangeService.getCellRanges()).type,i=e.get("enableFillHandle")&&nt(t)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==i&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(i)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},nG=class extends xe{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListener(this.beans.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}setComp(e){this.eGui=e,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();wn(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const e=this.column.getColSpan(this.rowNode),t=[];if(e===1)t.push(this.column);else{let s=this.column;const i=this.column.getPinned();for(let r=0;s&&r<e&&(t.push(s),s=this.beans.columnModel.getDisplayedColAfter(s),!(!s||nt(s)||i!==s.getPinned()));r++);}return t}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=At(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||this.column.getPinned()==="left")return e;const t=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(this.column.getPinned()==="right"){const s=this.beans.columnModel.getBodyContainerWidth();return t+s+(e||0)}return t+(e||0)}applyRowSpan(e){if(this.rowSpan===1&&!e)return;const s=this.beans.gos.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=`${s}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},oG=class extends xe{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),{cellClassRules:t}=e,s=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(t===this.cellClassRules?void 0:this.cellClassRules,t,s,i=>this.cellComp.addOrRemoveCssClass(i,!0),i=>this.cellComp.addOrRemoveCssClass(i,!1)),this.cellClassRules=t}applyUserStyles(){const e=this.column.getColDef();if(!e.cellStyle)return;let t;if(typeof e.cellStyle=="function"){const s=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex}),i=e.cellStyle;t=i(s)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}applyClassesFromColDef(){const e=this.column.getColDef(),t=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(s=>this.cellComp.addOrRemoveCssClass(s,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach(s=>this.cellComp.addOrRemoveCssClass(s,!0))}destroy(){super.destroy()}},ht=class{postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gos.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}};f([A("resizeObserverService")],ht.prototype,"resizeObserverService",2);f([A("paginationProxy")],ht.prototype,"paginationProxy",2);f([A("context")],ht.prototype,"context",2);f([A("gridOptionsService")],ht.prototype,"gos",2);f([A("environment")],ht.prototype,"environment",2);f([A("rowRenderer")],ht.prototype,"rowRenderer",2);f([A("valueService")],ht.prototype,"valueService",2);f([A("eventService")],ht.prototype,"eventService",2);f([A("columnModel")],ht.prototype,"columnModel",2);f([A("headerNavigationService")],ht.prototype,"headerNavigationService",2);f([A("navigationService")],ht.prototype,"navigationService",2);f([A("columnAnimationService")],ht.prototype,"columnAnimationService",2);f([A("focusService")],ht.prototype,"focusService",2);f([A("popupService")],ht.prototype,"popupService",2);f([A("stylingService")],ht.prototype,"stylingService",2);f([A("columnHoverService")],ht.prototype,"columnHoverService",2);f([A("userComponentFactory")],ht.prototype,"userComponentFactory",2);f([A("userComponentRegistry")],ht.prototype,"userComponentRegistry",2);f([A("animationFrameService")],ht.prototype,"animationFrameService",2);f([A("dragService")],ht.prototype,"dragService",2);f([A("dragAndDropService")],ht.prototype,"dragAndDropService",2);f([A("sortController")],ht.prototype,"sortController",2);f([A("filterManager")],ht.prototype,"filterManager",2);f([A("rowContainerHeightService")],ht.prototype,"rowContainerHeightService",2);f([A("frameworkOverrides")],ht.prototype,"frameworkOverrides",2);f([A("cellPositionUtils")],ht.prototype,"cellPositionUtils",2);f([A("rowPositionUtils")],ht.prototype,"rowPositionUtils",2);f([A("selectionService")],ht.prototype,"selectionService",2);f([A("rowCssClassCalculator")],ht.prototype,"rowCssClassCalculator",2);f([A("rowModel")],ht.prototype,"rowModel",2);f([A("ctrlsService")],ht.prototype,"ctrlsService",2);f([A("ctrlsFactory")],ht.prototype,"ctrlsFactory",2);f([A("agStackComponentsRegistry")],ht.prototype,"agStackComponentsRegistry",2);f([A("valueCache")],ht.prototype,"valueCache",2);f([A("rowNodeEventThrottle")],ht.prototype,"rowNodeEventThrottle",2);f([A("localeService")],ht.prototype,"localeService",2);f([A("syncService")],ht.prototype,"syncService",2);f([A("ariaAnnouncementService")],ht.prototype,"ariaAnnouncementService",2);f([Lt("rangeService")],ht.prototype,"rangeService",2);f([Lt("selectionHandleFactory")],ht.prototype,"selectionHandleFactory",2);f([Ee],ht.prototype,"postConstruct",1);ht=f([je("beans")],ht);var aG=class extends ht{constructor(e,t,s){super(),this.cellCtrl=e,this.beans=t,this.column=s}onMouseEvent(e,t){if(!en(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.isDoubleClickOnIPad()){this.onCellDoubleClicked(e),e.preventDefault();return}const{eventService:t,rangeService:s,gos:i}=this.beans,r=e.ctrlKey||e.metaKey;s&&r&&s.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&s.intersectLastRange(!0);const n=this.cellCtrl.createEvent(e,w.EVENT_CELL_CLICKED);t.dispatchEvent(n);const o=this.column.getColDef();o.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{o.onCellClicked(n)})},0),(i.get("singleClickEdit")||o.singleClickEdit)&&!i.get("suppressClickEdit")&&!(e.shiftKey&&(s==null?void 0:s.getCellRanges().length)!=0)&&this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!ao()||ZS("dblclick"))return!1;const e=new Date().getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const t=this.column.getColDef(),s=this.cellCtrl.createEvent(e,w.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(s),typeof t.onCellDoubleClicked=="function"&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{t.onCellDoubleClicked(s)})},0),!this.beans.gos.get("singleClickEdit")&&!this.beans.gos.get("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:s,shiftKey:i}=e,r=e.target,{cellCtrl:n,beans:o}=this,{eventService:a,rangeService:l,focusService:u}=o;if(this.isRightClickInExistingRange(e))return;const h=l&&l.getCellRanges().length!=0;if(!i||!h){const p=Pn()&&!n.isEditing()&&!h0(r);n.focusCell(p)}if(i&&h&&!u.isCellFocused(n.getCellPosition())){e.preventDefault();const p=u.getFocusedCell();if(p){const{column:g,rowIndex:m,rowPinned:C}=p,y=o.rowRenderer.getRowByPosition({rowIndex:m,rowPinned:C}),R=y==null?void 0:y.getCellCtrl(g);R!=null&&R.isEditing()&&R.stopEditing(),u.setFocusedCell({column:g,rowIndex:m,rowPinned:C,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(r)){if(l){const p=this.cellCtrl.getCellPosition();if(i)l.extendLatestRangeToCell(p);else{const g=t||s;l.setRangeToCell(p,g)}}a.dispatchEvent(this.cellCtrl.createEvent(e,w.EVENT_CELL_MOUSE_DOWN))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){const s=t.isCellInAnyRange(this.cellCtrl.getCellPosition()),i=e.button===2||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(s&&i)return!0}return!1}containsWidget(e){return rl(e,"ag-selection-checkbox",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,w.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const t=this.cellCtrl.createEvent(e,w.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(t),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),s=t.contains(e.target),i=t.contains(e.relatedTarget);return s&&i}destroy(){}},lG=class extends xe{constructor(e,t,s,i,r){super(),this.cellCtrl=e,this.beans=t,this.rowNode=i,this.rowCtrl=r}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case z.ENTER:this.onEnterKeyDown(e);break;case z.F2:this.onF2KeyDown(e);break;case z.ESCAPE:this.onEscapeKeyDown(e);break;case z.TAB:this.onTabKeyDown(e);break;case z.BACKSPACE:case z.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case z.DOWN:case z.UP:case z.RIGHT:case z.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){var s;const{cellCtrl:i,beans:r,rowNode:n}=this,{gos:o,rangeService:a,eventService:l}=r;if(!i.isEditing()){if(l.dispatchEvent({type:w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),vF(e,o.get("enableCellEditingOnBackspace"))){if(a&&o.get("enableRangeSelection"))a.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){const u=i.getColumn(),h=(s=this.beans.valueService.parseValue(u,n,"",n.getValueFromValueService(u)))!=null?s:null;n.setDataValue(u,h,"cellClear")}}else i.startRowOrCellEdit(e,t);l.dispatchEvent({type:w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END})}}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const t=e.shiftKey?z.UP:z.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(z.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(z.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const i=e.key;i===" "?this.onSpaceKeyDown(e):(this.cellCtrl.startRowOrCellEdit(i,e),e.preventDefault())}onSpaceKeyDown(e){const{gos:t}=this.beans;if(!this.cellCtrl.isEditing()&&t.isRowSelection()){const s=this.rowNode.isSelected(),i=!s;if(i||!t.get("suppressRowDeselection")){const r=this.beans.gos.get("groupSelectsFiltered"),n=this.rowNode.setSelectedParams({newValue:i,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spaceKey"});s===void 0&&n===0&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spaceKey"})}}e.preventDefault()}destroy(){super.destroy()}},hI=class extends ot{constructor(e,t,s){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=s}postConstruct(){this.getGui().appendChild(rs("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const t=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);const s=()=>{try{const i=JSON.stringify(this.rowNode.data);e.dataTransfer.setData("application/json",i),e.dataTransfer.setData("text/plain",i)}catch{}};if(t){const i=this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:e});t(i)}else s()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};f([Ee],hI.prototype,"postConstruct",1);var cG="ag-column-first",uG="ag-column-last",Xm=class{static getHeaderClassesFromColDef(e,t,s,i){return nt(e)?[]:this.getColumnClassesFromCollDef(e.headerClass,e,t,s,i)}static getToolPanelClassesFromColDef(e,t,s,i){return nt(e)?[]:this.getColumnClassesFromCollDef(e.toolPanelClass,e,t,s,i)}static refreshFirstAndLastStyles(e,t,s){e.addOrRemoveCssClass(cG,s.isColumnAtEdge(t,"first")),e.addOrRemoveCssClass(uG,s.isColumnAtEdge(t,"last"))}static getClassParams(e,t,s,i){return t.addGridCommonParams({colDef:e,column:s,columnGroup:i})}static getColumnClassesFromCollDef(e,t,s,i,r){if(nt(e))return[];let n;if(typeof e=="function"){const o=this.getClassParams(t,s,i,r);n=e(o)}else n=e;return typeof n=="string"?[n]:Array.isArray(n)?[...n]:[]}},dG="ag-cell",hG="ag-cell-auto-height",pG="ag-cell-normal-height",gG="ag-cell-focus",fG="ag-cell-first-right-pinned",mG="ag-cell-last-left-pinned",vG="ag-cell-not-inline-editing",CG="ag-column-hover",yG="ag-cell-wrap-text",wG=0,pI=class iw extends xe{constructor(t,s,i,r){super(),this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.column=t,this.rowNode=s,this.beans=i,this.rowCtrl=r,this.instanceId=t.getId()+"-"+wG++,this.colIdSanitised=ys(this.column.getId()),i.gos.get("suppressCellFocus")||(this.tabIndex=-1),this.createCellPosition(),this.addFeatures(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new nG(this,this.beans),this.addDestroyFunc(()=>{var s;(s=this.cellPositionFeature)==null||s.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new oG(this,this.beans),this.addDestroyFunc(()=>{var s;(s=this.cellCustomStyleFeature)==null||s.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new aG(this,this.beans,this.column),this.addDestroyFunc(()=>{var s;(s=this.cellMouseListenerFeature)==null||s.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new lG(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var s;(s=this.cellKeyboardListenerFeature)==null||s.destroy(),this.cellKeyboardListenerFeature=null}),this.column.isTooltipEnabled()&&(this.enableTooltipFeature(),this.addDestroyFunc(()=>{this.disableTooltipFeature()})),this.beans.rangeService&&this.beans.gos.get("enableRangeSelection")&&(this.cellRangeFeature=new rG(this.beans,this),this.addDestroyFunc(()=>{var s;(s=this.cellRangeFeature)==null||s.destroy(),this.cellRangeFeature=null}))}enableTooltipFeature(t,s){const i=()=>{const o=this.column.getColDef(),a=this.rowNode.data;if(o.tooltipField&&Ce(a))return Ec(a,o.tooltipField,this.column.isTooltipFieldContainsDots());const l=o.tooltipValueGetter;return l?l(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},r=this.beans.gos.get("tooltipShowMode")==="whenTruncated";!s&&r&&!this.isCellRenderer()&&(s=()=>{const o=this.getGui(),a=o.children.length===0?o:o.querySelector(".ag-cell-value");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:t!=null?()=>t:i,getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:s};this.tooltipFeature=new lo(n,this.beans)}disableTooltipFeature(){this.tooltipFeature&&(this.tooltipFeature.destroy(),this.tooltipFeature=null)}setComp(t,s,i,r,n){var o,a,l,u;this.cellComp=t,this.eGui=s,this.printLayout=r,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(i),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),(o=this.cellPositionFeature)==null||o.setComp(s),(a=this.cellCustomStyleFeature)==null||a.setComp(t),(l=this.tooltipFeature)==null||l.refreshToolTip(),(u=this.cellKeyboardListenerFeature)==null||u.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(t,s),n&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(h=>h()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(t){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!t)return;const s=t.parentElement,i=this.beans.gos.getRowHeightForNode(this.rowNode).height,r=a=>{if(this.editing||!this.isAlive())return;const{paddingTop:l,paddingBottom:u,borderBottomWidth:h,borderTopWidth:p}=da(s),g=l+u+h+p,C=t.offsetHeight+g;if(a<5){const R=this.beans.gos.getDocument(),x=!R||!R.contains(t),S=C==0;if(x||S){window.setTimeout(()=>r(a+1),0);return}}const y=Math.max(C,i);this.rowNode.setRowAutoHeight(y,this.column)},n=()=>r(0);n();const o=this.beans.resizeObserverService.observeResize(t,n);this.addDestroyFunc(()=>{o(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){var t;return(t=this.column.getColDef().cellAriaRole)!=null?t:"gridcell"}getInstanceId(){return this.instanceId}getColumnIdSanitised(){return this.colIdSanitised}getTabIndex(){return this.tabIndex}isCellRenderer(){const t=this.column.getColDef();return t.cellRenderer!=null||t.cellRendererSelector!=null}getValueToDisplay(){var t;return(t=this.valueFormatted)!=null?t:this.value}showValue(t=!1){var s;const i=this.getValueToDisplay();let r;if(this.rowNode.stub){const n=this.createCellRendererParams();r=this.beans.userComponentFactory.getLoadingCellRendererDetails(this.column.getColDef(),n)}else if(this.isCellRenderer()){const n=this.createCellRendererParams();r=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),n)}this.cellComp.setRenderDetails(r,i,t),(s=this.cellRangeFeature)==null||s.refreshHandle()}setupControlComps(){const t=this.column.getColDef();this.includeSelection=this.isIncludeControl(t.checkboxSelection),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(t){return this.rowNode.rowPinned!=null?!1:typeof t=="function"||t===!0}refreshShouldDestroy(){const t=this.column.getColDef(),s=this.includeSelection!=this.isIncludeControl(t.checkboxSelection),i=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),r=this.includeDndSource!=this.isIncludeControl(t.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return s||i||r||n}startEditing(t=null,s=!1,i=null){if(!this.isCellEditable()||this.editing)return;if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startEditing(t,s,i)});return}const r=this.createCellEditorParams(t,s),n=this.column.getColDef(),o=this.beans.userComponentFactory.getCellEditorDetails(n,r);this.editCompDetails=o;const a=(o==null?void 0:o.popupFromSelector)!=null?o.popupFromSelector:!!n.cellEditorPopup,l=(o==null?void 0:o.popupPositionFromSelector)!=null?o.popupPositionFromSelector:n.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(o,a,l,this.beans.gos.get("reactiveCustomComponents"));const u=this.createEvent(i,w.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(u)}setEditing(t){var s;this.editing!==t&&(this.editing=t,(s=this.cellRangeFeature)==null||s.refreshHandle())}stopRowOrCellEdit(t=!1){this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.stopEditing(t):this.stopEditing(t)}onPopupEditorClosed(){this.isEditing()&&this.stopEditingAndFocus()}takeValueFromCellEditor(t){const s={newValueExists:!1};if(t)return s;const i=this.cellComp.getCellEditor();return!i||i.isCancelAfterEnd&&i.isCancelAfterEnd()?s:{newValue:i.getValue(),newValueExists:!0}}saveNewValue(t,s){if(s===t)return!1;this.suppressRefreshCell=!0;const i=this.rowNode.setDataValue(this.column,s,"edit");return this.suppressRefreshCell=!1,i}stopEditing(t=!1){if(!this.editing)return!1;const{newValue:s,newValueExists:i}=this.takeValueFromCellEditor(t),r=this.rowNode.getValueFromValueService(this.column);let n=!1;return i&&(n=this.saveNewValue(r,s)),this.setEditing(!1),this.cellComp.setEditDetails(),this.editCompDetails=void 0,this.updateAndFormatValue(!1),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(r,s,!t&&!!n),n}dispatchEditingStoppedEvent(t,s,i){const r=Jt(Je({},this.createEvent(null,w.EVENT_CELL_EDITING_STOPPED)),{oldValue:t,newValue:s,valueChanged:i});this.beans.eventService.dispatchEvent(r)}createCellEditorParams(t,s){return this.beans.gos.addGridCommonParams({value:this.rowNode.getValueFromValueService(this.column),eventKey:t,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,cellStartedEdit:s,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)})}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:s=>this.beans.valueService.setValue(this.rowNode,this.column,s),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(s,i,r,n)=>this.registerRowDragger(s,i,n),setTooltip:(s,i)=>{var r;this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(s,i),(r=this.tooltipFeature)==null||r.refreshToolTip()}})}parseValue(t){return this.beans.valueService.parseValue(this.column,this.rowNode,t,this.getValue())}setFocusOutOnEditor(){if(!this.editing)return;const t=this.cellComp.getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(){if(!this.editing)return;const t=this.cellComp.getCellEditor();t&&t.focusIn?t.focusIn():this.focusCell(!0)}onCellChanged(t){t.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(t){var s;this.refreshShouldDestroy()?(s=this.rowCtrl)==null||s.recreateCell(this):this.refreshCell(t)}refreshCell(t){var s,i,r,n;if(this.suppressRefreshCell||this.editing)return;const o=this.column.getColDef(),a=t!=null&&!!t.newData,l=t!=null&&!!t.suppressFlash||!!o.suppressCellFlash,u=o.field==null&&o.valueGetter==null&&o.showRowGroup==null,h=t&&t.forceRefresh||u||a,p=!!this.cellComp,g=this.updateAndFormatValue(p),m=h||g;if(p){if(m){this.showValue(a);const C=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!l&&!C&&(this.beans.gos.get("enableCellChangeFlash")||o.enableCellChangeFlash)&&this.flashCell(),(s=this.cellCustomStyleFeature)==null||s.applyUserStyles(),(i=this.cellCustomStyleFeature)==null||i.applyClassesFromColDef()}(r=this.tooltipFeature)==null||r.refreshToolTip(),(n=this.cellCustomStyleFeature)==null||n.applyCellClassRules()}}stopEditingAndFocus(t=!1,s=!1){this.stopRowOrCellEdit(),this.focusCell(!0),t||this.navigateAfterEdit(s)}navigateAfterEdit(t){if(this.beans.gos.get("enterNavigatesVerticallyAfterEdit")){const i=t?z.UP:z.DOWN;this.beans.navigationService.navigateToNextCell(null,i,this.getCellPosition(),!1)}}flashCell(t){var s,i;const r=(s=t==null?void 0:t.flashDuration)!=null?s:t==null?void 0:t.flashDelay,n=(i=t==null?void 0:t.fadeDuration)!=null?i:t==null?void 0:t.fadeDelay;this.animateCell("data-changed",r,n)}animateCell(t,s,i){if(!this.cellComp)return;const r=`ag-cell-${t}`,n=`ag-cell-${t}-animation`,{gos:o}=this.beans;s||(s=o.get("cellFlashDuration")),Ce(i)||(i=o.get("cellFadeDuration")),this.cellComp.addOrRemoveCssClass(r,!0),this.cellComp.addOrRemoveCssClass(n,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(r,!1),this.cellComp.addOrRemoveCssClass(n,!0),this.eGui.style.transition=`background-color ${i}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(n,!1),this.eGui.style.transition="")},i))},s)})}onFlashCells(t){if(!this.cellComp)return;const s=this.beans.cellPositionUtils.createId(this.getCellPosition());t.cells[s]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(t){var s;return(s=this.callValueFormatter(t))!=null?s:t}callValueFormatter(t){return this.beans.valueService.formatValue(this.column,this.rowNode,t)}updateAndFormatValue(t){const s=this.value,i=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),t?!this.valuesAreEqual(s,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(t,s){const i=this.column.getColDef();return i.equals?i.equals(t,s):t===s}getComp(){return this.cellComp}getValue(){return this.value}addDomData(){const t=this.getGui();this.beans.gos.setDomData(t,iw.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gos.setDomData(t,iw.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(t,s){return this.beans.gos.addGridCommonParams({type:s,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:t,rowIndex:this.rowNode.rowIndex})}processCharacter(t){var s;(s=this.cellKeyboardListenerFeature)==null||s.processCharacter(t)}onKeyDown(t){var s;(s=this.cellKeyboardListenerFeature)==null||s.onKeyDown(t)}onMouseEvent(t,s){var i;(i=this.cellMouseListenerFeature)==null||i.onMouseEvent(t,s)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var t;this.cellComp&&((t=this.cellPositionFeature)==null||t.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:t,column:s,beans:i}=this;Xm.refreshFirstAndLastStyles(t,s,i.columnModel)}refreshAriaColIndex(){const t=this.beans.columnModel.getAriaColumnIndex(this.column);i0(this.getGui(),t)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var t;return(t=this.cellPositionFeature)==null?void 0:t.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(t,s=null){if(!this.cellComp){this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(t,s)});return}this.beans.gos.get("editType")==="fullRow"?this.rowCtrl.startRowEditing(t,this):this.startEditing(t,!0,s)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return this.cellRangeFeature!=null}focusCell(t=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:t})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const t=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass(fG,t)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const t=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass(mG,t)}onCellFocused(t){if(this.beans.gos.get("suppressCellFocus"))return;const s=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp){s&&(t!=null&&t.forceBrowserFocus)&&(this.focusEventToRestore=t);return}this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass(gG,s),s&&t&&t.forceBrowserFocus&&this.cellComp.getFocusableElement().focus({preventScroll:!!t.preventScrollOnBrowserFocus});const i=this.beans.gos.get("editType")==="fullRow";!s&&!i&&this.editing&&this.stopRowOrCellEdit(),s&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:Rn(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass(dG,!0),this.cellComp.addOrRemoveCssClass(vG,!0);const t=this.column.isAutoHeight()==!0;this.cellComp.addOrRemoveCssClass(hG,t),this.cellComp.addOrRemoveCssClass(pG,!t)}onColumnHover(){if(!this.cellComp||!this.beans.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass(CG,t)}onColDefChanged(){if(!this.cellComp)return;if(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),!this.editing)this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0});else{const s=this.getCellEditor();if(s!=null&&s.refresh){const{eventKey:i,cellStartedEdit:r}=this.editCompDetails.params,n=this.createCellEditorParams(i,r),o=this.column.getColDef(),a=this.beans.userComponentFactory.getCellEditorDetails(o,n);s.refresh(a.params)}}}setWrapText(){const t=this.column.getColDef().wrapText==!0;this.cellComp.addOrRemoveCssClass(yG,t)}dispatchCellContextMenuEvent(t){const s=this.column.getColDef(),i=this.createEvent(t,w.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(i),s.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{s.onCellContextMenu(i)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const t=new qm;return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t}createDndSource(){const t=new hI(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(t),t}registerRowDragger(t,s,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(t,s);return}const r=this.createRowDragComp(t,s,i);r&&(this.customRowDragComp=r,this.addDestroyFunc(()=>{this.beans.context.destroyBean(r),this.customRowDragComp=null}))}createRowDragComp(t,s,i){const r=this.beans.gos.get("pagination"),n=this.beans.gos.get("rowDragManaged"),o=this.beans.gos.isRowModelType("clientSide");if(n){if(!o){tt("managed row dragging is only allowed in the Client Side Row Model");return}if(r){tt("managed row dragging is not possible when doing pagination");return}}const a=new vl(()=>this.value,this.rowNode,this.column,t,s,i);return this.beans.context.createBean(a),a}};pI.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var ol=pI,SG=0,gI=class rw extends xe{constructor(t,s,i,r,n){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=s,this.gos=s.gos,this.rowNode=t,this.paginationPage=s.paginationProxy.getCurrentPage(),this.useAnimationFrameForCreate=r,this.printLayout=n,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=t.id+"-"+SG++,this.rowId=ys(t.id),this.initRowBusinessKey(),this.rowFocused=s.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=s.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.isFullWidth()&&!this.gos.get("suppressCellFocus")&&(this.tabIndex=-1),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const t=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=ys(t)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}getTabIndex(){return this.tabIndex}isSticky(){return this.rowNode.sticky}getInstanceId(){return this.instanceId}setComp(t,s,i){const r={rowComp:t,element:s,containerType:i};this.allRowGuis.push(r),i==="left"?this.leftGui=r:i==="right"?this.rightGui=r:i==="fullWidth"?this.fullWidthGui=r:this.centerGui=r,this.initialiseRowComp(r),this.rowType!=="FullWidthLoading"&&!this.rowNode.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(t){switch(this.allRowGuis=this.allRowGuis.filter(s=>s.containerType!==t),t){case"left":this.leftGui=void 0;break;case"right":this.rightGui=void 0;break;case"fullWidth":this.fullWidthGui=void 0;break;case"center":this.centerGui=void 0;break}}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(t){const s=t?"none":"";this.allRowGuis.forEach(i=>i.element.style.display=s)}initialiseRowComp(t){const s=this.gos;this.listenOnDomOrder(t),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),s.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=t.rowComp;this.getInitialRowClasses(t.containerType).forEach(n=>i.addOrRemoveCssClass(n,!0)),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&Jn(t.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),s.setDomData(t.element,rw.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>s.setDomData(t.element,rw.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t.element),this.isFullWidth()&&this.setupFullWidth(t),s.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(t){this.businessKeySanitised!=null&&t.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(t){this.rowId=ys(this.rowNode.id),this.rowId!=null&&t.setRowId(this.rowId)}executeSlideAndFadeAnimations(t){const{containerType:s}=t;this.slideInAnimation[s]&&(Wy(()=>{this.onTopChanged()}),this.slideInAnimation[s]=!1),this.fadeInAnimation[s]&&(Wy(()=>{t.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[s]=!1)}addRowDraggerToRow(t){if(this.gos.get("enableRangeSelection")){tt("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`");return}const s=this.beans.localeService.getLocaleTextFunc(),i=new vl(()=>`1 ${s("rowDragRow","row")}`,this.rowNode,void 0,t.element,void 0,!0),r=this.createBean(i,this.beans.context);this.rowDragComps.push(r)}setupFullWidth(t){const s=this.getPinnedForContainer(t.containerType);if(this.rowType=="FullWidthDetail"&&!Nt.__assertRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;const i=this.createFullWidthCompDetails(t.element,s);t.rowComp.showFullWidth(i)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){var t,s;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(i=>{var r;return(r=i==null?void 0:i.rowComp)==null?void 0:r.getFullWidthCellRenderer()}):[(s=(t=this.fullWidthGui)==null?void 0:t.rowComp)==null?void 0:s.getFullWidthCellRenderer()]}getCellElement(t){const s=this.getCellCtrl(t);return s?s.getGui():null}executeProcessRowPostCreateFunc(){const t=this.gos.getCallback("processRowPostCreate");if(!t||!this.areAllContainersReady())return;const s={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};t(s)}areAllContainersReady(){const t=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),s=!!this.centerGui,i=!!this.rightGui||!this.beans.columnModel.isPinningRight();return t&&s&&i}setRowType(){const t=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow"),s=this.rowNode.isFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,r=this.beans.columnModel.isPivotMode(),o=!!this.rowNode.group&&!this.rowNode.footer&&this.gos.isGroupUseEntireRow(r);t?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":s?this.rowType="FullWidth":o?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(t=!1,s=!1){if(this.isFullWidth())return;if(t||this.gos.get("suppressAnimationFrame")||this.printLayout){this.updateColumnListsImpl(s);return}this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(t,s,i=null){const r={list:[],map:{}},n=(o,a)=>{r.list.push(a),r.map[o]=a};return s.forEach(o=>{const a=o.getInstanceId();let l=t.map[a];l||(l=new ol(o,this.rowNode,this.beans,this)),n(a,l)}),t.list.forEach(o=>{if(r.map[o.getColumn().getInstanceId()]!=null)return;if(!this.isCellEligibleToBeRemoved(o,i)){n(o.getColumn().getInstanceId(),o);return}o.destroy()}),r}updateColumnListsImpl(t){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(t)}setCellCtrls(t){this.allRowGuis.forEach(s=>{const i=this.getCellCtrlsForContainer(s.containerType);s.rowComp.setCellCtrls(i,t)})}getCellCtrlsForContainer(t){switch(t){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list;default:const s=t;throw new Error(`Unhandled case: ${s}`)}}createAllCellCtrls(){const t=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const s=t.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,s);const i=t.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,i,"left");const r=t.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(t,s){if(t.getColumn().getPinned()!=s)return!0;const o=t.isEditing(),a=this.beans.focusService.isCellFocused(t.getCellPosition());if(o||a){const u=t.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(u)>=0)}return!0}getDomOrder(){return this.gos.get("ensureDomOrder")||this.gos.isDomLayout("print")}listenOnDomOrder(t){const s=()=>{t.rowComp.setDomOrder(this.getDomOrder())};this.addManagedPropertyListener("domLayout",s),this.addManagedPropertyListener("ensureDomOrder",s)}setAnimateFlags(t){if(this.isSticky()||!t)return;const s=Ce(this.rowNode.oldRowTop),i=this.beans.columnModel.isPinningLeft(),r=this.beans.columnModel.isPinningRight();if(s){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.slideInAnimation.fullWidth=!0;return}this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=r}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){this.fadeInAnimation.fullWidth=!0;return}this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=r}}isEditing(){return this.editingRow}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const t=(a,l)=>a?a.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(a.element,l).params):!0,s=t(this.fullWidthGui,null),i=t(this.centerGui,null),r=t(this.leftGui,"left"),n=t(this.rightGui,"right");return s&&i&&r&&n}addListeners(){this.addManagedListener(this.rowNode,ft.EVENT_HEIGHT_CHANGED,()=>this.onRowHeightChanged()),this.addManagedListener(this.rowNode,ft.EVENT_ROW_SELECTED,()=>this.onRowSelected()),this.addManagedListener(this.rowNode,ft.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.rowNode.detail&&this.addManagedListener(this.rowNode.parent,ft.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_CELL_CHANGED,this.postProcessCss.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_DRAGGING_CHANGED,this.postProcessRowDragging.bind(this)),this.addManagedListener(this.rowNode,ft.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));const t=this.beans.eventService;this.addManagedListener(t,w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(t,w.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(t,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(t,w.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(t,w.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addManagedListener(t,w.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusChanged.bind(this)),this.addManagedListener(t,w.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(t,w.EVENT_MODEL_UPDATED,this.refreshFirstAndLastRowStyles.bind(this)),this.addManagedListener(t,w.EVENT_COLUMN_MOVED,this.updateColumnLists.bind(this)),this.addDestroyFunc(()=>{this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowDragEntireRow"],()=>{if(this.gos.get("rowDragEntireRow")){this.allRowGuis.forEach(i=>{this.addRowDraggerToRow(i)});return}this.destroyBeans(this.rowDragComps,this.beans.context),this.rowDragComps=[]}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListener(this.rowNode,ft.EVENT_ROW_INDEX_CHANGED,()=>{this.getAllCellCtrls().forEach(t=>t.onRowIndexChanged())}),this.addManagedListener(this.rowNode,ft.EVENT_CELL_CHANGED,t=>{this.getAllCellCtrls().forEach(s=>s.onCellChanged(t))})}onRowNodeDataChanged(t){if(this.isFullWidth()!==!!this.rowNode.isFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(i=>i.refreshCell({suppressFlash:!t.update,newData:!t.update})),this.allRowGuis.forEach(i=>{this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const t=this.rowNode.highlighted;this.allRowGuis.forEach(s=>{const i=t===0,r=t===1;s.rowComp.addOrRemoveCssClass("ag-row-highlight-above",i),s.rowComp.addOrRemoveCssClass("ag-row-highlight-below",r)})}postProcessRowDragging(){const t=this.rowNode.dragging;this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass("ag-row-dragging",t))}updateExpandedCss(){const t=this.rowNode.isExpandable(),s=this.rowNode.expanded==!0;this.allRowGuis.forEach(i=>{i.rowComp.addOrRemoveCssClass("ag-row-group",t),i.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&s),i.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!s),Jn(i.element,t&&s)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Rn(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(t){const s=this.allRowGuis.find(l=>l.element.contains(t.target));if(!((s?s.element:null)===t.target))return;const n=this.rowNode,o=this.beans.focusService.getFocusedCell(),a={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:o&&o.column};this.beans.navigationService.navigateToNextCell(t,t.key,a,!0),t.preventDefault()}onTabKeyDown(t){if(t.defaultPrevented||en(t))return;const s=this.allRowGuis.find(o=>o.element.contains(t.target)),i=s?s.element:null,r=i===t.target;let n=null;r||(n=this.beans.focusService.findNextFocusableElement(i,!1,t.shiftKey)),(this.isFullWidth()&&r||!n)&&this.beans.navigationService.onTabKeyDown(this,t)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var t;const s=(t=this.allRowGuis.find(i=>ji(i.element)))==null?void 0:t.element;return s?s.getBoundingClientRect().top:0}onFullWidthRowFocused(t){var s;const i=this.rowNode,r=t?this.isFullWidth()&&t.rowIndex===i.rowIndex&&t.rowPinned==i.rowPinned:!1,n=this.fullWidthGui?this.fullWidthGui.element:(s=this.centerGui)==null?void 0:s.element;n&&(n.classList.toggle("ag-full-width-focus",r),r&&n.focus({preventScroll:!0}))}recreateCell(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),t.destroy(),this.updateColumnLists()}removeCellCtrl(t,s){const i={list:[],map:{}};return t.list.forEach(r=>{r!==s&&(i.list.push(r),i.map[r.getColumn().getInstanceId()]=r)}),i}onMouseEvent(t,s){switch(t){case"dblclick":this.onRowDblClick(s);break;case"click":this.onRowClick(s);break;case"touchstart":case"mousedown":this.onRowMouseDown(s);break}}createRowEvent(t,s){return this.gos.addGridCommonParams({type:t,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:s})}createRowEventWithSource(t,s){const i=this.createRowEvent(t,s);return i.source=this,i}onRowDblClick(t){if(en(t))return;const s=this.createRowEventWithSource(w.EVENT_ROW_DOUBLE_CLICKED,t);this.beans.eventService.dispatchEvent(s)}onRowMouseDown(t){if(this.lastMouseDownOnDragger=rl(t.target,"ag-row-drag",3),!this.isFullWidth())return;const s=this.rowNode,i=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:s.rowIndex,column:i.getAllDisplayedColumns()[0],rowPinned:s.rowPinned,forceBrowserFocus:!0})}onRowClick(t){if(en(t)||this.lastMouseDownOnDragger)return;const i=this.createRowEventWithSource(w.EVENT_ROW_CLICKED,t);this.beans.eventService.dispatchEvent(i);const r=t.ctrlKey||t.metaKey,n=t.shiftKey;if(this.gos.get("groupSelectsChildren")&&this.rowNode.group||this.isRowSelectionBlocked()||this.gos.get("suppressRowClickSelection"))return;const a=this.gos.get("rowMultiSelectWithClick"),l=!this.gos.get("suppressRowDeselection"),u="rowClicked";if(this.rowNode.isSelected())a?this.rowNode.setSelectedParams({newValue:!1,event:t,source:u}):r?l&&this.rowNode.setSelectedParams({newValue:!1,event:t,source:u}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!n,rangeSelect:n,event:t,source:u});else{const h=a?!1:!r;this.rowNode.setSelectedParams({newValue:!0,clearSelection:h,rangeSelect:n,event:t,source:u})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!this.gos.isRowSelection()}setupDetailRowAutoHeight(t){if(this.rowType!=="FullWidthDetail"||!this.gos.get("detailRowAutoHeight"))return;const s=()=>{const r=t.clientHeight;if(r!=null&&r>0){const n=()=>{this.rowNode.setRowHeight(r),this.beans.clientSideRowModel?this.beans.clientSideRowModel.onRowHeightChanged():this.beans.serverSideRowModel&&this.beans.serverSideRowModel.onRowHeightChanged()};window.setTimeout(n,0)}},i=this.beans.resizeObserverService.observeResize(t,s);this.addDestroyFunc(i),s()}createFullWidthCompDetails(t,s){const i=this.gos.addGridCommonParams({fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,eGridCell:t,eParentOfValue:t,pinned:s,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(r,n,o,a)=>this.addFullWidthRowDragging(r,n,o,a),setTooltip:(r,n)=>this.refreshRowTooltip(r,n)});switch(this.rowType){case"FullWidthDetail":return this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(i);case"FullWidthGroup":return this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(i);case"FullWidthLoading":return this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(i);default:return this.beans.userComponentFactory.getFullWidthCellRendererDetails(i)}}refreshRowTooltip(t,s){if(!this.fullWidthGui)return;const i={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>t,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:s};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new lo(i,this.beans))}addFullWidthRowDragging(t,s,i="",r){if(!this.isFullWidth())return;const n=new vl(()=>i,this.rowNode,void 0,t,s,r);this.createBean(n,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(n,this.beans.context)})}onUiLevelChanged(){const t=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=t){const s="ag-row-level-"+t,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(r=>{r.rowComp.addOrRemoveCssClass(s,!0),r.rowComp.addOrRemoveCssClass(i,!1)})}this.rowLevel=t}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}refreshFirstAndLastRowStyles(){const t=this.isFirstRowOnPage(),s=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-first",t))),this.lastRowOnPage!==s&&(this.lastRowOnPage=s,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-last",s)))}stopEditing(t=!1){if(this.stoppingRowEdit)return;const s=this.getAllCellCtrls(),i=this.editingRow;this.stoppingRowEdit=!0;let r=!1;for(const n of s){const o=n.stopEditing(t);i&&!t&&!r&&o&&(r=!0)}if(r){const n=this.createRowEvent(w.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(n)}i&&this.setEditingRow(!1),this.stoppingRowEdit=!1}setInlineEditingCss(t){this.allRowGuis.forEach(s=>{s.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),s.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})}setEditingRow(t){this.editingRow=t,this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass("ag-row-editing",t));const s=t?this.createRowEvent(w.EVENT_ROW_EDITING_STARTED):this.createRowEvent(w.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(s)}startRowEditing(t=null,s=null,i=null){if(this.editingRow)return;this.getAllCellCtrls().reduce((n,o)=>{const a=o===s;return a?o.startEditing(t,a,i):o.startEditing(null,a,i),n?!0:o.isEditing()},!1)&&this.setEditingRow(!0)}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const t=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);!t||!t.length||t.forEach(s=>{this.allRowGuis.forEach(i=>i.rowComp.addOrRemoveCssClass(s,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,t=>{this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass(t,!0))},t=>{this.allRowGuis.forEach(s=>s.rowComp.addOrRemoveCssClass(t,!1))})}setStylesFromGridOptions(t,s){t&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(s,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(t){return t==="left"?"left":t==="right"?"right":null}getInitialRowClasses(t){const s=this.getPinnedForContainer(t),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[t],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:s};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)}processStylesFromGridOptions(){const t=this.gos.get("rowStyle");if(t&&typeof t=="function"){console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");return}const s=this.gos.getCallback("getRowStyle");let i;if(s){const r={data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex};i=s(r)}return i||t?Object.assign({},t,i):this.emptyStyle}onRowSelected(t){const s=!!this.rowNode.isSelected();this.forEachGui(t,i=>{i.rowComp.addOrRemoveCssClass("ag-row-selected",s),$c(i.element,s),i.element.contains(this.beans.gos.getActiveDomElement())&&(i===this.centerGui||i===this.fullWidthGui)&&this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const t=this.rowNode.isSelected();if(t&&this.beans.gos.get("suppressRowDeselection"))return;const i=this.beans.localeService.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(i)}addHoverFunctionality(t){this.active&&(this.addManagedListener(t,"mouseenter",()=>this.rowNode.onMouseEnter()),this.addManagedListener(t,"mouseleave",()=>this.rowNode.onMouseLeave()),this.addManagedListener(this.rowNode,ft.EVENT_MOUSE_ENTER,()=>{!this.beans.dragService.isDragging()&&!this.gos.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),this.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,ft.EVENT_MOUSE_LEAVE,()=>{t.classList.remove("ag-row-hover"),this.rowNode.setHovered(!1)}))}roundRowTopToBounds(t){const s=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(s.top,!0)-100,r=this.applyPaginationOffset(s.bottom,!0)+100;return Math.min(Math.max(i,t),r)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(t,s){t?s(t):this.allRowGuis.forEach(s)}onRowHeightChanged(t){if(this.rowNode.rowHeight==null)return;const s=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=this.gos.isGetRowHeightFunction()?this.gos.getRowHeightForNode(this.rowNode).height:void 0,o=n?`${Math.min(i,n)-2}px`:void 0;this.forEachGui(t,a=>{a.element.style.height=`${s}px`,o&&a.element.style.setProperty("--ag-line-height",o)})}addEventListener(t,s){super.addEventListener(t,s)}removeEventListener(t,s){super.removeEventListener(t,s)}destroyFirstPass(t=!1){if(this.active=!1,!t&&this.gos.isAnimateRows()&&!this.isSticky())if(this.rowNode.rowTop!=null){const r=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(r)}else this.allRowGuis.forEach(r=>r.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0));this.rowNode.setHovered(!1);const s=this.createRowEvent(w.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(s),this.beans.eventService.dispatchEvent(s),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const t=s=>(s.list.forEach(i=>i.destroy()),{list:[],map:{}});this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)}setFocusedClasses(t){this.forEachGui(t,s=>{s.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),s.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const t=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses()),!t&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const t=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(t,s=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return t;const i=this.beans.paginationProxy.getPixelOffset();return t+i*(s?1:-1)}setRowTop(t){if(!this.printLayout&&Ce(t)){const s=this.applyPaginationOffset(t),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?s:this.beans.rowContainerHeightService.getRealPixelPosition(s)}px`;this.setRowTopStyle(n)}}getInitialRowTop(t){return this.suppressRowTransform?this.getInitialRowTopShared(t):void 0}getInitialTransform(t){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(t)})`}getInitialRowTopShared(t){if(this.printLayout)return"";let s;if(this.isSticky())s=this.rowNode.stickyRowTop;else{const i=this.slideInAnimation[t]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,r=this.applyPaginationOffset(i);s=this.rowNode.isRowPinned()?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}return s+"px"}setRowTopStyle(t){this.allRowGuis.forEach(s=>this.suppressRowTransform?s.rowComp.setTop(t):s.rowComp.setTransform(`translateY(${t})`))}getRowNode(){return this.rowNode}getCellCtrl(t){let s=null;return this.getAllCellCtrls().forEach(i=>{i.getColumn()==t&&(s=i)}),s!=null||this.getAllCellCtrls().forEach(i=>{i.getColSpanningList().indexOf(t)>=0&&(s=i)}),s}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(t){const s=this.rowNode.getRowIndexString(),i=this.beans.headerNavigationService.getHeaderRowCount()+this.beans.filterManager.getHeaderRowCount(),r=this.rowNode.rowIndex%2===0,n=i+this.rowNode.rowIndex+1;this.forEachGui(t,o=>{o.rowComp.setRowIndex(s),o.rowComp.addOrRemoveCssClass("ag-row-even",r),o.rowComp.addOrRemoveCssClass("ag-row-odd",!r),s0(o.element,n)})}};gI.DOM_DATA_KEY_ROW_CTRL="renderedRow";var al=gI,zi=class extends xe{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedListener(this.element,e,t)}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",ZS("touchstart")?"touchstart":"mousedown"].forEach(s=>{const i=this.processMouseEvent.bind(this,s);this.addManagedListener(this.element,s,i)})}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||en(t))return;const s=this.getRowForEvent(t),i=this.mouseEventService.getRenderedCellForEvent(t);e==="contextmenu"?this.handleContextMenuMouseEvent(t,void 0,s,i):(i&&i.onMouseEvent(e,t),s&&s.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!ao())return;const e=new ks(this.element),t=s=>{const i=this.getRowForEvent(s.touchEvent),r=this.mouseEventService.getRenderedCellForEvent(s.touchEvent);this.handleContextMenuMouseEvent(void 0,s.touchEvent,i,r)};this.addManagedListener(e,ks.EVENT_LONG_TAP,t),this.addDestroyFunc(()=>e.destroy())}getRowForEvent(e){let t=e.target;for(;t;){const s=this.gos.getDomData(t,al.DOM_DATA_KEY_ROW_CTRL);if(s)return s;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,s,i){const r=s?s.getRowNode():null,n=i?i.getColumn():null;let o=null;if(n){const u=e||t;i.dispatchCellContextMenuEvent(u??null),o=this.valueService.getValue(n,r)}const a=this.ctrlsService.getGridBodyCtrl(),l=i?i.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:r,column:n,value:o,anchorToElement:l})}getControlsForEventTarget(e){return{cellCtrl:Sf(this.gos,e,ol.DOM_DATA_KEY_CELL_CTRL),rowCtrl:Sf(this.gos,e,al.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:s,rowCtrl:i}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(s?this.processCellKeyboardEvent(s,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}processCellKeyboardEvent(e,t,s){const i=e.getRowNode(),r=e.getColumn(),n=e.isEditing();if(!Rf(this.gos,s,i,r,n)&&t==="keydown"&&(!n&&this.navigationService.handlePageScrollingKey(s)||e.onKeyDown(s),this.doGridOperations(s,e.isEditing()),Hm(s)&&e.processCharacter(s)),t==="keydown"){const a=e.createEvent(s,w.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(a)}}processFullWidthRowKeyboardEvent(e,t,s){const i=e.getRowNode(),r=this.focusService.getFocusedCell(),n=r&&r.column;if(!Rf(this.gos,s,i,n,!1)){const a=s.key;if(t==="keydown")switch(a){case z.PAGE_HOME:case z.PAGE_END:case z.PAGE_UP:case z.PAGE_DOWN:this.navigationService.handlePageScrollingKey(s,!0);break;case z.UP:case z.DOWN:e.onKeyboardNavigate(s);break;case z.TAB:e.onTabKeyDown(s);break}}if(t==="keydown"){const a=e.createRowEvent(w.EVENT_CELL_KEY_DOWN,s);this.eventService.dispatchEvent(a)}}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!this.mouseEventService.isEventFromThisGrid(e))return;const s=mF(e);if(s===z.A)return this.onCtrlAndA(e);if(s===z.C)return this.onCtrlAndC(e);if(s===z.D)return this.onCtrlAndD(e);if(s===z.V)return this.onCtrlAndV(e);if(s===z.X)return this.onCtrlAndX(e);if(s===z.Y)return this.onCtrlAndY();if(s===z.Z)return this.onCtrlAndZ(e)}onCtrlAndA(e){const{pinnedRowModel:t,paginationProxy:s,rangeService:i}=this;if(i&&s.isRowsToRender()){const[r,n]=[t.isEmpty("top"),t.isEmpty("bottom")],o=r?null:"top";let a,l;n?(a=null,l=this.paginationProxy.getRowCount()-1):(a="bottom",l=t.getPinnedBottomRowData().length-1);const u=this.columnModel.getAllDisplayedColumns();if(yr(u))return;i.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:l,rowEndPinned:a,columnStart:u[0],columnEnd:At(u)})}e.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:s}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||s!=null&&s.isEditing()||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:s}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||s!=null&&s.isEditing()||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:s}=this.getControlsForEventTarget(e.target);t!=null&&t.isEditing()||s!=null&&s.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){this.gos.get("undoRedoCellEditing")&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService.redo("ui")}};f([A("mouseEventService")],zi.prototype,"mouseEventService",2);f([A("valueService")],zi.prototype,"valueService",2);f([A("menuService")],zi.prototype,"menuService",2);f([A("ctrlsService")],zi.prototype,"ctrlsService",2);f([A("navigationService")],zi.prototype,"navigationService",2);f([A("focusService")],zi.prototype,"focusService",2);f([A("undoRedoService")],zi.prototype,"undoRedoService",2);f([A("columnModel")],zi.prototype,"columnModel",2);f([A("paginationProxy")],zi.prototype,"paginationProxy",2);f([A("pinnedRowModel")],zi.prototype,"pinnedRowModel",2);f([Lt("rangeService")],zi.prototype,"rangeService",2);f([Lt("clipboardService")],zi.prototype,"clipboardService",2);f([Ee],zi.prototype,"postConstruct",1);var fu=class extends xe{constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedListener(this.eventService,w.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this)),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const e=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.getBodyViewportElement(),t=Il(e);if(t<=50)return;let s=this.getPinnedColumnsOverflowingViewport(t-50);const i=this.gos.getCallback("processUnpinnedColumns");s.length&&(i&&(s=i({columns:s,viewportWidth:t})),this.columnModel.setColumnsPinned(s,null,"viewportSizeFeature"))}getPinnedColumnsOverflowingViewport(e){const t=this.pinnedWidthService.getPinnedRightWidth(),s=this.pinnedWidthService.getPinnedLeftWidth(),i=t+s;if(i<e)return[];const r=[...this.columnModel.getDisplayedLeftColumns()],n=[...this.columnModel.getDisplayedRightColumns()];let o=0,a=0,l=0;const u=[];let h=i-l-e;for(;(a<r.length||o<n.length)&&h>0;){if(o<n.length){const p=n[o++];h-=p.getActualWidth(),u.push(p)}if(a<r.length&&h>0){const p=r[a++];h-=p.getActualWidth(),u.push(p)}}return u}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.getBodyViewportElement(),t=lp(e);if(this.bodyHeight!==t){this.bodyHeight=t;const s={type:w.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(s)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(e,t)}};f([A("ctrlsService")],fu.prototype,"ctrlsService",2);f([A("pinnedWidthService")],fu.prototype,"pinnedWidthService",2);f([A("columnModel")],fu.prototype,"columnModel",2);f([A("scrollVisibleService")],fu.prototype,"scrollVisibleService",2);f([Ee],fu.prototype,"postConstruct",1);var M0=class extends xe{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;Et(this.element,t),Rr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}};f([A("pinnedWidthService")],M0.prototype,"pinnedWidthService",2);f([Ee],M0.prototype,"postConstruct",1);var L0=class extends xe{constructor(e){super(),this.element=e}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;Et(this.element,t),Rr(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}};f([A("pinnedWidthService")],L0.prototype,"pinnedWidthService",2);f([Ee],L0.prototype,"postConstruct",1);var ev=class extends xe{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=e!=null?`${e}px`:"";this.eContainer.style.height=t,this.eViewport&&(this.eViewport.style.height=t)}};f([A("rowContainerHeightService")],ev.prototype,"maxDivHeightScaler",2);f([Ee],ev.prototype,"postConstruct",1);var tv=class extends xe{constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListener("enableRangeSelection",t=>{if(t.currentValue){this.enableFeature();return}this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature()),this.gos.get("enableRangeSelection")&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}};f([A("dragService")],tv.prototype,"dragService",2);f([Lt("rangeService")],tv.prototype,"rangeService",2);f([Ee],tv.prototype,"postConstruct",1);var mu=class extends xe{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,e),this.addSpacer&&(this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_SCROLLBAR_WIDTH_CHANGED,e)),this.setWidth()}setWidth(){const{columnModel:e}=this,t=this.gos.isDomLayout("print"),s=e.getBodyContainerWidth(),i=e.getDisplayedColumnsLeftWidth(),r=e.getDisplayedColumnsRightWidth();let n;t?n=s+i+r:(n=s,this.addSpacer&&(this.gos.get("enableRtl")?i:r)===0&&this.scrollVisibleService.isVerticalScrollShowing()&&(n+=this.gos.getScrollbarWidth())),this.callback(n)}};f([A("columnModel")],mu.prototype,"columnModel",2);f([A("scrollVisibleService")],mu.prototype,"scrollVisibleService",2);f([Ee],mu.prototype,"postConstruct",1);var Kt=(e=>(e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.FULL_WIDTH="fullWidth",e.TOP_LEFT="topLeft",e.TOP_RIGHT="topRight",e.TOP_CENTER="topCenter",e.TOP_FULL_WIDTH="topFullWidth",e.STICKY_TOP_LEFT="stickyTopLeft",e.STICKY_TOP_RIGHT="stickyTopRight",e.STICKY_TOP_CENTER="stickyTopCenter",e.STICKY_TOP_FULL_WIDTH="stickyTopFullWidth",e.STICKY_BOTTOM_LEFT="stickyBottomLeft",e.STICKY_BOTTOM_RIGHT="stickyBottomRight",e.STICKY_BOTTOM_CENTER="stickyBottomCenter",e.STICKY_BOTTOM_FULL_WIDTH="stickyBottomFullWidth",e.BOTTOM_LEFT="bottomLeft",e.BOTTOM_RIGHT="bottomRight",e.BOTTOM_CENTER="bottomCenter",e.BOTTOM_FULL_WIDTH="bottomFullWidth",e))(Kt||{});function fI(e){switch(e){case"center":case"topCenter":case"stickyTopCenter":case"bottomCenter":case"stickyBottomCenter":return"center";case"left":case"topLeft":case"stickyTopLeft":case"bottomLeft":case"stickyBottomLeft":return"left";case"right":case"topRight":case"stickyTopRight":case"bottomRight":case"stickyBottomRight":return"right";case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return"fullWidth";default:throw Error("Invalid Row Container Type")}}var xG=Po([["center","ag-center-cols-container"],["left","ag-pinned-left-cols-container"],["right","ag-pinned-right-cols-container"],["fullWidth","ag-full-width-container"],["topCenter","ag-floating-top-container"],["topLeft","ag-pinned-left-floating-top"],["topRight","ag-pinned-right-floating-top"],["topFullWidth","ag-floating-top-full-width-container"],["stickyTopCenter","ag-sticky-top-container"],["stickyTopLeft","ag-pinned-left-sticky-top"],["stickyTopRight","ag-pinned-right-sticky-top"],["stickyTopFullWidth","ag-sticky-top-full-width-container"],["stickyBottomCenter","ag-sticky-bottom-container"],["stickyBottomLeft","ag-pinned-left-sticky-bottom"],["stickyBottomRight","ag-pinned-right-sticky-bottom"],["stickyBottomFullWidth","ag-sticky-bottom-full-width-container"],["bottomCenter","ag-floating-bottom-container"],["bottomLeft","ag-pinned-left-floating-bottom"],["bottomRight","ag-pinned-right-floating-bottom"],["bottomFullWidth","ag-floating-bottom-full-width-container"]]),EG=Po([["center","ag-center-cols-viewport"],["topCenter","ag-floating-top-viewport"],["stickyTopCenter","ag-sticky-top-viewport"],["bottomCenter","ag-floating-bottom-viewport"],["stickyBottomCenter","ag-sticky-bottom-viewport"]]),Gl=class mI extends xe{constructor(t){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=t,this.isFullWithContainer=this.name==="topFullWidth"||this.name==="stickyTopFullWidth"||this.name==="stickyBottomFullWidth"||this.name==="bottomFullWidth"||this.name==="fullWidth"}static getRowContainerCssClasses(t){const s=xG.get(t),i=EG.get(t);return{container:s,viewport:i}}static getPinned(t){switch(t){case"bottomLeft":case"topLeft":case"stickyTopLeft":case"stickyBottomLeft":case"left":return"left";case"bottomRight":case"topRight":case"stickyTopRight":case"stickyBottomRight":case"right":return"right";default:return null}}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>this.viewportSizeFeature=this.createManagedBean(new fu(this)))}registerWithCtrlsService(){switch(this.name){case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return;default:this.ctrlsService.register(this.name,this)}}forContainers(t,s){t.indexOf(this.name)>=0&&s()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(t,s,i){this.comp=t,this.eContainer=s,this.eViewport=i,this.createManagedBean(new zi(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();const r=["topCenter","topLeft","topRight"],n=["stickyTopCenter","stickyTopLeft","stickyTopRight"],o=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],a=["bottomCenter","bottomLeft","bottomRight"],l=["center","left","right"],u=[...r,...a,...l,...n,...o],h=["center","left","right","fullWidth"],p=["center","topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],g=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],m=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"];this.forContainers(g,()=>{this.pinnedWidthFeature=this.createManagedBean(new M0(this.eContainer)),this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(m,()=>{this.pinnedWidthFeature=this.createManagedBean(new L0(this.eContainer)),this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(h,()=>this.createManagedBean(new ev(this.eContainer,this.name==="center"?i:void 0))),this.forContainers(u,()=>this.createManagedBean(new tv(this.eContainer))),this.forContainers(p,()=>this.createManagedBean(new mu(C=>this.comp.setContainerWidth(`${C}px`)))),this.addListeners(),this.registerWithCtrlsService()}addListeners(){this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>this.onDisplayedColumnsChanged()),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>this.onDisplayedColumnsWidthChanged()),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_ROWS_CHANGED,t=>this.onDisplayedRowsChanged(t.afterScroll)),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(["stickyTopCenter","stickyTopLeft","stickyTopRight","stickyTopFullWidth","stickyBottomCenter","stickyBottomLeft","stickyBottomRight","stickyBottomFullWidth"].indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const i=()=>{const r=this.gos.get("ensureDomOrder"),n=this.gos.isDomLayout("print");this.comp.setDomOrder(r||n)};this.addManagedPropertyListener("domLayout",i),i()}stopHScrollOnPinnedRows(){this.forContainers(["topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],()=>{const t=()=>this.eViewport.scrollLeft=0;this.addManagedListener(this.eViewport,"scroll",t)})}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const t=s=>{this.dragService.isDragging()&&s.cancelable&&s.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(t=!1){const s=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(s,i,t)}getCenterWidth(){return Il(this.eViewport)}getCenterViewportScrollLeft(){return uh(this.eViewport,this.enableRtl)}registerViewportResizeListener(t){const s=this.resizeObserverService.observeResize(this.eViewport,t);this.addDestroyFunc(()=>s())}isViewportInTheDOMTree(){return f0(this.eViewport)}getViewportScrollLeft(){return uh(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||oF(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(t){this.eContainer.style.transform=`translateX(${t}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(t){dh(this.eViewport,t,this.enableRtl)}isContainerVisible(){return!mI.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const t=this.isContainerVisible();this.visible!=t&&(this.visible=t,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(t=!1){const s=this.getRowCtrls();if(!this.visible||s.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const i=this.gos.isDomLayout("print"),n=this.gos.get("embedFullWidthRows")||i,o=s.filter(a=>{const l=a.isFullWidth();return this.isFullWithContainer?!n&&l:n||!l});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:t})}getRowCtrls(){switch(this.name){case"topCenter":case"topLeft":case"topRight":case"topFullWidth":return this.rowRenderer.getTopRowCtrls();case"stickyTopCenter":case"stickyTopLeft":case"stickyTopRight":case"stickyTopFullWidth":return this.rowRenderer.getStickyTopRowCtrls();case"stickyBottomCenter":case"stickyBottomLeft":case"stickyBottomRight":case"stickyBottomFullWidth":return this.rowRenderer.getStickyBottomRowCtrls();case"bottomCenter":case"bottomLeft":case"bottomRight":case"bottomFullWidth":return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getCentreRowCtrls()}}};f([A("dragService")],Gl.prototype,"dragService",2);f([A("ctrlsService")],Gl.prototype,"ctrlsService",2);f([A("columnModel")],Gl.prototype,"columnModel",2);f([A("resizeObserverService")],Gl.prototype,"resizeObserverService",2);f([A("rowRenderer")],Gl.prototype,"rowRenderer",2);f([Ee],Gl.prototype,"postConstruct",1);var Pf=Gl,bG=`<div class="ag-root ag-unselectable" role="treegrid">
        <ag-header-root ref="gridHeader"></ag-header-root>
        <div class="ag-floating-top" ref="eTop" role="presentation">
            <ag-row-container ref="topLeftContainer" name="topLeft"></ag-row-container>
            <ag-row-container ref="topCenterContainer" name="topCenter"></ag-row-container>
            <ag-row-container ref="topRightContainer" name="topRight"></ag-row-container>
            <ag-row-container ref="topFullWidthContainer" name="topFullWidth"></ag-row-container>
        </div>
        <div class="ag-body" ref="eBody" role="presentation">
            <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">
                <ag-row-container ref="leftContainer" name="left"></ag-row-container>
                <ag-row-container ref="centerContainer" name="center"></ag-row-container>
                <ag-row-container ref="rightContainer" name="right"></ag-row-container>
                <ag-row-container ref="fullWidthContainer" name="fullWidth"></ag-row-container>
            </div>
            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>
        </div>
        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">
            <ag-row-container ref="stickyTopLeftContainer" name="stickyTopLeft"></ag-row-container>
            <ag-row-container ref="stickyTopCenterContainer" name="stickyTopCenter"></ag-row-container>
            <ag-row-container ref="stickyTopRightContainer" name="stickyTopRight"></ag-row-container>
            <ag-row-container ref="stickyTopFullWidthContainer" name="stickyTopFullWidth"></ag-row-container>
        </div>
        <div class="ag-sticky-bottom" ref="eStickyBottom" role="presentation">
            <ag-row-container ref="stickyBottomLeftContainer" name="stickyBottomLeft"></ag-row-container>
            <ag-row-container ref="stickyBottomCenterContainer" name="stickyBottomCenter"></ag-row-container>
            <ag-row-container ref="stickyBottomRightContainer" name="stickyBottomRight"></ag-row-container>
            <ag-row-container ref="stickyBottomFullWidthContainer" name="stickyBottomFullWidth"></ag-row-container>
        </div>
        <div class="ag-floating-bottom" ref="eBottom" role="presentation">
            <ag-row-container ref="bottomLeftContainer" name="bottomLeft"></ag-row-container>
            <ag-row-container ref="bottomCenterContainer" name="bottomCenter"></ag-row-container>
            <ag-row-container ref="bottomRightContainer" name="bottomRight"></ag-row-container>
            <ag-row-container ref="bottomFullWidthContainer" name="bottomFullWidth"></ag-row-container>
        </div>
        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>
        <ag-overlay-wrapper></ag-overlay-wrapper>
    </div>`,an=class extends ot{constructor(){super(bG)}init(){const t=(i,r)=>{const n=`${i}px`;r.style.minHeight=n,r.style.height=n},s={setRowAnimationCssOnBodyViewport:(i,r)=>this.setRowAnimationCssOnBodyViewport(i,r),setColumnCount:i=>WA(this.getGui(),i),setRowCount:i=>jA(this.getGui(),i),setTopHeight:i=>t(i,this.eTop),setBottomHeight:i=>t(i,this.eBottom),setTopDisplay:i=>this.eTop.style.display=i,setBottomDisplay:i=>this.eBottom.style.display=i,setStickyTopHeight:i=>this.eStickyTop.style.height=i,setStickyTopTop:i=>this.eStickyTop.style.top=i,setStickyTopWidth:i=>this.eStickyTop.style.width=i,setStickyBottomHeight:i=>this.eStickyBottom.style.height=i,setStickyBottomBottom:i=>this.eStickyBottom.style.bottom=i,setStickyBottomWidth:i=>this.eStickyBottom.style.width=i,setColumnMovingCss:(i,r)=>this.addOrRemoveCssClass(i,r),updateLayoutClasses:(i,r)=>{[this.eBodyViewport.classList,this.eBody.classList].forEach(o=>{o.toggle("ag-layout-auto-height",r.autoHeight),o.toggle("ag-layout-normal",r.normal),o.toggle("ag-layout-print",r.print)}),this.addOrRemoveCssClass("ag-layout-auto-height",r.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",r.normal),this.addOrRemoveCssClass("ag-layout-print",r.print)},setAlwaysVerticalScrollClass:(i,r)=>this.eBodyViewport.classList.toggle(dI,r),registerBodyViewportResizeListener:i=>{const r=this.resizeObserverService.observeResize(this.eBodyViewport,i);this.addDestroyFunc(()=>r())},setPinnedTopBottomOverflowY:i=>this.eTop.style.overflowY=this.eBottom.style.overflowY=i,setCellSelectableCss:(i,r)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(n=>n.classList.toggle(i,r))},setBodyViewportWidth:i=>this.eBodyViewport.style.width=i};this.ctrl=this.createManagedBean(new ri),this.ctrl.setComp(s,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(this.rangeService&&this.gos.get("enableRangeSelection")||this.gos.get("rowSelection")==="multiple")&&HA(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(t,s){const i=this.eBodyViewport.classList;i.toggle("ag-row-animation",s),i.toggle("ag-row-no-animation",!s)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}};f([A("resizeObserverService")],an.prototype,"resizeObserverService",2);f([Lt("rangeService")],an.prototype,"rangeService",2);f([Ie("eBodyViewport")],an.prototype,"eBodyViewport",2);f([Ie("eStickyTop")],an.prototype,"eStickyTop",2);f([Ie("eStickyBottom")],an.prototype,"eStickyBottom",2);f([Ie("eTop")],an.prototype,"eTop",2);f([Ie("eBottom")],an.prototype,"eBottom",2);f([Ie("gridHeader")],an.prototype,"headerRootComp",2);f([Ie("eBody")],an.prototype,"eBody",2);f([Ee],an.prototype,"init",1);var qc=class extends xe{postConstruct(){this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateImpl())}):this.updateImpl()}updateImpl(){const e=this.ctrlsService.get("center");if(!e||this.columnAnimationService.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t)}setScrollsVisible(e){if(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing){this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing;const s={type:w.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(s)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}};f([A("ctrlsService")],qc.prototype,"ctrlsService",2);f([A("columnAnimationService")],qc.prototype,"columnAnimationService",2);f([Ee],qc.prototype,"postConstruct",1);qc=f([je("scrollVisibleService")],qc);var Kn=class extends xe{constructor(){super(...arguments),this.gridInstanceId=Kn.gridInstanceSequence.next()}stampTopLevelGridCompWithGridInstance(e){e[Kn.GRID_DOM_KEY]=this.gridInstanceId}getRenderedCellForEvent(e){return Sf(this.gos,e.target,ol.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(e){return this.isElementInThisGrid(e.target)}isElementInThisGrid(e){let t=e;for(;t;){const s=t[Kn.GRID_DOM_KEY];if(Ce(s))return s===this.gridInstanceId;t=t.parentElement}return!1}getCellPositionForEvent(e){const t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}getNormalisedPosition(e){const t=this.gos.isDomLayout("normal"),s=e;let i,r;if(s.clientX!=null||s.clientY!=null?(i=s.clientX,r=s.clientY):(i=s.x,r=s.y),t){const n=this.ctrlsService.getGridBodyCtrl(),o=n.getScrollFeature().getVScrollPosition(),a=n.getScrollFeature().getHScrollPosition();i+=a.left,r+=o.top}return{x:i,y:r}}};Kn.gridInstanceSequence=new Yc;Kn.GRID_DOM_KEY="__ag_grid_instance";f([A("ctrlsService")],Kn.prototype,"ctrlsService",2);Kn=f([je("mouseEventService")],Kn);var si=class extends xe{constructor(){super(),this.onPageDown=zy(this.onPageDown,100),this.onPageUp=zy(this.onPageUp,100)}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const s=e.key,i=e.altKey,r=e.ctrlKey||e.metaKey,n=!!this.rangeService&&e.shiftKey,o=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(s){case z.PAGE_HOME:case z.PAGE_END:!r&&!i&&(this.onHomeOrEndKey(s),a=!0);break;case z.LEFT:case z.RIGHT:case z.UP:case z.DOWN:if(!o)return!1;r&&!i&&!n&&(this.onCtrlUpDownLeftRight(s,o),a=!0);break;case z.PAGE_DOWN:case z.PAGE_UP:!r&&!i&&(a=this.handlePageUpDown(s,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,s){return s&&(t=this.focusService.getFocusedCell()),t?(e===z.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo(e){var t;const{scrollIndex:s,scrollType:i,scrollColumn:r,focusIndex:n,focusColumn:o}=e;Ce(r)&&!r.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(r),Ce(s)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(s,i),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(n),this.focusService.setFocusedCell({rowIndex:n,column:o,rowPinned:null,forceBrowserFocus:!0}),(t=this.rangeService)==null||t.setRangeToCell({rowIndex:n,rowPinned:null,column:o})}onPageDown(e){const s=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.getViewportHeight(),r=this.paginationProxy.getPixelOffset(),n=s.top+i,o=this.paginationProxy.getRowIndexAtPixel(n+r);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}onPageUp(e){const s=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.paginationProxy.getPixelOffset(),r=s.top,n=this.paginationProxy.getRowIndexAtPixel(r+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,n,!0):this.navigateToNextPage(e,n,!0)}navigateToNextPage(e,t,s=!1){const i=this.getViewportHeight(),r=this.paginationProxy.getPageFirstRow(),n=this.paginationProxy.getPageLastRow(),o=this.paginationProxy.getPixelOffset(),a=this.paginationProxy.getRow(e.rowIndex),l=s?(a==null?void 0:a.rowHeight)-i-o:i-o,u=(a==null?void 0:a.rowTop)+l;let h=this.paginationProxy.getRowIndexAtPixel(u+o);if(h===e.rowIndex){const g=s?-1:1;t=h=e.rowIndex+g}let p;s?(p="bottom",h<r&&(h=r),t<r&&(t=r)):(p="top",h>n&&(h=n),t>n&&(t=n)),this.isRowTallerThanView(h)&&(t=h,p="top"),this.navigateTo({scrollIndex:t,scrollType:p,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,s=!1){this.navigateTo({scrollIndex:t,scrollType:s?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const i=this.getNextFocusIndexForAutoHeight(e,s);this.navigateTo({scrollIndex:t,scrollType:s?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){var s;const i=t?-1:1,r=this.getViewportHeight(),n=this.paginationProxy.getPageLastRow();let o=0,a=e.rowIndex;for(;a>=0&&a<=n;){const l=this.paginationProxy.getRow(a);if(l){const u=(s=l.rowHeight)!=null?s:0;if(o+u>r)break;o+=u}a+=i}return Math.max(0,Math.min(a,n))}getViewportHeight(){const{gridBodyCtrl:e,center:t}=this.ctrlsService.getParams(),s=e.getScrollFeature().getVScrollPosition(),i=this.gos.getScrollbarWidth();let r=s.bottom-s.top;return t.isHorizontalScrollShowing()&&(r-=i),r}isRowTallerThanView(e){const t=this.paginationProxy.getRow(e);if(!t)return!1;const s=t.rowHeight;return typeof s!="number"?!1:s>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const s=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:i,column:r}=s;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:r,focusIndex:i,focusColumn:r})}onHomeOrEndKey(e){const t=e===z.PAGE_HOME,s=this.columnModel.getAllDisplayedColumns(),i=t?s[0]:At(s),r=t?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:i,focusIndex:r,focusColumn:i})}onTabKeyDown(e,t){const s=t.shiftKey,i=this.tabToNextCellCommon(e,s,t);if(i!==!1){i&&t.preventDefault();return}if(s){const{rowIndex:r,rowPinned:n}=e.getRowPosition();(n?r===0:r===this.paginationProxy.getPageFirstRow())&&(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusPreviousFromFirstCell(t)))}else e instanceof ol&&e.focusCell(!0),this.focusService.focusNextGridCoreContainer(s)&&t.preventDefault()}tabToNextCell(e,t){const s=this.focusService.getFocusedCell();if(!s)return!1;let i=this.getCellByPosition(s);return!i&&(i=this.rowRenderer.getRowByPosition(s),!i||!i.isFullWidth())?!1:!!this.tabToNextCellCommon(i,e,t)}tabToNextCellCommon(e,t,s){let i=e.isEditing();if(!i&&e instanceof ol){const o=e.getRowCtrl();o&&(i=o.isEditing())}let r;return i?this.gos.get("editType")==="fullRow"?r=this.moveToNextEditingRow(e,t,s):r=this.moveToNextEditingCell(e,t,s):r=this.moveToNextCellNotEditing(e,t),r===null?r:r||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t,s=null){const i=e.getCellPosition();e.getGui().focus(),e.stopEditing();const r=this.findNextCellToFocusOn(i,t,!0);return r===!1?null:r==null?!1:(r.startEditing(null,!0,s),r.focusCell(!1),!0)}moveToNextEditingRow(e,t,s=null){const i=e.getCellPosition(),r=this.findNextCellToFocusOn(i,t,!0);if(r===!1)return null;if(r==null)return!1;const n=r.getCellPosition(),o=this.isCellEditable(i),a=this.isCellEditable(n),l=n&&i.rowIndex===n.rowIndex&&i.rowPinned===n.rowPinned;return o&&e.setFocusOutOnEditor(),l||(e.getRowCtrl().stopEditing(),r.getRowCtrl().startRowEditing(void 0,void 0,s)),a?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const s=this.columnModel.getAllDisplayedColumns();let i;e instanceof al?i=Jt(Je({},e.getRowPosition()),{column:t?s[0]:At(s)}):i=e.getCellPosition();const r=this.findNextCellToFocusOn(i,t,!1);if(r===!1)return null;if(r instanceof ol)r.focusCell(!0);else if(r)return this.tryToFocusFullWidthRow(r.getRowPosition(),t);return Ce(r)}findNextCellToFocusOn(e,t,s){var i;let r=e;for(;;){e!==r&&(e=r),t||(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextTabbedCell(r,t);const n=this.gos.getCallback("tabToNextCell");if(Ce(n)){const u=n({backwards:t,editing:s,previousCellPosition:e,nextCellPosition:r||null});if(u===!0||u===null)u===null&&tt("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),r=e;else{if(u===!1)return!1;u.floating&&(tt("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),u.rowPinned=u.floating),r={rowIndex:u.rowIndex,column:u.column,rowPinned:u.rowPinned}}}if(!r)return null;if(r.rowIndex<0){const l=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:l+r.rowIndex,column:r.column},fromCell:!0}),null}const o=this.gos.get("editType")==="fullRow";if(s&&!o&&!this.isCellEditable(r))continue;this.ensureCellVisible(r);const a=this.getCellByPosition(r);if(!a){const l=this.rowRenderer.getRowByPosition(r);if(!l||!l.isFullWidth()||s)continue;return l}if(!a.isSuppressNavigable())return(i=this.rangeService)==null||i.setRangeToCell(r),a}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return e.rowPinned==="top"?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):e.rowPinned==="bottom"?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.paginationProxy.getRow(e.rowIndex)}navigateToNextCell(e,t,s,i){let r=s,n=!1;for(;r&&(r===s||!this.isValidNavigateCell(r));)this.gos.get("enableRtl")?t===z.LEFT&&(r=this.getLastCellOfColSpan(r)):t===z.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextCellToFocus(t,r),n=nt(r);if(n&&e&&e.key===z.UP&&(r={rowIndex:-1,rowPinned:null,column:s.column}),i){const a=this.gos.getCallback("navigateToNextCell");if(Ce(a)){const u=a({key:t,previousCellPosition:s,nextCellPosition:r||null,event:e});Ce(u)?(u.floating&&(tt("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),u.rowPinned=u.floating),r={rowPinned:u.rowPinned,rowIndex:u.rowIndex,column:u.column}):r=null}}if(!r)return;if(r.rowIndex<0){const a=this.headerNavigationService.getHeaderRowCount();this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a+r.rowIndex,column:s.column},event:e||void 0,fromCell:!0});return}const o=this.getNormalisedPosition(r);o?this.focusPosition(o):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t=!1){const s=this.columnModel.getAllDisplayedColumns(),i=this.rowRenderer.getRowByPosition(e);if(!i||!i.isFullWidth())return!1;const r=this.focusService.getFocusedCell(),n={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?At(s):s[0])};this.focusPosition(n);const o=r!=null?this.rowPositionUtils.before(n,r):!1,a={type:w.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:n.column,isFullWidthCell:!0,floating:n.rowPinned,fromBelow:o};return this.eventService.dispatchEvent(a),!0}focusPosition(e){var t;this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),(t=this.rangeService)==null||t.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const s=t.getColSpanningList();return s.length===1?e:{rowIndex:e.rowIndex,column:At(s),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=this.gos.isGroupRowsSticky(),s=this.rowModel.getRow(e.rowIndex);!(t&&(s==null?void 0:s.sticky))&&nt(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}};f([A("mouseEventService")],si.prototype,"mouseEventService",2);f([A("paginationProxy")],si.prototype,"paginationProxy",2);f([A("focusService")],si.prototype,"focusService",2);f([A("columnModel")],si.prototype,"columnModel",2);f([A("rowModel")],si.prototype,"rowModel",2);f([A("ctrlsService")],si.prototype,"ctrlsService",2);f([A("rowRenderer")],si.prototype,"rowRenderer",2);f([A("headerNavigationService")],si.prototype,"headerNavigationService",2);f([A("rowPositionUtils")],si.prototype,"rowPositionUtils",2);f([A("cellNavigationService")],si.prototype,"cellNavigationService",2);f([A("pinnedRowModel")],si.prototype,"pinnedRowModel",2);f([Lt("rangeService")],si.prototype,"rangeService",2);f([Ee],si.prototype,"postConstruct",1);si=f([je("navigationService")],si);var O0=class vI extends kl{constructor(t){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=t}postConstruct(){this.gos.setDomData(this.getGui(),vI.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}addKeyDownListener(){const t=this.getGui(),s=this.params,i=r=>{Rf(this.gos,r,s.node,s.column,!0)||s.onKeyDown(r)};this.addManagedListener(t,"keydown",i)}};O0.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper";f([Ee],O0.prototype,"postConstruct",1);var CI=O0,RG=class extends ot{constructor(t,s,i,r,n){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=t,this.column=s.getColumn(),this.rowNode=s.getRowNode(),this.rowCtrl=s.getRowCtrl(),this.eRow=r,this.cellCtrl=s;const o=document.createElement("div");o.setAttribute("comp-id",`${this.getCompId()}`),this.setTemplateFromElement(o);const a=this.getGui();this.forceWrapper=s.isForceWrapper(),this.refreshWrapper(!1);const l=(p,g)=>{g!=null&&g!=""?a.setAttribute(p,g):a.removeAttribute(p)};cs(a,s.getCellAriaRole()),l("col-id",s.getColumnIdSanitised());const u=s.getTabIndex();u!==void 0&&l("tabindex",u.toString());const h={addOrRemoveCssClass:(p,g)=>this.addOrRemoveCssClass(p,g),setUserStyles:p=>C0(a,p),getFocusableElement:()=>this.getFocusableElement(),setIncludeSelection:p=>this.includeSelection=p,setIncludeRowDrag:p=>this.includeRowDrag=p,setIncludeDndSource:p=>this.includeDndSource=p,setRenderDetails:(p,g,m)=>this.setRenderDetails(p,g,m),setEditDetails:(p,g,m)=>this.setEditDetails(p,g,m),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};s.setComp(h,this.getGui(),this.eCellWrapper,i,n)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(t,s,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;const n=this.refreshWrapper(!1);this.refreshEditStyles(!1),t?!(i||n)&&this.refreshCellRenderer(t)||(this.destroyRenderer(),this.createCellRendererInstance(t)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(s))}setEditDetails(t,s,i){t?this.createCellEditorInstance(t,s,i):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(t){const s=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=s||this.forceWrapper,r=i&&this.eCellWrapper==null;if(r){const h=document.createElement("div");h.setAttribute("role","presentation"),h.setAttribute("class","ag-cell-wrapper"),this.eCellWrapper=h,this.getGui().appendChild(this.eCellWrapper)}const n=!i&&this.eCellWrapper!=null;n&&(qr(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!i);const o=!t&&i,a=o&&this.eCellValue==null;if(a){const h=document.createElement("span");h.setAttribute("role","presentation"),h.setAttribute("class","ag-cell-value"),this.eCellValue=h,this.eCellWrapper.appendChild(this.eCellValue)}const l=!o&&this.eCellValue!=null;l&&(qr(this.eCellValue),this.eCellValue=void 0);const u=r||n||a||l;return u&&this.removeControls(),t||s&&this.addControls(),u}addControls(){this.includeRowDrag&&this.rowDraggingComp==null&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&this.dndSourceComp==null&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(t,s,i){const r=this.editorVersion,n=t.newAgStackInstance();if(!n)return;const{params:o}=t;n.then(l=>this.afterCellEditorCreated(r,l,o,s,i)),nt(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(t){const s=this.getParentOfValue();fs(s);const i=t!=null?ys(t,!0):null;i!=null&&(s.textContent=i)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context:t}=this.beans;this.cellRenderer=t.destroyBean(this.cellRenderer),qr(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context:t}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=t.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=t.destroyBean(this.cellEditorPopupWrapper),qr(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(t){if(this.cellRenderer==null||this.cellRenderer.refresh==null||this.cellRendererClass!==t.componentClass)return!1;const s=this.cellRenderer.refresh(t.params);return s===!0||s===void 0}createCellRendererInstance(t){const i=!this.beans.gos.get("suppressAnimationFrame"),r=this.rendererVersion,{componentClass:n}=t,o=()=>{if(this.rendererVersion!==r||!this.isAlive())return;const l=t.newAgStackInstance(),u=this.afterCellRendererCreated.bind(this,r,n);l&&l.then(u)};i&&this.firstRender?this.beans.animationFrameService.createTask(o,this.rowNode.rowIndex,"createTasksP2"):o()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(t,s,i){if(!this.isAlive()||t!==this.rendererVersion){this.beans.context.destroyBean(i);return}if(this.cellRenderer=i,this.cellRendererClass=s,this.cellRendererGui=this.cellRenderer.getGui(),this.cellRendererGui!=null){const n=this.getParentOfValue();fs(n),n.appendChild(this.cellRendererGui)}}afterCellEditorCreated(t,s,i,r,n){if(t!==this.editorVersion){this.beans.context.destroyBean(s);return}if(s.isCancelBeforeStart&&s.isCancelBeforeStart()){this.beans.context.destroyBean(s),this.cellCtrl.stopEditing(!0);return}if(!s.getGui){console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`),this.beans.context.destroyBean(s);return}this.cellEditor=s,this.cellEditorGui=s.getGui();const l=r||s.isPopup!==void 0&&s.isPopup();l?this.addPopupCellEditor(i,n):this.addInCellEditor(),this.refreshEditStyles(!0,l),s.afterGuiAttached&&s.afterGuiAttached()}refreshEditStyles(t,s){var i;this.addOrRemoveCssClass("ag-cell-inline-editing",t&&!s),this.addOrRemoveCssClass("ag-cell-popup-editing",t&&!!s),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!t||!!s),(i=this.rowCtrl)==null||i.setInlineEditingCss(t)}addInCellEditor(){const t=this.getGui();t.contains(this.beans.gos.getActiveDomElement())&&t.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(t,s){this.beans.gos.get("editType")==="fullRow"&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const i=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new CI(t));const r=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&r.appendChild(this.cellEditorGui);const n=this.beans.popupService,o=this.beans.gos.get("stopEditingWhenCellsLoseFocus"),a=s??(i.getPopupPosition?i.getPopupPosition():"over"),l=this.beans.gos.get("enableRtl"),u={ePopup:r,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:a,alignSide:l?"right":"left",keepWithinBounds:!0},h=n.positionPopupByComponent.bind(n,u),p=this.beans.localeService.getLocaleTextFunc(),g=n.addPopup({modal:o,eChild:r,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:h,ariaLabel:p("ariaLabelCellEditor","Cell Editor")});g&&(this.hideEditorPopup=g.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const t=this.getGui();t.contains(this.beans.gos.getActiveDomElement())&&l0()&&t.focus({preventScroll:!0}),fs(this.getParentOfValue())}},TG=class extends ot{constructor(t,s,i){super(),this.cellComps={},this.beans=s,this.rowCtrl=t;const r=document.createElement("div");r.setAttribute("comp-id",`${this.getCompId()}`),r.setAttribute("style",this.getInitialStyle(i)),this.setTemplateFromElement(r);const n=this.getGui(),o=n.style;this.domOrder=this.rowCtrl.getDomOrder(),cs(n,"row");const a=this.rowCtrl.getTabIndex();a!=null&&n.setAttribute("tabindex",a.toString());const l={setDomOrder:u=>this.domOrder=u,setCellCtrls:u=>this.setCellCtrls(u),showFullWidth:u=>this.showFullWidth(u),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(u,h)=>this.addOrRemoveCssClass(u,h),setUserStyles:u=>C0(n,u),setTop:u=>o.top=u,setTransform:u=>o.transform=u,setRowIndex:u=>n.setAttribute("row-index",u),setRowId:u=>n.setAttribute("row-id",u),setRowBusinessKey:u=>n.setAttribute("row-business-key",u),refreshFullWidth:u=>this.refreshFullWidth(u)};t.setComp(l,this.getGui(),i),this.addDestroyFunc(()=>{t.unsetComp(i)})}getInitialStyle(t){const s=this.rowCtrl.getInitialTransform(t);return s?`transform: ${s}`:`top: ${this.rowCtrl.getInitialRowTop(t)}`}showFullWidth(t){const s=r=>{if(this.isAlive()){const n=r.getGui();this.getGui().appendChild(n),this.rowCtrl.setupDetailRowAutoHeight(n),this.setFullWidthRowComp(r)}else this.beans.context.destroyBean(r)},i=t.newAgStackInstance();i&&i.then(s)}setCellCtrls(t){const s=Object.assign({},this.cellComps);t.forEach(r=>{const n=r.getInstanceId();this.cellComps[n]==null?this.newCellComp(r):s[n]=null});const i=ea(s).filter(r=>r!=null);this.destroyCells(i),this.ensureDomOrder(t)}ensureDomOrder(t){if(!this.domOrder)return;const s=[];t.forEach(i=>{const r=this.cellComps[i.getInstanceId()];r&&s.push(r.getGui())}),v0(this.getGui(),s)}newCellComp(t){const s=new RG(this.beans,t,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[t.getInstanceId()]=s,this.getGui().appendChild(s.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const t=ea(this.cellComps).filter(s=>s!=null);this.destroyCells(t)}setFullWidthRowComp(t){this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(t){t.forEach(s=>{if(!s)return;const i=s.getCtrl().getInstanceId();this.cellComps[i]===s&&(s.detach(),s.destroy(),this.cellComps[i]=null)})}refreshFullWidth(t){const{fullWidthCellRenderer:s}=this;if(!s||!s.refresh)return!1;const i=t();return s.refresh(i)}};function DG(){const e=ot.elementGettingCreated.getAttribute("name"),t=Pf.getRowContainerCssClasses(e);let s;return e==="center"||e==="topCenter"||e==="stickyTopCenter"||e==="bottomCenter"||e==="stickyBottomCenter"?s=`<div class="${t.viewport}" ref="eViewport" role="presentation">
                <div class="${t.container}" ref="eContainer"></div>
            </div>`:s=`<div class="${t.container}" ref="eContainer"></div>`,s}var vu=class extends ot{constructor(){super(DG()),this.rowComps={},this.name=ot.elementGettingCreated.getAttribute("name"),this.type=fI(this.name)}postConstruct(){const t={setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>this.eContainer.style.width=i};this.createManagedBean(new Pf(this.name)).setComp(t,this.eContainer,this.eViewport)}preDestroy(){this.setRowCtrls([])}setRowCtrls(t){const s=Je({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;const i=r=>{const n=r.getInstanceId(),o=s[n];if(o)this.rowComps[n]=o,delete s[n],this.ensureDomOrder(o.getGui());else{if(!r.getRowNode().displayed)return;const a=new TG(r,this.beans,this.type);this.rowComps[n]=a,this.appendRow(a.getGui())}};t.forEach(i),ea(s).forEach(r=>{this.eContainer.removeChild(r.getGui()),r.destroy()}),cs(this.eContainer,"rowgroup")}appendRow(t){this.domOrder?nF(this.eContainer,t,this.lastPlacedElement):this.eContainer.appendChild(t),this.lastPlacedElement=t}ensureDomOrder(t){this.domOrder&&(m0(this.eContainer,t,this.lastPlacedElement),this.lastPlacedElement=t)}};f([A("beans")],vu.prototype,"beans",2);f([Ie("eViewport")],vu.prototype,"eViewport",2);f([Ie("eContainer")],vu.prototype,"eContainer",2);f([Ee],vu.prototype,"postConstruct",1);f([Si],vu.prototype,"preDestroy",1);var G0=class{constructor(e){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(s=>{s.isPrimary()&&(s.isAnyFunctionActive()||(s.isAllowValue()?this.columnsToAggregate.push(s):s.isAllowRowGroup()?this.columnsToGroup.push(s):s.isAllowPivot()&&this.columnsToPivot.push(s)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?at.ICON_PINNED:at.ICON_MOVE:null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}};f([A("columnModel")],G0.prototype,"columnModel",2);f([A("gridOptionsService")],G0.prototype,"gos",2);var ll=class{static attemptMoveColumns(e){const{isFromHeader:t,hDirection:s,xPosition:i,fromEnter:r,fakeEvent:n,pinned:o,gos:a,columnModel:l}=e,u=s===0,h=s===1;let{allMovingColumns:p}=e;if(t){let I=[];p.forEach(V=>{var H;let P=null,N=V.getParent();for(;N!=null&&N.getDisplayedLeafColumns().length===1;)P=N,N=N.getParent();P!=null?(!!((H=P.getColGroupDef())!=null&&H.marryChildren)?P.getProvidedColumnGroup().getLeafColumns():P.getLeafColumns()).forEach(M=>{I.includes(M)||I.push(M)}):I.includes(V)||I.push(V)}),p=I}const g=p.slice();l.sortColumnsLikeGridColumns(g);const m=this.calculateValidMoves({movingCols:g,draggingRight:h,xPosition:i,pinned:o,gos:a,columnModel:l}),C=this.calculateOldIndex(g,l);if(m.length===0)return;const y=m[0];let R=C!==null&&!r;if(t&&(R=C!==null),R&&!n&&(u&&y>=C||h&&y<=C))return;const x=l.getAllDisplayedColumns();let S=[],T=null;for(let I=0;I<m.length;I++){const V=m[I],H=l.getProposedColumnOrder(g,V);if(!l.doesOrderPassRules(H))continue;const P=H.filter(_=>x.includes(_));if(T===null)T=P;else if(!wn(P,T))break;const N=this.groupFragCount(H);S.push({move:V,fragCount:N})}if(S.length!==0)return S.sort((I,V)=>I.fragCount-V.fragCount),this.moveColumns(p,S[0].move,"uiColumnMoved",!1,l)}static moveColumns(e,t,s,i,r){return r.moveColumns(e,t,s,i),i?null:{columns:e,toIndex:t}}static calculateOldIndex(e,t){const s=t.getAllGridColumns(),i=CA(e.map(l=>s.indexOf(l))),r=i[0];return At(i)-r!==i.length-1?null:r}static groupFragCount(e){function t(i){let r=[],n=i.getOriginalParent();for(;n!=null;)r.push(n),n=n.getOriginalParent();return r}let s=0;for(let i=0;i<e.length-1;i++){let r=t(e[i]),n=t(e[i+1]);[r,n]=r.length>n.length?[r,n]:[n,r],r.forEach(o=>{n.indexOf(o)===-1&&s++})}return s}static getDisplayedColumns(e,t){switch(t){case"left":return e.getDisplayedLeftColumns();case"right":return e.getDisplayedRightColumns();default:return e.getDisplayedCenterColumns()}}static calculateValidMoves(e){const{movingCols:t,draggingRight:s,xPosition:i,pinned:r,gos:n,columnModel:o}=e;if(n.get("suppressMovableColumns")||t.some(S=>S.getColDef().suppressMovable))return[];const l=this.getDisplayedColumns(o,r),u=o.getAllGridColumns(),h=l.filter(S=>rr(t,S)),p=l.filter(S=>!rr(t,S)),g=u.filter(S=>!rr(t,S));let m=0,C=i;if(s){let S=0;h.forEach(T=>S+=T.getActualWidth()),C-=S}if(C>0){for(let S=0;S<p.length;S++){const T=p[S];if(C-=T.getActualWidth(),C<0)break;m++}s&&m++}let y;if(m>0){const S=p[m-1];y=g.indexOf(S)+1}else y=g.indexOf(p[0]),y===-1&&(y=0);const R=[y],x=(S,T)=>S-T;if(s){let S=y+1;const T=u.length-1;for(;S<=T;)R.push(S),S++;R.sort(x)}else{let S=y;const T=u.length-1;let I=u[S];for(;S<=T&&l.indexOf(I)<0;)S++,R.push(S),I=u[S];S=y-1;const V=0;for(;S>=V;)R.push(S),S--;R.sort(x).reverse()}return R}static normaliseX(e,t,s,i,r){const n=r.getHeaderRowContainerCtrl(t).getViewport();return s&&(e-=n.getBoundingClientRect().left),i.get("enableRtl")&&(e=n.clientWidth-e),t==null&&(e+=r.get("center").getCenterViewportScrollLeft()),e}},Cu=class{constructor(e){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.isCenterContainer=!Ce(e)}init(){this.ctrlsService.whenReady(e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){return this.pinned?at.ICON_PINNED:at.ICON_MOVE}onDragEnter(e){const t=e.dragItem.columns;if(e.dragSource.type===0)this.setColumnsVisible(t,!0,"uiColumnDragged");else{const i=e.dragItem.visibleState,r=(t||[]).filter(n=>i[n.getId()]);this.setColumnsVisible(r,!0,"uiColumnDragged")}this.setColumnsPinned(t,this.pinned,"uiColumnDragged"),this.onDragging(e,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,s){if(e){const i=e.filter(r=>!r.getColDef().lockVisible);this.columnModel.setColumnsVisible(i,t,s)}}setColumnsPinned(e,t,s){if(e){const i=e.filter(r=>!r.getColDef().lockPinned);this.columnModel.setColumnsPinned(i,t,s)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}checkCenterForScrolling(e){if(this.isCenterContainer){const t=this.ctrlsService.get("center"),s=t.getCenterViewportScrollLeft(),i=s+t.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=e<s+50,this.needToMoveLeft=e>i-50):(this.needToMoveLeft=e<s+50,this.needToMoveRight=e>i-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(e=this.lastDraggingEvent,t=!1,s=!1,i=!1){var r;if(i){if(this.lastMovedInfo){const{columns:h,toIndex:p}=this.lastMovedInfo;ll.moveColumns(h,p,"uiColumnMoved",!0,this.columnModel)}return}if(this.lastDraggingEvent=e,nt(e.hDirection))return;const n=ll.normaliseX(e.x,this.pinned,!1,this.gos,this.ctrlsService);t||this.checkCenterForScrolling(n);const o=this.normaliseDirection(e.hDirection),a=e.dragSource.type,l=((r=e.dragSource.getDragItem().columns)==null?void 0:r.filter(h=>h.getColDef().lockPinned?h.getPinned()==this.pinned:!0))||[],u=ll.attemptMoveColumns({allMovingColumns:l,isFromHeader:a===1,hDirection:o,xPosition:n,pinned:this.pinned,fromEnter:t,fakeEvent:s,gos:this.gos,columnModel:this.columnModel});u&&(this.lastMovedInfo=u)}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case 0:return 1;case 1:return 0;default:console.error(`AG Grid: Unknown direction ${e}`)}else return e}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(at.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(at.ICON_RIGHT,!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(at.ICON_MOVE))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*5,e>100&&(e=100);let t=null;const s=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=s.scrollHorizontally(-e):this.needToMoveRight&&(t=s.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const r=this.lastDraggingEvent.dragItem.columns.filter(n=>!n.getColDef().lockPinned);if(r.length>0&&(this.dragAndDropService.setGhostIcon(at.ICON_PINNED),this.failedMoveAttempts>7)){const n=this.needToMoveLeft?"left":"right";this.setColumnsPinned(r,n,"uiColumnDragged"),this.dragAndDropService.nudge()}}}};f([A("columnModel")],Cu.prototype,"columnModel",2);f([A("dragAndDropService")],Cu.prototype,"dragAndDropService",2);f([A("gridOptionsService")],Cu.prototype,"gos",2);f([A("ctrlsService")],Cu.prototype,"ctrlsService",2);f([Ee],Cu.prototype,"init",1);var yu=class extends xe{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.left.getContainerElement()],[e.bottomLeft.getContainerElement()],[e.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.right.getContainerElement()],[e.bottomRight.getContainerElement()],[e.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.center.getViewportElement()],[e.bottomCenter.getViewportElement()],[e.topCenter.getViewportElement()]];break}})}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}init(){this.moveColumnFeature=this.createManagedBean(new Cu(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new G0(this.pinned)),this.dragAndDropService.addDropTarget(this)}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}};f([A("dragAndDropService")],yu.prototype,"dragAndDropService",2);f([A("columnModel")],yu.prototype,"columnModel",2);f([A("ctrlsService")],yu.prototype,"ctrlsService",2);f([Ee],yu.prototype,"postConstruct",1);f([Ee],yu.prototype,"init",1);var wu=class yI extends k0{constructor(t){super(yI.TEMPLATE,t),this.headerCompVersion=0,this.column=t.getColumnGroupChild(),this.pinned=t.getPinned()}postConstruct(){const t=this.getGui();((n,o)=>{o!=null&&o!=""?t.setAttribute(n,o):t.removeAttribute(n)})("col-id",this.column.getColId());const i={setWidth:n=>t.style.width=n,addOrRemoveCssClass:(n,o)=>this.addOrRemoveCssClass(n,o),setAriaSort:n=>n?UA(t,n):$A(t),setUserCompDetails:n=>this.setUserCompDetails(n),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper);const r=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",r)}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(t){this.headerCompVersion++;const s=this.headerCompVersion;t.newAgStackInstance().then(i=>this.afterCompCreated(s,i))}afterCompCreated(t,s){if(t!=this.headerCompVersion||!this.isAlive()){this.destroyBean(s);return}this.destroyHeaderComp(),this.headerComp=s,this.headerCompGui=s.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}};wu.TEMPLATE=`<div class="ag-header-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>
        </div>`;f([Ie("eResize")],wu.prototype,"eResize",2);f([Ie("eHeaderCompWrapper")],wu.prototype,"eHeaderCompWrapper",2);f([Ee],wu.prototype,"postConstruct",1);f([Si],wu.prototype,"destroyHeaderComp",1);var PG=wu,sv=class wI extends k0{constructor(t){super(wI.TEMPLATE,t)}postConstruct(){const t=this.getGui(),s=(r,n)=>n!=null?t.setAttribute(r,n):t.removeAttribute(r);t.setAttribute("col-id",this.ctrl.getColId());const i={addOrRemoveCssClass:(r,n)=>this.addOrRemoveCssClass(r,n),setResizableDisplayed:r=>Et(this.eResize,r),setWidth:r=>t.style.width=r,setAriaExpanded:r=>s("aria-expanded",r),setUserCompDetails:r=>this.setUserCompDetails(r),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,t,this.eResize)}setUserCompDetails(t){t.newAgStackInstance().then(s=>this.afterHeaderCompCreated(s))}afterHeaderCompCreated(t){const s=()=>this.destroyBean(t);if(!this.isAlive()){s();return}const i=this.getGui(),r=t.getGui();i.appendChild(r),this.addDestroyFunc(s),this.headerGroupComp=t,this.ctrl.setDragSource(i)}};sv.TEMPLATE=`<div class="ag-header-group-cell" role="columnheader">
            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>
        </div>`;f([Ie("eResize")],sv.prototype,"eResize",2);f([Ee],sv.prototype,"postConstruct",1);var AG=sv,nw=(e=>(e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter",e))(nw||{}),V0=class extends ot{constructor(t){super(),this.headerComps={},this.ctrl=t,this.setTemplate(`<div class="${this.ctrl.getHeaderRowClass()}" role="row"></div>`)}init(){s0(this.getGui(),this.ctrl.getAriaRowIndex());const t={setHeight:s=>this.getGui().style.height=s,setTop:s=>this.getGui().style.top=s,setHeaderCtrls:(s,i)=>this.setHeaderCtrls(s,i),setWidth:s=>this.getGui().style.width=s};this.ctrl.setComp(t)}destroyHeaderCtrls(){this.setHeaderCtrls([],!1)}setHeaderCtrls(t,s){if(!this.isAlive())return;const i=this.headerComps;if(this.headerComps={},t.forEach(r=>{const n=r.getInstanceId();let o=i[n];delete i[n],o==null&&(o=this.createHeaderComp(r),this.getGui().appendChild(o.getGui())),this.headerComps[n]=o}),ei(i,(r,n)=>{this.getGui().removeChild(n.getGui()),this.destroyBean(n)}),s){const r=ea(this.headerComps);r.sort((o,a)=>{const l=o.getCtrl().getColumnGroupChild().getLeft(),u=a.getCtrl().getColumnGroupChild().getLeft();return l-u});const n=r.map(o=>o.getGui());v0(this.getGui(),n)}}createHeaderComp(t){let s;switch(this.ctrl.getType()){case"group":s=new AG(t);break;case"filter":s=new KO(t);break;default:s=new PG(t);break}return this.createBean(s),s.setParentComponent(this),s}};f([Ee],V0.prototype,"init",1);f([Si],V0.prototype,"destroyHeaderCtrls",1);var FG=0,ho=class SI extends xe{constructor(t,s,i){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=t,this.parentRowCtrl=i,this.beans=s,this.instanceId=t.getUniqueId()+"-"+FG++}postConstruct(){this.addManagedPropertyListeners(["suppressHeaderFocus"],()=>this.refreshTabIndex())}shouldStopEventPropagation(t){const{headerRowIndex:s,column:i}=this.focusService.getFocusedHeader();return fF(this.gos,t,s,i)}getWrapperHasFocus(){return this.gos.getActiveDomElement()===this.eGui}setGui(t){this.eGui=t,this.addDomData(),this.addManagedListener(this.beans.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onDisplayedColumnsChanged(){!this.comp||!this.column||(this.refreshFirstAndLastStyles(),this.refreshAriaColIndex())}refreshFirstAndLastStyles(){const{comp:t,column:s,beans:i}=this;Xm.refreshFirstAndLastStyles(t,s,i.columnModel)}refreshAriaColIndex(){const{beans:t,column:s}=this,i=t.columnModel.getAriaColumnIndex(s);i0(this.eGui,i)}addResizeAndMoveKeyboardListeners(){this.resizeFeature&&(this.addManagedListener(this.eGui,"keydown",this.onGuiKeyDown.bind(this)),this.addManagedListener(this.eGui,"keyup",this.onGuiKeyUp.bind(this)))}refreshTabIndex(){this.gos.get("suppressHeaderFocus")?this.eGui.removeAttribute("tabindex"):this.eGui.setAttribute("tabindex","-1")}onGuiKeyDown(t){var s;const i=this.gos.getActiveDomElement(),r=t.key===z.LEFT||t.key===z.RIGHT;if(this.isResizing&&(t.preventDefault(),t.stopImmediatePropagation()),i!==this.eGui||!t.shiftKey&&!t.altKey||((this.isResizing||r)&&(t.preventDefault(),t.stopImmediatePropagation()),!r))return;const n=t.key===z.LEFT!==this.gos.get("enableRtl"),o=$F[n?"Left":"Right"];if(t.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const a=this.getViewportAdjustedResizeDiff(t);this.resizeHeader(a,t.shiftKey),(s=this.resizeFeature)==null||s.toggleColumnResizing(!0)}else this.moveHeader(o)}getViewportAdjustedResizeDiff(t){let s=this.getResizeDiff(t);if(this.column.getPinned()){const r=this.pinnedWidthService.getPinnedLeftWidth(),n=this.pinnedWidthService.getPinnedRightWidth(),o=Il(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(r+n+s>o)if(o>r+n)s=o-r-n;else return 0}return s}getResizeDiff(t){let s=t.key===z.LEFT!==this.gos.get("enableRtl");const i=this.column.getPinned(),r=this.gos.get("enableRtl");return i&&r!==(i==="right")&&(s=!s),(s?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=setTimeout(()=>{var t;(t=this.resizeFeature)==null||t.toggleColumnResizing(!1)},150))}handleKeyDown(t){const s=this.getWrapperHasFocus();switch(t.key){case z.PAGE_DOWN:case z.PAGE_UP:case z.PAGE_HOME:case z.PAGE_END:s&&t.preventDefault()}}addDomData(){const t=SI.DOM_DATA_KEY_HEADER_CTRL;this.gos.setDomData(this.eGui,t,this),this.addDestroyFunc(()=>this.gos.setDomData(this.eGui,t,null))}getGui(){return this.eGui}focus(t){return this.eGui?(this.lastFocusEvent=t||null,this.eGui.focus(),!0):!1}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(t,s,i){const r=t??s;this.gos.get("preventDefaultOnContextMenu")&&r.preventDefault();const n=i instanceof Vt?i:void 0;this.menuService.isHeaderContextMenuEnabled(n)&&this.menuService.showHeaderContextMenu(n,t,s),this.dispatchColumnMouseEvent(w.EVENT_COLUMN_HEADER_CONTEXT_MENU,i)}dispatchColumnMouseEvent(t,s){const i={type:t,column:s};this.eventService.dispatchEvent(i)}destroy(){super.destroy(),this.removeDragSource(),this.comp=null,this.column=null,this.resizeFeature=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null,this.eGui=null}};ho.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";f([A("pinnedWidthService")],ho.prototype,"pinnedWidthService",2);f([A("focusService")],ho.prototype,"focusService",2);f([A("userComponentFactory")],ho.prototype,"userComponentFactory",2);f([A("ctrlsService")],ho.prototype,"ctrlsService",2);f([A("dragAndDropService")],ho.prototype,"dragAndDropService",2);f([A("menuService")],ho.prototype,"menuService",2);f([Ee],ho.prototype,"postConstruct",1);var iv=ho,rv=class extends xe{constructor(e,t,s,i){super(),this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=i,this.beans=s}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?At(this.colsSpanning):this.columnOrGroup}postConstruct(){this.addManagedListener(this.columnOrGroup,Vt.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}setLeftFirstTime(){const e=this.beans.gos.get("suppressColumnMoveAnimation"),t=Ce(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),s=e.getOldLeft(),i=this.modifyLeftForPrintLayout(e,s),r=this.modifyLeftForPrintLayout(e,t);this.setLeft(i),this.actualLeft=r,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!this.beans.gos.isDomLayout("print")||e.getPinned()==="left")return t;const i=this.beans.columnModel.getDisplayedColumnsLeftWidth();if(e.getPinned()==="right"){const r=this.beans.columnModel.getBodyContainerWidth();return i+r+t}return i+t}setLeft(e){if(Ce(e)&&(this.eCell.style.left=`${e}px`),this.columnOrGroup instanceof Vt)this.columnOrGroup;else{const s=this.columnOrGroup.getLeafColumns();if(!s.length)return;s.length>1&&zA(this.ariaEl,s.length),s[0]}}};f([Ee],rv.prototype,"postConstruct",1);var vp=class extends xe{constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}};f([A("columnHoverService")],vp.prototype,"columnHoverService",2);f([Ee],vp.prototype,"postConstruct",1);var IG=class extends iv{constructor(e,t,s){super(e,t,s),this.iconCreated=!1,this.column=e}setComp(e,t,s,i){this.comp=e,this.eButtonShowMainFilter=s,this.eFloatingFilterBody=i,this.setGui(t),this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,Vt.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}resizeHeader(){}moveHeader(){}setupActive(){const e=this.column.getColDef(),t=!!e.filter,s=!!e.floatingFilter;this.active=t&&s}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=rs("filter",this.gos,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(){this.createManagedBean(new ha(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();or(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(this.gos.getActiveDomElement()===this.eGui)return;const i=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(i){this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),i.focus();return}const r=this.findNextColumnWithFloatingFilter(e.shiftKey);r&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:r},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.columnModel;let s=this.column;do if(s=e?t.getDisplayedColBefore(s):t.getDisplayedColAfter(s),!s)break;while(!s.getColDef().filter||!s.getColDef().floatingFilter);return s}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case z.UP:case z.DOWN:t||e.preventDefault();case z.LEFT:case z.RIGHT:if(t)return;e.stopPropagation();case z.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case z.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const s=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&rl(e.relatedTarget,"ag-floating-filter");if(s&&i&&e.target===this.eGui){const n=this.lastFocusEvent,o=!!(n&&n.key===z.TAB);if(n&&o){const a=n.shiftKey;this.focusService.focusInto(this.eGui,a)}}const r=this.getRowIndex();this.beans.focusService.setFocusedHeader(r,this.column)}setupHover(){this.createManagedBean(new vp([this.column],this.eGui));const e=()=>{if(!this.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",t)};this.addManagedListener(this.eventService,w.EVENT_COLUMN_HOVER_CHANGED,e),e()}setupLeft(){const e=new rv(this.column,this.eGui,this.beans);this.createManagedBean(e)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(){if(!this.active)return;const{filterManager:e}=this.beans,t=s=>{if((s==null?void 0:s.source)==="filterDestroyed"&&this.context.isDestroyed())return;const i=this.comp.getFloatingFilterComp();i&&i.then(r=>{var n;if(r){const o=e.getCurrentFloatingFilterParentModel(this.column);r.onParentModelChanged(o,s?this.gos.addGridCommonParams({columns:(n=s.columns)!=null?n:[],type:w.EVENT_FILTER_CHANGED,source:s.source==="api"?"api":"columnFilter"}):null)}})};this.destroySyncListener=this.addManagedListener(this.column,Vt.EVENT_FILTER_CHANGED,t),e.isFilterActive(this.column)&&t(null)}setupWidth(){const e=()=>{const t=`${this.column.getActualWidth()}px`;this.comp.setWidth(t)};this.addManagedListener(this.column,Vt.EVENT_WIDTH_CHANGED,e),e()}setupFilterChangedListener(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,Vt.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=this.beans.filterManager.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(){var e,t;const s=this.active;this.setupActive();const i=!s&&this.active;s&&!this.active&&((e=this.destroySyncListener)==null||e.call(this),(t=this.destroyFilterChangedListener)==null||t.call(this));const r=this.active?this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,n=this.comp.getFloatingFilterComp();!n||!r?this.updateCompDetails(r,i):n.then(o=>{var a;!o||this.beans.filterManager.areFilterCompsDifferent((a=this.userCompDetails)!=null?a:null,r)?this.updateCompDetails(r,i):this.updateFloatingFilterParams(r)})}updateCompDetails(e,t){this.isAlive()&&(this.setCompDetails(e),this.setupFilterButton(),this.setupUi(),t&&(this.setupSyncWithFilter(),this.setupFilterChangedListener()))}updateFloatingFilterParams(e){var t;if(!e)return;const s=e.params;(t=this.comp.getFloatingFilterComp())==null||t.then(i=>{let r=!1;i!=null&&i.refresh&&typeof i.refresh=="function"&&i.refresh(s)!==null&&(r=!0),!r&&(i!=null&&i.onParamsUpdated)&&typeof i.onParamsUpdated=="function"&&i.onParamsUpdated(s)!==null&&tt("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")})}destroy(){super.destroy(),this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.destroySyncListener=null,this.destroyFilterChangedListener=null}},Su=class extends xe{constructor(e,t,s,i,r){super(),this.pinned=e,this.column=t,this.eResize=s,this.comp=i,this.ctrl=r}postConstruct(){const e=[];let t,s;const i=()=>{if(Et(this.eResize,t),!t)return;const o=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(e.push(o),s){const a=this.gos.get("skipHeaderOnAutoSize"),l=()=>{this.columnModel.autoSizeColumn(this.column,"uiColumnResized",a)};this.eResize.addEventListener("dblclick",l);const u=new ks(this.eResize);u.addEventListener(ks.EVENT_DOUBLE_TAP,l),e.push(()=>{this.eResize.removeEventListener("dblclick",l),u.removeEventListener(ks.EVENT_DOUBLE_TAP,l),u.destroy()})}},r=()=>{e.forEach(o=>o()),e.length=0},n=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==s)&&(t=o,s=a,r(),i())};n(),this.addDestroyFunc(r),this.ctrl.addRefreshFunction(n)}onResizing(e,t){const{column:s,lastResizeAmount:i,resizeStartWidth:r}=this,n=this.normaliseResizeAmount(t),o=r+n,a=[{key:s,newWidth:o}];if(this.column.getPinned()){const l=this.pinnedWidthService.getPinnedLeftWidth(),u=this.pinnedWidthService.getPinnedRightWidth(),h=Il(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(l+u+(n-i)>h)return}this.lastResizeAmount=n,this.columnModel.setColumnWidths(a,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const s=this.pinned!=="left",i=this.pinned==="right";return this.gos.get("enableRtl")?s&&(t*=-1):i&&(t*=-1),t}};f([A("horizontalResizeService")],Su.prototype,"horizontalResizeService",2);f([A("pinnedWidthService")],Su.prototype,"pinnedWidthService",2);f([A("ctrlsService")],Su.prototype,"ctrlsService",2);f([A("columnModel")],Su.prototype,"columnModel",2);f([Ee],Su.prototype,"postConstruct",1);var B0=class extends xe{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(this.gos.getActiveDomElement())&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new $m),this.cbSelectAll.addCssClass("ag-header-select-all"),cs(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,w.EVENT_FIELD_VALUE_CHANGED,this.onCbSelectAll.bind(this)),ap(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(e);const t=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),s=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),i=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${i} (${s})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${i} (${s})`),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(e){return this.gos.get("rowSelection")==="multiple"?!0:(console.warn(`AG Grid: ${e} is only available if using 'multiple' rowSelection.`),!1)}checkRightRowModelType(e){const t=this.rowModel.getType();return t==="clientSide"||t==="serverSide"?!0:(console.warn(`AG Grid: ${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.isFilteredOnly(),s=this.isCurrentPageOnly();let i="uiSelectAll";s?i="uiSelectAllCurrentPage":t&&(i="uiSelectAllFiltered");const r={source:i,justFiltered:t,justCurrentPage:s};e?this.selectionService.selectAllRowNodes(r):this.selectionService.deselectAllRowNodes(r)}isCheckboxSelection(){let e=this.column.getColDef().headerCheckboxSelection;if(typeof e=="function"){const t=e,s=this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()});e=t(s)}return e?this.checkRightRowModelType("headerCheckboxSelection")&&this.checkSelectionType("headerCheckboxSelection"):!1}isFilteredOnly(){return!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){return!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}};f([A("rowModel")],B0.prototype,"rowModel",2);f([A("selectionService")],B0.prototype,"selectionService",2);var NG=class extends iv{constructor(e,t,s){super(e,t,s),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,s,i){this.comp=e,this.setGui(t),this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(i),this.addColumnHoverListener(),this.setupFilterClass(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.resizeFeature=this.createManagedBean(new Su(this.getPinned(),this.column,s,e,this)),this.createManagedBean(new vp([this.column],t)),this.createManagedBean(new rv(this.column,t,this.beans)),this.createManagedBean(new ha(t,{shouldStopEventPropagation:r=>this.shouldStopEventPropagation(r),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(),this.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],this.refresh.bind(this)),this.addManagedListener(this.column,Vt.EVENT_COL_DEF_CHANGED,this.refresh.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}resizeHeader(e,t){var s,i;if(!this.column.isResizable())return;const r=this.column.getActualWidth(),n=(s=this.column.getMinWidth())!=null?s:0,o=(i=this.column.getMaxWidth())!=null?i:Number.MAX_SAFE_INTEGER,a=Math.min(Math.max(r+e,n),o);this.beans.columnModel.setColumnWidths([{key:this.column,newWidth:a}],t,!0,"uiColumnResized")}moveHeader(e){const{eGui:t,column:s,gos:i,ctrlsService:r}=this,n=this.getPinned(),o=t.getBoundingClientRect().left,a=s.getActualWidth(),l=i.get("enableRtl"),u=e===0!==l,h=ll.normaliseX(u?o-20:o+a+20,n,!0,i,r);ll.attemptMoveColumns({allMovingColumns:[s],isFromHeader:!0,hDirection:e,xPosition:h,pinned:n,fromEnter:!1,fakeEvent:!1,gos:i,columnModel:this.beans.columnModel}),r.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(s,"auto")}setupUserComp(){const e=this.lookupUserCompDetails();this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(t,e)}createParams(){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:t=>{this.menuService.showColumnMenu({column:this.column,buttonElement:t,positionBy:"button"})},showColumnMenuAfterMouseClick:t=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:t,positionBy:"mouse"})},showFilter:t=>{this.menuService.showFilterMenu({column:this.column,buttonElement:t,containerType:"columnFilter",positionBy:"button"})},progressSort:t=>{this.beans.sortController.progressSort(this.column,!!t,"uiColumnSorted")},setSort:(t,s)=>{this.beans.sortController.setSortForColumn(this.column,t,!!s,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(t,s)=>{this.setupTooltip(t,s)}})}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new B0(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===z.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===z.ENTER&&this.onEnterKeyDown(e),e.key===z.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const t=e.shiftKey;this.beans.sortController.progressSort(this.column,t,"uiColumnSorted")}}showMenuOnKeyPress(e,t){const s=this.comp.getUserCompInstance();!s||!(s instanceof tw)||s.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const t=this.getRowIndex();this.focusService.setFocusedHeader(t,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const s=this.gos.get("tooltipShowMode")==="whenTruncated",i=this.eGui,r=this.column.getColDef();!t&&s&&!r.headerComponent&&(t=()=>{const a=i.querySelector(".ag-header-cell-text");return a?a.scrollWidth>a.clientWidth:!0});const n={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>i,getLocation:()=>"header",getTooltipValue:()=>e??this.column.getColDef().headerTooltip,shouldDisplayTooltip:t},o=this.createManagedBean(new lo(n));this.refreshFunctions.push(()=>o.refreshToolTip())}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),s=Xm.getHeaderClassesFromColDef(t,this.gos,this.column,null),i=this.userHeaderClasses;this.userHeaderClasses=new Set(s),s.forEach(r=>{i.has(r)?i.delete(r):this.comp.addOrRemoveCssClass(r,!0)}),i.forEach(r=>this.comp.addOrRemoveCssClass(r,!1))};this.refreshFunctions.push(e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e||!this.draggable)return;const{column:t,beans:s,displayName:i,dragAndDropService:r,gos:n}=this,{columnModel:o}=s;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>a?at.ICON_HIDE:at.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(t),dragItemName:i,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),t.setMoving(!0,"uiColumnMoved")},onDragStopped:()=>t.setMoving(!1,"uiColumnMoved"),onGridEnter:u=>{var h;if(a){const p=((h=u==null?void 0:u.columns)==null?void 0:h.filter(g=>!g.getColDef().lockVisible))||[];o.setColumnsVisible(p,!0,"uiColumnMoved")}},onGridExit:u=>{var h;if(a){const p=((h=u==null?void 0:u.columns)==null?void 0:h.filter(g=>!g.getColDef().lockVisible))||[];o.setColumnsVisible(p,!1,"uiColumnMoved")}}};r.addDragSource(l,!0)}createDragItem(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(e){this.refreshFunctions.push(e)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(e=>e())}refreshHeaderComp(){const e=this.lookupUserCompDetails();(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.columnModel.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const e=()=>{const t=this.column.getActualWidth();this.comp.setWidth(`${t}px`)};this.addManagedListener(this.column,Vt.EVENT_WIDTH_CHANGED,e),e()}setupMovingCss(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};this.addManagedListener(this.column,Vt.EVENT_MOVING_CHANGED,e),e()}setupMenuClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};this.addManagedListener(this.column,Vt.EVENT_MENU_VISIBLE_CHANGED,e),e()}setupSortableClass(){const e=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};e(),this.addRefreshFunction(e),this.addManagedListener(this.eventService,Vt.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}setupFilterClass(){const e=()=>{const t=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",t),this.refreshAria()};this.addManagedListener(this.column,Vt.EVENT_FILTER_ACTIVE_CHANGED,e),e()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",t)};e(),this.addRefreshFunction(e)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:s,beans:i}=this;if(!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),s.addOrRemoveCssClass("ag-header-span-height",!1),s.addOrRemoveCssClass("ag-header-span-total",!1);return}const{numberOfParents:r,isSpanningTotal:n}=this.column.getColumnGroupPaddingInfo();s.addOrRemoveCssClass("ag-header-span-height",r>0);const{columnModel:o}=i,a=o.getColumnHeaderRowHeight();if(r===0){s.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${a}px`);return}s.addOrRemoveCssClass("ag-header-span-total",n);const u=o.isPivotMode()?o.getPivotGroupHeaderHeight():o.getGroupHeaderHeight(),h=r*u;e.style.setProperty("top",`${-h}px`),e.style.setProperty("height",`${a+h}px`)}setupAutoHeight(e){const{columnModel:t,resizeObserverService:s}=this.beans,i=u=>{if(!this.isAlive())return;const{paddingTop:h,paddingBottom:p,borderBottomWidth:g,borderTopWidth:m}=da(this.getGui()),C=h+p+g+m,R=e.offsetHeight+C;if(u<5){const x=this.beans.gos.getDocument(),S=!x||!x.contains(e),T=R==0;if(S||T){window.setTimeout(()=>i(u+1),0);return}}t.setColumnHeaderHeight(this.column,R)};let r=!1,n;const o=()=>{const u=this.column.isAutoHeaderHeight();u&&!r&&a(),!u&&r&&l()},a=()=>{r=!0,i(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),n=s.observeResize(e,()=>i(0))},l=()=>{r=!1,n&&n(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),n=void 0};o(),this.addDestroyFunc(()=>l()),this.addManagedListener(this.column,Vt.EVENT_WIDTH_CHANGED,()=>r&&i(0)),this.addManagedListener(this.eventService,Vt.EVENT_SORT_CHANGED,()=>{r&&window.setTimeout(()=>i(0))}),this.addRefreshFunction(o)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(kA(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(this.beans.gos.getActiveDomElement()))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,s)=>t==="filter"?-1:s.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnouncementService.announceValue(e)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(){const e=()=>{if(!this.gos.get("columnHoverHighlight"))return;const t=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",t)};this.addManagedListener(this.eventService,w.EVENT_COLUMN_HOVER_CHANGED,e),e()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(){const e=i=>this.handleMouseOverChange(i.type==="mouseenter"),t=()=>this.dispatchColumnMouseEvent(w.EVENT_COLUMN_HEADER_CLICKED,this.column),s=i=>this.handleContextMenuMouseEvent(i,void 0,this.column);this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e),this.addManagedListener(this.getGui(),"click",t),this.addManagedListener(this.getGui(),"contextmenu",s)}handleMouseOverChange(e){this.setActiveHeader(e);const s={type:e?w.EVENT_COLUMN_HEADER_MOUSE_OVER:w.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column};this.eventService.dispatchEvent(s)}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return t instanceof tw?t.getAnchorElementForMenu(e):this.getGui()}destroy(){super.destroy(),this.refreshFunctions=null,this.selectAllFeature=null,this.dragSourceElement=null,this.userCompDetails=null,this.userHeaderClasses=null,this.ariaDescriptionProperties=null}},Cp=class extends xe{constructor(e,t,s,i){super(),this.eResize=t,this.comp=e,this.pinned=s,this.columnGroup=i}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gos.get("suppressAutoSize")){const t=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const s=[];this.columnGroup.getDisplayedLeafColumns().forEach(r=>{r.getColDef().suppressAutoSize||s.push(r.getColId())}),s.length>0&&this.columnModel.autoSizeColumns({columns:s,skipHeader:t,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(e){const t=this.getInitialValues(e);this.storeLocalValues(t),this.toggleColumnResizing(!0)}onResizing(e,t,s="uiColumnResized"){const i=this.normaliseDragChange(t),r=this.resizeStartWidth+i;this.resizeColumnsFromLocalValues(r,s,e)}getInitialValues(e){const t=this.getColumnsToResize(),s=this.getInitialSizeOfColumns(t),i=this.getSizeRatiosOfColumns(t,s),r={columnsToResize:t,resizeStartWidth:s,resizeRatios:i};let n=null;if(e&&(n=this.columnModel.getDisplayedGroupAtDirection(this.columnGroup,"After")),n){const o=n.getDisplayedLeafColumns(),a=r.groupAfterColumns=o.filter(u=>u.isResizable()),l=r.groupAfterStartWidth=this.getInitialSizeOfColumns(a);r.groupAfterRatios=this.getSizeRatiosOfColumns(a,l)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}storeLocalValues(e){const{columnsToResize:t,resizeStartWidth:s,resizeRatios:i,groupAfterColumns:r,groupAfterStartWidth:n,groupAfterRatios:o}=e;this.resizeCols=t,this.resizeStartWidth=s,this.resizeRatios=i,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=n,this.resizeTakeFromRatios=o}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),s=this.getInitialValues();t>s.resizeStartWidth&&this.resizeColumns(s,t,e,!0)}resizeColumnsFromLocalValues(e,t,s=!0){var i,r,n;if(!this.resizeCols||!this.resizeRatios)return;const o={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:(i=this.resizeTakeFromCols)!=null?i:void 0,groupAfterStartWidth:(r=this.resizeTakeFromStartWidth)!=null?r:void 0,groupAfterRatios:(n=this.resizeTakeFromRatios)!=null?n:void 0};this.resizeColumns(o,e,t,s)}resizeColumns(e,t,s,i=!0){const{columnsToResize:r,resizeStartWidth:n,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:u}=e,h=[];if(h.push({columns:r,ratios:o,width:t}),a){const p=t-n;h.push({columns:a,ratios:u,width:l-p})}this.columnModel.resizeColumnSets({resizeSets:h,finished:i,source:s}),i&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}getInitialSizeOfColumns(e){return e.reduce((t,s)=>t+s.getActualWidth(),0)}getSizeRatiosOfColumns(e,t){return e.map(s=>s.getActualWidth()/t)}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.clearLocalValues()}};f([A("horizontalResizeService")],Cp.prototype,"horizontalResizeService",2);f([A("autoWidthCalculator")],Cp.prototype,"autoWidthCalculator",2);f([A("columnModel")],Cp.prototype,"columnModel",2);f([Ee],Cp.prototype,"postConstruct",1);var xI=class extends xe{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,Ps.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.addEventListener("widthChanged",e),t.addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.removeEventListener("widthChanged",e),t.removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",e===0)}};f([Ee],xI.prototype,"postConstruct",1);var _G=class extends iv{constructor(e,t,s){super(e,t,s),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const i=this.getGui();this.setDragSource(i)}},this.column=e}setComp(e,t,s){this.comp=e,this.setGui(t),this.displayName=this.beans.columnModel.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.addDestroyFunc(()=>{this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature))}),this.setupUserComp(),this.addHeaderMouseListeners();const i=this.getParentRowCtrl().getPinned(),r=this.column.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new vp(r,t)),this.createManagedBean(new rv(this.column,t,this.beans)),this.createManagedBean(new xI(e,this.column)),this.resizeFeature=this.createManagedBean(new Cp(e,s,i,this.column)),this.createManagedBean(new ha(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addManagedPropertyListener(w.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners()}resizeHeader(e,t){if(!this.resizeFeature)return;const s=this.resizeFeature.getInitialValues(t);this.resizeFeature.resizeColumns(s,s.resizeStartWidth+e,"uiColumnResized",!0)}moveHeader(e){const{beans:t,eGui:s,column:i,gos:r,ctrlsService:n}=this,o=r.get("enableRtl"),a=e===0,l=this.getPinned(),u=s.getBoundingClientRect(),h=u.left,p=u.width,g=ll.normaliseX(a!==o?h-20:h+p+20,l,!0,r,n),m=i.getGroupId(),C=this.focusService.getFocusedHeader();ll.attemptMoveColumns({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,hDirection:e,xPosition:g,pinned:l,fromEnter:!1,fakeEvent:!1,gos:r,columnModel:t.columnModel});const y=i.getDisplayedLeafColumns(),R=a?y[0]:At(y);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(R,"auto"),!this.isAlive()&&C&&this.restoreFocus(m,i,C)}restoreFocus(e,t,s){const i=t.getLeafColumns();if(!i.length)return;const r=i[0].getParent();if(!r)return;const n=this.findGroupWidthId(r,e);n&&this.focusService.focusHeaderPosition({headerPosition:Jt(Je({},s),{column:n})})}findGroupWidthId(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return null}resizeLeafColumnsToFit(e){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(){const e=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:s=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),s,"gridInitializing")},setTooltip:(s,i)=>{this.setupTooltip(s,i)}}),t=this.userComponentFactory.getHeaderGroupCompDetails(e);this.comp.setUserCompDetails(t)}addHeaderMouseListeners(){const e=i=>this.handleMouseOverChange(i.type==="mouseenter"),t=()=>this.dispatchColumnMouseEvent(w.EVENT_COLUMN_HEADER_CLICKED,this.column.getProvidedColumnGroup()),s=i=>this.handleContextMenuMouseEvent(i,void 0,this.column.getProvidedColumnGroup());this.addManagedListener(this.getGui(),"mouseenter",e),this.addManagedListener(this.getGui(),"mouseleave",e),this.addManagedListener(this.getGui(),"click",t),this.addManagedListener(this.getGui(),"contextmenu",s)}handleMouseOverChange(e){const s={type:e?w.EVENT_COLUMN_HEADER_MOUSE_OVER:w.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column.getProvidedColumnGroup()};this.eventService.dispatchEvent(s)}setupTooltip(e,t){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const s=this.column.getColGroupDef(),i=this.gos.get("tooltipShowMode")==="whenTruncated",r=this.eGui;!t&&i&&!(s!=null&&s.headerGroupComponent)&&(t=()=>{const o=r.querySelector(".ag-header-group-text");return o?o.scrollWidth>o.clientWidth:!0});const n={getColumn:()=>this.column,getGui:()=>r,getLocation:()=>"headerGroup",getTooltipValue:()=>e??(s&&s.headerTooltip),shouldDisplayTooltip:t};s&&(n.getColDef=()=>s),this.createBean(new lo(n))}setupExpandable(){const e=this.column.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(e,vs.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(e,vs.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}refreshExpanded(){const e=this.column;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const e=this.column.getColGroupDef(),t=Xm.getHeaderClassesFromColDef(e,this.gos,null,this.column);this.column.isPadding()?(t.push("ag-header-group-cell-no-group"),this.column.getLeafColumns().every(i=>i.isSpanHeaderHeight())&&t.push("ag-header-span-height")):t.push("ag-header-group-cell-with-group"),t.forEach(s=>this.comp.addOrRemoveCssClass(s,!0))}setupMovingCss(){const t=this.column.getProvidedColumnGroup().getLeafColumns(),s=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());t.forEach(i=>{this.addManagedListener(i,Vt.EVENT_MOVING_CHANGED,s)}),s()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const t=this.getRowIndex();this.beans.focusService.setFocusedHeader(t,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===z.ENTER){const s=this.column,i=!s.isExpanded();this.beans.columnModel.setColumnGroupOpened(s.getProvidedColumnGroup(),i,"uiColumnExpanded")}}setDragSource(e){if(!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),!e))return;const{beans:t,column:s,displayName:i,gos:r,dragAndDropService:n}=this,{columnModel:o}=t,a=s.getProvidedColumnGroup().getLeafColumns();let l=!r.get("suppressDragLeaveHidesColumns");const u=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>l?at.ICON_HIDE:at.ICON_NOT_ALLOWED,dragItemName:i,getDragItem:()=>this.getDragItemForGroup(s),onDragStarted:()=>{l=!r.get("suppressDragLeaveHidesColumns"),a.forEach(h=>h.setMoving(!0,"uiColumnDragged"))},onDragStopped:()=>a.forEach(h=>h.setMoving(!1,"uiColumnDragged")),onGridEnter:h=>{var p;if(l){const g=((p=h==null?void 0:h.columns)==null?void 0:p.filter(m=>!m.getColDef().lockVisible))||[];o.setColumnsVisible(g,!0,"uiColumnMoved")}},onGridExit:h=>{var p;if(l){const g=((p=h==null?void 0:h.columns)==null?void 0:p.filter(m=>!m.getColDef().lockVisible))||[];o.setColumnsVisible(g,!1,"uiColumnMoved")}}};n.addDragSource(u,!0)}getDragItemForGroup(e){const t=e.getProvidedColumnGroup().getLeafColumns(),s={};t.forEach(r=>s[r.getId()]=r.isVisible());const i=[];return this.beans.columnModel.getAllDisplayedColumns().forEach(r=>{t.indexOf(r)>=0&&(i.push(r),Fi(t,r))}),t.forEach(r=>i.push(r)),{columns:i,visibleState:s}}isSuppressMoving(){let e=!1;return this.column.getLeafColumns().forEach(s=>{(s.getColDef().suppressMovable||s.getColDef().lockPosition)&&(e=!0)}),e||this.gos.get("suppressMovableColumns")}},kG=0,Nd=class extends xe{constructor(e,t,s){super(),this.instanceId=kG++,this.rowIndex=e,this.pinned=t,this.type=s;const i=s=="group"?"ag-header-row-column-group":s=="filter"?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${i}`}postConstruct(){this.isPrintLayout=this.gos.isDomLayout("print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}getInstanceId(){return this.instanceId}setComp(e,t=!0){this.comp=e,t&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(){this.addManagedListener(this.eventService,w.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_VIRTUAL_COLUMNS_CHANGED,e=>this.onVirtualColumnsChanged(e.afterScroll)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",e=>this.isEnsureDomOrder=e.currentValue),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}getHeaderCellCtrl(e){if(this.headerCellCtrls)return il(this.headerCellCtrls).find(t=>t.getColumnGroupChild()===e)}onDisplayedColumnsChanged(){this.isPrintLayout=this.gos.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{columnModel:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){var{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{columnModel:e,filterManager:t}=this.beans;let s=e.getHeaderRowCount();const i=[];let r=0;t.hasFloatingFilters()&&(s++,r=1);const n=e.getColumnGroupHeaderRowHeight(),o=e.getColumnHeaderRowHeight(),a=1+r,l=s-a;for(let p=0;p<l;p++)i.push(n);i.push(o);for(let p=0;p<r;p++)i.push(e.getFloatingFiltersHeight());let u=0;for(let p=0;p<this.rowIndex;p++)u+=i[p];const h=i[this.rowIndex];return{topOffset:u,rowHeight:h}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(e=!1){const t=this.getHeaderCtrls(),s=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,s,e)}getHeaderCtrls(){const e=this.headerCellCtrls;this.headerCellCtrls=new Map;const t=this.getColumnsInViewport();for(const r of t)this.recycleAndCreateHeaderCtrls(r,e);const s=r=>{const{focusService:n,columnModel:o}=this.beans;return n.isHeaderWrapperFocused(r)?o.isDisplayed(r.getColumnGroupChild()):!1};if(e)for(const[r,n]of e)s(n)?this.headerCellCtrls.set(r,n):this.destroyBean(n);return Array.from(this.headerCellCtrls.values())}recycleAndCreateHeaderCtrls(e,t){if(!this.headerCellCtrls||e.isEmptyGroup())return;const s=e.getUniqueId();let i;if(t&&(i=t.get(s),t.delete(s)),i&&i.getColumnGroupChild()!=e&&(this.destroyBean(i),i=void 0),i==null)switch(this.type){case"filter":i=this.createBean(new IG(e,this.beans,this));break;case"group":i=this.createBean(new _G(e,this.beans,this));break;default:i=this.createBean(new NG(e,this.beans,this));break}this.headerCellCtrls.set(s,i)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(this.pinned!=null)return[];let e=[];const t=this.getActualDepth(),{columnModel:s}=this.beans;return["left",null,"right"].forEach(i=>{const r=s.getVirtualHeaderGroupRow(i,t);e=e.concat(r)}),e}getActualDepth(){return this.type=="filter"?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}focusHeader(e,t){if(!this.headerCellCtrls)return!1;const i=Array.from(this.headerCellCtrls.values()).find(r=>r.getColumnGroupChild()==e);return i?i.focus(t):!1}destroy(){this.headerCellCtrls&&this.headerCellCtrls.forEach(e=>{this.destroyBean(e)}),this.headerCellCtrls=void 0,super.destroy()}};f([A("beans")],Nd.prototype,"beans",2);f([Ee],Nd.prototype,"postConstruct",1);var pa=class extends xe{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}setupDragAndDrop(e){const t=new yu(this.pinned,e);this.createManagedBean(t)}refresh(e=!1){const t=new Yc,s=this.focusService.getFocusHeaderToUseAfterRefresh(),i=()=>{const a=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let l=0;l<a;l++){const u=this.createBean(new Nd(t.next(),this.pinned,"group"));this.groupsRowCtrls.push(u)}},r=()=>{const a=t.next(),l=!this.hidden&&(this.columnsRowCtrl==null||!e||this.columnsRowCtrl.getRowIndex()!==a);(l||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),l&&(this.columnsRowCtrl=this.createBean(new Nd(a,this.pinned,"column")))},n=()=>{this.includeFloatingFilter=this.filterManager.hasFloatingFilters()&&!this.hidden;const a=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){a();return}const l=t.next();if(this.filtersRowCtrl){const u=this.filtersRowCtrl.getRowIndex()!==l;(!e||u)&&a()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new Nd(l,this.pinned,"filter")))};i(),r(),n();const o=this.getAllCtrls();this.comp.setCtrls(o),this.restoreFocusOnHeader(s)}restoreFocusOnHeader(e){e==null||e.column.getPinned()!=this.pinned||this.focusService.focusHeaderPosition({headerPosition:e})}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const e=this.filterManager.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new mu(e=>this.comp.setCenterWidth(`${e}px`),!0))}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}setupPinnedWidth(){if(this.pinned==null)return;const e=this.pinned==="left",t=this.pinned==="right";this.hidden=!0;const s=()=>{const i=e?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(i==null)return;const r=i==0,n=this.hidden!==r,o=this.gos.get("enableRtl"),a=this.gos.getScrollbarWidth(),u=this.scrollVisibleService.isVerticalScrollShowing()&&(o&&e||!o&&t)?i+a:i;this.comp.setPinnedContainerWidth(`${u}px`),this.comp.setDisplayed(!r),n&&(this.hidden=r,this.refresh())};this.addManagedListener(this.eventService,w.EVENT_LEFT_PINNED_WIDTH_CHANGED,s),this.addManagedListener(this.eventService,w.EVENT_RIGHT_PINNED_WIDTH_CHANGED,s),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,s),this.addManagedListener(this.eventService,w.EVENT_SCROLLBAR_WIDTH_CHANGED,s)}getHeaderCtrlForColumn(e){if(e instanceof Vt)return this.columnsRowCtrl?this.columnsRowCtrl.getHeaderCellCtrl(e):void 0;if(this.groupsRowCtrls.length!==0)for(let t=0;t<this.groupsRowCtrls.length;t++){const s=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(s)return s}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const s=this.getAllCtrls()[e];return s?s.getType():void 0}focusHeader(e,t,s){const r=this.getAllCtrls()[e];return r?r.focusHeader(t,s):!1}getViewport(){return this.eViewport}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}};f([A("ctrlsService")],pa.prototype,"ctrlsService",2);f([A("scrollVisibleService")],pa.prototype,"scrollVisibleService",2);f([A("pinnedWidthService")],pa.prototype,"pinnedWidthService",2);f([A("columnModel")],pa.prototype,"columnModel",2);f([A("focusService")],pa.prototype,"focusService",2);f([A("filterManager")],pa.prototype,"filterManager",2);var Vl=class Ag extends ot{constructor(t){super(),this.headerRowComps={},this.rowCompsList=[],this.pinned=t}init(){this.selectAndSetTemplate();const t={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{const r=this.getGui();r.style.width=i,r.style.maxWidth=i,r.style.minWidth=i}};this.createManagedBean(new pa(this.pinned)).setComp(t,this.getGui())}selectAndSetTemplate(){const t=this.pinned=="left",s=this.pinned=="right",i=t?Ag.PINNED_LEFT_TEMPLATE:s?Ag.PINNED_RIGHT_TEMPLATE:Ag.CENTER_TEMPLATE;this.setTemplate(i),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}destroyRowComps(){this.setCtrls([])}destroyRowComp(t){this.destroyBean(t),this.eRowContainer.removeChild(t.getGui())}setCtrls(t){const s=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i;const r=n=>{const o=n.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),i&&m0(this.eRowContainer,o,i),i=o};t.forEach(n=>{const o=n.getInstanceId(),a=s[o];delete s[o];const l=a||this.createBean(new V0(n));this.headerRowComps[o]=l,this.rowCompsList.push(l),r(l)}),ea(s).forEach(n=>this.destroyRowComp(n))}};Vl.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="rowgroup"></div>';Vl.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="rowgroup"></div>';Vl.CENTER_TEMPLATE=`<div class="ag-header-viewport" role="presentation">
            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>
        </div>`;f([Ie("eCenterContainer")],Vl.prototype,"eCenterContainer",2);f([Ee],Vl.prototype,"init",1);f([Si],Vl.prototype,"destroyRowComps",1);var pC=Vl,Cl=class extends xe{constructor(){super(...arguments),this.currentHeaderRowWithoutSpan=-1}postConstruct(){this.ctrlsService.whenReady(t=>{this.gridBodyCon=t.gridBodyCtrl});const e=this.gos.getDocument();this.addManagedListener(e,"mousedown",()=>this.setCurrentHeaderRowWithoutSpan(-1))}getHeaderRowCount(){const e=this.ctrlsService.getHeaderRowContainerCtrl();return e?e.getRowCount():0}navigateVertically(e,t,s){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:i,column:r}=t,n=this.getHeaderRowCount(),o=e===0;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:u}=o?this.headerPositionUtils.getColumnVisibleParent(r,i):this.headerPositionUtils.getColumnVisibleChild(r,i),h=!1;return a<0&&(a=0,l=r,h=!0),a>=n?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):u!==void 0&&(this.currentHeaderRowWithoutSpan=u),!h&&!l?!1:this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:s})}setCurrentHeaderRowWithoutSpan(e){this.currentHeaderRowWithoutSpan=e}navigateHorizontally(e,t=!1,s){const i=this.focusService.getFocusedHeader(),r=e===2,n=this.gos.get("enableRtl");let o,a;if(this.currentHeaderRowWithoutSpan!==-1?i.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=i.headerRowIndex,r!==n?(a="Before",o=this.headerPositionUtils.findHeader(i,a)):(a="After",o=this.headerPositionUtils.findHeader(i,a)),o||!t)return this.focusService.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:s});if(t){const l=this.gos.getCallback("tabToNextHeader");if(l)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a})}return this.focusNextHeaderRow(i,a,s)}focusNextHeaderRow(e,t,s){const i=e.headerRowIndex;let r=null,n;if(t==="Before"?i>0&&(n=i-1,this.currentHeaderRowWithoutSpan-=1,r=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"end")):(n=i+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),r=this.headerPositionUtils.findColAtEdgeForHeaderRow(n,"start")),!r)return!1;const{column:o,headerRowIndex:a}=this.headerPositionUtils.getHeaderIndexToFocus(r.column,r==null?void 0:r.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:o,headerRowIndex:a},direction:t,fromTab:!0,allowUserOverride:!0,event:s})}scrollToColumn(e,t="After"){if(e.getPinned())return;let s;if(e instanceof Ps){const i=e.getDisplayedLeafColumns();s=t==="Before"?At(i):i[0]}else s=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(s)}};f([A("focusService")],Cl.prototype,"focusService",2);f([A("headerPositionUtils")],Cl.prototype,"headerPositionUtils",2);f([A("ctrlsService")],Cl.prototype,"ctrlsService",2);f([Ee],Cl.prototype,"postConstruct",1);Cl=f([je("headerNavigationService")],Cl);var ga=class extends xe{setComp(e,t,s){this.comp=e,this.eGui=t,this.createManagedBean(new ha(s,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight();const i=this.onHeaderContextMenu.bind(this);this.addManagedListener(this.eGui,"contextmenu",i),this.mockContextMenuForIPad(i),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListener("headerHeight",e),this.addManagedPropertyListener("pivotHeaderHeight",e),this.addManagedPropertyListener("groupHeaderHeight",e),this.addManagedPropertyListener("pivotGroupHeaderHeight",e),this.addManagedPropertyListener("floatingFiltersHeight",e),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,e)}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:e}=this;let t=0,s=e.getHeaderRowCount(),i;this.filterManager.hasFloatingFilters()&&(s++,t=1);const n=this.columnModel.getColumnGroupHeaderRowHeight(),o=this.columnModel.getColumnHeaderRowHeight(),a=1+t,l=s-a;if(i=t*e.getFloatingFiltersHeight(),i+=l*n,i+=o,this.headerHeight===i)return;this.headerHeight=i;const u=`${i+1}px`;this.comp.setHeightAndMinHeight(u),this.eventService.dispatchEvent({type:w.EVENT_HEADER_HEIGHT_CHANGED})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const t=this.columnModel.getAllDisplayedColumns().some(s=>s.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",t)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),s=e.shiftKey!==t?2:3;(this.headerNavigationService.navigateHorizontally(s,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case z.LEFT:t=2;case z.RIGHT:Ce(t)||(t=3),this.headerNavigationService.navigateHorizontally(t,!1,e);break;case z.UP:t=0;case z.DOWN:Ce(t)||(t=1),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget:t}=e;!t&&this.eGui.contains(this.gos.getActiveDomElement())||this.eGui.contains(t)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(e,t,s){if(!e&&!s||!this.menuService.isHeaderContextMenuEnabled())return;const{target:i}=e??t;(i===this.eGui||i===this.ctrlsService.getHeaderRowContainerCtrl().getViewport())&&this.menuService.showHeaderContextMenu(void 0,e,s)}mockContextMenuForIPad(e){if(!ao())return;const t=new ks(this.eGui),s=i=>{e(void 0,i.touchStart,i.touchEvent)};this.addManagedListener(t,ks.EVENT_LONG_TAP,s),this.addDestroyFunc(()=>t.destroy())}};f([A("headerNavigationService")],ga.prototype,"headerNavigationService",2);f([A("focusService")],ga.prototype,"focusService",2);f([A("columnModel")],ga.prototype,"columnModel",2);f([A("ctrlsService")],ga.prototype,"ctrlsService",2);f([A("filterManager")],ga.prototype,"filterManager",2);f([A("menuService")],ga.prototype,"menuService",2);var H0=class EI extends ot{constructor(){super(EI.TEMPLATE)}postConstruct(){const t={addOrRemoveCssClass:(r,n)=>this.addOrRemoveCssClass(r,n),setHeightAndMinHeight:r=>{this.getGui().style.height=r,this.getGui().style.minHeight=r}};this.createManagedBean(new ga).setComp(t,this.getGui(),this.getFocusableElement());const i=r=>{this.createManagedBean(r),this.appendChild(r)};i(new pC("left")),i(new pC(null)),i(new pC("right"))}};H0.TEMPLATE='<div class="ag-header" role="presentation"/>';f([Ee],H0.prototype,"postConstruct",1);var MG=H0,gh=class extends xe{addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};return this.dragService.addDragSource(t),()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const s=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(s)}setResizeIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e,t){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}};f([A("dragService")],gh.prototype,"dragService",2);f([A("ctrlsService")],gh.prototype,"ctrlsService",2);gh=f([je("horizontalResizeService")],gh);var sa=class extends xe{hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(e,t,s){this.showPopup(e,i=>{this.popupService.positionPopupUnderMouseEvent({column:e,type:s,mouseEvent:t,ePopup:i})},s,t.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(e,t,s){let i=-1,r="left";const n=this.menuService.isLegacyMenuEnabled();!n&&this.gos.get("enableRtl")&&(i=1,r="right");let o=n?void 0:4*i,a=n?void 0:4;this.showPopup(e,l=>{this.popupService.positionPopupByComponent({type:s,eventSource:t,ePopup:l,nudgeX:o,nudgeY:a,alignSide:r,keepWithinBounds:!0,position:"under",column:e})},s,t,n)}showPopup(e,t,s,i,r){const n=e?this.createBean(new Zm(e,"COLUMN_MENU")):void 0;if(this.activeMenu=n,!(n!=null&&n.hasFilter())||!e)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const o=document.createElement("div");cs(o,"presentation"),o.classList.add("ag-menu"),r||o.classList.add("ag-filter-menu"),this.tabListener=this.addManagedListener(o,"keydown",C=>this.trapFocusWithin(C,o)),o.appendChild(n==null?void 0:n.getGui());let a;const l=()=>n==null?void 0:n.afterGuiDetached(),u=this.menuService.isColumnMenuAnchoringEnabled()?i??this.ctrlsService.getGridBodyCtrl().getGui():void 0,h=C=>{e.setMenuVisible(!1,"contextMenu");const y=C instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),y&&i&&ji(i)){const R=this.focusService.findTabbableParent(i);R&&R.focus()}l(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,s,e)},p=this.localeService.getLocaleTextFunc(),g=r&&s!=="columnFilter"?p("ariaLabelColumnMenu","Column Menu"):p("ariaLabelColumnFilter","Column Filter"),m=this.popupService.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:h,positionCallback:()=>t(o),anchorToElement:u,ariaLabel:g});m&&(this.hidePopup=a=m.hideFunc),n.afterInit().then(()=>{t(o),n.afterGuiAttached({container:s,hidePopup:a})}),e.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,s,e)}trapFocusWithin(e,t){e.key!==z.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,s){const i={type:w.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible:e,switchingTab:!1,key:t,column:s??null};this.eventService.dispatchEvent(i)}isMenuEnabled(e){var t;return e.isFilterAllowed()&&((t=e.getColDef().menuTabs)!=null?t:["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}};f([A("filterManager")],sa.prototype,"filterManager",2);f([A("popupService")],sa.prototype,"popupService",2);f([A("focusService")],sa.prototype,"focusService",2);f([A("ctrlsService")],sa.prototype,"ctrlsService",2);f([A("menuService")],sa.prototype,"menuService",2);sa=f([je("filterMenuFactory")],sa);var Fg=(e=>(e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom",e))(Fg||{}),nv=class extends xe{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1;const{comp:t,eTopGuard:s,eBottomGuard:i,focusTrapActive:r,forceFocusOutWhenTabGuardsAreEmpty:n,focusInnerElement:o,onFocusIn:a,onFocusOut:l,shouldStopEventPropagation:u,onTabKeyDown:h,handleKeyDown:p,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=s,this.eBottomGuard=i,this.providedFocusInnerElement=o,this.eFocusableElement=g,this.focusTrapActive=!!r,this.forceFocusOutWhenTabGuardsAreEmpty=!!n,this.providedFocusIn=a,this.providedFocusOut=l,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=h,this.providedHandleKeyDown=p}postConstruct(){this.createManagedBean(new ha(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedListener(e,"focus",this.onFocus.bind(this)))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length===0){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}findNextElementOutsideAndFocus(e){const t=this.gos.getDocument(),s=this.focusService.findFocusableElements(t.body,null,!0),i=s.indexOf(e?this.eTopGuard:this.eBottomGuard);if(i===-1)return;let r,n;e?(r=0,n=i):(r=i+1,n=s.length);const o=s.slice(r,n),a=this.gos.get("tabIndex");o.sort((l,u)=>{const h=parseInt(l.getAttribute("tabindex")||"0"),p=parseInt(u.getAttribute("tabindex")||"0");return p===a?1:h===a?-1:h===0?1:p===0?-1:h-p}),o[e?o.length-1:0].focus()}onFocusIn(e){this.focusTrapActive||(this.providedFocusIn&&this.providedFocusIn(e),this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const s=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),s&&(s.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e){return e===this.eTopGuard||e===this.eBottomGuard}};f([A("focusService")],nv.prototype,"focusService",2);f([Ee],nv.prototype,"postConstruct",1);var yp=class extends ot{initialiseTabGuard(t){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();const s=[this.eTopGuard,this.eBottomGuard],i={setTabIndex:r=>{s.forEach(n=>r!=null?n.setAttribute("tabindex",r):n.removeAttribute("tabindex"))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new nv({comp:i,focusTrapActive:!!t.focusTrapActive,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:t.onFocusIn,onFocusOut:t.onFocusOut,focusInnerElement:t.focusInnerElement,handleKeyDown:t.handleKeyDown,onTabKeyDown:t.onTabKeyDown,shouldStopEventPropagation:t.shouldStopEventPropagation,forceFocusOutWhenTabGuardsAreEmpty:t.forceFocusOutWhenTabGuardsAreEmpty}))}createTabGuard(t){const s=document.createElement("div"),i=t==="top"?"ag-tab-guard-top":"ag-tab-guard-bottom";return s.classList.add("ag-tab-guard",i),cs(s,"presentation"),s}addTabGuards(t,s){this.eFocusableElement.insertAdjacentElement("afterbegin",t),this.eFocusableElement.insertAdjacentElement("beforeend",s)}removeAllChildrenExceptTabGuards(){const t=[this.eTopGuard,this.eBottomGuard];fs(this.getFocusableElement()),this.addTabGuards(...t)}forceFocusOutOfContainer(t=!1){this.tabGuardCtrl.forceFocusOutOfContainer(t)}appendChild(t,s){cp(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):super.appendChild(t,s)}},ov=class bI extends yp{constructor(t){super(bI.getTemplate(t.cssClass)),this.items=[],this.tabbedItemScrollMap=new Map,this.params=t}postConstruct(){this.setupHeader(),this.params.items&&this.params.items.forEach(t=>this.addItem(t)),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),focusInnerElement:this.focusInnerElement.bind(this),focusTrapActive:!0}),this.addDestroyFunc(()=>{var t,s,i;return(i=(s=(t=this.activeItem)==null?void 0:t.tabbedItem)==null?void 0:s.afterDetachedCallback)==null?void 0:i.call(s)})}static getTemplate(t){return`<div class="ag-tabs ${t}">
            <div ref="eHeader"></div>
            <div ref="eBody" role="presentation" class="ag-tabs-body ${t?`${t}-body`:""}"></div>
        </div>`}setupHeader(){const{enableCloseButton:t,cssClass:s}=this.params,i=(r,n)=>{r.classList.add(`ag-tabs-${n}`),s&&r.classList.add(`${s}-${n}`)};t?(this.setupCloseButton(i),this.eTabHeader=this.gos.getDocument().createElement("div"),i(this.eHeader,"header-wrapper"),cs(this.eHeader,"presentation"),this.eHeader.appendChild(this.eTabHeader)):this.eTabHeader=this.eHeader,cs(this.eTabHeader,"tablist"),i(this.eTabHeader,"header")}setupCloseButton(t){const s=this.gos.getDocument(),i=s.createElement("button");t(i,"close-button");const r=rs("close",this.gos,void 0,!0);or(i,this.params.closeButtonAriaLabel),i.appendChild(r),this.addManagedListener(i,"click",()=>{var o,a;return(a=(o=this.params).onCloseClicked)==null?void 0:a.call(o)});const n=s.createElement("div");t(n,"close-button-wrapper"),cs(n,"presentation"),n.appendChild(i),this.eHeader.appendChild(n),this.eCloseButton=i}handleKeyDown(t){switch(t.key){case z.RIGHT:case z.LEFT:if(!this.eTabHeader.contains(this.gos.getActiveDomElement()))return;const s=t.key===z.RIGHT,i=this.gos.get("enableRtl"),r=this.items.indexOf(this.activeItem),n=s!==i?Math.min(r+1,this.items.length-1):Math.max(r-1,0);if(r===n)return;t.preventDefault();const o=this.items[n];this.showItemWrapper(o),o.eHeaderButton.focus();break;case z.UP:case z.DOWN:t.stopPropagation();break}}onTabKeyDown(t){var s,i,r,n;if(t.defaultPrevented)return;const{focusService:o,eHeader:a,eBody:l,activeItem:u,params:h}=this,{suppressTrapFocus:p,enableCloseButton:g}=h,m=this.gos.getActiveDomElement(),C=t.target,y=t.shiftKey;if(a.contains(m)){t.preventDefault(),g&&y&&!((s=this.eCloseButton)!=null&&s.contains(m))?(i=this.eCloseButton)==null||i.focus():p&&y?(r=this.focusService.findFocusableElementBeforeTabGuard(this.gos.getDocument().body,C))==null||r.focus():this.focusBody(t.shiftKey);return}let R=null;if(o.isTargetUnderManagedComponent(l,C)&&(y&&(R=this.focusService.findFocusableElementBeforeTabGuard(l,C)),!R&&!p&&(R=u.eHeaderButton)),!R&&l.contains(m)&&(R=o.findNextFocusableElement(l,!1,y),!R)){t.preventDefault(),p&&!y?this.forceFocusOutOfContainer(y):g&&!y?(n=this.eCloseButton)==null||n.focus():this.focusHeader();return}R&&(t.preventDefault(),R.focus())}focusInnerElement(t){t?this.focusHeader():this.focusBody(!0)}focusHeader(t){this.activeItem.eHeaderButton.focus({preventScroll:t})}focusBody(t){this.focusService.focusInto(this.eBody,t)}setAfterAttachedParams(t){this.afterAttachedParams=t}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(t){const s=document.createElement("span");cs(s,"tab"),s.setAttribute("tabindex","-1"),s.appendChild(t.title),s.classList.add("ag-tab"),this.eTabHeader.appendChild(s),or(s,t.titleLabel);const i={tabbedItem:t,eHeaderButton:s};this.items.push(i),s.addEventListener("click",this.showItemWrapper.bind(this,i))}showItem(t){const s=this.items.find(i=>i.tabbedItem===t);s&&this.showItemWrapper(s)}showItemWrapper(t){var s,i,r,n,o,a;const{tabbedItem:l,eHeaderButton:u}=t;if((i=(s=this.params).onItemClicked)==null||i.call(s,{item:l}),this.activeItem===t){(n=(r=this.params).onActiveItemClicked)==null||n.call(r);return}this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),fs(this.eBody),l.bodyPromise.then(h=>{this.eBody.appendChild(h);const p=!this.focusService.isKeyboardMode();if(this.params.suppressFocusBodyOnOpen||this.focusService.focusInto(this.eBody,!1,p),l.afterAttachedCallback&&l.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const g=l.getScrollableContainer&&l.getScrollableContainer()||h;this.lastScrollListener=this.addManagedListener(g,"scroll",()=>{this.tabbedItemScrollMap.set(l.name,g.scrollTop)});const m=this.tabbedItemScrollMap.get(l.name);m!==void 0&&setTimeout(()=>{g.scrollTop=m},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),(a=(o=this.activeItem.tabbedItem).afterDetachedCallback)==null||a.call(o)),u.classList.add("ag-tab-selected"),this.activeItem=t}};f([A("focusService")],ov.prototype,"focusService",2);f([Ie("eHeader")],ov.prototype,"eHeader",2);f([Ie("eBody")],ov.prototype,"eBody",2);f([Ee],ov.prototype,"postConstruct",1);var LG=50,ow=class extends xe{constructor(){super(...arguments),this.polyfillFunctions=[]}observeResize(e,t){const s=this.gos.getWindow(),i=()=>{const a=new s.ResizeObserver(t);return a.observe(e),()=>a.disconnect()},r=()=>{var a,l;let u=(a=e==null?void 0:e.clientWidth)!=null?a:0,h=(l=e==null?void 0:e.clientHeight)!=null?l:0,p=!0;const g=()=>{var m,C;if(p){const y=(m=e==null?void 0:e.clientWidth)!=null?m:0,R=(C=e==null?void 0:e.clientHeight)!=null?C:0;(y!==u||R!==h)&&(u=y,h=R,t()),this.doNextPolyfillTurn(g)}};return g(),()=>p=!1},n=this.gos.get("suppressBrowserResizeObserver");return!!s.ResizeObserver&&!n?i():this.getFrameworkOverrides().wrapIncoming(()=>r(),"resize-observer")}doNextPolyfillTurn(e){this.polyfillFunctions.push(e),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;const e=()=>{const t=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],t.forEach(s=>s())};this.polyfillScheduled=!0,window.setTimeout(e,LG)}};ow=f([je("resizeObserverService")],ow);var Qc=class extends xe{constructor(){super(...arguments),this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}setScrollTop(e){const t=this.gos.get("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&e===0){const s=this.paginationProxy.getCurrentPage();s!==this.lastPage&&(this.lastPage=s,this.scrollGoingDown=!0)}this.lastScrollTop=e}init(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){this.useAnimationFrame===!1&&console.warn(`AG Grid: AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,s){this.verifyAnimationFrameOn(s);const i={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[s],i),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((s,i)=>s.index!==i.index?t*(i.index-s.index):i.createOrder-s.createOrder),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,s=t.list,i=this.createTasksP2,r=i.list,n=this.destroyTasks,o=new Date().getTime();let a=new Date().getTime()-o;const l=e<=0,u=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!u.getScrollFeature().scrollGridIfNeeded()){let p;if(s.length)this.sortTaskList(t),p=s.pop().task;else if(r.length)this.sortTaskList(i),p=r.pop().task;else if(n.length)p=n.pop();else{this.cancelledTasks.clear();break}this.cancelledTasks.has(p)||p()}a=new Date().getTime()-o}s.length||r.length||n.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=this.gos.getWindow();t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{if(!this.isOn()){window.setTimeout(e,0);return}t||(t=!0,this.addDestroyTask(()=>{t=!1,e()}))}}};f([A("ctrlsService")],Qc.prototype,"ctrlsService",2);f([A("paginationProxy")],Qc.prototype,"paginationProxy",2);f([Ee],Qc.prototype,"init",1);Qc=f([je("animationFrameService")],Qc);var fh=class extends xe{postConstruct(){this.isClientSideRowModel=this.rowModel.getType()==="clientSide"}expandRows(e){if(!this.isClientSideRowModel)return;const t=new Set(e);this.rowModel.forEachNode(s=>{s.id&&t.has(s.id)&&(s.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const e=[];return this.rowModel.forEachNode(({expanded:t,id:s})=>{t&&s&&e.push(s)}),e}expandAll(e){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(e)}setRowNodeExpanded(e,t,s,i){e&&(s&&e.parent&&e.parent.level!==-1&&this.setRowNodeExpanded(e.parent,t,s,i),e.setExpanded(t,void 0,i))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}};f([A("rowModel")],fh.prototype,"rowModel",2);f([Ee],fh.prototype,"postConstruct",1);fh=f([je("expansionService")],fh);var Ar=class extends xe{postConstruct(){var e;this.activeMenuFactory=(e=this.enterpriseMenuFactory)!=null?e:this.filterMenuFactory}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const t=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(t,e,e.containerType,!0)}showHeaderContextMenu(e,t,s){this.activeMenuFactory.showMenuAfterContextMenuEvent(e,t,s)}getContextMenuPosition(e,t){const s=this.getRowCtrl(e),i=this.getCellGui(s,t);if(!i)return s?{x:0,y:s.getRowYPosition()}:{x:0,y:0};const r=i.getBoundingClientRect();return{x:r.x+r.width/2,y:r.y+r.height/2}}showContextMenu(e){var t,s,i;const{column:r,rowNode:n}=e;let{anchorToElement:o,value:a}=e;n&&r&&a==null&&(a=n.getValueFromValueService(r)),o==null&&(o=this.getContextMenuAnchorElement(n,r)),(i=this.contextMenuFactory)==null||i.onContextMenu((t=e.mouseEvent)!=null?t:null,(s=e.touchEvent)!=null?s:null,n??null,r??null,a,o)}showColumnChooser(e){var t;(t=this.columnChooserFactory)==null||t.showColumnChooser(e)}hidePopupMenu(){var e;(e=this.contextMenuFactory)==null||e.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){var e;(e=this.columnChooserFactory)==null||e.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(e){const{suppressMenu:t,suppressHeaderMenuButton:s}=e.getColDef();return!(s??t)&&this.activeMenuFactory.isMenuEnabled(e)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&this.filterManager.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e!=null&&e.getColDef().suppressHeaderContextMenu)&&this.getColumnMenuType()==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(ao()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return this.filterManager.isFilterAllowed(e)&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return this.getColumnMenuType()==="new"}isLegacyMenuEnabled(){return this.getColumnMenuType()==="legacy"}isFloatingFilterButtonEnabled(e){var t;const s=e.getColDef(),i=(t=s.floatingFilterComponentParams)==null?void 0:t.suppressFilterButton;return i!=null&&tt("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),s.suppressFloatingFilterButton==null?!i:!s.suppressFloatingFilterButton}getColumnMenuType(){var e;return(e=this.gos.get("columnMenu"))!=null?e:"legacy"}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()||this.gos.exists("suppressMenuHide")?e:!0}showColumnMenuCommon(e,t,s,i){const{column:r,positionBy:n}=t;if(n==="button"){const{buttonElement:o}=t;e.showMenuAfterButtonClick(r,o,s,i)}else if(n==="mouse"){const{mouseEvent:o}=t;e.showMenuAfterMouseEvent(r,o,s,i)}else r&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(r,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const o=this.ctrlsService.getHeaderRowContainerCtrl(r.getPinned()).getHeaderCtrlForColumn(r);e.showMenuAfterButtonClick(r,o.getAnchorElementForMenu(i),s,!0)}))}getRowCtrl(e){const{rowIndex:t,rowPinned:s}=e||{};if(t!=null)return this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:s})||void 0}getCellGui(e,t){if(!e||!t)return;const s=e.getCellCtrl(t);return(s==null?void 0:s.getGui())||void 0}getContextMenuAnchorElement(e,t){const s=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),i=this.getRowCtrl(e);if(!i)return s;const r=this.getCellGui(i,t);return r||(i.isFullWidth()?i.getFullWidthElement():s)}};f([A("filterMenuFactory")],Ar.prototype,"filterMenuFactory",2);f([A("ctrlsService")],Ar.prototype,"ctrlsService",2);f([A("animationFrameService")],Ar.prototype,"animationFrameService",2);f([A("filterManager")],Ar.prototype,"filterManager",2);f([A("rowRenderer")],Ar.prototype,"rowRenderer",2);f([Lt("columnChooserFactory")],Ar.prototype,"columnChooserFactory",2);f([Lt("contextMenuFactory")],Ar.prototype,"contextMenuFactory",2);f([Lt("enterpriseMenuFactory")],Ar.prototype,"enterpriseMenuFactory",2);f([Ee],Ar.prototype,"postConstruct",1);Ar=f([je("menuService")],Ar);var yl=class extends xe{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const s=this.getHeaderCellForColumn(e);if(!s)return-1;const i=this.rowRenderer.getAllCellsForColumn(e);return t||i.push(s),this.addElementsToContainerAndGetWidth(i)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const s=this.centerRowContainerCtrl.getContainerElement();e.forEach(n=>this.cloneItemIntoDummy(n,t)),s.appendChild(t);const i=t.offsetWidth;s.removeChild(t);const r=this.getAutoSizePadding();return i+r}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(e){let t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(s=>{const i=s.getHtmlElementForColumnHeader(e);i!=null&&(t=i)}),t}cloneItemIntoDummy(e,t){const s=e.cloneNode(!0);s.style.width="",s.style.position="static",s.style.left="";const i=document.createElement("div"),r=i.classList;["ag-header-cell","ag-header-group-cell"].some(a=>s.classList.contains(a))?(r.add("ag-header","ag-header-row"),i.style.position="static"):r.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const u=o.classList[l];u!="ag-row-position-absolute"&&r.add(u)}break}o=o.parentElement}i.appendChild(s),t.appendChild(i)}};f([A("rowRenderer")],yl.prototype,"rowRenderer",2);f([A("ctrlsService")],yl.prototype,"ctrlsService",2);f([A("rowCssClassCalculator")],yl.prototype,"rowCssClassCalculator",2);f([Ee],yl.prototype,"postConstruct",1);yl=f([je("autoWidthCalculator")],yl);var wp=class extends xe{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.topContainerHeight=0,this.bottomContainerHeight=0}postConstruct(){this.isClientSide=this.rowModel.getType()==="clientSide",this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl})}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}getLastPixelOfGroup(e){return this.isClientSide?this.getClientSideLastPixelOfGroup(e):this.getServerSideLastPixelOfGroup(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}getServerSideLastPixelOfGroup(e){var t,s,i,r;if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(e.isExpandable()||e.footer){if(e.master)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1){let o=(t=e.childStore)==null?void 0:t.getStoreBounds();return e.footer&&(o=(s=e.sibling.childStore)==null?void 0:s.getStoreBounds()),((i=o==null?void 0:o.heightPx)!=null?i:0)+((r=o==null?void 0:o.topPx)!=null?r:0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(e){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(e.isExpandable()||e.footer){const t=e.footer&&e.rowIndex===0,s=!e.sibling||Math.abs(e.sibling.rowIndex-e.rowIndex)===1;if(t||s){let i=e.footer?e.sibling:e;for(;i.isExpandable()&&i.expanded;)if(i.master)i=i.detailNode;else if(i.childrenAfterSort){if(i.childrenAfterSort.length===0)break;i=At(i.childrenAfterSort)}return i.rowTop+i.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(e){const t=e==="top";let s=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,s);const i=t?this.rowRenderer.getFirstVisibleVerticalPixel():this.rowRenderer.getLastVisibleVerticalPixel(),r=new Set,n=u=>{if(r.add(u),t){const h=this.getLastPixelOfGroup(u),p=i+s+u.rowHeight;h<p?u.stickyRowTop=s+(h-p):u.stickyRowTop=s}else{const h=this.getFirstPixelOfGroup(u),p=i-(s+u.rowHeight);h>p?u.stickyRowTop=s-(h-p):u.stickyRowTop=s}s=0,r.forEach(h=>{const p=h.stickyRowTop+h.rowHeight;s<p&&(s=p)})},o=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=u=>u.displayed?u.footer?o===!0||o==="grand"&&u.level===-1||o==="group"&&u.level>-1?!1:!r.has(u):u.isExpandable()?a===!0?!1:!r.has(u)&&u.expanded:!1:!1;for(let u=0;u<100;u++){let h=i+s;t||(h=i-s);const p=this.rowModel.getRowIndexAtPixel(h),g=this.rowModel.getRow(p);if(g==null)break;const C=this.getStickyAncestors(g).find(R=>(t?R.rowIndex<p:R.rowIndex>p)&&l(R));if(C){n(C);continue}if((t?g.rowTop<h:g.rowTop+g.rowHeight>h)&&l(g)){n(g);continue}break}return t||r.forEach(u=>{u.stickyRowTop=s-(u.stickyRowTop+u.rowHeight)}),this.refreshNodesAndContainerHeight(e,r,s)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(e===!0)return!0;const t=!!this.gos.get("groupIncludeFooter")||e==="group",s=!!this.gos.get("groupIncludeTotalFooter")||e==="grand";return t&&s?!0:s?"grand":t?"group":!1}canRowsBeSticky(){const e=this.gos.isGroupRowsSticky(),t=this.areFooterRowsStickySuppressed(),s=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!s)}getStickyAncestors(e){const t=[];let s=e.footer?e.sibling:e.parent;for(;s;)s.sibling&&t.push(s.sibling),t.push(s),s=s.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some(s=>s.getRowNode()===e)){for(let s=0;s<this.stickyTopRowCtrls.length;s++){const i=this.stickyTopRowCtrls[s].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows();return}for(let s=0;s<this.stickyBottomRowCtrls.length;s++){const i=this.stickyBottomRowCtrls[s].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}refreshNodesAndContainerHeight(e,t,s){const i=e==="top",r=i?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,n={},o=[];for(let p=0;p<r.length;p++){const g=r[p].getRowNode();if(!t.has(g)){n[g.id]=r[p],g.sticky=!1;continue}o.push(r[p])}const a=new Set;for(let p=0;p<o.length;p++)a.add(o[p].getRowNode());const l=[];t.forEach(p=>{a.has(p)||(p.sticky=!0,l.push(this.createRowCon(p,!1,!1)))});let u=!!l.length||o.length!==r.length;i?this.topContainerHeight!==s&&(this.topContainerHeight=s,this.gridBodyCtrl.setStickyTopHeight(s),u=!0):this.bottomContainerHeight!==s&&(this.bottomContainerHeight=s,this.gridBodyCtrl.setStickyBottomHeight(s),u=!0),this.destroyRowCtrls(n,!1);const h=[...o,...l];return h.sort((p,g)=>g.getRowNode().rowIndex-p.getRowNode().rowIndex),i||h.reverse(),h.forEach(p=>p.setRowTop(p.getRowNode().stickyRowTop)),u?(i?this.stickyTopRowCtrls=h:this.stickyBottomRowCtrls=h,!0):!1}};f([A("rowModel")],wp.prototype,"rowModel",2);f([A("rowRenderer")],wp.prototype,"rowRenderer",2);f([A("ctrlsService")],wp.prototype,"ctrlsService",2);f([Ee],wp.prototype,"postConstruct",1);var ar=class extends xe{constructor(){super(...arguments),this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach(n=>n.onRangeSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(n=>n.updateRangeBordersIfRangeCount())},s=()=>{this.eventService.addEventListener(w.EVENT_RANGE_SELECTION_CHANGED,e),this.eventService.addEventListener(w.EVENT_COLUMN_MOVED,t),this.eventService.addEventListener(w.EVENT_COLUMN_PINNED,t),this.eventService.addEventListener(w.EVENT_COLUMN_VISIBLE,t)},i=()=>{this.eventService.removeEventListener(w.EVENT_RANGE_SELECTION_CHANGED,e),this.eventService.removeEventListener(w.EVENT_COLUMN_MOVED,t),this.eventService.removeEventListener(w.EVENT_COLUMN_PINNED,t),this.eventService.removeEventListener(w.EVENT_COLUMN_VISIBLE,t)};this.addDestroyFunc(()=>i()),this.addManagedPropertyListener("enableRangeSelection",n=>{n.currentValue?s():i()}),this.gos.get("enableRangeSelection")&&s()}}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){if(this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,w.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,w.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListeners(["suppressCellFocus","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.gos.isGroupRowsSticky()){const e=this.rowModel.getType();(e==="clientSide"||e==="serverSide")&&(this.stickyRowFeature=this.createManagedBean(new wp(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gos.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new OG(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const e=ea(this.rowCtrlsByRowIndex),t=ea(this.zombieRowCtrls),s=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];t.length>0||s.length>0?this.allRowCtrls=[...e,...t,...s]:this.allRowCtrls=e}onCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}registerCellEventListeners(){this.addManagedListener(this.eventService,w.EVENT_CELL_FOCUSED,e=>{this.onCellFocusChanged(e)}),this.addManagedListener(this.eventService,w.EVENT_CELL_FOCUS_CLEARED,()=>{this.onCellFocusChanged()}),this.addManagedListener(this.eventService,w.EVENT_FLASH_CELLS,e=>{this.getAllCellCtrls().forEach(t=>t.onFlashCells(e))}),this.addManagedListener(this.eventService,w.EVENT_COLUMN_HOVER_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())}),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())}),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,w.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.columnModel.getAllGridColumns().forEach(t=>{const s=l=>{this.getAllCellCtrls().forEach(u=>{u.getColumn()===t&&l(u)})},i=()=>{s(l=>l.onLeftChanged())},r=()=>{s(l=>l.onWidthChanged())},n=()=>{s(l=>l.onFirstRightPinnedChanged())},o=()=>{s(l=>l.onLastLeftPinnedChanged())},a=()=>{s(l=>l.onColDefChanged())};t.addEventListener("leftChanged",i),t.addEventListener("widthChanged",r),t.addEventListener("firstRightPinnedChanged",n),t.addEventListener("lastLeftPinnedChanged",o),t.addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.removeEventListener("leftChanged",i),t.removeEventListener("widthChanged",r),t.removeEventListener("firstRightPinnedChanged",n),t.removeEventListener("lastLeftPinnedChanged",o),t.removeEventListener("colDefChanged",a)})})}onDomLayoutChanged(){const e=this.gos.isDomLayout("print"),t=e||this.gos.get("embedFullWidthRows"),s=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,s&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(e){const t=[];return this.getAllRowCtrls().forEach(s=>{const i=s.getCellElement(e);i&&t.push(i)}),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(e,t){e.forEach(s=>{s.destroyFirstPass(),s.destroySecondPass()}),e.length=0,t&&t.forEach(s=>{const i=new al(s,this.beans,!1,!1,this.printLayout);e.push(i)})}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}redrawRow(e,t=!1){var s;if(e.sticky)this.stickyRowFeature.refreshStickyNode(e);else if((s=this.cachedRowCtrls)!=null&&s.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const i=r=>{const n=r[e.rowIndex];n&&n.getRowNode()===e&&(n.destroyFirstPass(),n.destroySecondPass(),r[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(e!=null){e==null||e.forEach(s=>this.redrawRow(s,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(e){const t=e!=null&&e.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(t==null)return null;const s=this.gos.getActiveDomElement(),i=this.gos.getDomData(s,ol.DOM_DATA_KEY_CELL_CTRL),r=this.gos.getDomData(s,al.DOM_DATA_KEY_ROW_CTRL);return i||r?t:null}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const s=!e.domLayoutChanged&&!!e.recycleRows,i=e.animate&&this.gos.isAnimateRows(),r=s?this.getRowsToRecycle():null;s||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows(),this.recycleRows(r,i),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,s=this.gos.get("suppressScrollOnNewData");t&&!s&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}updateContainerHeights(){if(this.printLayout){this.rowContainerHeightService.setModelHeight(null);return}let e=this.paginationProxy.getCurrentPageHeight();e===0&&(e=1),this.rowContainerHeightService.setModelHeight(e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}releaseLockOnRefresh(){this.refreshInProgress=!1}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&(this.focusService.setRestoreFocusedCell(e),this.onCellFocusChanged(this.beans.gos.addGridCommonParams({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"mock"})))}stopEditing(e=!1){this.getAllRowCtrls().forEach(t=>{t.stopEditing(e)})}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),s=t.length;for(let i=0;i<s;i++){const r=t[i].getAllCellCtrls(),n=r.length;for(let o=0;o<n;o++)e.push(r[o])}return e}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],t=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],s=[...this.topRowCtrls,...this.bottomRowCtrls,...e,...t];for(const i in this.rowCtrlsByRowIndex)s.push(this.rowCtrlsByRowIndex[i]);return s}addRenderedRowListener(e,t,s){const i=this.rowCtrlsByRowIndex[t];i&&i.addEventListener(e,s)}flashCells(e={}){this.getCellCtrls(e.rowNodes,e.columns).forEach(t=>t.flashCell(e))}refreshCells(e={}){const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};this.getCellCtrls(e.rowNodes,e.columns).forEach(s=>s.refreshOrDestroyCell(t)),e.rowNodes&&(this.getRowCtrls(e.rowNodes).forEach(s=>{if(!s.isFullWidth())return;s.refreshFullWidth()||this.redrawRow(s.getRowNode(),!0)}),this.dispatchDisplayedRowsChanged(!1))}getCellRendererInstances(e){var t;const s=this.getCellCtrls(e.rowNodes,e.columns).map(n=>n.getCellRenderer()).filter(n=>n!=null);if((t=e.columns)!=null&&t.length)return s;const i=[],r=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(n=>{if(r&&!this.isRowInMap(n.getRowNode(),r)||!n.isFullWidth())return;const o=n.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const l=o[a];l!=null&&i.push(l)}}),[...i,...s]}getCellEditorInstances(e){const t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(s=>{const i=s.getCellEditor();i&&t.push(i)}),t}getEditingCells(){const e=[];return this.getAllCellCtrls().forEach(t=>{if(t.isEditing()){const s=t.getCellPosition();e.push(s)}}),e}mapRowNodes(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach(s=>{const i=s.id;switch(s.rowPinned){case"top":t.top[i]=s;break;case"bottom":t.bottom[i]=s;break;default:t.normal[i]=s;break}}),t}isRowInMap(e,t){const s=e.id;switch(e.rowPinned){case"top":return t.top[s]!=null;case"bottom":return t.bottom[s]!=null;default:return t.normal[s]!=null}}getRowCtrls(e){const t=this.mapRowNodes(e),s=this.getAllRowCtrls();return!e||!t?s:s.filter(i=>{const r=i.getRowNode();return this.isRowInMap(r,t)})}getCellCtrls(e,t){let s;Ce(t)&&(s={},t.forEach(r=>{const n=this.columnModel.getGridColumn(r);Ce(n)&&(s[n.getId()]=!0)}));const i=[];return this.getRowCtrls(e).forEach(r=>{r.getAllCellCtrls().forEach(n=>{const o=n.getColumn().getId();s&&!s[o]||i.push(n)})}),i}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const e=[];ei(this.rowCtrlsByRowIndex,(s,i)=>{i.getRowNode().id==null&&e.push(s)}),this.removeRowCtrls(e);const t={};return ei(this.rowCtrlsByRowIndex,(s,i)=>{const r=i.getRowNode();t[r.id]=i}),this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){e.forEach(s=>{const i=this.rowCtrlsByRowIndex[s];i&&(i.destroyFirstPass(t),i.destroySecondPass()),delete this.rowCtrlsByRowIndex[s]})}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{afterScroll:t}=e;let s;this.stickyRowFeature&&l0()&&(s=this.getCellToRestoreFocusToAfterRefresh()||void 0);const i=this.firstRenderedRow,r=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let n=!1;this.stickyRowFeature&&(n=this.stickyRowFeature.checkStickyRows());const o=this.firstRenderedRow!==i||this.lastRenderedRow!==r;if(!(t&&!n&&!o)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t&&!n),s!=null)){const a=this.getCellToRestoreFocusToAfterRefresh();s!=null&&a==null&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(s))}}removeRowCompsNotToDraw(e,t){const s={};e.forEach(n=>s[n]=!0);const r=Object.keys(this.rowCtrlsByRowIndex).filter(n=>!s[n]);this.removeRowCtrls(r,t)}calculateIndexesToDraw(e){let t=tF(this.firstRenderedRow,this.lastRenderedRow);const s=(r,n)=>{const o=n.getRowNode().rowIndex;o!=null&&(o<this.firstRenderedRow||o>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(n)&&t.push(o)};ei(this.rowCtrlsByRowIndex,s),ei(e,s),t.sort((r,n)=>r-n);const i=[];for(let r=0;r<t.length;r++){const n=t[r],o=this.paginationProxy.getRow(n);o&&!o.sticky&&i.push(n)}return i}recycleRows(e,t=!1,s=!1){const i=this.calculateIndexesToDraw(e);(this.printLayout||s)&&(t=!1),this.removeRowCompsNotToDraw(i,!t),i.forEach(r=>{this.createOrUpdateRowCtrl(r,e,t,s)}),e&&(s&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)),this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){const t={type:w.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll:e};this.eventService.dispatchEvent(t)}onDisplayedColumnsChanged(){const e=this.columnModel.isPinningLeft(),t=this.columnModel.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach(t=>{const s=t.getRowNode().rowIndex;e.push(s.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=this.mapRowNodes(e);return this.getAllRowCtrls().filter(s=>{if(!s.isFullWidth())return!1;const i=s.getRowNode();return!(t!=null&&!this.isRowInMap(i,t))})}createOrUpdateRowCtrl(e,t,s,i){let r,n=this.rowCtrlsByRowIndex[e];if(n||(r=this.paginationProxy.getRow(e),Ce(r)&&Ce(t)&&t[r.id]&&r.alreadyRendered&&(n=t[r.id],t[r.id]=null)),!n)if(r||(r=this.paginationProxy.getRow(e)),Ce(r))n=this.createRowCon(r,s,i);else return;return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=n,n}destroyRowCtrls(e,t){const s=[];ei(e,(i,r)=>{if(r){if(this.cachedRowCtrls&&r.isCacheable()){this.cachedRowCtrls.addRow(r);return}r.destroyFirstPass(!t),t?(this.zombieRowCtrls[r.getInstanceId()]=r,s.push(()=>{r.destroySecondPass(),delete this.zombieRowCtrls[r.getInstanceId()]})):r.destroySecondPass()}}),t&&(s.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),lA(s))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=this.gos.getRowHeightAsNumber();return e*t}workOutFirstAndLastRowsToRender(){this.rowContainerHeightService.updateOffset();let e,t;if(!this.paginationProxy.isRowsToRender())e=0,t=-1;else if(this.printLayout)this.environment.refreshRowHeightVariable(),e=this.paginationProxy.getPageFirstRow(),t=this.paginationProxy.getPageLastRow();else{const a=this.getRowBufferInPixels(),l=this.ctrlsService.getGridBodyCtrl(),u=this.gos.get("suppressRowVirtualisation");let h=!1,p,g;do{const x=this.paginationProxy.getPixelOffset(),{pageFirstPixel:S,pageLastPixel:T}=this.paginationProxy.getCurrentPagePixelRange(),I=this.rowContainerHeightService.getDivStretchOffset(),V=l.getScrollFeature().getVScrollPosition(),H=V.top,P=V.bottom;u?(p=S+I,g=T+I):(p=Math.max(H+x-a,S)+I,g=Math.min(P+x+a,T)+I),this.firstVisibleVPixel=Math.max(H+x,S)+I,this.lastVisibleVPixel=Math.min(P+x,T)+I,h=this.ensureAllRowsInRangeHaveHeightsCalculated(p,g)}while(h);let m=this.paginationProxy.getRowIndexAtPixel(p),C=this.paginationProxy.getRowIndexAtPixel(g);const y=this.paginationProxy.getPageFirstRow(),R=this.paginationProxy.getPageLastRow();m<y&&(m=y),C>R&&(C=R),e=m,t=C}const s=this.gos.isDomLayout("normal"),i=this.gos.get("suppressMaxRenderedRowRestriction"),r=Math.max(this.getRowBuffer(),500);s&&!i&&t-e>r&&(t=e+r);const n=e!==this.firstRenderedRow,o=t!==this.lastRenderedRow;if(n||o){this.firstRenderedRow=e,this.lastRenderedRow=t;const a={type:w.EVENT_VIEWPORT_CHANGED,firstRow:e,lastRow:t};this.eventService.dispatchEvent(a)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const e={type:w.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(e)})}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const s=this.paginationProxy.ensureRowHeightsValid(e,t,-1,-1);return s&&this.updateContainerHeights(),s}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const i=e.getRowNode(),r=this.focusService.isRowNodeFocused(i),n=e.isEditing(),o=i.detail;return r||n||o?!!this.paginationProxy.isRowPresent(i):!1}createRowCon(e,t,s){const i=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(i)return i;const r=this.gos.get("suppressAnimationFrame"),n=s&&!r&&!this.printLayout;return new al(e,this.beans,t,n,this.printLayout)}getRenderedNodes(){const e=this.rowCtrlsByRowIndex;return Object.values(e).map(t=>t.getRowNode())}getRowByPosition(e){let t;const{rowIndex:s}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[s];break;case"bottom":t=this.bottomRowCtrls[s];break;default:t=this.rowCtrlsByRowIndex[s],t||(t=this.getStickyTopRowCtrls().find(i=>i.getRowNode().rowIndex===s)||null,t||(t=this.getStickyBottomRowCtrls().find(i=>i.getRowNode().rowIndex===s)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}};f([A("animationFrameService")],ar.prototype,"animationFrameService",2);f([A("paginationProxy")],ar.prototype,"paginationProxy",2);f([A("columnModel")],ar.prototype,"columnModel",2);f([A("pinnedRowModel")],ar.prototype,"pinnedRowModel",2);f([A("rowModel")],ar.prototype,"rowModel",2);f([A("focusService")],ar.prototype,"focusService",2);f([A("beans")],ar.prototype,"beans",2);f([A("rowContainerHeightService")],ar.prototype,"rowContainerHeightService",2);f([A("ctrlsService")],ar.prototype,"ctrlsService",2);f([Ee],ar.prototype,"postConstruct",1);ar=f([je("rowRenderer")],ar);var OG=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e==null||e.id==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.getRowNode()!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,s=this.entriesMap[t];delete this.entriesMap[t],Fi(this.entriesList,s)}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],Fi(this.entriesList,e)}getEntries(){return this.entriesList}},mh=class extends xe{init(){this.setPinnedTopRowData(),this.setPinnedBottomRowData(),this.addManagedPropertyListener("pinnedTopRowData",()=>this.setPinnedTopRowData()),this.addManagedPropertyListener("pinnedBottomRowData",()=>this.setPinnedBottomRowData())}isEmpty(e){const t=e==="top"?this.pinnedTopRows:this.pinnedBottomRows;return yr(t)}isRowsToRender(e){return!this.isEmpty(e)}getRowAtPixel(e,t){const s=t==="top"?this.pinnedTopRows:this.pinnedBottomRows;if(yr(s))return 0;for(let i=0;i<s.length;i++){const r=s[i];if(r.rowTop+r.rowHeight-1>=e)return i}return s.length-1}setPinnedTopRowData(){const e=this.gos.get("pinnedTopRowData");this.pinnedTopRows=this.createNodesFromData(e,!0);const t={type:w.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}setPinnedBottomRowData(){const e=this.gos.get("pinnedBottomRowData");this.pinnedBottomRows=this.createNodesFromData(e,!1);const t={type:w.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(t)}createNodesFromData(e,t){const s=[];if(e){let i=0;e.forEach((r,n)=>{const o=new ft(this.beans);o.data=r;const a=t?ft.ID_PREFIX_TOP_PINNED:ft.ID_PREFIX_BOTTOM_PINNED;o.id=a+n,o.rowPinned=t?"top":"bottom",o.setRowTop(i),o.setRowHeight(this.gos.getRowHeightForNode(o).height),o.setRowIndex(n),i+=o.rowHeight,s.push(o)})}return s}getPinnedTopRowData(){return this.pinnedTopRows}getPinnedBottomRowData(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(e){return this.pinnedTopRows[e]}getPinnedBottomRow(e){return this.pinnedBottomRows[e]}forEachPinnedTopRow(e){yr(this.pinnedTopRows)||this.pinnedTopRows.forEach(e)}forEachPinnedBottomRow(e){yr(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(e)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(e){if(!e||e.length===0)return 0;const t=At(e);return t.rowTop+t.rowHeight}};f([A("beans")],mh.prototype,"beans",2);f([Ee],mh.prototype,"init",1);mh=f([je("pinnedRowModel")],mh);var av=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(e,t){if(e.children)for(let s=0;s<e.children.length;s++)this.depthFirstSearchChangedPath(e.children[s],t);t(e.rowNode)}depthFirstSearchEverything(e,t,s){if(e.childrenAfterGroup)for(let i=0;i<e.childrenAfterGroup.length;i++){const r=e.childrenAfterGroup[i];r.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[i],t,s):s&&t(r)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,s=!1){this.active&&!s?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,s=0;for(;!this.mapToItems[t.id];){const i={rowNode:t,children:null};this.mapToItems[t.id]=i,s++,t=t.parent}return s}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let s=e;for(;s;)this.nodeIdsToColumns[s.id]||(this.nodeIdsToColumns[s.id]={}),t.forEach(i=>this.nodeIdsToColumns[s.id][i.getId()]=!0),s=s.parent}linkPathItems(e,t){let s=e;for(let i=0;i<t;i++){const r=this.mapToItems[s.id],n=this.mapToItems[s.parent.id];n.children||(n.children=[]),n.children.push(r),s=s.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const s=this.createPathItems(e);this.linkPathItems(e,s),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const s=this.nodeIdsToColumns[e.id];return t.filter(r=>s[r.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const s=this.nodeIdsToColumns[e.id];return t.filter(r=>!s[r.getId()])}},xu=class Ma extends xe{constructor(t){super(),this.state=Ma.STATE_WAITING_TO_LOAD,this.version=0,this.id=t}getId(){return this.id}load(){this.state=Ma.STATE_LOADING,this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state=Ma.STATE_WAITING_TO_LOAD}getState(){return this.state}pageLoadFailed(t){this.isRequestMostRecentAndLive(t)&&(this.state=Ma.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}success(t,s){this.successCommon(t,s)}pageLoaded(t,s,i){this.successCommon(t,{rowData:s,rowCount:i})}isRequestMostRecentAndLive(t){const s=t===this.version,i=this.isAlive();return s&&i}successCommon(t,s){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(t)&&(this.state=Ma.STATE_LOADED,this.processServerResult(s))}dispatchLoadCompleted(t=!0){const s={type:Ma.EVENT_LOAD_COMPLETE,success:t,block:this};this.dispatchEvent(s)}};xu.EVENT_LOAD_COMPLETE="loadComplete";xu.STATE_WAITING_TO_LOAD="needsLoading";xu.STATE_LOADING="loading";xu.STATE_LOADED="loaded";xu.STATE_FAILED="failed";var aw=xu,An=class extends xe{constructor(){super(...arguments),this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=rt.debounce(this.performCheckBlocksToLoad.bind(this),e))}setBeans(e){this.logger=e.create("RowNodeBlockLoader")}getMaxConcurrentDatasourceRequests(){const e=this.gos.get("maxConcurrentDatasourceRequests");if(e==null)return 2;if(!(e<=0))return e}addBlock(e){this.blocks.push(e),e.addEventListener(aw.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){rt.removeFromArray(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:An.BLOCK_LOADED_EVENT}),this.activeBlockLoadsCount==0&&this.dispatchEvent({type:An.BLOCK_LOADER_FINISHED_EVENT})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){this.logger.log("checkBlockToLoad: max loads exceeded");return}const e=this.getAvailableLoadingCount(),t=this.blocks.filter(s=>s.getState()===aw.STATE_WAITING_TO_LOAD).slice(0,e);this.registerLoads(t.length),t.forEach(s=>s.load()),this.printCacheStatus()}getBlockState(){if(this.gos.isRowModelType("serverSide"))return this.rowModel.getBlockStates();const e={};return this.blocks.forEach(t=>{const{id:s,state:i}=t.getBlockStateJson();e[s]=i}),e}printCacheStatus(){this.logger.isLogging()&&this.logger.log(`printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return this.maxConcurrentRequests!==void 0?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}};An.BLOCK_LOADED_EVENT="blockLoaded";An.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished";f([A("rowModel")],An.prototype,"rowModel",2);f([Ee],An.prototype,"postConstruct",1);f([Yr(0,Sr("loggerFactory"))],An.prototype,"setBeans",1);An=f([je("rowNodeBlockLoader")],An);var vh=class extends xe{constructor(){super(...arguments),this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.pixelOffset=0,this.masterRowCount=0}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,w.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this)),this.onModelUpdated()}ensureRowHeightsValid(e,t,s,i){const r=this.rowModel.ensureRowHeightsValid(e,t,this.getPageFirstRow(),this.getPageLastRow());return r&&this.calculatePages(),r}isPaginateChildRows(){return this.gos.get("groupRemoveSingleChildren")||this.gos.get("groupRemoveLowestSingleChildren")?!0:this.gos.get("paginateChildRows")}onModelUpdated(e){this.calculatePages();const t={type:w.EVENT_PAGINATION_CHANGED,animate:e?e.animate:!1,newData:e?e.newData:!1,newPage:e?e.newPage:!1,newPageSize:e?e.newPageSize:!1,keepRenderedRows:e?e.keepRenderedRows:!1};this.eventService.dispatchEvent(t)}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages();const e={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(e)}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){if(!this.active||this.currentPage===e||typeof this.currentPage!="number")return;this.currentPage=e,this.calculatePages();const t={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!0,newPageSize:!1,keepRenderedRows:!1};this.eventService.dispatchEvent(t)}getPixelOffset(){return this.pixelOffset}getRow(e){return this.rowModel.getRow(e)}getRowNode(e){return this.rowModel.getRowNode(e)}getRowIndexAtPixel(e){return this.rowModel.getRowIndexAtPixel(e)}getCurrentPageHeight(){return nt(this.topRowBounds)||nt(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){const e=this.topRowBounds?this.topRowBounds.rowTop:0,t=this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0;return{pageFirstPixel:e,pageLastPixel:t}}isRowPresent(e){return this.rowModel.isRowPresent(e)?e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex:!1}isEmpty(){return this.rowModel.isEmpty()}isRowsToRender(){return this.rowModel.isRowsToRender()}forEachNode(e){return this.rowModel.forEachNode(e)}forEachNodeOnPage(e){const t=this.getPageFirstRow(),s=this.getPageLastRow();for(let i=t;i<=s;i++){const r=this.getRow(i);r&&e(r)}}getType(){return this.rowModel.getType()}getRowBounds(e){const t=this.rowModel.getRowBounds(e);return t.rowIndex=e,t}getPageFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getPageLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getRowCount(){return this.rowModel.getRowCount()}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){return this.active?this.getPageForIndex(e.rowIndex)===this.currentPage:!0}isLastPageFound(){return this.rowModel.isLastRowIndexKnown()}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return Ce(this.pageSizeAutoCalculated)?this.pageSizeAutoCalculated:Ce(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:Ce(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:Ce(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;if(this.pageSizeAutoCalculated=void 0,this.pageSize===e)return;this.calculatePages();const t={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!1};this.eventService.dispatchEvent(t)}setPageSize(e,t){const s=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}if(s!==this.pageSize){this.calculatePages();const i={type:w.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!0};this.eventService.dispatchEvent(i)}}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(Ce(this.topRowBounds)?this.topRowBounds.rowTop:0)}setPixelOffset(e){this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:w.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0){this.setZeroRows();return}const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let s=this.pageSize*(this.currentPage+1)-1;if(s>e&&(s=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),s===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const i=this.rowModel.getTopLevelRowDisplayedIndex(s+1);this.bottomDisplayedRowIndex=i-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),this.masterRowCount===0){this.setZeroRows();return}const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}};f([A("rowModel")],vh.prototype,"rowModel",2);f([Ee],vh.prototype,"postConstruct",1);vh=f([je("paginationProxy")],vh);var Af=class extends xe{processAllCellClasses(e,t,s,i){this.processClassRules(void 0,e.cellClassRules,t,s,i),this.processStaticCellClasses(e,t,s)}processClassRules(e,t,s,i,r){if(t==null&&e==null)return;const n={},o={},a=(l,u)=>{l.split(" ").forEach(h=>{h.trim()!=""&&u(h)})};if(t){const l=Object.keys(t);for(let u=0;u<l.length;u++){const h=l[u],p=t[h];let g;typeof p=="string"?g=this.expressionService.evaluate(p,s):typeof p=="function"&&(g=p(s)),a(h,m=>{g?n[m]=!0:o[m]=!0})}}e&&r&&Object.keys(e).forEach(l=>a(l,u=>{n[u]||(o[u]=!0)})),r&&Object.keys(o).forEach(r),Object.keys(n).forEach(i)}getStaticCellClasses(e,t){const{cellClass:s}=e;if(!s)return[];let i;return typeof s=="function"?i=s(t):i=s,typeof i=="string"&&(i=[i]),i||[]}processStaticCellClasses(e,t,s){this.getStaticCellClasses(e,t).forEach(r=>{s(r)})}};f([A("expressionService")],Af.prototype,"expressionService",2);Af=f([je("stylingService")],Af);var RI=class extends $m{constructor(e){super(e,"ag-toggle-button")}setValue(e,t){return super.setValue(e,t),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}},GG=class extends Qr{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const s=super.setValue(e,t);return this.eInput.value=e,s}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},VG=class extends _l{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));const e=Pn();this.addManagedListener(this.eInput,"mousedown",()=>{this.isDisabled()||e||this.eInput.focus()}),this.eInput.step="any"}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}setMin(e){var t;const s=e instanceof Date?(t=br(e??null,!1))!=null?t:void 0:e;return this.min===s?this:(this.min=s,Tn(this.eInput,"min",s),this)}setMax(e){var t;const s=e instanceof Date?(t=br(e??null,!1))!=null?t:void 0:e;return this.max===s?this:(this.max=s,Tn(this.eInput,"max",s),this)}setStep(e){return this.step===e?this:(this.step=e,Tn(this.eInput,"step",e),this)}getDate(){var e;if(this.eInput.validity.valid)return(e=Li(this.getValue()))!=null?e:void 0}setDate(e,t){this.setValue(br(e??null,!1),t)}},BG=class extends Qr{constructor(e){super(e,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min:e,max:t,step:s}=this.config;e!=null&&this.setMinValue(e),t!=null&&this.setMaxValue(t),this.setStep(s||1)}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>{const t=e.target.value;this.setValue(t)})}setMinValue(e){return this.min=e,this.eInput.setAttribute("min",e.toString()),this}setMaxValue(e){return this.max=e,this.eInput.setAttribute("max",e.toString()),this}setStep(e){return this.eInput.setAttribute("step",e.toString()),this}setValue(e,t){this.min!=null&&(e=Math.max(parseFloat(e),this.min).toString()),this.max!=null&&(e=Math.min(parseFloat(e),this.max).toString());const s=super.setValue(e,t);return this.eInput.value=e,s}},j0=class extends ot{constructor(e,t){super('<div class="ag-rich-select-row" role="presentation"></div>'),this.params=e,this.wrapperEl=t}postConstruct(){this.addManagedListener(this.getGui(),"click",this.onClick.bind(this))}setState(e){let t="";this.params.valueFormatter&&(t=this.params.valueFormatter(e)),this.populateWithRenderer(e,t)||this.populateWithoutRenderer(e,t),this.value=e}highlightString(e){const{parsedValue:t}=this;if(this.params.cellRenderer||!Ce(t))return;let s=Ce(e);if(s){const i=t==null?void 0:t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(i>=0){const r=i+e.length,n=ys(t.slice(0,i),!0),o=ys(t.slice(i,r),!0),a=ys(t.slice(r));this.renderValueWithoutRenderer(`${n}<span class="ag-rich-select-row-text-highlight">${o}</span>${a}`)}else s=!1}s||this.renderValueWithoutRenderer(t)}updateHighlighted(e){var t;const s=this.getGui(),i=`ag-rich-select-row-${this.getCompId()}`;if((t=s.parentElement)==null||t.setAttribute("id",i),e){const r=this.getParentComponent().getAriaElement();t0(r,i),this.wrapperEl.setAttribute("data-active-option",i)}$c(s.parentElement,e),this.addOrRemoveCssClass("ag-rich-select-row-selected",e)}populateWithoutRenderer(e,t){const s=this.gos.getDocument(),i=this.getGui(),r=s.createElement("span");r.style.overflow="hidden",r.style.textOverflow="ellipsis";const n=ys(Ce(t)?t:e,!0);this.parsedValue=Ce(n)?n:null,i.appendChild(r),this.renderValueWithoutRenderer(n),this.setTooltip({newTooltipText:this.parsedValue,shouldDisplayTooltip:()=>r.scrollWidth>r.clientWidth})}renderValueWithoutRenderer(e){const t=this.getGui().querySelector("span");t&&(t.innerHTML=Ce(e)?e:"&nbsp;")}populateWithRenderer(e,t){let s,i;return this.params.cellRenderer&&(i=this.userComponentFactory.getCellRendererDetails(this.params,{value:e,valueFormatted:t,setTooltip:(r,n)=>{this.setTooltip({newTooltipText:r,shouldDisplayTooltip:n})}})),i&&(s=i.newAgStackInstance()),s&&w0(s,this.getGui()),s?(s.then(r=>{this.addDestroyFunc(()=>{this.getContext().destroyBean(r)})}),!0):!1}onClick(){const e=this.getParentComponent(),t={type:w.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:!1,value:this.value};e==null||e.dispatchEvent(t)}};f([A("userComponentFactory")],j0.prototype,"userComponentFactory",2);f([Ee],j0.prototype,"postConstruct",1);var Sp=class TI extends yp{constructor(t){super(TI.getTemplate((t==null?void 0:t.cssIdentifier)||"default")),this.renderedRows=new Map,this.rowHeight=20,this.pageSize=-1,this.isScrolling=!1,this.isHeightFromTheme=!0;const{cssIdentifier:s="default",ariaRole:i="listbox",listName:r}=t||{};this.cssIdentifier=s,this.ariaRole=i,this.listName=r}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:t=>this.onFocusIn(t),onFocusOut:t=>this.onFocusOut(t),focusInnerElement:t=>this.focusInnerElement(t),onTabKeyDown:t=>this.onTabKeyDown(t),handleKeyDown:t=>this.handleKeyDown(t)}),this.setAriaProperties(),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}onGridStylesChanged(){this.rowHeight=this.getItemHeight(),this.refresh()}setAriaProperties(){const s=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),i=this.eContainer;cs(i,this.ariaRole),or(i,s)}addResizeObserver(){const t=()=>this.animationFrameService.requestAnimationFrame(()=>this.drawVirtualRows()),s=this.resizeObserverService.observeResize(this.getGui(),t);this.addDestroyFunc(s)}focusInnerElement(t){this.focusRow(t?this.model.getRowCount()-1:0)}onFocusIn(t){const s=t.target;s.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=MA(s)-1)}onFocusOut(t){this.getFocusableElement().contains(t.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(t){switch(t.key){case z.UP:case z.DOWN:this.navigate(t.key===z.UP)&&t.preventDefault();break;case z.PAGE_HOME:case z.PAGE_END:case z.PAGE_UP:case z.PAGE_DOWN:this.navigateToPage(t.key)!==null&&t.preventDefault();break}}onTabKeyDown(t){this.navigate(t.shiftKey)?t.preventDefault():(nn(t),this.forceFocusOutOfContainer(t.shiftKey))}navigate(t){if(this.lastFocusedRowIndex==null)return!1;const s=this.lastFocusedRowIndex+(t?-1:1);return s<0||s>=this.model.getRowCount()?!1:(this.focusRow(s),!0)}navigateToPage(t,s="focused"){let i=!1;s==="focused"&&(s=this.getLastFocusedRow(),i=!0);const r=this.model.getRowCount()-1;let n=-1;return t===z.PAGE_HOME?n=0:t===z.PAGE_END?n=r:t===z.PAGE_DOWN?n=Math.min(s+this.pageSize,r):t===z.PAGE_UP&&(n=Math.max(s-this.pageSize,0)),n===-1?null:(i?this.focusRow(n):this.ensureIndexVisible(n),n)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(t){this.isScrolling||(this.isScrolling=!0,this.ensureIndexVisible(t),this.animationFrameService.requestAnimationFrame(()=>{if(this.isScrolling=!1,!this.isAlive())return;const s=this.renderedRows.get(t);s&&s.eDiv.focus()}))}getComponentAt(t){const s=this.renderedRows.get(t);return s&&s.rowComponent}forEachRenderedRow(t){this.renderedRows.forEach((s,i)=>t(s.rowComponent,i))}static getTemplate(t){return`<div class="ag-virtual-list-viewport ag-${t}-virtual-list-viewport" role="presentation">
                <div class="ag-virtual-list-container ag-${t}-virtual-list-container" ref="eContainer"></div>
            </div>`}getItemHeight(){return this.isHeightFromTheme?this.environment.getListItemHeight():this.rowHeight}ensureIndexVisible(t,s=!0){const i=this.model.getRowCount();if(typeof t!="number"||t<0||t>=i)return console.warn("AG Grid: invalid row index for ensureIndexVisible: "+t),!1;const r=t*this.rowHeight,n=r+this.rowHeight,o=this.getGui(),a=o.scrollTop,l=o.offsetHeight,u=a+l,h=s?0:this.rowHeight,p=a>r+h,g=u<n-h;if(p)return o.scrollTop=r,!0;if(g){const m=n-l;return o.scrollTop=m,!0}return!1}setComponentCreator(t){this.componentCreator=t}setComponentUpdater(t){this.componentUpdater=t}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(t){this.isHeightFromTheme=!1,this.rowHeight=t,this.refresh()}refresh(t){if(this.model==null||!this.isAlive())return;const s=this.model.getRowCount();this.eContainer.style.height=`${s*this.rowHeight}px`,YS(()=>this.eContainer.clientHeight>=s*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(t)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(t){return!!(t&&this.renderedRows.size&&typeof this.model.areRowsEqual=="function"&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((t,s)=>this.removeRow(s))}drawVirtualRows(t){if(!this.isAlive()||!this.model)return;const s=this.getGui(),i=s.scrollTop,r=i+s.offsetHeight,n=Math.floor(i/this.rowHeight),o=Math.floor(r/this.rowHeight);this.pageSize=Math.floor((r-i)/this.rowHeight),this.ensureRowsRendered(n,o,t)}ensureRowsRendered(t,s,i){this.renderedRows.forEach((r,n)=>{(n<t||n>s)&&n!==this.lastFocusedRowIndex&&this.removeRow(n)}),i&&this.refreshRows();for(let r=t;r<=s;r++)this.renderedRows.has(r)||r<this.model.getRowCount()&&this.insertRow(r)}insertRow(t){const s=this.model.getRow(t),i=document.createElement("div");i.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),cs(i,this.ariaRole==="tree"?"treeitem":"option"),Lm(i,this.model.getRowCount()),Om(i,t+1),i.setAttribute("tabindex","-1"),i.style.height=`${this.rowHeight}px`,i.style.top=`${this.rowHeight*t}px`;const r=this.componentCreator(s,i);r.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=t),i.appendChild(r.getGui()),this.renderedRows.has(t-1)?this.renderedRows.get(t-1).eDiv.insertAdjacentElement("afterend",i):this.renderedRows.has(t+1)?this.renderedRows.get(t+1).eDiv.insertAdjacentElement("beforebegin",i):this.eContainer.appendChild(i),this.renderedRows.set(t,{rowComponent:r,eDiv:i,value:s})}removeRow(t){const s=this.renderedRows.get(t);this.eContainer.removeChild(s.eDiv),this.destroyBean(s.rowComponent),this.renderedRows.delete(t)}refreshRows(){const t=this.model.getRowCount();this.renderedRows.forEach((s,i)=>{var r,n;if(i>=t)this.removeRow(i);else{const o=this.model.getRow(i);(n=(r=this.model).areRowsEqual)!=null&&n.call(r,s.value,o)?this.componentUpdater(o,s.rowComponent):this.removeRow(i)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(t){this.model=t}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}};f([A("resizeObserverService")],Sp.prototype,"resizeObserverService",2);f([A("animationFrameService")],Sp.prototype,"animationFrameService",2);f([Ie("eContainer")],Sp.prototype,"eContainer",2);f([Ee],Sp.prototype,"postConstruct",1);var DI=Sp,HG=`
    <div class="ag-picker-field" role="presentation">
        <div ref="eLabel"></div>
            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-rich-select-value ag-picker-collapsed">
            <div ref="eDisplayField" class="ag-picker-field-display"></div>
            <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>
            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>
        </div>
    </div>`,lv=class extends Nl{constructor(e){var t,s;super(Jt(Je({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list",className:"ag-rich-select",pickerIcon:"smallDown",ariaRole:"combobox",template:(t=e==null?void 0:e.template)!=null?t:HG,modalPicker:!1},e),{maxPickerHeight:(s=e==null?void 0:e.maxPickerHeight)!=null?s:"calc(var(--ag-row-height) * 6.5)"})),this.searchString="",this.highlightedItem=-1,this.lastRowHovered=-1,this.searchStringCreator=null;const{cellRowHeight:i,value:r,valueList:n,searchStringCreator:o}=e||{};i!=null&&(this.cellRowHeight=i),r!==void 0&&(this.value=r),n!=null&&(this.values=n),o&&(this.searchStringCreator=o)}postConstruct(){super.postConstruct(),this.createLoadingElement(),this.createListComponent();const{allowTyping:e,placeholder:t}=this.config;e?(this.eInput.setAutoComplete(!1).setInputPlaceholder(t),this.eDisplayField.classList.add("ag-hidden")):this.eInput.setDisplayed(!1),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{searchDebounceDelay:s=300}=this.config;this.clearSearchString=pi(this.clearSearchString,s),this.renderSelectedValue(),e&&(this.eInput.onValueChange(i=>this.searchTextFromString(i)),this.addManagedListener(this.eWrapper,"focus",this.onWrapperFocus.bind(this))),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}createLoadingElement(){const e=this.gos.getDocument(),t=this.localeService.getLocaleTextFunc(),s=e.createElement("div");s.classList.add("ag-loading-text"),s.innerText=t("loadingOoo","Loading..."),this.eLoading=s}createListComponent(){this.listComponent=this.createBean(new DI({cssIdentifier:"rich-select"})),this.listComponent.setComponentCreator(this.createRowComponent.bind(this));const e=(a,l)=>{};this.listComponent.setComponentUpdater(e),this.listComponent.setParentComponent(this),this.addManagedListener(this.listComponent,w.EVENT_FIELD_PICKER_VALUE_SELECTED,a=>{this.onListValueSelected(a.value,a.fromEnterKey)});const{cellRowHeight:t}=this;t&&this.listComponent.setRowHeight(t);const s=this.listComponent.getGui(),i=this.listComponent.getAriaElement();this.addManagedListener(s,"mousemove",this.onPickerMouseMove.bind(this)),this.addManagedListener(s,"mousedown",a=>a.preventDefault()),s.classList.add("ag-rich-select-list");const r=`ag-rich-select-list-${this.listComponent.getCompId()}`;i.setAttribute("id",r);const o=this.localeService.getLocaleTextFunc()(this.config.pickerAriaLabelKey,this.config.pickerAriaLabelValue);or(i,o),r0(this.eWrapper,i)}renderSelectedValue(){const{value:e,eDisplayField:t,config:s}=this,{allowTyping:i,initialInputValue:r}=this.config,n=this.config.valueFormatter?this.config.valueFormatter(e):e;if(i){this.eInput.setValue(r??n);return}let o;s.cellRenderer&&(o=this.userComponentFactory.getCellRendererDetails(this.config,{value:e,valueFormatted:n}));let a;if(o&&(a=o.newAgStackInstance()),a)fs(t),w0(a,t),a.then(l=>{this.addDestroyFunc(()=>this.getContext().destroyBean(l))});else{if(Ce(this.value))t.innerText=n,t.classList.remove("ag-display-as-placeholder");else{const{placeholder:l}=s;Ce(l)?(t.innerHTML=`${ys(l)}`,t.classList.add("ag-display-as-placeholder")):fs(t)}this.setTooltip({newTooltipText:n??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth})}}getCurrentValueIndex(){const{currentList:e,value:t}=this;if(t==null||!e)return-1;for(let s=0;s<e.length;s++)if(e[s]===t)return s;return-1}highlightFilterMatch(){var e;(e=this.listComponent)==null||e.forEachRenderedRow((t,s)=>{t.highlightString(this.searchString)})}highlightSelectedValue(e){var t;e==null&&(e=this.getCurrentValueIndex()),this.highlightedItem=e,(t=this.listComponent)==null||t.forEachRenderedRow((s,i)=>{const r=e===-1?!1:this.highlightedItem===i;s.updateHighlighted(r)})}setRowHeight(e){e!==this.cellRowHeight&&(this.cellRowHeight=e),this.listComponent&&this.listComponent.setRowHeight(e)}createPickerComponent(){const{values:e}=this;return e&&this.setValueList({valueList:e}),this.listComponent}setSearchStringCreator(e){this.searchStringCreator=e}setValueList(e){const{valueList:t,refresh:s}=e;this.listComponent&&this.currentList!==t&&(this.currentList=t,this.listComponent.setModel({getRowCount:()=>t.length,getRow:i=>t[i],areRowsEqual:(i,r)=>i===r}),s&&(this.values?this.listComponent.refresh(!0):(this.values=t,this.isPickerDisplayed&&this.showCurrentValueInPicker())))}showPicker(){super.showPicker(),this.showCurrentValueInPicker(),this.displayOrHidePicker()}showCurrentValueInPicker(){var e,t;if(!this.listComponent)return;if(!this.currentList){this.isPickerDisplayed&&this.eLoading&&this.listComponent.appendChild(this.eLoading);return}(e=this.eLoading)!=null&&e.offsetParent&&((t=this.eLoading.parentElement)==null||t.removeChild(this.eLoading));const s=this.getCurrentValueIndex();s!==-1?(this.listComponent.refresh(),this.listComponent.ensureIndexVisible(s),this.listComponent.refresh(!0),this.highlightSelectedValue(s)):this.listComponent.refresh()}beforeHidePicker(){this.highlightedItem=-1,super.beforeHidePicker()}onWrapperFocus(){if(!this.eInput)return;const e=this.eInput.getFocusableElement();e.focus(),e.select()}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}buildSearchStringFromKeyboardEvent(e){let{key:t}=e;if(t===z.BACKSPACE)this.searchString=this.searchString.slice(0,-1),t="";else if(!Hm(e))return;e.preventDefault(),this.searchTextFromCharacter(t)}searchTextFromCharacter(e){this.searchString+=e,this.runSearch(),this.clearSearchString()}searchTextFromString(e){e==null&&(e=""),this.searchString=e,this.runSearch()}buildSearchStrings(e){const{valueFormatter:t=i=>i}=this.config;let s;return typeof e[0]=="number"||typeof e[0]=="string"?s=e.map(i=>t(i)):typeof e[0]=="object"&&this.searchStringCreator&&(s=this.searchStringCreator(e)),s}getSuggestionsAndFilteredValues(e,t){let s=[],i=[];if(!e.length)return{suggestions:s,filteredValues:i};const{searchType:r="fuzzy",filterList:n}=this.config;if(r==="fuzzy"){const o=up(this.searchString,t,!0);s=o.values;const a=o.indices;if(n&&a.length)for(let l=0;l<a.length;l++)i.push(this.values[a[l]])}else s=t.filter((o,a)=>{const l=o.toLocaleLowerCase(),u=this.searchString.toLocaleLowerCase(),h=r==="match"?l.startsWith(u):l.indexOf(u)!==-1;return n&&h&&i.push(this.values[a]),h});return{suggestions:s,filteredValues:i}}filterListModel(e){const{filterList:t}=this.config;t&&(this.setValueList({valueList:e,refresh:!0}),this.alignPickerToComponent())}runSearch(){var e,t;const{values:s}=this,i=this.buildSearchStrings(s);if(!i){this.highlightSelectedValue(-1);return}const{suggestions:r,filteredValues:n}=this.getSuggestionsAndFilteredValues(this.searchString,i),{filterList:o,highlightMatch:a,searchType:l="fuzzy"}=this.config,u=n.length,h=!!(o&&this.searchString!=="");if(this.filterListModel(h?n:s),r.length){const p=h?0:i.indexOf(r[0]);this.selectListItem(p)}else if(this.highlightSelectedValue(-1),!h||u)(e=this.listComponent)==null||e.ensureIndexVisible(0);else if(h){this.getAriaElement().removeAttribute("data-active-option");const p=(t=this.listComponent)==null?void 0:t.getAriaElement();p&&t0(p,null)}a&&l!=="fuzzy"&&this.highlightFilterMatch(),this.displayOrHidePicker()}displayOrHidePicker(){var e;const t=(e=this.listComponent)==null?void 0:e.getGui(),s=this.currentList?this.currentList.length===0:!1;t==null||t.classList.toggle("ag-hidden",s)}clearSearchString(){this.searchString=""}selectListItem(e,t){if(!this.isPickerDisplayed||!this.currentList||!this.listComponent||e<0||e>=this.currentList.length)return;this.listComponent.ensureIndexVisible(e,!t)&&!t&&this.listComponent.refresh(!0),this.highlightSelectedValue(e)}setValue(e,t,s){const i=this.currentList?this.currentList.indexOf(e):-1;return i===-1?this:(this.value=e,s||this.selectListItem(i),this.renderSelectedValue(),super.setValue(e,t))}createRowComponent(e){const t=new j0(this.config,this.eWrapper);t.setParentComponent(this.listComponent),this.getContext().createBean(t),t.setState(e);const{highlightMatch:s,searchType:i="fuzzy"}=this.config;return s&&i!=="fuzzy"&&t.highlightString(this.searchString),t}getRowForMouseEvent(e){const{listComponent:t}=this;if(!t)return-1;const i=(t==null?void 0:t.getGui()).getBoundingClientRect(),r=t.getScrollTop(),n=e.clientY-i.top+r;return Math.floor(n/t.getRowHeight())}onPickerMouseMove(e){if(!this.listComponent)return;const t=this.getRowForMouseEvent(e);t!==-1&&t!=this.lastRowHovered&&(this.lastRowHovered=t,this.selectListItem(t,!0))}onNavigationKeyDown(e,t){e.preventDefault();const s=t===z.DOWN;if(!this.isPickerDisplayed&&s){this.showPicker();return}const i=this.highlightedItem,n=i===-1?0:i+(s?1:-1);this.selectListItem(n)}onPageNavigation(e){var t;if(!this.isPickerDisplayed)return;const s=(t=this.listComponent)==null?void 0:t.navigateToPage(e,this.highlightedItem);s!=null&&this.animationFrameService.requestAnimationFrame(()=>{if(!this.isAlive())return null;this.highlightSelectedValue(s)})}onEnterKeyDown(e){this.isPickerDisplayed&&(e.preventDefault(),this.currentList&&this.onListValueSelected(this.currentList[this.highlightedItem],!0))}onTabKeyDown(){!this.isPickerDisplayed||!this.currentList||this.setValue(this.currentList[this.highlightedItem],!1,!0)}onListValueSelected(e,t){this.setValue(e,!1,!0),this.dispatchPickerEvent(e,t),this.hidePicker()}dispatchPickerEvent(e,t){const s={type:w.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:t,value:e};this.dispatchEvent(s)}getFocusableElement(){const{allowTyping:e}=this.config;return e?this.eInput.getFocusableElement():super.getFocusableElement()}onKeyDown(e){const t=e.key,{allowTyping:s}=this.config;switch(t){case z.LEFT:case z.RIGHT:s||e.preventDefault();break;case z.PAGE_HOME:case z.PAGE_END:if(s){e.preventDefault();const i=this.eInput.getInputElement(),r=t===z.PAGE_HOME?0:i.value.length;i.setSelectionRange(r,r);break}case z.PAGE_UP:case z.PAGE_DOWN:e.preventDefault(),this.onPageNavigation(t);break;case z.DOWN:case z.UP:this.onNavigationKeyDown(e,t);break;case z.ESCAPE:this.isPickerDisplayed&&(ji(this.listComponent.getGui())&&(e.preventDefault(),nn(e)),this.hidePicker());break;case z.ENTER:this.onEnterKeyDown(e);break;case z.TAB:this.onTabKeyDown();break;default:s||this.buildSearchStringFromKeyboardEvent(e)}}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),this.eLoading=void 0,super.destroy()}};f([A("userComponentFactory")],lv.prototype,"userComponentFactory",2);f([A("animationFrameService")],lv.prototype,"animationFrameService",2);f([Ie("eInput")],lv.prototype,"eInput",2);var Eu=class PI extends b0{constructor(t){super(t,PI.TEMPLATE),this.labelAlignment="top"}init(){this.eSlider.addCssClass("ag-slider-field");const{minValue:t,maxValue:s,textFieldWidth:i,step:r,value:n,onValueChange:o}=this.config;t!=null&&this.setMinValue(t),s!=null&&this.setMaxValue(s),i!=null&&this.setTextFieldWidth(i),r!=null&&this.setStep(r),n!=null&&this.setValue(n),o!=null&&this.onValueChange(o)}onValueChange(t){const s=w.EVENT_FIELD_VALUE_CHANGED;return this.addManagedListener(this.eText,s,()=>{const i=parseFloat(this.eText.getValue());this.eSlider.setValue(i.toString(),!0),t(i||0)}),this.addManagedListener(this.eSlider,s,()=>{const i=this.eSlider.getValue();this.eText.setValue(i,!0),t(parseFloat(i))}),this}setSliderWidth(t){return this.eSlider.setWidth(t),this}setTextFieldWidth(t){return this.eText.setWidth(t),this}setMinValue(t){return this.eSlider.setMinValue(t),this.eText.setMin(t),this}setMaxValue(t){return this.eSlider.setMaxValue(t),this.eText.setMax(t),this}getValue(){return this.eText.getValue()}setValue(t,s){return this.getValue()===t?this:(this.eText.setValue(t,!0),this.eSlider.setValue(t,!0),s||this.dispatchEvent({type:w.EVENT_FIELD_VALUE_CHANGED}),this)}setStep(t){return this.eSlider.setStep(t),this.eText.setStep(t),this}};Eu.TEMPLATE=`<div class="ag-slider">
            <label ref="eLabel"></label>
            <div class="ag-wrapper ag-slider-wrapper">
                <ag-input-range ref="eSlider"></ag-input-range>
                <ag-input-number-field ref="eText"></ag-input-number-field>
            </div>
        </div>`;f([Ie("eLabel")],Eu.prototype,"eLabel",2);f([Ie("eSlider")],Eu.prototype,"eSlider",2);f([Ie("eText")],Eu.prototype,"eText",2);f([Ee],Eu.prototype,"init",1);var jG=Eu,fa=class Jl extends ot{constructor(t={}){super(Jl.getTemplate(t)),this.params=t,this.suppressEnabledCheckbox=!0,this.suppressToggleExpandOnEnableChange=!1;const{enabled:s,items:i,suppressEnabledCheckbox:r,expanded:n,suppressToggleExpandOnEnableChange:o,useToggle:a}=t;this.cssIdentifier=t.cssIdentifier||"default",this.enabled=s??!0,this.items=i||[],this.useToggle=a??!1,this.alignItems=t.alignItems||"center",this.expanded=n??!0,r!=null&&(this.suppressEnabledCheckbox=r),o!=null&&(this.suppressToggleExpandOnEnableChange=o)}static getTemplate(t){const s=t.cssIdentifier||"default",i=t.direction||"vertical";return`
            <div class="ag-group ag-${s}-group" role="presentation">
                <div ref="eToolbar" class="ag-group-toolbar ag-${s}-group-toolbar">
                    <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>
                </div>
                <div ref="eContainer" class="ag-group-container ag-group-container-${i} ag-${s}-group-container"></div>
            </div>
        `}postConstruct(){if(this.setupTitleBar(),this.items.length){const r=this.items;this.items=[],this.addItems(r)}const t=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(t("enabled","Enabled")),this.enabled&&this.setEnabled(this.enabled,void 0,!0),this.setAlignItems(this.alignItems);const{onEnableChange:s,suppressOpenCloseIcons:i}=this.params;this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(i??!1),this.refreshChildDisplay(),Et(this.eContainer,this.expanded),this.cbGroupEnabled.onValueChange(r=>{this.setEnabled(r,!0,this.suppressToggleExpandOnEnableChange),this.dispatchEnableChangeEvent(r)}),s!=null&&this.onEnableChange(s)}refreshChildDisplay(){var t;Et(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),(t=this.eTitleBar)==null||t.refreshOnExpand(this.expanded)}isExpanded(){return this.expanded}setAlignItems(t){this.alignItems!==t&&this.removeCssClass(`ag-group-item-alignment-${this.alignItems}`),this.alignItems=t;const s=`ag-group-item-alignment-${this.alignItems}`;return this.addCssClass(s),this}toggleGroupExpand(t){var s;let i=!1;if((s=this.eTitleBar)!=null&&s.isSuppressCollapse()&&!this.useToggle)t=!0,i=!0;else if(t=t??!this.expanded,this.expanded===t)return this;return this.expanded=t,this.refreshChildDisplay(),Et(this.eContainer,t),i||this.dispatchEvent({type:t?Jl.EVENT_EXPANDED:Jl.EVENT_COLLAPSED}),this}addItems(t){t.forEach(s=>this.addItem(s))}prependItem(t){this.insertItem(t,!0)}addItem(t){this.insertItem(t,!1)}insertItem(t,s){const i=this.eContainer,r=t instanceof ot?t.getGui():t;r.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),s?(i.insertAdjacentElement("afterbegin",r),this.items.unshift(r)):(i.appendChild(r),this.items.push(r))}hideItem(t,s){const i=this.items[s];Et(i,!t)}getItemIndex(t){const s=t instanceof ot?t.getGui():t;return this.items.indexOf(s)}setTitle(t){var s;return(s=this.eTitleBar)==null||s.setTitle(t),this}addTitleBarWidget(t){var s;return(s=this.eTitleBar)==null||s.addWidget(t),this}addCssClassToTitleBar(t){var s;(s=this.eTitleBar)==null||s.addCssClass(t)}dispatchEnableChangeEvent(t){const s={type:Jl.EVENT_ENABLE_CHANGE,enabled:t};this.dispatchEvent(s)}setEnabled(t,s,i){var r;return this.enabled=t,this.refreshDisabledStyles(),i||this.toggleGroupExpand(t),s||(this.cbGroupEnabled.setValue(t),(r=this.eToggle)==null||r.setValue(t)),this}isEnabled(){return this.enabled}onEnableChange(t){return this.addManagedListener(this,Jl.EVENT_ENABLE_CHANGE,s=>t(s.enabled)),this}hideEnabledCheckbox(t){return this.suppressEnabledCheckbox=t,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(t){var s;return(s=this.eTitleBar)==null||s.hideOpenCloseIcons(t),this}refreshDisabledStyles(){var t;const s=!this.enabled;this.eContainer.classList.toggle("ag-disabled",s),(t=this.eTitleBar)==null||t.refreshDisabledStyles(this.suppressEnabledCheckbox&&s),this.eContainer.classList.toggle("ag-disabled-group-container",s)}setupTitleBar(){const t=this.useToggle?this.createToggleTitleBar():this.createDefaultTitleBar();this.eToolbar.insertAdjacentElement("beforebegin",t.getGui())}createDefaultTitleBar(){const t=this.createManagedBean(new Db(this.params));return this.eTitleBar=t,t.refreshOnExpand(this.expanded),this.addManagedListener(t,Db.EVENT_EXPAND_CHANGED,s=>this.toggleGroupExpand(s.expanded)),t}createToggleTitleBar(){var t;const s=this.createManagedBean(new RI({value:this.enabled,label:this.params.title,labelAlignment:"left",labelWidth:"flex",onValueChange:i=>{this.setEnabled(i,!0),this.dispatchEnableChangeEvent(i)}}));return s.addCssClass("ag-group-title-bar"),s.addCssClass(`ag-${(t=this.params.cssIdentifier)!=null?t:"default"}-group-title-bar ag-unselectable`),this.eToggle=s,this.toggleGroupExpand(this.enabled),s}};fa.EVENT_EXPANDED="expanded";fa.EVENT_COLLAPSED="collapsed";fa.EVENT_ENABLE_CHANGE="enableChange";f([Ie("eToolbar")],fa.prototype,"eToolbar",2);f([Ie("cbGroupEnabled")],fa.prototype,"cbGroupEnabled",2);f([Ie("eContainer")],fa.prototype,"eContainer",2);f([Ee],fa.prototype,"postConstruct",1);var WG=fa,gC="ag-disabled-group-title-bar",bu=class lw extends ot{constructor(t={}){super(lw.getTemplate(t)),this.suppressOpenCloseIcons=!1;const{title:s,suppressOpenCloseIcons:i}=t;s&&s.length>0&&(this.title=s),i!=null&&(this.suppressOpenCloseIcons=i)}static getTemplate(t){var s;const i=(s=t.cssIdentifier)!=null?s:"default";return`
            <div class="ag-group-title-bar ag-${i}-group-title-bar ag-unselectable" role="button">
                <span class="ag-group-title-bar-icon ag-${i}-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>
                <span class="ag-group-title-bar-icon ag-${i}-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>
                <span ref="eTitle" class="ag-group-title ag-${i}-group-title"></span>
            </div>
        `}postConstruct(){this.setTitle(this.title),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract()}setupExpandContract(){this.eGroupClosedIcon.appendChild(fr("columnSelectClosed",this.gos,null)),this.eGroupOpenedIcon.appendChild(fr("columnSelectOpen",this.gos,null)),this.addManagedListener(this.getGui(),"click",()=>this.dispatchExpandChanged()),this.addManagedListener(this.getGui(),"keydown",t=>{switch(t.key){case z.ENTER:case z.SPACE:t.preventDefault(),this.dispatchExpandChanged();break;case z.RIGHT:case z.LEFT:t.preventDefault(),this.dispatchExpandChanged(t.key===z.RIGHT);break}})}refreshOnExpand(t){this.refreshAriaStatus(t),this.refreshOpenCloseIcons(t)}refreshAriaStatus(t){this.suppressOpenCloseIcons||Jn(this.getGui(),t)}refreshOpenCloseIcons(t){const s=!this.suppressOpenCloseIcons;Et(this.eGroupOpenedIcon,s&&t),Et(this.eGroupClosedIcon,s&&!t)}isSuppressCollapse(){return this.suppressOpenCloseIcons}dispatchExpandChanged(t){const s={type:lw.EVENT_EXPAND_CHANGED,expanded:t};this.dispatchEvent(s)}setTitle(t){const s=this.getGui(),i=!!t&&t.length>0;t=i?t:void 0,this.eTitle.textContent=t??"",Et(s,i),t!==this.title&&(this.title=t);const r=s.classList.contains(gC);return this.refreshDisabledStyles(r),this}addWidget(t){return this.getGui().appendChild(t),this}hideOpenCloseIcons(t){return this.suppressOpenCloseIcons=t,t&&this.dispatchExpandChanged(!0),this}refreshDisabledStyles(t){const s=this.getGui();t?(s.classList.add(gC),s.removeAttribute("tabindex")):(s.classList.remove(gC),typeof this.title=="string"?s.setAttribute("tabindex","0"):s.removeAttribute("tabindex"))}};bu.EVENT_EXPAND_CHANGED="expandedChanged";f([Ie("eGroupOpenedIcon")],bu.prototype,"eGroupOpenedIcon",2);f([Ie("eGroupClosedIcon")],bu.prototype,"eGroupClosedIcon",2);f([Ie("eTitle")],bu.prototype,"eTitle",2);f([Ee],bu.prototype,"postConstruct",1);var Db=bu,W0=class extends yp{constructor(e=0,t){super('<div class="ag-menu-list" role="tree"></div>'),this.level=e,this.menuItems=[],this.params=t??{column:null,node:null,value:null}}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.handleFocusIn(e),onFocusOut:e=>this.handleFocusOut(e)})}onTabKeyDown(e){const t=this.getParentComponent(),s=t&&t.getGui();s&&s.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(e){switch(e.key){case z.UP:case z.RIGHT:case z.DOWN:case z.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case z.ESCAPE:this.closeIfIsChild()&&nn(e);break}}handleFocusIn(e){var t,s;const i=e.relatedTarget;!this.tabGuardCtrl.isTabGuard(i)&&(this.getGui().contains(i)||(s=(t=this.activeMenuItem)==null?void 0:t.getSubMenuGui())!=null&&s.contains(i))||(this.activeMenuItem?this.activeMenuItem.activate():this.activateFirstItem())}handleFocusOut(e){var t;const s=e.relatedTarget;!this.activeMenuItem||this.getGui().contains(s)||(t=this.activeMenuItem.getSubMenuGui())!=null&&t.contains(s)||this.activeMenuItem.isSubMenuOpening()||this.activeMenuItem.deactivate()}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(e){e!=null&&ws.all(e.map(t=>t==="separator"?ws.resolve({eGui:this.createSeparator()}):typeof t=="string"?(console.warn(`AG Grid: unrecognised menu item ${t}`),ws.resolve({eGui:null})):this.addItem(t))).then(t=>{t.forEach(s=>{s!=null&&s.eGui&&(this.appendChild(s.eGui),s.comp&&this.menuItems.push(s.comp))})})}addItem(e){const t=this.createManagedBean(new ng);return t.init({menuItemDef:e,isAnotherSubMenuOpen:()=>this.menuItems.some(s=>s.isSubMenuOpen()),level:this.level,contextParams:this.params}).then(()=>(t.setParentComponent(this),this.addManagedListener(t,ng.EVENT_CLOSE_MENU,s=>{this.dispatchEvent(s)}),this.addManagedListener(t,ng.EVENT_MENU_ITEM_ACTIVATED,s=>{this.activeMenuItem&&this.activeMenuItem!==s.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=s.menuItem}),{comp:t,eGui:t.getGui()}))}activateFirstItem(){const e=this.menuItems.filter(t=>!t.isDisabled())[0];e&&e.activate()}createSeparator(){return Oi(`
            <div class="ag-menu-separator" aria-hidden="true">
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
                <div class="ag-menu-separator-part"></div>
            </div>`)}handleNavKey(e){switch(e){case z.UP:case z.DOWN:const s=this.findNextItem(e===z.UP);s&&s!==this.activeMenuItem&&s.activate();return}const t=this.gos.get("enableRtl")?z.RIGHT:z.LEFT;e===t?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const t=this.getParentComponent();return t&&t instanceof ng?(e&&e.preventDefault(),t.closeSubMenu(),t.getGui().focus(),!0):!1}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(e){const t=this.menuItems.filter(r=>!r.isDisabled());if(!t.length)return;if(!this.activeMenuItem)return e?At(t):t[0];e&&t.reverse();let s,i=!1;for(let r=0;r<t.length;r++){const n=t[r];if(!i){n===this.activeMenuItem&&(i=!0);continue}s=n;break}return i&&!s?t[0]:s||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}};f([A("focusService")],W0.prototype,"focusService",2);f([Ee],W0.prototype,"postConstruct",1);var AI=class extends yp{constructor(e){super(),this.wrappedComponent=e,this.setTemplateFromElement(e.getGui())}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===z.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const e=this.parentComponent;e.closeSubMenu(),setTimeout(()=>e.getGui().focus(),0)}};f([Ee],AI.prototype,"postConstruct",1);var Ru=class Xl extends xe{constructor(){super(...arguments),this.isActive=!1,this.subMenuIsOpen=!1,this.subMenuIsOpening=!1,this.suppressRootStyles=!0,this.suppressAria=!0,this.suppressFocus=!0}init(t){var s,i;const{menuItemDef:r,isAnotherSubMenuOpen:n,level:o,childComponent:a,contextParams:l}=t;return this.params=t.menuItemDef,this.level=o,this.isAnotherSubMenuOpen=n,this.childComponent=a,this.contextParams=l,this.cssClassPrefix=(i=(s=this.params.menuItemParams)==null?void 0:s.cssClassPrefix)!=null?i:"ag-menu-option",this.userComponentFactory.getMenuItemCompDetails(this.params,Jt(Je({},r),{level:o,isAnotherSubMenuOpen:n,openSubMenu:h=>this.openSubMenu(h),closeSubMenu:()=>this.closeSubMenu(),closeMenu:h=>this.closeMenu(h),updateTooltip:(h,p)=>this.refreshTooltip(h,p),onItemActivated:()=>this.onItemActivated()})).newAgStackInstance().then(h=>{var p;this.menuItemComp=h;const g=(p=h.configureDefaults)==null?void 0:p.call(h);g&&this.configureDefaults(g===!0?void 0:g)})}addListeners(t,s){s!=null&&s.suppressClick||this.addManagedListener(t,"click",i=>this.onItemSelected(i)),s!=null&&s.suppressKeyboardSelect||this.addManagedListener(t,"keydown",i=>{(i.key===z.ENTER||i.key===z.SPACE)&&(i.preventDefault(),this.onItemSelected(i))}),s!=null&&s.suppressMouseDown||this.addManagedListener(t,"mousedown",i=>{i.stopPropagation(),i.preventDefault()}),s!=null&&s.suppressMouseOver||(this.addManagedListener(t,"mouseenter",()=>this.onMouseEnter()),this.addManagedListener(t,"mouseleave",()=>this.onMouseLeave()))}isDisabled(){return!!this.params.disabled}openSubMenu(t=!1){var s,i;if(this.closeSubMenu(),!this.params.subMenu)return;this.subMenuIsOpening=!0;const r=Oi('<div class="ag-menu" role="presentation"></div>');this.eSubMenuGui=r;let n,o=()=>{this.subMenuIsOpening=!1};if(this.childComponent){const h=this.createBean(new AI(this.childComponent));h.setParentComponent(this);const p=h.getGui(),g="mouseenter",m=()=>this.cancelDeactivate();p.addEventListener(g,m),n=()=>p.removeEventListener(g,m),r.appendChild(p),this.childComponent.afterGuiAttached&&(o=()=>{this.childComponent.afterGuiAttached(),this.subMenuIsOpening=!1})}else if(this.params.subMenu){const h=this.createBean(new W0(this.level+1,this.contextParams));h.setParentComponent(this),h.addMenuItems(this.params.subMenu),r.appendChild(h.getGui()),this.addManagedListener(h,Xl.EVENT_CLOSE_MENU,p=>this.dispatchEvent(p)),h.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),n=()=>this.destroyBean(h),t&&(o=()=>{h.activateFirstItem(),this.subMenuIsOpening=!1})}const a=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:this.eGui,ePopup:r}),l=this.localeService.getLocaleTextFunc(),u=this.popupService.addPopup({modal:!0,eChild:r,positionCallback:a,anchorToElement:this.eGui,ariaLabel:l("ariaLabelSubMenu","SubMenu"),afterGuiAttached:o});this.subMenuIsOpen=!0,this.setAriaExpanded(!0),this.hideSubMenu=()=>{var h,p;u&&u.hideFunc(),this.subMenuIsOpen=!1,this.setAriaExpanded(!1),n(),(p=(h=this.menuItemComp).setExpanded)==null||p.call(h,!1),this.eSubMenuGui=void 0},(i=(s=this.menuItemComp).setExpanded)==null||i.call(s,!0)}setAriaExpanded(t){this.suppressAria||Jn(this.eGui,t)}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,this.setAriaExpanded(!1))}isSubMenuOpen(){return this.subMenuIsOpen}isSubMenuOpening(){return this.subMenuIsOpening}activate(t){var s,i;this.cancelActivate(),!this.params.disabled&&(this.isActive=!0,this.suppressRootStyles||this.eGui.classList.add(`${this.cssClassPrefix}-active`),(i=(s=this.menuItemComp).setActive)==null||i.call(s,!0),this.suppressFocus||this.eGui.focus({preventScroll:!0}),t&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){var t,s;this.cancelDeactivate(),this.suppressRootStyles||this.eGui.classList.remove(`${this.cssClassPrefix}-active`),(s=(t=this.menuItemComp).setActive)==null||s.call(t,!1),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}getGui(){return this.menuItemComp.getGui()}getParentComponent(){return this.parentComponent}setParentComponent(t){this.parentComponent=t}getSubMenuGui(){return this.eSubMenuGui}onItemSelected(t){var s,i;(i=(s=this.menuItemComp).select)==null||i.call(s),this.params.action?this.getFrameworkOverrides().wrapOutgoing(()=>this.params.action(this.gos.addGridCommonParams(Je({},this.contextParams)))):this.openSubMenu(t&&t.type==="keydown"),!(this.params.subMenu&&!this.params.action||this.params.suppressCloseOnSelect)&&this.closeMenu(t)}closeMenu(t){const s={type:Xl.EVENT_CLOSE_MENU};t&&(t instanceof MouseEvent?s.mouseEvent=t:s.keyboardEvent=t),this.dispatchEvent(s)}onItemActivated(){const t={type:Xl.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(t)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),Xl.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),Xl.ACTIVATION_DELAY):this.deactivate()}configureDefaults(t){var s,i,r;if(!this.menuItemComp){setTimeout(()=>this.configureDefaults(t));return}let n=this.menuItemComp.getGui();const o=(i=(s=this.menuItemComp).getRootElement)==null?void 0:i.call(s);o&&(t!=null&&t.suppressRootStyles||n.classList.add("ag-menu-option-custom"),n=o),this.eGui=n,this.suppressRootStyles=!!(t!=null&&t.suppressRootStyles),this.suppressRootStyles||(n.classList.add(this.cssClassPrefix),(r=this.params.cssClasses)==null||r.forEach(a=>n.classList.add(a)),this.params.disabled&&n.classList.add(`${this.cssClassPrefix}-disabled`)),t!=null&&t.suppressTooltip||this.refreshTooltip(this.params.tooltip),this.suppressAria=!!(t!=null&&t.suppressAria),this.suppressAria||(cs(n,"treeitem"),VA(n,this.level+1),this.params.disabled&&e0(n,!0)),t!=null&&t.suppressTabIndex||n.setAttribute("tabindex","-1"),this.params.disabled||this.addListeners(n,t),this.suppressFocus=!!(t!=null&&t.suppressFocus)}refreshTooltip(t,s){this.tooltip=t,this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),!(!t||!this.menuItemComp)&&(this.tooltipFeature=this.createBean(new lo({getGui:()=>this.getGui(),getTooltipValue:()=>this.tooltip,getLocation:()=>"menu",shouldDisplayTooltip:s})))}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}};Ru.EVENT_CLOSE_MENU="closeMenu";Ru.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated";Ru.ACTIVATION_DELAY=80;f([A("popupService")],Ru.prototype,"popupService",2);f([A("userComponentFactory")],Ru.prototype,"userComponentFactory",2);var ng=Ru,Bl=class cw extends ot{constructor(t){super(cw.getTemplate(t)),this.config=t,this.closable=!0}static getTemplate(t){const s=t.cssIdentifier||"default";return`<div class="ag-panel ag-${s}-panel" tabindex="-1">
            <div ref="eTitleBar" class="ag-panel-title-bar ag-${s}-panel-title-bar ag-unselectable">
                <span ref="eTitle" class="ag-panel-title-bar-title ag-${s}-panel-title-bar-title"></span>
                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${s}-panel-title-bar-buttons"></div>
            </div>
            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-${s}-panel-content-wrapper"></div>
        </div>`}postConstruct(){const{component:t,closable:s,hideTitleBar:i,title:r,minWidth:n=250,width:o,minHeight:a=250,height:l,centered:u,popup:h,x:p,y:g}=this.config;this.positionableFeature=new gu(this.getGui(),{minWidth:n,width:o,minHeight:a,height:l,centered:u,x:p,y:g,popup:h,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const m=this.getGui();t&&this.setBodyComponent(t),i?Et(this.eTitleBar,!1):(r&&this.setTitle(r),this.setClosable(s??this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",C=>{if(m.contains(C.relatedTarget)||m.contains(this.gos.getActiveDomElement())||this.eTitleBarButtons.contains(C.target)){C.preventDefault();return}const y=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");y&&y.focus()}),!(h&&this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const t=this.getGui();t.focus(),this.close=()=>{t.parentElement.removeChild(t),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(t){this.positionableFeature.setHeight(t)}getWidth(){return this.positionableFeature.getWidth()}setWidth(t){this.positionableFeature.setWidth(t)}setClosable(t){if(t!==this.closable&&(this.closable=t),t){const s=this.closeButtonComp=new ot(cw.CLOSE_BTN_TEMPLATE);this.getContext().createBean(s);const i=s.getGui(),r=rs("close",this.gos);r.classList.add("ag-panel-title-bar-button-icon"),i.appendChild(r),this.addTitleBarButton(s),s.addManagedListener(i,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){const s=this.closeButtonComp.getGui();s.parentElement.removeChild(s),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(t){t.setParentComponent(this),this.eContentWrapper.appendChild(t.getGui())}addTitleBarButton(t,s){const i=this.eTitleBarButtons,r=i.children,n=r.length;s==null&&(s=n),s=Math.max(0,Math.min(s,n)),t.addCssClass("ag-panel-title-bar-button");const o=t.getGui();s===0?i.insertAdjacentElement("afterbegin",o):s===n?i.insertAdjacentElement("beforeend",o):r[s-1].insertAdjacentElement("afterend",o),t.setParentComponent(this)}getBodyHeight(){return lp(this.eContentWrapper)}getBodyWidth(){return Il(this.eContentWrapper)}setTitle(t){this.eTitle.innerText=t}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const t=this.getGui();t&&ji(t)&&this.close(),super.destroy()}};Bl.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>';f([Ie("eContentWrapper")],Bl.prototype,"eContentWrapper",2);f([Ie("eTitleBar")],Bl.prototype,"eTitleBar",2);f([Ie("eTitleBarButtons")],Bl.prototype,"eTitleBarButtons",2);f([Ie("eTitle")],Bl.prototype,"eTitle",2);f([Ee],Bl.prototype,"postConstruct",1);var zG=Bl,UG=class extends zG{constructor(e){super(Jt(Je({},e),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}postConstruct(){const e=this.getGui(),{movable:t,resizable:s,maximizable:i}=this.config;this.addCssClass("ag-dialog"),super.postConstruct(),this.addManagedListener(e,"focusin",r=>{this.popupService.bringPopupToFront(e)}),t&&this.setMovable(t),i&&this.setMaximizable(i),s&&this.setResizable(s)}renderComponent(){const e=this.getGui(),{alwaysOnTop:t,modal:s,title:i,afterGuiAttached:r}=this.config,n=this.localeService.getLocaleTextFunc(),o=this.popupService.addPopup({modal:s,eChild:e,closeOnEsc:!0,closedCallback:this.onClosed.bind(this),alwaysOnTop:t,ariaLabel:i||n("ariaLabelDialog","Dialog"),afterGuiAttached:r});o&&(this.close=o.hideFunc)}onClosed(e){var t,s;this.destroy(),(s=(t=this.config).closedCallback)==null||s.call(t,e)}toggleMaximize(){const e=this.positionableFeature.getPosition();if(this.isMaximized){const{x:t,y:s,width:i,height:r}=this.lastPosition;this.setWidth(i),this.setHeight(r),this.positionableFeature.offsetElement(t,s)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=e.x,this.lastPosition.y=e.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){Et(this.maximizeIcon,!this.isMaximized),Et(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(e=>e()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(e){this.positionableFeature.setResizable(e)}setMovable(e){this.positionableFeature.setMovable(e,this.eTitleBar)}setMaximizable(e){if(!e){this.clearMaximizebleListeners(),this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0);return}const t=this.eTitleBar;if(!t||e===this.isMaximizable)return;const s=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),s.addManagedListener(s.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(s,0),this.maximizeListeners.push(this.addManagedListener(t,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",()=>{this.isMaximized=!1,this.refreshMaximizeIcon()})}buildMaximizeAndMinimizeElements(){const e=this.maximizeButtonComp=this.createBean(new ot('<div class="ag-dialog-button"></span>')),t=e.getGui();return this.maximizeIcon=rs("maximize",this.gos),t.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=rs("minimize",this.gos),t.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),e}};f([A("popupService")],UG.prototype,"popupService",2);var $G=0,Xn=class extends xe{constructor(){super(...arguments),this.popupList=[]}postConstruct(){this.ctrlsService.whenReady(e=>{this.gridCtrl=e.gridCtrl}),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.handleThemeChange.bind(this))}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:s}=e,i=this.getPopupIndex(s);if(i!==-1){const m=this.popupList[i];m.alignedToElement=t}const r=t.getBoundingClientRect(),n=this.getParentRect(),o=this.keepXYWithinBounds(s,r.top-n.top,0),a=s.clientWidth>0?s.clientWidth:200;s.style.minWidth=`${a}px`;const u=n.right-n.left-a;let h;this.gos.get("enableRtl")?(h=g(),h<0&&(h=p(),this.setAlignedStyles(s,"left")),h>u&&(h=0,this.setAlignedStyles(s,"right"))):(h=p(),h>u&&(h=g(),this.setAlignedStyles(s,"right")),h<0&&(h=0,this.setAlignedStyles(s,"left"))),s.style.left=`${h}px`,s.style.top=`${o}px`;function p(){return r.right-n.left-2}function g(){return r.left-n.left-a}}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:s,nudgeY:i,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:s,nudgeY:i,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:s,nudgeY:i,keepWithinBounds:r,eventSource:n,alignSide:o="left",position:a="over",column:l,rowNode:u,type:h}=e,p=n.getBoundingClientRect(),g=this.getParentRect(),m=this.getPopupIndex(t);if(m!==-1){const y=this.popupList[m];y.alignedToElement=n}const C=()=>{let y=p.left-g.left;o==="right"&&(y-=t.offsetWidth-p.width);let R;return a==="over"?(R=p.top-g.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,p,g,e.nudgeY||0)==="under"?R=p.top-g.top+p.height:R=p.top-t.offsetHeight-(i||0)*2-g.top),{x:y,y:R}};this.positionPopup({ePopup:t,nudgeX:s,nudgeY:i,keepWithinBounds:r,updatePosition:C,postProcessCallback:()=>this.callPostProcessPopup(h,t,n,null,l,u)})}shouldRenderUnderOrAbove(e,t,s,i){const r=s.bottom-t.bottom,n=t.top-s.top,o=e.offsetHeight+i;return r>o?"under":n>o||n>r?"above":"under"}setAlignedStyles(e,t){const s=this.getPopupIndex(e);if(s===-1)return;const i=this.popupList[s],{alignedToElement:r}=i;!r||(["right","left","over","above","under"].forEach(o=>{r.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`)}),!t)||(r.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}callPostProcessPopup(e,t,s,i,r,n){const o=this.gos.getCallback("postProcessPopup");o&&o({column:r,rowNode:n,ePopup:t,type:e,eventSource:s,mouseEvent:i})}positionPopup(e){const{ePopup:t,keepWithinBounds:s,nudgeX:i,nudgeY:r,skipObserver:n,updatePosition:o}=e,a={width:0,height:0},l=(u=!1)=>{let{x:h,y:p}=o();u&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,i&&(h+=i),r&&(p+=r),s&&(h=this.keepXYWithinBounds(t,h,1),p=this.keepXYWithinBounds(t,p,0)),t.style.left=`${h}px`,t.style.top=`${p}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!n){const u=this.resizeObserverService.observeResize(t,()=>l(!0));setTimeout(()=>u(),Xn.WAIT_FOR_POPUP_CONTENT_RESIZE)}}getActivePopups(){return this.popupList.map(e=>e.element)}getPopupList(){return this.popupList}getParentRect(){const e=this.gos.getDocument();let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),g0(t)}keepXYWithinBounds(e,t,s){const i=s===0,r=i?"clientHeight":"clientWidth",n=i?"top":"left",o=i?"offsetHeight":"offsetWidth",a=i?"scrollTop":"scrollLeft",l=this.gos.getDocument(),u=l.documentElement,h=this.getPopupParent(),p=h.getBoundingClientRect(),g=l.documentElement.getBoundingClientRect(),m=h===l.body,C=e[o];let R=m?(i?p0:lh)(u)+u[a]:h[r];m&&(R-=Math.abs(g[n]-p[n]));const x=R-C;return Math.min(Math.max(t,0),Math.abs(x))}addPopup(e){const t=this.gos.getDocument(),{eChild:s,ariaLabel:i,alwaysOnTop:r,positionCallback:n,anchorToElement:o}=e;if(!t)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(s);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(s);const l=this.createPopupWrapper(s,i,!!r),u=this.addEventListenersToPopup(Jt(Je({},e),{wrapperEl:l}));return n&&n(),this.addPopupToPopupList(s,l,u,o),{hideFunc:u}}initialisePopupPosition(e){const s=this.getPopupParent().getBoundingClientRect();Ce(e.style.top)||(e.style.top=`${s.top*-1}px`),Ce(e.style.left)||(e.style.left=`${s.left*-1}px`)}createPopupWrapper(e,t,s){const i=this.getPopupParent(),r=document.createElement("div"),{allThemes:n}=this.environment.getTheme();return n.length&&r.classList.add(...n),r.classList.add("ag-popup"),e.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||cs(e,"dialog"),or(e,t),r.appendChild(e),i.appendChild(r),s?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),r}handleThemeChange(){const{allThemes:e}=this.environment.getTheme();for(const t of this.popupList){for(const s of Array.from(t.wrapper.classList))s.startsWith("ag-theme-")&&t.wrapper.classList.remove(s);e.length&&t.wrapper.classList.add(...e)}}addEventListenersToPopup(e){const t=this.gos.getDocument(),s=this.getPopupParent(),{wrapperEl:i,eChild:r,closedCallback:n,afterGuiAttached:o,closeOnEsc:a,modal:l}=e;let u=!1;const h=C=>{if(!i.contains(this.gos.getActiveDomElement()))return;C.key===z.ESCAPE&&!en(C)&&m({keyboardEvent:C})},p=C=>m({mouseEvent:C}),g=C=>m({touchEvent:C}),m=(C={})=>{const{mouseEvent:y,touchEvent:R,keyboardEvent:x,forceHide:S}=C;!S&&(this.isEventFromCurrentPopup({mouseEvent:y,touchEvent:R},r)||u)||(u=!0,s.removeChild(i),t.removeEventListener("keydown",h),t.removeEventListener("mousedown",p),t.removeEventListener("touchstart",g),t.removeEventListener("contextmenu",p),this.eventService.removeEventListener(w.EVENT_DRAG_STARTED,p),n&&n(y||R||x),this.removePopupFromPopupList(r))};return o&&o({hidePopup:m}),window.setTimeout(()=>{a&&t.addEventListener("keydown",h),l&&(t.addEventListener("mousedown",p),this.eventService.addEventListener(w.EVENT_DRAG_STARTED,p),t.addEventListener("touchstart",g),t.addEventListener("contextmenu",p))},0),m}addPopupToPopupList(e,t,s,i){this.popupList.push({element:e,wrapper:t,hideFunc:s,instanceId:$G++,isAnchored:!!i}),i&&this.setPopupPositionRelatedToElement(e,i)}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const s=this.getPopupIndex(e);if(s===-1)return;const i=this.popupList[s];if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then(n=>n&&n()),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!t)return;const r=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:i.hideFunc});return i.stopAnchoringPromise=r,i.isAnchored=!0,r}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter(t=>t.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),s=t.getBoundingClientRect(),{element:i,ePopup:r}=e,n=i.getBoundingClientRect(),o=s.top-n.top,a=s.left-n.left;let l=o,u=a;const h=r.style.top,p=parseInt(h.substring(0,h.length-1),10),g=r.style.left,m=parseInt(g.substring(0,g.length-1),10);return new ws(C=>{this.getFrameworkOverrides().setInterval(()=>{const y=t.getBoundingClientRect(),R=i.getBoundingClientRect();if(R.top==0&&R.left==0&&R.height==0&&R.width==0){e.hidePopup();return}const S=y.top-R.top;if(S!=l){const I=this.keepXYWithinBounds(r,p+o-S,0);r.style.top=`${I}px`}l=S;const T=y.left-R.left;if(T!=u){const I=this.keepXYWithinBounds(r,m+a-T,1);r.style.left=`${I}px`}u=T},200).then(y=>{C(()=>{y!=null&&window.clearInterval(y)})})})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:s,touchEvent:i}=e,r=s||i;if(!r)return!1;const n=this.getPopupIndex(t);if(n===-1)return!1;for(let o=n;o<this.popupList.length;o++){const a=this.popupList[o];if(xf(a.element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){const t=this.gos.getDocument();for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const s=this.getWrapper(e);s&&(s.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(s))}bringPopupToFront(e){const t=this.getPopupParent(),s=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),i=s.length,r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup.ag-always-on-top")),n=r.length,o=this.getWrapper(e);if(!o||i<=1||!t.contains(e))return;const a=s.indexOf(o),l=o.querySelectorAll("div"),u=[];for(l.forEach(h=>{h.scrollTop!==0&&u.push([h,h.scrollTop])}),n?o.classList.contains("ag-always-on-top")?a!==i-1&&At(r).insertAdjacentElement("afterend",o):a!==i-n-1&&r[0].insertAdjacentElement("beforebegin",o):a!==i-1&&At(s).insertAdjacentElement("afterend",o);u.length;){const h=u.pop();h[0].scrollTop=h[1]}}};Xn.WAIT_FOR_POPUP_CONTENT_RESIZE=200;f([A("focusService")],Xn.prototype,"focusService",2);f([A("ctrlsService")],Xn.prototype,"ctrlsService",2);f([A("resizeObserverService")],Xn.prototype,"resizeObserverService",2);f([Ee],Xn.prototype,"postConstruct",1);Xn=f([je("popupService")],Xn);var KG=class extends ot{constructor(){super(`
        <div class="ag-autocomplete-row" role="presentation">
            <div class="ag-autocomplete-row-label"></div>
        </div>`),this.hasHighlighting=!1}setState(e,t){this.value=e,this.render(),this.updateSelected(t)}updateSelected(e){this.addOrRemoveCssClass("ag-autocomplete-row-selected",e)}setSearchString(e){var t;let s=!1;if(Ce(e)){const i=(t=this.value)==null?void 0:t.toLocaleLowerCase().indexOf(e.toLocaleLowerCase());if(i>=0){s=!0,this.hasHighlighting=!0;const r=i+e.length,n=ys(this.value.slice(0,i)),o=ys(this.value.slice(i,r)),a=ys(this.value.slice(r));this.getGui().lastElementChild.innerHTML=`${n}<b>${o}</b>${a}`}}!s&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())}render(){var e;this.getGui().lastElementChild.innerHTML=(e=ys(this.value))!=null?e:"&nbsp;"}},cv=class FI extends kl{constructor(t){super(FI.TEMPLATE),this.params=t,this.searchString=""}destroy(){super.destroy()}init(){this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new DI({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:()=>this.autocompleteEntries.length,getRow:s=>this.autocompleteEntries[s]});const t=this.virtualList.getGui();this.addManagedListener(t,"click",()=>this.params.onConfirmed()),this.addManagedListener(t,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(t,"mousedown",s=>s.preventDefault()),this.setSelectedValue(0)}onNavigationKeyDown(t,s){t.preventDefault();const i=this.autocompleteEntries.indexOf(this.selectedValue),r=s===z.UP?i-1:i+1;this.checkSetSelectedValue(r)}setSearch(t){this.searchString=t,Ce(t)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()}runContainsSearch(t,s){let i,r=!1;const n=t.toLocaleLowerCase(),o=s.filter(a=>{const u=a.toLocaleLowerCase().indexOf(n),h=u===0,p=u>=0;return p&&(!i||!r&&h||r===h&&a.length<i.length)&&(i=a,r=h),p});return!i&&o.length&&(i=o[0]),{topMatch:i,allMatches:o}}runSearch(){var t,s;const{autocompleteEntries:i}=this.params,r=i.map(u=>{var h;return(h=u.displayValue)!=null?h:u.key});let n,o;if(this.params.useFuzzySearch)n=up(this.searchString,r,!0).values,o=n.length?n[0]:void 0;else{const u=this.runContainsSearch(this.searchString,r);n=u.allMatches,o=u.topMatch}let a=i.filter(({key:u,displayValue:h})=>n.includes(h??u));if(!a.length&&this.selectedValue&&((s=(t=this.params)==null?void 0:t.forceLastSelection)!=null&&s.call(t,this.selectedValue,this.searchString))&&(a=[this.selectedValue]),this.autocompleteEntries=a,this.virtualList.refresh(),!o)return;const l=n.indexOf(o);this.checkSetSelectedValue(l)}updateSearchInList(){this.virtualList.forEachRenderedRow(t=>t.setSearchString(this.searchString))}checkSetSelectedValue(t){t>=0&&t<this.autocompleteEntries.length&&this.setSelectedValue(t)}setSelectedValue(t){const s=this.autocompleteEntries[t];this.selectedValue!==s&&(this.selectedValue=s,this.virtualList.ensureIndexVisible(t),this.virtualList.forEachRenderedRow((i,r)=>{i.updateSelected(t===r)}))}createRowComponent(t){var s;const i=new KG;return this.getContext().createBean(i),i.setState((s=t.displayValue)!=null?s:t.key,t===this.selectedValue),i}onMouseMove(t){const s=this.virtualList.getGui().getBoundingClientRect(),i=this.virtualList.getScrollTop(),r=t.clientY-s.top+i,n=Math.floor(r/this.virtualList.getRowHeight());this.checkSetSelectedValue(n)}afterGuiAttached(){this.virtualList.refresh()}getSelectedValue(){var t;return this.autocompleteEntries.length&&(t=this.selectedValue)!=null?t:null}};cv.TEMPLATE=`<div class="ag-autocomplete-list-popup">
            <div ref="eList" class="ag-autocomplete-list"></div>
        <div>`;f([Ie("eList")],cv.prototype,"eList",2);f([Ee],cv.prototype,"init",1);var YG=cv,ma=class hd extends ot{constructor(){super(`
            <div class="ag-autocomplete" role="presentation">
                <ag-input-text-field ref="eAutocompleteInput"></ag-input-text-field>
            </div>`),this.isListOpen=!1,this.lastPosition=0,this.valid=!0}postConstruct(){this.eAutocompleteInput.onValueChange(t=>this.onValueChanged(t)),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc(()=>{this.destroyBean(this.autocompleteList)}),this.addGuiEventListener("focusout",()=>this.onFocusOut())}onValueChanged(t){const s=Rn(t);this.updateValue(s),this.updateAutocompleteList(s)}updateValue(t){this.updateLastPosition(),this.dispatchEvent({type:hd.EVENT_VALUE_CHANGED,value:t}),this.validate(t)}updateAutocompleteList(t){var s,i,r,n;const o=(i=(s=this.listGenerator)==null?void 0:s.call(this,t,this.lastPosition))!=null?i:{enabled:!1};if((!o.type||o.type!==((r=this.autocompleteListParams)==null?void 0:r.type))&&this.isListOpen&&this.closeList(),this.autocompleteListParams=o,(n=this.autocompleteListParams)!=null&&n.enabled){this.isListOpen||this.openList();const{searchString:a}=this.autocompleteListParams;this.autocompleteList.setSearch(a??"")}else this.isListOpen&&this.closeList()}onKeyDown(t){const s=t.key;switch(this.updateLastPosition(),s){case z.ENTER:this.onEnterKeyDown(t);break;case z.TAB:this.onTabKeyDown(t);break;case z.DOWN:case z.UP:this.onUpDownKeyDown(t,s);break;case z.LEFT:case z.RIGHT:case z.PAGE_HOME:case z.PAGE_END:setTimeout(()=>{this.updatePositionAndList()});break;case z.ESCAPE:this.onEscapeKeyDown(t);break;case z.SPACE:t.ctrlKey&&!this.isListOpen&&(t.preventDefault(),this.forceOpenList());break}}confirmSelection(){var t;const s=(t=this.autocompleteList)==null?void 0:t.getSelectedValue();s&&(this.closeList(),this.dispatchEvent({type:hd.EVENT_OPTION_SELECTED,value:this.getValue(),position:this.lastPosition,updateEntry:s,autocompleteType:this.autocompleteListParams.type}))}onTabKeyDown(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.confirmSelection())}onEnterKeyDown(t){t.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()}onUpDownKeyDown(t,s){var i;t.preventDefault(),this.isListOpen?(i=this.autocompleteList)==null||i.onNavigationKeyDown(t,s):this.forceOpenList()}onEscapeKeyDown(t){this.isListOpen&&(t.preventDefault(),t.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))}onFocusOut(){this.isListOpen&&this.closeList()}updatePositionAndList(){var t;this.updateLastPosition(),this.updateAutocompleteList((t=this.eAutocompleteInput.getValue())!=null?t:null)}setCaret(t,s){const i=this.gos.getDocument(),r=this.gos.getActiveDomElement();s&&(!r||r===i.body)&&this.eAutocompleteInput.getFocusableElement().focus();const n=this.eAutocompleteInput.getInputElement();n.setSelectionRange(t,t),t===n.value.length&&(n.scrollLeft=n.scrollWidth)}forceOpenList(){this.onValueChanged(this.eAutocompleteInput.getValue())}updateLastPosition(){var t;this.lastPosition=(t=this.eAutocompleteInput.getInputElement().selectionStart)!=null?t:0}validate(t){var s;this.validator&&(this.validationMessage=this.validator(t),this.eAutocompleteInput.getInputElement().setCustomValidity((s=this.validationMessage)!=null?s:""),this.valid=!this.validationMessage,this.dispatchEvent({type:hd.EVENT_VALID_CHANGED,isValid:this.valid,validationMessage:this.validationMessage}))}openList(){this.isListOpen=!0,this.autocompleteList=this.createBean(new YG({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:()=>this.confirmSelection(),forceLastSelection:this.forceLastSelection}));const t=this.autocompleteList.getGui(),s={ePopup:t,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gos.get("enableRtl")?"right":"left",keepWithinBounds:!0},i=this.popupService.addPopup({eChild:t,anchorToElement:this.getGui(),positionCallback:()=>this.popupService.positionPopupByComponent(s),ariaLabel:this.listAriaLabel});this.hidePopup=i.hideFunc,this.autocompleteList.afterGuiAttached()}closeList(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null}onCompleted(){this.isListOpen&&this.closeList(),this.dispatchEvent({type:hd.EVENT_VALUE_CONFIRMED,value:this.getValue(),isValid:this.isValid()})}getValue(){return Rn(this.eAutocompleteInput.getValue())}setInputPlaceholder(t){return this.eAutocompleteInput.setInputPlaceholder(t),this}setInputAriaLabel(t){return this.eAutocompleteInput.setInputAriaLabel(t),this}setListAriaLabel(t){return this.listAriaLabel=t,this}setListGenerator(t){return this.listGenerator=t,this}setValidator(t){return this.validator=t,this}isValid(){return this.valid}setValue(t){const{value:s,position:i,silent:r,updateListOnlyIfOpen:n,restoreFocus:o}=t;this.eAutocompleteInput.setValue(s,!0),this.setCaret(i??this.lastPosition,o),r||this.updateValue(s),(!n||this.isListOpen)&&this.updateAutocompleteList(s)}setForceLastSelection(t){return this.forceLastSelection=t,this}setInputDisabled(t){return this.eAutocompleteInput.setDisabled(t),this}};ma.EVENT_VALUE_CHANGED="eventValueChanged";ma.EVENT_VALUE_CONFIRMED="eventValueConfirmed";ma.EVENT_OPTION_SELECTED="eventOptionSelected";ma.EVENT_VALID_CHANGED="eventValidChanged";f([A("popupService")],ma.prototype,"popupService",2);f([Ie("eAutocompleteInput")],ma.prototype,"eAutocompleteInput",2);f([Ee],ma.prototype,"postConstruct",1);var qG=ma,va=class Ig extends ot{constructor(t,s,i,r){super(),this.dragSourceDropTarget=t,this.ghost=s,this.horizontal=i,this.template=r}init(){var t;this.setTemplate((t=this.template)!=null?t:Ig.TEMPLATE);const s=this.getGui();this.addElementClasses(s),this.addElementClasses(this.eDragHandle,"drag-handle"),this.addElementClasses(this.eText,"text"),this.addElementClasses(this.eButton,"button"),this.eDragHandle.appendChild(rs("columnDrag",this.gos)),this.eButton.appendChild(rs("cancel",this.gos)),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const t=this.localeService.getLocaleTextFunc(),s=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(s,t),or(this.getGui(),s.join(". "))}addAdditionalAriaInstructions(t,s){if(this.isRemovable()){const i=s("ariaDropZoneColumnComponentDescription","Press DELETE to remove");t.push(i)}}setupTooltip(){const t=()=>{const s=this.getTooltip();this.setTooltip({newTooltipText:s})};t(),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,t)}getDragSourceId(){}getDefaultIconName(){return at.ICON_NOT_ALLOWED}addDragSource(){const{dragAndDropService:t,eDragHandle:s}=this,i=this.createGetDragItem(),r=this.getDefaultIconName(),n={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:s,getDefaultIconName:()=>r,getDragItem:i,dragItemName:this.getDisplayName()};t.addDragSource(n,!0),this.addDestroyFunc(()=>t.removeDragSource(n))}setupComponents(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){Et(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const t={type:Ig.EVENT_COLUMN_REMOVE};this.addGuiEventListener("keydown",i=>this.onKeyDown(i)),this.addManagedListener(this.eButton,"click",i=>{this.dispatchEvent(t),i.stopPropagation()});const s=new ks(this.eButton);this.addManagedListener(s,ks.EVENT_TAP,()=>{this.dispatchEvent(t)}),this.addDestroyFunc(s.destroy.bind(s))}onKeyDown(t){t.key===z.DELETE&&this.isRemovable()&&(t.preventDefault(),this.dispatchEvent({type:Ig.EVENT_COLUMN_REMOVE}))}getDisplayValue(){return this.getDisplayName()}setTextValue(){const t=this.getDisplayValue(),s=ys(t);this.eText.innerHTML=s}addElementClasses(t,s){s=s?`-${s}`:"";const i=this.horizontal?"horizontal":"vertical";t.classList.add(`ag-column-drop-cell${s}`,`ag-column-drop-${i}-cell${s}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}};va.EVENT_COLUMN_REMOVE="columnRemove";va.TEMPLATE=`<span role="option">
          <span ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>
          <span ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>
          <span ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>
        </span>`;f([A("dragAndDropService")],va.prototype,"dragAndDropService",2);f([Ie("eText")],va.prototype,"eText",2);f([Ie("eDragHandle")],va.prototype,"eDragHandle",2);f([Ie("eButton")],va.prototype,"eButton",2);f([Ee],va.prototype,"init",1);var QG=va,xp=class dn extends ot{constructor(t){super('<div class="ag-unselectable" role="presentation"></div>'),this.horizontal=t,this.state=dn.STATE_NOT_DRAGGING,this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=document.createElement("div"),this.addElementClasses(this.ePillDropList,"list"),cs(this.ePillDropList,"listbox")}isHorizontal(){return this.horizontal}toggleResizable(t){this.positionableFeature.setResizable(t?{bottom:!0}:!1),this.resizeEnabled=t}isSourceEventFromTarget(t){const{dropZoneTarget:s,dragSource:i}=t;return s.contains(i.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach(t=>t()),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,fs(this.getGui()),fs(this.ePillDropList)}init(t){this.params=t??{},this.createManagedBean(new ha(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new gu(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature),this.refreshGui(),or(this.ePillDropList,this.getAriaLabel())}handleKeyDown(t){const s=!this.horizontal;let i=t.key===z.DOWN,r=t.key===z.UP;if(!s){const o=this.gos.get("enableRtl");i=!o&&t.key===z.RIGHT||o&&t.key===z.LEFT,r=!o&&t.key===z.LEFT||o&&t.key===z.RIGHT}if(!i&&!r)return;const n=this.focusService.findNextFocusableElement(this.getFocusableElement(),!1,r);n&&(t.preventDefault(),n.focus())}addElementClasses(t,s){s=s?`-${s}`:"";const i=this.horizontal?"horizontal":"vertical";t.classList.add(`ag-column-drop${s}`,`ag-column-drop-${i}${s}`)}setupDropTarget(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.dragAndDropService.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(t){const s=this.getNewInsertIndex(t);if(s<0)return!1;const i=this.minimumAllowedNewInsertIndex(),r=Math.max(i,s),n=r!==this.insertIndex;return n&&(this.insertIndex=r),n}getNewInsertIndex(t){const s=t.event,i=this.horizontal?s.clientX:s.clientY,r=this.childPillComponents.map(o=>o.getGui().getBoundingClientRect()),n=r.findIndex(o=>this.horizontal?o.right>i&&o.left<i:o.top<i&&o.bottom>i);if(n===-1){const o=this.gos.get("enableRtl");return r.every(u=>i>(this.horizontal?u.right:u.bottom))?o&&this.horizontal?0:this.childPillComponents.length:r.every(u=>i<(this.horizontal?u.left:u.top))?o&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=n?n+1:n}checkDragStartedBySelf(t){this.state===dn.STATE_NOT_DRAGGING&&(this.state=dn.STATE_REARRANGE_ITEMS,this.potentialDndItems=this.getItems(t.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(t),this.refreshGui())}onDragging(t){this.checkDragStartedBySelf(t),this.checkInsertIndex(t)&&this.refreshGui()}handleDragEnterEnd(t){}onDragEnter(t){const s=this.getItems(t.dragSource.getDragItem());this.state=dn.STATE_NEW_ITEMS_IN;const i=s.filter(n=>this.isItemDroppable(n,t)),r=i.every(n=>this.childPillComponents.map(o=>o.getItem()).indexOf(n)!==-1);if(i.length!==0){if(this.potentialDndItems=i,r){this.state=dn.STATE_NOT_DRAGGING;return}this.handleDragEnterEnd(t),this.checkInsertIndex(t),this.refreshGui()}}isPotentialDndItems(){return vA(this.potentialDndItems)}handleDragLeaveEnd(t){}onDragLeave(t){if(this.state===dn.STATE_REARRANGE_ITEMS){const s=this.getItems(t.dragSource.getDragItem());this.removeItems(s)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(t),this.potentialDndItems=[],this.refreshGui()),this.state=dn.STATE_NOT_DRAGGING}refreshOnDragStop(){return!0}onDragStop(){if(this.isPotentialDndItems()){let t=!1;this.state===dn.STATE_NEW_ITEMS_IN?(this.addItems(this.potentialDndItems),t=!0):t=this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],(this.refreshOnDragStop()||!t)&&this.refreshGui()}this.state=dn.STATE_NOT_DRAGGING}removeItems(t){const s=this.getExistingItems().filter(i=>!rr(t,i));this.updateItems(s)}addItems(t){if(!t)return;const s=this.getExistingItems().slice(),i=t.filter(r=>s.indexOf(r)<0);Uy(s,i,this.insertIndex),this.updateItems(s)}addItem(t){this.insertIndex=this.getExistingItems().length,this.addItems([t]),this.refreshGui()}rearrangeItems(t){const s=this.getNonGhostItems().slice();return Uy(s,t,this.insertIndex),wn(s,this.getExistingItems())?!1:(this.updateItems(s),!0)}refreshGui(){const t=this.ePillDropList.scrollTop,s=this.resizeEnabled,i=this.getFocusedItem();let r=this.focusService.findNextFocusableElement();r||(r=this.focusService.findNextFocusableElement(void 0,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),this.isHorizontal()||(this.ePillDropList.scrollTop=t),s&&this.toggleResizable(s),this.focusService.isKeyboardMode()&&this.restoreFocus(i,r)}getFocusedItem(){const t=this.getGui(),s=this.gos.getActiveDomElement();return t.contains(s)?Array.from(t.querySelectorAll(".ag-column-drop-cell")).indexOf(s):-1}restoreFocus(t,s){const i=this.getGui(),r=Array.from(i.querySelectorAll(".ag-column-drop-cell"));if(t===-1)return;r.length===0&&s.focus();const n=Math.min(r.length-1,t),o=r[n];o&&o.focus()}focusList(t){const s=t?this.childPillComponents.length-1:0;this.restoreFocus(s,this.getFocusableElement())}getNonGhostItems(){const t=this.getExistingItems();return this.isPotentialDndItems()?t.filter(s=>!rr(this.potentialDndItems,s)):t}addItemsToGui(){const s=this.getNonGhostItems().map(i=>this.createItemComponent(i,!1));if(this.isPotentialDndItems()){const i=this.potentialDndItems.map(r=>this.createItemComponent(r,!0));this.insertIndex>=s.length?s.push(...i):s.splice(this.insertIndex,0,...i)}this.appendChild(this.ePillDropList),s.forEach((i,r)=>{r>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(i.getGui())}),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){this.childPillComponents.forEach((t,s)=>{const i=t.getGui();Om(i,s+1),Lm(i,this.childPillComponents.length)})}createItemComponent(t,s){const i=this.createPillComponent(t,this.dropTarget,s,this.horizontal);return i.addEventListener(QG.EVENT_COLUMN_REMOVE,this.removeItems.bind(this,[t])),this.context.createBean(i),this.guiDestroyFunctions.push(()=>this.destroyBean(i)),s||this.childPillComponents.push(i),i}addIconAndTitleToGui(){const{title:t,icon:s}=this.params;if(!t||!s)return;const i=document.createElement("div");if(ap(i,!0),this.addElementClasses(i,"title-bar"),this.addElementClasses(s,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingItemsEmpty()),i.appendChild(s),!this.horizontal){const r=document.createElement("span");this.addElementClasses(r,"title"),r.innerHTML=t,i.appendChild(r)}this.appendChild(i)}isExistingItemsEmpty(){return this.getExistingItems().length===0}addEmptyMessageToGui(){const{emptyMessage:t}=this.params;if(!t||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const s=document.createElement("span");s.innerHTML=t,this.addElementClasses(s,"empty-message"),this.ePillDropList.appendChild(s)}addArrow(t){if(this.horizontal){const s=this.gos.get("enableRtl"),i=rs(s?"smallLeft":"smallRight",this.gos);this.addElementClasses(i,"cell-separator"),t.appendChild(i)}}};xp.STATE_NOT_DRAGGING="notDragging";xp.STATE_NEW_ITEMS_IN="newItemsIn";xp.STATE_REARRANGE_ITEMS="rearrangeItems";f([A("focusService")],xp.prototype,"focusService",2);f([A("dragAndDropService")],xp.prototype,"dragAndDropService",2);var ZG=["touchstart","touchend","touchmove","touchcancel"],II=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t()}setInterval(e,t){return new ws(s=>{s(window.setInterval(e,t))})}addEventListener(e,t,s,i){const r=rr(ZG,t);e.addEventListener(t,s,{capture:!!i,passive:r})}get shouldWrapOutgoing(){return!1}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`https://www.ag-grid.com/${this.frameworkName==="solid"?"react":this.frameworkName}-data-grid${e?`/${e}`:""}`}},ia=class extends xe{getNextCellToFocus(e,t,s=!1){return s?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const s=e===z.UP,i=e===z.DOWN,r=e===z.LEFT;let n,o;if(s||i)o=s?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),n=t.column;else{const a=this.columnModel.getAllDisplayedColumns(),l=this.gos.get("enableRtl");o=t.rowIndex,n=r!==l?a[0]:At(a)}return{rowIndex:o,rowPinned:null,column:n}}getNextCellToFocusWithoutCtrlPressed(e,t){let s=t,i=!1;for(;!i;){switch(e){case z.UP:s=this.getCellAbove(s);break;case z.DOWN:s=this.getCellBelow(s);break;case z.RIGHT:this.gos.get("enableRtl")?s=this.getCellToLeft(s):s=this.getCellToRight(s);break;case z.LEFT:this.gos.get("enableRtl")?s=this.getCellToRight(s):s=this.getCellToLeft(s);break;default:s=null,console.warn("AG Grid: unknown key for navigation "+e);break}s?i=this.isCellGoodToFocusOn(s):i=!0}return s}isCellGoodToFocusOn(e){const t=e.column;let s;switch(e.rowPinned){case"top":s=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":s=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:s=this.rowModel.getRow(e.rowIndex);break}return s?!t.isSuppressNavigable(s):!1}getCellToLeft(e){if(!e)return null;const t=this.columnModel.getDisplayedColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.columnModel.getDisplayedColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,s=e.rowPinned;if(this.isLastRowInContainer(e))switch(s){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const i=this.rowModel.getRow(e.rowIndex),r=this.getNextStickyPosition(i);return r||{rowIndex:t+1,rowPinned:s}}getNextStickyPosition(e,t){if(!this.gos.isGroupRowsSticky()||!e||!e.sticky)return;const s=this.rowRenderer.getStickyTopRowCtrls().some(a=>a.getRowNode().rowIndex===e.rowIndex);let i=[];s?i=[...this.rowRenderer.getStickyTopRowCtrls()].sort((a,l)=>a.getRowNode().rowIndex-l.getRowNode().rowIndex):i=[...this.rowRenderer.getStickyBottomRowCtrls()].sort((a,l)=>l.getRowNode().rowIndex-a.getRowNode().rowIndex);const r=t?-1:1,n=i.findIndex(a=>a.getRowNode().rowIndex===e.rowIndex),o=i[n+r];if(o)return{rowIndex:o.getRowNode().rowIndex,rowPinned:null}}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,s=e.rowIndex;return t==="top"?this.pinnedRowModel.getPinnedTopRowData().length-1<=s:t==="bottom"?this.pinnedRowModel.getPinnedBottomRowData().length-1<=s:this.paginationProxy.getPageLastRow()<=s}getRowAbove(e){const t=e.rowIndex,s=e.rowPinned;if(s?t===0:t===this.paginationProxy.getPageFirstRow())return s==="top"?null:s?this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null:this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const r=this.rowModel.getRow(e.rowIndex),n=this.getNextStickyPosition(r,!0);return n||{rowIndex:t-1,rowPinned:s}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const t=this.columnModel.getAllDisplayedColumns();let s=e.rowIndex,i=e.rowPinned,r=this.columnModel.getDisplayedColAfter(e.column);if(!r){r=t[0];const n=this.getRowBelow(e);if(nt(n)||!n.rowPinned&&!this.paginationProxy.isRowInPage(n))return null;s=n?n.rowIndex:null,i=n?n.rowPinned:null}return{rowIndex:s,column:r,rowPinned:i}}getNextTabbedCellBackwards(e){const t=this.columnModel.getAllDisplayedColumns();let s=e.rowIndex,i=e.rowPinned,r=this.columnModel.getDisplayedColBefore(e.column);if(!r){r=At(t);const n=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(nt(n)||!n.rowPinned&&!this.paginationProxy.isRowInPage(n))return null;s=n?n.rowIndex:null,i=n?n.rowPinned:null}return{rowIndex:s,column:r,rowPinned:i}}};f([A("columnModel")],ia.prototype,"columnModel",2);f([A("rowModel")],ia.prototype,"rowModel",2);f([A("rowRenderer")],ia.prototype,"rowRenderer",2);f([A("pinnedRowModel")],ia.prototype,"pinnedRowModel",2);f([A("paginationProxy")],ia.prototype,"paginationProxy",2);ia=f([je("cellNavigationService")],ia);var wl=class extends xe{constructor(){super(...arguments),this.consuming=!1}setBeans(e){this.logger=e.create("AlignedGridsService")}getAlignedGridApis(){var e;let t=(e=this.gos.get("alignedGrids"))!=null?e:[];const s=typeof t=="function";typeof t=="function"&&(t=t());const i=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return t.map(n=>{var o;if(!n){Ua("alignedGrids contains an undefined option."),s||Ua(`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`),Ua(i());return}if(n instanceof yt)return n;const a=n;return"current"in a?(o=a.current)==null?void 0:o.api:(a.api||Ua(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${i()}`),a.api)}).filter(n=>!!n&&!n.isDestroyed())}init(){this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{if(t.isDestroyed())return;const s=t.__getAlignedGridService();e(s)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent(t=>{t.onColumnEvent(e)})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent(t=>{t.onScrollEvent(e)})}onScrollEvent(e){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}getMasterColumns(e){const t=[];return e.columns?e.columns.forEach(s=>{t.push(s)}):e.column&&t.push(e.column),t}getColumnIds(e){const t=[];return e.columns?e.columns.forEach(s=>{t.push(s.getColId())}):e.column&&t.push(e.column.getColId()),t}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case w.EVENT_COLUMN_MOVED:case w.EVENT_COLUMN_VISIBLE:case w.EVENT_COLUMN_PINNED:case w.EVENT_COLUMN_RESIZED:const t=e;this.processColumnEvent(t);break;case w.EVENT_COLUMN_GROUP_OPENED:const s=e;this.processGroupOpenedEvent(s);break;case w.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.");break}})}processGroupOpenedEvent(e){e.columnGroups.forEach(t=>{let s=null;if(t){const i=t.getGroupId();s=this.columnModel.getProvidedColumnGroup(i)}t&&!s||(this.logger.log("onColumnEvent-> processing "+e+" expanded = "+t.isExpanded()),this.columnModel.setColumnGroupOpened(s,t.isExpanded(),"alignedGridChanged"))})}processColumnEvent(e){var t;const s=e.column;let i=null;if(s&&(i=this.columnModel.getPrimaryColumn(s.getColId())),s&&!i)return;const r=this.getMasterColumns(e);switch(e.type){case w.EVENT_COLUMN_MOVED:{const u=e,p=e.api.getColumnState().map(g=>({colId:g.colId}));this.columnModel.applyColumnState({state:p,applyOrder:!0},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${e.type} toIndex = ${u.toIndex}`)}break;case w.EVENT_COLUMN_VISIBLE:{const u=e,p=e.api.getColumnState().map(g=>({colId:g.colId,hide:g.hide}));this.columnModel.applyColumnState({state:p},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${e.type} visible = ${u.visible}`)}break;case w.EVENT_COLUMN_PINNED:{const u=e,p=e.api.getColumnState().map(g=>({colId:g.colId,pinned:g.pinned}));this.columnModel.applyColumnState({state:p},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${e.type} pinned = ${u.pinned}`)}break;case w.EVENT_COLUMN_RESIZED:const a=e,l={};r.forEach(u=>{this.logger.log(`onColumnEvent-> processing ${e.type} actualWidth = ${u.getActualWidth()}`),l[u.getId()]={key:u.getColId(),newWidth:u.getActualWidth()}}),(t=a.flexColumns)==null||t.forEach(u=>{l[u.getId()]&&delete l[u.getId()]}),this.columnModel.setColumnWidths(Object.values(l),!1,a.finished,"alignedGridChanged");break}const o=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(a=>{a.setGridOption("alwaysShowVerticalScroll",o)})}};f([A("columnModel")],wl.prototype,"columnModel",2);f([A("ctrlsService")],wl.prototype,"ctrlsService",2);f([Yr(0,Sr("loggerFactory"))],wl.prototype,"setBeans",1);f([Ee],wl.prototype,"init",1);wl=f([je("alignedGridsService")],wl);var Sl=class extends xe{constructor(){super(...arguments),this.selectedNodes=new Map,this.lastRowNode=null}init(){this.rowSelection=this.gos.get("rowSelection"),this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.rowSelection=this.gos.get("rowSelection"),this.deselectAllRowNodes({source:"api"})}),this.addManagedListener(this.eventService,w.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}destroy(){super.destroy(),this.resetNodes(),this.lastRowNode=null}isMultiselect(){return this.rowSelection==="multiple"}setNodesSelected(e){var t;const{newValue:s,clearSelection:i,suppressFinishActions:r,rangeSelect:n,nodes:o,event:a,source:l="api"}=e;if(o.length===0)return 0;if(o.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;const u=this.groupSelectsChildren&&e.groupSelectsFiltered===!0,h=o.map(g=>g.footer?g.sibling:g);if(n){if(o.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;let g=null;if(l==="checkboxSelected"&&s===!1&&this.lastRowNode&&(this.lastRowNode.id?g=this.lastRowNode:this.lastRowNode=null),g==null&&(g=this.getLastSelectedNode()),g){const m=h[0];if(m!==g&&this.isMultiselect())return this.selectRange(m,g,s,l)}}this.lastRowNode=s?null:h[0];let p=0;for(let g=0;g<h.length;g++){const m=h[g];u&&m.group||m.selectThisNode(s,a,l)&&p++,this.groupSelectsChildren&&((t=m.childrenAfterGroup)!=null&&t.length)&&(p+=this.selectChildren(m,s,u,l))}if(!r&&(s&&(i||!this.isMultiselect())&&(p+=this.clearOtherNodes(h[0],l)),p>0)){this.updateGroupsFromChildrenSelections(l);const m={type:w.EVENT_SELECTION_CHANGED,source:l};this.eventService.dispatchEvent(m)}return p}selectRange(e,t,s=!0,i){const r=this.rowModel.getNodesInRangeForSelection(e,t);let n=0;r.forEach(a=>{if(a.group&&this.groupSelectsChildren)return;a.selectThisNode(s,void 0,i)&&n++}),this.updateGroupsFromChildrenSelections(i);const o={type:w.EVENT_SELECTION_CHANGED,source:i};return this.eventService.dispatchEvent(o),n}selectChildren(e,t,s,i){const r=s?e.childrenAfterAggFilter:e.childrenAfterGroup;return nt(r)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:s,source:i,nodes:r})}getLastSelectedNode(){const e=Array.from(this.selectedNodes.keys());if(e.length==0)return null;const t=this.selectedNodes.get(At(e));return t||null}getSelectedNodes(){const e=[];return this.selectedNodes.forEach(t=>{t&&e.push(t)}),e}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>{t&&t.data&&e.push(t.data)}),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((s,i)=>{s&&e(s)&&t.set(i,s)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsChildren||this.rowModel.getType()!=="clientSide")return!1;const i=this.rowModel.getRootNode();t||(t=new av(!0,i),t.setInactive());let r=!1;return t.forEachChangedNodeDepthFirst(n=>{if(n!==i){const o=n.calculateSelectedFromChildren();r=n.selectThisNode(o===null?!1:o,void 0,e)||r}}),r}clearOtherNodes(e,t){const s=new Map;let i=0;return this.selectedNodes.forEach(r=>{if(r&&r.id!==e.id){const n=this.selectedNodes.get(r.id);i+=n.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsChildren&&r.parent&&s.set(r.parent.id,r.parent)}}),s.forEach(r=>{const n=r.calculateSelectedFromChildren();r.selectThisNode(n===null?!1:n,void 0,t)}),i}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(e,t){if(Ce(t)&&e.id!==t.id&&t){const i=t.id;this.selectedNodes.get(i)==e&&this.selectedNodes.set(t.id,t)}}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.setSelectedInitialValue(!0),this.selectedNodes.set(e.id,e)):e.setSelectedInitialValue(!1)}reset(e){const t=this.getSelectionCount();if(this.resetNodes(),t){const s={type:w.EVENT_SELECTION_CHANGED,source:e};this.eventService.dispatchEvent(s)}}resetNodes(){var e;(e=this.selectedNodes)==null||e.clear()}getBestCostNodeSelection(){if(this.rowModel.getType()!=="clientSide")return;const t=this.rowModel.getTopLevelNodes();if(t===null)return;const s=[];function i(r){for(let n=0,o=r.length;n<o;n++){const a=r[n];if(a.isSelected())s.push(a);else{const l=a;l.group&&l.children&&i(l.children)}}}return i(t),s}isEmpty(){let e=0;return this.selectedNodes.forEach(t=>{t&&e++}),e===0}deselectAllRowNodes(e){const t=a=>a.selectThisNode(!1,void 0,i),s=this.rowModel.getType()==="clientSide",{source:i,justFiltered:r,justCurrentPage:n}=e;if(n||r){if(!s){console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");return}this.getNodesToSelect(r,n).forEach(t)}else this.selectedNodes.forEach(a=>{a&&t(a)}),this.reset(i);s&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(i);const o={type:w.EVENT_SELECTION_CHANGED,source:i};this.eventService.dispatchEvent(o)}getSelectedCounts(e,t){let s=0,i=0;const r=n=>{this.groupSelectsChildren&&n.group||(n.isSelected()?s++:n.selectable&&i++)};return this.getNodesToSelect(e,t).forEach(r),{selectedCount:s,notSelectedCount:i}}getSelectAllState(e,t){const{selectedCount:s,notSelectedCount:i}=this.getSelectedCounts(e,t);return s===0&&i===0?!1:s>0&&i>0?null:s>0}hasNodesToSelect(e=!1,t=!1){return this.getNodesToSelect(e,t).filter(s=>s.selectable).length>0}getNodesToSelect(e=!1,t=!1){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const s=[];if(t)return this.paginationProxy.forEachNodeOnPage(r=>{if(!r.group){s.push(r);return}if(!r.expanded){const n=o=>{var a;s.push(o),(a=o.childrenAfterFilter)!=null&&a.length&&o.childrenAfterFilter.forEach(n)};n(r);return}this.groupSelectsChildren||s.push(r)}),s;const i=this.rowModel;return e?(i.forEachNodeAfterFilter(r=>{s.push(r)}),s):(i.forEachNode(r=>{s.push(r)}),s)}selectAllRowNodes(e){if(this.rowModel.getType()!=="clientSide")throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const{source:t,justFiltered:s,justCurrentPage:i}=e,r=o=>o.selectThisNode(!0,void 0,t);this.getNodesToSelect(s,i).forEach(r),this.rowModel.getType()==="clientSide"&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t);const n={type:w.EVENT_SELECTION_CHANGED,source:t};this.eventService.dispatchEvent(n)}getSelectionState(){const e=[];return this.selectedNodes.forEach(t=>{t!=null&&t.id&&e.push(t.id)}),e.length?e:null}setSelectionState(e,t){if(!Array.isArray(e))return;const s=new Set(e),i=[];this.rowModel.forEachNode(r=>{s.has(r.id)&&i.push(r)}),this.setNodesSelected({newValue:!0,nodes:i,source:t})}};f([A("rowModel")],Sl.prototype,"rowModel",2);f([A("paginationProxy")],Sl.prototype,"paginationProxy",2);f([Ee],Sl.prototype,"init",1);Sl=f([je("selectionService")],Sl);var Zc=class{constructor(e){this.viaApi=(t,...s)=>(tt(`Since v31, 'columnApi.${t}' is deprecated and moved to 'api.${t}'.`),this.api[t](...s)),this.api=e}sizeColumnsToFit(e){this.viaApi("sizeColumnsToFit",e)}setColumnGroupOpened(e,t){this.viaApi("setColumnGroupOpened",e,t)}getColumnGroup(e,t){return this.viaApi("getColumnGroup",e,t)}getProvidedColumnGroup(e){return this.viaApi("getProvidedColumnGroup",e)}getDisplayNameForColumn(e,t){return this.viaApi("getDisplayNameForColumn",e,t)}getDisplayNameForColumnGroup(e,t){return this.viaApi("getDisplayNameForColumnGroup",e,t)}getColumn(e){return this.viaApi("getColumn",e)}getColumns(){return this.viaApi("getColumns")}applyColumnState(e){return this.viaApi("applyColumnState",e)}getColumnState(){return this.viaApi("getColumnState")}resetColumnState(){this.viaApi("resetColumnState")}getColumnGroupState(){return this.viaApi("getColumnGroupState")}setColumnGroupState(e){this.viaApi("setColumnGroupState",e)}resetColumnGroupState(){this.viaApi("resetColumnGroupState")}isPinning(){return this.viaApi("isPinning")}isPinningLeft(){return this.viaApi("isPinningLeft")}isPinningRight(){return this.viaApi("isPinningRight")}getDisplayedColAfter(e){return this.viaApi("getDisplayedColAfter",e)}getDisplayedColBefore(e){return this.viaApi("getDisplayedColBefore",e)}setColumnVisible(e,t){this.viaApi("setColumnVisible",e,t)}setColumnsVisible(e,t){this.viaApi("setColumnsVisible",e,t)}setColumnPinned(e,t){this.viaApi("setColumnPinned",e,t)}setColumnsPinned(e,t){this.viaApi("setColumnsPinned",e,t)}getAllGridColumns(){return this.viaApi("getAllGridColumns")}getDisplayedLeftColumns(){return this.viaApi("getDisplayedLeftColumns")}getDisplayedCenterColumns(){return this.viaApi("getDisplayedCenterColumns")}getDisplayedRightColumns(){return this.viaApi("getDisplayedRightColumns")}getAllDisplayedColumns(){return this.viaApi("getAllDisplayedColumns")}getAllDisplayedVirtualColumns(){return this.viaApi("getAllDisplayedVirtualColumns")}moveColumn(e,t){this.viaApi("moveColumn",e,t)}moveColumnByIndex(e,t){this.viaApi("moveColumnByIndex",e,t)}moveColumns(e,t){this.viaApi("moveColumns",e,t)}moveRowGroupColumn(e,t){this.viaApi("moveRowGroupColumn",e,t)}setColumnAggFunc(e,t){this.viaApi("setColumnAggFunc",e,t)}setColumnWidth(e,t,s=!0,i){this.viaApi("setColumnWidth",e,t,s,i)}setColumnWidths(e,t=!0,s){this.viaApi("setColumnWidths",e,t,s)}setPivotMode(e){this.viaApi("setPivotMode",e)}isPivotMode(){return this.viaApi("isPivotMode")}getPivotResultColumn(e,t){return this.viaApi("getPivotResultColumn",e,t)}setValueColumns(e){this.viaApi("setValueColumns",e)}getValueColumns(){return this.viaApi("getValueColumns")}removeValueColumn(e){this.viaApi("removeValueColumn",e)}removeValueColumns(e){this.viaApi("removeValueColumns",e)}addValueColumn(e){this.viaApi("addValueColumn",e)}addValueColumns(e){this.viaApi("addValueColumns",e)}setRowGroupColumns(e){this.viaApi("setRowGroupColumns",e)}removeRowGroupColumn(e){this.viaApi("removeRowGroupColumn",e)}removeRowGroupColumns(e){this.viaApi("removeRowGroupColumns",e)}addRowGroupColumn(e){this.viaApi("addRowGroupColumn",e)}addRowGroupColumns(e){this.viaApi("addRowGroupColumns",e)}getRowGroupColumns(){return this.viaApi("getRowGroupColumns")}setPivotColumns(e){this.viaApi("setPivotColumns",e)}removePivotColumn(e){this.viaApi("removePivotColumn",e)}removePivotColumns(e){this.viaApi("removePivotColumns",e)}addPivotColumn(e){this.viaApi("addPivotColumn",e)}addPivotColumns(e){this.viaApi("addPivotColumns",e)}getPivotColumns(){return this.viaApi("getPivotColumns")}getLeftDisplayedColumnGroups(){return this.viaApi("getLeftDisplayedColumnGroups")}getCenterDisplayedColumnGroups(){return this.viaApi("getCenterDisplayedColumnGroups")}getRightDisplayedColumnGroups(){return this.viaApi("getRightDisplayedColumnGroups")}getAllDisplayedColumnGroups(){return this.viaApi("getAllDisplayedColumnGroups")}autoSizeColumn(e,t){return this.viaApi("autoSizeColumn",e,t)}autoSizeColumns(e,t){this.viaApi("autoSizeColumns",e,t)}autoSizeAllColumns(e){this.viaApi("autoSizeAllColumns",e)}setPivotResultColumns(e){this.viaApi("setPivotResultColumns",e)}getPivotResultColumns(){return this.viaApi("getPivotResultColumns")}};f([A("gridApi")],Zc.prototype,"api",2);Zc=f([je("columnApi")],Zc);var ra=class extends xe{constructor(){super(...arguments),this.initialised=!1,this.isSsrm=!1}init(){this.isSsrm=this.gos.isRowModelType("serverSide"),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=s=>this.callColumnCellValueChangedHandler(s),t=this.gos.useAsyncEvents();this.eventService.addEventListener(w.EVENT_CELL_VALUE_CHANGED,e,t),this.addDestroyFunc(()=>this.eventService.removeEventListener(w.EVENT_CELL_VALUE_CHANGED,e,t)),this.addManagedPropertyListener("treeData",s=>this.isTreeData=s.currentValue)}getValue(e,t,s=!1,i=!1){if(this.initialised||this.init(),!t)return;const r=e.getColDef(),n=r.field,o=e.getColId(),a=t.data;let l;const u=t.groupData&&t.groupData[o]!==void 0,h=!i&&t.aggData&&t.aggData[o]!==void 0,p=this.isSsrm&&i&&!!e.getColDef().aggFunc,g=this.isSsrm&&t.footer&&t.field&&(e.getColDef().showRowGroup===!0||e.getColDef().showRowGroup===t.field);if(s&&r.filterValueGetter?l=this.executeFilterValueGetter(r.filterValueGetter,a,e,t):this.isTreeData&&h?l=t.aggData[o]:this.isTreeData&&r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):this.isTreeData&&n&&a?l=Ec(a,n,e.isFieldContainsDots()):u?l=t.groupData[o]:h?l=t.aggData[o]:r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):g?l=Ec(a,t.field,e.isFieldContainsDots()):n&&a&&!p&&(l=Ec(a,n,e.isFieldContainsDots())),this.cellExpressions&&typeof l=="string"&&l.indexOf("=")===0){const m=l.substring(1);l=this.executeValueGetter(m,a,e,t)}if(l==null){const m=this.getOpenedGroup(t,e);if(m!=null)return m}return l}parseValue(e,t,s,i){const r=e.getColDef(),n=this.gos.addGridCommonParams({node:t,data:t==null?void 0:t.data,oldValue:i,newValue:s,colDef:r,column:e}),o=r.valueParser;return Ce(o)?typeof o=="function"?o(n):this.expressionService.evaluate(o,n):s}formatValue(e,t,s,i,r=!0){let n=null,o;const a=e.getColDef();if(i?o=i:r&&(o=a.valueFormatter),o){const l=this.gos.addGridCommonParams({value:s,node:t,data:t?t.data:null,colDef:a,column:e});typeof o=="function"?n=o(l):n=this.expressionService.evaluate(o,l)}else if(a.refData)return a.refData[s]||"";return n==null&&Array.isArray(s)&&(n=s.join(", ")),n}getOpenedGroup(e,t){if(!this.gos.get("showOpenedGroup")||!t.getColDef().showRowGroup)return;const i=t.getColDef().showRowGroup;let r=e.parent;for(;r!=null;){if(r.rowGroupColumn&&(i===!0||i===r.rowGroupColumn.getColId()))return r.key;r=r.parent}}setValue(e,t,s,i){const r=this.columnModel.getPrimaryColumn(t);if(!e||!r)return!1;nt(e.data)&&(e.data={});const{field:n,valueSetter:o}=r.getColDef();if(nt(n)&&nt(o))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(r,s))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:e,data:e.data,oldValue:this.getValue(r,e),newValue:s,colDef:r.getColDef(),column:r});a.newValue=s;let l;if(Ce(o)?typeof o=="function"?l=o(a):l=this.expressionService.evaluate(o,a):l=this.setValueUsingField(e.data,n,s,r.isFieldContainsDots()),l===void 0&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),a.newValue=this.getValue(r,e);const u={type:w.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,api:a.api,columnApi:a.columnApi,colDef:a.colDef,context:a.context,data:e.data,node:e,oldValue:a.oldValue,newValue:a.newValue,value:a.newValue,source:i};return this.eventService.dispatchEvent(u),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.getFrameworkOverrides().wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,columnApi:e.columnApi,context:e.context})})}setValueUsingField(e,t,s,i){if(!t)return!1;let r=!1;if(!i)r=e[t]===s,r||(e[t]=s);else{const n=t.split(".");let o=e;for(;n.length>0&&o;){const a=n.shift();n.length===0?(r=o[a]===s,r||(o[a]=s)):o=o[a]}}return!r}executeFilterValueGetter(e,t,s,i){const r=this.gos.addGridCommonParams({data:t,node:i,column:s,colDef:s.getColDef(),getValue:this.getValueCallback.bind(this,i)});return typeof e=="function"?e(r):this.expressionService.evaluate(e,r)}executeValueGetter(e,t,s,i){const r=s.getColId(),n=this.valueCache.getValue(i,r);if(n!==void 0)return n;const o=this.gos.addGridCommonParams({data:t,node:i,column:s,colDef:s.getColDef(),getValue:this.getValueCallback.bind(this,i)});let a;return typeof e=="function"?a=e(o):a=this.expressionService.evaluate(e,o),this.valueCache.setValue(i,r,a),a}getValueCallback(e,t){const s=this.columnModel.getPrimaryColumn(t);return s?this.getValue(s,e):null}getKeyForNode(e,t){const s=this.getValue(e,t),i=e.getColDef().keyCreator;let r=s;if(i){const n=this.gos.addGridCommonParams({value:s,colDef:e.getColDef(),column:e,node:t,data:t.data});r=i(n)}return typeof r=="string"||r==null||(r=String(r),r==="[object Object]"&&tt("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),r}};f([A("expressionService")],ra.prototype,"expressionService",2);f([A("columnModel")],ra.prototype,"columnModel",2);f([A("valueCache")],ra.prototype,"valueCache",2);f([A("dataTypeService")],ra.prototype,"dataTypeService",2);f([Ee],ra.prototype,"init",1);ra=f([je("valueService")],ra);var Ff=class extends xe{constructor(){super(...arguments),this.expressionToFunctionCache={}}setBeans(e){this.logger=e.create("ExpressionService")}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);console.error("AG Grid: value should be either a string or a function",e)}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.columnApi,t.getValue,t.column,t.columnGroup)}catch(s){return console.log("Processing of the expression failed"),console.log("Expression = "+e),console.log("Params =",t),console.log("Exception = "+s),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),s=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=s,s}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}};f([Yr(0,Sr("loggerFactory"))],Ff.prototype,"setBeans",1);Ff=f([je("expressionService")],Ff);var If=class extends xe{setBeans(e){this.logging=e.get("debug")}create(e){return new z0(e,this.isLogging.bind(this))}isLogging(){return this.logging}};f([Yr(0,Sr("gridOptionsService"))],If.prototype,"setBeans",1);If=f([je("loggerFactory")],If);var z0=class{constructor(t,s){this.name=t,this.isLoggingFunc=s}isLogging(){return this.isLoggingFunc()}log(t){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+t)}},Ca=class extends xe{setComp(e,t,s){this.view=e,this.eGridHostDiv=t,this.eGui=s,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:r=>r===1||r===0,getIconName:()=>at.ICON_NOT_ALLOWED}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new Jm(this.view)),this.addRtlSupport();const i=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>i()),this.ctrlsService.register("gridCtrl",this)}isDetailGrid(){var e;const t=this.focusService.findTabbableParent(this.getGui());return((e=t==null?void 0:t.getAttribute("row-id"))==null?void 0:e.startsWith("detail"))||!1}showDropZones(){return Nt.__isRegistered("@ag-grid-enterprise/row-grouping",this.context.getGridId())}showSideBar(){return Nt.__isRegistered("@ag-grid-enterprise/side-bar",this.context.getGridId())}showStatusBar(){return Nt.__isRegistered("@ag-grid-enterprise/status-bar",this.context.getGridId())}showWatermark(){return Nt.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId())}onGridSizeChanged(){const e={type:w.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(e)}addRtlSupport(){const e=this.gos.get("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(e)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.view.getFocusableContainers(),s=this.gos.getActiveDomElement(),r=t.findIndex(n=>n.contains(s))+(e?-1:1);return r<=0||r>=t.length?!1:this.focusService.focusInto(t[r])}focusInnerElement(e){const t=this.view.getFocusableContainers(),s=this.columnModel.getAllDisplayedColumns();if(e){if(t.length>1)return this.focusService.focusInto(At(t),!0);const i=At(s);if(this.focusService.focusGridView(i,!0))return!0}if(this.gos.get("headerHeight")===0||this.gos.get("suppressHeaderFocus")){if(this.focusService.focusGridView(s[0]))return!0;for(let i=1;i<t.length;i++)if(this.focusService.focusInto(t[i]))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}};f([A("focusService")],Ca.prototype,"focusService",2);f([A("resizeObserverService")],Ca.prototype,"resizeObserverService",2);f([A("columnModel")],Ca.prototype,"columnModel",2);f([A("ctrlsService")],Ca.prototype,"ctrlsService",2);f([A("mouseEventService")],Ca.prototype,"mouseEventService",2);f([A("dragAndDropService")],Ca.prototype,"dragAndDropService",2);var Ep=class extends yp{constructor(t){super(),this.eGridDiv=t}postConstruct(){this.logger=this.loggerFactory.create("GridComp");const t={destroyGridUi:()=>this.destroyBean(this),setRtlClass:i=>this.addCssClass(i),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:i=>{this.getGui().style.userSelect=i??"",this.getGui().style.webkitUserSelect=i??""},setCursor:i=>{this.getGui().style.cursor=i??""}};this.ctrl=this.createManagedBean(new Ca);const s=this.createTemplate();this.setTemplate(s),this.ctrl.setComp(t,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:i=>this.ctrl.focusInnerElement(i),forceFocusOutWhenTabGuardsAreEmpty:!0})}insertGridIntoDom(){const t=this.getGui();this.eGridDiv.appendChild(t),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(t),this.logger.log("Grid removed from DOM")})}updateLayoutClasses(t,s){const i=this.eRootWrapperBody.classList;i.toggle("ag-layout-auto-height",s.autoHeight),i.toggle("ag-layout-normal",s.normal),i.toggle("ag-layout-print",s.print),this.addOrRemoveCssClass("ag-layout-auto-height",s.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",s.normal),this.addOrRemoveCssClass("ag-layout-print",s.print)}createTemplate(){const t=this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"",s=this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"",i=this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"",r=this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"";return`<div class="ag-root-wrapper" role="presentation">
                ${t}
                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">
                    <ag-grid-body ref="gridBody"></ag-grid-body>
                    ${s}
                </div>
                ${i}
                <ag-pagination></ag-pagination>
                ${r}
            </div>`}getFocusableElement(){return this.eRootWrapperBody}getFocusableContainers(){const t=[this.gridBodyComp.getGui()];return this.sideBarComp&&t.push(this.sideBarComp.getGui()),t.filter(s=>ji(s))}};f([A("loggerFactory")],Ep.prototype,"loggerFactory",2);f([Ie("gridBody")],Ep.prototype,"gridBodyComp",2);f([Ie("sideBar")],Ep.prototype,"sideBarComp",2);f([Ie("rootWrapperBody")],Ep.prototype,"eRootWrapperBody",2);f([Ee],Ep.prototype,"postConstruct",1);var xl=class extends xe{progressSort(e,t,s){const i=this.getNextSortDirection(e);this.setSortForColumn(e,i,t,s)}setSortForColumn(e,t,s,i){t!=="asc"&&t!=="desc"&&(t=null);const r=this.gos.isColumnsSortingCoupledToGroup();let n=[e];if(r&&e.getColDef().showRowGroup){const l=this.columnModel.getSourceColumnsForGroupColumn(e),u=l==null?void 0:l.filter(h=>h.isSortable());u&&(n=[e,...u])}n.forEach(l=>l.setSort(t,i));const o=(s||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"),a=[];if(!o){const l=this.clearSortBarTheseColumns(n,i);a.push(...l)}this.updateSortIndex(e),a.push(...n),this.dispatchSortChangedEvents(i,a)}updateSortIndex(e){const t=this.gos.isColumnsSortingCoupledToGroup(),s=this.columnModel.getGroupDisplayColumnForGroup(e.getId()),i=t&&s||e,r=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(a=>a.setSortIndex(null));const n=r.filter(a=>t&&a.getColDef().showRowGroup?!1:a!==i);(i.getSort()?[...n,i]:n).forEach((a,l)=>{a.setSortIndex(l)})}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){const t=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(s=>!!s.getSort());return t&&t.length>0}dispatchSortChangedEvents(e,t){const s={type:w.EVENT_SORT_CHANGED,source:e};t&&(s.columns=t),this.eventService.dispatchEvent(s)}clearSortBarTheseColumns(e,t){const s=[];return this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(i=>{e.includes(i)||(i.getSort()&&s.push(i),i.setSort(void 0,t))}),s}getNextSortDirection(e){let t;if(e.getColDef().sortingOrder?t=e.getColDef().sortingOrder:this.gos.get("sortingOrder")?t=this.gos.get("sortingOrder"):t=xl.DEFAULT_SORTING_ORDER,!Array.isArray(t)||t.length<=0)return console.warn(`AG Grid: sortingOrder must be an array with at least one element, currently it's ${t}`),null;const s=t.indexOf(e.getSort()),i=s<0,r=s==t.length-1;let n;return i||r?n=t[0]:n=t[s+1],xl.DEFAULT_SORTING_ORDER.indexOf(n)<0?(console.warn("AG Grid: invalid sort type "+n),null):n}getIndexedSortMap(){let e=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(n=>!!n.getSort());if(this.columnModel.isPivotMode()){const n=this.gos.isColumnsSortingCoupledToGroup();e=e.filter(o=>{const a=!!o.getAggFunc(),l=!o.isPrimary(),u=n?this.columnModel.getGroupDisplayColumnForGroup(o.getId()):o.getColDef().showRowGroup;return a||l||u})}const t=this.columnModel.getRowGroupColumns().filter(n=>!!n.getSort()),s={};e.forEach((n,o)=>s[n.getId()]=o),e.sort((n,o)=>{const a=n.getSortIndex(),l=o.getSortIndex();if(a!=null&&l!=null)return a-l;if(a==null&&l==null){const u=s[n.getId()],h=s[o.getId()];return u>h?1:-1}else return l==null?-1:1});const i=this.gos.isColumnsSortingCoupledToGroup()&&!!t.length;i&&(e=[...new Set(e.map(n=>{var o;return(o=this.columnModel.getGroupDisplayColumnForGroup(n.getId()))!=null?o:n}))]);const r=new Map;return e.forEach((n,o)=>r.set(n,o)),i&&t.forEach(n=>{const o=this.columnModel.getGroupDisplayColumnForGroup(n.getId());r.set(n,r.get(o))}),r}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([e,t],[s,i])=>t-i).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=this.gos.isColumnsSortingCoupledToGroup(),s=!!e.getColDef().showRowGroup;return t&&s}getDisplaySortForColumn(e){const t=this.columnModel.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!(t!=null&&t.length))return e.getSort();const i=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,r=i[0].getSort();return i.every(o=>o.getSort()==r)?r:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}};xl.DEFAULT_SORTING_ORDER=["asc","desc",null];f([A("columnModel")],xl.prototype,"columnModel",2);xl=f([je("sortController")],xl);var Gt=class extends xe{static addKeyboardModeEvents(e){this.instanceCount>0||(e.addEventListener("keydown",Gt.toggleKeyboardMode),e.addEventListener("mousedown",Gt.toggleKeyboardMode))}static removeKeyboardModeEvents(e){this.instanceCount>0||(e.addEventListener("keydown",Gt.toggleKeyboardMode),e.addEventListener("mousedown",Gt.toggleKeyboardMode))}static toggleKeyboardMode(e){const t=Gt.keyboardModeActive,s=e.type==="keydown";s&&(e.ctrlKey||e.metaKey||e.altKey)||t!==s&&(Gt.keyboardModeActive=s)}static unregisterGridCompController(e){Gt.removeKeyboardModeEvents(e)}init(){const e=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(t=>{this.gridCtrl=t.gridCtrl})}registerKeyboardFocusEvents(){const e=this.gos.getDocument();Gt.addKeyboardModeEvents(e),Gt.instanceCount++,this.addDestroyFunc(()=>{Gt.instanceCount--,Gt.unregisterGridCompController(e)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const e=this.focusedCellPosition.column,t=this.columnModel.getGridColumn(e.getId());e!==t&&this.clearFocusedCell()}isKeyboardMode(){return Gt.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),al.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),iv.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(e,t){let s=e;for(;s;){if(this.gos.getDomData(s,t))return!1;s=s.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(e){return this.isCellRestoreFocused(e)?(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0):!1}isCellRestoreFocused(e){return this.restoredFocusedCellPosition==null?!1:this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}setRestoreFocusedCell(e){this.getFrameworkOverrides().renderingEngine==="react"&&(this.restoredFocusedCellPosition=e)}getFocusEventParams(){const{rowIndex:e,rowPinned:t,column:s}=this.focusedCellPosition,i={rowIndex:e,rowPinned:t,column:s,isFullWidthCell:!1},r=this.rowRenderer.getRowByPosition({rowIndex:e,rowPinned:t});return r&&(i.isFullWidthCell=r.isFullWidth()),i}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,this.focusedCellPosition==null)return;const e=Je({type:w.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(e)}setFocusedCell(e){const{column:t,rowIndex:s,rowPinned:i,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:n=!1}=e,o=this.columnModel.getGridColumn(t);if(!o){this.focusedCellPosition=null;return}this.focusedCellPosition=o?{rowIndex:s,rowPinned:Rn(i),column:o}:null;const a=Jt(Je({type:w.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus:r,preventScrollOnBrowserFocus:n,floating:null});this.eventService.dispatchEvent(a)}isCellFocused(e){return this.focusedCellPosition==null?!1:this.cellPositionUtils.equals(e,this.focusedCellPosition)}isRowNodeFocused(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}isHeaderWrapperFocused(e){if(this.focusedHeaderPosition==null)return!1;const t=e.getColumnGroupChild(),s=e.getRowIndex(),i=e.getPinned(),{column:r,headerRowIndex:n}=this.focusedHeaderPosition;return t===r&&s===n&&i==r.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}focusHeaderPosition(e){if(this.gos.get("suppressHeaderFocus"))return!1;const{direction:t,fromTab:s,allowUserOverride:i,event:r,fromCell:n,rowWithoutSpanValue:o}=e;let{headerPosition:a}=e;if(n&&this.filterManager.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(a);if(i){const l=this.getFocusedHeader(),u=this.headerNavigationService.getHeaderRowCount();if(s){const h=this.gos.getCallback("tabToNextHeader");h&&(a=this.getHeaderPositionFromUserFunc({userFunc:h,direction:t,currentPosition:l,headerPosition:a,headerRowCount:u}))}else{const h=this.gos.getCallback("navigateToNextHeader");if(h&&r){const p={key:r.key,previousHeaderPosition:l,nextHeaderPosition:a,headerRowCount:u,event:r};a=h(p)}}}return a?this.focusProvidedHeaderPosition({headerPosition:a,direction:t,event:r,fromCell:n,rowWithoutSpanValue:o}):!1}focusHeaderPositionFromUserFunc(e){if(this.gos.get("suppressHeaderFocus"))return!1;const{userFunc:t,headerPosition:s,direction:i,event:r}=e,n=this.getFocusedHeader(),o=this.headerNavigationService.getHeaderRowCount(),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:i,currentPosition:n,headerPosition:s,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:i,event:r})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:s,currentPosition:i,headerPosition:r,headerRowCount:n}=e,a=t({backwards:s==="Before",previousHeaderPosition:i,nextHeaderPosition:r,headerRowCount:n});return a===!0||a===null?(a===null&&tt("Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),i):a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:s,fromCell:i,rowWithoutSpanValue:r,event:n}=e;if(t.headerRowIndex===-1)return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView(t.column);this.headerNavigationService.scrollToColumn(t.column,s);const a=this.ctrlsService.getHeaderRowContainerCtrl(t.column.getPinned()).focusHeader(t.headerRowIndex,t.column,n);return a&&(r!=null||i)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(r??-1),a}focusFirstHeader(){let e=this.columnModel.getAllDisplayedColumns()[0];if(!e)return!1;e.getParent()&&(e=this.columnModel.getColumnGroupAtLevel(e,0));const t=this.headerPositionUtils.getHeaderIndexToFocus(e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){const t=this.headerNavigationService.getHeaderRowCount()-1,s=At(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:s},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(e,t){return this.focusedCellPosition==null?!1:this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===Rn(t)}findFocusableElements(e,t,s=!1){const i=iF;let r=d0;t&&(r+=", "+t),s&&(r+=', [tabindex="-1"]');const n=Array.prototype.slice.apply(e.querySelectorAll(i)).filter(l=>ji(l)),o=Array.prototype.slice.apply(e.querySelectorAll(r));return o.length?((l,u)=>l.filter(h=>u.indexOf(h)===-1))(n,o):n}focusInto(e,t=!1,s=!1){const i=this.findFocusableElements(e,null,s),r=t?At(i):i[0];return r?(r.focus({preventScroll:!0}),!0):!1}findFocusableElementBeforeTabGuard(e,t){if(!t)return null;const s=this.findFocusableElements(e),i=s.indexOf(t);if(i===-1)return null;let r=-1;for(let n=i-1;n>=0;n--)if(s[n].classList.contains("ag-tab-guard-top")){r=n;break}return r<=0?null:s[r-1]}findNextFocusableElement(e=this.eGridDiv,t,s){const i=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),r=this.gos.getActiveDomElement();let n;t?n=i.findIndex(a=>a.contains(r)):n=i.indexOf(r);const o=n+(s?-1:1);return o<0||o>=i.length?null:i[o]}isTargetUnderManagedComponent(e,t){if(!t)return!1;const s=e.querySelectorAll(`.${ha.FOCUS_MANAGED_CLASS}`);if(!s.length)return!1;for(let i=0;i<s.length;i++)if(s[i].contains(t))return!0;return!1}findTabbableParent(e,t=5){let s=0;for(;e&&bf(e)===null&&++s<=t;)e=e.parentElement;return bf(e)===null?null:e}focusGridView(e,t){var s;if(this.gos.get("suppressCellFocus"))return t?this.gos.get("suppressHeaderFocus")?this.focusNextGridCoreContainer(!0,!0):this.focusLastHeader():this.focusNextGridCoreContainer(!1);const i=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!i)return!1;const{rowIndex:r,rowPinned:n}=i,o=this.getFocusedHeader();return!e&&o&&(e=o.column),r==null||!e?!1:(this.navigationService.ensureCellVisible({rowIndex:r,column:e,rowPinned:n}),this.setFocusedCell({rowIndex:r,column:e,rowPinned:Rn(n),forceBrowserFocus:!0}),(s=this.rangeService)==null||s.setRangeToCell({rowIndex:r,rowPinned:n,column:e}),!0)}focusNextGridCoreContainer(e,t=!1){return!t&&this.gridCtrl.focusNextInnerContainer(e)?!0:((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}focusAdvancedFilter(e){var t,s;return this.advancedFilterFocusColumn=e==null?void 0:e.column,(s=(t=this.advancedFilterService)==null?void 0:t.getCtrl().focusHeaderComp())!=null?s:!1}focusNextFromAdvancedFilter(e,t){var s,i;const r=(i=t?void 0:this.advancedFilterFocusColumn)!=null?i:(s=this.columnModel.getAllDisplayedColumns())==null?void 0:s[0];return e?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(r)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}};Gt.keyboardModeActive=!1;Gt.instanceCount=0;f([A("eGridDiv")],Gt.prototype,"eGridDiv",2);f([A("columnModel")],Gt.prototype,"columnModel",2);f([A("headerNavigationService")],Gt.prototype,"headerNavigationService",2);f([A("headerPositionUtils")],Gt.prototype,"headerPositionUtils",2);f([A("rowRenderer")],Gt.prototype,"rowRenderer",2);f([A("rowPositionUtils")],Gt.prototype,"rowPositionUtils",2);f([A("cellPositionUtils")],Gt.prototype,"cellPositionUtils",2);f([A("navigationService")],Gt.prototype,"navigationService",2);f([A("ctrlsService")],Gt.prototype,"ctrlsService",2);f([A("filterManager")],Gt.prototype,"filterManager",2);f([Lt("rangeService")],Gt.prototype,"rangeService",2);f([Lt("advancedFilterService")],Gt.prototype,"advancedFilterService",2);f([Ee],Gt.prototype,"init",1);Gt=f([je("focusService")],Gt);var uw=class extends xe{setMouseOver(e){this.selectedColumns=e;const t={type:w.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(t)}clearMouseOver(){this.selectedColumns=null;const e={type:w.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(e)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}};uw=f([je("columnHoverService")],uw);var Ch=class extends xe{constructor(){super(...arguments),this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.ctrlsService.whenReady(e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&this.flush(()=>{this.active=!1})}executeNextVMTurn(e){this.active?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(e){if(this.executeNextFuncs.length===0&&this.executeLaterFuncs.length===0){e();return}const t=s=>{for(;s.length;){const i=s.pop();i&&i()}};this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>t(this.executeNextFuncs),0),window.setTimeout(()=>{e(),t(this.executeLaterFuncs)},200)})}};f([A("ctrlsService")],Ch.prototype,"ctrlsService",2);f([Ee],Ch.prototype,"postConstruct",1);Ch=f([je("columnAnimationService")],Ch);var Jc=class extends xe{postConstruct(){this.ctrlsService.whenReady(e=>{this.centerRowsCtrl=e.center,this.addManagedListener(this.eventService,w.EVENT_BODY_HEIGHT_CHANGED,this.checkPageSize.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,this.checkPageSize.bind(this)),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.paginationProxy.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(e>0){const t=()=>{const s=this.gos.getRowHeightAsNumber(),i=Math.floor(e/s);this.paginationProxy.setPageSize(i,"autoCalculated")};this.isBodyRendered?pi(()=>t(),50)():(t(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}};f([A("ctrlsService")],Jc.prototype,"ctrlsService",2);f([A("paginationProxy")],Jc.prototype,"paginationProxy",2);f([Ee],Jc.prototype,"postConstruct",1);Jc=f([je("paginationAutoPageSizeService")],Jc);var Nf=class extends xe{constructor(){super(...arguments),this.cacheVersion=0}init(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,s){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=s)}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}};f([Ee],Nf.prototype,"init",1);Nf=f([je("valueCache")],Nf);var JG="paste",Xc=class extends xe{init(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,w.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}onCellValueChanged(e){e.source!==JG&&this.doChangeDetection(e.node,e.column)}doChangeDetection(e,t){if(this.gos.get("suppressChangeDetection"))return;const s=[e];if(this.clientSideRowModel&&!e.isRowPinned()){const i=this.gos.get("aggregateOnlyChangedColumns"),r=new av(i,this.clientSideRowModel.getRootNode());r.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(r),r.forEachChangedNodeDepthFirst(n=>{s.push(n)})}this.rowRenderer.refreshCells({rowNodes:s})}};f([A("rowModel")],Xc.prototype,"rowModel",2);f([A("rowRenderer")],Xc.prototype,"rowRenderer",2);f([Ee],Xc.prototype,"init",1);Xc=f([je("changeDetectionService")],Xc);var _f=class extends xe{adaptFunction(e,t){const s=this.componentMetadataProvider.retrieve(e);return s&&s.functionAdapter?s.functionAdapter(t):null}adaptCellRendererFunction(e){class t{refresh(i){return!1}getGui(){return this.eGui}init(i){const r=e(i),n=typeof r;if(n==="string"||n==="number"||n==="boolean"){this.eGui=Oi("<span>"+r+"</span>");return}if(r==null){this.eGui=Oi("<span></span>");return}this.eGui=r}}return t}doesImplementIComponent(e){return e?e.prototype&&"getGui"in e.prototype:!1}};f([A("componentMetadataProvider")],_f.prototype,"componentMetadataProvider",2);_f=f([je("agComponentUtils")],_f);var yh=class extends xe{postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(e){return this.componentMetaData[e]}};f([A("agComponentUtils")],yh.prototype,"agComponentUtils",2);f([Ee],yh.prototype,"postConstruct",1);yh=f([je("componentMetadataProvider")],yh);var XG=25,Pb=10,fC=8,e2=4,mC=4,vC=6,t2=16,Ab=14,CC=8,s2={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:e2*5,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:fC*7,headerCellMinWidth:48,listItemHeight:fC*4,rowHeight:fC*6,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:mC*8,headerCellMinWidth:24,listItemHeight:mC*6,rowHeight:mC*7,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:vC*8,headerCellMinWidth:36,listItemHeight:vC*4,rowHeight:vC*7,chartMenuPanelWidth:240},"ag-theme-quartz":{headerHeight:Ab+CC*4.25,headerCellMinWidth:36,listItemHeight:t2+CC,rowHeight:Ab+CC*3.5,chartMenuPanelWidth:260}},Fb={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},wh=class extends xe{constructor(){super(...arguments),this.calculatedSizes={},this.calculatedTheme=null}postConstruct(){var e;const t=(e=this.getTheme().el)!=null?e:this.eGridDiv;this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.mutationObserver=new MutationObserver(()=>{this.calculatedSizes={},this.calculatedTheme=null,this.calculatedTheme=this.getTheme(),this.fireGridStylesChangedEvent()}),this.mutationObserver.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}fireGridStylesChangedEvent(){const e={type:w.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(e)}getSassVariable(e){const{themeFamily:t,el:s}=this.getTheme();if(!t||t.indexOf("ag-theme")!==0)return;this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[t]||(this.calculatedSizes[t]={});const i=this.calculatedSizes[t][e];return i??(this.calculatedSizes[t][e]=this.calculateValueForSassProperty(e,t,s),this.calculatedSizes[t][e])}calculateValueForSassProperty(e,t,s){const i="ag-theme-"+(t.match("material")?"material":t.match("balham")?"balham":t.match("alpine")?"alpine":"custom"),r=s2[i][e],n=this.gos.getDocument();if(s||(s=this.eGridDiv),!Fb[e])return r;const o=Fb[e],a=n.createElement("div"),l=Array.from(s.classList);a.classList.add(t,...l),a.style.position="absolute";const u=o.reduce((p,g)=>{const m=n.createElement("div");return m.style.position="static",m.classList.add(g),p.appendChild(m),m},a);let h=0;if(n.body){n.body.appendChild(a);const p=e.toLowerCase().indexOf("height")!==-1?"height":"width";h=parseInt(window.getComputedStyle(u)[p],10),n.body.removeChild(a)}return h||r}isThemeDark(){const{theme:e}=this.getTheme();return!!e&&e.indexOf("dark")>=0}chartMenuPanelWidth(){return this.getSassVariable("chartMenuPanelWidth")}getTheme(){if(this.calculatedTheme)return this.calculatedTheme;const e=/\bag-(material|(?:theme-([\w\-]*)))\b/g;let t=this.eGridDiv,s=null,i=[];for(;t;)if(s=e.exec(t.className),!s)t=t.parentElement||void 0;else{const n=t.className.match(e);n&&(i=n);break}if(!s)return{allThemes:i};const r=s[0];return this.calculatedTheme={theme:r,el:t,themeFamily:r.replace(/-dark$/,""),allThemes:i},this.calculatedTheme}getFromTheme(e,t){var s;return(s=this.getSassVariable(t))!=null?s:e}getDefaultRowHeight(){return this.getFromTheme(XG,"rowHeight")}getListItemHeight(){return this.getFromTheme(20,"listItemHeight")}refreshRowHeightVariable(){const e=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),t=this.gos.get("rowHeight");if(t==null||isNaN(t)||!isFinite(t))return e!==null&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const s=`${t}px`;return e!=s?(this.eGridDiv.style.setProperty("--ag-line-height",s),t):e!=""?parseFloat(e):-1}getMinColWidth(){const e=this.getFromTheme(null,"headerCellMinWidth");return Ce(e)?Math.max(e,Pb):Pb}destroy(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),super.destroy()}};f([A("eGridDiv")],wh.prototype,"eGridDiv",2);f([Ee],wh.prototype,"postConstruct",1);wh=f([je("environment")],wh);var eu=class extends xe{constructor(){super(...arguments),this.scrollY=0,this.uiBodyHeight=0}agWire(e){this.logger=e.create("RowContainerHeightService")}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=YA(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,s=this.getUiBodyHeight();(t!==this.scrollY||s!==this.uiBodyHeight)&&(this.scrollY=t,this.uiBodyHeight=s,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.logger.log(`Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:w.EVENT_HEIGHT_SCALE_CHANGED}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return t.bottom-t.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),s=e/t;return this.maxScrollY*s}};f([A("ctrlsService")],eu.prototype,"ctrlsService",2);f([Yr(0,Sr("loggerFactory"))],eu.prototype,"agWire",1);f([Ee],eu.prototype,"postConstruct",1);eu=f([je("rowContainerHeightService")],eu);var tu=class extends xe{init(){this.addManagedPropertyListener("isRowSelectable",()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(e=!1){const t=!!this.gos.get("rowSelection"),s=this.gos.get("isRowSelectable");if(!t||!s)return;const i=this.gos.get("groupSelectsChildren"),r=this.rowModel.getType()==="clientSide"&&i,n=[],o=a=>{if(e&&!a.group)return;if(r&&a.group){const u=a.childrenAfterGroup.some(h=>h.selectable===!0);a.setRowSelectable(u,!0);return}const l=s?s(a):!0;a.setRowSelectable(l,!0),!l&&a.isSelected()&&n.push(a)};if(r){const a=this.rowModel;new av(!1,a.getRootNode()).forEachChangedNodeDepthFirst(o,!0,!0)}else this.rowModel.forEachNode(o);n.length&&this.selectionService.setNodesSelected({nodes:n,newValue:!1,source:"selectableChanged"}),r&&this.selectionService instanceof Sl&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}};f([A("rowModel")],tu.prototype,"rowModel",2);f([A("selectionService")],tu.prototype,"selectionService",2);f([Ee],tu.prototype,"init",1);tu=f([je("selectableService")],tu);var Ui=class extends ot{constructor(){super(),this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate());const{btFirst:t,btPrevious:s,btNext:i,btLast:r,pageSizeComp:n}=this;this.activateTabIndex([t,s,i,r]),t.insertAdjacentElement("afterbegin",rs(e?"last":"first",this.gos)),s.insertAdjacentElement("afterbegin",rs(e?"next":"previous",this.gos)),i.insertAdjacentElement("afterbegin",rs(e?"previous":"next",this.gos)),r.insertAdjacentElement("afterbegin",rs(e?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.onPaginationChanged()}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:s}=e;this.addManagedListener(t,"click",s),this.addManagedListener(t,"keydown",i=>{(i.key===z.ENTER||i.key===z.SPACE)&&(i.preventDefault(),s())})}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}setCurrentPageLabel(){const e=this.paginationProxy.getTotalPages()>0,t=this.paginationProxy.getCurrentPage(),s=e?t+1:0;this.lbCurrent.textContent=this.formatNumber(s)}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t)return t({value:e});const s=this.localeService.getLocaleTextFunc(),i=s("thousandSeparator",","),r=s("decimalSeparator",".");return u0(e,i,r)}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),s=e("to","to"),i=e("of","of"),r=e("firstPage","First Page"),n=e("previousPage","Previous Page"),o=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">
                <ag-page-size-selector ref="pageSizeComp"></ag-page-size-selector>
                <span class="ag-paging-row-summary-panel" role="status">
                    <span id="ag-${l}-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-to">${s}</span>
                    <span id="ag-${l}-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>
                    <span id="ag-${l}-of">${i}</span>
                    <span id="ag-${l}-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>
                </span>
                <span class="ag-paging-page-summary-panel" role="presentation">
                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${r}"></div>
                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${n}"></div>
                    <span class="ag-paging-description" role="status">
                        <span id="ag-${l}-start-page">${t}</span>
                        <span id="ag-${l}-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>
                        <span id="ag-${l}-of-page">${i}</span>
                        <span id="ag-${l}-of-page-number" ref="lbTotal" class="ag-paging-number"></span>
                    </span>
                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>
                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>
                </span>
            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}enableOrDisableButtons(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.isLastPageFound(),s=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const i=this.isZeroPagesToDisplay(),r=e===s-1;this.nextButtonDisabled=r||i,this.lastButtonDisabled=!t||i||e===s-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){e0(e,t),e.classList.toggle("ag-disabled",t)}updateRowLabels(){const e=this.paginationProxy.getCurrentPage(),t=this.paginationProxy.getPageSize(),s=this.paginationProxy.isLastPageFound(),i=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;let r,n;if(this.isZeroPagesToDisplay()?r=n=0:(r=t*e+1,n=r+t-1,s&&n>i&&(n=i)),this.lbFirstRowOnPage.textContent=this.formatNumber(r),this.rowNodeBlockLoader.isLoading()){const o=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=o("pageLastRowUnknown","?")}else this.lbLastRowOnPage.textContent=this.formatNumber(n)}isZeroPagesToDisplay(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages();return e&&t===0}setTotalLabels(){const e=this.paginationProxy.isLastPageFound(),t=this.paginationProxy.getTotalPages(),s=e?this.paginationProxy.getMasterRowCount():null;if(s===1){const i=this.paginationProxy.getRow(0);if(i&&i.group&&!(i.groupData||i.aggData)){this.setTotalLabelsToZero();return}}if(e)this.lbTotal.textContent=this.formatNumber(t),this.lbRecordCount.textContent=this.formatNumber(s);else{const i=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=i,this.lbRecordCount.innerHTML=i}}setTotalLabelsToZero(){this.lbFirstRowOnPage.textContent=this.formatNumber(0),this.lbCurrent.textContent=this.formatNumber(0),this.lbLastRowOnPage.textContent=this.formatNumber(0),this.lbTotal.textContent=this.formatNumber(0),this.lbRecordCount.textContent=this.formatNumber(0)}};f([A("paginationProxy")],Ui.prototype,"paginationProxy",2);f([A("rowNodeBlockLoader")],Ui.prototype,"rowNodeBlockLoader",2);f([Ie("btFirst")],Ui.prototype,"btFirst",2);f([Ie("btPrevious")],Ui.prototype,"btPrevious",2);f([Ie("btNext")],Ui.prototype,"btNext",2);f([Ie("btLast")],Ui.prototype,"btLast",2);f([Ie("lbRecordCount")],Ui.prototype,"lbRecordCount",2);f([Ie("lbFirstRowOnPage")],Ui.prototype,"lbFirstRowOnPage",2);f([Ie("lbLastRowOnPage")],Ui.prototype,"lbLastRowOnPage",2);f([Ie("lbCurrent")],Ui.prototype,"lbCurrent",2);f([Ie("lbTotal")],Ui.prototype,"lbTotal",2);f([Ie("pageSizeComp")],Ui.prototype,"pageSizeComp",2);f([Ee],Ui.prototype,"postConstruct",1);var bp=class NI extends ot{constructor(){super(NI.TEMPLATE),this.inProgress=!1,this.destroyRequested=!1}updateLayoutClasses(t,s){const i=this.eOverlayWrapper.classList;i.toggle("ag-layout-auto-height",s.autoHeight),i.toggle("ag-layout-normal",s.normal),i.toggle("ag-layout-print",s.print)}postConstruct(){this.createManagedBean(new Jm(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.registerOverlayWrapperComp(this)}setWrapperTypeClass(t){const s=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&s.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=t,s.toggle(t,!0)}showOverlay(t,s,i){this.inProgress||(this.setWrapperTypeClass(s),this.destroyActiveOverlay(),this.inProgress=!0,t&&t.then(r=>{this.inProgress=!1,this.eOverlayWrapper.appendChild(r.getGui()),this.activeOverlay=r,this.updateListenerDestroyFunc=i,this.destroyRequested&&(this.destroyRequested=!1,this.destroyActiveOverlay())}),this.setDisplayed(!0,{skipAriaHidden:!0}))}destroyActiveOverlay(){var t;if(this.inProgress){this.destroyRequested=!0;return}this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),(t=this.updateListenerDestroyFunc)==null||t.call(this),fs(this.eOverlayWrapper))}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}};bp.TEMPLATE=`
        <div class="ag-overlay" role="presentation">
            <div class="ag-overlay-panel" role="presentation">
                <div class="ag-overlay-wrapper" ref="eOverlayWrapper" role="presentation"></div>
            </div>
        </div>`;f([A("overlayService")],bp.prototype,"overlayService",2);f([Ie("eOverlayWrapper")],bp.prototype,"eOverlayWrapper",2);f([Ee],bp.prototype,"postConstruct",1);var i2=bp,su=class extends xe{getFirstRow(){let e=0,t;return this.pinnedRowModel.getPinnedTopRowCount()?t="top":this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(t="bottom"),t===void 0?null:{rowIndex:e,rowPinned:t}}getLastRow(){let e,t=null;const s=this.pinnedRowModel.getPinnedBottomRowCount(),i=this.pinnedRowModel.getPinnedTopRowCount();return s?(t="bottom",e=s-1):this.rowModel.getRowCount()?(t=null,e=this.paginationProxy.getPageLastRow()):i&&(t="top",e=i-1),e===void 0?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[e.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[e.rowIndex];default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}before(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(Ce(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}};f([A("rowModel")],su.prototype,"rowModel",2);f([A("pinnedRowModel")],su.prototype,"pinnedRowModel",2);f([A("paginationProxy")],su.prototype,"paginationProxy",2);su=f([je("rowPositionUtils")],su);var dw=class extends xe{createId(e){const{rowIndex:t,rowPinned:s,column:i}=e;return this.createIdFromValues({rowIndex:t,column:i,rowPinned:s})}createIdFromValues(e){const{rowIndex:t,rowPinned:s,column:i}=e;return`${t}.${s??"null"}.${i.getId()}`}equals(e,t){const s=e.column===t.column,i=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return s&&i&&r}};dw=f([je("cellPositionUtils")],dw);var pd=class{constructor(e){this.cellValueChanges=e}},yC=class extends pd{constructor(e,t,s,i){super(e),this.initialRange=t,this.finalRange=s,this.ranges=i}},_I=class kI{constructor(t){this.actionStack=[],this.maxStackSize=t||kI.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(t){t.cellValueChanges&&t.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(t))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};_I.DEFAULT_STACK_SIZE=10;var Ib=_I,Fn=class extends xe{constructor(){super(...arguments),this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},s=this.activeCellEdit!==null&&this.cellPositionUtils.equals(this.activeCellEdit,t),i=this.activeRowEdit!==null&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(s||i||this.isPasting||this.isRangeInAction))return;const{rowPinned:n,rowIndex:o,column:a,oldValue:l,value:u}=e,h={rowPinned:n,rowIndex:o,columnId:a.getColId(),newValue:u,oldValue:l};this.cellValueChanges.push(h)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}init(){if(!this.gos.get("undoRedoCellEditing"))return;const e=this.gos.get("undoRedoCellEditingLimit");e<=0||(this.undoStack=new Ib(e),this.redoStack=new Ib(e),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,w.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,w.EVENT_MODEL_UPDATED,t=>{t.keepUndoRedoStack||this.clearStacks()}),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,w.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(t=>{this.gridBodyCtrl=t.gridBodyCtrl}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){const t={type:w.EVENT_UNDO_STARTED,source:e};this.eventService.dispatchEvent(t);const s=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),i={type:w.EVENT_UNDO_ENDED,source:e,operationPerformed:s};this.eventService.dispatchEvent(i)}redo(e){const t={type:w.EVENT_REDO_STARTED,source:e};this.eventService.dispatchEvent(t);const s=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),i={type:w.EVENT_REDO_ENDED,source:e,operationPerformed:s};this.eventService.dispatchEvent(i)}undoRedo(e,t,s,i,r){if(!e)return!1;const n=e.pop();return!n||!n.cellValueChanges?!1:(this.processAction(n,o=>o[i],r),n instanceof yC?this.processRange(this.rangeService,n.ranges||[n[s]]):this.processCell(n.cellValueChanges),t.push(n),!0)}processAction(e,t,s){e.cellValueChanges.forEach(i=>{const{rowIndex:r,rowPinned:n,columnId:o}=i,a={rowIndex:r,rowPinned:n},l=this.rowPositionUtils.getRowNode(a);l.displayed&&l.setDataValue(o,t(i),s)})}processRange(e,t){let s;e.removeAllCellRanges(!0),t.forEach((i,r)=>{if(!i)return;const n=i.startRow,o=i.endRow;r===t.length-1&&(s={rowPinned:n.rowPinned,rowIndex:n.rowIndex,columnId:i.startColumn.getColId()},this.setLastFocusedCell(s));const a={rowStartIndex:n.rowIndex,rowStartPinned:n.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:i.startColumn,columns:i.columns};e.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:s,rowPinned:i}=t,r={rowIndex:s,rowPinned:i},n=this.rowPositionUtils.getRowNode(r),o={rowPinned:t.rowPinned,rowIndex:n.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o,this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:s,columnId:i,rowPinned:r}=e,n=this.gridBodyCtrl.getScrollFeature(),o=this.columnModel.getGridColumn(i);if(!o)return;n.ensureIndexVisible(s),n.ensureColumnVisible(o);const a={rowIndex:s,column:o,rowPinned:r};this.focusService.setFocusedCell(Jt(Je({},a),{forceBrowserFocus:!0})),t==null||t.setRangeToCell(a)}addRowEditingListeners(){this.addManagedListener(this.eventService,w.EVENT_ROW_EDITING_STARTED,e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,w.EVENT_ROW_EDITING_STOPPED,()=>{const e=new pd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null})}addCellEditingListeners(){this.addManagedListener(this.eventService,w.EVENT_CELL_EDITING_STARTED,e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,w.EVENT_CELL_EDITING_STOPPED,e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const s=new pd(this.cellValueChanges);this.pushActionsToUndoStack(s)}})}addPasteListeners(){this.addManagedListener(this.eventService,w.EVENT_PASTE_START,()=>{this.isPasting=!0}),this.addManagedListener(this.eventService,w.EVENT_PASTE_END,()=>{const e=new pd(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1})}addFillListeners(){this.addManagedListener(this.eventService,w.EVENT_FILL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,w.EVENT_FILL_END,e=>{const t=new yC(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1})}addCellKeyListeners(){this.addManagedListener(this.eventService,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,w.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,()=>{let e;this.rangeService&&this.gos.get("enableRangeSelection")?e=new yC(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):e=new pd(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}};f([A("focusService")],Fn.prototype,"focusService",2);f([A("ctrlsService")],Fn.prototype,"ctrlsService",2);f([A("cellPositionUtils")],Fn.prototype,"cellPositionUtils",2);f([A("rowPositionUtils")],Fn.prototype,"rowPositionUtils",2);f([A("columnModel")],Fn.prototype,"columnModel",2);f([Lt("rangeService")],Fn.prototype,"rangeService",2);f([Ee],Fn.prototype,"init",1);Fn=f([je("undoRedoService")],Fn);var Sh=class extends xe{findHeader(e,t){let s,i;if(e.column instanceof Ps?s=this.columnModel.getDisplayedGroupAtDirection(e.column,t):(i=`getDisplayedCol${t}`,s=this.columnModel[i](e.column)),!s)return;let{headerRowIndex:r}=e;if(this.getHeaderRowType(r)!=="filter"){const a=[s];for(;s.getParent();)s=s.getParent(),a.push(s);s=a[a.length-1-r]}const{column:n,headerRowIndex:o}=this.getHeaderIndexToFocus(s,r);return{column:n,headerRowIndex:o}}getHeaderIndexToFocus(e,t){let s;if(e instanceof Ps&&this.isAnyChildSpanningHeaderHeight(e)&&e.isPadding()){const i=e;s=i.getLeafColumns()[0];let r=s;for(;r!==i;)t++,r=r.getParent()}return{column:s||e,headerRowIndex:t}}isAnyChildSpanningHeaderHeight(e){return e?e.getLeafColumns().some(t=>t.isSpanHeaderHeight()):!1}getColumnVisibleParent(e,t){const s=this.getHeaderRowType(t),i=s==="filter",r=s==="column";let n=i?e:e.getParent(),o=t-1,a=o;if(r&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;n&&n.isPadding();)n=n.getParent(),o--;a=o,o<0&&(n=e,o=t,a=void 0)}return{column:n,headerRowIndex:o,headerRowIndexWithoutSpan:a}}getColumnVisibleChild(e,t,s="After"){const i=this.getHeaderRowType(t);let r=e,n=t+1,o=n;if(i==="group"){const a=e.getDisplayedLeafColumns(),l=s==="After"?a[0]:At(a),u=[];let h=l;for(;h.getParent()!==e;)h=h.getParent(),u.push(h);if(r=l,l.isSpanHeaderHeight())for(let p=u.length-1;p>=0;p--){const g=u[p];if(!g.isPadding()){r=g;break}n++}else r=At(u),r||(r=l)}return{column:r,headerRowIndex:n,headerRowIndexWithoutSpan:o}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const s=this.columnModel.getAllDisplayedColumns(),i=s[t==="start"?0:s.length-1];if(!i)return;const n=this.ctrlsService.getHeaderRowContainerCtrl(i.getPinned()).getRowType(e);if(n=="group"){const o=this.columnModel.getColumnGroupAtLevel(i,e);return{headerRowIndex:e,column:o}}return{headerRowIndex:n==null?-1:e,column:i}}};f([A("columnModel")],Sh.prototype,"columnModel",2);f([A("ctrlsService")],Sh.prototype,"ctrlsService",2);Sh=f([je("headerPositionUtils")],Sh);var hw=class{buildColumnDefs(e,t,s){const i=[],r={};return e.forEach(n=>{const o=this.createDefFromColumn(n,t,s);let a=!0,l=o,u=n.getOriginalParent(),h=null;for(;u;){let p=null;if(u.isPadding()){u=u.getOriginalParent();continue}const g=r[u.getGroupId()];if(g){g.children.push(l),a=!1;break}if(p=this.createDefFromGroup(u),p&&(p.children=[l],r[p.groupId]=p,l=p,u=u.getOriginalParent()),u!=null&&h===u){a=!1;break}h=u}a&&i.push(l)}),i}createDefFromGroup(e){const t=yf(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,s){const i=yf(e.getColDef());return i.colId=e.getColId(),i.width=e.getActualWidth(),i.rowGroup=e.isRowGroupActive(),i.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,i.pivot=e.isPivotActive(),i.pivotIndex=e.isPivotActive()?s.indexOf(e):null,i.aggFunc=e.isValueActive()?e.getAggFunc():null,i.hide=e.isVisible()?void 0:!0,i.pinned=e.isPinned()?e.getPinned():null,i.sort=e.getSort()?e.getSort():null,i.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,i}};hw=f([je("columnDefFactory")],hw);var xh=class{getInitialRowClasses(e){const t=[];return Ce(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),Ky(t,this.processClassesFromGridOptions(e.rowNode)),Ky(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&(e.pinned==="left"&&t.push("ag-cell-last-left-pinned"),e.pinned==="right"&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],s=n=>{typeof n=="string"?t.push(n):Array.isArray(n)&&n.forEach(o=>t.push(o))},i=this.gos.get("rowClass");if(i){if(typeof i=="function")return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];s(i)}const r=this.gos.getCallback("getRowClass");if(r){const n={data:e.data,node:e,rowIndex:e.rowIndex},o=r(n);s(o)}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,s=>{t.push(s)},s=>{}),t}processRowClassRules(e,t,s){const i=this.gos.addGridCommonParams({data:e.data,node:e,rowIndex:e.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),i,t,s)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}};f([A("stylingService")],xh.prototype,"stylingService",2);f([A("gridOptionsService")],xh.prototype,"gos",2);xh=f([je("rowCssClassCalculator")],xh);var iu=class extends xe{init(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup())}doFullSort(e,t){const s=(r,n)=>({currentPos:n,rowNode:r}),i=e.map(s);return i.sort(this.compareRowNodes.bind(this,t)),i.map(r=>r.rowNode)}compareRowNodes(e,t,s){const i=t.rowNode,r=s.rowNode;for(let n=0,o=e.length;n<o;n++){const a=e[n],l=a.sort==="desc",u=this.getValue(i,a.column),h=this.getValue(r,a.column);let p;const g=this.getComparator(a,i);if(g?p=g(u,h,i,r,l):p=rt.defaultComparator(u,h,this.isAccentedSort),!isNaN(p)&&p!==0)return a.sort==="asc"?p:p*-1}return t.currentPos-s.currentPos}getComparator(e,t){const s=e.column,i=s.getColDef().comparator;if(i!=null)return i;if(!s.getColDef().showRowGroup)return;const r=!t.group&&s.getColDef().field;if(!r)return;const n=this.columnModel.getPrimaryColumn(r);if(n)return n.getColDef().comparator}getValue(e,t){var s,i;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(this.gos.isGroupUseEntireRow(this.columnModel.isPivotActive())){const a=(s=e.allLeafChildren)==null?void 0:s[0];return a?this.valueService.getValue(t,a,!1,!1):void 0}const o=this.columnModel.getGroupDisplayColumnForGroup(t.getId());return o?(i=e.groupData)==null?void 0:i[o.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return this.valueService.getValue(t,e,!1,!1)}};f([A("valueService")],iu.prototype,"valueService",2);f([A("columnModel")],iu.prototype,"columnModel",2);f([Ee],iu.prototype,"init",1);iu=f([je("rowNodeSorter")],iu);var cl=class extends xe{constructor(){super(...arguments),this.params={},this.ready=!1,this.readyCallbacks=[]}checkReady(){const e=this.params;this.ready=e.gridCtrl!=null&&e.gridBodyCtrl!=null&&e.center!=null&&e.left!=null&&e.right!=null&&e.bottomCenter!=null&&e.bottomLeft!=null&&e.bottomRight!=null&&e.topCenter!=null&&e.topLeft!=null&&e.topRight!=null&&e.stickyTopCenter!=null&&e.stickyTopLeft!=null&&e.stickyTopRight!=null&&e.stickyBottomCenter!=null&&e.stickyBottomLeft!=null&&e.stickyBottomRight!=null&&e.centerHeader!=null&&e.leftHeader!=null&&e.rightHeader!=null&&e.fakeHScrollComp!=null&&e.fakeVScrollComp!=null&&e.gridHeaderCtrl!=null,this.ready&&(this.readyCallbacks.forEach(t=>t(e)),this.readyCallbacks.length=0)}whenReady(e){this.ready?e(this.params):this.readyCallbacks.push(e)}register(e,t){this.params[e]=t,this.checkReady()}registerHeaderContainer(e,t){switch(t){case"left":this.params.leftHeader=e;break;case"right":this.params.rightHeader=e;break;default:this.params.centerHeader=e;break}this.checkReady()}get(e){return this.params[e]}getParams(){return this.params}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){return[this.params.leftHeader,this.params.rightHeader,this.params.centerHeader]}getHeaderRowContainerCtrl(e){switch(e){case"left":return this.params.leftHeader;case"right":return this.params.rightHeader;default:return this.params.centerHeader}}};cl.NAME="ctrlsService";cl=f([je(cl.NAME)],cl);var pw=class extends xe{constructor(){super(...arguments),this.registry={}}register(e){this.registry[e.controllerName]=e.controllerClass}getInstance(e){const t=this.registry[e];if(t!=null)return new t}};pw=f([je("ctrlsFactory")],pw);var Hl=class extends ot{constructor(e,t){super(e),this.direction=t,this.hideTimeout=null}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",a0()||ao())}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=c0(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=["mouseenter","mousedown","touchstart"],t=["mouseleave","touchend"],s=this.getGui();e.forEach(i=>this.addManagedListener(s,i,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0))),t.forEach(i=>this.addManagedListener(s,i,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1)))}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL,e=>{e.direction===this.direction&&(this.hideTimeout!==null&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL_END,()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)})}attemptSettingScrollPosition(e){const t=this.getViewport();YS(()=>ji(t),()=>this.setScrollPosition(e),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedListener(this.getViewport(),"scroll",e)}};f([Ie("eViewport")],Hl.prototype,"eViewport",2);f([Ie("eContainer")],Hl.prototype,"eContainer",2);f([A("scrollVisibleService")],Hl.prototype,"scrollVisibleService",2);f([A("ctrlsService")],Hl.prototype,"ctrlsService",2);f([A("animationFrameService")],Hl.prototype,"animationFrameService",2);var jl=class MI extends Hl{constructor(){super(MI.TEMPLATE,"horizontal")}postConstruct(){super.postConstruct();const t=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedListener(this.eventService,w.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",t),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new mu(s=>this.eContainer.style.width=`${s}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const t=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${t}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const t=this.scrollVisibleService.isVerticalScrollShowing();let s=this.columnModel.getDisplayedColumnsRightWidth();const i=!this.enableRtl&&t,r=this.gos.getScrollbarWidth();i&&(s+=r),Rr(this.eRightSpacer,s),this.eRightSpacer.classList.toggle("ag-scroller-corner",s<=r);let n=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&t&&(n+=r),Rr(this.eLeftSpacer,n),this.eLeftSpacer.classList.toggle("ag-scroller-corner",n<=r)}setScrollVisible(){const t=this.scrollVisibleService.isHorizontalScrollShowing(),s=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),r=t&&this.gos.getScrollbarWidth()||0,o=i?0:r===0&&s?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",s),nl(this.getGui(),o),nl(this.eViewport,o),nl(this.eContainer,o),this.setDisplayed(t,{skipAriaHidden:!0})}getScrollPosition(){return uh(this.getViewport(),this.enableRtl)}setScrollPosition(t){ji(this.getViewport())||this.attemptSettingScrollPosition(t),dh(this.getViewport(),t,this.enableRtl)}};jl.TEMPLATE=`<div class="ag-body-horizontal-scroll" aria-hidden="true">
            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>
            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">
                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>
            </div>
            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>
        </div>`;f([Ie("eLeftSpacer")],jl.prototype,"eLeftSpacer",2);f([Ie("eRightSpacer")],jl.prototype,"eRightSpacer",2);f([A("columnModel")],jl.prototype,"columnModel",2);f([A("pinnedRowModel")],jl.prototype,"pinnedRowModel",2);f([Ee],jl.prototype,"postConstruct",1);var r2=jl,Eh=class extends xe{postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,e),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=this.gos.isDomLayout("print"),t=e?0:this.columnModel.getDisplayedColumnsLeftWidth(),s=e?0:this.columnModel.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:w.EVENT_LEFT_PINNED_WIDTH_CHANGED})),s!=this.rightWidth&&(this.rightWidth=s,this.eventService.dispatchEvent({type:w.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}};f([A("columnModel")],Eh.prototype,"columnModel",2);f([Ee],Eh.prototype,"postConstruct",1);Eh=f([je("pinnedWidthService")],Eh);var ru=class extends xe{constructor(){super(...arguments),this.events=[]}postConstruct(){this.rowModel.getType()=="clientSide"&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e,t){if(this.clientSideRowModel==null){this.eventService.dispatchEvent(e);return}this.events.push(e);const s=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(i=>this.eventService.dispatchEvent(i)),this.events=[]};t?s():(this.dispatchExpandedDebounced==null&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(s)),this.dispatchExpandedDebounced())}};f([A("animationFrameService")],ru.prototype,"animationFrameService",2);f([A("rowModel")],ru.prototype,"rowModel",2);f([Ee],ru.prototype,"postConstruct",1);ru=f([je("rowNodeEventThrottle")],ru);var n2={columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},dndSource:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."},dndSourceOnRowDrag:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."}},Co=(e,t)=>{var s;return((s=t.rowModelType)!=null?s:"clientSide")==="clientSide"?{module:"@ag-grid-enterprise/row-grouping"}:null},o2={enableRowGroup:Co,rowGroup:Co,rowGroupIndex:Co,enablePivot:Co,enableValue:Co,pivot:Co,pivotIndex:Co,aggFunc:Co,cellEditor:e=>e.cellEditor==="agRichSelect"||e.cellEditor==="agRichSelectCellEditor"?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:e=>{var t;const s=["columnsMenuTab","generalMenuTab"];return(t=e.menuTabs)!=null&&t.some(i=>s.includes(i))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],dependencies:(e,{rowSelection:t})=>t==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},children:()=>fc},a2={headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0},l2=Object.keys(a2),fc={objectName:"colDef",allProperties:l2,docsUrl:"column-properties/",deprecations:n2,validations:o2},c2={enableChartToolPanelsButton:{version:"29"},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",renamed:"enterNavigatesVertically"},enterMovesDownAfterEdit:{version:"30",renamed:"enterNavigatesVerticallyAfterEdit"},suppressParentsInRowNodes:{version:"30.2",message:"Using suppressParentsInRowNodes is no longer recommended. To serialize nodes it is now recommended to instead remove the parent node reference before serialization."},advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."}},u2={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!1,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,suppressChartToolPanelsButton:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,functionsPassive:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1},d2={sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",dependencies:e=>{var t;const s=(t=e.rowModelType)!=null?t:"clientSide";switch(s){case"clientSide":const i=`treeData requires 'getDataPath' in the ${s} row model.`;return e.getDataPath?null:i;case"serverSide":const r=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${s} row model.`;return e.isServerSideGroup&&e.getServerSideGroupKey?null:r}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],dependencies:e=>{var t;switch((t=e.rowModelType)!=null?t:"clientSide"){case"clientSide":return null;case"serverSide":return e.suppressServerSideInfiniteScroll?"groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll":null}return null}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},suppressParentsInRowNodes:{dependencies:{groupSelectsChildren:[void 0,!1]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},columnDefs:()=>fc,defaultColDef:()=>fc,defaultColGroupDef:()=>fc,autoGroupColumnDef:()=>fc},h2={objectName:"gridOptions",allProperties:[...ah.ALL_PROPERTIES,...Ef.EVENT_CALLBACKS],propertyExceptions:["api","columnApi"],docsUrl:"grid-options/",deprecations:c2,validations:d2},_t=class{constructor(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new rn,this.globalEventHandlerFactory=e=>(t,s)=>{if(this.destroyed)return;const i=Rg.has(t);if(i&&!e||!i&&e)return;const r=Ef.getCallbackForEvent(t),n=this.gridOptions[r];typeof n=="function"&&this.frameworkOverrides.wrapOutgoing(()=>{n(s)})}}get context(){return this.gridOptions.context}init(){this.columnApi=new Zc(this.api);const e=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),e),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.getScrollbarWidth()}destroy(){this.destroyed=!0,this.columnApi=void 0}get(e){var t;return(t=this.gridOptions[e])!=null?t:u2[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return Ce(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(s=>{const i=s;return i.api=this.api,i.columnApi=this.columnApi,i.context=this.context,e(i)})}static toBoolean(e){return typeof e=="boolean"?e:typeof e=="string"?e.toUpperCase()==="TRUE"||e=="":!1}static toNumber(e){if(typeof e=="number")return e;if(typeof e=="string"){const t=parseInt(e);return isNaN(t)?void 0:t}}static toConstrainedNum(e,t){return s=>{const i=_t.toNumber(s);if(!(i==null||i<e||i>t))return i}}static getCoercedValue(e,t){const s=_t.PROPERTY_COERCIONS.get(e);return s?s(t):t}static getCoercedGridOptions(e){const t={};return Object.entries(e).forEach(([s,i])=>{const r=_t.getCoercedValue(s,i);t[s]=r}),t}updateGridOptions({options:e,force:t,source:s="api"}){const i={id:_t.changeSetId++,properties:[]},r=[];Object.entries(e).forEach(([n,o])=>{s==="api"&&B1[n]&&tt(`${n} is an initial property and cannot be updated.`);const a=_t.getCoercedValue(n,o),l=t||typeof a=="object"&&s==="api",u=this.gridOptions[n];if(l||u!==a){this.gridOptions[n]=a;const h={type:n,currentValue:a,previousValue:u,changeSet:i,source:s};r.push(h)}}),this.validationService.processGridOptions(this.gridOptions),i.properties=r.map(n=>n.type),r.forEach(n=>{this.gridOptions.debug&&console.log(`AG Grid: Updated property ${n.type} from `,n.previousValue," to  ",n.currentValue),this.propertyEventService.dispatchEvent(n)})}addEventListener(e,t){this.propertyEventService.addEventListener(e,t)}removeEventListener(e,t){this.propertyEventService.removeEventListener(e,t)}getScrollbarWidth(){if(this.scrollbarWidth==null){const t=typeof this.gridOptions.scrollbarWidth=="number"&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:ZA();t!=null&&(this.scrollbarWidth=t,this.eventService.dispatchEvent({type:w.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}isRowModelType(e){return this.gridOptions.rowModelType===e||e==="clientSide"&&nt(this.gridOptions.rowModelType)}isDomLayout(e){var t;return((t=this.gridOptions.domLayout)!=null?t:"normal")===e}isRowSelection(){return this.gridOptions.rowSelection==="single"||this.gridOptions.rowSelection==="multiple"}useAsyncEvents(){return!this.get("suppressAsyncEvents")}isGetRowHeightFunction(){return typeof this.gridOptions.getRowHeight=="function"}getRowHeightForNode(e,t=!1,s){if(s==null&&(s=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(t)return{height:s,estimated:!0};const r={node:e,data:e.data},n=this.getCallback("getRowHeight")(r);if(this.isNumeric(n))return n===0&&tt("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,n),estimated:!1}}return e.detail&&this.get("masterDetail")?this.getMasterDetailRowHeight():{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:s,estimated:!1}}getMasterDetailRowHeight(){return this.get("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||nt(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const e=this.environment.refreshRowHeightVariable();return e!==-1?e:(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}getDomDataKey(){return this.domDataKey}getDomData(e,t){const s=e[this.getDomDataKey()];return s?s[t]:void 0}setDomData(e,t,s){const i=this.getDomDataKey();let r=e[i];nt(r)&&(r={},e[i]=r),r[t]=s}getDocument(){let e=null;return this.gridOptions.getDocument&&Ce(this.gridOptions.getDocument)?e=this.gridOptions.getDocument():this.eGridDiv&&(e=this.eGridDiv.ownerDocument),e&&Ce(e)?e:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getActiveDomElement(){return this.getRootNode().activeElement}getAsyncTransactionWaitMillis(){return Ce(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return this.get("ensureDomOrder")?!1:this.get("animateRows")}isGroupRowsSticky(){return!(this.get("paginateChildRows")||this.get("groupHideOpenParents")||this.isDomLayout("print"))}isColumnsSortingCoupledToGroup(){const e=this.gridOptions.autoGroupColumnDef;return!(e!=null&&e.comparator)&&!this.get("treeData")}getGroupAggFiltering(){const e=this.gridOptions.groupAggFiltering;if(typeof e=="function")return this.getCallback("groupAggFiltering");if(e===!0)return()=>!0}getGrandTotalRow(){const e=this.gridOptions.grandTotalRow;if(e)return e;if(this.gridOptions.groupIncludeTotalFooter)return"bottom"}getGroupTotalRowCallback(){const e=this.get("groupTotalRow");if(typeof e=="function")return this.getCallback("groupTotalRow");if(e)return()=>e;const t=this.get("groupIncludeFooter");if(typeof t=="function"){const s=this.getCallback("groupIncludeFooter");return i=>s(i)?"bottom":void 0}return()=>t?"bottom":void 0}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?this.gridOptions.groupDisplayType==="multipleColumns":this.get("groupHideOpenParents")}isGroupUseEntireRow(e){return e?!1:this.gridOptions.groupDisplayType==="groupRows"}getGridCommonParams(){return{api:this.api,columnApi:this.columnApi,context:this.context}}addGridCommonParams(e){const t=e;return t.api=this.api,t.columnApi=this.columnApi,t.context=this.context,t}};_t.PROPERTY_COERCIONS=new Map([...ah.BOOLEAN_PROPERTIES.map(e=>[e,_t.toBoolean]),...ah.NUMBER_PROPERTIES.map(e=>[e,_t.toNumber]),["groupAggFiltering",e=>typeof e=="function"?e:_t.toBoolean(e)],["pageSize",_t.toConstrainedNum(1,Number.MAX_VALUE)],["autoSizePadding",_t.toConstrainedNum(0,Number.MAX_VALUE)],["keepDetailRowsCount",_t.toConstrainedNum(1,Number.MAX_VALUE)],["rowBuffer",_t.toConstrainedNum(0,Number.MAX_VALUE)],["infiniteInitialRowCount",_t.toConstrainedNum(1,Number.MAX_VALUE)],["cacheOverflowSize",_t.toConstrainedNum(1,Number.MAX_VALUE)],["cacheBlockSize",_t.toConstrainedNum(1,Number.MAX_VALUE)],["serverSideInitialRowCount",_t.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelPageSize",_t.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelBufferSize",_t.toConstrainedNum(0,Number.MAX_VALUE)]]);_t.changeSetId=0;f([A("gridOptions")],_t.prototype,"gridOptions",2);f([A("eventService")],_t.prototype,"eventService",2);f([A("environment")],_t.prototype,"environment",2);f([A("frameworkOverrides")],_t.prototype,"frameworkOverrides",2);f([A("eGridDiv")],_t.prototype,"eGridDiv",2);f([A("validationService")],_t.prototype,"validationService",2);f([A("gridApi")],_t.prototype,"api",2);f([Ee],_t.prototype,"init",1);f([Si],_t.prototype,"destroy",1);_t=f([je("gridOptionsService")],_t);var gw=class extends xe{getLocaleTextFunc(){const e=this.gos.getCallback("getLocaleText");if(e)return(s,i,r)=>e({key:s,defaultValue:i,variableValues:r});const t=this.gos.get("localeText");return(s,i,r)=>{let n=t&&t[s];if(n&&r&&r.length){let o=0;for(;!(o>=r.length||n.indexOf("${variable}")===-1);)n=n.replace("${variable}",r[o++])}return n??i}}};gw=f([je("localeService")],gw);var U0=class LI extends Hl{constructor(){super(LI.TEMPLATE,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new ev(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedListener(this.eventService,w.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}setScrollVisible(){const t=this.scrollVisibleService.isVerticalScrollShowing(),s=this.invisibleScrollbar,i=t&&this.gos.getScrollbarWidth()||0,r=i===0&&s?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",s),Rr(this.getGui(),r),Rr(this.eViewport,r),Rr(this.eContainer,r),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:t}=this,i=t.getGridBodyCtrl().getBodyViewportElement(),r=this.getScrollPosition(),n=i.scrollTop;r!=n&&this.setScrollPosition(n,!0)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(t,s){!s&&!ji(this.getViewport())&&this.attemptSettingScrollPosition(t),this.getViewport().scrollTop=t}};U0.TEMPLATE=`<div class="ag-body-vertical-scroll" aria-hidden="true">
            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">
                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>
            </div>
        </div>`;f([Ee],U0.prototype,"postConstruct",1);var p2=U0,Nb={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},_b=["january","february","march","april","may","june","july","august","september","october","november","december"],El=class extends xe{constructor(){super(...arguments),this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}init(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(gc(e.source))})}processDataTypeDefinitions(){var e;const t=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(t).forEach(([i,r])=>{this.dataTypeDefinitions[i]=Jt(Je({},r),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)})});const s=(e=this.gos.get("dataTypeDefinitions"))!=null?e:{};this.dataTypeMatchers={},Object.entries(s).forEach(([i,r])=>{const n=this.processDataTypeDefinition(r,s,[i],t);n&&(this.dataTypeDefinitions[i]=n,r.dataTypeMatcher&&(this.dataTypeMatchers[i]=r.dataTypeMatcher))}),this.checkObjectValueHandlers(t),["dateString","text","number","boolean","date"].forEach(i=>{const r=this.dataTypeMatchers[i];r&&delete this.dataTypeMatchers[i],this.dataTypeMatchers[i]=r??t[i].dataTypeMatcher})}mergeDataTypeDefinitions(e,t){const s=Je(Je({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(s.columnTypes=[...this.convertColumnTypes(e.columnTypes),...this.convertColumnTypes(t.columnTypes)]),s}processDataTypeDefinition(e,t,s,i){let r;const n=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=i[n];const a=t[n];if(o&&a&&(o=a),!this.validateDataTypeDefinition(e,o,n))return;r=this.mergeDataTypeDefinitions(o,e)}else{if(s.includes(n)){tt('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');return}const o=t[n];if(!this.validateDataTypeDefinition(e,o,n))return;const a=this.processDataTypeDefinition(o,t,[...s,n],i);if(!a)return;r=this.mergeDataTypeDefinitions(a,e)}return Jt(Je({},r),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)})}validateDataTypeDefinition(e,t,s){return t?t.baseDataType!==e.baseDataType?(tt('The "baseDataType" property of a data type definition must match that of its parent.'),!1):!0:(tt(`The data type definition ${s} does not exist.`),!1)}createGroupSafeValueFormatter(e){if(e.valueFormatter)return t=>{var s,i;if((s=t.node)!=null&&s.group){const r=t.column.getAggFunc();if(r){if(r==="first"||r==="last")return e.valueFormatter(t);if(e.baseDataType==="number"&&r!=="count"){if(typeof t.value=="number")return e.valueFormatter(t);if(typeof t.value=="object"){if(!t.value)return;if("toNumber"in t.value)return e.valueFormatter(Jt(Je({},t),{value:t.value.toNumber()}));if("value"in t.value)return e.valueFormatter(Jt(Je({},t),{value:t.value.value}))}}}if(!this.gos.get("suppressGroupMaintainValueType"))return}else if(this.groupHideOpenParents&&t.column.isRowGroupActive()){if(typeof t.value!="string"||(i=e.dataTypeMatcher)!=null&&i.call(e,t.value))return e.valueFormatter(t);if(!this.gos.get("suppressGroupMaintainValueType"))return}return e.valueFormatter(t)}}updateColDefAndGetDataTypeDefinitionColumnType(e,t,s){let{cellDataType:i}=t;const{field:r}=t;if(i===void 0&&(i=e.cellDataType),(i==null||i===!0)&&(i=this.canInferCellDataType(e,t)?this.inferCellDataType(r,s):!1),!i){e.cellDataType=!1;return}const n=this.dataTypeDefinitions[i];if(!n){tt(`Missing data type definition - "${i}"`);return}return e.cellDataType=i,n.groupSafeValueFormatter&&(e.valueFormatter=n.groupSafeValueFormatter),n.valueParser&&(e.valueParser=n.valueParser),n.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,s),n.columnTypes}updateColDefAndGetColumnType(e,t,s){var i,r;const n=this.updateColDefAndGetDataTypeDefinitionColumnType(e,t,s),o=(r=(i=t.type)!=null?i:n)!=null?r:e.type;return e.type=o,o?this.convertColumnTypes(o):void 0}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const s=i=>{t.add(i.key)};e.addEventListener(Vt.EVENT_STATE_UPDATED,s),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.removeEventListener(Vt.EVENT_STATE_UPDATED,s))}canInferCellDataType(e,t){var s;if(this.rowModel.getType()!=="clientSide")return!1;const i={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,i))return!1;const r=t.type===null?e.type:t.type;if(r){const n=(s=this.gos.get("columnTypes"))!=null?s:{};if(this.convertColumnTypes(r).some(a=>{const l=n[a.trim()];return l&&this.doColDefPropsPreventInference(l,i)}))return!1}return!this.doColDefPropsPreventInference(e,i)}doColDefPropsPreventInference(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([s,i])=>this.doesColDefPropPreventInference(e,t,s,i))}doesColDefPropPreventInference(e,t,s,i){if(!t[s])return!1;const r=e[s];return r===null?(t[s]=!1,!1):i===void 0?!!r:r===i}inferCellDataType(e,t){var s;if(!e)return;let i;const r=this.getInitialData();if(r){const o=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");i=Ec(r,e,o)}else this.initWaitForRowData(t);if(i==null)return;const[n]=(s=Object.entries(this.dataTypeMatchers).find(([o,a])=>a(i)))!=null?s:["object"];return n}getInitialData(){const e=this.gos.get("rowData");if(e!=null&&e.length)return e[0];if(this.initialData)return this.initialData;{const t=this.rowModel.getRootNode().allLeafChildren;if(t!=null&&t.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions;t&&this.columnModel.queueResizeOperations();const s=this.addManagedListener(this.eventService,w.EVENT_ROW_DATA_UPDATE_STARTED,i=>{const{firstRowData:r}=i;if(!r)return;s==null||s(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(r,t),this.columnStateUpdatesPendingInference={},t&&this.columnModel.processResizeOperations();const n={type:w.EVENT_DATA_TYPES_INFERRED};this.eventService.dispatchEvent(n)})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(e,t){this.initialData=e;const s=[];this.columnStateUpdateListenerDestroyFuncs.forEach(n=>n()),this.columnStateUpdateListenerDestroyFuncs=[];const i={},r={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([n,o])=>{const a=this.columnModel.getGridColumn(n);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColumnDefIntoColumn(a,"cellDataTypeInferred"))return;const u=a.getColDef();if(t&&u.type&&u.type!==l.type){const h=this.getUpdatedColumnState(a,o);h.rowGroup&&h.rowGroupIndex==null&&(i[n]=h),h.pivot&&h.pivotIndex==null&&(r[n]=h),s.push(h)}}),t&&s.push(...this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(i,r)),s.length&&this.columnModel.applyColumnState({state:s},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const s=this.columnModel.getColumnStateFromColDef(e);return t.forEach(i=>{delete s[i],i==="rowGroup"?delete s.rowGroupIndex:i==="pivot"&&delete s.pivotIndex}),s}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,s=e.object;this.hasObjectValueParser=t.valueParser!==s.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==s.valueFormatter}convertColumnTypes(e){let t=[];return e instanceof Array?e.some(i=>typeof i!="string")?console.warn("if colDef.type is supplied an array it should be of type 'string[]'"):t=e:typeof e=="string"?t=e.split(","):console.warn("colDef.type should be of type 'string' | 'string[]'"),t}getDateStringTypeDefinition(e){var t;return e?(t=this.getDataTypeDefinition(e))!=null?t:this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){var t;return(t=this.getDataTypeDefinition(e))==null?void 0:t.baseDataType}checkType(e,t){var s;if(t==null)return!0;const i=(s=this.getDataTypeDefinition(e))==null?void 0:s.dataTypeMatcher;return i?i(t):!0}validateColDef(e){e.cellDataType==="object"&&(e.valueFormatter===this.dataTypeDefinitions.object.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&tt('Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&tt('Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'))}setColDefPropertiesForBaseDataType(e,t,s){const i=(a,l,u)=>{let h=a.getColDef().valueFormatter;return h===t.groupSafeValueFormatter&&(h=t.valueFormatter),this.valueService.formatValue(a,l,u,h)},r=Nt.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()),n=this.localeService.getLocaleTextFunc(),o=a=>{const{filterParams:l}=e;e.filterParams=typeof l=="object"?Je(Je({},l),a):a};switch(t.baseDataType){case"number":{e.cellEditor="agNumberCellEditor",r&&o({comparator:(a,l)=>{const u=a==null?0:parseInt(a),h=l==null?0:parseInt(l);return u===h?0:u>h?1:-1}});break}case"boolean":{e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=a=>!!a.colDef.editable&&a.event.key===z.SPACE,o(r?{valueFormatter:a=>Ce(a.value)?n(String(a.value),a.value?"True":"False"):n("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(a,l)=>l,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(a,l)=>l===!1,numberOfInputs:0}]});break}case"date":{e.cellEditor="agDateCellEditor",e.keyCreator=a=>i(a.column,a.node,a.value),r&&o({valueFormatter:a=>{const l=i(a.column,a.node,a.value);return Ce(l)?l:n("blanks","(Blanks)")},treeList:!0,treeListFormatter:(a,l)=>{if(l===1&&a!=null){const u=_b[Number(a)-1];return n(u,Nb[u])}return a??n("blanks","(Blanks)")}});break}case"dateString":{e.cellEditor="agDateStringCellEditor",e.keyCreator=l=>i(l.column,l.node,l.value);const a=t.dateParser;o(r?{valueFormatter:l=>{const u=i(l.column,l.node,l.value);return Ce(u)?u:n("blanks","(Blanks)")},treeList:!0,treeListPathGetter:l=>{const u=a(l??void 0);return u?[String(u.getFullYear()),String(u.getMonth()+1),String(u.getDate())]:null},treeListFormatter:(l,u)=>{if(u===1&&l!=null){const h=_b[Number(l)-1];return n(h,Nb[h])}return l??n("blanks","(Blanks)")}}:{comparator:(l,u)=>{const h=a(u);return u==null||h<l?-1:h>l?1:0}});break}case"object":{e.cellEditorParams={useFormatter:!0},e.comparator=(a,l)=>{const u=this.columnModel.getPrimaryColumn(s),h=u==null?void 0:u.getColDef();if(!u||!h)return 0;const p=a==null?"":i(u,null,a),g=l==null?"":i(u,null,l);return p===g?0:p>g?1:-1},e.keyCreator=a=>i(a.column,a.node,a.value),r?o({valueFormatter:a=>{const l=i(a.column,a.node,a.value);return Ce(l)?l:n("blanks","(Blanks)")}}):e.filterValueGetter=a=>i(a.column,a.node,this.valueService.getValue(a.column,a.node));break}}}getDefaultDataTypes(){const e=s=>!!s.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:s=>{var i,r;return((r=(i=s.newValue)==null?void 0:i.trim)==null?void 0:r.call(i))===""?null:Number(s.newValue)},valueFormatter:s=>s.value==null?"":typeof s.value!="number"||isNaN(s.value)?t("invalidNumber","Invalid Number"):String(s.value),dataTypeMatcher:s=>typeof s=="number"},text:{baseDataType:"text",valueParser:s=>s.newValue===""?null:ih(s.newValue),dataTypeMatcher:s=>typeof s=="string"},boolean:{baseDataType:"boolean",valueParser:s=>{var i,r;return s.newValue==null?s.newValue:((r=(i=s.newValue)==null?void 0:i.trim)==null?void 0:r.call(i))===""?null:String(s.newValue).toLowerCase()==="true"},valueFormatter:s=>s.value==null?"":String(s.value),dataTypeMatcher:s=>typeof s=="boolean"},date:{baseDataType:"date",valueParser:s=>Li(s.newValue==null?null:String(s.newValue)),valueFormatter:s=>{var i;return s.value==null?"":!(s.value instanceof Date)||isNaN(s.value.getTime())?t("invalidDate","Invalid Date"):(i=br(s.value,!1))!=null?i:""},dataTypeMatcher:s=>s instanceof Date},dateString:{baseDataType:"dateString",dateParser:s=>{var i;return(i=Li(s))!=null?i:void 0},dateFormatter:s=>{var i;return(i=br(s??null,!1))!=null?i:void 0},valueParser:s=>e(String(s.newValue))?s.newValue:null,valueFormatter:s=>e(String(s.value))?s.value:"",dataTypeMatcher:s=>typeof s=="string"&&e(s)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:s=>{var i;return(i=ih(s.value))!=null?i:""}}}}};f([A("rowModel")],El.prototype,"rowModel",2);f([A("columnModel")],El.prototype,"columnModel",2);f([A("valueService")],El.prototype,"valueService",2);f([Ee],El.prototype,"init",1);El=f([je("dataTypeService")],El);var bl=class extends xe{constructor(){super(...arguments),this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.ctrlsService.whenReady(()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){this.columnModel.setColumnDefs(e??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.dispatchGridReadyEvent();const e=Nt.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId());new z0("AG Grid",()=>this.gos.get("debug")).log(`initialised successfully, enterprise = ${e}`)}dispatchGridReadyEvent(){const e={type:w.EVENT_GRID_READY};this.eventService.dispatchEvent(e)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.columnModel.setColumnDefs(t,gc(e.source))}}};f([A("ctrlsService")],bl.prototype,"ctrlsService",2);f([A("columnModel")],bl.prototype,"columnModel",2);f([A("rowModel")],bl.prototype,"rowModel",2);f([Ee],bl.prototype,"postConstruct",1);bl=f([je("syncService")],bl);var Rl=class extends xe{constructor(){super(...arguments),this.manuallyDisplayed=!1}postConstruct(){this.addManagedListener(this.eventService,w.EVENT_ROW_DATA_UPDATED,()=>this.onRowDataUpdated()),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}registerOverlayWrapperComp(e){this.overlayWrapperComp=e,(!this.gos.get("columnDefs")||this.gos.isRowModelType("clientSide")&&!this.gos.get("rowData"))&&this.showLoadingOverlay()}showLoadingOverlay(){if(this.gos.get("suppressLoadingOverlay"))return;const e={},t=this.userComponentFactory.getLoadingOverlayCompDetails(e);this.showOverlay(t,"ag-overlay-loading-wrapper","loadingOverlayComponentParams")}showNoRowsOverlay(){if(this.gos.get("suppressNoRowsOverlay"))return;const e={},t=this.userComponentFactory.getNoRowsOverlayCompDetails(e);this.showOverlay(t,"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams")}showOverlay(e,t,s){const i=e.newAgStackInstance(),r=this.addManagedPropertyListener(s,({currentValue:n})=>{i.then(o=>{o.refresh&&o.refresh(this.gos.addGridCommonParams(Je({},n??{})))})});this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.overlayWrapperComp.showOverlay(i,t,r)}hideOverlay(){this.manuallyDisplayed=!1,this.overlayWrapperComp.hideOverlay()}showOrHideOverlay(){const e=this.paginationProxy.isEmpty(),t=this.gos.get("suppressNoRowsOverlay");e&&!t?this.showNoRowsOverlay():this.hideOverlay()}onRowDataUpdated(){this.showOrHideOverlay()}onNewColumnsLoaded(){this.columnModel.isReady()&&!this.paginationProxy.isEmpty()&&!this.manuallyDisplayed&&this.hideOverlay()}};f([A("userComponentFactory")],Rl.prototype,"userComponentFactory",2);f([A("paginationProxy")],Rl.prototype,"paginationProxy",2);f([A("columnModel")],Rl.prototype,"columnModel",2);f([Ee],Rl.prototype,"postConstruct",1);Rl=f([je("overlayService")],Rl);var fi=class extends xe{constructor(){super(...arguments),this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=pi(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=pi(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=pi(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){var e;this.isClientSideRowModel=this.rowModel.getType()==="clientSide",this.cachedState=(e=this.gos.get("initialState"))!=null?e:{},this.ctrlsService.whenReady(()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const t=this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,({source:r})=>{r==="gridInitializing"&&(t==null||t(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))}),s=this.addManagedListener(this.eventService,w.EVENT_ROW_COUNT_READY,()=>{s==null||s(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())}),i=this.addManagedListener(this.eventService,w.EVENT_FIRST_DATA_RENDERED,()=>{i==null||i(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState()),this.addManagedListener(this.eventService,w.EVENT_TOOL_PANEL_VISIBLE_CHANGED,()=>this.updateCachedState("sideBar",this.getSideBarState())),this.addManagedListener(this.eventService,w.EVENT_SIDE_BAR_UPDATED,()=>this.updateCachedState("sideBar",this.getSideBarState()))}setupStateOnColumnsInitialised(){var e;const t=(e=this.gos.get("initialState"))!=null?e:{};this.setColumnState(t),this.setColumnGroupState(t),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState()),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,()=>this.updateColumnState(["aggregation"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_MOVED,()=>this.updateColumnState(["columnOrder"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PINNED,()=>this.updateColumnState(["columnPinning"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_RESIZED,()=>this.updateColumnState(["columnSizing"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VISIBLE,()=>this.updateColumnState(["columnVisibility"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateColumnState(["rowGroup"])),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,()=>this.updateColumnState(["sort"])),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"])),this.addManagedListener(this.eventService,w.EVENT_COLUMN_GROUP_OPENED,()=>this.updateCachedState("columnGroup",this.getColumnGroupState()))}setupStateOnRowCountReady(){var e;const{filter:t,rowGroupExpansion:s,rowSelection:i,pagination:r}=(e=this.gos.get("initialState"))!=null?e:{},n=this.gos.get("advancedFilterModel");(t||n)&&this.setFilterState(t,n),s&&this.setRowGroupExpansionState(s),i&&this.setRowSelectionState(i),r&&this.setPaginationState(r),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState()),this.addManagedListener(this.eventService,w.EVENT_FILTER_CHANGED,()=>this.updateCachedState("filter",this.getFilterState())),this.addManagedListener(this.eventService,w.EVENT_ROW_GROUP_OPENED,()=>this.onRowGroupOpenedDebounced()),this.addManagedListener(this.eventService,w.EVENT_EXPAND_COLLAPSE_ALL,()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())),this.addManagedListener(this.eventService,w.EVENT_SELECTION_CHANGED,()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()}),this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,o=>{(o.newPage||o.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())})}setupStateOnFirstDataRendered(){var e;const{scroll:t,rangeSelection:s,focusedCell:i,columnOrder:r}=(e=this.gos.get("initialState"))!=null?e:{};i&&this.setFocusedCellState(i),s&&this.setRangeSelectionState(s),t&&this.setScrollState(t),this.setColumnPivotState(!!(r!=null&&r.orderedColIds)),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState()),this.updateCachedState("rangeSelection",this.getRangeSelectionState()),this.updateCachedState("scroll",this.getScrollState()),this.addManagedListener(this.eventService,w.EVENT_CELL_FOCUSED,()=>this.updateCachedState("focusedCell",this.getFocusedCellState())),this.addManagedListener(this.eventService,w.EVENT_RANGE_SELECTION_CHANGED,n=>{n.finished&&this.updateCachedState("rangeSelection",this.getRangeSelectionState())}),this.addManagedListener(this.eventService,w.EVENT_BODY_SCROLL_END,()=>this.updateCachedState("scroll",this.getScrollState()))}getColumnState(){const e=this.columnModel.isPivotMode(),t=[],s=[],i=[],r=[],n=[],o=[],a=[],l=[],u=[],h=this.columnModel.getColumnState();for(let p=0;p<h.length;p++){const{colId:g,sort:m,sortIndex:C,rowGroup:y,rowGroupIndex:R,aggFunc:x,pivot:S,pivotIndex:T,pinned:I,hide:V,width:H,flex:P}=h[p];u.push(g),m&&(t[C??0]={colId:g,sort:m}),y&&(s[R??0]=g),typeof x=="string"&&i.push({colId:g,aggFunc:x}),S&&(r[T??0]=g),I&&(I==="right"?o:n).push(g),V&&a.push(g),(P||H)&&l.push({colId:g,flex:P??void 0,width:H})}return{sort:t.length?{sortModel:t}:void 0,rowGroup:s.length?{groupColIds:s}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:r.length||e?{pivotMode:e,pivotColIds:r}:void 0,columnPinning:n.length||o.length?{leftColIds:n,rightColIds:o}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:u.length?{orderedColIds:u}:void 0}}setColumnState(e){const{sort:t,rowGroup:s,aggregation:i,pivot:r,columnPinning:n,columnVisibility:o,columnSizing:a,columnOrder:l}=e,u={},h=C=>{let y=u[C];return y||(y={colId:C},u[C]=y,y)};t&&t.sortModel.forEach(({colId:C,sort:y},R)=>{const x=h(C);x.sort=y,x.sortIndex=R}),s&&s.groupColIds.forEach((C,y)=>{const R=h(C);R.rowGroup=!0,R.rowGroupIndex=y}),i&&i.aggregationModel.forEach(({colId:C,aggFunc:y})=>{h(C).aggFunc=y}),r&&(r.pivotColIds.forEach((C,y)=>{const R=h(C);R.pivot=!0,R.pivotIndex=y}),this.gos.updateGridOptions({options:{pivotMode:r.pivotMode},source:"gridInitializing"})),n&&(n.leftColIds.forEach(C=>{h(C).pinned="left"}),n.rightColIds.forEach(C=>{h(C).pinned="right"})),o&&o.hiddenColIds.forEach(C=>{h(C).hide=!0}),a&&a.columnSizingModel.forEach(({colId:C,flex:y,width:R})=>{const x=h(C);x.flex=y??null,x.width=R});const p=l==null?void 0:l.orderedColIds,g=!!(p!=null&&p.length),m=g?p.map(C=>h(C)):Object.values(u);if(m.length){this.columnStates=m;const C={sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};this.columnModel.applyColumnState({state:m,applyOrder:g,defaultState:C},"gridInitializing")}}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const s=this.columnGroupStates;if(this.columnGroupStates=void 0,!!this.columnModel.isSecondaryColumnsPresent()){if(t){let i=[];for(const r of t)this.columnModel.getSecondaryColumn(r.colId)&&i.push(r);this.columnModel.applyColumnState({state:i,applyOrder:e},"gridInitializing")}s&&this.columnModel.setColumnGroupState(s,"gridInitializing")}}getColumnGroupState(){const e=this.columnModel.getColumnGroupState(),t=[];return e.forEach(({groupId:s,open:i})=>{i&&t.push(s)}),t.length?{openColumnGroupIds:t}:void 0}setColumnGroupState(e){var t;if(!e.hasOwnProperty("columnGroup"))return;const s=new Set((t=e.columnGroup)==null?void 0:t.openColumnGroupIds),r=this.columnModel.getColumnGroupState().map(({groupId:n})=>{const o=s.has(n);return o&&s.delete(n),{groupId:n,open:o}});s.forEach(n=>{r.push({groupId:n,open:!0})}),r.length&&(this.columnGroupStates=r),this.columnModel.setColumnGroupState(r,"gridInitializing")}getFilterState(){var e;let t=this.filterManager.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);const s=(e=this.filterManager.getAdvancedFilterModel())!=null?e:void 0;return t||s?{filterModel:t,advancedFilterModel:s}:void 0}setFilterState(e,t){const{filterModel:s,advancedFilterModel:i}=e??{advancedFilterModel:t};s&&this.filterManager.setFilterModel(s,"columnFilter"),i&&this.filterManager.setAdvancedFilterModel(i)}getRangeSelectionState(){var e;const t=(e=this.rangeService)==null?void 0:e.getCellRanges().map(s=>{const{id:i,type:r,startRow:n,endRow:o,columns:a,startColumn:l}=s;return{id:i,type:r,startRow:n,endRow:o,colIds:a.map(u=>u.getColId()),startColId:l.getColId()}});return t!=null&&t.length?{cellRanges:t}:void 0}setRangeSelectionState(e){if(!this.gos.get("enableRangeSelection")||!this.rangeService)return;const t=[];e.cellRanges.forEach(s=>{const i=[];if(s.colIds.forEach(n=>{const o=this.columnModel.getGridColumn(n);o&&i.push(o)}),!i.length)return;let r=this.columnModel.getGridColumn(s.startColId);if(!r){const n=this.columnModel.getAllDisplayedColumns(),o=new Set(i);r=n.find(a=>o.has(a))}t.push(Jt(Je({},s),{columns:i,startColumn:r}))}),this.rangeService.setCellRanges(t)}getScrollState(){var e,t,s;if(!this.isClientSideRowModel)return;const i=(e=this.ctrlsService.getGridBodyCtrl())==null?void 0:e.getScrollFeature(),{left:r}=(t=i==null?void 0:i.getHScrollPosition())!=null?t:{left:0},{top:n}=(s=i==null?void 0:i.getVScrollPosition())!=null?s:{top:0};return n||r?{top:n,left:r}:void 0}setScrollState(e){var t;if(!this.isClientSideRowModel)return;const{top:s,left:i}=e;(t=this.ctrlsService.getGridBodyCtrl())==null||t.getScrollFeature().setScrollPosition(s,i)}getSideBarState(){var e,t;return(t=(e=this.sideBarService)==null?void 0:e.getSideBarComp())==null?void 0:t.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.focusService.getFocusedCell();if(e){const{column:t,rowIndex:s,rowPinned:i}=e;return{colId:t.getColId(),rowIndex:s,rowPinned:i}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:s,rowPinned:i}=e;this.focusService.setFocusedCell({column:this.columnModel.getGridColumn(t),rowIndex:s,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const e=this.paginationProxy.getCurrentPage(),t=this.gos.get("paginationAutoPageSize")?void 0:this.paginationProxy.getPageSize();if(!(!e&&!t))return{page:e,pageSize:t}}setPaginationState(e){e.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationProxy.setPageSize(e.pageSize,"initialState"),typeof e.page=="number"&&this.paginationProxy.setPage(e.page)}getRowSelectionState(){var e;const t=this.selectionService.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!((e=t==null?void 0:t.toggledNodes)!=null&&e.length)?void 0:t}setRowSelectionState(e){this.selectionService.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const e=this.expansionService.getExpandedRows();return e.length?{expandedRowGroupIds:e}:void 0}setRowGroupExpansionState(e){this.expansionService.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let s=!1;Object.entries(t).forEach(([i,r])=>{jy(r,this.cachedState[i])||(s=!0)}),this.cachedState=Je(Je({},this.cachedState),t),s&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const s=this.cachedState[e];this.setCachedStateValue(e,t),jy(t,s)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=Jt(Je({},this.cachedState),{[e]:t})}refreshStaleState(){this.staleStateKeys.forEach(e=>{switch(e){case"rowSelection":this.setCachedStateValue(e,this.getRowSelectionState());break}}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(t=>this.queuedUpdateSources.add(t)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear();const t={type:w.EVENT_STATE_UPDATED,sources:e,state:this.cachedState};this.eventService.dispatchEvent(t)}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),e(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}};f([A("filterManager")],fi.prototype,"filterManager",2);f([A("ctrlsService")],fi.prototype,"ctrlsService",2);f([A("focusService")],fi.prototype,"focusService",2);f([A("columnModel")],fi.prototype,"columnModel",2);f([A("paginationProxy")],fi.prototype,"paginationProxy",2);f([A("rowModel")],fi.prototype,"rowModel",2);f([A("selectionService")],fi.prototype,"selectionService",2);f([A("expansionService")],fi.prototype,"expansionService",2);f([A("columnAnimationService")],fi.prototype,"columnAnimationService",2);f([Lt("sideBarService")],fi.prototype,"sideBarService",2);f([Lt("rangeService")],fi.prototype,"rangeService",2);f([Ee],fi.prototype,"postConstruct",1);fi=f([je("stateService")],fi);var bh=class extends xe{init(){this.processGridOptions(this.gridOptions)}processGridOptions(e){this.processOptions(e,h2)}processColumnDefs(e){this.processOptions(e,fc)}processOptions(e,t){const{validations:s,deprecations:i,allProperties:r,propertyExceptions:n,objectName:o,docsUrl:a}=t;r&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...n??[],...Object.keys(i)],r,o,a);const l=new Set;Object.keys(e).forEach(h=>{var p;const g=i[h];if(g)if("renamed"in g){const{renamed:T,version:I}=g;l.add(`As of v${I}, ${String(h)} is deprecated. Please use ${String(T)} instead.`),e[T]=e[h]}else{const{message:T,version:I}=g;l.add(`As of v${I}, ${String(h)} is deprecated. ${T??""}`)}const m=e[h];if(m==null||m===!1)return;const C=s[h];let y;if(C)if(typeof C=="function"){const T=C(e,this.gridOptions);if(!T)return;if("objectName"in T){const I=e[h];if(Array.isArray(I)){I.forEach(V=>{this.processOptions(V,T)});return}this.processOptions(e[h],T);return}y=T}else y=C;else return;const{module:R,dependencies:x,supportedRowModels:S}=y;if(S){const T=(p=this.gridOptions.rowModelType)!=null?p:"clientSide";if(!S.includes(T)){l.add(`${String(h)} is not supported with the '${T}' row model.`);return}}if(R){const T=Array.isArray(R)?R:[R];let I=!0;if(T.forEach(V=>{Nt.__assertRegistered(V,String(h),this.context.getGridId())||(I=!1,l.add(`${String(h)} is only available when ${V} is loaded.`))}),!I)return}if(x){const T=this.checkForWarning(h,x,e);if(T){l.add(T);return}}}),l.size>0&&l.forEach(h=>{tt(h)})}checkForWarning(e,t,s){if(typeof t=="function")return t(s,this.gridOptions);const r=Object.entries(t).find(([a,l])=>{const u=s[a];return!l.includes(u)});if(!r)return null;const[n,o]=r;return o.length>1?`'${String(e)}' requires '${n}' to be one of [${o.join(", ")}].`:`'${String(e)}' requires '${n}' to be ${o[0]}.`}checkProperties(e,t,s,i,r){const n=["__ob__","__v_skip","__metadata__"],o=dF(Object.getOwnPropertyNames(e),[...n,...t,...s],s);if(ei(o,(a,l)=>{tt(`invalid ${i} property '${a}' did you mean any of these: ${l.slice(0,8).join(", ")}`)}),Object.keys(o).length>0&&r){const a=this.getFrameworkOverrides().getDocLink(r);tt(`to see all the valid ${i} properties please check: ${a}`)}}};f([A("gridOptions")],bh.prototype,"gridOptions",2);f([Ee],bh.prototype,"init",1);bh=f([je("validationService")],bh);var kf=class extends xe{constructor(){super(...arguments),this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new qS(this.getFrameworkOverrides())}addEventListener(e,t){const s=this.frameworkEventWrappingService.wrap(t),i=this.gos.useAsyncEvents()&&!Rg.has(e),r=i?this.asyncEventListeners:this.syncEventListeners;r.has(e)||r.set(e,new Set),r.get(e).add(s),this.eventService.addEventListener(e,s,i)}removeEventListener(e,t){var s;const i=this.frameworkEventWrappingService.unwrap(t),r=this.asyncEventListeners.get(e),n=!!(r!=null&&r.delete(i));n||(s=this.syncEventListeners.get(e))==null||s.delete(i),this.eventService.removeEventListener(e,i,n)}addGlobalListener(e){const t=this.frameworkEventWrappingService.wrapGlobal(e);if(this.gos.useAsyncEvents()){const i=(n,o)=>{Rg.has(n)&&t(n,o)},r=(n,o)=>{Rg.has(n)||t(n,o)};this.globalEventListenerPairs.set(e,{syncListener:i,asyncListener:r}),this.eventService.addGlobalListener(i,!1),this.eventService.addGlobalListener(r,!0)}else this.syncGlobalEventListeners.add(t),this.eventService.addGlobalListener(t,!1)}removeGlobalListener(e){const t=this.frameworkEventWrappingService.unwrapGlobal(e);if(this.globalEventListenerPairs.has(t)){const{syncListener:i,asyncListener:r}=this.globalEventListenerPairs.get(t);this.eventService.removeGlobalListener(i,!1),this.eventService.removeGlobalListener(r,!0),this.globalEventListenerPairs.delete(e)}else this.syncGlobalEventListeners.delete(t),this.eventService.removeGlobalListener(t,!1)}destroyEventListeners(e,t){e.forEach((s,i)=>{s.forEach(r=>this.eventService.removeEventListener(i,r,t)),s.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(s=>this.eventService.removeGlobalListener(s,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(({syncListener:e,asyncListener:t})=>{this.eventService.removeGlobalListener(e,!1),this.eventService.removeGlobalListener(t,!0)}),this.globalEventListenerPairs.clear()}};f([Ee],kf.prototype,"postConstruct",1);kf=f([je("apiEventService")],kf);var $0=class extends ot{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.paginationProxy.getPageSize()||(this.paginationProxy.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}init(){this.addManagedPropertyListener("paginationPageSizeSelector",()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedListener(this.eventService,w.EVENT_PAGINATION_CHANGED,e=>this.handlePaginationChanged(e))}handlePaginationChanged(e){if(!this.selectPageSizeComp||!(e!=null&&e.newPageSize))return;const t=this.paginationProxy.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp&&this.appendChild(this.selectPageSizeComp))}reset(){fs(this.getGui()),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0)}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get("paginationPageSizeSelector")!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.paginationProxy.getPageSize(),s=!t||!e.includes(t);s&&(e.unshift(""),tt(`The paginationPageSize grid option is set to a value that is not in the list of page size options.
                Please make sure that the paginationPageSize grid option is set to one of the values in the 
                paginationPageSizeSelector array, or set the paginationPageSizeSelector to false to hide the page size selector.`)),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0);const i=this.localeService.getLocaleTextFunc(),r=i("pageSizeSelectorLabel","Page Size:"),n=e.map(a=>({value:String(a),text:String(a)})),o=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new Um).addOptions(n).setValue(String(s?"":t)).setAriaLabel(o).setLabel(r).onValueChange(()=>this.handlePageSizeItemSelected()),this.hasEmptyOption=s}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get("paginationPageSizeSelector");return!Array.isArray(t)||!this.validateValues(t)?e:[...t].sort((s,i)=>s-i)}validateValues(e){if(!e.length)return tt(`The paginationPageSizeSelector grid option is an empty array. This is most likely a mistake.
                If you want to hide the page size selector, please set the paginationPageSizeSelector to false.`),!1;for(let t=0;t<e.length;t++){const s=e[t],i=typeof s=="number",r=s>0;if(!i)return tt(`The paginationPageSizeSelector grid option contains a non-numeric value.
                    Please make sure that all values in the paginationPageSizeSelector array are numbers.`),!1;if(!r)return tt(`The paginationPageSizeSelector grid option contains a negative number or zero.
                    Please make sure that all values in the paginationPageSizeSelector array are positive.`),!1}return!0}destroy(){this.toggleSelectDisplay(!1),super.destroy()}};f([A("paginationProxy")],$0.prototype,"paginationProxy",2);f([Ee],$0.prototype,"init",1);var Rh=class extends xe{constructor(){super(),this.descriptionContainer=null,this.announceValue=pi(this.announceValue.bind(this),200)}postConstruct(){const e=this.gos.getDocument(),t=this.descriptionContainer=e.createElement("div");t.classList.add("ag-aria-description-container"),XS(t,"polite"),GA(t,"additions text"),OA(t,!0),this.eGridDiv.appendChild(t)}announceValue(e){this.descriptionContainer&&(this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=e)},50))}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(fs(e),e.parentElement&&e.parentElement.removeChild(e)),this.descriptionContainer=null,this.eGridDiv=null}};f([A("eGridDiv")],Rh.prototype,"eGridDiv",2);f([Ee],Rh.prototype,"postConstruct",1);Rh=f([je("ariaAnnouncementService")],Rh);var fw=class{};fw.gridOptions=void 0;var g2=1,f2=class{create(e,t,s,i,r){var n;let o={};fw.gridOptions?(Mi(o,fw.gridOptions,!0,!0),o=Je(Je({},o),t)):o=t;const a=_t.getCoercedGridOptions(o),l=!!a.debug,u=(n=a.gridId)!=null?n:String(g2++),h=this.getRegisteredModules(r,u),p=this.createBeansList(a.rowModelType,h,u),g=this.createProvidedBeans(e,a,r);if(!p){Ua("Failed to create grid.");return}const m={providedBeanInstances:g,beanClasses:p,debug:l,gridId:u},C=new z0("Context",()=>m.debug),y=new R1(m,C),R=y.getBean("beans");return this.registerModuleUserComponents(R,h),this.registerStackComponents(R,h),this.registerControllers(R,h),s(y),R.syncService.start(),i&&i(y),y.getBean("gridApi")}registerControllers(e,t){t.forEach(s=>{s.controllers&&s.controllers.forEach(i=>e.ctrlsFactory.register(i))})}registerStackComponents(e,t){const s=this.createAgStackComponentsList(t);e.agStackComponentsRegistry.setupComponents(s)}getRegisteredModules(e,t){const s=e?e.modules:null,i=Nt.__getRegisteredModules(t),r=[],n={},o=(a,l,u)=>{(p=>{n[p.moduleName]||(n[p.moduleName]=!0,r.push(p),Nt.__register(p,a,u))})(l),l.dependantModules&&l.dependantModules.forEach(p=>o(a,p,u))};return s&&s.forEach(a=>o(!0,a,t)),i&&i.forEach(a=>o(!Nt.__isPackageBased(),a,void 0)),r}registerModuleUserComponents(e,t){this.extractModuleEntity(t,i=>i.userComponents?i.userComponents:[]).forEach(i=>{e.userComponentRegistry.registerDefaultComponent(i.componentName,i.componentClass)})}createProvidedBeans(e,t,s){let i=s?s.frameworkOverrides:null;nt(i)&&(i=new II);const r={gridOptions:t,eGridDiv:e,globalEventListener:s?s.globalEventListener:null,globalSyncEventListener:s?s.globalSyncEventListener:null,frameworkOverrides:i};return s&&s.providedBeanInstances&&Object.assign(r,s.providedBeanInstances),r}createAgStackComponentsList(e){let t=[{componentName:"AgCheckbox",componentClass:$m},{componentName:"AgRadioButton",componentClass:AF},{componentName:"AgToggleButton",componentClass:RI},{componentName:"AgInputTextField",componentClass:_l},{componentName:"AgInputTextArea",componentClass:GG},{componentName:"AgInputNumberField",componentClass:P0},{componentName:"AgInputDateField",componentClass:VG},{componentName:"AgInputRange",componentClass:BG},{componentName:"AgRichSelect",componentClass:lv},{componentName:"AgSelect",componentClass:Um},{componentName:"AgSlider",componentClass:jG},{componentName:"AgGridBody",componentClass:an},{componentName:"AgHeaderRoot",componentClass:MG},{componentName:"AgSortIndicator",componentClass:F0},{componentName:"AgPagination",componentClass:Ui},{componentName:"AgPageSizeSelector",componentClass:$0},{componentName:"AgOverlayWrapper",componentClass:i2},{componentName:"AgGroupComponent",componentClass:WG},{componentName:"AgRowContainer",componentClass:vu},{componentName:"AgFakeHorizontalScroll",componentClass:r2},{componentName:"AgFakeVerticalScroll",componentClass:p2},{componentName:"AgAutocomplete",componentClass:qG}];const s=this.extractModuleEntity(e,i=>i.agStackComponents?i.agStackComponents:[]);return t=t.concat(s),t}createBeansList(e="clientSide",t,s){const i=t.filter(l=>!l.rowModel||l.rowModel===e),r={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!r[e]){Ua("Could not find row model for rowModelType = "+e);return}if(!Nt.__assertRegistered(r[e],`rowModelType = '${e}'`,s))return;const n=[ht,su,dw,Sh,Jc,yt,Df,_f,yh,ow,ta,eu,gh,gw,bh,mh,ph,Yy,rn,_t,Xn,Sl,Pr,Ls,Cl,vh,ar,Ff,nh,wl,si,Nf,ra,If,yl,sa,at,Zc,Gt,Kn,wh,ia,Af,qc,xl,uw,Ch,tu,oh,Xc,Qc,Fn,qy,hw,xh,An,iu,cl,Eh,ru,pw,El,Gi,bl,Rl,fi,fh,kf,Rh,Ar],o=this.extractModuleEntity(i,l=>l.beans?l.beans:[]);n.push(...o);const a=[];return n.forEach(l=>{a.indexOf(l)<0&&a.push(l)}),a}extractModuleEntity(e,t){return[].concat(...e.map(t))}},m2=class{wrap(e,t,s=[],i){const r=this.createWrapper(e,i);return t.forEach(n=>{this.createMethod(r,n,!0)}),s.forEach(n=>{this.createMethod(r,n,!1)}),r}unwrap(e){return e}createMethod(e,t,s){e.addMethod(t,this.createMethodProxy(e,t,s))}createMethodProxy(e,t,s){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(s&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}}},Tu=typeof global>"u"?{}:global;Tu.HTMLElement=typeof HTMLElement>"u"?{}:HTMLElement;Tu.HTMLButtonElement=typeof HTMLButtonElement>"u"?{}:HTMLButtonElement;Tu.HTMLSelectElement=typeof HTMLSelectElement>"u"?{}:HTMLSelectElement;Tu.HTMLInputElement=typeof HTMLInputElement>"u"?{}:HTMLInputElement;Tu.Node=typeof Node>"u"?{}:Node;Tu.MouseEvent=typeof MouseEvent>"u"?{}:MouseEvent;var K0=class gd{constructor(t,s,i,r,n,o){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=t,this.gos=s,this.eventService=i,this.columnModel=r,this.beans=o,this.selectionService=n,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=gd.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return rt.cloneObject(this.allNodesMap)}getRowNode(t){return this.allNodesMap[t]}setRowData(t){if(typeof t=="string"){console.warn("AG Grid: rowData must be an array.");return}this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(t);const s=this.rootNode,i=this.rootNode.sibling;s.childrenAfterFilter=null,s.childrenAfterGroup=null,s.childrenAfterAggFilter=null,s.childrenAfterSort=null,s.childrenMapped=null,s.updateHasChildren(),this.nextId=0,this.allNodesMap={},t?s.allLeafChildren=t.map(r=>this.createNode(r,this.rootNode,gd.TOP_LEVEL)):(s.allLeafChildren=[],s.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=s.childrenAfterFilter,i.childrenAfterGroup=s.childrenAfterGroup,i.childrenAfterAggFilter=s.childrenAfterAggFilter,i.childrenAfterSort=s.childrenAfterSort,i.childrenMapped=s.childrenMapped,i.allLeafChildren=s.allLeafChildren)}updateRowData(t,s){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(t.add);const i={remove:[],update:[],add:[]},r=[];return this.executeRemove(t,i,r),this.executeUpdate(t,i,r),this.executeAdd(t,i),this.updateSelection(r,"rowDataChanged"),s&&rt.sortRowNodesByOrder(this.rootNode.allLeafChildren,s),i}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(t){const s={type:w.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:t!=null&&t.length?t[0]:null};this.eventService.dispatchEvent(s)}updateSelection(t,s){const i=t.length>0;if(i&&this.selectionService.setNodesSelected({newValue:!1,nodes:t,suppressFinishActions:!0,source:s}),this.selectionService.updateGroupsFromChildrenSelections(s),i){const r={type:w.EVENT_SELECTION_CHANGED,source:s};this.eventService.dispatchEvent(r)}}executeAdd(t,s){var i;const{add:r,addIndex:n}=t;if(rt.missingOrEmpty(r))return;const o=r.map(a=>this.createNode(a,this.rootNode,gd.TOP_LEVEL));if(typeof n=="number"&&n>=0){const{allLeafChildren:a}=this.rootNode,l=a.length;let u=n;if(this.gos.get("treeData")&&n>0&&l>0){for(let m=0;m<l;m++)if(((i=a[m])==null?void 0:i.rowIndex)==n-1){u=m+1;break}}const p=a.slice(0,u),g=a.slice(u,a.length);this.rootNode.allLeafChildren=[...p,...o,...g]}else this.rootNode.allLeafChildren=[...this.rootNode.allLeafChildren,...o];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),s.add=o}executeRemove(t,s,i){const{remove:r}=t;if(rt.missingOrEmpty(r))return;const n={};r.forEach(o=>{const a=this.lookupRowNode(o);a&&(a.isSelected()&&i.push(a),a.clearRowTopAndRowIndex(),n[a.id]=!0,delete this.allNodesMap[a.id],s.remove.push(a))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(o=>!n[o.id]),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(t,s,i){const{update:r}=t;rt.missingOrEmpty(r)||r.forEach(n=>{const o=this.lookupRowNode(n);o&&(o.updateData(n),!o.selectable&&o.isSelected()&&i.push(o),this.setMasterForRow(o,n,gd.TOP_LEVEL,!1),s.update.push(o))})}lookupRowNode(t){const s=this.gos.getCallback("getRowId");let i;if(s){const r=s({data:t,level:0});if(i=this.allNodesMap[r],!i)return console.error(`AG Grid: could not find row id=${r}, data item was not found for this id`),null}else if(i=this.rootNode.allLeafChildren.find(r=>r.data===t),!i)return console.error("AG Grid: could not find data item as object was not found",t),console.error("Consider using getRowId to help the Grid find matching row data"),null;return i||null}createNode(t,s,i){const r=new ft(this.beans);r.group=!1,this.setMasterForRow(r,t,i,!0);const n=this.gos.get("suppressParentsInRowNodes");return s&&!n&&(r.parent=s),r.level=i,r.setDataAndId(t,this.nextId.toString()),this.allNodesMap[r.id]&&console.warn(`AG Grid: duplicate node id '${r.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[r.id]=r,this.nextId++,r}setMasterForRow(t,s,i,r){if(this.gos.get("treeData"))t.setMaster(!1),r&&(t.expanded=!1);else{if(this.gos.get("masterDetail")){const a=this.gos.get("isRowMaster");a?t.setMaster(a(s)):t.setMaster(!0)}else t.setMaster(!1);if(r){const a=this.columnModel.getRowGroupColumns(),l=a?a.length:0,u=i+l;t.expanded=t.master?this.isExpanded(u):!1}}}isExpanded(t){const s=this.gos.get("groupDefaultExpanded");return s===-1?!0:t<s}};K0.TOP_LEVEL=0;K0.ROOT_NODE_ID="ROOT_NODE_ID";var v2=K0,mi=class extends xe{constructor(){super(...arguments),this.onRowHeightChanged_debounced=rt.debounce(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}init(){const e=this.refreshModel.bind(this,{step:"group"}),t=!this.gos.get("suppressAnimationFrame"),s=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,s),this.addManagedListener(this.eventService,w.EVENT_COLUMN_ROW_GROUP_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:"pivot"})),this.addManagedListener(this.eventService,w.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_COLUMN_PIVOT_MODE_CHANGED,e),this.addManagedListener(this.eventService,w.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this)),this.addManagedListener(this.eventService,w.EVENT_GRID_READY,()=>this.onGridReady()),this.addPropertyListeners(),this.rootNode=new ft(this.beans),this.nodeManager=new v2(this.rootNode,this.gos,this.eventService,this.columnModel,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["suppressParentsInRowNodes","groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),s=new Set(["excludeChildrenWhenTreeDataFiltering"]),i=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),r=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),n=new Set(["postSortRows","groupDisplayType","accentedSort"]),o=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...e,...t,...s,...i,...i,...r,...n,...o,...a];this.addManagedPropertyListeners(l,u=>{var h;const p=(h=u.changeSet)==null?void 0:h.properties;if(!p)return;const g=m=>p.some(C=>m.has(C));if(g(e)){this.setRowData(this.rootNode.allLeafChildren.map(m=>m.data));return}if(g(t)){this.refreshModel({step:"group"});return}if(g(s)){this.refreshModel({step:"filter"});return}if(g(i)){this.refreshModel({step:"pivot"});return}if(g(r)){this.refreshModel({step:"aggregate"});return}if(g(n)){this.refreshModel({step:"sort"});return}if(g(o)){this.refreshModel({step:"filter_aggregates"});return}g(a)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,s,i){let r,n=!1;do{r=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,s),u=Math.min(a,i);for(let h=l;h<=u;h++){const p=this.getRow(h);if(p.rowHeightEstimated){const g=this.gos.getRowHeightForNode(p);p.setRowHeight(g.height),r=!0,n=!0}}r&&this.setRowTopAndRowIndex()}while(r);return n}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const s=new Set,i=this.gos.isDomLayout("normal");for(let r=0;r<this.rowsToDisplay.length;r++){const n=this.rowsToDisplay[r];if(n.id!=null&&s.add(n.id),n.rowHeight==null){const o=this.gos.getRowHeightForNode(n,i,e);n.setRowHeight(o.height,o.estimated)}n.setRowTop(t),n.setRowIndex(r),t+=n.rowHeight}return s}clearRowTopAndRowIndex(e,t){const s=e.isActive(),i=n=>{n&&n.id!=null&&!t.has(n.id)&&n.clearRowTopAndRowIndex()},r=n=>{if(i(n),i(n.detailNode),i(n.sibling),n.hasChildren()&&n.childrenAfterGroup){const o=n.level==-1;s&&!o&&!n.expanded||n.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(e,t,s=0){const i=this.getRowIndexAtPixel(t),r=this.getRow(i),n=!this.gos.get("suppressAnimationFrame");return r===e[0]?!1:(e.forEach(o=>{rt.removeFromArray(this.rootNode.allLeafChildren,o)}),e.forEach((o,a)=>{rt.insertIntoArray(this.rootNode.allLeafChildren,o,Math.max(i+s,0)+a)}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:n}),!0)}highlightRowAtPixel(e,t){const s=t!=null?this.getRowIndexAtPixel(t):null,i=s!=null?this.getRow(s):null;if(!i||!e||i===e||t==null){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null);return}const r=this.getHighlightPosition(t,i);this.lastHighlightedRow&&this.lastHighlightedRow!==i&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),i.setHighlighted(r),this.lastHighlightedRow=i}getHighlightPosition(e,t){if(!t){const r=this.getRowIndexAtPixel(e);if(t=this.getRow(r||0),!t)return 1}const{rowTop:s,rowHeight:i}=t;return e-s<i/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const t=this.rootNode.childrenAfterAggFilter;return t?t.length:0}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let s=this.rootNode.childrenAfterSort[e];if(this.gos.get("groupHideOpenParents"))for(;s.expanded&&s.childrenAfterSort&&s.childrenAfterSort.length>0;)s=s.childrenAfterSort[0];return s.rowIndex}getRowBounds(e){if(rt.missing(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=this.gos.isAnimateRows();this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=this.gos.isAnimateRows(),i=e.columns.length===0||e.columns.some(r=>r.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=this.gos.isAnimateRows();this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(e){const t=rt.missingOrEmpty(e),s=new av(!1,this.rootNode);return(t||this.gos.get("treeData"))&&s.setInactive(),s}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction")||e.rowNodeTransactions==null)return!1;const t=e.rowNodeTransactions.filter(i=>i.add!=null&&i.add.length>0||i.remove!=null&&i.remove.length>0);return t==null||t.length==0}buildRefreshModelParams(e){let t="group";const s={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",sort:"sort",pivot:"pivot"};if(rt.exists(e)&&(t=s[e]),rt.missing(t)){console.error(`AG Grid: invalid step ${e}, available steps are ${Object.keys(s).join(", ")}`);return}const i=!this.gos.get("suppressAnimationFrame");return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:i}}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.shouldRowModelIgnoreRefresh())return;let t=typeof e=="object"&&"step"in e?e:this.buildRefreshModelParams(e);if(!t||this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const s=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case"group":this.doRowGrouping(t.rowNodeTransactions,t.rowNodeOrder,s,!!t.afterColumnsChanged);case"filter":this.doFilter(s);case"pivot":this.doPivot(s);case"aggregate":this.doAggregate(s);case"filter_aggregates":this.doFilterAggregates(s);case"sort":this.doSort(t.rowNodeTransactions,s);case"map":this.doRowsToDisplay()}const i=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(s,i),this.isRefreshingModel=!1;const r={type:w.EVENT_MODEL_UPDATED,animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack};this.eventService.dispatchEvent(r)}isEmpty(){const e=rt.missing(this.rootNode.allLeafChildren)||this.rootNode.allLeafChildren.length===0;return rt.missing(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return rt.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let s=!t,i=!1;const r=[],n=this.gos.get("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(o=>{if(i)return;if(s&&(o===t||o===e)&&(i=!0,o.group&&n)){r.push(...o.allLeafChildren);return}if(!s){if(o!==t&&o!==e)return;s=!0}if(!o.group||!n){r.push(o);return}}),r}setDatasource(e){console.error("AG Grid: should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||this.rowsToDisplay.length===0)return-1;let t=0,s=this.rowsToDisplay.length-1;if(e<=0)return 0;if(rt.last(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let r=-1,n=-1;for(;;){const o=Math.floor((t+s)/2),a=this.rowsToDisplay[o];if(this.isRowInPixel(a,e)||(a.rowTop<e?t=o+1:a.rowTop>e&&(s=o-1),r===t&&n===s))return o;r=t,n=s}}isRowInPixel(e,t){const s=e.rowTop,i=e.rowTop+e.rowHeight;return s<=t&&i>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((t,s)=>e(t,s))}forEachNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e,t=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:s,recursionType:i,includeFooterNodes:r}=e;let{index:n}=e;const o=a=>{var l;const u=(l=t[0])==null?void 0:l.parent;if(!u)return;const h=r&&this.gos.getGrandTotalRow(),p=this.gos.getGroupTotalRowCallback(),g=r&&p({node:u});if(u===this.rootNode){h===a&&(u.createFooter(),s(u.sibling,n++));return}g===a&&(u.createFooter(),s(u.sibling,n++))};o("top");for(let a=0;a<t.length;a++){const l=t[a];if(s(l,n++),l.hasChildren()&&!l.footer){let u=null;switch(i){case 0:u=l.childrenAfterGroup;break;case 1:u=l.childrenAfterAggFilter;break;case 2:u=l.childrenAfterSort;break;case 3:u=l.leafGroup?null:l.childrenAfterSort;break}u&&(n=this.recursivelyWalkNodesAndCallback({nodes:[...u],callback:s,recursionType:i,index:n,includeFooterNodes:r}))}}return o("bottom"),n}doAggregate(e){var t;(t=this.aggregationStage)==null||t.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),s=this.columnModel.isPivotActive(),i=o=>{o&&o.forEach(a=>{const l=()=>{a.expanded=e,i(a.childrenAfterGroup)};if(t){rt.exists(a.childrenAfterGroup)&&l();return}if(s){!a.leafGroup&&l();return}a.group&&l()})};this.rootNode&&i(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"});const r=e?"expandAll":"collapseAll",n={type:w.EVENT_EXPAND_COLLAPSE_ALL,source:r};this.eventService.dispatchEvent(n)}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,s,i){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodeOrder:t,changedPath:s}):this.groupStage.execute({rowNode:this.rootNode,changedPath:s,afterColumnsChanged:i}),this.gos.get("groupSelectsChildren")&&this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",s)){const n={type:w.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(n)}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren();this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:w.EVENT_ROW_COUNT_READY}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){var t;(t=this.pivotStage)==null||t.execute({rowNode:this.rootNode,changedPath:e})}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(e){if(typeof e=="string"&&e.indexOf(ft.ID_PREFIX_ROW_GROUP)==0){let s;return this.forEachNode(i=>{i.id===e&&(s=i)}),s}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){const e={type:w.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(e),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(e,t){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];const s=this.gos.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},s)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const e=[],t=[];let s=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(i=>{const r=this.nodeManager.updateRowData(i.rowDataTransaction,void 0);t.push(r),i.callback&&e.push(i.callback.bind(null,r)),typeof i.rowDataTransaction.addIndex=="number"&&(s=!0)}),this.commonUpdateRowData(t,void 0,s),e.length>0&&window.setTimeout(()=>{e.forEach(i=>i())},0),t.length>0){const i={type:w.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:t};this.eventService.dispatchEvent(i)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e,t){this.valueCache.onDataChanged();const s=this.nodeManager.updateRowData(e,t),i=typeof e.addIndex=="number";return this.commonUpdateRowData([s],t,i),s}createRowNodeOrder(){if(this.gos.get("suppressMaintainUnsortedOrder"))return;const t={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let s=0;s<this.rootNode.allLeafChildren.length;s++){const i=this.rootNode.allLeafChildren[s];t[i.id]=s}return t}commonUpdateRowData(e,t,s){if(!this.hasStarted)return;const i=!this.gos.get("suppressAnimationFrame");s&&(t=this.createRowNodeOrder());const r={type:w.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(r),this.refreshModel({step:"group",rowNodeTransactions:e,rowNodeOrder:t,keepRenderedRows:!0,keepEditingRows:!0,animate:i})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const s=t.detailNode;s&&s.setRowHeight(s.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}};f([A("columnModel")],mi.prototype,"columnModel",2);f([A("selectionService")],mi.prototype,"selectionService",2);f([A("valueCache")],mi.prototype,"valueCache",2);f([A("beans")],mi.prototype,"beans",2);f([A("filterStage")],mi.prototype,"filterStage",2);f([A("sortStage")],mi.prototype,"sortStage",2);f([A("flattenStage")],mi.prototype,"flattenStage",2);f([Lt("groupStage")],mi.prototype,"groupStage",2);f([Lt("aggregationStage")],mi.prototype,"aggregationStage",2);f([Lt("pivotStage")],mi.prototype,"pivotStage",2);f([Lt("filterAggregatesStage")],mi.prototype,"filterAggregatesStage",2);f([Ee],mi.prototype,"init",1);mi=f([je("rowModel")],mi);var Mf=class extends xe{execute(e){const{changedPath:t}=e;this.filterService.filter(t)}};f([A("filterService")],Mf.prototype,"filterService",2);Mf=f([je("filterStage")],Mf);var Th=class extends xe{execute(e){const t=this.sortController.getSortOptions(),s=rt.exists(t)&&t.length>0,i=s&&rt.exists(e.rowNodeTransactions)&&this.gos.get("deltaSort"),r=t.some(n=>this.gos.isColumnsSortingCoupledToGroup()?n.column.isPrimary()&&n.column.isRowGroupActive():!!n.column.getColDef().showRowGroup);this.sortService.sort(t,s,i,e.rowNodeTransactions,e.changedPath,r)}};f([A("sortService")],Th.prototype,"sortService",2);f([A("sortController")],Th.prototype,"sortController",2);Th=f([je("sortStage")],Th);var Lf=class extends xe{execute(e){const t=e.rowNode,s=[],i=this.beans.columnModel.isPivotMode(),r=i&&t.leafGroup,n=r?[t]:t.childrenAfterSort,o=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(o,n,s,i,0);const a=s.length>0;if(!r&&a&&o.grandTotalRow){t.createFooter();const u=o.grandTotalRow==="top";this.addRowNodeToRowsToDisplay(o,t.sibling,s,0,u)}return s}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:this.gos.isGroupMultiAutoColumn(),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:this.gos.getGrandTotalRow(),groupTotalRow:this.gos.getGroupTotalRowCallback()}}recursivelyAddToRowsToDisplay(e,t,s,i,r){if(!rt.missingOrEmpty(t))for(let n=0;n<t.length;n++){const o=t[n],a=o.hasChildren(),l=i&&!a,u=e.groupRemoveSingleChildren&&a&&o.childrenAfterGroup.length===1,h=e.groupRemoveLowestSingleChildren&&a&&o.leafGroup&&o.childrenAfterGroup.length===1,p=i&&o.leafGroup,g=e.hideOpenParents&&o.expanded&&!o.master&&!p;if(!l&&!g&&!u&&!h&&this.addRowNodeToRowsToDisplay(e,o,s,r),!(i&&o.leafGroup)){if(a){const C=u||h;if(o.expanded||C){const y=e.groupTotalRow({node:o});y||o.destroyFooter();const R=C?r:r+1;y==="top"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,s,R)),this.recursivelyAddToRowsToDisplay(e,o.childrenAfterSort,s,i,R),y==="bottom"&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,s,R))}}else if(o.master&&o.expanded){const C=this.createDetailNode(o);this.addRowNodeToRowsToDisplay(e,C,s,r)}}}}addRowNodeToRowsToDisplay(e,t,s,i,r){r?s.unshift(t):s.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:i)}createDetailNode(e){if(rt.exists(e.detailNode))return e.detailNode;const t=new ft(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,rt.exists(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}};f([A("beans")],Lf.prototype,"beans",2);Lf=f([je("flattenStage")],Lf);var Dh=class extends xe{sort(e,t,s,i,r,n){const o=this.gos.get("groupMaintainOrder"),a=this.columnModel.getAllGridColumns().some(g=>g.isRowGroupActive());let l={};s&&i&&(l=this.calculateDirtyNodes(i));const u=this.columnModel.isPivotMode(),h=this.gos.getCallback("postSortRows"),p=g=>{var m;this.pullDownGroupDataForHideOpenParents(g.childrenAfterAggFilter,!0);const C=u&&g.leafGroup;if(o&&a&&!g.leafGroup&&!n){const R=(m=this.columnModel.getRowGroupColumns())==null?void 0:m[g.level+1],x=(R==null?void 0:R.getSort())===null,S=g.childrenAfterAggFilter.slice(0);if(g.childrenAfterSort&&!x){const T={};g.childrenAfterSort.forEach((I,V)=>{T[I.id]=V}),S.sort((I,V)=>{var H,P;return((H=T[I.id])!=null?H:0)-((P=T[V.id])!=null?P:0)})}g.childrenAfterSort=S}else!t||C?g.childrenAfterSort=g.childrenAfterAggFilter.slice(0):s?g.childrenAfterSort=this.doDeltaSort(g,l,r,e):g.childrenAfterSort=this.rowNodeSorter.doFullSort(g.childrenAfterAggFilter,e);if(g.sibling&&(g.sibling.childrenAfterSort=g.childrenAfterSort),this.updateChildIndexes(g),h){const R={nodes:g.childrenAfterSort};h(R)}};r&&r.forEachChangedNodeDepthFirst(p),this.updateGroupDataForHideOpenParents(r)}calculateDirtyNodes(e){const t={},s=i=>{i&&i.forEach(r=>t[r.id]=!0)};return e&&e.forEach(i=>{s(i.add),s(i.update),s(i.remove)}),t}doDeltaSort(e,t,s,i){const r=e.childrenAfterAggFilter,n=e.childrenAfterSort;if(!n)return this.rowNodeSorter.doFullSort(r,i);const o={},a=[];r.forEach(p=>{t[p.id]||!s.canSkip(p)?a.push(p):o[p.id]=!0});const l=n.filter(p=>o[p.id]),u=(p,g)=>({currentPos:g,rowNode:p}),h=a.map(u).sort((p,g)=>this.rowNodeSorter.compareRowNodes(i,p,g));return this.mergeSortedArrays(i,h,l.map(u)).map(({rowNode:p})=>p)}mergeSortedArrays(e,t,s){const i=[];let r=0,n=0;for(;r<t.length&&n<s.length;)this.rowNodeSorter.compareRowNodes(e,t[r],s[n])<0?i.push(t[r++]):i.push(s[n++]);for(;r<t.length;)i.push(t[r++]);for(;n<s.length;)i.push(s[n++]);return i}updateChildIndexes(e){if(rt.missing(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let s=0;s<t.length;s++){const i=t[s],r=s===0,n=s===e.childrenAfterSort.length-1;i.setFirstChild(r),i.setLastChild(n),i.setChildIndex(s)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return rt.warnOnce("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=s=>{this.pullDownGroupDataForHideOpenParents(s.childrenAfterSort,!1),s.childrenAfterSort.forEach(i=>{i.hasChildren()&&t(i)})};e&&e.executeFromRootNode(s=>t(s))}pullDownGroupDataForHideOpenParents(e,t){!this.gos.get("groupHideOpenParents")||rt.missing(e)||e.forEach(s=>{this.columnModel.getGroupDisplayColumns().forEach(r=>{const n=r.getColDef().showRowGroup;if(typeof n!="string"){console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");return}const o=n,a=this.columnModel.getPrimaryColumn(o);if(a!==s.rowGroupColumn)if(t)s.setGroupValue(r.getId(),void 0);else{const u=s.getFirstChildOfFirstChild(a);u&&s.setGroupValue(r.getId(),u.key)}})})}};f([A("columnModel")],Dh.prototype,"columnModel",2);f([A("rowNodeSorter")],Dh.prototype,"rowNodeSorter",2);Dh=f([je("sortService")],Dh);var Of=class extends xe{filter(e){const t=this.filterManager.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const s=(i,r)=>{i.hasChildren()&&e&&!r?i.childrenAfterFilter=i.childrenAfterGroup.filter(n=>{const o=n.childrenAfterFilter&&n.childrenAfterFilter.length>0,a=n.data&&this.filterManager.doesRowPassFilter({rowNode:n});return o||a}):i.childrenAfterFilter=i.childrenAfterGroup,i.sibling&&(i.sibling.childrenAfterFilter=i.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const i=(n,o)=>{if(n.childrenAfterGroup)for(let a=0;a<n.childrenAfterGroup.length;a++){const l=n.childrenAfterGroup[a],u=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?i(n.childrenAfterGroup[a],u):s(l,u)}s(n,o)},r=n=>i(n,!1);t.executeFromRootNode(r)}else{const i=r=>s(r,!1);t.forEachChangedNodeDepthFirst(i,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}};f([A("filterManager")],Of.prototype,"filterManager",2);Of=f([je("filterService")],Of);var Tl=class extends xe{postConstruct(){this.rowModel.getType()==="clientSide"&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const e=this.gos.exists("getRowId");return this.gos.get("resetRowDataOnUpdate")?!1:e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const[s,i]=t;this.clientSideRowModel.updateRowData(s,i)}createTransactionForRowData(e){if(rt.missing(this.clientSideRowModel)){console.error("AG Grid: ImmutableService only works with ClientSideRowModel");return}const t=this.gos.getCallback("getRowId");if(t==null){console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");return}const s={remove:[],update:[],add:[]},i=this.clientSideRowModel.getCopyOfNodesMap(),n=this.gos.get("suppressMaintainUnsortedOrder")?void 0:{};return rt.exists(e)&&e.forEach((o,a)=>{const l=t({data:o,level:0}),u=i[l];n&&(n[l]=a),u?(u.data!==o&&s.update.push(o),i[l]=void 0):s.add.push(o)}),rt.iterateObject(i,(o,a)=>{a&&s.remove.push(a.data)}),[s,n]}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}};f([A("rowModel")],Tl.prototype,"rowModel",2);f([A("rowRenderer")],Tl.prototype,"rowRenderer",2);f([A("selectionService")],Tl.prototype,"selectionService",2);f([Ee],Tl.prototype,"postConstruct",1);Tl=f([je("immutableService")],Tl);var C2="31.3.4",y2={version:C2,moduleName:"@ag-grid-community/client-side-row-model",rowModel:"clientSide",beans:[mi,Mf,Th,Lf,Dh,Of,Tl]},w2=Object.defineProperty,S2=Object.getOwnPropertyDescriptor,Ei=(e,t,s,i)=>{for(var r=i>1?void 0:i?S2(t,s):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(i?o(t,s,r):o(r))||r);return i&&r&&w2(t,s,r),r},x2=(e,t)=>(s,i)=>t(s,i,e),Ph=class extends aw{constructor(e,t,s){super(e),this.parentCache=t,this.params=s,this.startRow=e*s.blockSize,this.endRow=this.startRow+s.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,s){rt.exists(t)?e.setDataAndId(t,s.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(rt.missing(this.params.datasource.getRows)){console.warn("AG Grid: datasource is missing getRows method");return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(e,t,s){this.rowNodes.forEach((i,r)=>{this.startRow+r<s&&e(i,t.next())})}getLastAccessed(){return this.lastAccessed}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.next());const s=e-this.startRow;return this.rowNodes[s]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let e=0;e<this.params.blockSize;e++){const t=this.startRow+e,s=new ft(this.beans);s.setRowHeight(this.params.rowHeight),s.uiLevel=0,s.setRowIndex(t),s.setRowTop(this.params.rowHeight*t),this.rowNodes.push(s)}}processServerResult(e){this.rowNodes.forEach((s,i)=>{const r=e.rowData?e.rowData[i]:void 0;!s.id&&s.alreadyRendered&&r&&(this.rowNodes[i]=new ft(this.beans),this.rowNodes[i].setRowIndex(s.rowIndex),this.rowNodes[i].setRowTop(s.rowTop),this.rowNodes[i].setRowHeight(s.rowHeight),s.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[i],r,this.startRow+i)});const t=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,t)}destroyRowNodes(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()})}};Ei([A("beans")],Ph.prototype,"beans",2);Ei([Ee],Ph.prototype,"postConstruct",1);Ei([Si],Ph.prototype,"destroyRowNodes",1);var Du=class OI extends xe{constructor(t){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=t.initialRowCount,this.params=t}setBeans(t){this.logger=t.create("InfiniteCache")}getRow(t,s=!1){const i=Math.floor(t/this.params.blockSize);let r=this.blocks[i];if(!r){if(s)return;r=this.createBlock(i)}return r.getRow(t)}createBlock(t){const s=this.createBean(new Ph(t,this,this.params));return this.blocks[s.getId()]=s,this.blockCount++,this.purgeBlocksIfNeeded(s),this.params.rowNodeBlockLoader.addBlock(s),s}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(s=>s.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroyAllBlocks(){this.getBlocksInOrder().forEach(t=>this.destroyBlock(t))}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(t,s){this.isAlive()&&(this.logger.log(`onPageLoaded: page = ${t.getId()}, lastRow = ${s}`),this.checkRowCount(t,s),this.onCacheUpdated())}purgeBlocksIfNeeded(t){const s=this.getBlocksInOrder().filter(a=>a!=t),i=(a,l)=>l.getLastAccessed()-a.getLastAccessed();s.sort(i);const r=this.params.maxBlocksInCache>0,n=r?this.params.maxBlocksInCache-1:null,o=OI.MAX_EMPTY_BLOCKS_TO_KEEP-1;s.forEach((a,l)=>{const u=a.getState()===Ph.STATE_WAITING_TO_LOAD&&l>=o,h=r?l>=n:!1;if(u||h){if(this.isBlockCurrentlyDisplayed(a)||this.isBlockFocused(a))return;this.removeBlockFromCache(a)}})}isBlockFocused(t){const s=this.focusService.getFocusCellToUseAfterRefresh();if(!s||s.rowPinned!=null)return!1;const i=t.getStartRow(),r=t.getEndRow();return s.rowIndex>=i&&s.rowIndex<r}isBlockCurrentlyDisplayed(t){const s=t.getStartRow(),i=t.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(s,i)}removeBlockFromCache(t){t&&this.destroyBlock(t)}checkRowCount(t,s){if(typeof s=="number"&&s>=0)this.rowCount=s,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const r=(t.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<r&&(this.rowCount=r)}}setRowCount(t,s){this.rowCount=t,rt.exists(s)&&(this.lastRowIndexKnown=s),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(t){const s=new Yc;this.getBlocksInOrder().forEach(i=>i.forEachNode(t,s,this.rowCount))}getBlocksInOrder(){const t=(i,r)=>i.getId()-r.getId();return rt.getAllValuesInObject(this.blocks).sort(t)}destroyBlock(t){delete this.blocks[t.getId()],this.destroyBean(t),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(t)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const t={type:w.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(t)}}destroyAllBlocksPastVirtualRowCount(){const t=[];this.getBlocksInOrder().forEach(s=>{s.getId()*this.params.blockSize>=this.rowCount&&t.push(s)}),t.length>0&&t.forEach(s=>this.destroyBlock(s))}purgeCache(){this.getBlocksInOrder().forEach(t=>this.removeBlockFromCache(t)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(t,s){const i=[];let r=-1,n=!1;const o=new Yc;rt.missing(t)&&(n=!0);let a=!1;return this.getBlocksInOrder().forEach(u=>{if(!a){if(n&&r+1!==u.getId()){a=!0;return}r=u.getId(),u.forEachNode(h=>{const p=h===t||h===s;(n||p)&&i.push(h),p&&(n=!n)},o,this.rowCount)}}),a||n?[]:i}};Du.MAX_EMPTY_BLOCKS_TO_KEEP=2;Ei([A("rowRenderer")],Du.prototype,"rowRenderer",2);Ei([A("focusService")],Du.prototype,"focusService",2);Ei([x2(0,Sr("loggerFactory"))],Du.prototype,"setBeans",1);Ei([Si],Du.prototype,"destroyAllBlocks",1);var E2=Du,In=class extends xe{getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(e,t,s,i){return!1}init(){this.gos.isRowModelType("infinite")&&(this.rowHeight=this.gos.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&rt.warnOnce("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroyDatasource(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedListener(this.eventService,w.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,w.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,w.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this)),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=this.gos.getRowHeightAsNumber(),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;this.cacheParams?e=this.isSortModelDifferent():e=!0,e&&this.reset()}isSortModelDifferent(){return!rt.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;this.gos.getCallback("getRowId")!=null||this.selectionService.reset("rowDataChanged"),this.resetCache()}createModelUpdatedEvent(){return{type:w.EVENT_MODEL_UPDATED,newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:this.gos.getRowHeightAsNumber(),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new Yc},this.infiniteCache=this.createBean(new E2(this.cacheParams)),this.eventService.dispatchEventOnce({type:w.EVENT_ROW_COUNT_READY});const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}updateRowHeights(){this.forEachNode(t=>{t.setRowHeight(this.rowHeight),t.setRowTop(this.rowHeight*t.rowIndex)});const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const e=this.createModelUpdatedEvent();this.eventService.dispatchEvent(e)}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(e){let t;return this.forEachNode(s=>{s.id===e&&(t=s)}),t}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),s=this.getRowCount()-1;return t>s?s:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?this.infiniteCache.isLastRowIndexKnown():!1}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}};Ei([A("filterManager")],In.prototype,"filterManager",2);Ei([A("sortController")],In.prototype,"sortController",2);Ei([A("selectionService")],In.prototype,"selectionService",2);Ei([A("rowRenderer")],In.prototype,"rowRenderer",2);Ei([A("rowNodeBlockLoader")],In.prototype,"rowNodeBlockLoader",2);Ei([Ee],In.prototype,"init",1);Ei([Si],In.prototype,"destroyDatasource",1);In=Ei([je("rowModel")],In);var b2="31.3.4",R2={version:b2,moduleName:"@ag-grid-community/infinite-row-model",rowModel:"infinite",beans:[In]},T2=Object.defineProperty,D2=Object.getOwnPropertyDescriptor,$i=(e,t,s,i)=>{for(var r=i>1?void 0:i?D2(t,s):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(i?o(t,s,r):o(r))||r);return i&&r&&T2(t,s,r),r},P2=class{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return(e==null||!e.length)&&(e=this.getDefaultFileName()),e.indexOf(".")===-1?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},A2=class{constructor(e){this.groupColumns=[];const{columnModel:t,valueService:s,gos:i,processCellCallback:r,processHeaderCallback:n,processGroupHeaderCallback:o,processRowGroupCallback:a}=e;this.columnModel=t,this.valueService=s,this.gos=i,this.processCellCallback=r,this.processHeaderCallback=n,this.processGroupHeaderCallback=o,this.processRowGroupCallback=a}prepare(e){this.groupColumns=e.filter(t=>!!t.getColDef().showRowGroup)}extractHeaderValue(e){const t=this.getHeaderName(this.processHeaderCallback,e);return t??""}extractRowCellValue(e,t,s,i,r){const o=(!this.gos.get("groupHideOpenParents")||r.footer)&&this.shouldRenderGroupSummaryCell(r,e,t)?this.createValueForGroupNode(e,r):this.valueService.getValue(e,r);return this.processCell({accumulatedRowIndex:s,rowNode:r,column:e,value:o,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,s){var i;if(!(e&&e.group))return!1;if(this.groupColumns.indexOf(t)!==-1){if(((i=e.groupData)==null?void 0:i[t.getId()])!=null||this.gos.isRowModelType("serverSide")&&e.group)return!0;if(e.footer&&e.level===-1){const a=t.getColDef();return a==null||a.showRowGroup===!0||a.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}const o=this.gos.isGroupUseEntireRow(this.columnModel.isPivotMode());return s===0&&o}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnModel.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const s=this.gos.get("treeData"),i=this.gos.get("suppressGroupMaintainValueType"),r=l=>{var u,h;if(s||i)return l.key;const p=(u=l.groupData)==null?void 0:u[e.getId()];return!p||!l.rowGroupColumn||l.rowGroupColumn.getColDef().useValueFormatterForExport===!1?p:(h=this.valueService.formatValue(l.rowGroupColumn,l,p))!=null?h:p},n=t.footer,o=[r(t)];if(!this.gos.isGroupMultiAutoColumn())for(;t.parent;)t=t.parent,o.push(r(t));const a=o.reverse().join(" -> ");return n?`Total ${a}`:a}processCell(e){var t;const{accumulatedRowIndex:s,rowNode:i,column:r,value:n,processCellCallback:o,type:a}=e;return o?{value:(t=o(this.gos.addGridCommonParams({accumulatedRowIndex:s,column:r,node:i,value:n,type:a,parseValue:l=>this.valueService.parseValue(r,i,l,this.valueService.getValue(r,i)),formatValue:l=>{var u;return(u=this.valueService.formatValue(r,i,l))!=null?u:l}})))!=null?t:""}:r.getColDef().useValueFormatterForExport!==!1?{value:n??"",valueFormatted:this.valueService.formatValue(r,i,n)}:{value:n??""}}},F2=class{static download(e,t){const s=document.defaultView||window;if(!s){console.warn("AG Grid: There is no `window` associated with the current `document`");return}const i=document.createElement("a"),r=s.URL.createObjectURL(t);i.setAttribute("href",r),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:s})),document.body.removeChild(i),s.setTimeout(()=>{s.URL.revokeObjectURL(r)},0)}},kb=`\r
`,I2=class extends A2{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:s}=e;this.suppressQuotes=t,this.columnSeparator=s}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,kb),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((s,i)=>{i!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(s.data.value||""),s.mergeAcross&&this.appendEmptyCells(s.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,s,i){s!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,s){var i;t!=0&&(this.result+=this.columnSeparator);const r=this.extractRowCellValue(e,t,t,"csv",s);this.result+=this.putInQuotes((i=r.valueFormatted)!=null?i:r.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(console.warn("AG Grid: unknown value type during csv conversion"),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=kb),this.isFirstLine=!1}},na=class extends P2{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration.");return}const t=this.getMergedParams(e),s=this.getData(t),i=new Blob(["\uFEFF",s],{type:"text/plain"}),r=typeof t.fileName=="function"?t.fileName(this.gos.getGridCommonParams()):t.fileName;F2.download(this.getFileName(r),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const s=t?Object.assign({},e):this.getMergedParams(e);return this.getData(s)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,valueService:s,gos:i}=this,{processCellCallback:r,processHeaderCallback:n,processGroupHeaderCallback:o,processRowGroupCallback:a,suppressQuotes:l,columnSeparator:u}=e;return new I2({columnModel:t,valueService:s,gos:i,processCellCallback:r||void 0,processHeaderCallback:n||void 0,processGroupHeaderCallback:o||void 0,processRowGroupCallback:a||void 0,suppressQuotes:l||!1,columnSeparator:u||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};$i([A("columnModel")],na.prototype,"columnModel",2);$i([A("valueService")],na.prototype,"valueService",2);$i([A("gridSerializer")],na.prototype,"gridSerializer",2);$i([A("gridOptionsService")],na.prototype,"gos",2);$i([Ee],na.prototype,"postConstruct",1);na=$i([je("csvCreator")],na);var Nn=class extends xe{serialize(e,t={}){const{allColumns:s,columnKeys:i,skipRowGroups:r}=t,n=this.getColumnsToExport(s,r,i);return rt.compose(this.prepareSession(n),this.prependContent(t),this.exportColumnGroups(t,n),this.exportHeaders(t,n),this.processPinnedTopRows(t,n),this.processRows(t,n),this.processPinnedBottomRows(t,n),this.appendContent(t))(e).parse()}processRow(e,t,s,i){const r=t.shouldRowBeSkipped||(()=>!1),n=this.gos.get("groupRemoveSingleChildren"),o=this.gos.get("groupRemoveLowestSingleChildren"),l=t.rowPositions!=null||!!t.onlySelected,u=this.gos.get("groupHideOpenParents")&&!l,h=this.columnModel.isPivotMode()?i.leafGroup:!i.group,p=!!i.footer;t.skipRowGroups;const g=o&&i.leafGroup,m=i.allChildrenCount===1&&(n||g);if(!h&&!p&&(t.skipRowGroups||m||u)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&i.rowPinned==="top"||t.skipPinnedBottom&&i.rowPinned==="bottom"||i.level===-1&&!h&&!p||r(this.gos.addGridCommonParams({node:i})))return;const R=e.onNewBodyRow(i);if(s.forEach((x,S)=>{R.onColumn(x,S,i)}),t.getCustomContentBelowRow){const x=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:i}));x&&e.addCustomContent(x)}}appendContent(e){return t=>{const s=e.appendContent;return s&&t.addCustomContent(s),t}}prependContent(e){return t=>{const s=e.prependContent;return s&&t.addCustomContent(s),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return s=>{if(!e.skipColumnGroupHeaders){const i=new DA,r=this.displayedGroupCreator.createDisplayedGroups(t,i,null);this.recursivelyAddHeaderGroups(r,s,e.processGroupHeaderCallback)}return s}}exportHeaders(e,t){return s=>{if(!e.skipColumnHeaders){const i=s.onNewHeaderRow();t.forEach((r,n)=>{i.onColumn(r,n,void 0)})}return s}}processPinnedTopRows(e,t){return s=>{const i=this.processRow.bind(this,s,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="top").sort((r,n)=>r.rowIndex-n.rowIndex).map(r=>this.pinnedRowModel.getPinnedTopRow(r.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedTopRow(i),s}}processRows(e,t){return s=>{const i=this.rowModel,r=i.getType(),n=r==="clientSide",o=r==="serverSide",a=!n&&e.onlySelected,l=this.processRow.bind(this,s,e,t),{exportedRows:u="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(h=>h.rowPinned==null).sort((h,p)=>h.rowIndex-p.rowIndex).map(h=>i.getRow(h.rowIndex)).forEach(l);else if(this.columnModel.isPivotMode())n?i.forEachPivotNode(l,!0):o?i.forEachNodeAfterFilterAndSort(l,!0):i.forEachNode(l);else if(e.onlySelectedAllPages||a){const h=this.selectionService.getSelectedNodes();this.replicateSortedOrder(h),h.forEach(l)}else u==="all"?i.forEachNode(l):n||o?i.forEachNodeAfterFilterAndSort(l,!0):i.forEachNode(l);return s}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),s=(i,r)=>{var n,o,a,l;return i.rowIndex!=null&&r.rowIndex!=null?i.rowIndex-r.rowIndex:i.level===r.level?((n=i.parent)==null?void 0:n.id)===((o=r.parent)==null?void 0:o.id)?this.rowNodeSorter.compareRowNodes(t,{rowNode:i,currentPos:(a=i.rowIndex)!=null?a:-1},{rowNode:r,currentPos:(l=r.rowIndex)!=null?l:-1}):s(i.parent,r.parent):i.level>r.level?s(i.parent,r):s(i,r.parent)};e.sort(s)}processPinnedBottomRows(e,t){return s=>{const i=this.processRow.bind(this,s,e,t);return e.rowPositions?e.rowPositions.filter(r=>r.rowPinned==="bottom").sort((r,n)=>r.rowIndex-n.rowIndex).map(r=>this.pinnedRowModel.getPinnedBottomRow(r.rowIndex)).forEach(i):this.pinnedRowModel.forEachPinnedBottomRow(i),s}}getColumnsToExport(e=!1,t=!1,s){const i=this.columnModel.isPivotMode();if(s&&s.length)return this.columnModel.getGridColumns(s);const r=this.gos.get("treeData");let n=[];return e&&!i?n=this.columnModel.getAllGridColumns():n=this.columnModel.getAllDisplayedColumns(),t&&!r&&(n=n.filter(o=>o.getColId()!==zc)),n}recursivelyAddHeaderGroups(e,t,s){const i=[];e.forEach(r=>{const n=r;n.getChildren&&n.getChildren().forEach(o=>i.push(o))}),e.length>0&&e[0]instanceof Ps&&this.doAddHeaderHeader(t,e,s),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,s)}doAddHeaderHeader(e,t,s){const i=e.onNewHeaderGroupingRow();let r=0;t.forEach(n=>{const o=n;let a;s?a=s(this.gos.addGridCommonParams({columnGroup:o})):a=this.columnModel.getDisplayNameForColumnGroup(o,"header");const l=o.getLeafColumns().reduce((u,h,p,g)=>{let m=rt.last(u);return h.getColumnGroupShow()==="open"?(!m||m[1]!=null)&&(m=[p],u.push(m)):m&&m[1]==null&&(m[1]=p-1),p===g.length-1&&m&&m[1]==null&&(m[1]=p),u},[]);i.onColumn(o,a||"",r++,o.getLeafColumns().length-1,l)})}};$i([A("displayedGroupCreator")],Nn.prototype,"displayedGroupCreator",2);$i([A("columnModel")],Nn.prototype,"columnModel",2);$i([A("rowModel")],Nn.prototype,"rowModel",2);$i([A("pinnedRowModel")],Nn.prototype,"pinnedRowModel",2);$i([A("selectionService")],Nn.prototype,"selectionService",2);$i([A("rowNodeSorter")],Nn.prototype,"rowNodeSorter",2);$i([A("sortController")],Nn.prototype,"sortController",2);Nn=$i([je("gridSerializer")],Nn);var N2="31.3.4",_2={version:N2,moduleName:"@ag-grid-community/csv-export",beans:[na,Nn]},{utf8_encode:a6}=rt;Nt.__registerModules([y2,R2,_2],!1,void 0);var Pu={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GI=E;function mt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Pi=Object.prototype.hasOwnProperty,k2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mb={},Lb={};function VI(e){return Pi.call(Lb,e)?!0:Pi.call(Mb,e)?!1:k2.test(e)?Lb[e]=!0:(Mb[e]=!0,!1)}function bi(e,t,s,i,r,n,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=o}var $s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$s[e]=new bi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$s[t]=new bi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){$s[e]=new bi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$s[e]=new bi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$s[e]=new bi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){$s[e]=new bi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){$s[e]=new bi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){$s[e]=new bi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){$s[e]=new bi(e,5,!1,e.toLowerCase(),null,!1,!1)});var Y0=/[\-:]([a-z])/g;function q0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Y0,q0);$s[t]=new bi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Y0,q0);$s[t]=new bi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Y0,q0);$s[t]=new bi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){$s[e]=new bi(e,1,!1,e.toLowerCase(),null,!1,!1)});$s.xlinkHref=new bi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){$s[e]=new bi(e,1,!1,e.toLowerCase(),null,!0,!0)});var Ng={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},M2=["Webkit","ms","Moz","O"];Object.keys(Ng).forEach(function(e){M2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ng[t]=Ng[e]})});var L2=/["'&<>]/;function hi(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=L2.exec(e);if(t){var s="",i,r=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==i&&(s+=e.substring(r,i)),r=i+1,s+=t}e=r!==i?s+e.substring(r,i):s}return e}var O2=/([A-Z])/g,G2=/^ms-/,mw=Array.isArray;function Ln(e,t){return{insertionMode:e,selectedValue:t}}function V2(e,t,s){switch(t){case"select":return Ln(1,s.value!=null?s.value:s.defaultValue);case"svg":return Ln(2,null);case"math":return Ln(3,null);case"foreignObject":return Ln(1,null);case"table":return Ln(4,null);case"thead":case"tbody":case"tfoot":return Ln(5,null);case"colgroup":return Ln(7,null);case"tr":return Ln(6,null)}return 4<=e.insertionMode||e.insertionMode===0?Ln(1,null):e}var Ob=new Map;function BI(e,t,s){if(typeof s!="object")throw Error(mt(62));t=!0;for(var i in s)if(Pi.call(s,i)){var r=s[i];if(r!=null&&typeof r!="boolean"&&r!==""){if(i.indexOf("--")===0){var n=hi(i);r=hi((""+r).trim())}else{n=i;var o=Ob.get(n);o!==void 0||(o=hi(n.replace(O2,"-$1").toLowerCase().replace(G2,"-ms-")),Ob.set(n,o)),n=o,r=typeof r=="number"?r===0||Pi.call(Ng,i)?""+r:r+"px":hi((""+r).trim())}t?(t=!1,e.push(' style="',n,":",r)):e.push(";",n,":",r)}}t||e.push('"')}function Yi(e,t,s,i){switch(s){case"style":BI(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N"){if(t=$s.hasOwnProperty(s)?$s[s]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(s=t.attributeName,t.type){case 3:i&&e.push(" ",s,'=""');break;case 4:i===!0?e.push(" ",s,'=""'):i!==!1&&e.push(" ",s,'="',hi(i),'"');break;case 5:isNaN(i)||e.push(" ",s,'="',hi(i),'"');break;case 6:!isNaN(i)&&1<=i&&e.push(" ",s,'="',hi(i),'"');break;default:t.sanitizeURL&&(i=""+i),e.push(" ",s,'="',hi(i),'"')}}else if(VI(s)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=s.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(" ",s,'="',hi(i),'"')}}}function _g(e,t,s){if(t!=null){if(s!=null)throw Error(mt(60));if(typeof t!="object"||!("__html"in t))throw Error(mt(61));t=t.__html,t!=null&&e.push(""+t)}}function B2(e){var t="";return GI.Children.forEach(e,function(s){s!=null&&(t+=s)}),t}function wC(e,t,s,i){e.push(hn(s));var r=s=null,n;for(n in t)if(Pi.call(t,n)){var o=t[n];if(o!=null)switch(n){case"children":s=o;break;case"dangerouslySetInnerHTML":r=o;break;default:Yi(e,i,n,o)}}return e.push(">"),_g(e,r,s),typeof s=="string"?(e.push(hi(s)),null):s}var H2=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Gb=new Map;function hn(e){var t=Gb.get(e);if(t===void 0){if(!H2.test(e))throw Error(mt(65,e));t="<"+e,Gb.set(e,t)}return t}function j2(e,t,s,i,r){switch(t){case"select":e.push(hn("select"));var n=null,o=null;for(h in s)if(Pi.call(s,h)){var a=s[h];if(a!=null)switch(h){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"defaultValue":case"value":break;default:Yi(e,i,h,a)}}return e.push(">"),_g(e,o,n),n;case"option":o=r.selectedValue,e.push(hn("option"));var l=a=null,u=null,h=null;for(n in s)if(Pi.call(s,n)){var p=s[n];if(p!=null)switch(n){case"children":a=p;break;case"selected":u=p;break;case"dangerouslySetInnerHTML":h=p;break;case"value":l=p;default:Yi(e,i,n,p)}}if(o!=null)if(s=l!==null?""+l:B2(a),mw(o)){for(i=0;i<o.length;i++)if(""+o[i]===s){e.push(' selected=""');break}}else""+o===s&&e.push(' selected=""');else u&&e.push(' selected=""');return e.push(">"),_g(e,h,a),a;case"textarea":e.push(hn("textarea")),h=o=n=null;for(a in s)if(Pi.call(s,a)&&(l=s[a],l!=null))switch(a){case"children":h=l;break;case"value":n=l;break;case"defaultValue":o=l;break;case"dangerouslySetInnerHTML":throw Error(mt(91));default:Yi(e,i,a,l)}if(n===null&&o!==null&&(n=o),e.push(">"),h!=null){if(n!=null)throw Error(mt(92));if(mw(h)&&1<h.length)throw Error(mt(93));n=""+h}return typeof n=="string"&&n[0]===`
`&&e.push(`
`),n!==null&&e.push(hi(""+n)),null;case"input":e.push(hn("input")),l=h=a=n=null;for(o in s)if(Pi.call(s,o)&&(u=s[o],u!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(mt(399,"input"));case"defaultChecked":l=u;break;case"defaultValue":a=u;break;case"checked":h=u;break;case"value":n=u;break;default:Yi(e,i,o,u)}return h!==null?Yi(e,i,"checked",h):l!==null&&Yi(e,i,"checked",l),n!==null?Yi(e,i,"value",n):a!==null&&Yi(e,i,"value",a),e.push("/>"),null;case"menuitem":e.push(hn("menuitem"));for(var g in s)if(Pi.call(s,g)&&(n=s[g],n!=null))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(mt(400));default:Yi(e,i,g,n)}return e.push(">"),null;case"title":e.push(hn("title")),n=null;for(p in s)if(Pi.call(s,p)&&(o=s[p],o!=null))switch(p){case"children":n=o;break;case"dangerouslySetInnerHTML":throw Error(mt(434));default:Yi(e,i,p,o)}return e.push(">"),n;case"listing":case"pre":e.push(hn(t)),o=n=null;for(l in s)if(Pi.call(s,l)&&(a=s[l],a!=null))switch(l){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;default:Yi(e,i,l,a)}if(e.push(">"),o!=null){if(n!=null)throw Error(mt(60));if(typeof o!="object"||!("__html"in o))throw Error(mt(61));s=o.__html,s!=null&&(typeof s=="string"&&0<s.length&&s[0]===`
`?e.push(`
`,s):e.push(""+s))}return typeof n=="string"&&n[0]===`
`&&e.push(`
`),n;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(hn(t));for(var m in s)if(Pi.call(s,m)&&(n=s[m],n!=null))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(mt(399,t));default:Yi(e,i,m,n)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return wC(e,s,t,i);case"html":return r.insertionMode===0&&e.push("<!DOCTYPE html>"),wC(e,s,t,i);default:if(t.indexOf("-")===-1&&typeof s.is!="string")return wC(e,s,t,i);e.push(hn(t)),o=n=null;for(u in s)if(Pi.call(s,u)&&(a=s[u],a!=null))switch(u){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"style":BI(e,i,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:VI(u)&&typeof a!="function"&&typeof a!="symbol"&&e.push(" ",u,'="',hi(a),'"')}return e.push(">"),_g(e,o,n),n}}function Vb(e,t,s){if(e.push('<!--$?--><template id="'),s===null)throw Error(mt(395));return e.push(s),e.push('"></template>')}function W2(e,t,s,i){switch(s.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=i.toString(16),e.push(t),e.push('">');default:throw Error(mt(397))}}function z2(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(mt(397))}}var U2=/[<\u2028\u2029]/g;function SC(e){return JSON.stringify(e).replace(U2,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function $2(e,t){return t=t===void 0?"":t,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:t+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}function Bb(e,t,s,i){return s.generateStaticMarkup?(e.push(hi(t)),!1):(t===""?e=i:(i&&e.push("<!-- -->"),e.push(hi(t)),e=!0),e)}var _d=Object.assign,K2=Symbol.for("react.element"),HI=Symbol.for("react.portal"),jI=Symbol.for("react.fragment"),WI=Symbol.for("react.strict_mode"),zI=Symbol.for("react.profiler"),UI=Symbol.for("react.provider"),$I=Symbol.for("react.context"),KI=Symbol.for("react.forward_ref"),YI=Symbol.for("react.suspense"),qI=Symbol.for("react.suspense_list"),QI=Symbol.for("react.memo"),Q0=Symbol.for("react.lazy"),Y2=Symbol.for("react.scope"),q2=Symbol.for("react.debug_trace_mode"),Q2=Symbol.for("react.legacy_hidden"),Z2=Symbol.for("react.default_value"),Hb=Symbol.iterator;function vw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case jI:return"Fragment";case HI:return"Portal";case zI:return"Profiler";case WI:return"StrictMode";case YI:return"Suspense";case qI:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case $I:return(e.displayName||"Context")+".Consumer";case UI:return(e._context.displayName||"Context")+".Provider";case KI:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case QI:return t=e.displayName||null,t!==null?t:vw(e.type)||"Memo";case Q0:t=e._payload,e=e._init;try{return vw(e(t))}catch{}}return null}var ZI={};function jb(e,t){if(e=e.contextTypes,!e)return ZI;var s={},i;for(i in e)s[i]=t[i];return s}var Ka=null;function uv(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var s=t.parent;if(e===null){if(s!==null)throw Error(mt(401))}else{if(s===null)throw Error(mt(401));uv(e,s)}t.context._currentValue2=t.value}}function JI(e){e.context._currentValue2=e.parentValue,e=e.parent,e!==null&&JI(e)}function XI(e){var t=e.parent;t!==null&&XI(t),e.context._currentValue2=e.value}function eN(e,t){if(e.context._currentValue2=e.parentValue,e=e.parent,e===null)throw Error(mt(402));e.depth===t.depth?uv(e,t):eN(e,t)}function tN(e,t){var s=t.parent;if(s===null)throw Error(mt(402));e.depth===s.depth?uv(e,s):tN(e,s),t.context._currentValue2=t.value}function Gf(e){var t=Ka;t!==e&&(t===null?XI(e):e===null?JI(t):t.depth===e.depth?uv(t,e):t.depth>e.depth?eN(t,e):tN(t,e),Ka=e)}var Wb={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function zb(e,t,s,i){var r=e.state!==void 0?e.state:null;e.updater=Wb,e.props=s,e.state=r;var n={queue:[],replace:!1};e._reactInternals=n;var o=t.contextType;if(e.context=typeof o=="object"&&o!==null?o._currentValue2:i,o=t.getDerivedStateFromProps,typeof o=="function"&&(o=o(s,r),r=o==null?r:_d({},r,o),e.state=r),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&Wb.enqueueReplaceState(e,e.state,null),n.queue!==null&&0<n.queue.length)if(t=n.queue,o=n.replace,n.queue=null,n.replace=!1,o&&t.length===1)e.state=t[0];else{for(n=o?t[0]:e.state,r=!0,o=o?1:0;o<t.length;o++){var a=t[o];a=typeof a=="function"?a.call(e,n,s,i):a,a!=null&&(r?(r=!1,n=_d({},n,a)):_d(n,a))}e.state=n}else n.queue=null}var J2={id:1,overflow:""};function Cw(e,t,s){var i=e.id;e=e.overflow;var r=32-kg(i)-1;i&=~(1<<r),s+=1;var n=32-kg(t)+r;if(30<n){var o=r-r%5;return n=(i&(1<<o)-1).toString(32),i>>=o,r-=o,{id:1<<32-kg(t)+r|s<<r|i,overflow:n+e}}return{id:1<<n|s<<r|i,overflow:e}}var kg=Math.clz32?Math.clz32:tV,X2=Math.log,eV=Math.LN2;function tV(e){return e>>>=0,e===0?32:31-(X2(e)/eV|0)|0}function sV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var iV=typeof Object.is=="function"?Object.is:sV,eo=null,Z0=null,Mg=null,Yt=null,fd=!1,Vf=!1,Ah=0,Oo=null,dv=0;function Oa(){if(eo===null)throw Error(mt(321));return eo}function Ub(){if(0<dv)throw Error(mt(312));return{memoizedState:null,queue:null,next:null}}function J0(){return Yt===null?Mg===null?(fd=!1,Mg=Yt=Ub()):(fd=!0,Yt=Mg):Yt.next===null?(fd=!1,Yt=Yt.next=Ub()):(fd=!0,Yt=Yt.next),Yt}function X0(){Z0=eo=null,Vf=!1,Mg=null,dv=0,Yt=Oo=null}function sN(e,t){return typeof t=="function"?t(e):t}function $b(e,t,s){if(eo=Oa(),Yt=J0(),fd){var i=Yt.queue;if(t=i.dispatch,Oo!==null&&(s=Oo.get(i),s!==void 0)){Oo.delete(i),i=Yt.memoizedState;do i=e(i,s.action),s=s.next;while(s!==null);return Yt.memoizedState=i,[i,t]}return[Yt.memoizedState,t]}return e=e===sN?typeof t=="function"?t():t:s!==void 0?s(t):t,Yt.memoizedState=e,e=Yt.queue={last:null,dispatch:null},e=e.dispatch=rV.bind(null,eo,e),[Yt.memoizedState,e]}function Kb(e,t){if(eo=Oa(),Yt=J0(),t=t===void 0?null:t,Yt!==null){var s=Yt.memoizedState;if(s!==null&&t!==null){var i=s[1];e:if(i===null)i=!1;else{for(var r=0;r<i.length&&r<t.length;r++)if(!iV(t[r],i[r])){i=!1;break e}i=!0}if(i)return s[0]}}return e=e(),Yt.memoizedState=[e,t],e}function rV(e,t,s){if(25<=dv)throw Error(mt(301));if(e===eo)if(Vf=!0,e={action:s,next:null},Oo===null&&(Oo=new Map),s=Oo.get(t),s===void 0)Oo.set(t,e);else{for(t=s;t.next!==null;)t=t.next;t.next=e}}function nV(){throw Error(mt(394))}function og(){}var Yb={readContext:function(e){return e._currentValue2},useContext:function(e){return Oa(),e._currentValue2},useMemo:Kb,useReducer:$b,useRef:function(e){eo=Oa(),Yt=J0();var t=Yt.memoizedState;return t===null?(e={current:e},Yt.memoizedState=e):t},useState:function(e){return $b(sN,e)},useInsertionEffect:og,useLayoutEffect:function(){},useCallback:function(e,t){return Kb(function(){return e},t)},useImperativeHandle:og,useEffect:og,useDebugValue:og,useDeferredValue:function(e){return Oa(),e},useTransition:function(){return Oa(),[!1,nV]},useId:function(){var e=Z0.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-kg(e)-1)).toString(32)+t;var s=Lg;if(s===null)throw Error(mt(404));return t=Ah++,e=":"+s.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Oa(),t(e._source)},useSyncExternalStore:function(e,t,s){if(s===void 0)throw Error(mt(407));return s()}},Lg=null,xC=GI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function oV(e){return console.error(e),null}function md(){}function aV(e,t,s,i,r,n,o,a,l){var u=[],h=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:h,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:r===void 0?oV:r,onAllReady:md,onShellReady:o===void 0?md:o,onShellError:md,onFatalError:md},s=Bf(t,0,null,s,!1,!1),s.parentFlushed=!0,e=ex(t,e,null,s,h,ZI,null,J2),u.push(e),t}function ex(e,t,s,i,r,n,o,a){e.allPendingTasks++,s===null?e.pendingRootTasks++:s.pendingTasks++;var l={node:t,ping:function(){var u=e.pingedTasks;u.push(l),u.length===1&&nN(e)},blockedBoundary:s,blockedSegment:i,abortSet:r,legacyContext:n,context:o,treeContext:a};return r.add(l),l}function Bf(e,t,s,i,r,n){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:s,lastPushedText:r,textEmbedded:n}}function Fh(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function Hf(e,t){var s=e.onShellError;s(t),s=e.onFatalError,s(t),e.destination!==null?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function qb(e,t,s,i,r){for(eo={},Z0=t,Ah=0,e=s(i,r);Vf;)Vf=!1,Ah=0,dv+=1,Yt=null,e=s(i,r);return X0(),e}function Qb(e,t,s,i){var r=s.render(),n=i.childContextTypes;if(n!=null){var o=t.legacyContext;if(typeof s.getChildContext!="function")i=o;else{s=s.getChildContext();for(var a in s)if(!(a in n))throw Error(mt(108,vw(i)||"Unknown",a));i=_d({},o,s)}t.legacyContext=i,Zi(e,t,r),t.legacyContext=o}else Zi(e,t,r)}function Zb(e,t){if(e&&e.defaultProps){t=_d({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function yw(e,t,s,i,r){if(typeof s=="function")if(s.prototype&&s.prototype.isReactComponent){r=jb(s,t.legacyContext);var n=s.contextType;n=new s(i,typeof n=="object"&&n!==null?n._currentValue2:r),zb(n,s,i,r),Qb(e,t,n,s)}else{n=jb(s,t.legacyContext),r=qb(e,t,s,i,n);var o=Ah!==0;if(typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0)zb(r,s,i,n),Qb(e,t,r,s);else if(o){i=t.treeContext,t.treeContext=Cw(i,1,0);try{Zi(e,t,r)}finally{t.treeContext=i}}else Zi(e,t,r)}else if(typeof s=="string"){switch(r=t.blockedSegment,n=j2(r.chunks,s,i,e.responseState,r.formatContext),r.lastPushedText=!1,o=r.formatContext,r.formatContext=V2(o,s,i),ww(e,t,n),r.formatContext=o,s){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:r.chunks.push("</",s,">")}r.lastPushedText=!1}else{switch(s){case Q2:case q2:case WI:case zI:case jI:Zi(e,t,i.children);return;case qI:Zi(e,t,i.children);return;case Y2:throw Error(mt(343));case YI:e:{s=t.blockedBoundary,r=t.blockedSegment,n=i.fallback,i=i.children,o=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},l=Bf(e,r.chunks.length,a,r.formatContext,!1,!1);r.children.push(l),r.lastPushedText=!1;var u=Bf(e,0,null,r.formatContext,!1,!1);u.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=u;try{if(ww(e,t,i),e.responseState.generateStaticMarkup||u.lastPushedText&&u.textEmbedded&&u.chunks.push("<!-- -->"),u.status=1,jf(a,u),a.pendingTasks===0)break e}catch(h){u.status=4,a.forceClientRender=!0,a.errorDigest=Fh(e,h)}finally{t.blockedBoundary=s,t.blockedSegment=r}t=ex(e,n,s,l,o,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof s=="object"&&s!==null)switch(s.$$typeof){case KI:if(i=qb(e,t,s.render,i,r),Ah!==0){s=t.treeContext,t.treeContext=Cw(s,1,0);try{Zi(e,t,i)}finally{t.treeContext=s}}else Zi(e,t,i);return;case QI:s=s.type,i=Zb(s,i),yw(e,t,s,i,r);return;case UI:if(r=i.children,s=s._context,i=i.value,n=s._currentValue2,s._currentValue2=i,o=Ka,Ka=i={parent:o,depth:o===null?0:o.depth+1,context:s,parentValue:n,value:i},t.context=i,Zi(e,t,r),e=Ka,e===null)throw Error(mt(403));i=e.parentValue,e.context._currentValue2=i===Z2?e.context._defaultValue:i,e=Ka=e.parent,t.context=e;return;case $I:i=i.children,i=i(s._currentValue2),Zi(e,t,i);return;case Q0:r=s._init,s=r(s._payload),i=Zb(s,i),yw(e,t,s,i,void 0);return}throw Error(mt(130,s==null?s:typeof s,""))}}function Zi(e,t,s){if(t.node=s,typeof s=="object"&&s!==null){switch(s.$$typeof){case K2:yw(e,t,s.type,s.props,s.ref);return;case HI:throw Error(mt(257));case Q0:var i=s._init;s=i(s._payload),Zi(e,t,s);return}if(mw(s)){Jb(e,t,s);return}if(s===null||typeof s!="object"?i=null:(i=Hb&&s[Hb]||s["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(s))){if(s=i.next(),!s.done){var r=[];do r.push(s.value),s=i.next();while(!s.done);Jb(e,t,r)}return}throw e=Object.prototype.toString.call(s),Error(mt(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}typeof s=="string"?(i=t.blockedSegment,i.lastPushedText=Bb(t.blockedSegment.chunks,s,e.responseState,i.lastPushedText)):typeof s=="number"&&(i=t.blockedSegment,i.lastPushedText=Bb(t.blockedSegment.chunks,""+s,e.responseState,i.lastPushedText))}function Jb(e,t,s){for(var i=s.length,r=0;r<i;r++){var n=t.treeContext;t.treeContext=Cw(n,i,r);try{ww(e,t,s[r])}finally{t.treeContext=n}}}function ww(e,t,s){var i=t.blockedSegment.formatContext,r=t.legacyContext,n=t.context;try{return Zi(e,t,s)}catch(l){if(X0(),typeof l=="object"&&l!==null&&typeof l.then=="function"){s=l;var o=t.blockedSegment,a=Bf(e,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(a),o.lastPushedText=!1,e=ex(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,s.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Gf(n)}else throw t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Gf(n),l}}function lV(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,rN(this,t,e)}function iN(e,t,s){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.push(null))):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=s===void 0?Error(mt(432)):s,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(r){return iN(r,t,s)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function jf(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var s=t.children[0];s.id=t.id,s.parentFlushed=!0,s.status===1&&jf(e,s)}else e.completedSegments.push(t)}function rN(e,t,s){if(t===null){if(s.parentFlushed){if(e.completedRootSegment!==null)throw Error(mt(389));e.completedRootSegment=s}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=md,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(s.parentFlushed&&s.status===1&&jf(t,s),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(lV,e),t.fallbackAbortableTasks.clear()):s.parentFlushed&&s.status===1&&(jf(t,s),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function nN(e){if(e.status!==2){var t=Ka,s=xC.current;xC.current=Yb;var i=Lg;Lg=e.responseState;try{var r=e.pingedTasks,n;for(n=0;n<r.length;n++){var o=r[n],a=e,l=o.blockedSegment;if(l.status===0){Gf(o.context);try{Zi(a,o,o.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),o.abortSet.delete(o),l.status=1,rN(a,o.blockedBoundary,l)}catch(C){if(X0(),typeof C=="object"&&C!==null&&typeof C.then=="function"){var u=o.ping;C.then(u,u)}else{o.abortSet.delete(o),l.status=4;var h=o.blockedBoundary,p=C,g=Fh(a,p);if(h===null?Hf(a,p):(h.pendingTasks--,h.forceClientRender||(h.forceClientRender=!0,h.errorDigest=g,h.parentFlushed&&a.clientRenderedBoundaries.push(h))),a.allPendingTasks--,a.allPendingTasks===0){var m=a.onAllReady;m()}}}finally{}}}r.splice(0,n),e.destination!==null&&tx(e,e.destination)}catch(C){Fh(e,C),Hf(e,C)}finally{Lg=i,xC.current=s,s===Yb&&Gf(t)}}}function ag(e,t,s){switch(s.parentFlushed=!0,s.status){case 0:var i=s.id=e.nextSegmentId++;return s.lastPushedText=!1,s.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=i.toString(16),t.push(e),t.push('"></template>');case 1:s.status=2;var r=!0;i=s.chunks;var n=0;s=s.children;for(var o=0;o<s.length;o++){for(r=s[o];n<r.index;n++)t.push(i[n]);r=hv(e,t,r)}for(;n<i.length-1;n++)t.push(i[n]);return n<i.length&&(r=t.push(i[n])),r;default:throw Error(mt(390))}}function hv(e,t,s){var i=s.boundary;if(i===null)return ag(e,t,s);if(i.parentFlushed=!0,i.forceClientRender)return e.responseState.generateStaticMarkup||(i=i.errorDigest,t.push("<!--$!-->"),t.push("<template"),i&&(t.push(' data-dgst="'),i=hi(i),t.push(i),t.push('"')),t.push("></template>")),ag(e,t,s),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e;if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var r=e.responseState,n=r.nextSuspenseID++;return r=r.boundaryPrefix+n.toString(16),i=i.id=r,Vb(t,e.responseState,i),ag(e,t,s),t.push("<!--/$-->")}if(i.byteSize>e.progressiveChunkSize)return i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),Vb(t,e.responseState,i.id),ag(e,t,s),t.push("<!--/$-->");if(e.responseState.generateStaticMarkup||t.push("<!--$-->"),s=i.completedSegments,s.length!==1)throw Error(mt(391));return hv(e,t,s[0]),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e}function Xb(e,t,s){return W2(t,e.responseState,s.formatContext,s.id),hv(e,t,s),z2(t,s.formatContext)}function eR(e,t,s){for(var i=s.completedSegments,r=0;r<i.length;r++)oN(e,t,s,i[r]);if(i.length=0,e=e.responseState,i=s.id,s=s.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),i===null)throw Error(mt(395));return s=s.toString(16),t.push(i),t.push('","'),t.push(e.segmentPrefix),t.push(s),t.push('")<\/script>')}function oN(e,t,s,i){if(i.status===2)return!0;var r=i.id;if(r===-1){if((i.id=s.rootSegmentID)===-1)throw Error(mt(392));return Xb(e,t,i)}return Xb(e,t,i),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),r=r.toString(16),t.push(r),t.push('","'),t.push(e.placeholderPrefix),t.push(r),t.push('")<\/script>')}function tx(e,t){try{var s=e.completedRootSegment;if(s!==null&&e.pendingRootTasks===0){hv(e,t,s),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(s=0;s<i.length-1;s++)t.push(i[s]);s<i.length&&t.push(i[s])}var r=e.clientRenderedBoundaries,n;for(n=0;n<r.length;n++){var o=r[n];i=t;var a=e.responseState,l=o.id,u=o.errorDigest,h=o.errorMessage,p=o.errorComponentStack;if(i.push(a.startInlineScript),a.sentClientRenderFunction?i.push('$RX("'):(a.sentClientRenderFunction=!0,i.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(mt(395));if(i.push(l),i.push('"'),u||h||p){i.push(",");var g=SC(u||"");i.push(g)}if(h||p){i.push(",");var m=SC(h||"");i.push(m)}if(p){i.push(",");var C=SC(p);i.push(C)}if(!i.push(")<\/script>")){e.destination=null,n++,r.splice(0,n);return}}r.splice(0,n);var y=e.completedBoundaries;for(n=0;n<y.length;n++)if(!eR(e,t,y[n])){e.destination=null,n++,y.splice(0,n);return}y.splice(0,n);var R=e.partialBoundaries;for(n=0;n<R.length;n++){var x=R[n];e:{r=e,o=t;var S=x.completedSegments;for(a=0;a<S.length;a++)if(!oN(r,o,x,S[a])){a++,S.splice(0,a);var T=!1;break e}S.splice(0,a),T=!0}if(!T){e.destination=null,n++,R.splice(0,n);return}}R.splice(0,n);var I=e.completedBoundaries;for(n=0;n<I.length;n++)if(!eR(e,t,I[n])){e.destination=null,n++,I.splice(0,n);return}I.splice(0,n)}finally{e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.push(null)}}function cV(e,t){try{var s=e.abortableTasks;s.forEach(function(i){return iN(i,e,t)}),s.clear(),e.destination!==null&&tx(e,e.destination)}catch(i){Fh(e,i),Hf(e,i)}}function uV(){}function aN(e,t,s,i){var r=!1,n=null,o="",a={push:function(u){return u!==null&&(o+=u),!0},destroy:function(u){r=!0,n=u}},l=!1;if(e=aV(e,$2(s,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,uV,void 0,function(){l=!0}),nN(e),cV(e,i),e.status===1)e.status=2,a.destroy(e.fatalError);else if(e.status!==2&&e.destination===null){e.destination=a;try{tx(e,a)}catch(u){Fh(e,u),Hf(e,u)}}if(r)throw n;if(!l)throw Error(mt(426));return o}Pu.renderToNodeStream=function(){throw Error(mt(207))};Pu.renderToStaticMarkup=function(e,t){return aN(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Pu.renderToStaticNodeStream=function(){throw Error(mt(208))};Pu.renderToString=function(e,t){return aN(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Pu.version="18.3.1";var sx={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lN=E;function xt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ji=null,Xi=0;function it(e,t){if(t.length!==0)if(512<t.length)0<Xi&&(e.enqueue(new Uint8Array(Ji.buffer,0,Xi)),Ji=new Uint8Array(512),Xi=0),e.enqueue(t);else{var s=Ji.length-Xi;s<t.length&&(s===0?e.enqueue(Ji):(Ji.set(t.subarray(0,s),Xi),e.enqueue(Ji),t=t.subarray(s)),Ji=new Uint8Array(512),Xi=0),Ji.set(t,Xi),Xi+=t.length}}function ss(e,t){return it(e,t),!0}function tR(e){Ji&&0<Xi&&(e.enqueue(new Uint8Array(Ji.buffer,0,Xi)),Ji=null,Xi=0)}var cN=new TextEncoder;function Rt(e){return cN.encode(e)}function $e(e){return cN.encode(e)}function uN(e,t){typeof e.error=="function"?e.error(t):e.close()}var Ai=Object.prototype.hasOwnProperty,dV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sR={},iR={};function dN(e){return Ai.call(iR,e)?!0:Ai.call(sR,e)?!1:dV.test(e)?iR[e]=!0:(sR[e]=!0,!1)}function Ri(e,t,s,i,r,n,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=o}var Ks={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ks[e]=new Ri(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ks[t]=new Ri(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ks[e]=new Ri(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ks[e]=new Ri(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ks[e]=new Ri(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ks[e]=new Ri(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ks[e]=new Ri(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ks[e]=new Ri(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ks[e]=new Ri(e,5,!1,e.toLowerCase(),null,!1,!1)});var ix=/[\-:]([a-z])/g;function rx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ix,rx);Ks[t]=new Ri(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ix,rx);Ks[t]=new Ri(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ix,rx);Ks[t]=new Ri(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ks[e]=new Ri(e,1,!1,e.toLowerCase(),null,!1,!1)});Ks.xlinkHref=new Ri("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ks[e]=new Ri(e,1,!1,e.toLowerCase(),null,!0,!0)});var Og={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hV=["Webkit","ms","Moz","O"];Object.keys(Og).forEach(function(e){hV.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Og[t]=Og[e]})});var pV=/["'&<>]/;function js(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=pV.exec(e);if(t){var s="",i,r=0;for(i=t.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==i&&(s+=e.substring(r,i)),r=i+1,s+=t}e=r!==i?s+e.substring(r,i):s}return e}var gV=/([A-Z])/g,fV=/^ms-/,Sw=Array.isArray,mV=$e("<script>"),vV=$e("<\/script>"),CV=$e('<script src="'),yV=$e('<script type="module" src="'),rR=$e('" async=""><\/script>'),wV=/(<\/|<)(s)(cript)/gi;function SV(e,t,s,i){return""+t+(s==="s"?"\\u0073":"\\u0053")+i}function xV(e,t,s,i,r){e=e===void 0?"":e,t=t===void 0?mV:$e('<script nonce="'+js(t)+'">');var n=[];if(s!==void 0&&n.push(t,Rt((""+s).replace(wV,SV)),vV),i!==void 0)for(s=0;s<i.length;s++)n.push(CV,Rt(js(i[s])),rR);if(r!==void 0)for(i=0;i<r.length;i++)n.push(yV,Rt(js(r[i])),rR);return{bootstrapChunks:n,startInlineScript:t,placeholderPrefix:$e(e+"P:"),segmentPrefix:$e(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function pn(e,t){return{insertionMode:e,selectedValue:t}}function EV(e){return pn(e==="http://www.w3.org/2000/svg"?2:e==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function bV(e,t,s){switch(t){case"select":return pn(1,s.value!=null?s.value:s.defaultValue);case"svg":return pn(2,null);case"math":return pn(3,null);case"foreignObject":return pn(1,null);case"table":return pn(4,null);case"thead":case"tbody":case"tfoot":return pn(5,null);case"colgroup":return pn(7,null);case"tr":return pn(6,null)}return 4<=e.insertionMode||e.insertionMode===0?pn(1,null):e}var nx=$e("<!-- -->");function nR(e,t,s,i){return t===""?i:(i&&e.push(nx),e.push(Rt(js(t))),!0)}var oR=new Map,RV=$e(' style="'),aR=$e(":"),TV=$e(";");function hN(e,t,s){if(typeof s!="object")throw Error(xt(62));t=!0;for(var i in s)if(Ai.call(s,i)){var r=s[i];if(r!=null&&typeof r!="boolean"&&r!==""){if(i.indexOf("--")===0){var n=Rt(js(i));r=Rt(js((""+r).trim()))}else{n=i;var o=oR.get(n);o!==void 0||(o=$e(js(n.replace(gV,"-$1").toLowerCase().replace(fV,"-ms-"))),oR.set(n,o)),n=o,r=typeof r=="number"?r===0||Ai.call(Og,i)?Rt(""+r):Rt(r+"px"):Rt(js((""+r).trim()))}t?(t=!1,e.push(RV,n,aR,r)):e.push(TV,n,aR,r)}}t||e.push(Ga)}var So=$e(" "),ec=$e('="'),Ga=$e('"'),lR=$e('=""');function qi(e,t,s,i){switch(s){case"style":hN(e,t,i);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N"){if(t=Ks.hasOwnProperty(s)?Ks[s]:null,t!==null){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(s=Rt(t.attributeName),t.type){case 3:i&&e.push(So,s,lR);break;case 4:i===!0?e.push(So,s,lR):i!==!1&&e.push(So,s,ec,Rt(js(i)),Ga);break;case 5:isNaN(i)||e.push(So,s,ec,Rt(js(i)),Ga);break;case 6:!isNaN(i)&&1<=i&&e.push(So,s,ec,Rt(js(i)),Ga);break;default:t.sanitizeURL&&(i=""+i),e.push(So,s,ec,Rt(js(i)),Ga)}}else if(dN(s)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(t=s.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(So,Rt(s),ec,Rt(js(i)),Ga)}}}var xo=$e(">"),cR=$e("/>");function Gg(e,t,s){if(t!=null){if(s!=null)throw Error(xt(60));if(typeof t!="object"||!("__html"in t))throw Error(xt(61));t=t.__html,t!=null&&e.push(Rt(""+t))}}function DV(e){var t="";return lN.Children.forEach(e,function(s){s!=null&&(t+=s)}),t}var EC=$e(' selected=""');function bC(e,t,s,i){e.push(gn(s));var r=s=null,n;for(n in t)if(Ai.call(t,n)){var o=t[n];if(o!=null)switch(n){case"children":s=o;break;case"dangerouslySetInnerHTML":r=o;break;default:qi(e,i,n,o)}}return e.push(xo),Gg(e,r,s),typeof s=="string"?(e.push(Rt(js(s))),null):s}var RC=$e(`
`),PV=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,uR=new Map;function gn(e){var t=uR.get(e);if(t===void 0){if(!PV.test(e))throw Error(xt(65,e));t=$e("<"+e),uR.set(e,t)}return t}var AV=$e("<!DOCTYPE html>");function FV(e,t,s,i,r){switch(t){case"select":e.push(gn("select"));var n=null,o=null;for(h in s)if(Ai.call(s,h)){var a=s[h];if(a!=null)switch(h){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"defaultValue":case"value":break;default:qi(e,i,h,a)}}return e.push(xo),Gg(e,o,n),n;case"option":o=r.selectedValue,e.push(gn("option"));var l=a=null,u=null,h=null;for(n in s)if(Ai.call(s,n)){var p=s[n];if(p!=null)switch(n){case"children":a=p;break;case"selected":u=p;break;case"dangerouslySetInnerHTML":h=p;break;case"value":l=p;default:qi(e,i,n,p)}}if(o!=null)if(s=l!==null?""+l:DV(a),Sw(o)){for(i=0;i<o.length;i++)if(""+o[i]===s){e.push(EC);break}}else""+o===s&&e.push(EC);else u&&e.push(EC);return e.push(xo),Gg(e,h,a),a;case"textarea":e.push(gn("textarea")),h=o=n=null;for(a in s)if(Ai.call(s,a)&&(l=s[a],l!=null))switch(a){case"children":h=l;break;case"value":n=l;break;case"defaultValue":o=l;break;case"dangerouslySetInnerHTML":throw Error(xt(91));default:qi(e,i,a,l)}if(n===null&&o!==null&&(n=o),e.push(xo),h!=null){if(n!=null)throw Error(xt(92));if(Sw(h)&&1<h.length)throw Error(xt(93));n=""+h}return typeof n=="string"&&n[0]===`
`&&e.push(RC),n!==null&&e.push(Rt(js(""+n))),null;case"input":e.push(gn("input")),l=h=a=n=null;for(o in s)if(Ai.call(s,o)&&(u=s[o],u!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(xt(399,"input"));case"defaultChecked":l=u;break;case"defaultValue":a=u;break;case"checked":h=u;break;case"value":n=u;break;default:qi(e,i,o,u)}return h!==null?qi(e,i,"checked",h):l!==null&&qi(e,i,"checked",l),n!==null?qi(e,i,"value",n):a!==null&&qi(e,i,"value",a),e.push(cR),null;case"menuitem":e.push(gn("menuitem"));for(var g in s)if(Ai.call(s,g)&&(n=s[g],n!=null))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(xt(400));default:qi(e,i,g,n)}return e.push(xo),null;case"title":e.push(gn("title")),n=null;for(p in s)if(Ai.call(s,p)&&(o=s[p],o!=null))switch(p){case"children":n=o;break;case"dangerouslySetInnerHTML":throw Error(xt(434));default:qi(e,i,p,o)}return e.push(xo),n;case"listing":case"pre":e.push(gn(t)),o=n=null;for(l in s)if(Ai.call(s,l)&&(a=s[l],a!=null))switch(l){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;default:qi(e,i,l,a)}if(e.push(xo),o!=null){if(n!=null)throw Error(xt(60));if(typeof o!="object"||!("__html"in o))throw Error(xt(61));s=o.__html,s!=null&&(typeof s=="string"&&0<s.length&&s[0]===`
`?e.push(RC,Rt(s)):e.push(Rt(""+s)))}return typeof n=="string"&&n[0]===`
`&&e.push(RC),n;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(gn(t));for(var m in s)if(Ai.call(s,m)&&(n=s[m],n!=null))switch(m){case"children":case"dangerouslySetInnerHTML":throw Error(xt(399,t));default:qi(e,i,m,n)}return e.push(cR),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return bC(e,s,t,i);case"html":return r.insertionMode===0&&e.push(AV),bC(e,s,t,i);default:if(t.indexOf("-")===-1&&typeof s.is!="string")return bC(e,s,t,i);e.push(gn(t)),o=n=null;for(u in s)if(Ai.call(s,u)&&(a=s[u],a!=null))switch(u){case"children":n=a;break;case"dangerouslySetInnerHTML":o=a;break;case"style":hN(e,i,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:dN(u)&&typeof a!="function"&&typeof a!="symbol"&&e.push(So,Rt(u),ec,Rt(js(a)),Ga)}return e.push(xo),Gg(e,o,n),n}}var IV=$e("</"),NV=$e(">"),_V=$e('<template id="'),kV=$e('"></template>'),MV=$e("<!--$-->"),LV=$e('<!--$?--><template id="'),OV=$e('"></template>'),GV=$e("<!--$!-->"),VV=$e("<!--/$-->"),BV=$e("<template"),HV=$e('"'),jV=$e(' data-dgst="');$e(' data-msg="');$e(' data-stck="');var WV=$e("></template>");function dR(e,t,s){if(it(e,LV),s===null)throw Error(xt(395));return it(e,s),ss(e,OV)}var zV=$e('<div hidden id="'),UV=$e('">'),$V=$e("</div>"),KV=$e('<svg aria-hidden="true" style="display:none" id="'),YV=$e('">'),qV=$e("</svg>"),QV=$e('<math aria-hidden="true" style="display:none" id="'),ZV=$e('">'),JV=$e("</math>"),XV=$e('<table hidden id="'),eB=$e('">'),tB=$e("</table>"),sB=$e('<table hidden><tbody id="'),iB=$e('">'),rB=$e("</tbody></table>"),nB=$e('<table hidden><tr id="'),oB=$e('">'),aB=$e("</tr></table>"),lB=$e('<table hidden><colgroup id="'),cB=$e('">'),uB=$e("</colgroup></table>");function dB(e,t,s,i){switch(s.insertionMode){case 0:case 1:return it(e,zV),it(e,t.segmentPrefix),it(e,Rt(i.toString(16))),ss(e,UV);case 2:return it(e,KV),it(e,t.segmentPrefix),it(e,Rt(i.toString(16))),ss(e,YV);case 3:return it(e,QV),it(e,t.segmentPrefix),it(e,Rt(i.toString(16))),ss(e,ZV);case 4:return it(e,XV),it(e,t.segmentPrefix),it(e,Rt(i.toString(16))),ss(e,eB);case 5:return it(e,sB),it(e,t.segmentPrefix),it(e,Rt(i.toString(16))),ss(e,iB);case 6:return it(e,nB),it(e,t.segmentPrefix),it(e,Rt(i.toString(16))),ss(e,oB);case 7:return it(e,lB),it(e,t.segmentPrefix),it(e,Rt(i.toString(16))),ss(e,cB);default:throw Error(xt(397))}}function hB(e,t){switch(t.insertionMode){case 0:case 1:return ss(e,$V);case 2:return ss(e,qV);case 3:return ss(e,JV);case 4:return ss(e,tB);case 5:return ss(e,rB);case 6:return ss(e,aB);case 7:return ss(e,uB);default:throw Error(xt(397))}}var pB=$e('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),gB=$e('$RS("'),fB=$e('","'),mB=$e('")<\/script>'),vB=$e('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),CB=$e('$RC("'),yB=$e('","'),wB=$e('")<\/script>'),SB=$e('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),xB=$e('$RX("'),EB=$e('"'),bB=$e(")<\/script>"),TC=$e(","),RB=/[<\u2028\u2029]/g;function DC(e){return JSON.stringify(e).replace(RB,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var kd=Object.assign,TB=Symbol.for("react.element"),pN=Symbol.for("react.portal"),gN=Symbol.for("react.fragment"),fN=Symbol.for("react.strict_mode"),mN=Symbol.for("react.profiler"),vN=Symbol.for("react.provider"),CN=Symbol.for("react.context"),yN=Symbol.for("react.forward_ref"),wN=Symbol.for("react.suspense"),SN=Symbol.for("react.suspense_list"),xN=Symbol.for("react.memo"),ox=Symbol.for("react.lazy"),DB=Symbol.for("react.scope"),PB=Symbol.for("react.debug_trace_mode"),AB=Symbol.for("react.legacy_hidden"),FB=Symbol.for("react.default_value"),hR=Symbol.iterator;function xw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case gN:return"Fragment";case pN:return"Portal";case mN:return"Profiler";case fN:return"StrictMode";case wN:return"Suspense";case SN:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case CN:return(e.displayName||"Context")+".Consumer";case vN:return(e._context.displayName||"Context")+".Provider";case yN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case xN:return t=e.displayName||null,t!==null?t:xw(e.type)||"Memo";case ox:t=e._payload,e=e._init;try{return xw(e(t))}catch{}}return null}var EN={};function pR(e,t){if(e=e.contextTypes,!e)return EN;var s={},i;for(i in e)s[i]=t[i];return s}var Ya=null;function pv(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var s=t.parent;if(e===null){if(s!==null)throw Error(xt(401))}else{if(s===null)throw Error(xt(401));pv(e,s)}t.context._currentValue=t.value}}function bN(e){e.context._currentValue=e.parentValue,e=e.parent,e!==null&&bN(e)}function RN(e){var t=e.parent;t!==null&&RN(t),e.context._currentValue=e.value}function TN(e,t){if(e.context._currentValue=e.parentValue,e=e.parent,e===null)throw Error(xt(402));e.depth===t.depth?pv(e,t):TN(e,t)}function DN(e,t){var s=t.parent;if(s===null)throw Error(xt(402));e.depth===s.depth?pv(e,s):DN(e,s),t.context._currentValue=t.value}function Wf(e){var t=Ya;t!==e&&(t===null?RN(e):e===null?bN(t):t.depth===e.depth?pv(t,e):t.depth>e.depth?TN(t,e):DN(t,e),Ya=e)}var gR={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function fR(e,t,s,i){var r=e.state!==void 0?e.state:null;e.updater=gR,e.props=s,e.state=r;var n={queue:[],replace:!1};e._reactInternals=n;var o=t.contextType;if(e.context=typeof o=="object"&&o!==null?o._currentValue:i,o=t.getDerivedStateFromProps,typeof o=="function"&&(o=o(s,r),r=o==null?r:kd({},r,o),e.state=r),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&gR.enqueueReplaceState(e,e.state,null),n.queue!==null&&0<n.queue.length)if(t=n.queue,o=n.replace,n.queue=null,n.replace=!1,o&&t.length===1)e.state=t[0];else{for(n=o?t[0]:e.state,r=!0,o=o?1:0;o<t.length;o++){var a=t[o];a=typeof a=="function"?a.call(e,n,s,i):a,a!=null&&(r?(r=!1,n=kd({},n,a)):kd(n,a))}e.state=n}else n.queue=null}var IB={id:1,overflow:""};function Ew(e,t,s){var i=e.id;e=e.overflow;var r=32-Vg(i)-1;i&=~(1<<r),s+=1;var n=32-Vg(t)+r;if(30<n){var o=r-r%5;return n=(i&(1<<o)-1).toString(32),i>>=o,r-=o,{id:1<<32-Vg(t)+r|s<<r|i,overflow:n+e}}return{id:1<<n|s<<r|i,overflow:e}}var Vg=Math.clz32?Math.clz32:kB,NB=Math.log,_B=Math.LN2;function kB(e){return e>>>=0,e===0?32:31-(NB(e)/_B|0)|0}function MB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var LB=typeof Object.is=="function"?Object.is:MB,to=null,ax=null,Bg=null,qt=null,vd=!1,zf=!1,Ih=0,Go=null,gv=0;function Va(){if(to===null)throw Error(xt(321));return to}function mR(){if(0<gv)throw Error(xt(312));return{memoizedState:null,queue:null,next:null}}function lx(){return qt===null?Bg===null?(vd=!1,Bg=qt=mR()):(vd=!0,qt=Bg):qt.next===null?(vd=!1,qt=qt.next=mR()):(vd=!0,qt=qt.next),qt}function cx(){ax=to=null,zf=!1,Bg=null,gv=0,qt=Go=null}function PN(e,t){return typeof t=="function"?t(e):t}function vR(e,t,s){if(to=Va(),qt=lx(),vd){var i=qt.queue;if(t=i.dispatch,Go!==null&&(s=Go.get(i),s!==void 0)){Go.delete(i),i=qt.memoizedState;do i=e(i,s.action),s=s.next;while(s!==null);return qt.memoizedState=i,[i,t]}return[qt.memoizedState,t]}return e=e===PN?typeof t=="function"?t():t:s!==void 0?s(t):t,qt.memoizedState=e,e=qt.queue={last:null,dispatch:null},e=e.dispatch=OB.bind(null,to,e),[qt.memoizedState,e]}function CR(e,t){if(to=Va(),qt=lx(),t=t===void 0?null:t,qt!==null){var s=qt.memoizedState;if(s!==null&&t!==null){var i=s[1];e:if(i===null)i=!1;else{for(var r=0;r<i.length&&r<t.length;r++)if(!LB(t[r],i[r])){i=!1;break e}i=!0}if(i)return s[0]}}return e=e(),qt.memoizedState=[e,t],e}function OB(e,t,s){if(25<=gv)throw Error(xt(301));if(e===to)if(zf=!0,e={action:s,next:null},Go===null&&(Go=new Map),s=Go.get(t),s===void 0)Go.set(t,e);else{for(t=s;t.next!==null;)t=t.next;t.next=e}}function GB(){throw Error(xt(394))}function lg(){}var yR={readContext:function(e){return e._currentValue},useContext:function(e){return Va(),e._currentValue},useMemo:CR,useReducer:vR,useRef:function(e){to=Va(),qt=lx();var t=qt.memoizedState;return t===null?(e={current:e},qt.memoizedState=e):t},useState:function(e){return vR(PN,e)},useInsertionEffect:lg,useLayoutEffect:function(){},useCallback:function(e,t){return CR(function(){return e},t)},useImperativeHandle:lg,useEffect:lg,useDebugValue:lg,useDeferredValue:function(e){return Va(),e},useTransition:function(){return Va(),[!1,GB]},useId:function(){var e=ax.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-Vg(e)-1)).toString(32)+t;var s=Hg;if(s===null)throw Error(xt(404));return t=Ih++,e=":"+s.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Va(),t(e._source)},useSyncExternalStore:function(e,t,s){if(s===void 0)throw Error(xt(407));return s()}},Hg=null,PC=lN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function VB(e){return console.error(e),null}function Cd(){}function BB(e,t,s,i,r,n,o,a,l){var u=[],h=new Set;return t={destination:null,responseState:t,progressiveChunkSize:i===void 0?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:h,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:r===void 0?VB:r,onAllReady:n===void 0?Cd:n,onShellReady:o===void 0?Cd:o,onShellError:a===void 0?Cd:a,onFatalError:l===void 0?Cd:l},s=Uf(t,0,null,s,!1,!1),s.parentFlushed=!0,e=ux(t,e,null,s,h,EN,null,IB),u.push(e),t}function ux(e,t,s,i,r,n,o,a){e.allPendingTasks++,s===null?e.pendingRootTasks++:s.pendingTasks++;var l={node:t,ping:function(){var u=e.pingedTasks;u.push(l),u.length===1&&IN(e)},blockedBoundary:s,blockedSegment:i,abortSet:r,legacyContext:n,context:o,treeContext:a};return r.add(l),l}function Uf(e,t,s,i,r,n){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:s,lastPushedText:r,textEmbedded:n}}function Nh(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function $f(e,t){var s=e.onShellError;s(t),s=e.onFatalError,s(t),e.destination!==null?(e.status=2,uN(e.destination,t)):(e.status=1,e.fatalError=t)}function wR(e,t,s,i,r){for(to={},ax=t,Ih=0,e=s(i,r);zf;)zf=!1,Ih=0,gv+=1,qt=null,e=s(i,r);return cx(),e}function SR(e,t,s,i){var r=s.render(),n=i.childContextTypes;if(n!=null){var o=t.legacyContext;if(typeof s.getChildContext!="function")i=o;else{s=s.getChildContext();for(var a in s)if(!(a in n))throw Error(xt(108,xw(i)||"Unknown",a));i=kd({},o,s)}t.legacyContext=i,er(e,t,r),t.legacyContext=o}else er(e,t,r)}function xR(e,t){if(e&&e.defaultProps){t=kd({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function bw(e,t,s,i,r){if(typeof s=="function")if(s.prototype&&s.prototype.isReactComponent){r=pR(s,t.legacyContext);var n=s.contextType;n=new s(i,typeof n=="object"&&n!==null?n._currentValue:r),fR(n,s,i,r),SR(e,t,n,s)}else{n=pR(s,t.legacyContext),r=wR(e,t,s,i,n);var o=Ih!==0;if(typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0)fR(r,s,i,n),SR(e,t,r,s);else if(o){i=t.treeContext,t.treeContext=Ew(i,1,0);try{er(e,t,r)}finally{t.treeContext=i}}else er(e,t,r)}else if(typeof s=="string"){switch(r=t.blockedSegment,n=FV(r.chunks,s,i,e.responseState,r.formatContext),r.lastPushedText=!1,o=r.formatContext,r.formatContext=bV(o,s,i),Rw(e,t,n),r.formatContext=o,s){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:r.chunks.push(IV,Rt(s),NV)}r.lastPushedText=!1}else{switch(s){case AB:case PB:case fN:case mN:case gN:er(e,t,i.children);return;case SN:er(e,t,i.children);return;case DB:throw Error(xt(343));case wN:e:{s=t.blockedBoundary,r=t.blockedSegment,n=i.fallback,i=i.children,o=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},l=Uf(e,r.chunks.length,a,r.formatContext,!1,!1);r.children.push(l),r.lastPushedText=!1;var u=Uf(e,0,null,r.formatContext,!1,!1);u.parentFlushed=!0,t.blockedBoundary=a,t.blockedSegment=u;try{if(Rw(e,t,i),u.lastPushedText&&u.textEmbedded&&u.chunks.push(nx),u.status=1,Kf(a,u),a.pendingTasks===0)break e}catch(h){u.status=4,a.forceClientRender=!0,a.errorDigest=Nh(e,h)}finally{t.blockedBoundary=s,t.blockedSegment=r}t=ux(e,n,s,l,o,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof s=="object"&&s!==null)switch(s.$$typeof){case yN:if(i=wR(e,t,s.render,i,r),Ih!==0){s=t.treeContext,t.treeContext=Ew(s,1,0);try{er(e,t,i)}finally{t.treeContext=s}}else er(e,t,i);return;case xN:s=s.type,i=xR(s,i),bw(e,t,s,i,r);return;case vN:if(r=i.children,s=s._context,i=i.value,n=s._currentValue,s._currentValue=i,o=Ya,Ya=i={parent:o,depth:o===null?0:o.depth+1,context:s,parentValue:n,value:i},t.context=i,er(e,t,r),e=Ya,e===null)throw Error(xt(403));i=e.parentValue,e.context._currentValue=i===FB?e.context._defaultValue:i,e=Ya=e.parent,t.context=e;return;case CN:i=i.children,i=i(s._currentValue),er(e,t,i);return;case ox:r=s._init,s=r(s._payload),i=xR(s,i),bw(e,t,s,i,void 0);return}throw Error(xt(130,s==null?s:typeof s,""))}}function er(e,t,s){if(t.node=s,typeof s=="object"&&s!==null){switch(s.$$typeof){case TB:bw(e,t,s.type,s.props,s.ref);return;case pN:throw Error(xt(257));case ox:var i=s._init;s=i(s._payload),er(e,t,s);return}if(Sw(s)){ER(e,t,s);return}if(s===null||typeof s!="object"?i=null:(i=hR&&s[hR]||s["@@iterator"],i=typeof i=="function"?i:null),i&&(i=i.call(s))){if(s=i.next(),!s.done){var r=[];do r.push(s.value),s=i.next();while(!s.done);ER(e,t,r)}return}throw e=Object.prototype.toString.call(s),Error(xt(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}typeof s=="string"?(i=t.blockedSegment,i.lastPushedText=nR(t.blockedSegment.chunks,s,e.responseState,i.lastPushedText)):typeof s=="number"&&(i=t.blockedSegment,i.lastPushedText=nR(t.blockedSegment.chunks,""+s,e.responseState,i.lastPushedText))}function ER(e,t,s){for(var i=s.length,r=0;r<i;r++){var n=t.treeContext;t.treeContext=Ew(n,i,r);try{Rw(e,t,s[r])}finally{t.treeContext=n}}}function Rw(e,t,s){var i=t.blockedSegment.formatContext,r=t.legacyContext,n=t.context;try{return er(e,t,s)}catch(l){if(cx(),typeof l=="object"&&l!==null&&typeof l.then=="function"){s=l;var o=t.blockedSegment,a=Uf(e,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(a),o.lastPushedText=!1,e=ux(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,s.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Wf(n)}else throw t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=n,Wf(n),l}}function HB(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,FN(this,t,e)}function AN(e,t,s){var i=e.blockedBoundary;e.blockedSegment.status=3,i===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.close())):(i.pendingTasks--,i.forceClientRender||(i.forceClientRender=!0,e=s===void 0?Error(xt(432)):s,i.errorDigest=t.onError(e),i.parentFlushed&&t.clientRenderedBoundaries.push(i)),i.fallbackAbortableTasks.forEach(function(r){return AN(r,t,s)}),i.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(i=t.onAllReady,i()))}function Kf(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var s=t.children[0];s.id=t.id,s.parentFlushed=!0,s.status===1&&Kf(e,s)}else e.completedSegments.push(t)}function FN(e,t,s){if(t===null){if(s.parentFlushed){if(e.completedRootSegment!==null)throw Error(xt(389));e.completedRootSegment=s}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=Cd,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(s.parentFlushed&&s.status===1&&Kf(t,s),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(HB,e),t.fallbackAbortableTasks.clear()):s.parentFlushed&&s.status===1&&(Kf(t,s),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function IN(e){if(e.status!==2){var t=Ya,s=PC.current;PC.current=yR;var i=Hg;Hg=e.responseState;try{var r=e.pingedTasks,n;for(n=0;n<r.length;n++){var o=r[n],a=e,l=o.blockedSegment;if(l.status===0){Wf(o.context);try{er(a,o,o.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(nx),o.abortSet.delete(o),l.status=1,FN(a,o.blockedBoundary,l)}catch(C){if(cx(),typeof C=="object"&&C!==null&&typeof C.then=="function"){var u=o.ping;C.then(u,u)}else{o.abortSet.delete(o),l.status=4;var h=o.blockedBoundary,p=C,g=Nh(a,p);if(h===null?$f(a,p):(h.pendingTasks--,h.forceClientRender||(h.forceClientRender=!0,h.errorDigest=g,h.parentFlushed&&a.clientRenderedBoundaries.push(h))),a.allPendingTasks--,a.allPendingTasks===0){var m=a.onAllReady;m()}}}finally{}}}r.splice(0,n),e.destination!==null&&dx(e,e.destination)}catch(C){Nh(e,C),$f(e,C)}finally{Hg=i,PC.current=s,s===yR&&Wf(t)}}}function cg(e,t,s){switch(s.parentFlushed=!0,s.status){case 0:var i=s.id=e.nextSegmentId++;return s.lastPushedText=!1,s.textEmbedded=!1,e=e.responseState,it(t,_V),it(t,e.placeholderPrefix),e=Rt(i.toString(16)),it(t,e),ss(t,kV);case 1:s.status=2;var r=!0;i=s.chunks;var n=0;s=s.children;for(var o=0;o<s.length;o++){for(r=s[o];n<r.index;n++)it(t,i[n]);r=fv(e,t,r)}for(;n<i.length-1;n++)it(t,i[n]);return n<i.length&&(r=ss(t,i[n])),r;default:throw Error(xt(390))}}function fv(e,t,s){var i=s.boundary;if(i===null)return cg(e,t,s);if(i.parentFlushed=!0,i.forceClientRender)i=i.errorDigest,ss(t,GV),it(t,BV),i&&(it(t,jV),it(t,Rt(js(i))),it(t,HV)),ss(t,WV),cg(e,t,s);else if(0<i.pendingTasks){i.rootSegmentID=e.nextSegmentId++,0<i.completedSegments.length&&e.partialBoundaries.push(i);var r=e.responseState,n=r.nextSuspenseID++;r=$e(r.boundaryPrefix+n.toString(16)),i=i.id=r,dR(t,e.responseState,i),cg(e,t,s)}else if(i.byteSize>e.progressiveChunkSize)i.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(i),dR(t,e.responseState,i.id),cg(e,t,s);else{if(ss(t,MV),s=i.completedSegments,s.length!==1)throw Error(xt(391));fv(e,t,s[0])}return ss(t,VV)}function bR(e,t,s){return dB(t,e.responseState,s.formatContext,s.id),fv(e,t,s),hB(t,s.formatContext)}function RR(e,t,s){for(var i=s.completedSegments,r=0;r<i.length;r++)NN(e,t,s,i[r]);if(i.length=0,e=e.responseState,i=s.id,s=s.rootSegmentID,it(t,e.startInlineScript),e.sentCompleteBoundaryFunction?it(t,CB):(e.sentCompleteBoundaryFunction=!0,it(t,vB)),i===null)throw Error(xt(395));return s=Rt(s.toString(16)),it(t,i),it(t,yB),it(t,e.segmentPrefix),it(t,s),ss(t,wB)}function NN(e,t,s,i){if(i.status===2)return!0;var r=i.id;if(r===-1){if((i.id=s.rootSegmentID)===-1)throw Error(xt(392));return bR(e,t,i)}return bR(e,t,i),e=e.responseState,it(t,e.startInlineScript),e.sentCompleteSegmentFunction?it(t,gB):(e.sentCompleteSegmentFunction=!0,it(t,pB)),it(t,e.segmentPrefix),r=Rt(r.toString(16)),it(t,r),it(t,fB),it(t,e.placeholderPrefix),it(t,r),ss(t,mB)}function dx(e,t){Ji=new Uint8Array(512),Xi=0;try{var s=e.completedRootSegment;if(s!==null&&e.pendingRootTasks===0){fv(e,t,s),e.completedRootSegment=null;var i=e.responseState.bootstrapChunks;for(s=0;s<i.length-1;s++)it(t,i[s]);s<i.length&&ss(t,i[s])}var r=e.clientRenderedBoundaries,n;for(n=0;n<r.length;n++){var o=r[n];i=t;var a=e.responseState,l=o.id,u=o.errorDigest,h=o.errorMessage,p=o.errorComponentStack;if(it(i,a.startInlineScript),a.sentClientRenderFunction?it(i,xB):(a.sentClientRenderFunction=!0,it(i,SB)),l===null)throw Error(xt(395));it(i,l),it(i,EB),(u||h||p)&&(it(i,TC),it(i,Rt(DC(u||"")))),(h||p)&&(it(i,TC),it(i,Rt(DC(h||"")))),p&&(it(i,TC),it(i,Rt(DC(p)))),ss(i,bB)}r.splice(0,n);var g=e.completedBoundaries;for(n=0;n<g.length;n++)RR(e,t,g[n]);g.splice(0,n),tR(t),Ji=new Uint8Array(512),Xi=0;var m=e.partialBoundaries;for(n=0;n<m.length;n++){var C=m[n];e:{r=e,o=t;var y=C.completedSegments;for(a=0;a<y.length;a++)if(!NN(r,o,C,y[a])){a++,y.splice(0,a);var R=!1;break e}y.splice(0,a),R=!0}if(!R){e.destination=null,n++,m.splice(0,n);return}}m.splice(0,n);var x=e.completedBoundaries;for(n=0;n<x.length;n++)RR(e,t,x[n]);x.splice(0,n)}finally{tR(t),e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.close()}}function TR(e,t){try{var s=e.abortableTasks;s.forEach(function(i){return AN(i,e,t)}),s.clear(),e.destination!==null&&dx(e,e.destination)}catch(i){Nh(e,i),$f(e,i)}}sx.renderToReadableStream=function(e,t){return new Promise(function(s,i){var r,n,o=new Promise(function(h,p){n=h,r=p}),a=BB(e,xV(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),EV(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,n,function(){var h=new ReadableStream({type:"bytes",pull:function(p){if(a.status===1)a.status=2,uN(p,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=p;try{dx(a,p)}catch(g){Nh(a,g),$f(a,g)}}},cancel:function(){TR(a)}},{highWaterMark:0});h.allReady=o,s(h)},function(h){o.catch(function(){}),i(h)},r);if(t&&t.signal){var l=t.signal,u=function(){TR(a,l.reason),l.removeEventListener("abort",u)};l.addEventListener("abort",u)}IN(a)})};sx.version="18.3.1";var Au,_N;Au=Pu,_N=sx;Au.version;Au.renderToString;var jB=Au.renderToStaticMarkup;Au.renderToNodeStream;Au.renderToStaticNodeStream;_N.renderToReadableStream;var WB=Object.defineProperty,zB=Object.defineProperties,UB=Object.getOwnPropertyDescriptors,DR=Object.getOwnPropertySymbols,$B=Object.prototype.hasOwnProperty,KB=Object.prototype.propertyIsEnumerable,PR=(e,t,s)=>t in e?WB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ns=(e,t)=>{for(var s in t||(t={}))$B.call(t,s)&&PR(e,s,t[s]);if(DR)for(var s of DR(t))KB.call(t,s)&&PR(e,s,t[s]);return e},vi=(e,t)=>zB(e,UB(t)),hx=E.createContext({setMethods:()=>{}}),YB=e=>{const{initialProps:t,addUpdateCallback:s,CustomComponentClass:i,setMethods:r}=e,[n,o]=E.useState(t);return E.useEffect(()=>{s(a=>o(a))},[]),Fe.createElement(hx.Provider,{value:{setMethods:r}},Fe.createElement(i,ns({},n)))},qB=E.memo(YB),QB=0;function AR(){return`agPortalKey_${++QB}`}var kN=class{constructor(e,t,s,i){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=s,this.suppressFallbackMethods=!!i,this.statelessComponent=this.isStateless(this.reactComponent),this.key=AR(),this.portalKey=AR(),this.instanceCreated=this.isStatelessComponent()?ws.resolve(!1):new ws(r=>{this.resolveInstanceCreated=r})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){return this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy(),this.portalManager.destroyPortal(this.portal)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),s=document.createElement(t||"div");return s.classList.add("ag-react-container"),e.reactContainer=s,s}addParentContainerStyleAndClasses(){this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&(rt.warnOnce('Since v31.1 "getReactContainerStyle" is deprecated. Apply styling directly to ".ag-react-container" if needed.'),Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle())),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses()&&(rt.warnOnce('Since v31.1 "getReactContainerClasses" is deprecated. Apply styling directly to ".ag-react-container" if needed.'),this.componentInstance.getReactContainerClasses().forEach(t=>this.eParentElement.classList.add(t))))}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&t[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,t){const s=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!s){setTimeout(()=>this.callMethod(e,t));return}const i=s[e];if(i)return i.apply(s,t);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,t&&t[0]?t[0]:{})}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.params=e,this.createOrUpdatePortal(e),new ws(t=>this.createReactComponent(t))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=t=>{var s;this.componentInstance=t,this.addParentContainerStyleAndClasses(),(s=this.resolveInstanceCreated)==null||s.call(this,!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,vi(ns({},e),{key:this.key})),this.portal=Dm.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return E.createElement(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,t=>{e(t)})}isNullValue(){return this.valueRenderedIsNull(this.params)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}valueRenderedIsNull(e){if(!this.componentType.cellRenderer)return!1;const t=console.error;try{return console.error=()=>{},jB(E.createElement(this.reactComponent,e))===""}catch{}finally{console.error=t}return!1}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const s=this[`${e}Component`];if(!this.suppressFallbackMethods&&s)return s.bind(this)(t)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function px(e,t,s){e.forEach(i=>{const r=t[i];r&&(s[i]=r)})}var ya=class extends kN{constructor(){super(...arguments),this.awaitUpdateCallback=new ws(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=qB}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:s=>this.setMethods(s),addUpdateCallback:s=>{this.updateCallback=()=>(s(this.getProps()),new ws(i=>{setTimeout(()=>{i()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,px(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return vi(ns({},this.sourceParams),{key:this.key,ref:this.ref})}refreshProps(){return this.updateCallback?this.updateCallback():new ws(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},ZB=class extends ya{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},JB=class extends ya{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterChangedCallback()}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.model=e,this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getOptionalMethods(){return["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}updateModel(e){this.setModel(e).then(()=>this.sourceParams.filterChangedCallback())}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,delete e.filterModifiedCallback,delete e.valueGetter,e}};function MN(e,t){e.parentFilterInstance(s=>{(s.setModel(t)||ws.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var XB=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=s=>this.updateModel(s)}getProps(){return vi(ns({},this.floatingFilterParams),{model:this.model,onModelChange:this.onModelChange})}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){px(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),MN(this.floatingFilterParams,e)}},eH=class extends ya{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),MN(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},tH=class extends ya{refresh(e){this.sourceParams=e,this.refreshProps()}},sH=class extends ya{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},iH=class extends ya{refresh(e){this.sourceParams=e,this.refreshProps()}},rH=class extends ya{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},nH=class extends ya{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}},LN=class ON{constructor(t,s,i){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=s||"div",this.refresher=t,this.maxComponentCreationTimeMs=i||ON.MAX_COMPONENT_CREATION_TIME_IN_MS}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(t){this.portals=this.portals.filter(s=>s!==t),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(t,s,i){this.portals=[...this.portals,t],this.waitForInstance(s,i),this.batchUpdate()}updateReactPortal(t,s){this.portals[this.portals.indexOf(t)]=s,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(t,s,i=Date.now()){if(this.destroyed){s(null);return}if(t.rendered())s(t);else{if(Date.now()-i>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){if(t.isNullValue()){s(t);return}console.error(`AG Grid: React Component '${t.getReactComponentName()}' not created within ${this.maxComponentCreationTimeMs}ms.`),console.error("    If the component is using `forwardRef` but not `useImperativeHandle`, add the following: `useImperativeHandle(ref, () => ({}));`");return}window.setTimeout(()=>{this.waitForInstance(t,s,i)})}}};LN.MAX_COMPONENT_CREATION_TIME_IN_MS=1e3;var oH=LN,Ti=Fe.createContext({}),$r=(...e)=>e.filter(s=>s!=null&&s!=="").join(" "),xr=class GN{constructor(...t){this.classesMap={},t.forEach(s=>{this.classesMap[s]=!0})}setClass(t,s){if(!!this.classesMap[t]==s)return this;const r=new GN;return r.classesMap=ns({},this.classesMap),r.classesMap[t]=s,r}toString(){return Object.keys(this.classesMap).filter(s=>this.classesMap[s]).join(" ")}},Fu=e=>{const t=()=>typeof Symbol=="function"&&Symbol.for,s=()=>t()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===s()},aH=Oy.createRoot!=null&&Oy.flushSync!=null,jg=!1;function lH(e){return jg||setTimeout(()=>jg=!1,0),jg=!0,e()}var gx=(e,t)=>{aH&&e&&!jg?Oy.flushSync(t):t()};function fx(e,t,s){if(t==null||e==null)return t;if(e===t||t.length===0&&e.length===0)return e;if(s||e.length===0&&t.length>0||e.length>0&&t.length===0)return t;const i=[],r=[],n=new Map,o=new Map;for(let a=0;a<t.length;a++){const l=t[a];o.set(l.getInstanceId(),l)}for(let a=0;a<e.length;a++){const l=e[a];n.set(l.getInstanceId(),l),o.has(l.getInstanceId())&&i.push(l)}for(let a=0;a<t.length;a++){const l=t[a],u=l.getInstanceId();n.has(u)||r.push(l)}return i.length===e.length&&r.length===0?e:i.length===0&&r.length===t.length?t:i.length===0?r:r.length===0?i:[...i,...r]}var Rp=(e,t,s,i)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const n=e.newAgStackInstance();if(!n)return;let o,a,l=!1;return n.then(u=>{if(l){t.destroyBean(u);return}o=u,a=o.getGui(),s.appendChild(a),FR(i,o)}),()=>{l=!0,o&&(a&&a.parentElement&&a.parentElement.removeChild(a),t.destroyBean(o),i&&FR(i,void 0))}},FR=(e,t)=>{if(e)if(e instanceof Function)e(t);else{const s=e;s.current=t}},cH=e=>{const t=e.newAgStackInstance();if(t)return t.resolveNow(null,s=>s)},VN=E.forwardRef((e,t)=>{var s;const i=E.useContext(Ti).context,r=E.useRef(null),n=E.useRef(null),o=E.useRef(null),a=E.useRef(null),l=E.useRef(null),u=E.useRef(),[h,p]=E.useState(),[g,m]=E.useState(),[C,y]=E.useState(),[R,x]=E.useState(()=>new xr),[S,T]=E.useState(()=>new xr("ag-hidden")),[I,V]=E.useState(()=>new xr("ag-hidden")),[H,P]=E.useState(()=>new xr("ag-invisible"));E.useImperativeHandle(t,()=>({refresh(){return!1}})),E.useLayoutEffect(()=>Rp(h,i,n.current),[h]);const N=E.useCallback(me=>{if(r.current=me,!r.current){i.destroyBean(u.current),u.current=null;return}const de={setInnerRenderer:(ye,pe)=>{p(ye),y(pe)},setChildCount:ye=>m(ye),addOrRemoveCssClass:(ye,pe)=>x(q=>q.setClass(ye,pe)),setContractedDisplayed:ye=>V(pe=>pe.setClass("ag-hidden",!ye)),setExpandedDisplayed:ye=>T(pe=>pe.setClass("ag-hidden",!ye)),setCheckboxVisible:ye=>P(pe=>pe.setClass("ag-invisible",!ye))};u.current=i.createBean(new Ml),u.current.init(de,r.current,o.current,a.current,l.current,VN,e)},[]),_=E.useMemo(()=>`ag-cell-wrapper ${R.toString()}`,[R]),L=E.useMemo(()=>`ag-group-expanded ${S.toString()}`,[S]),M=E.useMemo(()=>`ag-group-contracted ${I.toString()}`,[I]),b=E.useMemo(()=>`ag-group-checkbox ${H.toString()}`,[H]),F=h&&h.componentFromFramework,Z=F?h.componentClass:void 0,K=h==null&&C!=null,ge=rt.escapeString(C,!0);return Fe.createElement("span",ns({className:_,ref:N},e.colDef?{}:{role:(s=u.current)==null?void 0:s.getCellAriaRole()}),Fe.createElement("span",{className:L,ref:a}),Fe.createElement("span",{className:M,ref:l}),Fe.createElement("span",{className:b,ref:o}),Fe.createElement("span",{className:"ag-group-value",ref:n},K&&Fe.createElement(Fe.Fragment,null,ge),F&&Fe.createElement(Z,ns({},h.params))),Fe.createElement("span",{className:"ag-group-child-count"},g))}),IR=VN,uH=e=>{const{ctrl:t}=e,s=t.isAlive(),{context:i}=E.useContext(Ti),r=s?t.getColId():void 0,[n,o]=E.useState(),a=E.useRef(null),l=E.useRef(null),u=E.useRef(null),h=E.useRef();let p=E.useRef();s&&!p.current&&(p.current=new dp(()=>a.current));const g=E.useCallback(R=>{var x;if(a.current=R,!a.current||!s)return;const S={setWidth:I=>{a.current&&(a.current.style.width=I)},addOrRemoveCssClass:(I,V)=>p.current.addOrRemoveCssClass(I,V),setAriaSort:I=>{a.current&&(I?rt.setAriaSort(a.current,I):rt.removeAriaSort(a.current))},setUserCompDetails:I=>o(I),getUserCompInstance:()=>h.current||void 0};t.setComp(S,a.current,l.current,u.current);const T=t.getSelectAllGui();(x=l.current)==null||x.insertAdjacentElement("afterend",T)},[]);E.useLayoutEffect(()=>Rp(n,i,u.current,h),[n]),E.useEffect(()=>{t.setDragSource(a.current)},[n]);const m=E.useMemo(()=>!!((n==null?void 0:n.componentFromFramework)&&Fu(n.componentClass)),[n]),C=n&&n.componentFromFramework,y=n&&n.componentClass;return Fe.createElement("div",{ref:g,className:"ag-header-cell","col-id":r,role:"columnheader"},Fe.createElement("div",{ref:l,className:"ag-header-cell-resize",role:"presentation"}),Fe.createElement("div",{ref:u,className:"ag-header-cell-comp-wrapper",role:"presentation"},C&&m&&Fe.createElement(y,ns({},n.params)),C&&!m&&Fe.createElement(y,vi(ns({},n.params),{ref:h}))))},dH=E.memo(uH),hH=e=>{const{context:t}=E.useContext(Ti),{ctrl:s}=e,[i,r]=E.useState(()=>new xr),[n,o]=E.useState(()=>new xr),[a,l]=E.useState("false"),[u,h]=E.useState(),[p,g]=E.useState(),m=E.useMemo(()=>s.getColId(),[]),C=E.useRef(null),y=E.useRef(null),R=E.useRef(),x=E.useCallback(P=>{if(C.current=P,!C.current)return;const N={setWidth:_=>{C.current&&(C.current.style.width=_)},addOrRemoveCssClass:(_,L)=>r(M=>M.setClass(_,L)),setUserCompDetails:_=>g(_),setResizableDisplayed:_=>{o(L=>L.setClass("ag-hidden",!_)),l(_?"false":"true")},setAriaExpanded:_=>h(_),getUserCompInstance:()=>R.current||void 0};s.setComp(N,C.current,y.current)},[]);E.useLayoutEffect(()=>Rp(p,t,C.current),[p]),E.useEffect(()=>{C.current&&s.setDragSource(C.current)},[p]);const S=E.useMemo(()=>!!((p==null?void 0:p.componentFromFramework)&&Fu(p.componentClass)),[p]),T=E.useMemo(()=>"ag-header-group-cell "+i.toString(),[i]),I=E.useMemo(()=>"ag-header-cell-resize "+n.toString(),[n]),V=p&&p.componentFromFramework,H=p&&p.componentClass;return Fe.createElement("div",{ref:x,className:T,"col-id":m,role:"columnheader","aria-expanded":u},V&&S&&Fe.createElement(H,ns({},p.params)),V&&!S&&Fe.createElement(H,vi(ns({},p.params),{ref:R})),Fe.createElement("div",{ref:y,"aria-hidden":a,className:I}))},pH=E.memo(hH);function mx(){rt.warnOnce("Using custom components without `reactiveCustomComponents = true` is deprecated.")}var gH=e=>{const{context:t,gos:s}=E.useContext(Ti),[i,r]=E.useState(()=>new xr("ag-header-cell","ag-floating-filter")),[n,o]=E.useState(()=>new xr),[a,l]=E.useState(()=>new xr("ag-floating-filter-button","ag-hidden")),[u,h]=E.useState("false"),[p,g]=E.useState(),[m,C]=E.useState(1),y=E.useRef(null),R=E.useRef(null),x=E.useRef(null),S=E.useRef(null),T=E.useRef(),I=E.useRef(),V=me=>{me!=null&&T.current&&T.current(me)},{ctrl:H}=e,P=E.useCallback(me=>{if(y.current=me,!y.current)return;I.current=new ws(ye=>{T.current=ye});const de={addOrRemoveCssClass:(ye,pe)=>r(q=>q.setClass(ye,pe)),addOrRemoveBodyCssClass:(ye,pe)=>o(q=>q.setClass(ye,pe)),setButtonWrapperDisplayed:ye=>{l(pe=>pe.setClass("ag-hidden",!ye)),h(ye?"false":"true")},setWidth:ye=>{y.current&&(y.current.style.width=ye)},setCompDetails:ye=>g(ye),getFloatingFilterComp:()=>I.current?I.current:null,setMenuIcon:ye=>{var pe;return(pe=S.current)==null?void 0:pe.appendChild(ye)}};H.setComp(de,y.current,S.current,R.current)},[]);E.useLayoutEffect(()=>Rp(p,t,R.current,V),[p]);const N=E.useMemo(()=>i.toString(),[i]),_=E.useMemo(()=>n.toString(),[n]),L=E.useMemo(()=>a.toString(),[a]),M=E.useMemo(()=>!!(p&&p.componentFromFramework&&Fu(p.componentClass)),[p]),b=E.useMemo(()=>s.get("reactiveCustomComponents"),[]),F=E.useMemo(()=>{if(p)if(b){const me=new XB(p.params,()=>C(de=>de+1));return V(me),me}else p.componentFromFramework&&mx()},[p]),Z=F==null?void 0:F.getProps(),K=p&&p.componentFromFramework,ge=p&&p.componentClass;return Fe.createElement("div",{ref:P,className:N,role:"gridcell"},Fe.createElement("div",{ref:R,className:_,role:"presentation"},K&&!b&&Fe.createElement(ge,vi(ns({},p.params),{ref:M?()=>{}:V})),K&&b&&Fe.createElement(hx.Provider,{value:{setMethods:me=>F.setMethods(me)}},Fe.createElement(ge,ns({},Z)))),Fe.createElement("div",{ref:x,"aria-hidden":u,className:L,role:"presentation"},Fe.createElement("button",{ref:S,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},fH=E.memo(gH),mH=e=>{const{ctrl:t}=e,{topOffset:s,rowHeight:i}=E.useMemo(()=>t.getTopAndHeight(),[]),r=t.getAriaRowIndex(),n=t.getHeaderRowClass(),[o,a]=E.useState(()=>i+"px"),[l,u]=E.useState(()=>s+"px"),h=E.useRef(null),p=E.useRef(null),[g,m]=E.useState(()=>t.getHeaderCtrls()),C=E.useRef(null),y=E.useCallback(S=>{if(C.current=S,!S)return;const T={setHeight:I=>a(I),setTop:I=>u(I),setHeaderCtrls:(I,V,H)=>{p.current=h.current,h.current=I;const P=fx(p.current,I,V);P!==p.current&&gx(H,()=>m(P))},setWidth:I=>{C.current&&(C.current.style.width=I)}};t.setComp(T,!1)},[]),R=E.useMemo(()=>({height:o,top:l}),[o,l]),x=E.useCallback(S=>{switch(t.getType()){case nw.COLUMN_GROUP:return Fe.createElement(pH,{ctrl:S,key:S.getInstanceId()});case nw.FLOATING_FILTER:return Fe.createElement(fH,{ctrl:S,key:S.getInstanceId()});default:return Fe.createElement(dH,{ctrl:S,key:S.getInstanceId()})}},[]);return Fe.createElement("div",{ref:y,className:n,role:"row",style:R,"aria-rowindex":r},g.map(x))},vH=E.memo(mH),CH=e=>{const[t,s]=E.useState(!0),[i,r]=E.useState([]),{context:n}=E.useContext(Ti),o=E.useRef(null),a=E.useRef(null),l=E.useRef(null),u=e.pinned==="left",h=e.pinned==="right",p=!u&&!h,g=E.useCallback(y=>{if(o.current=y,!o.current){n.destroyBean(l.current),l.current=null;return}const R={setDisplayed:s,setCtrls:x=>r(x),setCenterWidth:x=>{a.current&&(a.current.style.width=x)},setViewportScrollLeft:x=>{o.current&&(o.current.scrollLeft=x)},setPinnedContainerWidth:x=>{o.current&&(o.current.style.width=x,o.current.style.minWidth=x,o.current.style.maxWidth=x)}};l.current=n.createBean(new pa(e.pinned)),l.current.setComp(R,o.current)},[]),m=t?"":"ag-hidden",C=()=>i.map(y=>Fe.createElement(vH,{ctrl:y,key:y.getInstanceId()}));return Fe.createElement(Fe.Fragment,null,u&&Fe.createElement("div",{ref:g,className:"ag-pinned-left-header "+m,"aria-hidden":!t,role:"rowgroup"},C()),h&&Fe.createElement("div",{ref:g,className:"ag-pinned-right-header "+m,"aria-hidden":!t,role:"rowgroup"},C()),p&&Fe.createElement("div",{ref:g,className:"ag-header-viewport "+m,role:"presentation"},Fe.createElement("div",{ref:a,className:"ag-header-container",role:"rowgroup"},C())))},AC=E.memo(CH),yH=()=>{const[e,t]=E.useState(()=>new xr),[s,i]=E.useState(),{context:r}=E.useContext(Ti),n=E.useRef(null),o=E.useRef(null),a=E.useCallback(h=>{if(n.current=h,!h){r.destroyBean(o.current),o.current=null;return}const p={addOrRemoveCssClass:(g,m)=>t(C=>C.setClass(g,m)),setHeightAndMinHeight:g=>i(g)};o.current=r.createBean(new ga),o.current.setComp(p,n.current,n.current)},[]),l=E.useMemo(()=>"ag-header "+e.toString(),[e]),u=E.useMemo(()=>({height:s,minHeight:s}),[s]);return Fe.createElement("div",{ref:a,className:l,style:u,role:"presentation"},Fe.createElement(AC,{pinned:"left"}),Fe.createElement(AC,{pinned:null}),Fe.createElement(AC,{pinned:"right"}))},wH=E.memo(yH),SH=(e,t)=>{E.useEffect(()=>{const s=t.current;if(s){const i=s.parentElement;if(i){const r=document.createComment(e);return i.insertBefore(r,s),()=>{i.removeChild(r)}}}},[e])},Ba=SH,xH=e=>{const t=E.useRef(e),s=E.useRef(),i=E.useRef(!1),r=E.useRef(!1),[,n]=E.useState(0);i.current&&(r.current=!0),E.useEffect(()=>(i.current||(s.current=t.current(),i.current=!0),n(o=>o+1),()=>{r.current&&s.current&&s.current()}),[])},EH=e=>{const[t,s]=E.useState(),{context:i,popupService:r,localeService:n,gos:o}=E.useContext(Ti);return xH(()=>{const{editDetails:a,cellCtrl:l,eParentCell:u}=e,{compDetails:h}=a,p=o.get("stopEditingWhenCellsLoseFocus"),g=i.createBean(new CI(h.params)),m=g.getGui();if(e.jsChildComp){const T=e.jsChildComp.getGui();T&&m.appendChild(T)}const C={column:l.getColumn(),rowNode:l.getRowNode(),type:"popupCellEditor",eventSource:u,ePopup:m,position:a.popupPosition,keepWithinBounds:!0},y=r.positionPopupByComponent.bind(r,C),R=n.getLocaleTextFunc(),x=r.addPopup({modal:p,eChild:m,closeOnEsc:!0,closedCallback:()=>{l.onPopupEditorClosed()},anchorToElement:u,positionCallback:y,ariaLabel:R("ariaLabelCellEditor","Cell Editor")}),S=x?x.hideFunc:void 0;return s(g),e.jsChildComp&&e.jsChildComp.afterGuiAttached&&e.jsChildComp.afterGuiAttached(),()=>{S!=null&&S(),i.destroyBean(g)}}),Fe.createElement(Fe.Fragment,null,t&&e.wrappedContent&&Dm.createPortal(e.wrappedContent,t.getGui()))},NR=E.memo(EH),bH=(e,t,s,i,r,n)=>{const{context:o}=E.useContext(Ti),a=E.useCallback(()=>{const l=r.current;if(!l)return;const u=l.getGui();u&&u.parentElement&&u.parentElement.removeChild(u),o.destroyBean(l),r.current=void 0},[]);E.useEffect(()=>{const l=e!=null,u=e&&e.compDetails&&!e.compDetails.componentFromFramework,h=t&&s==null;if(!(l&&u&&!h)){a();return}const g=e.compDetails;if(r.current){const x=r.current,T=x.refresh!=null&&e.force==!1?x.refresh(g.params):!1;if(T===!0||T===void 0)return;a()}const m=g.newAgStackInstance();if(!m)return;const C=m.resolveNow(null,x=>x);if(!C)return;const y=C.getGui();if(!y)return;(t?s:n.current).appendChild(y),r.current=C},[e,t,i]),E.useEffect(()=>a,[])},RH=bH,TH=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new ws(s=>{this.resolveInstanceCreated=s}),this.onValueChange=s=>this.updateValue(s),this.value=e.value}getProps(){return vi(ns({},this.cellEditorParams),{initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange})}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){px(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){var t;this.componentInstance=e,(t=this.resolveInstanceCreated)==null||t.call(this),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]}updateValue(e){this.value=e,this.refreshProps()}},DH=(e,t,s)=>{const i=s.getColumn();if(!e&&t.isPopup&&t.isPopup()){const r=`AG Grid: Found an issue in column ${i.getColId()}. If using React, specify an editor is a popup using colDef.cellEditorPopup=true. AG Grid React cannot depend on the editor component specifying if it's in a popup (via the isPopup() method on the editor), as React needs to know this information BEFORE the component is created.`;rt.doOnce(()=>console.warn(r),"jsEditorComp-isPopup-"+s.getColumn().getColId())}if(e&&t.getPopupPosition&&t.getPopupPosition()!=null){const r=`AG Grid: Found an issue in column ${i.getColId()}. If using React, specify an editor popup position using colDef.cellEditorPopupPosition=true. AG Grid React cannot depend on the editor component specifying it's position (via the getPopupPosition() method on the editor), as React needs to know this information BEFORE the component is created.`;rt.doOnce(()=>console.warn(r),"jsEditorComp-getPopupPosition-"+s.getColumn().getColId())}},PH=(e,t,s)=>{const{compProxy:i}=e;s(i);const r=i.getProps(),n=Fu(t);return Fe.createElement(hx.Provider,{value:{setMethods:o=>i.setMethods(o)}},n&&Fe.createElement(t,ns({},r)),!n&&Fe.createElement(t,vi(ns({},r),{ref:o=>i.setRef(o)})))},_R=(e,t,s)=>{const i=e.compProxy;return Fe.createElement(Fe.Fragment,null,!i&&Fe.createElement(t,vi(ns({},e.compDetails.params),{ref:s})),i&&PH(e,t,s))},AH=(e,t,s,i,r,n)=>{const o=e.compDetails,a=o.componentClass,l=o.componentFromFramework&&!e.popup,u=o.componentFromFramework&&e.popup,h=!o.componentFromFramework&&e.popup;return Fe.createElement(Fe.Fragment,null,l&&_R(e,a,t),u&&Fe.createElement(NR,{editDetails:e,cellCtrl:r,eParentCell:i,wrappedContent:_R(e,a,s)}),h&&n&&Fe.createElement(NR,{editDetails:e,cellCtrl:r,eParentCell:i,jsChildComp:n}))},FH=(e,t,s,i,r,n,o)=>{const{compDetails:a,value:l}=e,u=!a,h=a&&a.componentFromFramework,p=a&&a.componentClass,g=l!=null&&l.toString?l.toString():l,m=()=>Fe.createElement(Fe.Fragment,null,u&&Fe.createElement(Fe.Fragment,null,g),h&&!n&&Fe.createElement(p,vi(ns({},a.params),{key:t,ref:i})),h&&n&&Fe.createElement(p,vi(ns({},a.params),{key:t})));return Fe.createElement(Fe.Fragment,null,r?Fe.createElement("span",{role:"presentation",id:`cell-${s}`,className:"ag-cell-value",ref:o},m()):m())},IH=e=>{const{context:t}=E.useContext(Ti),{cellCtrl:s,printLayout:i,editingRow:r}=e,n=s.getTabIndex(),o=s.getColumnIdSanitised(),a=s.getInstanceId(),[l,u]=E.useState(()=>s.isCellRenderer()?void 0:{compDetails:void 0,value:s.getValueToDisplay(),force:!1}),[h,p]=E.useState(),[g,m]=E.useState(1),[C,y]=E.useState(),[R,x]=E.useState(!1),[S,T]=E.useState(!1),[I,V]=E.useState(!1),[H,P]=E.useState(),N=E.useMemo(()=>s.isForceWrapper(),[s]),_=E.useMemo(()=>s.getCellAriaRole(),[s]),L=E.useRef(null),M=E.useRef(null),b=E.useRef(),F=E.useRef(),Z=E.useRef(),K=E.useRef([]),ge=E.useRef(),[me,de]=E.useState(0),ye=E.useCallback(Y=>{ge.current=Y,de(te=>te+1)},[]),pe=l!=null&&(R||I||S),q=N||pe,ve=E.useCallback((Y,te)=>{F.current=te,te&&(DH(Y,te,s),te.isCancelBeforeStart&&te.isCancelBeforeStart()&&setTimeout(()=>{s.stopEditing(!0),s.focusCell(!0)}))},[s]),$=E.useCallback(Y=>ve(!0,Y),[ve]),be=E.useCallback(Y=>ve(!1,Y),[ve]);let se=E.useRef();se.current||(se.current=new dp(()=>L.current)),RH(l,q,ge.current,me,b,L);const Ge=E.useRef();E.useLayoutEffect(()=>{const Y=Ge.current,te=l;if(Ge.current=l,Y==null||Y.compDetails==null||te==null||te.compDetails==null)return;const he=Y.compDetails,Ae=te.compDetails;if(he.componentClass!=Ae.componentClass||M.current==null||M.current.refresh==null)return;M.current.refresh(Ae.params)!=!0&&m(k=>k+1)},[l]),E.useLayoutEffect(()=>{if(!(h&&!h.compDetails.componentFromFramework))return;const te=h.compDetails,he=h.popup===!0,Ae=cH(te);if(!Ae)return;const fe=Ae.getGui();if(ve(he,Ae),!he){const k=(N?Z:L).current;k==null||k.appendChild(fe),Ae.afterGuiAttached&&Ae.afterGuiAttached()}return P(Ae),()=>{t.destroyBean(Ae),ve(he,void 0),P(void 0),fe&&fe.parentElement&&fe.parentElement.removeChild(fe)}},[h]);const Re=E.useCallback(Y=>{if(Z.current=Y,!Z.current){K.current.forEach(he=>he()),K.current=[];return}const te=he=>{var Ae;if(he){const fe=he.getGui();(Ae=Z.current)==null||Ae.insertAdjacentElement("afterbegin",fe),K.current.push(()=>{t.destroyBean(he),rt.removeFromParent(fe)})}return he};if(R){const he=s.createSelectionCheckbox();te(he)}I&&te(s.createDndSource()),S&&te(s.createRowDragComp())},[s,t,I,S,R]),U=E.useCallback(Y=>{if(L.current=Y,!L.current||!s)return;const te={addOrRemoveCssClass:(Ae,fe)=>se.current.addOrRemoveCssClass(Ae,fe),setUserStyles:Ae=>y(Ae),getFocusableElement:()=>L.current,setIncludeSelection:Ae=>x(Ae),setIncludeRowDrag:Ae=>T(Ae),setIncludeDndSource:Ae=>V(Ae),getCellEditor:()=>F.current||null,getCellRenderer:()=>M.current?M.current:b.current,getParentOfValue:()=>ge.current?ge.current:Z.current?Z.current:L.current,setRenderDetails:(Ae,fe,k)=>{u(O=>(O==null?void 0:O.compDetails)!==Ae||(O==null?void 0:O.value)!==fe||(O==null?void 0:O.force)!==k?{value:fe,compDetails:Ae,force:k}:O)},setEditDetails:(Ae,fe,k,O)=>{if(Ae){let W;O?W=new TH(Ae.params,()=>m(le=>le+1)):Ae.componentFromFramework&&mx(),p({compDetails:Ae,popup:fe,popupPosition:k,compProxy:W}),fe||u(void 0)}else p(W=>{W!=null&&W.compProxy&&(F.current=void 0)})}},he=Z.current||void 0;s.setComp(te,L.current,he,i,r)},[]),J=E.useMemo(()=>!!(l&&l.compDetails&&l.compDetails.componentFromFramework&&Fu(l.compDetails.componentClass)),[l]);E.useLayoutEffect(()=>{var Y;L.current&&(se.current.addOrRemoveCssClass("ag-cell-value",!q),se.current.addOrRemoveCssClass("ag-cell-inline-editing",!!h&&!h.popup),se.current.addOrRemoveCssClass("ag-cell-popup-editing",!!h&&!!h.popup),se.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!h||!!h.popup),(Y=s.getRowCtrl())==null||Y.setInlineEditingCss(!!h),s.shouldRestoreFocus()&&!s.isEditing()&&L.current.focus({preventScroll:!0}))});const ce=()=>Fe.createElement(Fe.Fragment,null,l!=null&&FH(l,g,a,M,q,J,ye),h!=null&&AH(h,be,$,L.current,s,H));return Fe.createElement("div",{ref:U,style:C,tabIndex:n,role:_,"col-id":o},q?Fe.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:Re},ce()):ce())},NH=E.memo(IH),_H=e=>{const{context:t,gos:s}=E.useContext(Ti),{rowCtrl:i,containerType:r}=e,n=i.getTabIndex(),o=E.useRef(i.getDomOrder()),a=i.isFullWidth(),l=i.getRowNode().displayed,[u,h]=E.useState(()=>l?i.getRowIndex():null),[p,g]=E.useState(()=>i.getRowId()),[m,C]=E.useState(()=>i.getBusinessKey()),[y,R]=E.useState(()=>i.getRowStyles()),x=E.useRef(null),S=E.useRef(null),[T,I]=E.useState(()=>null),[V,H]=E.useState(),[P,N]=E.useState(()=>l?i.getInitialRowTop(r):void 0),[_,L]=E.useState(()=>l?i.getInitialTransform(r):void 0),M=E.useRef(null),b=E.useRef(),F=E.useRef(!1),[Z,K]=E.useState(0);E.useEffect(()=>{var se;if(F.current||!V||Z>10)return;const Ge=(se=M.current)==null?void 0:se.firstChild;Ge?(i.setupDetailRowAutoHeight(Ge),F.current=!0):K(Re=>Re+1)},[V,Z]);let ge=E.useRef();ge.current||(ge.current=new dp(()=>M.current));const me=E.useCallback(se=>{if(M.current=se,!M.current){i.unsetComp(r);return}if(!i.isAlive())return;const Ge={setTop:N,setTransform:L,addOrRemoveCssClass:(Re,U)=>ge.current.addOrRemoveCssClass(Re,U),setDomOrder:Re=>o.current=Re,setRowIndex:h,setRowId:g,setRowBusinessKey:C,setUserStyles:R,setCellCtrls:(Re,U)=>{S.current=x.current,x.current=Re;const J=fx(S.current,Re,o.current);J!==S.current&&gx(U,()=>I(J))},showFullWidth:Re=>H(Re),getFullWidthCellRenderer:()=>b.current,refreshFullWidth:Re=>ve.current?(H(U=>vi(ns({},U),{params:Re()})),!0):!b.current||!b.current.refresh?!1:b.current.refresh(Re())};i.setComp(Ge,M.current,r)},[]);E.useLayoutEffect(()=>Rp(V,t,M.current,b),[V]);const de=E.useMemo(()=>{const se={top:P,transform:_};return Object.assign(se,y),se},[P,_,y]),ye=a&&V&&V.componentFromFramework,pe=!a&&T!=null,q=E.useMemo(()=>!!((V==null?void 0:V.componentFromFramework)&&Fu(V.componentClass)),[V]),ve=E.useRef(!1);E.useEffect(()=>{ve.current=q&&!!V&&!!s.get("reactiveCustomComponents")},[q,V]);const $=()=>T==null?void 0:T.map(se=>Fe.createElement(NH,{cellCtrl:se,editingRow:i.isEditing(),printLayout:i.isPrintLayout(),key:se.getInstanceId()})),be=()=>{const se=V.componentClass;return Fe.createElement(Fe.Fragment,null,q&&Fe.createElement(se,ns({},V.params)),!q&&Fe.createElement(se,vi(ns({},V.params),{ref:b})))};return Fe.createElement("div",{ref:me,role:"row",style:de,"row-index":u,"row-id":p,"row-business-key":m,tabIndex:n},pe&&$(),ye&&be())},kH=E.memo(_H),MH=e=>{const{context:t}=E.useContext(Ti),{name:s}=e,i=E.useMemo(()=>fI(s),[s]),r=E.useRef(null),n=E.useRef(null),o=E.useRef([]),a=E.useRef([]),[l,u]=E.useState(()=>[]),h=E.useRef(!1),p=E.useRef(),g=E.useMemo(()=>Pf.getRowContainerCssClasses(s),[s]),m=E.useMemo(()=>$r(g.viewport),[g]),C=E.useMemo(()=>$r(g.container),[g]),y=s===Kt.CENTER||s===Kt.TOP_CENTER||s===Kt.BOTTOM_CENTER||s===Kt.STICKY_TOP_CENTER||s===Kt.STICKY_BOTTOM_CENTER,R=y?r:n;Ba(" AG Row Container "+s+" ",R);const x=E.useCallback(()=>y?r.current!=null&&n.current!=null:n.current!=null,[]),S=E.useCallback(()=>y?r.current==null&&n.current==null:n.current==null,[]),T=E.useCallback(()=>{if(S()&&(t.destroyBean(p.current),p.current=null),x()){const P=_=>{const L=fx(a.current,o.current,h.current);L!==a.current&&(a.current=L,gx(_,()=>u(L)))},N={setViewportHeight:_=>{r.current&&(r.current.style.height=_)},setRowCtrls:({rowCtrls:_,useFlushSync:L})=>{const M=!!L&&o.current.length>0&&_.length>0;o.current=_,P(M)},setDomOrder:_=>{h.current!=_&&(h.current=_,P(!1))},setContainerWidth:_=>{n.current&&(n.current.style.width=_)}};p.current=t.createBean(new Pf(s)),p.current.setComp(N,n.current,r.current)}},[x,S]),I=E.useCallback(P=>{n.current=P,T()},[T]),V=E.useCallback(P=>{r.current=P,T()},[T]),H=()=>Fe.createElement("div",{className:C,ref:I,role:"rowgroup"},l.map(P=>Fe.createElement(kH,{rowCtrl:P,containerType:i,key:P.getInstanceId()})));return Fe.createElement(Fe.Fragment,null,y?Fe.createElement("div",{className:m,ref:V,role:"presentation"},H()):H())},LH=E.memo(MH),OH=()=>{const{context:e,agStackComponentsRegistry:t,resizeObserverService:s}=E.useContext(Ti),[i,r]=E.useState(""),[n,o]=E.useState(0),[a,l]=E.useState(0),[u,h]=E.useState("0px"),[p,g]=E.useState("0px"),[m,C]=E.useState("100%"),[y,R]=E.useState("0px"),[x,S]=E.useState("0px"),[T,I]=E.useState("100%"),[V,H]=E.useState(""),[P,N]=E.useState(""),[_,L]=E.useState(null),[M,b]=E.useState(""),[F,Z]=E.useState(null),[K,ge]=E.useState("ag-layout-normal");let me=E.useRef();me.current||(me.current=new dp(()=>de.current));const de=E.useRef(null),ye=E.useRef(null),pe=E.useRef(null),q=E.useRef(null),ve=E.useRef(null),$=E.useRef(null),be=E.useRef(null),se=E.useRef([]),Ge=E.useRef([]);Ba(" AG Grid Body ",de),Ba(" AG Pinned Top ",ye),Ba(" AG Sticky Top ",pe),Ba(" AG Middle ",$),Ba(" AG Pinned Bottom ",be);const Re=E.useCallback(X=>{if(de.current=X,!de.current){e.destroyBeans(se.current),Ge.current.forEach(Ne=>Ne()),se.current=[],Ge.current=[];return}if(!e)return;const Q=Ne=>{const Pe=t.getComponentClass(Ne),We=e.createBean(new Pe);return se.current.push(We),We},re=(Ne,Pe)=>{Ne.appendChild(Pe),Ge.current.push(()=>Ne.removeChild(Pe))};re(de.current,document.createComment(" AG Fake Horizontal Scroll ")),re(de.current,Q("AG-FAKE-HORIZONTAL-SCROLL").getGui()),re(de.current,document.createComment(" AG Overlay Wrapper ")),re(de.current,Q("AG-OVERLAY-WRAPPER").getGui()),ve.current&&(re(ve.current,document.createComment(" AG Fake Vertical Scroll ")),re(ve.current,Q("AG-FAKE-VERTICAL-SCROLL").getGui()));const Se={setRowAnimationCssOnBodyViewport:r,setColumnCount:Ne=>{de.current&&rt.setAriaColCount(de.current,Ne)},setRowCount:Ne=>{de.current&&rt.setAriaRowCount(de.current,Ne)},setTopHeight:o,setBottomHeight:l,setStickyTopHeight:h,setStickyTopTop:g,setStickyTopWidth:C,setTopDisplay:H,setBottomDisplay:N,setColumnMovingCss:(Ne,Pe)=>me.current.addOrRemoveCssClass(Ne,Pe),updateLayoutClasses:ge,setAlwaysVerticalScrollClass:L,setPinnedTopBottomOverflowY:b,setCellSelectableCss:(Ne,Pe)=>Z(Pe?Ne:null),setBodyViewportWidth:Ne=>{$.current&&($.current.style.width=Ne)},registerBodyViewportResizeListener:Ne=>{if($.current){const Pe=s.observeResize($.current,Ne);Ge.current.push(()=>Pe())}},setStickyBottomHeight:R,setStickyBottomBottom:S,setStickyBottomWidth:I},Me=e.createBean(new ri);se.current.push(Me),Me.setComp(Se,de.current,$.current,ye.current,be.current,pe.current,q.current)},[]),U=E.useMemo(()=>$r("ag-root","ag-unselectable",K),[K]),J=E.useMemo(()=>$r("ag-body-viewport",i,K,_,F),[i,K,_,F]),ce=E.useMemo(()=>$r("ag-body",K),[K]),Y=E.useMemo(()=>$r("ag-floating-top",F),[F]),te=E.useMemo(()=>$r("ag-sticky-top",F),[F]),he=E.useMemo(()=>$r("ag-sticky-bottom",F),[F]),Ae=E.useMemo(()=>$r("ag-floating-bottom",F),[F]),fe=E.useMemo(()=>({height:n,minHeight:n,display:V,overflowY:M}),[n,V,M]),k=E.useMemo(()=>({height:u,top:p,width:m}),[u,p,m]),O=E.useMemo(()=>({height:y,bottom:x,width:T}),[y,x,T]),W=E.useMemo(()=>({height:a,minHeight:a,display:P,overflowY:M}),[a,P,M]),le=X=>Fe.createElement(LH,{name:X,key:`${X}-container`}),ne=({section:X,children:Q,className:re,style:Se})=>Fe.createElement("div",{ref:X,className:re,role:"presentation",style:Se},Q.map(le));return Fe.createElement("div",{ref:Re,className:U,role:"treegrid"},Fe.createElement(wH,null),ne({section:ye,className:Y,style:fe,children:[Kt.TOP_LEFT,Kt.TOP_CENTER,Kt.TOP_RIGHT,Kt.TOP_FULL_WIDTH]}),Fe.createElement("div",{className:ce,ref:ve,role:"presentation"},ne({section:$,className:J,children:[Kt.LEFT,Kt.CENTER,Kt.RIGHT,Kt.FULL_WIDTH]})),ne({section:pe,className:te,style:k,children:[Kt.STICKY_TOP_LEFT,Kt.STICKY_TOP_CENTER,Kt.STICKY_TOP_RIGHT,Kt.STICKY_TOP_FULL_WIDTH]}),ne({section:q,className:he,style:O,children:[Kt.STICKY_BOTTOM_LEFT,Kt.STICKY_BOTTOM_CENTER,Kt.STICKY_BOTTOM_RIGHT,Kt.STICKY_BOTTOM_FULL_WIDTH]}),ne({section:be,className:Ae,style:W,children:[Kt.BOTTOM_LEFT,Kt.BOTTOM_CENTER,Kt.BOTTOM_RIGHT,Kt.BOTTOM_FULL_WIDTH]}))},GH=E.memo(OH),VH=(e,t)=>{const{children:s,eFocusableElement:i,onTabKeyDown:r,gridCtrl:n,forceFocusOutWhenTabGuardsAreEmpty:o}=e,{context:a}=E.useContext(Ti),l=E.useRef(null),u=E.useRef(null),h=E.useRef(),p=R=>{const x=R==null?void 0:parseInt(R,10).toString();[l,u].forEach(S=>{var T,I;x===void 0?(T=S.current)==null||T.removeAttribute("tabindex"):(I=S.current)==null||I.setAttribute("tabindex",x)})};E.useImperativeHandle(t,()=>({forceFocusOutOfContainer(R){var x;(x=h.current)==null||x.forceFocusOutOfContainer(R)}}));const g=E.useCallback(()=>{if(!l.current&&!u.current){a.destroyBean(h.current),h.current=null;return}if(l.current&&u.current){const R={setTabIndex:p};h.current=a.createBean(new nv({comp:R,eTopGuard:l.current,eBottomGuard:u.current,eFocusableElement:i,onTabKeyDown:r,forceFocusOutWhenTabGuardsAreEmpty:o,focusInnerElement:x=>n.focusInnerElement(x)}))}},[]),m=E.useCallback(R=>{l.current=R,g()},[g]),C=E.useCallback(R=>{u.current=R,g()},[g]),y=R=>{const x=R==="top"?Fg.TAB_GUARD_TOP:Fg.TAB_GUARD_BOTTOM;return Fe.createElement("div",{className:`${Fg.TAB_GUARD} ${x}`,role:"presentation",ref:R==="top"?m:C})};return Fe.createElement(Fe.Fragment,null,y("top"),s,y("bottom"))},BH=E.forwardRef(VH),HH=E.memo(BH),jH=({context:e})=>{const[t,s]=E.useState(""),[i,r]=E.useState(""),[n,o]=E.useState(""),[a,l]=E.useState(null),[u,h]=E.useState(null),[p,g]=E.useState(!1),[m,C]=E.useState(),y=E.useRef(null),R=E.useRef(null),x=E.useRef(),[S,T]=E.useState(null),I=E.useRef(()=>{}),V=E.useCallback(()=>{},[]),H=E.useMemo(()=>e.isDestroyed()?null:e.getBean("beans"),[e]);Ba(" AG Grid ",R);const P=E.useCallback(b=>{if(R.current=b,!R.current){e.destroyBean(y.current),y.current=null;return}if(e.isDestroyed())return;y.current=e.createBean(new Ca);const F=y.current;I.current=F.focusInnerElement.bind(F);const Z={destroyGridUi:()=>{},setRtlClass:s,forceFocusOutOfContainer:K=>{var ge;(ge=x.current)==null||ge.forceFocusOutOfContainer(K)},updateLayoutClasses:o,getFocusableContainers:()=>{var K,ge;const me=[],de=(K=R.current)==null?void 0:K.querySelector(".ag-root"),ye=(ge=R.current)==null?void 0:ge.querySelector(".ag-side-bar:not(.ag-hidden)");return de&&me.push(de),ye&&me.push(ye),me},setCursor:l,setUserSelect:h};F.setComp(Z,R.current,R.current),g(!0)},[]);E.useEffect(()=>{if(!m||!H||!y.current||!S||!R.current)return;const b=y.current,F=[],{agStackComponentsRegistry:Z}=H,K=Z.getComponentClass("AG-GRID-HEADER-DROP-ZONES"),ge=Z.getComponentClass("AG-SIDE-BAR"),me=Z.getComponentClass("AG-STATUS-BAR"),de=Z.getComponentClass("AG-WATERMARK"),ye=Z.getComponentClass("AG-PAGINATION"),pe=[],q=R.current;if(b.showDropZones()&&K){const ve=e.createBean(new K),$=ve.getGui();q.insertAdjacentElement("afterbegin",$),pe.push($),F.push(ve)}if(b.showSideBar()&&ge){const ve=e.createBean(new ge),$=ve.getGui(),be=S.querySelector(".ag-tab-guard-bottom");be&&(be.insertAdjacentElement("beforebegin",$),pe.push($)),F.push(ve)}if(b.showStatusBar()&&me){const ve=e.createBean(new me),$=ve.getGui();q.insertAdjacentElement("beforeend",$),pe.push($),F.push(ve)}if(ye){const ve=e.createBean(new ye),$=ve.getGui();q.insertAdjacentElement("beforeend",$),pe.push($),F.push(ve)}if(b.showWatermark()&&de){const ve=e.createBean(new de),$=ve.getGui();q.insertAdjacentElement("beforeend",$),pe.push($),F.push(ve)}return()=>{e.destroyBeans(F),pe.forEach(ve=>{ve.parentElement&&ve.parentElement.removeChild(ve)})}},[m,S,H]);const N=E.useMemo(()=>$r("ag-root-wrapper",t,i,n),[t,i,n]),_=E.useMemo(()=>$r("ag-root-wrapper-body","ag-focus-managed",n),[n]),L=E.useMemo(()=>({userSelect:u??"",WebkitUserSelect:u??"",cursor:a??""}),[u,a]),M=E.useCallback(b=>{x.current=b,C(b!==null)},[]);return Fe.createElement("div",{ref:P,className:N,style:L,role:"presentation"},Fe.createElement("div",{className:_,ref:T,role:"presentation"},p&&S&&H&&Fe.createElement(Ti.Provider,{value:H},Fe.createElement(HH,{ref:M,eFocusableElement:S,onTabKeyDown:V,gridCtrl:y.current,forceFocusOutWhenTabGuardsAreEmpty:!0},Fe.createElement(GH,null)))))},WH=E.memo(jH),BN=e=>{var t,s;const i=E.useRef(),r=E.useRef(null),n=E.useRef(null),o=E.useRef([]),a=E.useRef([]),l=E.useRef(e),u=E.useRef(!1),[h,p]=E.useState(void 0),[,g]=E.useState(0),m=E.useCallback(R=>{if(r.current=R,!r.current){o.current.forEach(P=>P()),o.current.length=0;return}const x=e.modules||[];n.current||(n.current=new oH(()=>g(P=>P+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),o.current.push(()=>{var P;(P=n.current)==null||P.destroy(),n.current=null}));const S=Ef.combineAttributesAndGridOptions(e.gridOptions,e),T={providedBeanInstances:{frameworkComponentWrapper:new UH(n.current,!!S.reactiveCustomComponents)},modules:x,frameworkOverrides:new KH},I=P=>{p(P),o.current.push(()=>{P.destroy()}),P.getBean(cl.NAME).whenReady(()=>{if(P.isDestroyed())return;const _=i.current;_&&e.setGridApi&&e.setGridApi(_,new Zc(_))})},V=P=>{P.getBean(cl.NAME).whenReady(()=>{a.current.forEach(_=>_()),a.current.length=0,u.current=!0})},H=new f2;i.current=H.create(r.current,S,I,V,T)},[]),C=E.useMemo(()=>ns({height:"100%"},e.containerStyle||{}),[e.containerStyle]),y=E.useCallback(R=>{u.current?R():a.current.push(R)},[]);return E.useEffect(()=>{const R=zH(l.current,e);l.current=e,y(()=>{i.current&&Ef.processOnChange(R,i.current)})},[e]),Fe.createElement("div",{style:C,className:e.className,ref:m},h&&!h.isDestroyed()?Fe.createElement(WH,{context:h}):null,(s=(t=n.current)==null?void 0:t.getPortals())!=null?s:null)};function zH(e,t){const s={};return Object.keys(t).forEach(i=>{const r=t[i];e[i]!==r&&(s[i]=r)}),s}var UH=class extends m2{constructor(e,t){super(),this.parent=e,this.reactiveCustomComponents=t}createWrapper(e,t){if(this.reactiveCustomComponents){const r=(n=>{switch(n){case"filter":return JB;case"floatingFilterComponent":return eH;case"dateComponent":return ZB;case"loadingOverlayComponent":return tH;case"noRowsOverlayComponent":return iH;case"statusPanel":return rH;case"toolPanel":return nH;case"menuItem":return sH}})(t.propertyName);if(r)return new r(e,this.parent,t)}else switch(t.propertyName){case"filter":case"floatingFilterComponent":case"dateComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":mx();break}const s=!t.cellRenderer&&t.propertyName!=="toolPanel";return new kN(e,this.parent,t,s)}},$H=E.forwardRef((e,t)=>{const{ctrlsFactory:s,context:i,gos:r,resizeObserverService:n,clientSideRowModel:o,serverSideRowModel:a}=E.useContext(Ti),[l,u]=E.useState(()=>new xr),[h,p]=E.useState(()=>new xr),[g,m]=E.useState(),[C,y]=E.useState(),R=E.useRef(),x=E.useRef(null),S=E.useRef(),T=E.useMemo(()=>Nt.__getGridRegisteredModules(e.api.getGridId()),[e]),I=E.useMemo(()=>l.toString()+" ag-details-row",[l]),V=E.useMemo(()=>h.toString()+" ag-details-grid",[h]);t&&E.useImperativeHandle(t,()=>({refresh(){var N,_;return(_=(N=R.current)==null?void 0:N.refresh())!=null?_:!1}})),e.template&&rt.warnOnce("detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://ag-grid.com/react-data-grid/master-detail-custom-detail/");const H=E.useCallback(N=>{if(x.current=N,!x.current){i.destroyBean(R.current),S.current&&S.current();return}const _={addOrRemoveCssClass:(M,b)=>u(F=>F.setClass(M,b)),addOrRemoveDetailGridCssClass:(M,b)=>p(F=>F.setClass(M,b)),setDetailGrid:M=>m(M),setRowData:M=>y(M),getGui:()=>x.current},L=s.getInstance("detailCellRenderer");if(L&&(i.createBean(L),L.init(_,e),R.current=L,r.get("detailRowAutoHeight"))){const M=()=>{if(x.current==null)return;const b=x.current.clientHeight;b!=null&&b>0&&setTimeout(()=>{e.node.setRowHeight(b),o?o.onRowHeightChanged():a&&a.onRowHeightChanged()},0)};S.current=n.observeResize(x.current,M),M()}},[]),P=E.useCallback((N,_)=>{var L;(L=R.current)==null||L.registerDetailWithMaster(N,_)},[]);return Fe.createElement("div",{className:I,ref:H},g&&Fe.createElement(BN,vi(ns({className:V},g),{modules:T,rowData:C,setGridApi:P})))}),KH=class extends II{constructor(){super("react"),this.frameworkComponents={agGroupCellRenderer:IR,agGroupRowRenderer:IR,agDetailCellRenderer:$H},this.wrapIncoming=(e,t)=>t==="ensureVisible"?lH(e):e(),this.renderingEngine="react"}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}},YH=class extends E.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=(e,t)=>{this.api=e,this.columnApi=t,this.apiListeners.forEach(s=>s(e))}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return Fe.createElement(BN,vi(ns({},this.props),{setGridApi:this.setGridApi}))}};const qH={},kR=e=>{let t;const s=new Set,i=(h,p)=>{const g=typeof h=="function"?h(t):h;if(!Object.is(g,t)){const m=t;t=p??(typeof g!="object"||g===null)?g:Object.assign({},t,g),s.forEach(C=>C(t,m))}},r=()=>t,l={setState:i,getState:r,getInitialState:()=>u,subscribe:h=>(s.add(h),()=>s.delete(h)),destroy:()=>{(qH?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},u=t=e(i,r,l);return l},QH=e=>e?kR(e):kR;var HN={exports:{}},jN={},WN={exports:{}},zN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nu=E;function ZH(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var JH=typeof Object.is=="function"?Object.is:ZH,XH=nu.useState,ej=nu.useEffect,tj=nu.useLayoutEffect,sj=nu.useDebugValue;function ij(e,t){var s=t(),i=XH({inst:{value:s,getSnapshot:t}}),r=i[0].inst,n=i[1];return tj(function(){r.value=s,r.getSnapshot=t,FC(r)&&n({inst:r})},[e,s,t]),ej(function(){return FC(r)&&n({inst:r}),e(function(){FC(r)&&n({inst:r})})},[e]),sj(s),s}function FC(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!JH(e,s)}catch{return!0}}function rj(e,t){return t()}var nj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?rj:ij;zN.useSyncExternalStore=nu.useSyncExternalStore!==void 0?nu.useSyncExternalStore:nj;WN.exports=zN;var oj=WN.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mv=E,aj=oj;function lj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cj=typeof Object.is=="function"?Object.is:lj,uj=aj.useSyncExternalStore,dj=mv.useRef,hj=mv.useEffect,pj=mv.useMemo,gj=mv.useDebugValue;jN.useSyncExternalStoreWithSelector=function(e,t,s,i,r){var n=dj(null);if(n.current===null){var o={hasValue:!1,value:null};n.current=o}else o=n.current;n=pj(function(){function l(m){if(!u){if(u=!0,h=m,m=i(m),r!==void 0&&o.hasValue){var C=o.value;if(r(C,m))return p=C}return p=m}if(C=p,cj(h,m))return C;var y=i(m);return r!==void 0&&r(C,y)?(h=m,C):(h=m,p=y)}var u=!1,h,p,g=s===void 0?null:s;return[function(){return l(t())},g===null?void 0:function(){return l(g())}]},[t,s,i,r]);var a=uj(e,n[0],n[1]);return hj(function(){o.hasValue=!0,o.value=a},[a]),gj(a),a};HN.exports=jN;var fj=HN.exports;const mj=um(fj),UN={},{useDebugValue:vj}=Fe,{useSyncExternalStoreWithSelector:Cj}=mj;let MR=!1;const yj=e=>e;function wj(e,t=yj,s){(UN?"production":void 0)!=="production"&&s&&!MR&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),MR=!0);const i=Cj(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return vj(i),i}const Sj=e=>{(UN?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?QH(e):e,s=(i,r)=>wj(t,i,r);return Object.assign(s,t),s},xj=e=>Sj,Ej={};function bj(e,t){let s;try{s=e()}catch{return}return{getItem:r=>{var n;const o=l=>l===null?null:JSON.parse(l,void 0),a=(n=s.getItem(r))!=null?n:null;return a instanceof Promise?a.then(o):o(a)},setItem:(r,n)=>s.setItem(r,JSON.stringify(n,void 0)),removeItem:r=>s.removeItem(r)}}const _h=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then(i){return _h(i)(s)},catch(i){return this}}}catch(s){return{then(i){return this},catch(i){return _h(i)(s)}}}},Rj=(e,t)=>(s,i,r)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:R=>R,version:0,merge:(R,x)=>({...x,...R}),...t},o=!1;const a=new Set,l=new Set;let u;try{u=n.getStorage()}catch{}if(!u)return e((...R)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),s(...R)},i,r);const h=_h(n.serialize),p=()=>{const R=n.partialize({...i()});let x;const S=h({state:R,version:n.version}).then(T=>u.setItem(n.name,T)).catch(T=>{x=T});if(x)throw x;return S},g=r.setState;r.setState=(R,x)=>{g(R,x),p()};const m=e((...R)=>{s(...R),p()},i,r);let C;const y=()=>{var R;if(!u)return;o=!1,a.forEach(S=>S(i()));const x=((R=n.onRehydrateStorage)==null?void 0:R.call(n,i()))||void 0;return _h(u.getItem.bind(u))(n.name).then(S=>{if(S)return n.deserialize(S)}).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==n.version){if(n.migrate)return n.migrate(S.state,S.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return S.state}).then(S=>{var T;return C=n.merge(S,(T=i())!=null?T:m),s(C,!0),p()}).then(()=>{x==null||x(C,void 0),o=!0,l.forEach(S=>S(C))}).catch(S=>{x==null||x(void 0,S)})};return r.persist={setOptions:R=>{n={...n,...R},R.getStorage&&(u=R.getStorage())},clearStorage:()=>{u==null||u.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:R=>(a.add(R),()=>{a.delete(R)}),onFinishHydration:R=>(l.add(R),()=>{l.delete(R)})},y(),C||m},Tj=(e,t)=>(s,i,r)=>{let n={storage:bj(()=>localStorage),partialize:y=>y,version:0,merge:(y,R)=>({...R,...y}),...t},o=!1;const a=new Set,l=new Set;let u=n.storage;if(!u)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),s(...y)},i,r);const h=()=>{const y=n.partialize({...i()});return u.setItem(n.name,{state:y,version:n.version})},p=r.setState;r.setState=(y,R)=>{p(y,R),h()};const g=e((...y)=>{s(...y),h()},i,r);r.getInitialState=()=>g;let m;const C=()=>{var y,R;if(!u)return;o=!1,a.forEach(S=>{var T;return S((T=i())!=null?T:g)});const x=((R=n.onRehydrateStorage)==null?void 0:R.call(n,(y=i())!=null?y:g))||void 0;return _h(u.getItem.bind(u))(n.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==n.version){if(n.migrate)return[!0,n.migrate(S.state,S.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var T;const[I,V]=S;if(m=n.merge(V,(T=i())!=null?T:g),s(m,!0),I)return h()}).then(()=>{x==null||x(m,void 0),m=i(),o=!0,l.forEach(S=>S(m))}).catch(S=>{x==null||x(void 0,S)})};return r.persist={setOptions:y=>{n={...n,...y},y.storage&&(u=y.storage)},clearStorage:()=>{u==null||u.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>C(),hasHydrated:()=>o,onHydrate:y=>(a.add(y),()=>{a.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},n.skipHydration||C(),m||g},Dj=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Ej?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Rj(e,t)):Tj(e,t),Pj=Dj,Zt=["verified_foods","foods","manual_foods","user_added","ai_enhanced","ai_manually_added","tesco_products","uk_foods_cleaned","fast_foods_database","generic_database","consumer_foods"],Aj={verified_foods:"verifiedFoods",foods:"foods",manual_foods:"manualFoods",user_added:"userAdded",ai_enhanced:"aiEnhanced",ai_manually_added:"aiManuallyAdded",tesco_products:"tescoProducts",uk_foods_cleaned:null,fast_foods_database:null,generic_database:null,consumer_foods:"consumer_foods"},Fj=["uk_foods_cleaned","fast_foods_database","generic_database"],LR={searchQuery:"",indices:[...Zt],verified:"all",hasIssues:!1,hasDuplicates:!1,hasBarcode:!1,zeroCalories:!1,hasReport:!1},Ij=["selection","imageUrl","name","brandName","barcode","_sourceIndex","calories","protein","carbs","fat","fiber","sugar","sodium","servingSizeG","servingDescription","isVerified","_reviewFlags","actions"],Yo=xj()(Pj((e,t)=>({foods:[],searchResults:[],isSearching:!1,selectedFoodIds:[],duplicateGroups:[],isLoading:!1,loadingProgress:0,loadingMessage:"",filters:LR,stats:null,undoStack:[],redoStack:[],columnOrder:Ij,dirtyFoodIds:new Set,foodReportIds:new Set,setFoods:s=>e({foods:s,dirtyFoodIds:new Set}),addFoods:s=>e(i=>({foods:[...i.foods,...s]})),updateFood:(s,i)=>e(r=>{const n=r.foods.findIndex(p=>p._id===s);if(n===-1)return r;const o=r.foods[n],a={...o,...i,_isDirty:!0},l=[...r.foods];l[n]=a;const u=new Set(r.dirtyFoodIds);u.add(s);const h={type:"update",food:a,previousState:o};return{foods:l,dirtyFoodIds:u,undoStack:[...r.undoStack,h],redoStack:[]}}),markFoodDeleted:s=>e(i=>{const r=i.foods.findIndex(l=>l._id===s);if(r===-1)return i;const n=i.foods[r],o=[...i.foods];o[r]={...n,_isDeleted:!0};const a={type:"delete",food:o[r],previousState:n};return{foods:o,undoStack:[...i.undoStack,a],redoStack:[]}}),restoreFood:s=>e(i=>{const r=i.foods.findIndex(o=>o._id===s);if(r===-1)return i;const n=[...i.foods];return n[r]={...n[r],_isDeleted:!1},{foods:n}}),setSelectedFoodIds:s=>e({selectedFoodIds:s}),toggleFoodSelection:s=>e(i=>({selectedFoodIds:i.selectedFoodIds.includes(s)?i.selectedFoodIds.filter(n=>n!==s):[...i.selectedFoodIds,s]})),selectAll:()=>e(()=>({selectedFoodIds:t().getFilteredFoods().map(s=>s._id)})),deselectAll:()=>e({selectedFoodIds:[]}),setFilters:s=>e(i=>({filters:{...i.filters,...s}})),clearFilters:()=>e({filters:LR}),setLoading:(s,i="")=>e({isLoading:s,loadingMessage:i}),setLoadingProgress:s=>e({loadingProgress:s}),setStats:s=>e({stats:s}),setDuplicateGroups:s=>e({duplicateGroups:s}),setColumnOrder:s=>e({columnOrder:s}),undo:()=>e(s=>{if(s.undoStack.length===0)return s;const i=s.undoStack[s.undoStack.length-1],r=s.undoStack.slice(0,-1);if(!i.previousState)return{undoStack:r};const n=s.foods.findIndex(a=>a._id===i.food._id);if(n===-1)return{undoStack:r};const o=[...s.foods];return o[n]=i.previousState,{foods:o,undoStack:r,redoStack:[...s.redoStack,i]}}),redo:()=>e(s=>{if(s.redoStack.length===0)return s;const i=s.redoStack[s.redoStack.length-1],r=s.redoStack.slice(0,-1),n=s.foods.findIndex(a=>a._id===i.food._id);if(n===-1)return{redoStack:r};const o=[...s.foods];return o[n]=i.food,{foods:o,redoStack:r,undoStack:[...s.undoStack,i]}}),pushUndo:s=>e(i=>({undoStack:[...i.undoStack,s],redoStack:[]})),clearDirty:()=>e(s=>({dirtyFoodIds:new Set,foods:s.foods.map(i=>({...i,_isDirty:!1}))})),getDirtyFoods:()=>t().foods.filter(i=>i._isDirty),setSearchResults:s=>e({searchResults:s,isSearching:!0}),setIsSearching:s=>e({isSearching:s}),clearSearch:()=>e({searchResults:[],isSearching:!1}),setFoodReportIds:s=>e({foodReportIds:s}),getFilteredFoods:()=>{const s=t(),{filters:i,foods:r,searchResults:n,isSearching:o}=s;return(o?n:r).filter(l=>{if(l._isDeleted||!i.indices.includes(l._sourceIndex)||i.verified==="verified"&&!l.isVerified||i.verified==="unverified"&&l.isVerified||i.hasIssues&&l._reviewFlags.length===0||i.hasBarcode&&!l.barcode||i.zeroCalories&&l.calories!==0||i.hasReport&&!s.foodReportIds.has(l.objectID))return!1;if(!o&&i.searchQuery){const u=i.searchQuery.toLowerCase();if(!`${l.name} ${l.brandName||""} ${l.barcode||""} ${l.ingredientsText||""}`.toLowerCase().includes(u))return!1}return!0})},getFoodById:s=>{const i=t();return i.foods.find(r=>r._id===s)||i.searchResults.find(r=>r._id===s)}}),{name:"nutrasafe-grid-store",partialize:e=>({columnOrder:e.columnOrder,filters:{indices:e.filters.indices}})})),IC="https://us-central1-nutrasafe-705c7.cloudfunctions.net",Nj=({food:e,onClose:t,onDelete:s,onSaveImage:i,isDeleting:r,isSaving:n})=>{const[o,a]=E.useState(e.imageUrl||""),[l,u]=E.useState(e.imageUrl||""),h=o!==(e.imageUrl||""),p=()=>{u(o)},g=()=>{o.trim()&&i(o.trim())};return c.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",onClick:t,children:c.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl w-full mx-4 overflow-hidden",onClick:m=>m.stopPropagation(),children:[c.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),e.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:e.brandName})]}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 p-1",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"p-6 bg-gray-50 flex items-center justify-center min-h-[300px]",children:l?c.jsx("img",{src:l,alt:e.name,className:"max-h-[400px] max-w-full object-contain rounded-lg shadow",onError:m=>{m.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23f3f4f6" width="200" height="200"/%3E%3Ctext fill="%239ca3af" x="50%25" y="50%25" text-anchor="middle" dy=".3em" font-size="14"%3EImage failed to load%3C/text%3E%3C/svg%3E'}}):c.jsxs("div",{className:"text-gray-400 text-center",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("p",{children:"No image"})]})}),c.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"url",value:o,onChange:m=>a(m.target.value),placeholder:"https://example.com/image.jpg",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),c.jsx("button",{onClick:p,disabled:!o.trim(),className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Preview"})]})]}),c.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-white",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Source: ",c.jsx("span",{className:"font-medium",children:e._sourceIndex})]}),c.jsxs("div",{className:"flex gap-2",children:[e.imageUrl&&c.jsx("button",{onClick:s,disabled:r||n,className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 ${r||n?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-600 hover:bg-red-100"}`,children:r?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Deleting..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})}),h&&o.trim()&&c.jsx("button",{onClick:g,disabled:n||r,className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 ${n||r?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:n?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Saving..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Image"]})})]})]})]})})};let Yf=null;const _j=e=>{const t=e.value,s=e.data,i=()=>{s&&Yf&&Yf(s)};return t?c.jsx("img",{src:t,alt:"",className:"w-12 h-12 object-cover rounded cursor-pointer hover:opacity-80 transition-opacity",onClick:i,title:"Click to view image",onError:r=>{r.target.style.display="none"}}):c.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-gray-100 rounded text-gray-400 text-xs cursor-pointer hover:bg-gray-200",onClick:i,title:"Click to view/add image",children:"No img"})},kj=e=>{var n;const t=e.value,s=(n=e.data)==null?void 0:n._id,i=Yo(o=>o.foodReportIds),r=s&&i.has(s);return c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{children:t}),r&&c.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-700",title:"Has user report",children:""})]})},Mj=e=>{const t=e.value,s={verified_foods:"bg-green-100 text-green-800",foods:"bg-blue-100 text-blue-800",manual_foods:"bg-purple-100 text-purple-800",user_added:"bg-yellow-100 text-yellow-800",ai_enhanced:"bg-pink-100 text-pink-800",ai_manually_added:"bg-indigo-100 text-indigo-800",tesco_products:"bg-orange-100 text-orange-800",uk_foods_cleaned:"bg-cyan-100 text-cyan-800",fast_foods_database:"bg-red-100 text-red-800",generic_database:"bg-gray-100 text-gray-800",consumer_foods:"bg-teal-100 text-teal-800"},i={verified_foods:"Verified",foods:"Foods",manual_foods:"Manual",user_added:"User",ai_enhanced:"AI",ai_manually_added:"AI Manual",tesco_products:"Tesco",uk_foods_cleaned:"UK Clean",fast_foods_database:"Fast Food",generic_database:"Generic",consumer_foods:"Consumer"};return c.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s[t]}`,children:i[t]})},Lj=e=>{const t=e.value;return c.jsx("span",{className:`inline-flex items-center ${t?"text-green-600":"text-gray-400"}`,children:t?c.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("circle",{cx:"12",cy:"12",r:"10",strokeWidth:"2"})})})},Oj=e=>{const t=e.value;return c.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${t?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-600"}`,children:t?"Per Unit":"Per 100g"})},Gj=e=>{var n;const t=((n=e.data)==null?void 0:n._reviewFlags)||[];if(t.length===0)return c.jsx("span",{className:"text-gray-400 text-xs",children:"None"});const s=t.filter(o=>o.severity==="error").length,i=t.filter(o=>o.severity==="warning").length,r=t.filter(o=>o.severity==="info").length;return c.jsxs("div",{className:"flex gap-1",children:[s>0&&c.jsx("span",{className:"px-1.5 py-0.5 bg-red-100 text-red-700 rounded text-xs",title:t.filter(o=>o.severity==="error").map(o=>o.message).join(`
`),children:s}),i>0&&c.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-700 rounded text-xs",title:t.filter(o=>o.severity==="warning").map(o=>o.message).join(`
`),children:i}),r>0&&c.jsx("span",{className:"px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",title:t.filter(o=>o.severity==="info").map(o=>o.message).join(`
`),children:r})]})},Pa=e=>{const t=e.value;if(t==null)return c.jsx("span",{className:"text-gray-400",children:"-"});const s=Number.isInteger(t)?t.toString():t.toFixed(1);return c.jsx("span",{className:"font-mono text-right",children:s})},Vj=()=>{const e=E.useRef(null),t=E.useRef(null),s=E.useRef(null),i=E.useRef(new Map),[r,n]=E.useState("idle"),[o,a]=E.useState(null),[l,u]=E.useState(!1),[h,p]=E.useState(!1);E.useEffect(()=>(Yf=a,()=>{Yf=null}),[]);const{getFilteredFoods:g,setSelectedFoodIds:m,updateFood:C,setColumnOrder:y}=Yo(),R=g(),x=E.useCallback(async b=>{try{const F={foodId:b.objectID,indexName:b._sourceIndex,updates:{foodName:b.name,brandName:b.brandName,barcode:b.barcode,servingSizeG:b.servingSizeG,servingSize:b.servingDescription,isPerUnit:b.isPerUnit,nutrition:{calories:b.calories,protein:b.protein,carbs:b.carbs,fat:b.fat,fiber:b.fiber,sugar:b.sugar,sodium:b.sodium,saturatedFat:b.saturatedFat}}};return console.log(" Saving to backend:",JSON.stringify(F,null,2)),(await(await fetch(`${IC}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).json()).success}catch(F){return console.error("Auto-save error:",F),!1}},[]),S=E.useCallback(b=>{i.current.set(b._id,b),s.current&&clearTimeout(s.current),n("saving"),s.current=setTimeout(async()=>{const F=Array.from(i.current.values());i.current.clear();let Z=!0;for(const K of F)await x(K)||(Z=!1);n(Z?"saved":"error"),setTimeout(()=>n("idle"),2e3)},1e3)},[x]),T=E.useMemo(()=>[{headerCheckboxSelection:!0,checkboxSelection:!0,width:50,pinned:"left",lockPosition:!0,suppressMenu:!0,resizable:!1},{field:"imageUrl",headerName:"Image",width:80,cellRenderer:_j,editable:!1,filter:!1,sortable:!1},{field:"name",headerName:"Name",width:250,editable:!0,filter:"agTextColumnFilter",sortable:!0,cellClass:"font-medium",cellRenderer:kj},{field:"brandName",headerName:"Brand",width:150,editable:!0,filter:"agTextColumnFilter",sortable:!0},{field:"barcode",headerName:"Barcode",width:130,editable:!0,filter:"agTextColumnFilter",sortable:!0,cellClass:"font-mono text-sm"},{field:"_sourceIndex",headerName:"Source",width:100,cellRenderer:Mj,editable:!1,filter:"agSetColumnFilter",filterParams:{values:[...Zt]},sortable:!0},{field:"calories",headerName:"Cal",width:80,editable:!0,cellRenderer:Pa,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"protein",headerName:"Protein",width:80,editable:!0,cellRenderer:Pa,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"carbs",headerName:"Carbs",width:80,editable:!0,cellRenderer:Pa,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"fat",headerName:"Fat",width:70,editable:!0,cellRenderer:Pa,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"fiber",headerName:"Fibre",width:70,editable:!0,cellRenderer:Pa,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"sugar",headerName:"Sugar",width:70,editable:!0,cellRenderer:Pa,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"sodium",headerName:"Sodium",width:80,editable:!0,cellRenderer:Pa,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"servingSizeG",headerName:"Serving (g)",width:100,editable:!0,valueGetter:b=>{var F;return(F=b.data)==null?void 0:F.servingSizeG},valueFormatter:b=>b.value==null?"-":`${b.value}g`,valueParser:b=>{if(!b.newValue)return null;const F=String(b.newValue).toLowerCase().replace(/[^0-9.]/g,""),Z=parseFloat(F);return console.log(`servingSizeG parser: "${b.newValue}" -> ${Z}`),isNaN(Z)?null:Z},filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn"},{field:"servingDescription",headerName:"Serving Desc",width:120,editable:!0,valueFormatter:b=>b.value||"-",filter:"agTextColumnFilter",sortable:!0},{field:"isPerUnit",headerName:"Per Unit",width:90,cellRenderer:Oj,editable:!0,filter:"agSetColumnFilter",filterParams:{values:[!0,!1],valueFormatter:b=>b.value?"Per Unit":"Per 100g"},sortable:!0,cellEditor:"agSelectCellEditor",cellEditorParams:{values:[!0,!1]},valueFormatter:b=>b.value?"Per Unit":"Per 100g"},{field:"isVerified",headerName:"Verified",width:90,cellRenderer:Lj,editable:!1,filter:"agSetColumnFilter",filterParams:{values:[!0,!1],valueFormatter:b=>b.value?"Verified":"Unverified"},sortable:!0},{field:"_reviewFlags",headerName:"Issues",width:100,cellRenderer:Gj,editable:!1,filter:!1,sortable:!1},{field:"_confidenceScore",headerName:"Score",width:80,editable:!1,filter:"agNumberColumnFilter",sortable:!0,type:"numericColumn",valueFormatter:b=>b.value?`${b.value}%`:"-"}],[]),I=E.useMemo(()=>({resizable:!0,suppressMovable:!1}),[]),V=E.useCallback(b=>{t.current=b.api},[]),H=E.useCallback(b=>{if(b.data&&b.colDef.field){const F=b.colDef.field;C(b.data._id,{[F]:b.newValue});const Z={...b.data,[F]:b.newValue};S(Z)}},[C,S]),P=E.useCallback(b=>{if(t.current){const F=t.current.getSelectedRows();m(F.map(Z=>Z._id))}},[m]),N=E.useCallback(b=>{if(t.current){const Z=t.current.getAllDisplayedColumns().map(K=>K.getColId());y(Z)}},[y]);E.useEffect(()=>{const b=F=>{(F.metaKey||F.ctrlKey)&&F.key==="s"&&(F.preventDefault(),console.log("Save triggered")),(F.metaKey||F.ctrlKey)&&F.key==="z"&&!F.shiftKey&&(F.preventDefault(),Yo.getState().undo()),(F.metaKey||F.ctrlKey)&&F.key==="z"&&F.shiftKey&&(F.preventDefault(),Yo.getState().redo())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[]);const _=E.useMemo(()=>({"bg-red-50":b=>{var F;return((F=b.data)==null?void 0:F._isDeleted)===!0},"bg-yellow-50":b=>{var F;return((F=b.data)==null?void 0:F._isDirty)===!0},"bg-red-100":b=>{var F,Z;return((Z=(F=b.data)==null?void 0:F._reviewFlags)==null?void 0:Z.some(K=>K.severity==="error"))===!0}}),[]),L=E.useCallback(async()=>{if(!(!o||!window.confirm(`Are you sure you want to delete the image for "${o.name}"?

This action cannot be undone.`))){u(!0);try{const F={foodId:o.objectID,indexName:o._sourceIndex,updates:{imageUrl:null}};console.log(" Deleting image:",F);const K=await(await fetch(`${IC}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).json();if(K.success)C(o._id,{imageUrl:null}),t.current&&t.current.refreshCells({force:!0}),a(null),console.log(" Image deleted successfully");else throw new Error(K.error||"Failed to delete image")}catch(F){console.error("Delete image error:",F),alert(`Failed to delete image: ${F instanceof Error?F.message:String(F)}`)}finally{u(!1)}}},[o,C]),M=E.useCallback(async b=>{if(o){p(!0);try{const F={foodId:o.objectID,indexName:o._sourceIndex,updates:{imageUrl:b}};console.log(" Saving image:",F);const K=await(await fetch(`${IC}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)})).json();if(K.success)C(o._id,{imageUrl:b}),t.current&&t.current.refreshCells({force:!0}),a(null),console.log(" Image saved successfully");else throw new Error(K.error||"Failed to save image")}catch(F){console.error("Save image error:",F),alert(`Failed to save image: ${F instanceof Error?F.message:String(F)}`)}finally{p(!1)}}},[o,C]);return c.jsxs("div",{className:"ag-theme-alpine w-full h-full relative",children:[r!=="idle"&&c.jsxs("div",{className:`absolute top-2 right-2 z-10 px-3 py-1.5 rounded-full text-sm font-medium shadow-lg flex items-center gap-2 ${r==="saving"?"bg-yellow-100 text-yellow-800":r==="saved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[r==="saving"&&c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Saving..."]}),r==="saved"&&c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),r==="error"&&c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Save failed"]})]}),c.jsx(YH,{ref:e,rowData:R,columnDefs:T,defaultColDef:I,rowSelection:"multiple",suppressRowClickSelection:!0,getRowId:b=>b.data._id,onGridReady:V,onCellValueChanged:H,onRowSelected:P,onColumnMoved:N,rowClassRules:_,animateRows:!0,enableCellTextSelection:!0,suppressCopyRowsToClipboard:!1,rowBuffer:20,cacheBlockSize:100,maxBlocksInCache:10,rowHeight:56,headerHeight:40}),o&&c.jsx(Nj,{food:o,onClose:()=>a(null),onDelete:L,onSaveImage:M,isDeleting:l,isSaving:h})]})};var $N={exports:{}};/*! algoliasearch-lite.umd.js | 4.25.3 |  Algolia, inc. | https://github.com/algolia/algoliasearch-client-javascript */(function(e,t){(function(s,i){e.exports=i()})(fk,function(){function s(U,J,ce){return J in U?Object.defineProperty(U,J,{value:ce,enumerable:!0,configurable:!0,writable:!0}):U[J]=ce,U}function i(U,J){var ce=Object.keys(U);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(U);J&&(Y=Y.filter(function(te){return Object.getOwnPropertyDescriptor(U,te).enumerable})),ce.push.apply(ce,Y)}return ce}function r(U){for(var J=1;J<arguments.length;J++){var ce=arguments[J]!=null?arguments[J]:{};J%2?i(Object(ce),!0).forEach(function(Y){s(U,Y,ce[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(ce)):i(Object(ce)).forEach(function(Y){Object.defineProperty(U,Y,Object.getOwnPropertyDescriptor(ce,Y))})}return U}function n(U,J){if(U==null)return{};var ce,Y,te=function(Ae,fe){if(Ae==null)return{};var k,O,W={},le=Object.keys(Ae);for(O=0;O<le.length;O++)k=le[O],fe.indexOf(k)>=0||(W[k]=Ae[k]);return W}(U,J);if(Object.getOwnPropertySymbols){var he=Object.getOwnPropertySymbols(U);for(Y=0;Y<he.length;Y++)ce=he[Y],J.indexOf(ce)>=0||Object.prototype.propertyIsEnumerable.call(U,ce)&&(te[ce]=U[ce])}return te}function o(U,J){return function(ce){if(Array.isArray(ce))return ce}(U)||function(ce,Y){if(Symbol.iterator in Object(ce)||Object.prototype.toString.call(ce)==="[object Arguments]"){var te=[],he=!0,Ae=!1,fe=void 0;try{for(var k,O=ce[Symbol.iterator]();!(he=(k=O.next()).done)&&(te.push(k.value),!Y||te.length!==Y);he=!0);}catch(W){Ae=!0,fe=W}finally{try{he||O.return==null||O.return()}finally{if(Ae)throw fe}}return te}}(U,J)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(U){return function(J){if(Array.isArray(J)){for(var ce=0,Y=new Array(J.length);ce<J.length;ce++)Y[ce]=J[ce];return Y}}(U)||function(J){if(Symbol.iterator in Object(J)||Object.prototype.toString.call(J)==="[object Arguments]")return Array.from(J)}(U)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(U){var J,ce="algoliasearch-client-js-".concat(U.key),Y=function(){return J===void 0&&(J=U.localStorage||window.localStorage),J},te=function(){return JSON.parse(Y().getItem(ce)||"{}")},he=function(fe){Y().setItem(ce,JSON.stringify(fe))},Ae=function(){var fe=U.timeToLive?1e3*U.timeToLive:null,k=te(),O=Object.fromEntries(Object.entries(k).filter(function(le){return o(le,2)[1].timestamp!==void 0}));if(he(O),fe){var W=Object.fromEntries(Object.entries(O).filter(function(le){var ne=o(le,2)[1],X=new Date().getTime();return!(ne.timestamp+fe<X)}));he(W)}};return{get:function(fe,k){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}};return Promise.resolve().then(function(){Ae();var W=JSON.stringify(fe);return te()[W]}).then(function(W){return Promise.all([W?W.value:k(),W!==void 0])}).then(function(W){var le=o(W,2),ne=le[0],X=le[1];return Promise.all([ne,X||O.miss(ne)])}).then(function(W){return o(W,1)[0]})},set:function(fe,k){return Promise.resolve().then(function(){var O=te();return O[JSON.stringify(fe)]={timestamp:new Date().getTime(),value:k},Y().setItem(ce,JSON.stringify(O)),k})},delete:function(fe){return Promise.resolve().then(function(){var k=te();delete k[JSON.stringify(fe)],Y().setItem(ce,JSON.stringify(k))})},clear:function(){return Promise.resolve().then(function(){Y().removeItem(ce)})}}}function u(U){var J=a(U.caches),ce=J.shift();return ce===void 0?{get:function(Y,te){var he=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}},Ae=te();return Ae.then(function(fe){return Promise.all([fe,he.miss(fe)])}).then(function(fe){return o(fe,1)[0]})},set:function(Y,te){return Promise.resolve(te)},delete:function(Y){return Promise.resolve()},clear:function(){return Promise.resolve()}}:{get:function(Y,te){var he=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}};return ce.get(Y,te,he).catch(function(){return u({caches:J}).get(Y,te,he)})},set:function(Y,te){return ce.set(Y,te).catch(function(){return u({caches:J}).set(Y,te)})},delete:function(Y){return ce.delete(Y).catch(function(){return u({caches:J}).delete(Y)})},clear:function(){return ce.clear().catch(function(){return u({caches:J}).clear()})}}}function h(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{serializable:!0},J={};return{get:function(ce,Y){var te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}},he=JSON.stringify(ce);if(he in J)return Promise.resolve(U.serializable?JSON.parse(J[he]):J[he]);var Ae=Y(),fe=te&&te.miss||function(){return Promise.resolve()};return Ae.then(function(k){return fe(k)}).then(function(){return Ae})},set:function(ce,Y){return J[JSON.stringify(ce)]=U.serializable?JSON.stringify(Y):Y,Promise.resolve(Y)},delete:function(ce){return delete J[JSON.stringify(ce)],Promise.resolve()},clear:function(){return J={},Promise.resolve()}}}function p(U){for(var J=U.length-1;J>0;J--){var ce=Math.floor(Math.random()*(J+1)),Y=U[J];U[J]=U[ce],U[ce]=Y}return U}function g(U,J){return J&&Object.keys(J).forEach(function(ce){U[ce]=J[ce](U)}),U}function m(U){for(var J=arguments.length,ce=new Array(J>1?J-1:0),Y=1;Y<J;Y++)ce[Y-1]=arguments[Y];var te=0;return U.replace(/%s/g,function(){return encodeURIComponent(ce[te++])})}var C={WithinQueryParameters:0,WithinHeaders:1};function y(U,J){var ce=U||{},Y=ce.data||{};return Object.keys(ce).forEach(function(te){["timeout","headers","queryParameters","data","cacheable"].indexOf(te)===-1&&(Y[te]=ce[te])}),{data:Object.entries(Y).length>0?Y:void 0,timeout:ce.timeout||J,headers:ce.headers||{},queryParameters:ce.queryParameters||{},cacheable:ce.cacheable}}var R={Read:1,Write:2,Any:3},x=1,S=2,T=3;function I(U){var J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x;return r(r({},U),{},{status:J,lastUpdate:Date.now()})}function V(U){return typeof U=="string"?{protocol:"https",url:U,accept:R.Any}:{protocol:U.protocol||"https",url:U.url,accept:U.accept||R.Any}}var H="GET",P="POST";function N(U,J){return Promise.all(J.map(function(ce){return U.get(ce,function(){return Promise.resolve(I(ce))})})).then(function(ce){var Y=ce.filter(function(Ae){return function(fe){return fe.status===x||Date.now()-fe.lastUpdate>12e4}(Ae)}),te=ce.filter(function(Ae){return function(fe){return fe.status===T&&Date.now()-fe.lastUpdate<=12e4}(Ae)}),he=[].concat(a(Y),a(te));return{getTimeout:function(Ae,fe){return(te.length===0&&Ae===0?1:te.length+3+Ae)*fe},statelessHosts:he.length>0?he.map(function(Ae){return V(Ae)}):J}})}function _(U,J,ce,Y){var te=[],he=function(ne,X){if(!(ne.method===H||ne.data===void 0&&X.data===void 0)){var Q=Array.isArray(ne.data)?ne.data:r(r({},ne.data),X.data);return JSON.stringify(Q)}}(ce,Y),Ae=function(ne,X){var Q=r(r({},ne.headers),X.headers),re={};return Object.keys(Q).forEach(function(Se){var Me=Q[Se];re[Se.toLowerCase()]=Me}),re}(U,Y),fe=ce.method,k=ce.method!==H?{}:r(r({},ce.data),Y.data),O=r(r(r({"x-algolia-agent":U.userAgent.value},U.queryParameters),k),Y.queryParameters),W=0,le=function ne(X,Q){var re=X.pop();if(re===void 0)throw{name:"RetryError",message:"Unreachable hosts - your application id may be incorrect. If the error persists, please reach out to the Algolia Support team: https://alg.li/support .",transporterStackTrace:F(te)};var Se={data:he,headers:Ae,method:fe,url:M(re,ce.path,O),connectTimeout:Q(W,U.timeouts.connect),responseTimeout:Q(W,Y.timeout)},Me=function(Pe){var We={request:Se,response:Pe,host:re,triesLeft:X.length};return te.push(We),We},Ne={onSuccess:function(Pe){return function(We){try{return JSON.parse(We.content)}catch(Ye){throw function(Ke,ie){return{name:"DeserializationError",message:Ke,response:ie}}(Ye.message,We)}}(Pe)},onRetry:function(Pe){var We=Me(Pe);return Pe.isTimedOut&&W++,Promise.all([U.logger.info("Retryable failure",Z(We)),U.hostsCache.set(re,I(re,Pe.isTimedOut?T:S))]).then(function(){return ne(X,Q)})},onFail:function(Pe){throw Me(Pe),function(We,Ye){var Ke=We.content,ie=We.status,Dt=Ke;try{Dt=JSON.parse(Ke).message}catch{}return function(Fs,$t,bt){return{name:"ApiError",message:Fs,status:$t,transporterStackTrace:bt}}(Dt,ie,Ye)}(Pe,F(te))}};return U.requester.send(Se).then(function(Pe){return function(We,Ye){return function(Ke){var ie=Ke.status;return Ke.isTimedOut||function(Dt){var Fs=Dt.isTimedOut,$t=Dt.status;return!Fs&&~~$t==0}(Ke)||~~(ie/100)!=2&&~~(ie/100)!=4}(We)?Ye.onRetry(We):~~(We.status/100)==2?Ye.onSuccess(We):Ye.onFail(We)}(Pe,Ne)})};return N(U.hostsCache,J).then(function(ne){return le(a(ne.statelessHosts).reverse(),ne.getTimeout)})}function L(U){var J={value:"Algolia for JavaScript (".concat(U,")"),add:function(ce){var Y="; ".concat(ce.segment).concat(ce.version!==void 0?" (".concat(ce.version,")"):"");return J.value.indexOf(Y)===-1&&(J.value="".concat(J.value).concat(Y)),J}};return J}function M(U,J,ce){var Y=b(ce),te="".concat(U.protocol,"://").concat(U.url,"/").concat(J.charAt(0)==="/"?J.substr(1):J);return Y.length&&(te+="?".concat(Y)),te}function b(U){return Object.keys(U).map(function(J){return m("%s=%s",J,(ce=U[J],Object.prototype.toString.call(ce)==="[object Object]"||Object.prototype.toString.call(ce)==="[object Array]"?JSON.stringify(U[J]):U[J]));var ce}).join("&")}function F(U){return U.map(function(J){return Z(J)})}function Z(U){var J=U.request.headers["x-algolia-api-key"]?{"x-algolia-api-key":"*****"}:{};return r(r({},U),{},{request:r(r({},U.request),{},{headers:r(r({},U.request.headers),J)})})}var K=function(U){var J=U.appId,ce=function(te,he,Ae){var fe={"x-algolia-api-key":Ae,"x-algolia-application-id":he};return{headers:function(){return te===C.WithinHeaders?fe:{}},queryParameters:function(){return te===C.WithinQueryParameters?fe:{}}}}(U.authMode!==void 0?U.authMode:C.WithinHeaders,J,U.apiKey),Y=function(te){var he=te.hostsCache,Ae=te.logger,fe=te.requester,k=te.requestsCache,O=te.responsesCache,W=te.timeouts,le=te.userAgent,ne=te.hosts,X=te.queryParameters,Q={hostsCache:he,logger:Ae,requester:fe,requestsCache:k,responsesCache:O,timeouts:W,userAgent:le,headers:te.headers,queryParameters:X,hosts:ne.map(function(re){return V(re)}),read:function(re,Se){var Me=y(Se,Q.timeouts.read),Ne=function(){return _(Q,Q.hosts.filter(function(We){return(We.accept&R.Read)!=0}),re,Me)};if((Me.cacheable!==void 0?Me.cacheable:re.cacheable)!==!0)return Ne();var Pe={request:re,mappedRequestOptions:Me,transporter:{queryParameters:Q.queryParameters,headers:Q.headers}};return Q.responsesCache.get(Pe,function(){return Q.requestsCache.get(Pe,function(){return Q.requestsCache.set(Pe,Ne()).then(function(We){return Promise.all([Q.requestsCache.delete(Pe),We])},function(We){return Promise.all([Q.requestsCache.delete(Pe),Promise.reject(We)])}).then(function(We){var Ye=o(We,2);return Ye[0],Ye[1]})})},{miss:function(We){return Q.responsesCache.set(Pe,We)}})},write:function(re,Se){return _(Q,Q.hosts.filter(function(Me){return(Me.accept&R.Write)!=0}),re,y(Se,Q.timeouts.write))}};return Q}(r(r({hosts:[{url:"".concat(J,"-dsn.algolia.net"),accept:R.Read},{url:"".concat(J,".algolia.net"),accept:R.Write}].concat(p([{url:"".concat(J,"-1.algolianet.com")},{url:"".concat(J,"-2.algolianet.com")},{url:"".concat(J,"-3.algolianet.com")}]))},U),{},{headers:r(r(r({},ce.headers()),{"content-type":"application/x-www-form-urlencoded"}),U.headers),queryParameters:r(r({},ce.queryParameters()),U.queryParameters)}));return g({transporter:Y,appId:J,addAlgoliaAgent:function(te,he){Y.userAgent.add({segment:te,version:he})},clearCache:function(){return Promise.all([Y.requestsCache.clear(),Y.responsesCache.clear()]).then(function(){})}},U.methods)},ge=function(U){return function(J,ce){return J.method===H?U.transporter.read(J,ce):U.transporter.write(J,ce)}},me=function(U){return function(J){var ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y={transporter:U.transporter,appId:U.appId,indexName:J};return g(Y,ce.methods)}},de=function(U){return function(J,ce){var Y=J.map(function(te){return r(r({},te),{},{params:b(te.params||{})})});return U.transporter.read({method:P,path:"1/indexes/*/queries",data:{requests:Y},cacheable:!0},ce)}},ye=function(U){return function(J,ce){return Promise.all(J.map(function(Y){var te=Y.params,he=te.facetName,Ae=te.facetQuery,fe=n(te,["facetName","facetQuery"]);return me(U)(Y.indexName,{methods:{searchForFacetValues:ve}}).searchForFacetValues(he,Ae,r(r({},ce),fe))}))}},pe=function(U){return function(J,ce,Y){return U.transporter.read({method:P,path:m("1/answers/%s/prediction",U.indexName),data:{query:J,queryLanguages:ce},cacheable:!0},Y)}},q=function(U){return function(J,ce){return U.transporter.read({method:P,path:m("1/indexes/%s/query",U.indexName),data:{query:J},cacheable:!0},ce)}},ve=function(U){return function(J,ce,Y){return U.transporter.read({method:P,path:m("1/indexes/%s/facets/%s/query",U.indexName,J),data:{facetQuery:ce},cacheable:!0},Y)}},$=1,be=2,se=3,Ge=function(U){return function(J,ce){var Y=J.map(function(te){return r(r({},te),{},{threshold:te.threshold||0})});return U.transporter.read({method:P,path:"1/indexes/*/recommendations",data:{requests:Y},cacheable:!0},ce)}};function Re(U,J,ce){var Y,te={appId:U,apiKey:J,timeouts:{connect:1,read:2,write:30},requester:{send:function(he){return new Promise(function(Ae){var fe=new XMLHttpRequest;fe.open(he.method,he.url,!0),Object.keys(he.headers).forEach(function(le){return fe.setRequestHeader(le,he.headers[le])});var k,O=function(le,ne){return setTimeout(function(){fe.abort(),Ae({status:0,content:ne,isTimedOut:!0})},1e3*le)},W=O(he.connectTimeout,"Connection timeout");fe.onreadystatechange=function(){fe.readyState>fe.OPENED&&k===void 0&&(clearTimeout(W),k=O(he.responseTimeout,"Socket timeout"))},fe.onerror=function(){fe.status===0&&(clearTimeout(W),clearTimeout(k),Ae({content:fe.responseText||"Network request failed",status:fe.status,isTimedOut:!1}))},fe.onload=function(){clearTimeout(W),clearTimeout(k),Ae({content:fe.responseText,status:fe.status,isTimedOut:!1})},fe.send(he.data)})}},logger:(Y=se,{debug:function(he,Ae){return $>=Y&&console.debug(he,Ae),Promise.resolve()},info:function(he,Ae){return be>=Y&&console.info(he,Ae),Promise.resolve()},error:function(he,Ae){return console.error(he,Ae),Promise.resolve()}}),responsesCache:h(),requestsCache:h({serializable:!1}),hostsCache:u({caches:[l({key:"".concat("4.25.3","-").concat(U)}),h()]}),userAgent:L("4.25.3").add({segment:"Browser",version:"lite"}),authMode:C.WithinQueryParameters};return K(r(r(r({},te),ce),{},{methods:{search:de,searchForFacetValues:ye,multipleQueries:de,multipleSearchForFacetValues:ye,customRequest:ge,initIndex:function(he){return function(Ae){return me(he)(Ae,{methods:{search:q,searchForFacetValues:ve,findAnswers:pe}})}},getRecommendations:Ge}}))}return Re.version="4.25.3",Re})})($N);var Bj=$N.exports;const Hj=um(Bj),jj="WK0TIF84M2",Wj="577cc4ee3fed660318917bbb54abfb2e",KN=Hj(jj,Wj);function zj(e,t){var Z,K;const s=e.objectID||"",i=e.name||e.foodName||e.title||"",r=e.brandName||e.brand||null,n=e.barcode||e.gtin||e.ean||null;let o=[],a=null;e.ingredients&&(Array.isArray(e.ingredients)?(o=e.ingredients,a=o.join(", ")):typeof e.ingredients=="string"&&(a=e.ingredients,o=e.ingredients.split(/,\s*/))),e.extractedIngredients&&(a=e.extractedIngredients,o.length||(o=a.split(/,\s*/)));const l=Number(e.calories||e.energyKcal||0),u=Number(e.protein||0),h=Number(e.carbs||e.carbohydrate||e.carbohydrates||0),p=Number(e.fat||0),g=e.saturatedFat!==void 0?Number(e.saturatedFat||e.saturates||0):null,m=Number(e.fiber||e.fibre||0),C=Number(e.sugar||e.sugars||0),y=Number(e.sodium||0),R=e.salt!==void 0?Number(e.salt):null,x=e.servingDescription||e.servingSize||e.serving_description||null,S=e.servingSizeG!==void 0?Number(e.servingSizeG||e.serving_size_g||0):null,T=!!(e.per_unit_nutrition||e.isPerUnit),I=!!(e.verified||e.isVerified),V=e.verifiedBy||null,H=e.verifiedAt?new Date(e.verifiedAt):null,P=e.imageUrl||e.image_url||null,N=e.category||e.department||null,_=e.source||null,L=e.createdAt?new Date((Z=e.createdAt)!=null&&Z._seconds?e.createdAt._seconds*1e3:e.createdAt*1e3):null,M=e.updatedAt?new Date((K=e.updatedAt)!=null&&K._seconds?e.updatedAt._seconds*1e3:e.updatedAt*1e3):null,b=Uj({name:i,calories:l,protein:u,carbs:h,fat:p,barcode:n,ingredients:o}),F=$j({name:i,brandName:r,barcode:n,ingredients:o,calories:l,isVerified:I,imageUrl:P});return{_id:`${t}:${s}`,objectID:s,_sourceIndex:t,_firestoreCollection:Aj[t],_hasFirestoreBacking:!Fj.includes(t),name:i,brandName:r,barcode:n,barcodes:n?[n]:[],ingredients:o,ingredientsText:a,calories:l,protein:u,carbs:h,fat:p,saturatedFat:g,fiber:m,sugar:C,sodium:y,salt:R,servingDescription:x,servingSizeG:S,isPerUnit:T,isVerified:I,verifiedBy:V,verifiedAt:H,imageUrl:P,category:N,source:_,createdAt:L,updatedAt:M,_confidenceScore:F,_reviewFlags:b,_duplicateCandidates:[],_isDirty:!1,_isDeleted:!1}}function Uj(e){const t=[];if((!e.name||e.name.trim()==="")&&t.push({type:"missing_name",severity:"error",message:"Missing product name"}),e.calories===0&&e.protein===0&&e.carbs===0&&e.fat===0&&t.push({type:"missing_nutrition",severity:"error",message:"All nutrition values are zero"}),e.calories>900&&t.push({type:"implausible_calories",severity:"error",message:`Calories (${e.calories}) exceed 900 per 100g`}),e.calories>0){const n=e.protein*4+e.carbs*4+e.fat*9;Math.abs(e.calories-n)/e.calories>.3&&n>0&&t.push({type:"implausible_macros",severity:"warning",message:`Macros (${Math.round(n)} cal) don't match calories (${e.calories})`})}const s=["color","flavor","fiber","center"],i=`${e.name} ${e.ingredients.join(" ")}`.toLowerCase();return s.some(n=>i.includes(n))&&t.push({type:"non_uk",severity:"warning",message:"Contains US spelling (may not be UK product)"}),e.barcode||t.push({type:"missing_barcode",severity:"info",message:"No barcode available"}),e.ingredients.length||t.push({type:"missing_ingredients",severity:"info",message:"No ingredients listed"}),t}function $j(e){let t=0;return e.name&&e.name.trim()&&(t+=20),e.brandName&&(t+=10),e.barcode&&(t+=15),e.ingredients.length>0&&(t+=15),e.calories>0&&(t+=15),e.isVerified&&(t+=15),e.imageUrl&&(t+=10),Math.min(100,t)}async function YN(e,t="",s={}){const{page:i=0,hitsPerPage:r=100,filters:n}=s,o=KN.initIndex(e);try{const a=await o.search(t,{page:i,hitsPerPage:r,filters:n});return{foods:a.hits.map(u=>zj(u,e)),total:a.nbHits,page:a.page}}catch(a){return console.error(`Error searching index ${e}:`,a),{foods:[],total:0,page:0}}}async function qN(e="",t=[...Zt],s={}){const{hitsPerPage:i=1e3}=s,r=await Promise.all(t.map(async u=>{const h=await YN(u,e,{hitsPerPage:i});return{indexName:u,...h}})),n=[],o={},a=["verified_foods","uk_foods_cleaned","tesco_products","manual_foods","ai_enhanced","user_added","foods","ai_manually_added","fast_foods_database","generic_database"];return r.sort((u,h)=>{const p=a.indexOf(u.indexName),g=a.indexOf(h.indexName);return(p===-1?999:p)-(g===-1?999:g)}).forEach(u=>{n.push(...u.foods),o[u.indexName]=u.total}),{foods:n,totalByIndex:o}}async function QN(e,t=[...Zt]){const s=await Promise.all(t.map(async a=>{const l=await YN(a,"",{hitsPerPage:100,filters:`barcode:"${e}"`});return{indexName:a,...l}})),i=[],r={},n=["verified_foods","uk_foods_cleaned","tesco_products","manual_foods","ai_enhanced","user_added","foods","ai_manually_added","fast_foods_database","generic_database"];return s.sort((a,l)=>{const u=n.indexOf(a.indexName),h=n.indexOf(l.indexName);return(u===-1?999:u)-(h===-1?999:h)}).forEach(a=>{i.push(...a.foods),r[a.indexName]=a.total}),{foods:i,totalByIndex:r}}async function Kj(){const e={};return await Promise.all(Zt.map(async t=>{try{const i=await KN.initIndex(t).search("",{hitsPerPage:0,analytics:!1});e[t]={entries:i.nbHits}}catch(s){console.error(`Error getting stats for ${t}:`,s),e[t]={entries:0}}})),e}const Yj=({onSave:e,onRefresh:t,onDeleteSelected:s,onMoveSelected:i,isSaving:r,isDeleting:n,isMoving:o=!1})=>{const{filters:a,setFilters:l,selectedFoodIds:u,deselectAll:h,stats:p,getDirtyFoods:g,setSearchResults:m,clearSearch:C,isSearching:y}=Yo(),[R,x]=E.useState(!1),[S,T]=E.useState(!1),[I,V]=E.useState(!1),[H,P]=E.useState(""),[N,_]=E.useState(!1),L=E.useRef(null),M=g().length,b=E.useCallback(async pe=>{if(!pe.trim()){C();return}V(!0);try{const{foods:q}=await qN(pe,a.indices,{hitsPerPage:500});m(q)}catch(q){console.error("Search error:",q)}finally{V(!1)}},[a.indices,m,C]),F=E.useCallback(pe=>{const q=pe.target.value;l({searchQuery:q}),L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{b(q)},300)},[l,b]);E.useEffect(()=>()=>{L.current&&clearTimeout(L.current)},[]);const Z=E.useCallback(async()=>{if(H.trim()){_(!0);try{const{foods:pe}=await QN(H.trim(),a.indices);m(pe),l({searchQuery:`Barcode: ${H}`})}catch(pe){console.error("Barcode search error:",pe)}finally{_(!1)}}},[H,a.indices,m,l]),K=E.useCallback(pe=>{l({verified:pe})},[l]),ge=E.useCallback(pe=>{const q=a.indices,ve=q.includes(pe)?q.filter($=>$!==pe):[...q,pe];l({indices:ve})},[a.indices,l]),me=E.useCallback(()=>{l({indices:[...Zt]})},[l]),de=E.useCallback(()=>{l({indices:[]})},[l]),ye={verified_foods:"Verified",foods:"Foods",manual_foods:"Manual",user_added:"User",ai_enhanced:"AI Enhanced",ai_manually_added:"AI Manual",tesco_products:"Tesco",uk_foods_cleaned:"UK Cleaned",fast_foods_database:"Fast Food",generic_database:"Generic",consumer_foods:"Consumer"};return c.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-3",children:c.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-white font-bold text-sm",children:"NS"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Food Database Manager"}),p&&c.jsxs("p",{className:"text-xs text-gray-500",children:[p.totalFoods.toLocaleString()," foods across ",Zt.length," indices"]})]})]}),c.jsxs("div",{className:"flex-1 max-w-md",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Search all foods across Algolia...",value:a.searchQuery,onChange:F,className:`w-full px-4 py-2 pl-10 pr-10 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent ${y?"border-primary-400 bg-primary-50":"border-gray-300"}`}),I?c.jsxs("svg",{className:"absolute left-3 top-2.5 w-5 h-5 text-primary-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a.searchQuery&&c.jsx("button",{onClick:()=>{l({searchQuery:""}),C()},className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y&&c.jsx("p",{className:"mt-1 text-xs text-primary-600",children:"Searching across all Algolia indices"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Barcode...",value:H,onChange:pe=>P(pe.target.value),onKeyDown:pe=>{pe.key==="Enter"&&Z()},className:"w-36 px-3 py-2 pl-8 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),c.jsx("svg",{className:"absolute left-2.5 top-2.5 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})]}),c.jsxs("button",{onClick:Z,disabled:!H.trim()||N,className:"flex items-center gap-1.5 px-3 py-2 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[N?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[c.jsx("button",{onClick:()=>K("all"),className:`px-3 py-1.5 text-sm ${a.verified==="all"?"bg-primary-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"All"}),c.jsx("button",{onClick:()=>K("verified"),className:`px-3 py-1.5 text-sm border-l ${a.verified==="verified"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Verified"}),c.jsx("button",{onClick:()=>K("unverified"),className:`px-3 py-1.5 text-sm border-l ${a.verified==="unverified"?"bg-yellow-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Unverified"})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>x(!R),className:"flex items-center gap-2 px-3 py-1.5 text-sm border border-gray-300 rounded-lg bg-white hover:bg-gray-50",children:[c.jsxs("span",{children:["Indices (",a.indices.length,")"]}),c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),R&&c.jsxs("div",{className:"absolute right-0 mt-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[c.jsxs("div",{className:"p-2 border-b border-gray-100 flex justify-between",children:[c.jsx("button",{onClick:me,className:"text-xs text-primary-600 hover:underline",children:"Select All"}),c.jsx("button",{onClick:de,className:"text-xs text-gray-500 hover:underline",children:"Deselect All"})]}),c.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Zt.map(pe=>{var q;return c.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:a.indices.includes(pe),onChange:()=>ge(pe),className:"rounded text-primary-600 focus:ring-primary-500"}),c.jsx("span",{className:"text-sm text-gray-700",children:ye[pe]}),p&&c.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:((q=p.byIndex[pe])==null?void 0:q.toLocaleString())||0})]},pe)})})]})]}),c.jsx("button",{onClick:()=>l({hasIssues:!a.hasIssues}),className:`px-3 py-1.5 text-sm border rounded-lg ${a.hasIssues?"bg-red-100 text-red-700 border-red-300":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Issues"}),c.jsx("button",{onClick:()=>l({zeroCalories:!a.zeroCalories}),className:`px-3 py-1.5 text-sm border rounded-lg ${a.zeroCalories?"bg-orange-100 text-orange-700 border-orange-300":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Show only foods with 0 calories",children:"0 Cal"}),c.jsx("button",{onClick:()=>l({hasReport:!a.hasReport}),className:`px-3 py-1.5 text-sm border rounded-lg ${a.hasReport?"bg-yellow-100 text-yellow-700 border-yellow-300":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Show only foods with user reports",children:" Reports"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[u.length>0&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-primary-50 text-primary-700 rounded-lg",children:[c.jsxs("span",{className:"text-sm font-medium",children:[u.length," selected"]}),c.jsx("button",{onClick:h,className:"text-primary-600 hover:text-primary-800",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i&&c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>T(!S),disabled:o,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),c.jsx("span",{className:"text-sm font-medium",children:"Move To"}),c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),S&&!o&&c.jsxs("div",{className:"absolute left-0 mt-1 w-56 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[c.jsx("div",{className:"p-2 border-b border-gray-100",children:c.jsxs("p",{className:"text-xs text-gray-600 font-medium",children:["Move ",u.length," food(s) to:"]})}),c.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Zt.map(pe=>{var q;return c.jsxs("button",{onClick:()=>{i(pe),T(!1)},className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-blue-50 rounded transition-colors",children:[ye[pe],p&&c.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",((q=p.byIndex[pe])==null?void 0:q.toLocaleString())||0," foods)"]})]},pe)})})]})]}),c.jsxs("button",{onClick:s,disabled:n,className:"flex items-center gap-2 px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),c.jsx("span",{className:"text-sm font-medium",children:"Delete"})]})]}),c.jsx("button",{onClick:t,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",title:"Refresh data",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),c.jsxs("button",{onClick:e,disabled:M===0||r,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${M>0?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[r?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),c.jsxs("span",{children:["Save ",M>0?`(${M})`:""]})]})]})]})})},qj=({onDetectDuplicates:e,onLookupOFF:t,onImageProcessing:s,onGoogleScraper:i,onReports:r,onMasterBuilder:n,onFoodCategorizer:o,isDetectingDuplicates:a,pendingReportsCount:l=0})=>{const{stats:u,duplicateGroups:h,filters:p,setFilters:g,getFilteredFoods:m,selectedFoodIds:C}=Yo(),y=m(),R=y.filter(T=>T._reviewFlags.length>0).length,x={verified_foods:"bg-green-500",foods:"bg-blue-500",manual_foods:"bg-purple-500",user_added:"bg-yellow-500",ai_enhanced:"bg-pink-500",ai_manually_added:"bg-indigo-500",tesco_products:"bg-orange-500",uk_foods_cleaned:"bg-cyan-500",fast_foods_database:"bg-red-500",generic_database:"bg-gray-500",consumer_foods:"bg-teal-500"},S={verified_foods:"Verified",foods:"Foods",manual_foods:"Manual",user_added:"User",ai_enhanced:"AI",ai_manually_added:"AI Manual",tesco_products:"Tesco",uk_foods_cleaned:"UK",fast_foods_database:"Fast",generic_database:"Generic",consumer_foods:"Consumer"};return c.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[c.jsxs("div",{className:"p-4 border-b border-gray-100",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Overview"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:y.length.toLocaleString()}),c.jsx("div",{className:"text-xs text-gray-500",children:"Showing"})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(u==null?void 0:u.totalFoods.toLocaleString())||"-"}),c.jsx("div",{className:"text-xs text-gray-500",children:"Total"})]})]})]}),c.jsxs("div",{className:"p-4 border-b border-gray-100 flex-1 overflow-auto",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Indices"}),c.jsx("div",{className:"space-y-2",children:Zt.map(T=>{const I=(u==null?void 0:u.byIndex[T])||0,V=p.indices.includes(T),H=u!=null&&u.totalFoods?I/u.totalFoods*100:0;return c.jsxs("button",{onClick:()=>{V&&p.indices.length===1?g({indices:[...Zt]}):g(V?{indices:p.indices.filter(P=>P!==T)}:{indices:[T]})},className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${V?"bg-gray-100":"hover:bg-gray-50 opacity-60"}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${x[T]}`}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:S[T]})]}),c.jsx("span",{className:"text-sm text-gray-500",children:I.toLocaleString()})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:c.jsx("div",{className:`${x[T]} h-1 rounded-full transition-all`,style:{width:`${H}%`}})})]},T)})})]}),c.jsxs("div",{className:"p-4 border-b border-gray-100",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Data Quality"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-green-50 rounded-lg",children:[c.jsx("span",{className:"text-sm text-green-700",children:"Verified"}),c.jsx("span",{className:"text-sm font-medium text-green-700",children:(u==null?void 0:u.verified.toLocaleString())||0})]}),c.jsxs("button",{onClick:()=>g({hasIssues:!p.hasIssues}),className:`w-full flex items-center justify-between px-3 py-2 rounded-lg transition-colors ${p.hasIssues?"bg-red-100":"bg-red-50 hover:bg-red-100"}`,children:[c.jsx("span",{className:"text-sm text-red-700",children:"With Issues"}),c.jsx("span",{className:"text-sm font-medium text-red-700",children:R.toLocaleString()})]}),c.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-yellow-50 rounded-lg",children:[c.jsx("span",{className:"text-sm text-yellow-700",children:"Duplicates"}),c.jsx("span",{className:"text-sm font-medium text-yellow-700",children:h.length})]})]})]}),c.jsxs("div",{className:"p-4",children:[c.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Actions"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("button",{onClick:e,disabled:a,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:[a?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),c.jsx("span",{children:"Detect Duplicates"})]}),c.jsxs("button",{onClick:t,className:`w-full flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors ${C.length>0?"text-primary-700 bg-primary-50 hover:bg-primary-100":"text-gray-700 bg-gray-50 hover:bg-gray-100"}`,children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.jsx("span",{children:C.length>0?`Check UK Status (${C.length})`:"OpenFoodFacts Lookup"})]}),c.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),c.jsx("span",{children:"Add New Food"})]}),c.jsxs("button",{onClick:s,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),c.jsx("span",{children:"Image Processing"})]}),c.jsxs("button",{onClick:i,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})}),c.jsx("span",{children:"Google Image Scraper"})]}),c.jsxs("button",{onClick:r,className:`w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg transition-colors ${l>0?"text-orange-700 bg-orange-50 hover:bg-orange-100":"text-gray-700 bg-gray-50 hover:bg-gray-100"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("span",{children:"User Reports"})]}),l>0&&c.jsx("span",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold text-white bg-orange-500 rounded-full",children:l>99?"99+":l})]}),c.jsxs("button",{onClick:n,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-green-700 bg-green-50 hover:bg-green-100 rounded-lg transition-colors font-semibold",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),c.jsx("span",{children:"Master Builder"})]}),c.jsxs("button",{onClick:o,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors font-semibold",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),c.jsx("span",{children:"Food Categorizer"})]})]})]})]})},Qj=({message:e,progress:t})=>c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("svg",{className:"w-12 h-12 text-primary-600 animate-spin mx-auto",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),c.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:e}),t!==void 0&&c.jsxs("div",{className:"w-64 mx-auto",children:[c.jsxs("div",{className:"flex justify-between text-sm text-gray-500 mb-1",children:[c.jsx("span",{children:"Loading..."}),c.jsxs("span",{children:[Math.round(t),"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${t}%`}})})]})]})}),Zj="https://uk.openfoodfacts.org/api/v2",Jj="https://world.openfoodfacts.org/api/v2",OR=["en:united-kingdom","en:great-britain","en:england","en:scotland","en:wales","en:northern-ireland","en:uk"],Xj=["50","539"],GR=["tesco","sainsbury","sainsburys","sainsbury's","asda","morrisons","waitrose","aldi","lidl","co-op","coop","marks & spencer","m&s","iceland","ocado","booths","budgens","costcutter","spar","londis","nisa","premier","one stop","farmfoods","heron foods","b&m","home bargains","poundland","wilko","superdrug","boots"],e4=["en:tesco","en:sainsburys","en:asda","en:morrisons","en:waitrose","en:aldi","en:lidl","en:co-op","en:marks-and-spencer","en:iceland","en:ocado","en:boots","en:superdrug","en:holland-and-barrett"],VR=[["colour","color"],["flavour","flavor"],["fibre","fiber"],["centre","center"],["litre","liter"],["grey","gray"],["organise","organize"],["recognise","recognize"],["favourite","favorite"],["honour","honor"],["defence","defense"],["licence","license"],["stabiliser","stabilizer"],["pasteurised","pasteurized"],["homogenised","homogenized"],["flavouring","flavoring"],["colouring","coloring"],["sulphur","sulfur"],["sulphite","sulfite"]],t4=["skimmed milk","semi-skimmed","full fat milk","double cream","single cream","clotted cream","cornflour","bicarbonate of soda","caster sugar","demerara","muscovado","golden syrup","treacle","marmite","bovril","hp sauce","worcestershire","crisps","biscuit","aubergine","courgette","coriander","rocket","swede","spring onion","porridge"];function s4(e){const t=[];let s=0,i=0;const r=30;s+=r;const n=e.countries_tags||[],o=n.some(se=>OR.includes(se.toLowerCase()));o?(i+=r,t.push({signal:"Country tags include UK",matched:!0,weight:r,details:n.filter(se=>OR.includes(se.toLowerCase())).join(", ")})):t.push({signal:"Country tags include UK",matched:!1,weight:r,details:n.length>0?`Found: ${n.slice(0,3).join(", ")}`:"No country tags"});const a=25;s+=a;const l=e.code||"",u=Xj.some(se=>l.startsWith(se));u?(i+=a,t.push({signal:"UK barcode prefix (50/539)",matched:!0,weight:a,details:`Barcode: ${l}`})):t.push({signal:"UK barcode prefix (50/539)",matched:!1,weight:a,details:l?`Barcode starts with: ${l.substring(0,3)}`:"No barcode"});const h=20;s+=h;const p=(e.brands||"").toLowerCase(),g=(e.brands_tags||[]).map(se=>se.toLowerCase()),m=GR.find(se=>p.includes(se)||g.some(Ge=>Ge.includes(se.replace(/[^a-z]/g,""))));m?(i+=h,t.push({signal:"UK retailer brand",matched:!0,weight:h,details:`Matched: ${m}`})):t.push({signal:"UK retailer brand",matched:!1,weight:h,details:p||"No brand"});const C=15;s+=C;const y=e.stores_tags||[],R=e.purchase_places_tags||[],x=[...y,...R].map(se=>se.toLowerCase());x.some(se=>e4.some(Ge=>se.includes(Ge.replace("en:",""))))||x.some(se=>GR.some(Ge=>se.includes(Ge.replace(/[^a-z]/g,""))))?(i+=C,t.push({signal:"UK store/purchase location",matched:!0,weight:C,details:x.slice(0,3).join(", ")})):t.push({signal:"UK store/purchase location",matched:!1,weight:C,details:x.length>0?x.slice(0,3).join(", "):"No store data"});const T=10;s+=T;const I=((e.ingredients_text||"")+" "+(e.ingredients_text_en||"")).toLowerCase(),V=((e.product_name||"")+" "+(e.product_name_en||"")).toLowerCase(),H=I+" "+V,P=VR.filter(([se])=>H.includes(se)).map(([se])=>se),N=VR.filter(([,se])=>H.includes(se)).map(([,se])=>se);P.length>0&&P.length>=N.length?(i+=T,t.push({signal:"UK spelling patterns",matched:!0,weight:T,details:P.slice(0,3).join(", ")})):N.length>P.length?t.push({signal:"UK spelling patterns",matched:!1,weight:T,details:`US spellings found: ${N.slice(0,3).join(", ")}`}):t.push({signal:"UK spelling patterns",matched:!1,weight:T,details:"No distinctive spelling found"});const _=10;s+=_;const L=t4.filter(se=>H.includes(se.toLowerCase()));L.length>0?(i+=_,t.push({signal:"UK-specific terms",matched:!0,weight:_,details:L.slice(0,3).join(", ")})):t.push({signal:"UK-specific terms",matched:!1,weight:_,details:"No UK-specific terms found"});const M=5;s+=M;const b=e.nutriments||{},F=b.salt_100g!==void 0&&b.salt_100g>0,Z=b.sodium_100g!==void 0&&!F;F?(i+=M,t.push({signal:"Salt labeling (UK style)",matched:!0,weight:M,details:`Salt: ${b.salt_100g}g per 100g`})):Z?t.push({signal:"Salt labeling (UK style)",matched:!1,weight:M,details:"Sodium only (US style)"}):t.push({signal:"Salt labeling (UK style)",matched:!1,weight:M,details:"No salt/sodium data"});const K=10;s+=K;const ge=(e.origins||"").toLowerCase(),me=(e.origins_tags||[]).map(se=>se.toLowerCase()),de=(e.manufacturing_places||"").toLowerCase(),ye=(e.manufacturing_places_tags||[]).map(se=>se.toLowerCase()),pe=[ge,...me,de,...ye].join(" ");["united kingdom","uk","britain","england","scotland","wales","northern ireland"].some(se=>pe.includes(se))?(i+=K,t.push({signal:"UK manufacturing/origin",matched:!0,weight:K,details:pe.substring(0,50)})):t.push({signal:"UK manufacturing/origin",matched:!1,weight:K,details:pe.length>0?pe.substring(0,50):"No origin data"});const $=Math.round(i/s*100);return{isUKProduct:$>=40||o||u,confidenceScore:$,signals:t.sort((se,Ge)=>Ge.weight-se.weight)}}async function i4(e,t="UK"){var i,r,n,o,a;const s=(n=(r=(i=e.selected_images)==null?void 0:i.front)==null?void 0:r.display)==null?void 0:n.en;if(s)return{best_image_url:s,image_confidence_score:8,is_region_match:!0};if((a=(o=e.selected_images)==null?void 0:o.front)!=null&&a.display){const l=e.selected_images.front.display;for(const h of["en","uk","gb"])if(l[h])return{best_image_url:l[h],image_confidence_score:7,is_region_match:h==="en"};const u=Object.keys(l)[0];if(u&&l[u])return{best_image_url:l[u],image_confidence_score:6,is_region_match:!1}}if(e.image_front_url){const l=e.image_front_url.includes("front_en")||e.image_front_url.includes("front_uk");return{best_image_url:e.image_front_url,image_confidence_score:5,is_region_match:l}}return{best_image_url:null,image_confidence_score:0,is_region_match:!1}}async function BR(e,t="UK"){const s=e.replace(/\D/g,"");if(!s||s.length<8)return{product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:"Invalid barcode"};try{let i=await fetch(`${Zj}/product/${s}.json`),r=await i.json();if((r.status!==1||!r.product)&&(i=await fetch(`${Jj}/product/${s}.json`),r=await i.json()),r.status!==1||!r.product)return{product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:"Product not found"};const n=r.product,o=s4(n),a=await i4(n,t);return{product:n,isUKProduct:o.isUKProduct,ukConfidenceScore:o.confidenceScore,ukSignals:o.signals,bestImageUrl:a.best_image_url,imageConfidenceScore:a.image_confidence_score,isRegionMatch:a.is_region_match}}catch(i){return console.error("Error looking up product:",i),{product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:String(i)}}}function NC(e){const t=e.nutriments||{};return{name:e.product_name_en||e.product_name||"Unknown Product",brandName:e.brands||null,barcode:e.code,ingredientsText:e.ingredients_text_en||e.ingredients_text||null,calories:t["energy-kcal_100g"]||0,protein:t.proteins_100g||0,carbs:t.carbohydrates_100g||0,fat:t.fat_100g||0,saturatedFat:t["saturated-fat_100g"]??null,fiber:t.fiber_100g||0,sugar:t.sugars_100g||0,sodium:t.sodium_100g?t.sodium_100g*1e3:0,salt:t.salt_100g??null}}var HR={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN=function(e){const t=[];let s=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[s++]=r:r<2048?(t[s++]=r>>6|192,t[s++]=r&63|128):(r&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(e.charCodeAt(++i)&1023),t[s++]=r>>18|240,t[s++]=r>>12&63|128,t[s++]=r>>6&63|128,t[s++]=r&63|128):(t[s++]=r>>12|224,t[s++]=r>>6&63|128,t[s++]=r&63|128)}return t},r4=function(e){const t=[];let s=0,i=0;for(;s<e.length;){const r=e[s++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const n=e[s++];t[i++]=String.fromCharCode((r&31)<<6|n&63)}else if(r>239&&r<365){const n=e[s++],o=e[s++],a=e[s++],l=((r&7)<<18|(n&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const n=e[s++],o=e[s++];t[i++]=String.fromCharCode((r&15)<<12|(n&63)<<6|o&63)}}return t.join("")},JN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const n=e[r],o=r+1<e.length,a=o?e[r+1]:0,l=r+2<e.length,u=l?e[r+2]:0,h=n>>2,p=(n&3)<<4|a>>4;let g=(a&15)<<2|u>>6,m=u&63;l||(m=64,o||(g=64)),i.push(s[h],s[p],s[g],s[m])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ZN(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):r4(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const s=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const n=s[e.charAt(r++)],a=r<e.length?s[e.charAt(r)]:0;++r;const u=r<e.length?s[e.charAt(r)]:64;++r;const p=r<e.length?s[e.charAt(r)]:64;if(++r,n==null||a==null||u==null||p==null)throw new n4;const g=n<<2|a>>4;if(i.push(g),u!==64){const m=a<<4&240|u>>2;if(i.push(m),p!==64){const C=u<<6&192|p;i.push(C)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class n4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o4=function(e){const t=ZN(e);return JN.encodeByteArray(t,!0)},qf=function(e){return o4(e).replace(/\./g,"")},a4=function(e){try{return JN.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=()=>l4().__FIREBASE_DEFAULTS__,u4=()=>{if(typeof process>"u"||typeof HR>"u")return;const e=HR.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},d4=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&a4(e[1]);return t&&JSON.parse(t)},XN=()=>{try{return c4()||u4()||d4()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},h4=e=>{var t,s;return(s=(t=XN())===null||t===void 0?void 0:t.emulatorHosts)===null||s===void 0?void 0:s[e]},p4=e=>{const t=h4(e);if(!t)return;const s=t.lastIndexOf(":");if(s<=0||s+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(s+1),10);return t[0]==="["?[t.substring(1,s-1),i]:[t.substring(0,s),i]},e_=()=>{var e;return(e=XN())===null||e===void 0?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}wrapCallback(t){return(s,i)=>{s?this.reject(s):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(s):t(s,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f4(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},i=t||"demo-project",r=e.iat||0,n=e.sub||e.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},e);return[qf(JSON.stringify(s)),qf(JSON.stringify(o)),""].join(".")}function m4(){try{return typeof indexedDB=="object"}catch{return!1}}function v4(){return new Promise((e,t)=>{try{let s=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),s||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{s=!1},r.onerror=()=>{var n;t(((n=r.error)===null||n===void 0?void 0:n.message)||"")}}catch(s){t(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4="FirebaseError";class Iu extends Error{constructor(t,s,i){super(s),this.code=t,this.customData=i,this.name=C4,Object.setPrototypeOf(this,Iu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t_.prototype.create)}}class t_{constructor(t,s,i){this.service=t,this.serviceName=s,this.errors=i}create(t,...s){const i=s[0]||{},r=`${this.service}/${t}`,n=this.errors[t],o=n?y4(n,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Iu(r,a,i)}}function y4(e,t){return e.replace(w4,(s,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const w4=/\{\$([^}]+)}/g;function Tw(e,t){if(e===t)return!0;const s=Object.keys(e),i=Object.keys(t);for(const r of s){if(!i.includes(r))return!1;const n=e[r],o=t[r];if(jR(n)&&jR(o)){if(!Tw(n,o))return!1}else if(n!==o)return!1}for(const r of i)if(!s.includes(r))return!1;return!0}function jR(e){return e!==null&&typeof e=="object"}class kh{constructor(t,s,i){this.name=t,this.instanceFactory=s,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(t,s){this.name=t,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const s=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(s)){const i=new g4;if(this.instancesDeferred.set(s,i),this.isInitialized(s)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:s});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(t){var s;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(s=t==null?void 0:t.optional)!==null&&s!==void 0?s:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(n){if(r)return null;throw n}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(E4(t))try{this.getOrInitializeService({instanceIdentifier:La})}catch{}for(const[s,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(s);try{const n=this.getOrInitializeService({instanceIdentifier:r});i.resolve(n)}catch{}}}}clearInstance(t=La){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...t.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=La){return this.instances.has(t)}getOptions(t=La){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:s={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:s});for(const[n,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);i===a&&o.resolve(r)}return r}onInit(t,s){var i;const r=this.normalizeInstanceIdentifier(s),n=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;n.add(t),this.onInitCallbacks.set(r,n);const o=this.instances.get(r);return o&&t(o,r),()=>{n.delete(t)}}invokeOnInitCallbacks(t,s){const i=this.onInitCallbacks.get(s);if(i)for(const r of i)try{r(t,s)}catch{}}getOrInitializeService({instanceIdentifier:t,options:s={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:x4(t),options:s}),this.instances.set(t,i),this.instancesOptions.set(t,s),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=La){return this.component?this.component.multipleInstances?t:La:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function x4(e){return e===La?void 0:e}function E4(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const s=this.getProvider(t.name);if(s.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);s.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const s=new S4(t,this);return this.providers.set(t,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(zt||(zt={}));const R4={debug:zt.DEBUG,verbose:zt.VERBOSE,info:zt.INFO,warn:zt.WARN,error:zt.ERROR,silent:zt.SILENT},T4=zt.INFO,D4={[zt.DEBUG]:"log",[zt.VERBOSE]:"log",[zt.INFO]:"info",[zt.WARN]:"warn",[zt.ERROR]:"error"},P4=(e,t,...s)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),r=D4[t];if(r)console[r](`[${i}]  ${e.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class s_{constructor(t){this.name=t,this._logLevel=T4,this._logHandler=P4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in zt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?R4[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,zt.DEBUG,...t),this._logHandler(this,zt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,zt.VERBOSE,...t),this._logHandler(this,zt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,zt.INFO,...t),this._logHandler(this,zt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,zt.WARN,...t),this._logHandler(this,zt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,zt.ERROR,...t),this._logHandler(this,zt.ERROR,...t)}}const A4=(e,t)=>t.some(s=>e instanceof s);let WR,zR;function F4(){return WR||(WR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function I4(){return zR||(zR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const i_=new WeakMap,Dw=new WeakMap,r_=new WeakMap,_C=new WeakMap,vx=new WeakMap;function N4(e){const t=new Promise((s,i)=>{const r=()=>{e.removeEventListener("success",n),e.removeEventListener("error",o)},n=()=>{s(qo(e.result)),r()},o=()=>{i(e.error),r()};e.addEventListener("success",n),e.addEventListener("error",o)});return t.then(s=>{s instanceof IDBCursor&&i_.set(s,e)}).catch(()=>{}),vx.set(t,e),t}function _4(e){if(Dw.has(e))return;const t=new Promise((s,i)=>{const r=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",o),e.removeEventListener("abort",o)},n=()=>{s(),r()},o=()=>{i(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",n),e.addEventListener("error",o),e.addEventListener("abort",o)});Dw.set(e,t)}let Pw={get(e,t,s){if(e instanceof IDBTransaction){if(t==="done")return Dw.get(e);if(t==="objectStoreNames")return e.objectStoreNames||r_.get(e);if(t==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return qo(e[t])},set(e,t,s){return e[t]=s,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function k4(e){Pw=e(Pw)}function M4(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...s){const i=e.call(kC(this),t,...s);return r_.set(i,t.sort?t.sort():[t]),qo(i)}:I4().includes(e)?function(...t){return e.apply(kC(this),t),qo(i_.get(this))}:function(...t){return qo(e.apply(kC(this),t))}}function L4(e){return typeof e=="function"?M4(e):(e instanceof IDBTransaction&&_4(e),A4(e,F4())?new Proxy(e,Pw):e)}function qo(e){if(e instanceof IDBRequest)return N4(e);if(_C.has(e))return _C.get(e);const t=L4(e);return t!==e&&(_C.set(e,t),vx.set(t,e)),t}const kC=e=>vx.get(e);function O4(e,t,{blocked:s,upgrade:i,blocking:r,terminated:n}={}){const o=indexedDB.open(e,t),a=qo(o);return i&&o.addEventListener("upgradeneeded",l=>{i(qo(o.result),l.oldVersion,l.newVersion,qo(o.transaction),l)}),s&&o.addEventListener("blocked",l=>s(l.oldVersion,l.newVersion,l)),a.then(l=>{n&&l.addEventListener("close",()=>n()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const G4=["get","getKey","getAll","getAllKeys","count"],V4=["put","add","delete","clear"],MC=new Map;function UR(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(MC.get(t))return MC.get(t);const s=t.replace(/FromIndex$/,""),i=t!==s,r=V4.includes(s);if(!(s in(i?IDBIndex:IDBObjectStore).prototype)||!(r||G4.includes(s)))return;const n=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let u=l.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[s](...a),r&&l.done]))[0]};return MC.set(t,n),n}k4(e=>({...e,get:(t,s,i)=>UR(t,s)||e.get(t,s,i),has:(t,s)=>!!UR(t,s)||e.has(t,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(H4(s)){const i=s.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(s=>s).join(" ")}}function H4(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const Aw="@firebase/app",$R="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=new s_("@firebase/app"),j4="@firebase/app-compat",W4="@firebase/analytics-compat",z4="@firebase/analytics",U4="@firebase/app-check-compat",$4="@firebase/app-check",K4="@firebase/auth",Y4="@firebase/auth-compat",q4="@firebase/database",Q4="@firebase/data-connect",Z4="@firebase/database-compat",J4="@firebase/functions",X4="@firebase/functions-compat",eW="@firebase/installations",tW="@firebase/installations-compat",sW="@firebase/messaging",iW="@firebase/messaging-compat",rW="@firebase/performance",nW="@firebase/performance-compat",oW="@firebase/remote-config",aW="@firebase/remote-config-compat",lW="@firebase/storage",cW="@firebase/storage-compat",uW="@firebase/firestore",dW="@firebase/vertexai-preview",hW="@firebase/firestore-compat",pW="firebase",gW="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="[DEFAULT]",fW={[Aw]:"fire-core",[j4]:"fire-core-compat",[z4]:"fire-analytics",[W4]:"fire-analytics-compat",[$4]:"fire-app-check",[U4]:"fire-app-check-compat",[K4]:"fire-auth",[Y4]:"fire-auth-compat",[q4]:"fire-rtdb",[Q4]:"fire-data-connect",[Z4]:"fire-rtdb-compat",[J4]:"fire-fn",[X4]:"fire-fn-compat",[eW]:"fire-iid",[tW]:"fire-iid-compat",[sW]:"fire-fcm",[iW]:"fire-fcm-compat",[rW]:"fire-perf",[nW]:"fire-perf-compat",[oW]:"fire-rc",[aW]:"fire-rc-compat",[lW]:"fire-gcs",[cW]:"fire-gcs-compat",[uW]:"fire-fst",[hW]:"fire-fst-compat",[dW]:"fire-vertex","fire-js":"fire-js",[pW]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=new Map,mW=new Map,Iw=new Map;function KR(e,t){try{e.container.addComponent(t)}catch(s){so.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,s)}}function Zf(e){const t=e.name;if(Iw.has(t))return so.debug(`There were multiple attempts to register component ${t}.`),!1;Iw.set(t,e);for(const s of Qf.values())KR(s,e);for(const s of mW.values())KR(s,e);return!0}function vW(e,t){const s=e.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),e.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CW={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qo=new t_("app","Firebase",CW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yW{constructor(t,s,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},s),this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new kh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Qo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wW=gW;function n_(e,t={}){let s=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:Fw,automaticDataCollectionEnabled:!1},t),r=i.name;if(typeof r!="string"||!r)throw Qo.create("bad-app-name",{appName:String(r)});if(s||(s=e_()),!s)throw Qo.create("no-options");const n=Qf.get(r);if(n){if(Tw(s,n.options)&&Tw(i,n.config))return n;throw Qo.create("duplicate-app",{appName:r})}const o=new b4(r);for(const l of Iw.values())o.addComponent(l);const a=new yW(s,i,o);return Qf.set(r,a),a}function SW(e=Fw){const t=Qf.get(e);if(!t&&e===Fw&&e_())return n_();if(!t)throw Qo.create("no-app",{appName:e});return t}function Tc(e,t,s){var i;let r=(i=fW[e])!==null&&i!==void 0?i:e;s&&(r+=`-${s}`);const n=r.match(/\s|\//),o=t.match(/\s|\//);if(n||o){const a=[`Unable to register library "${r}" with version "${t}":`];n&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),n&&o&&a.push("and"),o&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),so.warn(a.join(" "));return}Zf(new kh(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xW="firebase-heartbeat-database",EW=1,Mh="firebase-heartbeat-store";let LC=null;function o_(){return LC||(LC=O4(xW,EW,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Mh)}catch(s){console.warn(s)}}}}).catch(e=>{throw Qo.create("idb-open",{originalErrorMessage:e.message})})),LC}async function bW(e){try{const s=(await o_()).transaction(Mh),i=await s.objectStore(Mh).get(a_(e));return await s.done,i}catch(t){if(t instanceof Iu)so.warn(t.message);else{const s=Qo.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});so.warn(s.message)}}}async function YR(e,t){try{const i=(await o_()).transaction(Mh,"readwrite");await i.objectStore(Mh).put(t,a_(e)),await i.done}catch(s){if(s instanceof Iu)so.warn(s.message);else{const i=Qo.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});so.warn(i.message)}}}function a_(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RW=1024,TW=30*24*60*60*1e3;class DW{constructor(t){this.container=t,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new AW(s),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,s;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=qR();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)===null||s===void 0?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n)?void 0:(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=TW}),this._storage.overwrite(this._heartbeatsCache))}catch(i){so.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=qR(),{heartbeatsToSend:i,unsentEntries:r}=PW(this._heartbeatsCache.heartbeats),n=qf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=s,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(s){return so.warn(s),""}}}function qR(){return new Date().toISOString().substring(0,10)}function PW(e,t=RW){const s=[];let i=e.slice();for(const r of e){const n=s.find(o=>o.agent===r.agent);if(n){if(n.dates.push(r.date),QR(s)>t){n.dates.pop();break}}else if(s.push({agent:r.agent,dates:[r.date]}),QR(s)>t){s.pop();break}i=i.slice(1)}return{heartbeatsToSend:s,unsentEntries:i}}class AW{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return m4()?v4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await bW(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var s;if(await this._canUseIndexedDBPromise){const r=await this.read();return YR(this.app,{lastSentHeartbeatDate:(s=t.lastSentHeartbeatDate)!==null&&s!==void 0?s:r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var s;if(await this._canUseIndexedDBPromise){const r=await this.read();return YR(this.app,{lastSentHeartbeatDate:(s=t.lastSentHeartbeatDate)!==null&&s!==void 0?s:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function QR(e){return qf(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FW(e){Zf(new kh("platform-logger",t=>new B4(t),"PRIVATE")),Zf(new kh("heartbeat",t=>new DW(t),"PRIVATE")),Tc(Aw,$R,e),Tc(Aw,$R,"esm2017"),Tc("fire-js","")}FW("");var IW="firebase",NW="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tc(IW,NW,"app");var ZR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var l_;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(P,N){function _(){}_.prototype=N.prototype,P.D=N.prototype,P.prototype=new _,P.prototype.constructor=P,P.C=function(L,M,b){for(var F=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)F[Z-2]=arguments[Z];return N.prototype[M].apply(L,F)}}function s(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,s),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(P,N,_){_||(_=0);var L=Array(16);if(typeof N=="string")for(var M=0;16>M;++M)L[M]=N.charCodeAt(_++)|N.charCodeAt(_++)<<8|N.charCodeAt(_++)<<16|N.charCodeAt(_++)<<24;else for(M=0;16>M;++M)L[M]=N[_++]|N[_++]<<8|N[_++]<<16|N[_++]<<24;N=P.g[0],_=P.g[1],M=P.g[2];var b=P.g[3],F=N+(b^_&(M^b))+L[0]+3614090360&4294967295;N=_+(F<<7&4294967295|F>>>25),F=b+(M^N&(_^M))+L[1]+3905402710&4294967295,b=N+(F<<12&4294967295|F>>>20),F=M+(_^b&(N^_))+L[2]+606105819&4294967295,M=b+(F<<17&4294967295|F>>>15),F=_+(N^M&(b^N))+L[3]+3250441966&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(b^_&(M^b))+L[4]+4118548399&4294967295,N=_+(F<<7&4294967295|F>>>25),F=b+(M^N&(_^M))+L[5]+1200080426&4294967295,b=N+(F<<12&4294967295|F>>>20),F=M+(_^b&(N^_))+L[6]+2821735955&4294967295,M=b+(F<<17&4294967295|F>>>15),F=_+(N^M&(b^N))+L[7]+4249261313&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(b^_&(M^b))+L[8]+1770035416&4294967295,N=_+(F<<7&4294967295|F>>>25),F=b+(M^N&(_^M))+L[9]+2336552879&4294967295,b=N+(F<<12&4294967295|F>>>20),F=M+(_^b&(N^_))+L[10]+4294925233&4294967295,M=b+(F<<17&4294967295|F>>>15),F=_+(N^M&(b^N))+L[11]+2304563134&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(b^_&(M^b))+L[12]+1804603682&4294967295,N=_+(F<<7&4294967295|F>>>25),F=b+(M^N&(_^M))+L[13]+4254626195&4294967295,b=N+(F<<12&4294967295|F>>>20),F=M+(_^b&(N^_))+L[14]+2792965006&4294967295,M=b+(F<<17&4294967295|F>>>15),F=_+(N^M&(b^N))+L[15]+1236535329&4294967295,_=M+(F<<22&4294967295|F>>>10),F=N+(M^b&(_^M))+L[1]+4129170786&4294967295,N=_+(F<<5&4294967295|F>>>27),F=b+(_^M&(N^_))+L[6]+3225465664&4294967295,b=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(b^N))+L[11]+643717713&4294967295,M=b+(F<<14&4294967295|F>>>18),F=_+(b^N&(M^b))+L[0]+3921069994&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(M^b&(_^M))+L[5]+3593408605&4294967295,N=_+(F<<5&4294967295|F>>>27),F=b+(_^M&(N^_))+L[10]+38016083&4294967295,b=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(b^N))+L[15]+3634488961&4294967295,M=b+(F<<14&4294967295|F>>>18),F=_+(b^N&(M^b))+L[4]+3889429448&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(M^b&(_^M))+L[9]+568446438&4294967295,N=_+(F<<5&4294967295|F>>>27),F=b+(_^M&(N^_))+L[14]+3275163606&4294967295,b=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(b^N))+L[3]+4107603335&4294967295,M=b+(F<<14&4294967295|F>>>18),F=_+(b^N&(M^b))+L[8]+1163531501&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(M^b&(_^M))+L[13]+2850285829&4294967295,N=_+(F<<5&4294967295|F>>>27),F=b+(_^M&(N^_))+L[2]+4243563512&4294967295,b=N+(F<<9&4294967295|F>>>23),F=M+(N^_&(b^N))+L[7]+1735328473&4294967295,M=b+(F<<14&4294967295|F>>>18),F=_+(b^N&(M^b))+L[12]+2368359562&4294967295,_=M+(F<<20&4294967295|F>>>12),F=N+(_^M^b)+L[5]+4294588738&4294967295,N=_+(F<<4&4294967295|F>>>28),F=b+(N^_^M)+L[8]+2272392833&4294967295,b=N+(F<<11&4294967295|F>>>21),F=M+(b^N^_)+L[11]+1839030562&4294967295,M=b+(F<<16&4294967295|F>>>16),F=_+(M^b^N)+L[14]+4259657740&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(_^M^b)+L[1]+2763975236&4294967295,N=_+(F<<4&4294967295|F>>>28),F=b+(N^_^M)+L[4]+1272893353&4294967295,b=N+(F<<11&4294967295|F>>>21),F=M+(b^N^_)+L[7]+4139469664&4294967295,M=b+(F<<16&4294967295|F>>>16),F=_+(M^b^N)+L[10]+3200236656&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(_^M^b)+L[13]+681279174&4294967295,N=_+(F<<4&4294967295|F>>>28),F=b+(N^_^M)+L[0]+3936430074&4294967295,b=N+(F<<11&4294967295|F>>>21),F=M+(b^N^_)+L[3]+3572445317&4294967295,M=b+(F<<16&4294967295|F>>>16),F=_+(M^b^N)+L[6]+76029189&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(_^M^b)+L[9]+3654602809&4294967295,N=_+(F<<4&4294967295|F>>>28),F=b+(N^_^M)+L[12]+3873151461&4294967295,b=N+(F<<11&4294967295|F>>>21),F=M+(b^N^_)+L[15]+530742520&4294967295,M=b+(F<<16&4294967295|F>>>16),F=_+(M^b^N)+L[2]+3299628645&4294967295,_=M+(F<<23&4294967295|F>>>9),F=N+(M^(_|~b))+L[0]+4096336452&4294967295,N=_+(F<<6&4294967295|F>>>26),F=b+(_^(N|~M))+L[7]+1126891415&4294967295,b=N+(F<<10&4294967295|F>>>22),F=M+(N^(b|~_))+L[14]+2878612391&4294967295,M=b+(F<<15&4294967295|F>>>17),F=_+(b^(M|~N))+L[5]+4237533241&4294967295,_=M+(F<<21&4294967295|F>>>11),F=N+(M^(_|~b))+L[12]+1700485571&4294967295,N=_+(F<<6&4294967295|F>>>26),F=b+(_^(N|~M))+L[3]+2399980690&4294967295,b=N+(F<<10&4294967295|F>>>22),F=M+(N^(b|~_))+L[10]+4293915773&4294967295,M=b+(F<<15&4294967295|F>>>17),F=_+(b^(M|~N))+L[1]+2240044497&4294967295,_=M+(F<<21&4294967295|F>>>11),F=N+(M^(_|~b))+L[8]+1873313359&4294967295,N=_+(F<<6&4294967295|F>>>26),F=b+(_^(N|~M))+L[15]+4264355552&4294967295,b=N+(F<<10&4294967295|F>>>22),F=M+(N^(b|~_))+L[6]+2734768916&4294967295,M=b+(F<<15&4294967295|F>>>17),F=_+(b^(M|~N))+L[13]+1309151649&4294967295,_=M+(F<<21&4294967295|F>>>11),F=N+(M^(_|~b))+L[4]+4149444226&4294967295,N=_+(F<<6&4294967295|F>>>26),F=b+(_^(N|~M))+L[11]+3174756917&4294967295,b=N+(F<<10&4294967295|F>>>22),F=M+(N^(b|~_))+L[2]+718787259&4294967295,M=b+(F<<15&4294967295|F>>>17),F=_+(b^(M|~N))+L[9]+3951481745&4294967295,P.g[0]=P.g[0]+N&4294967295,P.g[1]=P.g[1]+(M+(F<<21&4294967295|F>>>11))&4294967295,P.g[2]=P.g[2]+M&4294967295,P.g[3]=P.g[3]+b&4294967295}i.prototype.u=function(P,N){N===void 0&&(N=P.length);for(var _=N-this.blockSize,L=this.B,M=this.h,b=0;b<N;){if(M==0)for(;b<=_;)r(this,P,b),b+=this.blockSize;if(typeof P=="string"){for(;b<N;)if(L[M++]=P.charCodeAt(b++),M==this.blockSize){r(this,L),M=0;break}}else for(;b<N;)if(L[M++]=P[b++],M==this.blockSize){r(this,L),M=0;break}}this.h=M,this.o+=N},i.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var N=1;N<P.length-8;++N)P[N]=0;var _=8*this.o;for(N=P.length-8;N<P.length;++N)P[N]=_&255,_/=256;for(this.u(P),P=Array(16),N=_=0;4>N;++N)for(var L=0;32>L;L+=8)P[_++]=this.g[N]>>>L&255;return P};function n(P,N){var _=a;return Object.prototype.hasOwnProperty.call(_,P)?_[P]:_[P]=N(P)}function o(P,N){this.h=N;for(var _=[],L=!0,M=P.length-1;0<=M;M--){var b=P[M]|0;L&&b==N||(_[M]=b,L=!1)}this.g=_}var a={};function l(P){return-128<=P&&128>P?n(P,function(N){return new o([N|0],0>N?-1:0)}):new o([P|0],0>P?-1:0)}function u(P){if(isNaN(P)||!isFinite(P))return p;if(0>P)return R(u(-P));for(var N=[],_=1,L=0;P>=_;L++)N[L]=P/_|0,_*=4294967296;return new o(N,0)}function h(P,N){if(P.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(P.charAt(0)=="-")return R(h(P.substring(1),N));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=u(Math.pow(N,8)),L=p,M=0;M<P.length;M+=8){var b=Math.min(8,P.length-M),F=parseInt(P.substring(M,M+b),N);8>b?(b=u(Math.pow(N,b)),L=L.j(b).add(u(F))):(L=L.j(_),L=L.add(u(F)))}return L}var p=l(0),g=l(1),m=l(16777216);e=o.prototype,e.m=function(){if(y(this))return-R(this).m();for(var P=0,N=1,_=0;_<this.g.length;_++){var L=this.i(_);P+=(0<=L?L:4294967296+L)*N,N*=4294967296}return P},e.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(C(this))return"0";if(y(this))return"-"+R(this).toString(P);for(var N=u(Math.pow(P,6)),_=this,L="";;){var M=I(_,N).g;_=x(_,M.j(N));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(P);if(_=M,C(_))return b+L;for(;6>b.length;)b="0"+b;L=b+L}},e.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function C(P){if(P.h!=0)return!1;for(var N=0;N<P.g.length;N++)if(P.g[N]!=0)return!1;return!0}function y(P){return P.h==-1}e.l=function(P){return P=x(this,P),y(P)?-1:C(P)?0:1};function R(P){for(var N=P.g.length,_=[],L=0;L<N;L++)_[L]=~P.g[L];return new o(_,~P.h).add(g)}e.abs=function(){return y(this)?R(this):this},e.add=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0,M=0;M<=N;M++){var b=L+(this.i(M)&65535)+(P.i(M)&65535),F=(b>>>16)+(this.i(M)>>>16)+(P.i(M)>>>16);L=F>>>16,b&=65535,F&=65535,_[M]=F<<16|b}return new o(_,_[_.length-1]&-2147483648?-1:0)};function x(P,N){return P.add(R(N))}e.j=function(P){if(C(this)||C(P))return p;if(y(this))return y(P)?R(this).j(R(P)):R(R(this).j(P));if(y(P))return R(this.j(R(P)));if(0>this.l(m)&&0>P.l(m))return u(this.m()*P.m());for(var N=this.g.length+P.g.length,_=[],L=0;L<2*N;L++)_[L]=0;for(L=0;L<this.g.length;L++)for(var M=0;M<P.g.length;M++){var b=this.i(L)>>>16,F=this.i(L)&65535,Z=P.i(M)>>>16,K=P.i(M)&65535;_[2*L+2*M]+=F*K,S(_,2*L+2*M),_[2*L+2*M+1]+=b*K,S(_,2*L+2*M+1),_[2*L+2*M+1]+=F*Z,S(_,2*L+2*M+1),_[2*L+2*M+2]+=b*Z,S(_,2*L+2*M+2)}for(L=0;L<N;L++)_[L]=_[2*L+1]<<16|_[2*L];for(L=N;L<2*N;L++)_[L]=0;return new o(_,0)};function S(P,N){for(;(P[N]&65535)!=P[N];)P[N+1]+=P[N]>>>16,P[N]&=65535,N++}function T(P,N){this.g=P,this.h=N}function I(P,N){if(C(N))throw Error("division by zero");if(C(P))return new T(p,p);if(y(P))return N=I(R(P),N),new T(R(N.g),R(N.h));if(y(N))return N=I(P,R(N)),new T(R(N.g),N.h);if(30<P.g.length){if(y(P)||y(N))throw Error("slowDivide_ only works with positive integers.");for(var _=g,L=N;0>=L.l(P);)_=V(_),L=V(L);var M=H(_,1),b=H(L,1);for(L=H(L,2),_=H(_,2);!C(L);){var F=b.add(L);0>=F.l(P)&&(M=M.add(_),b=F),L=H(L,1),_=H(_,1)}return N=x(P,M.j(N)),new T(M,N)}for(M=p;0<=P.l(N);){for(_=Math.max(1,Math.floor(P.m()/N.m())),L=Math.ceil(Math.log(_)/Math.LN2),L=48>=L?1:Math.pow(2,L-48),b=u(_),F=b.j(N);y(F)||0<F.l(P);)_-=L,b=u(_),F=b.j(N);C(b)&&(b=g),M=M.add(b),P=x(P,F)}return new T(M,P)}e.A=function(P){return I(this,P).h},e.and=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0;L<N;L++)_[L]=this.i(L)&P.i(L);return new o(_,this.h&P.h)},e.or=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0;L<N;L++)_[L]=this.i(L)|P.i(L);return new o(_,this.h|P.h)},e.xor=function(P){for(var N=Math.max(this.g.length,P.g.length),_=[],L=0;L<N;L++)_[L]=this.i(L)^P.i(L);return new o(_,this.h^P.h)};function V(P){for(var N=P.g.length+1,_=[],L=0;L<N;L++)_[L]=P.i(L)<<1|P.i(L-1)>>>31;return new o(_,P.h)}function H(P,N){var _=N>>5;N%=32;for(var L=P.g.length-_,M=[],b=0;b<L;b++)M[b]=0<N?P.i(b+_)>>>N|P.i(b+_+1)<<32-N:P.i(b+_);return new o(M,P.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,l_=o}).apply(typeof ZR<"u"?ZR:typeof self<"u"?self:typeof window<"u"?window:{});var ug=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,v,D){return d==Array.prototype||d==Object.prototype||(d[v]=D.value),d};function s(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof ug=="object"&&ug];for(var v=0;v<d.length;++v){var D=d[v];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var i=s(this);function r(d,v){if(v)e:{var D=i;d=d.split(".");for(var G=0;G<d.length-1;G++){var ee=d[G];if(!(ee in D))break e;D=D[ee]}d=d[d.length-1],G=D[d],v=v(G),v!=G&&v!=null&&t(D,d,{configurable:!0,writable:!0,value:v})}}function n(d,v){d instanceof String&&(d+="");var D=0,G=!1,ee={next:function(){if(!G&&D<d.length){var ue=D++;return{value:v(ue,d[ue]),done:!1}}return G=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}r("Array.prototype.values",function(d){return d||function(){return n(this,function(v,D){return D})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(d){var v=typeof d;return v=v!="object"?v:d?Array.isArray(d)?"array":v:"null",v=="array"||v=="object"&&typeof d.length=="number"}function u(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function h(d,v,D){return d.call.apply(d.bind,arguments)}function p(d,v,D){if(!d)throw Error();if(2<arguments.length){var G=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,G),d.apply(v,ee)}}return function(){return d.apply(v,arguments)}}function g(d,v,D){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,g.apply(null,arguments)}function m(d,v){var D=Array.prototype.slice.call(arguments,1);return function(){var G=D.slice();return G.push.apply(G,arguments),d.apply(this,G)}}function C(d,v){function D(){}D.prototype=v.prototype,d.aa=v.prototype,d.prototype=new D,d.prototype.constructor=d,d.Qb=function(G,ee,ue){for(var Be=Array(arguments.length-2),Ut=2;Ut<arguments.length;Ut++)Be[Ut-2]=arguments[Ut];return v.prototype[ee].apply(G,Be)}}function y(d){const v=d.length;if(0<v){const D=Array(v);for(let G=0;G<v;G++)D[G]=d[G];return D}return[]}function R(d,v){for(let D=1;D<arguments.length;D++){const G=arguments[D];if(l(G)){const ee=d.length||0,ue=G.length||0;d.length=ee+ue;for(let Be=0;Be<ue;Be++)d[ee+Be]=G[Be]}else d.push(G)}}class x{constructor(v,D){this.i=v,this.j=D,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function S(d){return/^[\s\xa0]*$/.test(d)}function T(){var d=a.navigator;return d&&(d=d.userAgent)?d:""}function I(d){return I[" "](d),d}I[" "]=function(){};var V=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function H(d,v,D){for(const G in d)v.call(D,d[G],G,d)}function P(d,v){for(const D in d)v.call(void 0,d[D],D,d)}function N(d){const v={};for(const D in d)v[D]=d[D];return v}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(d,v){let D,G;for(let ee=1;ee<arguments.length;ee++){G=arguments[ee];for(D in G)d[D]=G[D];for(let ue=0;ue<_.length;ue++)D=_[ue],Object.prototype.hasOwnProperty.call(G,D)&&(d[D]=G[D])}}function M(d){var v=1;d=d.split(":");const D=[];for(;0<v&&d.length;)D.push(d.shift()),v--;return d.length&&D.push(d.join(":")),D}function b(d){a.setTimeout(()=>{throw d},0)}function F(){var d=ye;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class Z{constructor(){this.h=this.g=null}add(v,D){const G=K.get();G.set(v,D),this.h?this.h.next=G:this.g=G,this.h=G}}var K=new x(()=>new ge,d=>d.reset());class ge{constructor(){this.next=this.g=this.h=null}set(v,D){this.h=v,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let me,de=!1,ye=new Z,pe=()=>{const d=a.Promise.resolve(void 0);me=()=>{d.then(q)}};var q=()=>{for(var d;d=F();){try{d.h.call(d.g)}catch(D){b(D)}var v=K;v.j(d),100>v.h&&(v.h++,d.next=v.g,v.g=d)}de=!1};function ve(){this.s=this.s,this.C=this.C}ve.prototype.s=!1,ve.prototype.ma=function(){this.s||(this.s=!0,this.N())},ve.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var be=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const D=()=>{};a.addEventListener("test",D,v),a.removeEventListener("test",D,v)}catch{}return d}();function se(d,v){if($.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var D=this.type=d.type,G=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget){if(V){e:{try{I(v.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(v=null)}}else D=="mouseover"?v=d.fromElement:D=="mouseout"&&(v=d.toElement);this.relatedTarget=v,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Ge[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&se.aa.h.call(this)}}C(se,$);var Ge={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Re="closure_listenable_"+(1e6*Math.random()|0),U=0;function J(d,v,D,G,ee){this.listener=d,this.proxy=null,this.src=v,this.type=D,this.capture=!!G,this.ha=ee,this.key=++U,this.da=this.fa=!1}function ce(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Y(d){this.src=d,this.g={},this.h=0}Y.prototype.add=function(d,v,D,G,ee){var ue=d.toString();d=this.g[ue],d||(d=this.g[ue]=[],this.h++);var Be=he(d,v,G,ee);return-1<Be?(v=d[Be],D||(v.fa=!1)):(v=new J(v,this.src,ue,!!G,ee),v.fa=D,d.push(v)),v};function te(d,v){var D=v.type;if(D in d.g){var G=d.g[D],ee=Array.prototype.indexOf.call(G,v,void 0),ue;(ue=0<=ee)&&Array.prototype.splice.call(G,ee,1),ue&&(ce(v),d.g[D].length==0&&(delete d.g[D],d.h--))}}function he(d,v,D,G){for(var ee=0;ee<d.length;++ee){var ue=d[ee];if(!ue.da&&ue.listener==v&&ue.capture==!!D&&ue.ha==G)return ee}return-1}var Ae="closure_lm_"+(1e6*Math.random()|0),fe={};function k(d,v,D,G,ee){if(Array.isArray(v)){for(var ue=0;ue<v.length;ue++)k(d,v[ue],D,G,ee);return null}return D=Me(D),d&&d[Re]?d.K(v,D,u(G)?!!G.capture:!1,ee):O(d,v,D,!1,G,ee)}function O(d,v,D,G,ee,ue){if(!v)throw Error("Invalid event type");var Be=u(ee)?!!ee.capture:!!ee,Ut=re(d);if(Ut||(d[Ae]=Ut=new Y(d)),D=Ut.add(v,D,G,Be,ue),D.proxy)return D;if(G=W(),D.proxy=G,G.src=d,G.listener=D,d.addEventListener)be||(ee=Be),ee===void 0&&(ee=!1),d.addEventListener(v.toString(),G,ee);else if(d.attachEvent)d.attachEvent(X(v.toString()),G);else if(d.addListener&&d.removeListener)d.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return D}function W(){function d(D){return v.call(d.src,d.listener,D)}const v=Q;return d}function le(d,v,D,G,ee){if(Array.isArray(v))for(var ue=0;ue<v.length;ue++)le(d,v[ue],D,G,ee);else G=u(G)?!!G.capture:!!G,D=Me(D),d&&d[Re]?(d=d.i,v=String(v).toString(),v in d.g&&(ue=d.g[v],D=he(ue,D,G,ee),-1<D&&(ce(ue[D]),Array.prototype.splice.call(ue,D,1),ue.length==0&&(delete d.g[v],d.h--)))):d&&(d=re(d))&&(v=d.g[v.toString()],d=-1,v&&(d=he(v,D,G,ee)),(D=-1<d?v[d]:null)&&ne(D))}function ne(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Re])te(v.i,d);else{var D=d.type,G=d.proxy;v.removeEventListener?v.removeEventListener(D,G,d.capture):v.detachEvent?v.detachEvent(X(D),G):v.addListener&&v.removeListener&&v.removeListener(G),(D=re(v))?(te(D,d),D.h==0&&(D.src=null,v[Ae]=null)):ce(d)}}}function X(d){return d in fe?fe[d]:fe[d]="on"+d}function Q(d,v){if(d.da)d=!0;else{v=new se(v,this);var D=d.listener,G=d.ha||d.src;d.fa&&ne(d),d=D.call(G,v)}return d}function re(d){return d=d[Ae],d instanceof Y?d:null}var Se="__closure_events_fn_"+(1e9*Math.random()>>>0);function Me(d){return typeof d=="function"?d:(d[Se]||(d[Se]=function(v){return d.handleEvent(v)}),d[Se])}function Ne(){ve.call(this),this.i=new Y(this),this.M=this,this.F=null}C(Ne,ve),Ne.prototype[Re]=!0,Ne.prototype.removeEventListener=function(d,v,D,G){le(this,d,v,D,G)};function Pe(d,v){var D,G=d.F;if(G)for(D=[];G;G=G.F)D.push(G);if(d=d.M,G=v.type||v,typeof v=="string")v=new $(v,d);else if(v instanceof $)v.target=v.target||d;else{var ee=v;v=new $(G,d),L(v,ee)}if(ee=!0,D)for(var ue=D.length-1;0<=ue;ue--){var Be=v.g=D[ue];ee=We(Be,G,!0,v)&&ee}if(Be=v.g=d,ee=We(Be,G,!0,v)&&ee,ee=We(Be,G,!1,v)&&ee,D)for(ue=0;ue<D.length;ue++)Be=v.g=D[ue],ee=We(Be,G,!1,v)&&ee}Ne.prototype.N=function(){if(Ne.aa.N.call(this),this.i){var d=this.i,v;for(v in d.g){for(var D=d.g[v],G=0;G<D.length;G++)ce(D[G]);delete d.g[v],d.h--}}this.F=null},Ne.prototype.K=function(d,v,D,G){return this.i.add(String(d),v,!1,D,G)},Ne.prototype.L=function(d,v,D,G){return this.i.add(String(d),v,!0,D,G)};function We(d,v,D,G){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();for(var ee=!0,ue=0;ue<v.length;++ue){var Be=v[ue];if(Be&&!Be.da&&Be.capture==D){var Ut=Be.listener,Vs=Be.ha||Be.src;Be.fa&&te(d.i,Be),ee=Ut.call(Vs,G)!==!1&&ee}}return ee&&!G.defaultPrevented}function Ye(d,v,D){if(typeof d=="function")D&&(d=g(d,D));else if(d&&typeof d.handleEvent=="function")d=g(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:a.setTimeout(d,v||0)}function Ke(d){d.g=Ye(()=>{d.g=null,d.i&&(d.i=!1,Ke(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class ie extends ve{constructor(v,D){super(),this.m=v,this.l=D,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Ke(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dt(d){ve.call(this),this.h=d,this.g={}}C(Dt,ve);var Fs=[];function $t(d){H(d.g,function(v,D){this.g.hasOwnProperty(D)&&ne(v)},d),d.g={}}Dt.prototype.N=function(){Dt.aa.N.call(this),$t(this)},Dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bt=a.JSON.stringify,dr=a.JSON.parse,Sa=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function hr(){}hr.prototype.h=null;function Rs(d){return d.h||(d.h=d.i())}function Wl(){}var ln={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function po(){$.call(this,"d")}C(po,$);function go(){$.call(this,"c")}C(go,$);var _r={},xa=null;function Ea(){return xa=xa||new Ne}_r.La="serverreachability";function ba(d){$.call(this,_r.La,d)}C(ba,$);function kr(d){const v=Ea();Pe(v,new ba(v))}_r.STAT_EVENT="statevent";function ni(d,v){$.call(this,_r.STAT_EVENT,d),this.stat=v}C(ni,$);function os(d){const v=Ea();Pe(v,new ni(v,d))}_r.Ma="timingevent";function Ki(d,v){$.call(this,_r.Ma,d),this.size=v}C(Ki,$);function Mr(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},v)}function Gs(){this.g=!0}Gs.prototype.xa=function(){this.g=!1};function Is(d,v,D,G,ee,ue){d.info(function(){if(d.g)if(ue)for(var Be="",Ut=ue.split("&"),Vs=0;Vs<Ut.length;Vs++){var Mt=Ut[Vs].split("=");if(1<Mt.length){var Ys=Mt[0];Mt=Mt[1];var qs=Ys.split("_");Be=2<=qs.length&&qs[1]=="type"?Be+(Ys+"="+Mt+"&"):Be+(Ys+"=redacted&")}}else Be=null;else Be=ue;return"XMLHTTP REQ ("+G+") [attempt "+ee+"]: "+v+`
`+D+`
`+Be})}function Lr(d,v,D,G,ee,ue,Be){d.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+ee+"]: "+v+`
`+D+`
`+ue+" "+Be})}function pr(d,v,D,G){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+xv(d,D)+(G?" "+G:"")})}function Sv(d,v){d.info(function(){return"TIMEOUT: "+v})}Gs.prototype.info=function(){};function xv(d,v){if(!d.g)return v;if(!v)return null;try{var D=JSON.parse(v);if(D){for(d=0;d<D.length;d++)if(Array.isArray(D[d])){var G=D[d];if(!(2>G.length)){var ee=G[1];if(Array.isArray(ee)&&!(1>ee.length)){var ue=ee[0];if(ue!="noop"&&ue!="stop"&&ue!="close")for(var Be=1;Be<ee.length;Be++)ee[Be]=""}}}}return bt(D)}catch{return v}}var Lu={NO_ERROR:0,TIMEOUT:8},Ev={},B;function oe(){}C(oe,hr),oe.prototype.g=function(){return new XMLHttpRequest},oe.prototype.i=function(){return{}},B=new oe;function j(d,v,D,G){this.j=d,this.i=v,this.l=D,this.R=G||1,this.U=new Dt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new De}function De(){this.i=null,this.g="",this.h=!1}var ae={},ze={};function Te(d,v,D){d.L=1,d.v=Fp(kn(v)),d.m=D,d.P=!0,_e(d,null)}function _e(d,v){d.F=Date.now(),Ct(d),d.A=kn(d.v);var D=d.A,G=d.R;Array.isArray(G)||(G=[String(G)]),Nx(D.i,"t",G),d.C=0,D=d.j.J,d.h=new De,d.g=Qx(d.j,D?v:null,!d.m),0<d.O&&(d.M=new ie(g(d.Y,d,d.g),d.O)),v=d.U,D=d.g,G=d.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(Fs[0]=ee.toString()),ee=Fs);for(var ue=0;ue<ee.length;ue++){var Be=k(D,ee[ue],G||v.handleEvent,!1,v.h||v);if(!Be)break;v.g[Be.key]=Be}v=d.H?N(d.H):{},d.m?(d.u||(d.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,v)):(d.u="GET",d.g.ea(d.A,d.u,null,v)),kr(),Is(d.i,d.u,d.A,d.l,d.R,d.m)}j.prototype.ca=function(d){d=d.target;const v=this.M;v&&Mn(d)==3?v.j():this.Y(d)},j.prototype.Y=function(d){try{if(d==this.g)e:{const qs=Mn(this.g);var v=this.g.Ba();const Yl=this.g.Z();if(!(3>qs)&&(qs!=3||this.g&&(this.h.h||this.g.oa()||Vx(this.g)))){this.J||qs!=4||v==7||(v==8||0>=Yl?kr(3):kr(2)),pt(this);var D=this.g.Z();this.X=D;t:if(Xe(this)){var G=Vx(this.g);d="";var ee=G.length,ue=Mn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ke(this),Qe(this);var Be="";break t}this.h.i=new a.TextDecoder}for(v=0;v<ee;v++)this.h.h=!0,d+=this.h.i.decode(G[v],{stream:!(ue&&v==ee-1)});G.length=0,this.h.g+=d,this.C=0,Be=this.h.g}else Be=this.g.oa();if(this.o=D==200,Lr(this.i,this.u,this.A,this.l,this.R,qs,D),this.o){if(this.T&&!this.K){t:{if(this.g){var Ut,Vs=this.g;if((Ut=Vs.g?Vs.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Ut)){var Mt=Ut;break t}}Mt=null}if(D=Mt)pr(this.i,this.l,D,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ve(this,D);else{this.o=!1,this.s=3,os(12),ke(this),Qe(this);break e}}if(this.P){D=!0;let Or;for(;!this.J&&this.C<Be.length;)if(Or=et(this,Be),Or==ze){qs==4&&(this.s=4,os(14),D=!1),pr(this.i,this.l,null,"[Incomplete Response]");break}else if(Or==ae){this.s=4,os(15),pr(this.i,this.l,Be,"[Invalid Chunk]"),D=!1;break}else pr(this.i,this.l,Or,null),Ve(this,Or);if(Xe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qs!=4||Be.length!=0||this.h.h||(this.s=1,os(16),D=!1),this.o=this.o&&D,!D)pr(this.i,this.l,Be,"[Invalid Chunked Response]"),ke(this),Qe(this);else if(0<Be.length&&!this.W){this.W=!0;var Ys=this.j;Ys.g==this&&Ys.ba&&!Ys.M&&(Ys.j.info("Great, no buffering proxy detected. Bytes received: "+Be.length),Pv(Ys),Ys.M=!0,os(11))}}else pr(this.i,this.l,Be,null),Ve(this,Be);qs==4&&ke(this),this.o&&!this.J&&(qs==4?$x(this.j,this):(this.o=!1,Ct(this)))}else pk(this.g),D==400&&0<Be.indexOf("Unknown SID")?(this.s=3,os(12)):(this.s=0,os(13)),ke(this),Qe(this)}}}catch{}finally{}};function Xe(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function et(d,v){var D=d.C,G=v.indexOf(`
`,D);return G==-1?ze:(D=Number(v.substring(D,G)),isNaN(D)?ae:(G+=1,G+D>v.length?ze:(v=v.slice(G,G+D),d.C=G+D,v)))}j.prototype.cancel=function(){this.J=!0,ke(this)};function Ct(d){d.S=Date.now()+d.I,St(d,d.I)}function St(d,v){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Mr(g(d.ba,d),v)}function pt(d){d.B&&(a.clearTimeout(d.B),d.B=null)}j.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(Sv(this.i,this.A),this.L!=2&&(kr(),os(17)),ke(this),this.s=2,Qe(this)):St(this,this.S-d)};function Qe(d){d.j.G==0||d.J||$x(d.j,d)}function ke(d){pt(d);var v=d.M;v&&typeof v.ma=="function"&&v.ma(),d.M=null,$t(d.U),d.g&&(v=d.g,d.g=null,v.abort(),v.ma())}function Ve(d,v){try{var D=d.j;if(D.G!=0&&(D.g==d||zl(D.h,d))){if(!d.K&&zl(D.h,d)&&D.G==3){try{var G=D.Da.g.parse(v)}catch{G=null}if(Array.isArray(G)&&G.length==3){var ee=G;if(ee[0]==0){e:if(!D.u){if(D.g)if(D.g.F+3e3<d.F)Lp(D),kp(D);else break e;Dv(D),os(18)}}else D.za=ee[1],0<D.za-D.T&&37500>ee[2]&&D.F&&D.v==0&&!D.C&&(D.C=Mr(g(D.Za,D),6e3));if(1>=ai(D.h)&&D.ca){try{D.ca()}catch{}D.ca=void 0}}else Da(D,11)}else if((d.K||D.g==d)&&Lp(D),!S(v))for(ee=D.Da.g.parse(v),v=0;v<ee.length;v++){let Mt=ee[v];if(D.T=Mt[0],Mt=Mt[1],D.G==2)if(Mt[0]=="c"){D.K=Mt[1],D.ia=Mt[2];const Ys=Mt[3];Ys!=null&&(D.la=Ys,D.j.info("VER="+D.la));const qs=Mt[4];qs!=null&&(D.Aa=qs,D.j.info("SVER="+D.Aa));const Yl=Mt[5];Yl!=null&&typeof Yl=="number"&&0<Yl&&(G=1.5*Yl,D.L=G,D.j.info("backChannelRequestTimeoutMs_="+G)),G=D;const Or=d.g;if(Or){const Op=Or.g?Or.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Op){var ue=G.h;ue.g||Op.indexOf("spdy")==-1&&Op.indexOf("quic")==-1&&Op.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(jt(ue,ue.h),ue.h=null))}if(G.D){const Av=Or.g?Or.g.getResponseHeader("X-HTTP-Session-Id"):null;Av&&(G.ya=Av,es(G.I,G.D,Av))}}D.G=3,D.l&&D.l.ua(),D.ba&&(D.R=Date.now()-d.F,D.j.info("Handshake RTT: "+D.R+"ms")),G=D;var Be=d;if(G.qa=qx(G,G.J?G.ia:null,G.W),Be.K){bv(G.h,Be);var Ut=Be,Vs=G.L;Vs&&(Ut.I=Vs),Ut.B&&(pt(Ut),Ct(Ut)),G.g=Be}else zx(G);0<D.i.length&&Mp(D)}else Mt[0]!="stop"&&Mt[0]!="close"||Da(D,7);else D.G==3&&(Mt[0]=="stop"||Mt[0]=="close"?Mt[0]=="stop"?Da(D,7):Tv(D):Mt[0]!="noop"&&D.l&&D.l.ta(Mt),D.v=0)}}kr(4)}catch{}}var He=class{constructor(d,v){this.g=d,this.map=v}};function gt(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function oi(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ai(d){return d.h?1:d.g?d.g.size:0}function zl(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function jt(d,v){d.g?d.g.add(v):d.h=v}function bv(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}gt.prototype.cancel=function(){if(this.i=Ra(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Ra(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const D of d.g.values())v=v.concat(D.D);return v}return y(d.i)}function Ul(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var v=[],D=d.length,G=0;G<D;G++)v.push(d[G]);return v}v=[],D=0;for(G in d)v[D++]=d[G];return v}function Ou(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var v=[];d=d.length;for(var D=0;D<d;D++)v.push(D);return v}v=[],D=0;for(const G in d)v[D++]=G;return v}}}function Gu(d,v){if(d.forEach&&typeof d.forEach=="function")d.forEach(v,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,v,void 0);else for(var D=Ou(d),G=Ul(d),ee=G.length,ue=0;ue<ee;ue++)v.call(void 0,G[ue],D&&D[ue],d)}var Bt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Di(d,v){if(d){d=d.split("&");for(var D=0;D<d.length;D++){var G=d[D].indexOf("="),ee=null;if(0<=G){var ue=d[D].substring(0,G);ee=d[D].substring(G+1)}else ue=d[D];v(ue,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Ta(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ta){this.h=d.h,Pp(this,d.j),this.o=d.o,this.g=d.g,Ap(this,d.s),this.l=d.l;var v=d.i,D=new Hu;D.i=v.i,v.g&&(D.g=new Map(v.g),D.h=v.h),Px(this,D),this.m=d.m}else d&&(v=String(d).match(Bt))?(this.h=!1,Pp(this,v[1]||"",!0),this.o=Vu(v[2]||""),this.g=Vu(v[3]||"",!0),Ap(this,v[4]),this.l=Vu(v[5]||"",!0),Px(this,v[6]||"",!0),this.m=Vu(v[7]||"")):(this.h=!1,this.i=new Hu(null,this.h))}Ta.prototype.toString=function(){var d=[],v=this.j;v&&d.push(Bu(v,Ax,!0),":");var D=this.g;return(D||v=="file")&&(d.push("//"),(v=this.o)&&d.push(Bu(v,Ax,!0),"@"),d.push(encodeURIComponent(String(D)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.s,D!=null&&d.push(":",String(D))),(D=this.l)&&(this.g&&D.charAt(0)!="/"&&d.push("/"),d.push(Bu(D,D.charAt(0)=="/"?ik:sk,!0))),(D=this.i.toString())&&d.push("?",D),(D=this.m)&&d.push("#",Bu(D,nk)),d.join("")};function kn(d){return new Ta(d)}function Pp(d,v,D){d.j=D?Vu(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function Ap(d,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);d.s=v}else d.s=null}function Px(d,v,D){v instanceof Hu?(d.i=v,ok(d.i,d.h)):(D||(v=Bu(v,rk)),d.i=new Hu(v,d.h))}function es(d,v,D){d.i.set(v,D)}function Fp(d){return es(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Vu(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Bu(d,v,D){return typeof d=="string"?(d=encodeURI(d).replace(v,tk),D&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function tk(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Ax=/[#\/\?@]/g,sk=/[#\?:]/g,ik=/[#\?]/g,rk=/[#\?@]/g,nk=/#/g;function Hu(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function fo(d){d.g||(d.g=new Map,d.h=0,d.i&&Di(d.i,function(v,D){d.add(decodeURIComponent(v.replace(/\+/g," ")),D)}))}e=Hu.prototype,e.add=function(d,v){fo(this),this.i=null,d=$l(this,d);var D=this.g.get(d);return D||this.g.set(d,D=[]),D.push(v),this.h+=1,this};function Fx(d,v){fo(d),v=$l(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Ix(d,v){return fo(d),v=$l(d,v),d.g.has(v)}e.forEach=function(d,v){fo(this),this.g.forEach(function(D,G){D.forEach(function(ee){d.call(v,ee,G,this)},this)},this)},e.na=function(){fo(this);const d=Array.from(this.g.values()),v=Array.from(this.g.keys()),D=[];for(let G=0;G<v.length;G++){const ee=d[G];for(let ue=0;ue<ee.length;ue++)D.push(v[G])}return D},e.V=function(d){fo(this);let v=[];if(typeof d=="string")Ix(this,d)&&(v=v.concat(this.g.get($l(this,d))));else{d=Array.from(this.g.values());for(let D=0;D<d.length;D++)v=v.concat(d[D])}return v},e.set=function(d,v){return fo(this),this.i=null,d=$l(this,d),Ix(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},e.get=function(d,v){return d?(d=this.V(d),0<d.length?String(d[0]):v):v};function Nx(d,v,D){Fx(d,v),0<D.length&&(d.i=null,d.g.set($l(d,v),y(D)),d.h+=D.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(var D=0;D<v.length;D++){var G=v[D];const ue=encodeURIComponent(String(G)),Be=this.V(G);for(G=0;G<Be.length;G++){var ee=ue;Be[G]!==""&&(ee+="="+encodeURIComponent(String(Be[G]))),d.push(ee)}}return this.i=d.join("&")};function $l(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function ok(d,v){v&&!d.j&&(fo(d),d.i=null,d.g.forEach(function(D,G){var ee=G.toLowerCase();G!=ee&&(Fx(this,G),Nx(this,ee,D))},d)),d.j=v}function ak(d,v){const D=new Gs;if(a.Image){const G=new Image;G.onload=m(mo,D,"TestLoadImage: loaded",!0,v,G),G.onerror=m(mo,D,"TestLoadImage: error",!1,v,G),G.onabort=m(mo,D,"TestLoadImage: abort",!1,v,G),G.ontimeout=m(mo,D,"TestLoadImage: timeout",!1,v,G),a.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=d}else v(!1)}function lk(d,v){const D=new Gs,G=new AbortController,ee=setTimeout(()=>{G.abort(),mo(D,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:G.signal}).then(ue=>{clearTimeout(ee),ue.ok?mo(D,"TestPingServer: ok",!0,v):mo(D,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ee),mo(D,"TestPingServer: error",!1,v)})}function mo(d,v,D,G,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),G(D)}catch{}}function ck(){this.g=new Sa}function uk(d,v,D){const G=D||"";try{Gu(d,function(ee,ue){let Be=ee;u(ee)&&(Be=bt(ee)),v.push(G+ue+"="+encodeURIComponent(Be))})}catch(ee){throw v.push(G+"type="+encodeURIComponent("_badmap")),ee}}function Ip(d){this.l=d.Ub||null,this.j=d.eb||!1}C(Ip,hr),Ip.prototype.g=function(){return new Np(this.l,this.j)},Ip.prototype.i=function(d){return function(){return d}}({});function Np(d,v){Ne.call(this),this.D=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Np,Ne),e=Np.prototype,e.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=v,this.readyState=1,Wu(this)},e.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(v.body=d),(this.D||a).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ju(this)),this.readyState=0},e.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Wu(this)),this.g&&(this.readyState=3,Wu(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_x(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function _x(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}e.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?ju(this):Wu(this),this.readyState==3&&_x(this)}},e.Ra=function(d){this.g&&(this.response=this.responseText=d,ju(this))},e.Qa=function(d){this.g&&(this.response=d,ju(this))},e.ga=function(){this.g&&ju(this)};function ju(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Wu(d)}e.setRequestHeader=function(d,v){this.u.append(d,v)},e.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var D=v.next();!D.done;)D=D.value,d.push(D[0]+": "+D[1]),D=v.next();return d.join(`\r
`)};function Wu(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Np.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function kx(d){let v="";return H(d,function(D,G){v+=G,v+=":",v+=D,v+=`\r
`}),v}function Rv(d,v,D){e:{for(G in D){var G=!1;break e}G=!0}G||(D=kx(D),typeof d=="string"?D!=null&&encodeURIComponent(String(D)):es(d,v,D))}function ms(d){Ne.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(ms,Ne);var dk=/^https?$/i,hk=["POST","PUT"];e=ms.prototype,e.Ha=function(d){this.J=d},e.ea=function(d,v,D,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():B.g(),this.v=this.o?Rs(this.o):Rs(B),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(ue){Mx(this,ue);return}if(d=D||"",D=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var ee in G)D.set(ee,G[ee]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const ue of G.keys())D.set(ue,G.get(ue));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(D.keys()).find(ue=>ue.toLowerCase()=="content-type"),ee=a.FormData&&d instanceof a.FormData,!(0<=Array.prototype.indexOf.call(hk,v,void 0))||G||ee||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Be]of D)this.g.setRequestHeader(ue,Be);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Gx(this),this.u=!0,this.g.send(d),this.u=!1}catch(ue){Mx(this,ue)}};function Mx(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.m=5,Lx(d),_p(d)}function Lx(d){d.A||(d.A=!0,Pe(d,"complete"),Pe(d,"error"))}e.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Pe(this,"complete"),Pe(this,"abort"),_p(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_p(this,!0)),ms.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Ox(this):this.bb())},e.bb=function(){Ox(this)};function Ox(d){if(d.h&&typeof o<"u"&&(!d.v[1]||Mn(d)!=4||d.Z()!=2)){if(d.u&&Mn(d)==4)Ye(d.Ea,0,d);else if(Pe(d,"readystatechange"),Mn(d)==4){d.h=!1;try{const Be=d.Z();e:switch(Be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var D;if(!(D=v)){var G;if(G=Be===0){var ee=String(d.D).match(Bt)[1]||null;!ee&&a.self&&a.self.location&&(ee=a.self.location.protocol.slice(0,-1)),G=!dk.test(ee?ee.toLowerCase():"")}D=G}if(D)Pe(d,"complete"),Pe(d,"success");else{d.m=6;try{var ue=2<Mn(d)?d.g.statusText:""}catch{ue=""}d.l=ue+" ["+d.Z()+"]",Lx(d)}}finally{_p(d)}}}}function _p(d,v){if(d.g){Gx(d);const D=d.g,G=d.v[0]?()=>{}:null;d.g=null,d.v=null,v||Pe(d,"ready");try{D.onreadystatechange=G}catch{}}}function Gx(d){d.I&&(a.clearTimeout(d.I),d.I=null)}e.isActive=function(){return!!this.g};function Mn(d){return d.g?d.g.readyState:0}e.Z=function(){try{return 2<Mn(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),dr(v)}};function Vx(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function pk(d){const v={};d=(d.g&&2<=Mn(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<d.length;G++){if(S(d[G]))continue;var D=M(d[G]);const ee=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const ue=v[ee]||[];v[ee]=ue,ue.push(D)}P(v,function(G){return G.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zu(d,v,D){return D&&D.internalChannelParams&&D.internalChannelParams[d]||v}function Bx(d){this.Aa=0,this.i=[],this.j=new Gs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zu("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zu("baseRetryDelayMs",5e3,d),this.cb=zu("retryDelaySeedMs",1e4,d),this.Wa=zu("forwardChannelMaxRetries",2,d),this.wa=zu("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new gt(d&&d.concurrentRequestLimit),this.Da=new ck,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Bx.prototype,e.la=8,e.G=1,e.connect=function(d,v,D,G){os(0),this.W=d,this.H=v||{},D&&G!==void 0&&(this.H.OSID=D,this.H.OAID=G),this.F=this.X,this.I=qx(this,null,this.W),Mp(this)};function Tv(d){if(Hx(d),d.G==3){var v=d.U++,D=kn(d.I);if(es(D,"SID",d.K),es(D,"RID",v),es(D,"TYPE","terminate"),Uu(d,D),v=new j(d,d.j,v),v.L=2,v.v=Fp(kn(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(v.v.toString(),"")}catch{}!D&&a.Image&&(new Image().src=v.v,D=!0),D||(v.g=Qx(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Ct(v)}Yx(d)}function kp(d){d.g&&(Pv(d),d.g.cancel(),d.g=null)}function Hx(d){kp(d),d.u&&(a.clearTimeout(d.u),d.u=null),Lp(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&a.clearTimeout(d.s),d.s=null)}function Mp(d){if(!oi(d.h)&&!d.s){d.s=!0;var v=d.Ga;me||pe(),de||(me(),de=!0),ye.add(v,d),d.B=0}}function gk(d,v){return ai(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=v.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Mr(g(d.Ga,d,v),Kx(d,d.B)),d.B++,!0)}e.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const ee=new j(this,this.j,d);let ue=this.o;if(this.S&&(ue?(ue=N(ue),L(ue,this.S)):ue=this.S),this.m!==null||this.O||(ee.H=ue,ue=null),this.P)e:{for(var v=0,D=0;D<this.i.length;D++){t:{var G=this.i[D];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(v+=G,4096<v){v=D;break e}if(v===4096||D===this.i.length-1){v=D+1;break e}}v=1e3}else v=1e3;v=Wx(this,ee,v),D=kn(this.I),es(D,"RID",d),es(D,"CVER",22),this.D&&es(D,"X-HTTP-Session-Id",this.D),Uu(this,D),ue&&(this.O?v="headers="+encodeURIComponent(String(kx(ue)))+"&"+v:this.m&&Rv(D,this.m,ue)),jt(this.h,ee),this.Ua&&es(D,"TYPE","init"),this.P?(es(D,"$req",v),es(D,"SID","null"),ee.T=!0,Te(ee,D,null)):Te(ee,D,v),this.G=2}}else this.G==3&&(d?jx(this,d):this.i.length==0||oi(this.h)||jx(this))};function jx(d,v){var D;v?D=v.l:D=d.U++;const G=kn(d.I);es(G,"SID",d.K),es(G,"RID",D),es(G,"AID",d.T),Uu(d,G),d.m&&d.o&&Rv(G,d.m,d.o),D=new j(d,d.j,D,d.B+1),d.m===null&&(D.H=d.o),v&&(d.i=v.D.concat(d.i)),v=Wx(d,D,1e3),D.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),jt(d.h,D),Te(D,G,v)}function Uu(d,v){d.H&&H(d.H,function(D,G){es(v,G,D)}),d.l&&Gu({},function(D,G){es(v,G,D)})}function Wx(d,v,D){D=Math.min(d.i.length,D);var G=d.l?g(d.l.Na,d.l,d):null;e:{var ee=d.i;let ue=-1;for(;;){const Be=["count="+D];ue==-1?0<D?(ue=ee[0].g,Be.push("ofs="+ue)):ue=0:Be.push("ofs="+ue);let Ut=!0;for(let Vs=0;Vs<D;Vs++){let Mt=ee[Vs].g;const Ys=ee[Vs].map;if(Mt-=ue,0>Mt)ue=Math.max(0,ee[Vs].g-100),Ut=!1;else try{uk(Ys,Be,"req"+Mt+"_")}catch{G&&G(Ys)}}if(Ut){G=Be.join("&");break e}}}return d=d.i.splice(0,D),v.D=d,G}function zx(d){if(!d.g&&!d.u){d.Y=1;var v=d.Fa;me||pe(),de||(me(),de=!0),ye.add(v,d),d.v=0}}function Dv(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Mr(g(d.Fa,d),Kx(d,d.v)),d.v++,!0)}e.Fa=function(){if(this.u=null,Ux(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Mr(g(this.ab,this),d)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,os(10),kp(this),Ux(this))};function Pv(d){d.A!=null&&(a.clearTimeout(d.A),d.A=null)}function Ux(d){d.g=new j(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var v=kn(d.qa);es(v,"RID","rpc"),es(v,"SID",d.K),es(v,"AID",d.T),es(v,"CI",d.F?"0":"1"),!d.F&&d.ja&&es(v,"TO",d.ja),es(v,"TYPE","xmlhttp"),Uu(d,v),d.m&&d.o&&Rv(v,d.m,d.o),d.L&&(d.g.I=d.L);var D=d.g;d=d.ia,D.L=1,D.v=Fp(kn(v)),D.m=null,D.P=!0,_e(D,d)}e.Za=function(){this.C!=null&&(this.C=null,kp(this),Dv(this),os(19))};function Lp(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function $x(d,v){var D=null;if(d.g==v){Lp(d),Pv(d),d.g=null;var G=2}else if(zl(d.h,v))D=v.D,bv(d.h,v),G=1;else return;if(d.G!=0){if(v.o)if(G==1){D=v.m?v.m.length:0,v=Date.now()-v.F;var ee=d.B;G=Ea(),Pe(G,new Ki(G,D)),Mp(d)}else zx(d);else if(ee=v.s,ee==3||ee==0&&0<v.X||!(G==1&&gk(d,v)||G==2&&Dv(d)))switch(D&&0<D.length&&(v=d.h,v.i=v.i.concat(D)),ee){case 1:Da(d,5);break;case 4:Da(d,10);break;case 3:Da(d,6);break;default:Da(d,2)}}}function Kx(d,v){let D=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(D*=2),D*v}function Da(d,v){if(d.j.info("Error code "+v),v==2){var D=g(d.fb,d),G=d.Xa;const ee=!G;G=new Ta(G||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Pp(G,"https"),Fp(G),ee?ak(G.toString(),D):lk(G.toString(),D)}else os(2);d.G=0,d.l&&d.l.sa(v),Yx(d),Hx(d)}e.fb=function(d){d?(this.j.info("Successfully pinged google.com"),os(2)):(this.j.info("Failed to ping google.com"),os(1))};function Yx(d){if(d.G=0,d.ka=[],d.l){const v=Ra(d.h);(v.length!=0||d.i.length!=0)&&(R(d.ka,v),R(d.ka,d.i),d.h.i.length=0,y(d.i),d.i.length=0),d.l.ra()}}function qx(d,v,D){var G=D instanceof Ta?kn(D):new Ta(D);if(G.g!="")v&&(G.g=v+"."+G.g),Ap(G,G.s);else{var ee=a.location;G=ee.protocol,v=v?v+"."+ee.hostname:ee.hostname,ee=+ee.port;var ue=new Ta(null);G&&Pp(ue,G),v&&(ue.g=v),ee&&Ap(ue,ee),D&&(ue.l=D),G=ue}return D=d.D,v=d.ya,D&&v&&es(G,D,v),es(G,"VER",d.la),Uu(d,G),G}function Qx(d,v,D){if(v&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Ca&&!d.pa?new ms(new Ip({eb:D})):new ms(d.pa),v.Ha(d.J),v}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zx(){}e=Zx.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function gr(d,v){Ne.call(this),this.g=new Bx(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(d?d["X-WebChannel-Client-Profile"]=v.va:d={"X-WebChannel-Client-Profile":v.va}),this.g.S=d,(d=v&&v.Sb)&&!S(d)&&(this.g.m=d),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!S(v)&&(this.g.D=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Kl(this)}C(gr,Ne),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){Tv(this.g)},gr.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var D={};D.__data__=d,d=D}else this.u&&(D={},D.__data__=bt(d),d=D);v.i.push(new He(v.Ya++,d)),v.G==3&&Mp(v)},gr.prototype.N=function(){this.g.l=null,delete this.j,Tv(this.g),delete this.g,gr.aa.N.call(this)};function Jx(d){po.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const D in v){d=D;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}C(Jx,po);function Xx(){go.call(this),this.status=1}C(Xx,go);function Kl(d){this.g=d}C(Kl,Zx),Kl.prototype.ua=function(){Pe(this.g,"a")},Kl.prototype.ta=function(d){Pe(this.g,new Jx(d))},Kl.prototype.sa=function(d){Pe(this.g,new Xx)},Kl.prototype.ra=function(){Pe(this.g,"b")},gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,Lu.NO_ERROR=0,Lu.TIMEOUT=8,Lu.HTTP_ERROR=6,Ev.COMPLETE="complete",Wl.EventType=ln,ln.OPEN="a",ln.CLOSE="b",ln.ERROR="c",ln.MESSAGE="d",Ne.prototype.listen=Ne.prototype.K,ms.prototype.listenOnce=ms.prototype.L,ms.prototype.getLastError=ms.prototype.Ka,ms.prototype.getLastErrorCode=ms.prototype.Ba,ms.prototype.getStatus=ms.prototype.Z,ms.prototype.getResponseJson=ms.prototype.Oa,ms.prototype.getResponseText=ms.prototype.oa,ms.prototype.send=ms.prototype.ea,ms.prototype.setWithCredentials=ms.prototype.Ha}).apply(typeof ug<"u"?ug:typeof self<"u"?self:typeof window<"u"?window:{});const JR="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ui.UNAUTHENTICATED=new ui(null),ui.GOOGLE_CREDENTIALS=new ui("google-credentials-uid"),ui.FIRST_PARTY=new ui("first-party-uid"),ui.MOCK_USER=new ui("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tp="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ou=new s_("@firebase/firestore");function Zr(e,...t){if(ou.logLevel<=zt.DEBUG){const s=t.map(Cx);ou.debug(`Firestore (${Tp}): ${e}`,...s)}}function c_(e,...t){if(ou.logLevel<=zt.ERROR){const s=t.map(Cx);ou.error(`Firestore (${Tp}): ${e}`,...s)}}function _W(e,...t){if(ou.logLevel<=zt.WARN){const s=t.map(Cx);ou.warn(`Firestore (${Tp}): ${e}`,...s)}}function Cx(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(s){return JSON.stringify(s)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(e="Unexpected state"){const t=`FIRESTORE (${Tp}) INTERNAL ASSERTION FAILED: `+e;throw c_(t),new Error(t)}function Md(e,t){e||yx()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class _i extends Iu{constructor(t,s){super(t,s),this.code=t,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(){this.promise=new Promise((t,s)=>{this.resolve=t,this.reject=s})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(t,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class kW{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,s){t.enqueueRetryable(()=>s(ui.UNAUTHENTICATED))}shutdown(){}}class MW{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,s){this.changeListener=s,t.enqueueRetryable(()=>s(this.token.user))}shutdown(){this.changeListener=null}}class LW{constructor(t){this.t=t,this.currentUser=ui.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,s){Md(this.o===void 0);let i=this.i;const r=l=>this.i!==i?(i=this.i,s(l)):Promise.resolve();let n=new Ld;this.o=()=>{this.i++,this.currentUser=this.u(),n.resolve(),n=new Ld,t.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=n;t.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{Zr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Zr("FirebaseAuthCredentialsProvider","Auth not yet detected"),n.resolve(),n=new Ld)}},0),o()}getToken(){const t=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then(i=>this.i!==t?(Zr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Md(typeof i.accessToken=="string"),new u_(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Md(t===null||typeof t=="string"),new ui(t)}}class OW{constructor(t,s,i){this.l=t,this.h=s,this.P=i,this.type="FirstParty",this.user=ui.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class GW{constructor(t,s,i){this.l=t,this.h=s,this.P=i}getToken(){return Promise.resolve(new OW(this.l,this.h,this.P))}start(t,s){t.enqueueRetryable(()=>s(ui.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class VW{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class BW{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,s){Md(this.o===void 0);const i=n=>{n.error!=null&&Zr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${n.error.message}`);const o=n.token!==this.R;return this.R=n.token,Zr("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?s(n.token):Promise.resolve()};this.o=n=>{t.enqueueRetryable(()=>i(n))};const r=n=>{Zr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=n,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(n=>r(n)),setTimeout(()=>{if(!this.appCheck){const n=this.A.getImmediate({optional:!0});n?r(n):Zr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(s=>s?(Md(typeof s.token=="string"),this.R=s.token,new VW(s.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function HW(e){return e.name==="IndexedDbTransactionError"}class Jf{constructor(t,s){this.projectId=t,this.database=s||"(default)"}static empty(){return new Jf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof Jf&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var XR,Ft;(Ft=XR||(XR={}))[Ft.OK=0]="OK",Ft[Ft.CANCELLED=1]="CANCELLED",Ft[Ft.UNKNOWN=2]="UNKNOWN",Ft[Ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ft[Ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ft[Ft.NOT_FOUND=5]="NOT_FOUND",Ft[Ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ft[Ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ft[Ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ft[Ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ft[Ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ft[Ft.ABORTED=10]="ABORTED",Ft[Ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ft[Ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ft[Ft.INTERNAL=13]="INTERNAL",Ft[Ft.UNAVAILABLE=14]="UNAVAILABLE",Ft[Ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new l_([4294967295,4294967295],0);function OC(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jW{constructor(t,s,i=1e3,r=1.5,n=6e4){this.ui=t,this.timerId=s,this.ko=i,this.qo=r,this.Qo=n,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const s=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,s-i);r>0&&Zr("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${s} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(t,s,i,r,n){this.asyncQueue=t,this.timerId=s,this.targetTimeMs=i,this.op=r,this.removalCallback=n,this.deferred=new Ld,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,s,i,r,n){const o=Date.now()+i,a=new wx(t,s,o,r,n);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _i(Ni.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var eT,tT;(tT=eT||(eT={})).ea="default",tT.Cache="cache";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WW(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=new Map;function zW(e,t,s,i){if(t===!0&&i===!0)throw new _i(Ni.INVALID_ARGUMENT,`${e} and ${s} cannot be used together.`)}function UW(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":yx()}function $W(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new _i(Ni.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=UW(e);throw new _i(Ni.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${s}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(t){var s,i;if(t.host===void 0){if(t.ssl!==void 0)throw new _i(Ni.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(s=t.ssl)===null||s===void 0||s;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new _i(Ni.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}zW("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WW((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new _i(Ni.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new _i(Ni.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new _i(Ni.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class d_{constructor(t,s,i,r){this._authCredentials=t,this._appCheckCredentials=s,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iT({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _i(Ni.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new _i(Ni.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iT(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new kW;switch(i.type){case"firstParty":return new GW(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new _i(Ni.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(s){const i=sT.get(s);i&&(Zr("ComponentProvider","Removing Datastore"),sT.delete(s),i.terminate())}(this),Promise.resolve()}}function KW(e,t,s,i={}){var r;const n=(e=$W(e,d_))._getSettings(),o=`${t}:${s}`;if(n.host!=="firestore.googleapis.com"&&n.host!==o&&_W("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},n),{host:o,ssl:!1})),i.mockUserToken){let a,l;if(typeof i.mockUserToken=="string")a=i.mockUserToken,l=ui.MOCK_USER;else{a=f4(i.mockUserToken,(r=e._app)===null||r===void 0?void 0:r.options.projectId);const u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new _i(Ni.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ui(u)}e._authCredentials=new MW(new u_(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new jW(this,"async_queue_retry"),this.Vu=()=>{const i=OC();i&&Zr("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=t;const s=OC();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const s=OC();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const s=new Ld;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(s.resolve,s.reject),s.promise)).then(()=>s.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!HW(t))throw t;Zr("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const s=this.mu.then(()=>(this.du=!0,t().catch(i=>{this.Eu=i,this.du=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw c_("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=s,s}enqueueAfterDelay(t,s,i){this.fu(),this.Ru.indexOf(t)>-1&&(s=0);const r=wx.createAndSchedule(this,t,s,i,n=>this.yu(n));return this.Tu.push(r),r}fu(){this.Eu&&yx()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const s of this.Tu)if(s.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((s,i)=>s.targetTimeMs-i.targetTimeMs);for(const s of this.Tu)if(s.skipDelay(),t!=="all"&&s.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const s=this.Tu.indexOf(t);this.Tu.splice(s,1)}}class YW extends d_{constructor(t,s,i,r){super(t,s,i,r),this.type="firestore",this._queue=new rT,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new rT(t),this._firestoreClient=void 0,await t}}}function qW(e,t){const s=typeof e=="object"?e:SW(),i=typeof e=="string"?e:"(default)",r=vW(s,"firestore").getImmediate({identifier:i});if(!r._initialized){const n=p4("firestore");n&&KW(r,...n)}return r}(function(t,s=!0){(function(r){Tp=r})(wW),Zf(new kh("firestore",(i,{instanceIdentifier:r,options:n})=>{const o=i.getProvider("app").getImmediate(),a=new YW(new LW(i.getProvider("auth-internal")),new BW(i.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new _i(Ni.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jf(u.options.projectId,h)}(o,r),o);return n=Object.assign({useFetchStreams:s},n),a._setSettings(n),a},"PUBLIC").setMultipleInstances(!0)),Tc(JR,"4.7.3",t),Tc(JR,"4.7.3","esm2017")})();const QW={apiKey:"AIzaSyD6P4U8D1lOJ-h8-QgQ6GYTp4h9Qy7YQHM",authDomain:"nutrasafe-705c7.firebaseapp.com",projectId:"nutrasafe-705c7",storageBucket:"nutrasafe-705c7.appspot.com",messagingSenderId:"1043273165814",appId:"1:1043273165814:web:c3e98e4d8f5a6b7c8d9e0f"};let dg,nT;function ZW(){return dg||(dg=n_(QW),nT=qW(dg)),{app:dg,db:nT}}const Lh="https://us-central1-nutrasafe-705c7.cloudfunctions.net";async function yd(e,t){const{objectID:s,_hasFirestoreBacking:i,_firestoreCollection:r,_sourceIndex:n}=e,o={foodId:s,collection:i?r:n,foodName:t.name,brandName:t.brandName,barcode:t.barcode,extractedIngredients:t.ingredientsText,nutritionData:{calories:t.calories,protein:t.protein,carbs:t.carbs,fat:t.fat,saturatedFat:t.saturatedFat,fiber:t.fiber,sugar:t.sugar,sodium:t.sodium,salt:t.salt},servingSize:t.servingDescription,servingSizeG:t.servingSizeG,isPerUnit:t.isPerUnit,source:t.source};try{const l=await(await fetch(`${Lh}/updateVerifiedFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();return l.success?{success:!0}:{success:!1,error:l.error||"Unknown error"}}catch(a){return console.error("Error updating food:",a),{success:!1,error:String(a)}}}async function JW(e){var r,n;const{_sourceIndex:t,objectID:s,barcode:i}=e;try{let o=await fetch(`${Lh}/deleteFoodComprehensive`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:s,indexName:t,barcode:i,deleteFromAllIndices:!0})});o.ok||(console.log("Comprehensive delete unavailable, using single-index delete"),o=await fetch(`${Lh}/deleteFoodFromAlgolia`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:s,indexName:t})}));const a=await o.json();return a.success?(console.log(` Deleted food from ${((r=a.deletedFrom)==null?void 0:r.length)||1} location(s)`),{success:!0,deletedFrom:((n=a.deletedFrom)==null?void 0:n.length)||1}):{success:!1,error:a.error||"Unknown error"}}catch(o){return console.error("Error deleting food:",o),{success:!1,error:String(o)}}}async function XW(e){let t=0,s=0;const i=[],r=5;for(let n=0;n<e.length;n+=r){const o=e.slice(n,n+r);(await Promise.all(o.map(({food:l,updates:u})=>yd(l,u)))).forEach((l,u)=>{l.success?t++:(s++,i.push(`${o[u].food.name}: ${l.error}`))})}return{success:t,failed:s,errors:i}}async function ez(e){let t=0,s=0;const i=[],r=5;for(let n=0;n<e.length;n+=r){const o=e.slice(n,n+r);(await Promise.all(o.map(l=>JW(l)))).forEach((l,u)=>{l.success?t++:(s++,i.push(`${o[u].name}: ${l.error}`))})}return{success:t,failed:s,errors:i}}async function tz(e){try{const s=await(await fetch(`${Lh}/addVerifiedFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodName:e.name,brandName:e.brandName,barcode:e.barcode,extractedIngredients:e.ingredientsText,nutritionData:{calories:e.calories,protein:e.protein,carbs:e.carbs,fat:e.fat,saturatedFat:e.saturatedFat,fiber:e.fiber,sugar:e.sugar,sodium:e.sodium,salt:e.salt},servingSize:e.servingDescription})})).json();return s.success?{success:!0,foodId:s.foodId}:{success:!1,error:s.error||"Unknown error"}}catch(t){return console.error("Error adding food:",t),{success:!1,error:String(t)}}}async function sz(e,t){const s=new Map;e.forEach(o=>{const a=o._sourceIndex;s.has(a)||s.set(a,[]),s.get(a).push(o.objectID)});let i=0,r=0;const n=[];for(const[o,a]of s.entries()){if(o===t){console.log(`Skipping ${a.length} foods already in ${t}`),i+=a.length;continue}try{const l=await fetch(`${Lh}/moveFoodsBetweenIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodIds:a,fromIndex:o,toIndex:t})});if(!l.ok){const h=await l.text();console.error(` Move failed (HTTP ${l.status}):`,h),r+=a.length,n.push(`${o}  ${t}: HTTP ${l.status} - ${h}`);continue}const u=await l.json();if(console.log("Move result:",u),u.success)i+=u.moved||0,r+=u.failed||0,u.errors&&u.errors.length>0&&n.push(...u.errors),console.log(` Moved ${u.moved} foods from ${o} to ${t}`);else{r+=a.length;const h=u.details||u.error||"Unknown error";console.error(" Move failed:",h),n.push(`${o}  ${t}: ${h}`)}}catch(l){console.error(` Error moving foods from ${o}:`,l),r+=a.length,n.push(`${o}  ${t}: ${String(l)}`)}}return{success:i,failed:r,errors:n}}const iz="modulepreload",rz=function(e){return"/admin-v2/"+e},oT={},aT=function(t,s,i){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(s.map(l=>{if(l=rz(l),l in oT)return;oT[l]=!0;const u=l.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":iz,u||(p.as="script"),p.crossOrigin="",p.href=l,a&&p.setAttribute("nonce",a),document.head.appendChild(p),u)return new Promise((g,m)=>{p.addEventListener("load",g),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return t().catch(n)})};var nz=Object.create,h_=Object.defineProperty,oz=Object.getOwnPropertyDescriptor,p_=Object.getOwnPropertyNames,az=Object.getPrototypeOf,lz=Object.prototype.hasOwnProperty,Sx=(e,t)=>function(){return t||(0,e[p_(e)[0]])((t={exports:{}}).exports,t),t.exports},cz=(e,t,s,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of p_(t))!lz.call(e,r)&&r!==s&&h_(e,r,{get:()=>t[r],enumerable:!(i=oz(t,r))||i.enumerable});return e},vv=(e,t,s)=>(s=e!=null?nz(az(e)):{},cz(!e||!e.__esModule?h_(s,"default",{value:e,enumerable:!0}):s,e)),uz=Sx({"../../node_modules/.pnpm/iota-array@1.0.0/node_modules/iota-array/iota.js"(e,t){function s(i){for(var r=new Array(i),n=0;n<i;++n)r[n]=n;return r}t.exports=s}}),dz=Sx({"../../node_modules/.pnpm/is-buffer@1.1.6/node_modules/is-buffer/index.js"(e,t){t.exports=function(r){return r!=null&&(s(r)||i(r)||!!r._isBuffer)};function s(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function i(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&s(r.slice(0,0))}}}),Cv=Sx({"../../node_modules/.pnpm/ndarray@1.0.19/node_modules/ndarray/ndarray.js"(e,t){var s=uz(),i=dz(),r=typeof Float64Array<"u";function n(p,g){return p[0]-g[0]}function o(){var p=this.stride,g=new Array(p.length),m;for(m=0;m<g.length;++m)g[m]=[Math.abs(p[m]),m];g.sort(n);var C=new Array(g.length);for(m=0;m<C.length;++m)C[m]=g[m][1];return C}function a(p,g){var m=["View",g,"d",p].join("");g<0&&(m="View_Nil"+p);var C=p==="generic";if(g===-1){var y="function "+m+"(a){this.data=a;};var proto="+m+".prototype;proto.dtype='"+p+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+m+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+m+"(a){return new "+m+"(a);}",L=new Function(y);return L()}else if(g===0){var y="function "+m+"(a,d) {this.data = a;this.offset = d};var proto="+m+".prototype;proto.dtype='"+p+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+m+"_copy() {return new "+m+"(this.data,this.offset)};proto.pick=function "+m+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+m+"_get(){return "+(C?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+m+"_set(v){return "+(C?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+m+"(a,b,c,d){return new "+m+"(a,d)}",L=new Function("TrivialArray",y);return L(u[p][0])}var y=["'use strict'"],R=s(g),x=R.map(function(M){return"i"+M}),S="this.offset+"+R.map(function(M){return"this.stride["+M+"]*i"+M}).join("+"),T=R.map(function(M){return"b"+M}).join(","),I=R.map(function(M){return"c"+M}).join(",");y.push("function "+m+"(a,"+T+","+I+",d){this.data=a","this.shape=["+T+"]","this.stride=["+I+"]","this.offset=d|0}","var proto="+m+".prototype","proto.dtype='"+p+"'","proto.dimension="+g),y.push("Object.defineProperty(proto,'size',{get:function "+m+"_size(){return "+R.map(function(M){return"this.shape["+M+"]"}).join("*"),"}})"),g===1?y.push("proto.order=[0]"):(y.push("Object.defineProperty(proto,'order',{get:"),g<4?(y.push("function "+m+"_order(){"),g===2?y.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):g===3&&y.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):y.push("ORDER})")),y.push("proto.set=function "+m+"_set("+x.join(",")+",v){"),C?y.push("return this.data.set("+S+",v)}"):y.push("return this.data["+S+"]=v}"),y.push("proto.get=function "+m+"_get("+x.join(",")+"){"),C?y.push("return this.data.get("+S+")}"):y.push("return this.data["+S+"]}"),y.push("proto.index=function "+m+"_index(",x.join(),"){return "+S+"}"),y.push("proto.hi=function "+m+"_hi("+x.join(",")+"){return new "+m+"(this.data,"+R.map(function(M){return["(typeof i",M,"!=='number'||i",M,"<0)?this.shape[",M,"]:i",M,"|0"].join("")}).join(",")+","+R.map(function(M){return"this.stride["+M+"]"}).join(",")+",this.offset)}");var V=R.map(function(M){return"a"+M+"=this.shape["+M+"]"}),H=R.map(function(M){return"c"+M+"=this.stride["+M+"]"});y.push("proto.lo=function "+m+"_lo("+x.join(",")+"){var b=this.offset,d=0,"+V.join(",")+","+H.join(","));for(var P=0;P<g;++P)y.push("if(typeof i"+P+"==='number'&&i"+P+">=0){d=i"+P+"|0;b+=c"+P+"*d;a"+P+"-=d}");y.push("return new "+m+"(this.data,"+R.map(function(M){return"a"+M}).join(",")+","+R.map(function(M){return"c"+M}).join(",")+",b)}"),y.push("proto.step=function "+m+"_step("+x.join(",")+"){var "+R.map(function(M){return"a"+M+"=this.shape["+M+"]"}).join(",")+","+R.map(function(M){return"b"+M+"=this.stride["+M+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var P=0;P<g;++P)y.push("if(typeof i"+P+"==='number'){d=i"+P+"|0;if(d<0){c+=b"+P+"*(a"+P+"-1);a"+P+"=ceil(-a"+P+"/d)}else{a"+P+"=ceil(a"+P+"/d)}b"+P+"*=d}");y.push("return new "+m+"(this.data,"+R.map(function(M){return"a"+M}).join(",")+","+R.map(function(M){return"b"+M}).join(",")+",c)}");for(var N=new Array(g),_=new Array(g),P=0;P<g;++P)N[P]="a[i"+P+"]",_[P]="b[i"+P+"]";y.push("proto.transpose=function "+m+"_transpose("+x+"){"+x.map(function(M,b){return M+"=("+M+"===undefined?"+b+":"+M+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+m+"(this.data,"+N.join(",")+","+_.join(",")+",this.offset)}"),y.push("proto.pick=function "+m+"_pick("+x+"){var a=[],b=[],c=this.offset");for(var P=0;P<g;++P)y.push("if(typeof i"+P+"==='number'&&i"+P+">=0){c=(c+this.stride["+P+"]*i"+P+")|0}else{a.push(this.shape["+P+"]);b.push(this.stride["+P+"])}");y.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),y.push("return function construct_"+m+"(data,shape,stride,offset){return new "+m+"(data,"+R.map(function(M){return"shape["+M+"]"}).join(",")+","+R.map(function(M){return"stride["+M+"]"}).join(",")+",offset)}");var L=new Function("CTOR_LIST","ORDER",y.join(`
`));return L(u[p],o)}function l(p){if(i(p))return"buffer";if(r)switch(Object.prototype.toString.call(p)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(p)?"array":"generic"}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function h(p,g,m,C){if(p===void 0){var I=u.array[0];return I([])}else typeof p=="number"&&(p=[p]);g===void 0&&(g=[p.length]);var y=g.length;if(m===void 0){m=new Array(y);for(var R=y-1,x=1;R>=0;--R)m[R]=x,x*=g[R]}if(C===void 0){C=0;for(var R=0;R<y;++R)m[R]<0&&(C-=(g[R]-1)*m[R])}for(var S=l(p),T=u[S];T.length<=y+1;)T.push(a(S,T.length-1));var I=T[y+1];return I(p,g,m,C)}t.exports=h}}),hz=typeof global=="object"&&global&&global.Object===Object&&global,pz=hz,gz=typeof self=="object"&&self&&self.Object===Object&&self,fz=pz||gz||Function("return this")(),xx=fz,mz=xx.Symbol,Xf=mz,g_=Object.prototype,vz=g_.hasOwnProperty,Cz=g_.toString,td=Xf?Xf.toStringTag:void 0;function yz(e){var t=vz.call(e,td),s=e[td];try{e[td]=void 0;var i=!0}catch{}var r=Cz.call(e);return i&&(t?e[td]=s:delete e[td]),r}var wz=yz,Sz=Object.prototype,xz=Sz.toString;function Ez(e){return xz.call(e)}var bz=Ez,Rz="[object Null]",Tz="[object Undefined]",lT=Xf?Xf.toStringTag:void 0;function Dz(e){return e==null?e===void 0?Tz:Rz:lT&&lT in Object(e)?wz(e):bz(e)}var Pz=Dz;function Az(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var f_=Az,Fz="[object AsyncFunction]",Iz="[object Function]",Nz="[object GeneratorFunction]",_z="[object Proxy]";function kz(e){if(!f_(e))return!1;var t=Pz(e);return t==Iz||t==Nz||t==Fz||t==_z}var Mz=kz,Lz=xx["__core-js_shared__"],GC=Lz,cT=function(){var e=/[^.]+$/.exec(GC&&GC.keys&&GC.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Oz(e){return!!cT&&cT in e}var Gz=Oz,Vz=Function.prototype,Bz=Vz.toString;function Hz(e){if(e!=null){try{return Bz.call(e)}catch{}try{return e+""}catch{}}return""}var jz=Hz,Wz=/[\\^$.*+?()[\]{}|]/g,zz=/^\[object .+?Constructor\]$/,Uz=Function.prototype,$z=Object.prototype,Kz=Uz.toString,Yz=$z.hasOwnProperty,qz=RegExp("^"+Kz.call(Yz).replace(Wz,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Qz(e){if(!f_(e)||Gz(e))return!1;var t=Mz(e)?qz:zz;return t.test(jz(e))}var Zz=Qz;function Jz(e,t){return e==null?void 0:e[t]}var Xz=Jz;function eU(e,t){var s=Xz(e,t);return Zz(s)?s:void 0}var m_=eU,tU=m_(Object,"create"),Oh=tU;function sU(){this.__data__=Oh?Oh(null):{},this.size=0}var iU=sU;function rU(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var nU=rU,oU="__lodash_hash_undefined__",aU=Object.prototype,lU=aU.hasOwnProperty;function cU(e){var t=this.__data__;if(Oh){var s=t[e];return s===oU?void 0:s}return lU.call(t,e)?t[e]:void 0}var uU=cU,dU=Object.prototype,hU=dU.hasOwnProperty;function pU(e){var t=this.__data__;return Oh?t[e]!==void 0:hU.call(t,e)}var gU=pU,fU="__lodash_hash_undefined__";function mU(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Oh&&t===void 0?fU:t,this}var vU=mU;function Nu(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var i=e[t];this.set(i[0],i[1])}}Nu.prototype.clear=iU;Nu.prototype.delete=nU;Nu.prototype.get=uU;Nu.prototype.has=gU;Nu.prototype.set=vU;var uT=Nu;function CU(){this.__data__=[],this.size=0}var yU=CU;function wU(e,t){return e===t||e!==e&&t!==t}var SU=wU;function xU(e,t){for(var s=e.length;s--;)if(SU(e[s][0],t))return s;return-1}var yv=xU,EU=Array.prototype,bU=EU.splice;function RU(e){var t=this.__data__,s=yv(t,e);if(s<0)return!1;var i=t.length-1;return s==i?t.pop():bU.call(t,s,1),--this.size,!0}var TU=RU;function DU(e){var t=this.__data__,s=yv(t,e);return s<0?void 0:t[s][1]}var PU=DU;function AU(e){return yv(this.__data__,e)>-1}var FU=AU;function IU(e,t){var s=this.__data__,i=yv(s,e);return i<0?(++this.size,s.push([e,t])):s[i][1]=t,this}var NU=IU;function _u(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var i=e[t];this.set(i[0],i[1])}}_u.prototype.clear=yU;_u.prototype.delete=TU;_u.prototype.get=PU;_u.prototype.has=FU;_u.prototype.set=NU;var _U=_u,kU=m_(xx,"Map"),MU=kU;function LU(){this.size=0,this.__data__={hash:new uT,map:new(MU||_U),string:new uT}}var OU=LU;function GU(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var VU=GU;function BU(e,t){var s=e.__data__;return VU(t)?s[typeof t=="string"?"string":"hash"]:s.map}var wv=BU;function HU(e){var t=wv(this,e).delete(e);return this.size-=t?1:0,t}var jU=HU;function WU(e){return wv(this,e).get(e)}var zU=WU;function UU(e){return wv(this,e).has(e)}var $U=UU;function KU(e,t){var s=wv(this,e),i=s.size;return s.set(e,t),this.size+=s.size==i?0:1,this}var YU=KU;function ku(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var i=e[t];this.set(i[0],i[1])}}ku.prototype.clear=OU;ku.prototype.delete=jU;ku.prototype.get=zU;ku.prototype.has=$U;ku.prototype.set=YU;var v_=ku,qU="Expected a function";function Ex(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(qU);var s=function(){var i=arguments,r=t?t.apply(this,i):i[0],n=s.cache;if(n.has(r))return n.get(r);var o=e.apply(this,i);return s.cache=n.set(r,o)||n,o};return s.cache=new(Ex.Cache||v_),s}Ex.Cache=v_;var QU=Ex,bx=vv(Cv()),C_=class Nw{constructor(t,s){this.type="application/octet-stream",this.params={},this.type=t,this.params=s}toString(){const t=[];for(const s in this.params){const i=this.params[s];t.push(`${s}=${i}`)}return[this.type,...t].join(";")}static create(t,s){return new Nw(t,s)}isIdentical(t){return this.type===t.type&&this.params===t.params}isEqual(t){return this.type===t.type}static fromString(t){const[s,...i]=t.split(";"),r={};for(const n of i){const[o,a]=n.split("=");r[o.trim()]=a.trim()}return new Nw(s,r)}},VC=vv(Cv());async function ZU(e){const t=C_.fromString(e.type);switch(t.type){case"image/x-alpha8":{const s=parseInt(t.params.width),i=parseInt(t.params.height);return(0,VC.default)(new Uint8Array(await e.arrayBuffer()),[i,s,1])}case"image/x-rgba8":{const s=parseInt(t.params.width),i=parseInt(t.params.height);return(0,VC.default)(new Uint8Array(await e.arrayBuffer()),[i,s,4])}case"application/octet-stream":case"image/png":case"image/jpeg":case"image/jpg":case"image/webp":{const s=await createImageBitmap(e),i=t5(s);return(0,VC.default)(new Uint8Array(i.data),[i.height,i.width,4])}default:throw new Error(`Invalid format: ${t.type} with params: ${t.params}`)}}async function JU(e,t=.8,s="image/png"){const[i,r,n]=e.shape;switch(s){case"image/x-alpha8":case"image/x-rgba8":{const l=C_.create(s,{width:r.toString(),height:i.toString()});return new Blob([e.data],{type:l.toString()})}case"image/png":case"image/jpeg":case"image/webp":{const l=new ImageData(new Uint8ClampedArray(e.data),r,i);var o=y_(l.width,l.height),a=o.getContext("2d");return a.putImageData(l,0,0),o.convertToBlob({quality:t,type:s})}default:throw new Error(`Invalid format: ${s}`)}}function XU(e){return new RegExp("^(?:[a-z+]+:)?//","i").test(e)}function e5(e,t){return XU(e)?e:new URL(e,t).href}function t5(e){var t=y_(e.width,e.height),s=t.getContext("2d");return s.drawImage(e,0,0),s.getImageData(0,0,t.width,t.height)}function s5(e){if(typeof Uint8Array<"u")return new Uint8Array(e);if(typeof Uint8ClampedArray<"u")return new Uint8ClampedArray(e);if(typeof Uint16Array<"u")return new Uint16Array(e);if(typeof Uint32Array<"u")return new Uint32Array(e);if(typeof Float32Array<"u")return new Float32Array(e);if(typeof Float64Array<"u")return new Float64Array(e);throw new Error("TypedArray not supported")}function dT(e,t,s,i=!1){const[r,n,o]=e.shape;let a=n/t,l=r/s;i&&(a=l=Math.max(a,l)>1?Math.max(a,l):Math.min(a,l));const u=(0,bx.default)(s5(o*t*s),[s,t,o]);for(let h=0;h<s;h++)for(let p=0;p<t;p++){const g=p*a,m=h*l,C=Math.max(Math.floor(g),0),y=Math.min(Math.ceil(g),n-1),R=Math.max(Math.floor(m),0),x=Math.min(Math.ceil(m),r-1),S=g-C,T=m-R;for(let I=0;I<o;I++){const V=e.get(R,C,I),H=e.get(R,y,I),P=e.get(x,C,I),N=e.get(x,y,I),_=(1-S)*(1-T)*V+S*(1-T)*H+(1-S)*T*P+S*T*N;u.set(h,p,I,_)}}return u}function i5(e,t=[128,128,128],s=[256,256,256]){var i=e.data;const[r,n,o]=e.shape,a=r*n,l=new Float32Array(3*a);for(let u=0,h=0;u<i.length;u+=4,h+=1)l[h]=(i[u]-t[0])/s[0],l[h+a]=(i[u+1]-t[1])/s[1],l[h+a+a]=(i[u+2]-t[2])/s[2];return(0,bx.default)(l,[1,3,r,n])}async function r5(e,t){return typeof e=="string"&&(e=e5(e,t.publicPath),e=new URL(e)),e instanceof URL&&(e=await(await fetch(e,{})).blob()),(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e=new Blob([e])),e instanceof Blob&&(e=await ZU(e)),e}function n5(e){const t=new Uint8Array(e.data.length);for(let s=0;s<e.data.length;s++)t[s]=e.data[s]*255;return(0,bx.default)(t,e.shape)}function y_(e,t){let s;if(typeof OffscreenCanvas<"u"?s=new OffscreenCanvas(e,t):s=document.createElement("canvas"),!s)throw new Error("Canvas nor OffscreenCanvas are available in the current context.");return s}var o5=vv(Cv()),w_=async()=>navigator.gpu===void 0?!1:await navigator.gpu.requestAdapter()!==null,a5=()=>navigator.hardwareConcurrency??4;async function hT(e,t){return URL.createObjectURL(await S_(e,t))}async function S_(e,t){const s=new URL("resources.json",t.publicPath),i=await fetch(s);if(!i.ok)throw new Error("Resource metadata not found. Ensure that the config.publicPath is configured correctly.");const n=(await i.json())[e];if(!n)throw new Error(`Resource ${e} not found. Ensure that the config.publicPath is configured correctly.`);const o=n.chunks;let a=0;const l=o.map(async p=>{const g=p.offsets[1]-p.offsets[0],m=t.publicPath?new URL(p.name,t.publicPath).toString():p.name,y=await(await fetch(m,t.fetchArgs)).blob();if(g!==y.size)throw new Error(`Failed to fetch ${e} with size ${g} but got ${y.size}`);return t.progress&&(a+=g,t.progress(`fetch:${e}`,a,n.size)),y}),u=await Promise.all(l),h=new Blob(u,{type:n.mime});if(h.size!==n.size)throw new Error(`Failed to fetch ${e} with size ${n.size} but got ${h.size}`);return h}var sd=null,x_=async e=>(sd!==null||(e?sd=(await aT(async()=>{const{default:t}=await import("./ort.webgpu.bundle.min-OqVjPHQG.js");return{default:t}},[])).default:sd=(await aT(async()=>{const{default:t}=await import("./ort.bundle.min-fzhtFWcq.js");return{default:t}},[])).default),sd);async function l5(e,t){const s=t.device==="gpu"&&await w_(),i=s&&t.proxyToWorker,r=[s?"webgpu":"wasm"],n=await x_(s);t.debug&&(console.debug("	Using WebGPU:",s),console.debug("	Proxy to Worker:",i),n.env.debug=!0,n.env.logLevel="verbose"),n.env.wasm.numThreads=a5(),n.env.wasm.proxy=i;const o=s?"/onnxruntime-web/ort-wasm-simd-threaded.jsep":"/onnxruntime-web/ort-wasm-simd-threaded",a=await hT(`${o}.wasm`,t),l=await hT(`${o}.mjs`,t);n.env.wasm.wasmPaths={mjs:l,wasm:a},t.debug&&console.debug("ort.env.wasm:",n.env.wasm);const u={executionProviders:r,graphOptimizationLevel:"all",executionMode:"parallel",enableCpuMemArena:!0};return await n.InferenceSession.create(e,u).catch(p=>{throw new Error(`Failed to create session: "${p}". Please check if the publicPath is set correctly.`)})}async function c5(e,t,s,i){const r=i.device==="gpu"&&await w_(),n=await x_(r),o={};for(const[u,h]of t)o[u]=new n.Tensor("float32",new Float32Array(h.data),h.shape);const a=await e.run(o,{}),l=[];for(const u of s){const h=a[u],p=h.dims,g=h.data,m=(0,o5.default)(g,p);l.push(m)}return l}var It;(function(e){e.assertEqual=r=>r;function t(r){}e.assertIs=t;function s(r){throw new Error}e.assertNever=s,e.arrayToEnum=r=>{const n={};for(const o of r)n[o]=o;return n},e.getValidEnumValues=r=>{const n=e.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),o={};for(const a of n)o[a]=r[a];return e.objectValues(o)},e.objectValues=r=>e.objectKeys(r).map(function(n){return r[n]}),e.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const n=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&n.push(o);return n},e.find=(r,n)=>{for(const o of r)if(n(o))return o},e.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&isFinite(r)&&Math.floor(r)===r;function i(r,n=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(n)}e.joinValues=i,e.jsonStringifyReplacer=(r,n)=>typeof n=="bigint"?n.toString():n})(It||(It={}));var _w;(function(e){e.mergeShapes=(t,s)=>({...t,...s})})(_w||(_w={}));var qe=It.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),jn=e=>{switch(typeof e){case"undefined":return qe.undefined;case"string":return qe.string;case"number":return isNaN(e)?qe.nan:qe.number;case"boolean":return qe.boolean;case"function":return qe.function;case"bigint":return qe.bigint;case"symbol":return qe.symbol;case"object":return Array.isArray(e)?qe.array:e===null?qe.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?qe.promise:typeof Map<"u"&&e instanceof Map?qe.map:typeof Set<"u"&&e instanceof Set?qe.set:typeof Date<"u"&&e instanceof Date?qe.date:qe.object;default:return qe.unknown}},Le=It.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),u5=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),tn=class E_ extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=t}format(t){const s=t||function(n){return n.message},i={_errors:[]},r=n=>{for(const o of n.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)i._errors.push(s(o));else{let a=i,l=0;for(;l<o.path.length;){const u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(s(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return r(this),i}static assert(t){if(!(t instanceof E_))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,It.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=s=>s.message){const s={},i=[];for(const r of this.issues)r.path.length>0?(s[r.path[0]]=s[r.path[0]]||[],s[r.path[0]].push(t(r))):i.push(t(r));return{formErrors:i,fieldErrors:s}}get formErrors(){return this.flatten()}};tn.create=e=>new tn(e);var au=(e,t)=>{let s;switch(e.code){case Le.invalid_type:e.received===qe.undefined?s="Required":s=`Expected ${e.expected}, received ${e.received}`;break;case Le.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(e.expected,It.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:s=`Unrecognized key(s) in object: ${It.joinValues(e.keys,", ")}`;break;case Le.invalid_union:s="Invalid input";break;case Le.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${It.joinValues(e.options)}`;break;case Le.invalid_enum_value:s=`Invalid enum value. Expected ${It.joinValues(e.options)}, received '${e.received}'`;break;case Le.invalid_arguments:s="Invalid function arguments";break;case Le.invalid_return_type:s="Invalid function return type";break;case Le.invalid_date:s="Invalid date";break;case Le.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(s=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?s=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?s=`Invalid input: must end with "${e.validation.endsWith}"`:It.assertNever(e.validation):e.validation!=="regex"?s=`Invalid ${e.validation}`:s="Invalid";break;case Le.too_small:e.type==="array"?s=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?s=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?s=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?s=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:s="Invalid input";break;case Le.too_big:e.type==="array"?s=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?s=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?s=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?s=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?s=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:s="Invalid input";break;case Le.custom:s="Invalid input";break;case Le.invalid_intersection_types:s="Intersection results could not be merged";break;case Le.not_multiple_of:s=`Number must be a multiple of ${e.multipleOf}`;break;case Le.not_finite:s="Number must be finite";break;default:s=t.defaultError,It.assertNever(e)}return{message:s}},b_=au;function d5(e){b_=e}function em(){return b_}var tm=e=>{const{data:t,path:s,errorMaps:i,issueData:r}=e,n=[...s,...r.path||[]],o={...r,path:n};if(r.message!==void 0)return{...r,path:n,message:r.message};let a="";const l=i.filter(u=>!!u).slice().reverse();for(const u of l)a=u(o,{data:t,defaultError:a}).message;return{...r,path:n,message:a}},h5=[];function Ue(e,t){const s=em(),i=tm({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,s,s===au?void 0:au].filter(r=>!!r)});e.common.issues.push(i)}var Wi=class R_{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,s){const i=[];for(const r of s){if(r.status==="aborted")return ut;r.status==="dirty"&&t.dirty(),i.push(r.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,s){const i=[];for(const r of s){const n=await r.key,o=await r.value;i.push({key:n,value:o})}return R_.mergeObjectSync(t,i)}static mergeObjectSync(t,s){const i={};for(const r of s){const{key:n,value:o}=r;if(n.status==="aborted"||o.status==="aborted")return ut;n.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),n.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(i[n.value]=o.value)}return{status:t.value,value:i}}},ut=Object.freeze({status:"aborted"}),mc=e=>({status:"dirty",value:e}),Ci=e=>({status:"valid",value:e}),kw=e=>e.status==="aborted",Mw=e=>e.status==="dirty",Dl=e=>e.status==="valid",Gh=e=>typeof Promise<"u"&&e instanceof Promise;function sm(e,t,s,i){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function T_(e,t,s,i,r){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,s),s}var st;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(st||(st={}));var wd,Sd,_n=class{constructor(e,t,s,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},pT=(e,t)=>{if(Dl(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new tn(e.common.issues);return this._error=s,this._error}}};function vt(e){if(!e)return{};const{errorMap:t,invalid_type_error:s,required_error:i,description:r}=e;if(t&&(s||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:r}:{errorMap:(o,a)=>{var l,u;const{message:h}=e;return o.code==="invalid_enum_value"?{message:h??a.defaultError}:typeof a.data>"u"?{message:(l=h??i)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(u=h??s)!==null&&u!==void 0?u:a.defaultError}},description:r}}var wt=class{get description(){return this._def.description}_getType(e){return jn(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:jn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Wi,ctx:{common:e.parent.common,data:e.data,parsedType:jn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Gh(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;const i={common:{issues:[],async:(s=t==null?void 0:t.async)!==null&&s!==void 0?s:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:jn(e)},r=this._parseSync({data:e,path:i.path,parent:i});return pT(i,r)}"~validate"(e){var t,s;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:jn(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:i});return Dl(r)?{value:r.value}:{issues:i.common.issues}}catch(r){!((s=(t=r==null?void 0:r.message)===null||t===void 0?void 0:t.toLowerCase())===null||s===void 0)&&s.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(r=>Dl(r)?{value:r.value}:{issues:i.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:jn(e)},i=this._parse({data:e,path:s.path,parent:s}),r=await(Gh(i)?i:Promise.resolve(i));return pT(s,r)}refine(e,t){const s=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,r)=>{const n=e(i),o=()=>r.addIssue({code:Le.custom,...s(i)});return typeof Promise<"u"&&n instanceof Promise?n.then(a=>a?!0:(o(),!1)):n?!0:(o(),!1)})}refinement(e,t){return this._refinement((s,i)=>e(s)?!0:(i.addIssue(typeof t=="function"?t(s,i):t),!1))}_refinement(e){return new on({schema:this,typeName:lt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Dn.create(this,this._def)}nullable(){return aa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Pl.create(this)}promise(){return uu.create(this,this._def)}or(e){return Uh.create([this,e],this._def)}and(e){return $h.create(this,e,this._def)}transform(e){return new on({...vt(this._def),schema:this,typeName:lt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Qh({...vt(this._def),innerType:this,defaultValue:t,typeName:lt.ZodDefault})}brand(){return new Rx({typeName:lt.ZodBranded,type:this,...vt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Zh({...vt(this._def),innerType:this,catchValue:t,typeName:lt.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Tx.create(this,e)}readonly(){return Jh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},p5=/^c[^\s-]{8,}$/i,g5=/^[0-9a-z]+$/,f5=/^[0-9A-HJKMNP-TV-Z]{26}$/i,m5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,v5=/^[a-z0-9_-]{21}$/i,C5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,y5=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,w5=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,S5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",BC,x5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,E5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,b5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,R5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,T5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,D5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,D_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",P5=new RegExp(`^${D_}$`);function P_(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function A5(e){return new RegExp(`^${P_(e)}$`)}function A_(e){let t=`${D_}T${P_(e)}`;const s=[];return s.push(e.local?"Z?":"Z"),e.offset&&s.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${s.join("|")})`,new RegExp(`^${t}$`)}function F5(e,t){return!!((t==="v4"||!t)&&x5.test(e)||(t==="v6"||!t)&&b5.test(e))}function I5(e,t){if(!C5.test(e))return!1;try{const[s]=e.split("."),i=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),r=JSON.parse(atob(i));return!(typeof r!="object"||r===null||!r.typ||!r.alg||t&&r.alg!==t)}catch{return!1}}function N5(e,t){return!!((t==="v4"||!t)&&E5.test(e)||(t==="v6"||!t)&&R5.test(e))}var lu=class xd extends wt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==qe.string){const n=this._getOrReturnCtx(t);return Ue(n,{code:Le.invalid_type,expected:qe.string,received:n.parsedType}),ut}const i=new Wi;let r;for(const n of this._def.checks)if(n.kind==="min")t.data.length<n.value&&(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),i.dirty());else if(n.kind==="max")t.data.length>n.value&&(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),i.dirty());else if(n.kind==="length"){const o=t.data.length>n.value,a=t.data.length<n.value;(o||a)&&(r=this._getOrReturnCtx(t,r),o?Ue(r,{code:Le.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):a&&Ue(r,{code:Le.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),i.dirty())}else if(n.kind==="email")w5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"email",code:Le.invalid_string,message:n.message}),i.dirty());else if(n.kind==="emoji")BC||(BC=new RegExp(S5,"u")),BC.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"emoji",code:Le.invalid_string,message:n.message}),i.dirty());else if(n.kind==="uuid")m5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"uuid",code:Le.invalid_string,message:n.message}),i.dirty());else if(n.kind==="nanoid")v5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"nanoid",code:Le.invalid_string,message:n.message}),i.dirty());else if(n.kind==="cuid")p5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"cuid",code:Le.invalid_string,message:n.message}),i.dirty());else if(n.kind==="cuid2")g5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"cuid2",code:Le.invalid_string,message:n.message}),i.dirty());else if(n.kind==="ulid")f5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"ulid",code:Le.invalid_string,message:n.message}),i.dirty());else if(n.kind==="url")try{new URL(t.data)}catch{r=this._getOrReturnCtx(t,r),Ue(r,{validation:"url",code:Le.invalid_string,message:n.message}),i.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"regex",code:Le.invalid_string,message:n.message}),i.dirty())):n.kind==="trim"?t.data=t.data.trim():n.kind==="includes"?t.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),i.dirty()):n.kind==="toLowerCase"?t.data=t.data.toLowerCase():n.kind==="toUpperCase"?t.data=t.data.toUpperCase():n.kind==="startsWith"?t.data.startsWith(n.value)||(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.invalid_string,validation:{startsWith:n.value},message:n.message}),i.dirty()):n.kind==="endsWith"?t.data.endsWith(n.value)||(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.invalid_string,validation:{endsWith:n.value},message:n.message}),i.dirty()):n.kind==="datetime"?A_(n).test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.invalid_string,validation:"datetime",message:n.message}),i.dirty()):n.kind==="date"?P5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.invalid_string,validation:"date",message:n.message}),i.dirty()):n.kind==="time"?A5(n).test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.invalid_string,validation:"time",message:n.message}),i.dirty()):n.kind==="duration"?y5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"duration",code:Le.invalid_string,message:n.message}),i.dirty()):n.kind==="ip"?F5(t.data,n.version)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"ip",code:Le.invalid_string,message:n.message}),i.dirty()):n.kind==="jwt"?I5(t.data,n.alg)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"jwt",code:Le.invalid_string,message:n.message}),i.dirty()):n.kind==="cidr"?N5(t.data,n.version)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"cidr",code:Le.invalid_string,message:n.message}),i.dirty()):n.kind==="base64"?T5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"base64",code:Le.invalid_string,message:n.message}),i.dirty()):n.kind==="base64url"?D5.test(t.data)||(r=this._getOrReturnCtx(t,r),Ue(r,{validation:"base64url",code:Le.invalid_string,message:n.message}),i.dirty()):It.assertNever(n);return{status:i.value,value:t.data}}_regex(t,s,i){return this.refinement(r=>t.test(r),{validation:s,code:Le.invalid_string,...st.errToObj(i)})}_addCheck(t){return new xd({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...st.errToObj(t)})}url(t){return this._addCheck({kind:"url",...st.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...st.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...st.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...st.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...st.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...st.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...st.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...st.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...st.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...st.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...st.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...st.errToObj(t)})}datetime(t){var s,i;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(s=t==null?void 0:t.offset)!==null&&s!==void 0?s:!1,local:(i=t==null?void 0:t.local)!==null&&i!==void 0?i:!1,...st.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...st.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...st.errToObj(t)})}regex(t,s){return this._addCheck({kind:"regex",regex:t,...st.errToObj(s)})}includes(t,s){return this._addCheck({kind:"includes",value:t,position:s==null?void 0:s.position,...st.errToObj(s==null?void 0:s.message)})}startsWith(t,s){return this._addCheck({kind:"startsWith",value:t,...st.errToObj(s)})}endsWith(t,s){return this._addCheck({kind:"endsWith",value:t,...st.errToObj(s)})}min(t,s){return this._addCheck({kind:"min",value:t,...st.errToObj(s)})}max(t,s){return this._addCheck({kind:"max",value:t,...st.errToObj(s)})}length(t,s){return this._addCheck({kind:"length",value:t,...st.errToObj(s)})}nonempty(t){return this.min(1,st.errToObj(t))}trim(){return new xd({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new xd({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new xd({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxLength(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}};lu.create=e=>{var t;return new lu({checks:[],typeName:lt.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...vt(e)})};function _5(e,t){const s=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,r=s>i?s:i,n=parseInt(e.toFixed(r).replace(".","")),o=parseInt(t.toFixed(r).replace(".",""));return n%o/Math.pow(10,r)}var Vh=class Lw extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==qe.number){const n=this._getOrReturnCtx(t);return Ue(n,{code:Le.invalid_type,expected:qe.number,received:n.parsedType}),ut}let i;const r=new Wi;for(const n of this._def.checks)n.kind==="int"?It.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):n.kind==="min"?(n.inclusive?t.data<n.value:t.data<=n.value)&&(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?t.data>n.value:t.data>=n.value)&&(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="multipleOf"?_5(t.data,n.value)!==0&&(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):n.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.not_finite,message:n.message}),r.dirty()):It.assertNever(n);return{status:r.value,value:t.data}}gte(t,s){return this.setLimit("min",t,!0,st.toString(s))}gt(t,s){return this.setLimit("min",t,!1,st.toString(s))}lte(t,s){return this.setLimit("max",t,!0,st.toString(s))}lt(t,s){return this.setLimit("max",t,!1,st.toString(s))}setLimit(t,s,i,r){return new Lw({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:i,message:st.toString(r)}]})}_addCheck(t){return new Lw({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:st.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:st.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:st.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:st.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:st.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:st.toString(s)})}finite(t){return this._addCheck({kind:"finite",message:st.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:st.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:st.toString(t)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&It.isInteger(t.value))}get isFinite(){let t=null,s=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(s===null||i.value>s)&&(s=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(s)&&Number.isFinite(t)}};Vh.create=e=>new Vh({checks:[],typeName:lt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...vt(e)});var Bh=class Ow extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==qe.bigint)return this._getInvalidInput(t);let i;const r=new Wi;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?t.data<n.value:t.data<=n.value)&&(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?t.data>n.value:t.data>=n.value)&&(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="multipleOf"?t.data%n.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),Ue(i,{code:Le.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):It.assertNever(n);return{status:r.value,value:t.data}}_getInvalidInput(t){const s=this._getOrReturnCtx(t);return Ue(s,{code:Le.invalid_type,expected:qe.bigint,received:s.parsedType}),ut}gte(t,s){return this.setLimit("min",t,!0,st.toString(s))}gt(t,s){return this.setLimit("min",t,!1,st.toString(s))}lte(t,s){return this.setLimit("max",t,!0,st.toString(s))}lt(t,s){return this.setLimit("max",t,!1,st.toString(s))}setLimit(t,s,i,r){return new Ow({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:i,message:st.toString(r)}]})}_addCheck(t){return new Ow({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:st.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:st.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:st.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:st.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:st.toString(s)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}};Bh.create=e=>{var t;return new Bh({checks:[],typeName:lt.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...vt(e)})};var Hh=class extends wt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==qe.boolean){const s=this._getOrReturnCtx(e);return Ue(s,{code:Le.invalid_type,expected:qe.boolean,received:s.parsedType}),ut}return Ci(e.data)}};Hh.create=e=>new Hh({typeName:lt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...vt(e)});var jh=class F_ extends wt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==qe.date){const n=this._getOrReturnCtx(t);return Ue(n,{code:Le.invalid_type,expected:qe.date,received:n.parsedType}),ut}if(isNaN(t.data.getTime())){const n=this._getOrReturnCtx(t);return Ue(n,{code:Le.invalid_date}),ut}const i=new Wi;let r;for(const n of this._def.checks)n.kind==="min"?t.data.getTime()<n.value&&(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),i.dirty()):n.kind==="max"?t.data.getTime()>n.value&&(r=this._getOrReturnCtx(t,r),Ue(r,{code:Le.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),i.dirty()):It.assertNever(n);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new F_({...this._def,checks:[...this._def.checks,t]})}min(t,s){return this._addCheck({kind:"min",value:t.getTime(),message:st.toString(s)})}max(t,s){return this._addCheck({kind:"max",value:t.getTime(),message:st.toString(s)})}get minDate(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t!=null?new Date(t):null}};jh.create=e=>new jh({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:lt.ZodDate,...vt(e)});var im=class extends wt{_parse(e){if(this._getType(e)!==qe.symbol){const s=this._getOrReturnCtx(e);return Ue(s,{code:Le.invalid_type,expected:qe.symbol,received:s.parsedType}),ut}return Ci(e.data)}};im.create=e=>new im({typeName:lt.ZodSymbol,...vt(e)});var Wh=class extends wt{_parse(e){if(this._getType(e)!==qe.undefined){const s=this._getOrReturnCtx(e);return Ue(s,{code:Le.invalid_type,expected:qe.undefined,received:s.parsedType}),ut}return Ci(e.data)}};Wh.create=e=>new Wh({typeName:lt.ZodUndefined,...vt(e)});var zh=class extends wt{_parse(e){if(this._getType(e)!==qe.null){const s=this._getOrReturnCtx(e);return Ue(s,{code:Le.invalid_type,expected:qe.null,received:s.parsedType}),ut}return Ci(e.data)}};zh.create=e=>new zh({typeName:lt.ZodNull,...vt(e)});var cu=class extends wt{constructor(){super(...arguments),this._any=!0}_parse(e){return Ci(e.data)}};cu.create=e=>new cu({typeName:lt.ZodAny,...vt(e)});var ul=class extends wt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ci(e.data)}};ul.create=e=>new ul({typeName:lt.ZodUnknown,...vt(e)});var io=class extends wt{_parse(e){const t=this._getOrReturnCtx(e);return Ue(t,{code:Le.invalid_type,expected:qe.never,received:t.parsedType}),ut}};io.create=e=>new io({typeName:lt.ZodNever,...vt(e)});var rm=class extends wt{_parse(e){if(this._getType(e)!==qe.undefined){const s=this._getOrReturnCtx(e);return Ue(s,{code:Le.invalid_type,expected:qe.void,received:s.parsedType}),ut}return Ci(e.data)}};rm.create=e=>new rm({typeName:lt.ZodVoid,...vt(e)});var Pl=class Wg extends wt{_parse(t){const{ctx:s,status:i}=this._processInputParams(t),r=this._def;if(s.parsedType!==qe.array)return Ue(s,{code:Le.invalid_type,expected:qe.array,received:s.parsedType}),ut;if(r.exactLength!==null){const o=s.data.length>r.exactLength.value,a=s.data.length<r.exactLength.value;(o||a)&&(Ue(s,{code:o?Le.too_big:Le.too_small,minimum:a?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),i.dirty())}if(r.minLength!==null&&s.data.length<r.minLength.value&&(Ue(s,{code:Le.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),i.dirty()),r.maxLength!==null&&s.data.length>r.maxLength.value&&(Ue(s,{code:Le.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),i.dirty()),s.common.async)return Promise.all([...s.data].map((o,a)=>r.type._parseAsync(new _n(s,o,s.path,a)))).then(o=>Wi.mergeArray(i,o));const n=[...s.data].map((o,a)=>r.type._parseSync(new _n(s,o,s.path,a)));return Wi.mergeArray(i,n)}get element(){return this._def.type}min(t,s){return new Wg({...this._def,minLength:{value:t,message:st.toString(s)}})}max(t,s){return new Wg({...this._def,maxLength:{value:t,message:st.toString(s)}})}length(t,s){return new Wg({...this._def,exactLength:{value:t,message:st.toString(s)}})}nonempty(t){return this.min(1,t)}};Pl.create=(e,t)=>new Pl({type:e,minLength:null,maxLength:null,exactLength:null,typeName:lt.ZodArray,...vt(t)});function tc(e){if(e instanceof Fr){const t={};for(const s in e.shape){const i=e.shape[s];t[s]=Dn.create(tc(i))}return new Fr({...e._def,shape:()=>t})}else return e instanceof Pl?new Pl({...e._def,type:tc(e.element)}):e instanceof Dn?Dn.create(tc(e.unwrap())):e instanceof aa?aa.create(tc(e.unwrap())):e instanceof oa?oa.create(e.items.map(t=>tc(t))):e}var Fr=class Vr extends wt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),s=It.objectKeys(t);return this._cached={shape:t,keys:s}}_parse(t){if(this._getType(t)!==qe.object){const u=this._getOrReturnCtx(t);return Ue(u,{code:Le.invalid_type,expected:qe.object,received:u.parsedType}),ut}const{status:i,ctx:r}=this._processInputParams(t),{shape:n,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof io&&this._def.unknownKeys==="strip"))for(const u in r.data)o.includes(u)||a.push(u);const l=[];for(const u of o){const h=n[u],p=r.data[u];l.push({key:{status:"valid",value:u},value:h._parse(new _n(r,p,r.path,u)),alwaysSet:u in r.data})}if(this._def.catchall instanceof io){const u=this._def.unknownKeys;if(u==="passthrough")for(const h of a)l.push({key:{status:"valid",value:h},value:{status:"valid",value:r.data[h]}});else if(u==="strict")a.length>0&&(Ue(r,{code:Le.unrecognized_keys,keys:a}),i.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const h of a){const p=r.data[h];l.push({key:{status:"valid",value:h},value:u._parse(new _n(r,p,r.path,h)),alwaysSet:h in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const u=[];for(const h of l){const p=await h.key,g=await h.value;u.push({key:p,value:g,alwaysSet:h.alwaysSet})}return u}).then(u=>Wi.mergeObjectSync(i,u)):Wi.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(t){return st.errToObj,new Vr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(s,i)=>{var r,n,o,a;const l=(o=(n=(r=this._def).errorMap)===null||n===void 0?void 0:n.call(r,s,i).message)!==null&&o!==void 0?o:i.defaultError;return s.code==="unrecognized_keys"?{message:(a=st.errToObj(t).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Vr({...this._def,unknownKeys:"strip"})}passthrough(){return new Vr({...this._def,unknownKeys:"passthrough"})}extend(t){return new Vr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Vr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:lt.ZodObject})}setKey(t,s){return this.augment({[t]:s})}catchall(t){return new Vr({...this._def,catchall:t})}pick(t){const s={};return It.objectKeys(t).forEach(i=>{t[i]&&this.shape[i]&&(s[i]=this.shape[i])}),new Vr({...this._def,shape:()=>s})}omit(t){const s={};return It.objectKeys(this.shape).forEach(i=>{t[i]||(s[i]=this.shape[i])}),new Vr({...this._def,shape:()=>s})}deepPartial(){return tc(this)}partial(t){const s={};return It.objectKeys(this.shape).forEach(i=>{const r=this.shape[i];t&&!t[i]?s[i]=r:s[i]=r.optional()}),new Vr({...this._def,shape:()=>s})}required(t){const s={};return It.objectKeys(this.shape).forEach(i=>{if(t&&!t[i])s[i]=this.shape[i];else{let n=this.shape[i];for(;n instanceof Dn;)n=n._def.innerType;s[i]=n}}),new Vr({...this._def,shape:()=>s})}keyof(){return L_(It.objectKeys(this.shape))}};Fr.create=(e,t)=>new Fr({shape:()=>e,unknownKeys:"strip",catchall:io.create(),typeName:lt.ZodObject,...vt(t)});Fr.strictCreate=(e,t)=>new Fr({shape:()=>e,unknownKeys:"strict",catchall:io.create(),typeName:lt.ZodObject,...vt(t)});Fr.lazycreate=(e,t)=>new Fr({shape:e,unknownKeys:"strip",catchall:io.create(),typeName:lt.ZodObject,...vt(t)});var Uh=class extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function i(r){for(const o of r)if(o.result.status==="valid")return o.result;for(const o of r)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const n=r.map(o=>new tn(o.ctx.common.issues));return Ue(t,{code:Le.invalid_union,unionErrors:n}),ut}if(t.common.async)return Promise.all(s.map(async r=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await r._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(i);{let r;const n=[];for(const a of s){const l={...t,common:{...t.common,issues:[]},parent:null},u=a._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!r&&(r={result:u,ctx:l}),l.common.issues.length&&n.push(l.common.issues)}if(r)return t.common.issues.push(...r.ctx.common.issues),r.result;const o=n.map(a=>new tn(a));return Ue(t,{code:Le.invalid_union,unionErrors:o}),ut}}get options(){return this._def.options}};Uh.create=(e,t)=>new Uh({options:e,typeName:lt.ZodUnion,...vt(t)});var Gn=e=>e instanceof Kh?Gn(e.schema):e instanceof on?Gn(e.innerType()):e instanceof Yh?[e.value]:e instanceof Dp?e.options:e instanceof qh?It.objectValues(e.enum):e instanceof Qh?Gn(e._def.innerType):e instanceof Wh?[void 0]:e instanceof zh?[null]:e instanceof Dn?[void 0,...Gn(e.unwrap())]:e instanceof aa?[null,...Gn(e.unwrap())]:e instanceof Rx||e instanceof Jh?Gn(e.unwrap()):e instanceof Zh?Gn(e._def.innerType):[],I_=class N_ extends wt{_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==qe.object)return Ue(s,{code:Le.invalid_type,expected:qe.object,received:s.parsedType}),ut;const i=this.discriminator,r=s.data[i],n=this.optionsMap.get(r);return n?s.common.async?n._parseAsync({data:s.data,path:s.path,parent:s}):n._parseSync({data:s.data,path:s.path,parent:s}):(Ue(s,{code:Le.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),ut)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,s,i){const r=new Map;for(const n of s){const o=Gn(n.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const a of o){if(r.has(a))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(a)}`);r.set(a,n)}}return new N_({typeName:lt.ZodDiscriminatedUnion,discriminator:t,options:s,optionsMap:r,...vt(i)})}};function Gw(e,t){const s=jn(e),i=jn(t);if(e===t)return{valid:!0,data:e};if(s===qe.object&&i===qe.object){const r=It.objectKeys(t),n=It.objectKeys(e).filter(a=>r.indexOf(a)!==-1),o={...e,...t};for(const a of n){const l=Gw(e[a],t[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(s===qe.array&&i===qe.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const o=e[n],a=t[n],l=Gw(o,a);if(!l.valid)return{valid:!1};r.push(l.data)}return{valid:!0,data:r}}else return s===qe.date&&i===qe.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var $h=class extends wt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=(r,n)=>{if(kw(r)||kw(n))return ut;const o=Gw(r.value,n.value);return o.valid?((Mw(r)||Mw(n))&&t.dirty(),{status:t.value,value:o.data}):(Ue(s,{code:Le.invalid_intersection_types}),ut)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([r,n])=>i(r,n)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};$h.create=(e,t,s)=>new $h({left:e,right:t,typeName:lt.ZodIntersection,...vt(s)});var oa=class __ extends wt{_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.parsedType!==qe.array)return Ue(i,{code:Le.invalid_type,expected:qe.array,received:i.parsedType}),ut;if(i.data.length<this._def.items.length)return Ue(i,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ut;!this._def.rest&&i.data.length>this._def.items.length&&(Ue(i,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const n=[...i.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new _n(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(n).then(o=>Wi.mergeArray(s,o)):Wi.mergeArray(s,n)}get items(){return this._def.items}rest(t){return new __({...this._def,rest:t})}};oa.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new oa({items:e,typeName:lt.ZodTuple,rest:null,...vt(t)})};var k_=class Vw extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.parsedType!==qe.object)return Ue(i,{code:Le.invalid_type,expected:qe.object,received:i.parsedType}),ut;const r=[],n=this._def.keyType,o=this._def.valueType;for(const a in i.data)r.push({key:n._parse(new _n(i,a,i.path,a)),value:o._parse(new _n(i,i.data[a],i.path,a)),alwaysSet:a in i.data});return i.common.async?Wi.mergeObjectAsync(s,r):Wi.mergeObjectSync(s,r)}get element(){return this._def.valueType}static create(t,s,i){return s instanceof wt?new Vw({keyType:t,valueType:s,typeName:lt.ZodRecord,...vt(i)}):new Vw({keyType:lu.create(),valueType:t,typeName:lt.ZodRecord,...vt(s)})}},nm=class extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==qe.map)return Ue(s,{code:Le.invalid_type,expected:qe.map,received:s.parsedType}),ut;const i=this._def.keyType,r=this._def.valueType,n=[...s.data.entries()].map(([o,a],l)=>({key:i._parse(new _n(s,o,s.path,[l,"key"])),value:r._parse(new _n(s,a,s.path,[l,"value"]))}));if(s.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const a of n){const l=await a.key,u=await a.value;if(l.status==="aborted"||u.status==="aborted")return ut;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const a of n){const l=a.key,u=a.value;if(l.status==="aborted"||u.status==="aborted")return ut;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}}}};nm.create=(e,t,s)=>new nm({valueType:t,keyType:e,typeName:lt.ZodMap,...vt(s)});var om=class Bw extends wt{_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.parsedType!==qe.set)return Ue(i,{code:Le.invalid_type,expected:qe.set,received:i.parsedType}),ut;const r=this._def;r.minSize!==null&&i.data.size<r.minSize.value&&(Ue(i,{code:Le.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),s.dirty()),r.maxSize!==null&&i.data.size>r.maxSize.value&&(Ue(i,{code:Le.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),s.dirty());const n=this._def.valueType;function o(l){const u=new Set;for(const h of l){if(h.status==="aborted")return ut;h.status==="dirty"&&s.dirty(),u.add(h.value)}return{status:s.value,value:u}}const a=[...i.data.values()].map((l,u)=>n._parse(new _n(i,l,i.path,u)));return i.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(t,s){return new Bw({...this._def,minSize:{value:t,message:st.toString(s)}})}max(t,s){return new Bw({...this._def,maxSize:{value:t,message:st.toString(s)}})}size(t,s){return this.min(t,s).max(t,s)}nonempty(t){return this.min(1,t)}};om.create=(e,t)=>new om({valueType:e,minSize:null,maxSize:null,typeName:lt.ZodSet,...vt(t)});var M_=class zg extends wt{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==qe.function)return Ue(s,{code:Le.invalid_type,expected:qe.function,received:s.parsedType}),ut;function i(a,l){return tm({data:a,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,em(),au].filter(u=>!!u),issueData:{code:Le.invalid_arguments,argumentsError:l}})}function r(a,l){return tm({data:a,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,em(),au].filter(u=>!!u),issueData:{code:Le.invalid_return_type,returnTypeError:l}})}const n={errorMap:s.common.contextualErrorMap},o=s.data;if(this._def.returns instanceof uu){const a=this;return Ci(async function(...l){const u=new tn([]),h=await a._def.args.parseAsync(l,n).catch(m=>{throw u.addIssue(i(l,m)),u}),p=await Reflect.apply(o,this,h);return await a._def.returns._def.type.parseAsync(p,n).catch(m=>{throw u.addIssue(r(p,m)),u})})}else{const a=this;return Ci(function(...l){const u=a._def.args.safeParse(l,n);if(!u.success)throw new tn([i(l,u.error)]);const h=Reflect.apply(o,this,u.data),p=a._def.returns.safeParse(h,n);if(!p.success)throw new tn([r(h,p.error)]);return p.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new zg({...this._def,args:oa.create(t).rest(ul.create())})}returns(t){return new zg({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,s,i){return new zg({args:t||oa.create([]).rest(ul.create()),returns:s||ul.create(),typeName:lt.ZodFunction,...vt(i)})}},Kh=class extends wt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Kh.create=(e,t)=>new Kh({getter:e,typeName:lt.ZodLazy,...vt(t)});var Yh=class extends wt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Ue(t,{received:t.data,code:Le.invalid_literal,expected:this._def.value}),ut}return{status:"valid",value:e.data}}get value(){return this._def.value}};Yh.create=(e,t)=>new Yh({value:e,typeName:lt.ZodLiteral,...vt(t)});function L_(e,t){return new Dp({values:e,typeName:lt.ZodEnum,...vt(t)})}var Dp=class Hw extends wt{constructor(){super(...arguments),wd.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const s=this._getOrReturnCtx(t),i=this._def.values;return Ue(s,{expected:It.joinValues(i),received:s.parsedType,code:Le.invalid_type}),ut}if(sm(this,wd)||T_(this,wd,new Set(this._def.values)),!sm(this,wd).has(t.data)){const s=this._getOrReturnCtx(t),i=this._def.values;return Ue(s,{received:s.data,code:Le.invalid_enum_value,options:i}),ut}return Ci(t.data)}get options(){return this._def.values}get enum(){const t={};for(const s of this._def.values)t[s]=s;return t}get Values(){const t={};for(const s of this._def.values)t[s]=s;return t}get Enum(){const t={};for(const s of this._def.values)t[s]=s;return t}extract(t,s=this._def){return Hw.create(t,{...this._def,...s})}exclude(t,s=this._def){return Hw.create(this.options.filter(i=>!t.includes(i)),{...this._def,...s})}};wd=new WeakMap;Dp.create=L_;var qh=class extends wt{constructor(){super(...arguments),Sd.set(this,void 0)}_parse(e){const t=It.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==qe.string&&s.parsedType!==qe.number){const i=It.objectValues(t);return Ue(s,{expected:It.joinValues(i),received:s.parsedType,code:Le.invalid_type}),ut}if(sm(this,Sd)||T_(this,Sd,new Set(It.getValidEnumValues(this._def.values))),!sm(this,Sd).has(e.data)){const i=It.objectValues(t);return Ue(s,{received:s.data,code:Le.invalid_enum_value,options:i}),ut}return Ci(e.data)}get enum(){return this._def.values}};Sd=new WeakMap;qh.create=(e,t)=>new qh({values:e,typeName:lt.ZodNativeEnum,...vt(t)});var uu=class extends wt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==qe.promise&&t.common.async===!1)return Ue(t,{code:Le.invalid_type,expected:qe.promise,received:t.parsedType}),ut;const s=t.parsedType===qe.promise?t.data:Promise.resolve(t.data);return Ci(s.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}};uu.create=(e,t)=>new uu({type:e,typeName:lt.ZodPromise,...vt(t)});var on=class extends wt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===lt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:n=>{Ue(s,n),n.fatal?t.abort():t.dirty()},get path(){return s.path}};if(r.addIssue=r.addIssue.bind(r),i.type==="preprocess"){const n=i.transform(s.data,r);if(s.common.async)return Promise.resolve(n).then(async o=>{if(t.value==="aborted")return ut;const a=await this._def.schema._parseAsync({data:o,path:s.path,parent:s});return a.status==="aborted"?ut:a.status==="dirty"||t.value==="dirty"?mc(a.value):a});{if(t.value==="aborted")return ut;const o=this._def.schema._parseSync({data:n,path:s.path,parent:s});return o.status==="aborted"?ut:o.status==="dirty"||t.value==="dirty"?mc(o.value):o}}if(i.type==="refinement"){const n=o=>{const a=i.refinement(o,r);if(s.common.async)return Promise.resolve(a);if(a instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return o.status==="aborted"?ut:(o.status==="dirty"&&t.dirty(),n(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>o.status==="aborted"?ut:(o.status==="dirty"&&t.dirty(),n(o.value).then(()=>({status:t.value,value:o.value}))))}if(i.type==="transform")if(s.common.async===!1){const n=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Dl(n))return n;const o=i.transform(n.value,r);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(n=>Dl(n)?Promise.resolve(i.transform(n.value,r)).then(o=>({status:t.value,value:o})):n);It.assertNever(i)}};on.create=(e,t,s)=>new on({schema:e,typeName:lt.ZodEffects,effect:t,...vt(s)});on.createWithPreprocess=(e,t,s)=>new on({schema:t,effect:{type:"preprocess",transform:e},typeName:lt.ZodEffects,...vt(s)});var Dn=class extends wt{_parse(e){return this._getType(e)===qe.undefined?Ci(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Dn.create=(e,t)=>new Dn({innerType:e,typeName:lt.ZodOptional,...vt(t)});var aa=class extends wt{_parse(e){return this._getType(e)===qe.null?Ci(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};aa.create=(e,t)=>new aa({innerType:e,typeName:lt.ZodNullable,...vt(t)});var Qh=class extends wt{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===qe.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Qh.create=(e,t)=>new Qh({innerType:e,typeName:lt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...vt(t)});var Zh=class extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Gh(i)?i.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new tn(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new tn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};Zh.create=(e,t)=>new Zh({innerType:e,typeName:lt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...vt(t)});var am=class extends wt{_parse(e){if(this._getType(e)!==qe.nan){const s=this._getOrReturnCtx(e);return Ue(s,{code:Le.invalid_type,expected:qe.nan,received:s.parsedType}),ut}return{status:"valid",value:e.data}}};am.create=e=>new am({typeName:lt.ZodNaN,...vt(e)});var k5=Symbol("zod_brand"),Rx=class extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}},Tx=class O_ extends wt{_parse(t){const{status:s,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const n=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?ut:n.status==="dirty"?(s.dirty(),mc(n.value)):this._def.out._parseAsync({data:n.value,path:i.path,parent:i})})();{const r=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return r.status==="aborted"?ut:r.status==="dirty"?(s.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:i.path,parent:i})}}static create(t,s){return new O_({in:t,out:s,typeName:lt.ZodPipeline})}},Jh=class extends wt{_parse(e){const t=this._def.innerType._parse(e),s=i=>(Dl(i)&&(i.value=Object.freeze(i.value)),i);return Gh(t)?t.then(i=>s(i)):s(t)}unwrap(){return this._def.innerType}};Jh.create=(e,t)=>new Jh({innerType:e,typeName:lt.ZodReadonly,...vt(t)});function gT(e,t){const s=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof s=="string"?{message:s}:s}function G_(e,t={},s){return e?cu.create().superRefine((i,r)=>{var n,o;const a=e(i);if(a instanceof Promise)return a.then(l=>{var u,h;if(!l){const p=gT(t,i),g=(h=(u=p.fatal)!==null&&u!==void 0?u:s)!==null&&h!==void 0?h:!0;r.addIssue({code:"custom",...p,fatal:g})}});if(!a){const l=gT(t,i),u=(o=(n=l.fatal)!==null&&n!==void 0?n:s)!==null&&o!==void 0?o:!0;r.addIssue({code:"custom",...l,fatal:u})}}):cu.create()}var M5={object:Fr.lazycreate},lt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(lt||(lt={}));var L5=(e,t={message:`Input not instance of ${e.name}`})=>G_(s=>s instanceof e,t),V_=lu.create,B_=Vh.create,O5=am.create,G5=Bh.create,H_=Hh.create,V5=jh.create,B5=im.create,H5=Wh.create,j5=zh.create,W5=cu.create,z5=ul.create,U5=io.create,$5=rm.create,K5=Pl.create,Y5=Fr.create,q5=Fr.strictCreate,Q5=Uh.create,Z5=I_.create,J5=$h.create,X5=oa.create,e$=k_.create,t$=nm.create,s$=om.create,i$=M_.create,r$=Kh.create,n$=Yh.create,o$=Dp.create,a$=qh.create,l$=uu.create,fT=on.create,c$=Dn.create,u$=aa.create,d$=on.createWithPreprocess,h$=Tx.create,p$=()=>V_().optional(),g$=()=>B_().optional(),f$=()=>H_().optional(),m$={string:e=>lu.create({...e,coerce:!0}),number:e=>Vh.create({...e,coerce:!0}),boolean:e=>Hh.create({...e,coerce:!0}),bigint:e=>Bh.create({...e,coerce:!0}),date:e=>jh.create({...e,coerce:!0})},v$=ut,Bs=Object.freeze({__proto__:null,defaultErrorMap:au,setErrorMap:d5,getErrorMap:em,makeIssue:tm,EMPTY_PATH:h5,addIssueToContext:Ue,ParseStatus:Wi,INVALID:ut,DIRTY:mc,OK:Ci,isAborted:kw,isDirty:Mw,isValid:Dl,isAsync:Gh,get util(){return It},get objectUtil(){return _w},ZodParsedType:qe,getParsedType:jn,ZodType:wt,datetimeRegex:A_,ZodString:lu,ZodNumber:Vh,ZodBigInt:Bh,ZodBoolean:Hh,ZodDate:jh,ZodSymbol:im,ZodUndefined:Wh,ZodNull:zh,ZodAny:cu,ZodUnknown:ul,ZodNever:io,ZodVoid:rm,ZodArray:Pl,ZodObject:Fr,ZodUnion:Uh,ZodDiscriminatedUnion:I_,ZodIntersection:$h,ZodTuple:oa,ZodRecord:k_,ZodMap:nm,ZodSet:om,ZodFunction:M_,ZodLazy:Kh,ZodLiteral:Yh,ZodEnum:Dp,ZodNativeEnum:qh,ZodPromise:uu,ZodEffects:on,ZodTransformer:on,ZodOptional:Dn,ZodNullable:aa,ZodDefault:Qh,ZodCatch:Zh,ZodNaN:am,BRAND:k5,ZodBranded:Rx,ZodPipeline:Tx,ZodReadonly:Jh,custom:G_,Schema:wt,ZodSchema:wt,late:M5,get ZodFirstPartyTypeKind(){return lt},coerce:m$,any:W5,array:K5,bigint:G5,boolean:H_,date:V5,discriminatedUnion:Z5,effect:fT,enum:o$,function:i$,instanceof:L5,intersection:J5,lazy:r$,literal:n$,map:t$,nan:O5,nativeEnum:a$,never:U5,null:j5,nullable:u$,number:B_,object:Y5,oboolean:f$,onumber:g$,optional:c$,ostring:p$,pipeline:h$,preprocess:d$,promise:l$,record:e$,set:s$,strictObject:q5,string:V_,symbol:B5,transformer:fT,tuple:X5,undefined:H5,union:Q5,unknown:z5,void:$5,NEVER:v$,ZodIssueCode:Le,quotelessJson:u5,ZodError:tn}),mT={name:"@imgly/background-removal",version:"1.7.0"},C$=Bs.object({publicPath:Bs.string().optional().describe("The public path to the wasm files and the onnx model.").default("https://staticimgly.com/@imgly/background-removal-data/${PACKAGE_VERSION}/dist/").transform(e=>e.replace("${PACKAGE_NAME}",mT.name).replace("${PACKAGE_VERSION}",mT.version)),debug:Bs.boolean().default(!1).describe("Whether to enable debug logging."),rescale:Bs.boolean().default(!0).describe("Whether to rescale the image."),device:Bs.enum(["cpu","gpu"]).default("cpu").describe("The device to run the model on."),proxyToWorker:Bs.boolean().default(!1).describe("Whether to proxy inference to a web worker."),fetchArgs:Bs.any().default({}).describe("Arguments to pass to fetch when loading the model."),progress:Bs.function().args(Bs.string(),Bs.number(),Bs.number()).returns(Bs.void()).describe("Progress callback.").optional(),model:Bs.preprocess(e=>{switch(e){case"large":return"isnet";case"small":return"isnet_quint8";case"medium":return"isnet_fp16";default:return e}},Bs.enum(["isnet","isnet_fp16","isnet_quint8"])).default("medium"),output:Bs.object({format:Bs.enum(["image/png","image/jpeg","image/webp","image/x-rgba8","image/x-alpha8"]).default("image/png"),quality:Bs.number().default(.8)}).default({})}).default({}).transform(e=>(e.debug&&console.log("Config:",e),e.debug&&!e.progress&&(e.progress=e.progress??((t,s,i)=>{console.debug(`Downloading ${t}: ${s} of ${i}`)}),crossOriginIsolated||e.debug&&console.debug("Cross-Origin-Isolated is not enabled. Performance will be degraded. Please see  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer.")),e));function y$(e){return C$.parse(e??{})}var w$=vv(Cv());async function S$(e){e.debug&&console.debug("Loading model...",e.model);const t=e.model,i=await(await S_(`/models/${t}`,e)).arrayBuffer();return await l5(i,e)}async function x$(e){e=y$(e);const t=await S$(e);return{config:e,session:{base:t}}}async function E$(e,t,s){const[r,n,o]=e.shape,a=!1;let l=dT(e,1024,1024,a);const u=i5(l);let h=await c5(s.base,[["input",u]],["output"],t),p=(0,w$.default)(h[0].data,[1024,1024,1]),g=n5(p);return t.rescale?(g=dT(g,n,r,a),[g,e]):[g,l]}var b$=QU(x$,e=>JSON.stringify(e));async function R$(e,t){var g,m,C,y;const{config:s,session:i}=await b$(t);s.progress&&s.progress("compute:decode",0,4);const r=await r5(e,s);(g=s.progress)==null||g.call(s,"compute:inference",1,4);const[n,o]=await E$(r,s,i);(m=s.progress)==null||m.call(s,"compute:mask",2,4);const a=o,[l,u]=a.shape,h=l*u;for(let R=0;R<h;R+=1)a.data[4*R+3]=n.data[R];(C=s.progress)==null||C.call(s,"compute:encode",3,4);const p=await JU(a,s.output.quality,s.output.format);return(y=s.progress)==null||y.call(s,"compute:encode",4,4),p}/*! Bundled license information:

is-buffer/index.js:
  (*!
   * Determine if an object is a Buffer
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/const j_="https://rembg-service-128150759188.us-central1.run.app";async function T$(e){try{const t=await fetch(`${j_}/remove-background`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:e})});if(!t.ok)throw new Error(`Cloud service error: ${t.status}`);const s=await t.json();if(!s.success)throw new Error(s.error||"Unknown error");const i=s.imageData.split(",")[1],r=atob(i),n=new Uint8Array(r.length);for(let l=0;l<r.length;l++)n[l]=r.charCodeAt(l);const o=new Blob([n],{type:"image/png"});return{success:!0,processedUrl:URL.createObjectURL(o),blob:o,method:"cloud"}}catch(t){return console.error("Cloud background removal error:",t),{success:!1,error:t instanceof Error?t.message:String(t),method:"cloud"}}}async function D$(e,t){try{const s=await fetch(e);if(!s.ok)throw new Error(`Failed to fetch image: ${s.status}`);const i=await s.blob(),r=await R$(i,{progress:(o,a,l)=>{t&&l>0&&t(Math.round(a/l*100))}});return{success:!0,processedUrl:URL.createObjectURL(r),blob:r,method:"browser"}}catch(s){return console.error("Browser background removal error:",s),{success:!1,error:s instanceof Error?s.message:String(s),method:"browser"}}}async function W_(e,t,s){{const i=await T$(e);if(i.success)return i;console.warn("Cloud processing failed, falling back to browser:",i.error)}return D$(e,t)}async function P$(){try{return(await(await fetch(j_,{method:"GET"})).json()).status==="healthy"}catch{return!1}}function A$(e){return new Promise((t,s)=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.onerror=s,i.readAsDataURL(e)})}function Aa(e,t,s){if(t===null&&s===null)return{field:e,ours:t,theirs:s,difference:null,theirsIsBetter:!1,matches:!0};if(t===null&&s!==null)return{field:e,ours:t,theirs:s,difference:null,theirsIsBetter:!0,matches:!1};if(t!==null&&s===null)return{field:e,ours:t,theirs:s,difference:null,theirsIsBetter:!1,matches:!1};const i=t!==0?Math.abs((s-t)/t*100):s!==0?100:0,r=i<10;return{field:e,ours:t,theirs:s,difference:Math.round(i),theirsIsBetter:!1,matches:r}}function F$(e){const t=["calories","protein","carbs","fat","fiber","sugar","sodium"],s=e.filter(r=>t.includes(r.field));if(s.length===0)return 0;const i=s.filter(r=>r.matches).length;return Math.round(i/s.length*100)}const I$=({onClose:e,onImport:t,selectedFoods:s=[]})=>{const[i,r]=E.useState(""),[n,o]=E.useState(!1),[a,l]=E.useState(null),[u,h]=E.useState(!1),[p,g]=E.useState([]),[m,C]=E.useState(s.length>0),[y,R]=E.useState(0),[x,S]=E.useState(null);E.useEffect(()=>{s.length>0&&T()},[]);const T=async()=>{const b=s.filter(Z=>Z.barcode);if(b.length===0){g(s.map(Z=>({food:Z,offResult:null,offTransformed:null,isLoading:!1,error:"No barcode",comparison:[],hasImage:!1,hasBetterImage:!1,nutritionMatches:!1,nutritionScore:0,isApplying:!1,applied:"none",isCleaningImage:!1,cleaningProgress:0,cleanedImageUrl:null,cleanedImageBlob:null})));return}g(s.map(Z=>({food:Z,offResult:null,offTransformed:null,isLoading:!!Z.barcode,error:Z.barcode?void 0:"No barcode",comparison:[],hasImage:!1,hasBetterImage:!1,nutritionMatches:!1,nutritionScore:0,isApplying:!1,applied:"none",isCleaningImage:!1,cleaningProgress:0,cleanedImageUrl:null,cleanedImageBlob:null})));let F=0;for(const Z of s)if(Z.barcode){try{const K=await BR(Z.barcode,"UK");if(K.product){const ge=NC(K.product),me=[Aa("calories",Z.calories,ge.calories),Aa("protein",Z.protein,ge.protein),Aa("carbs",Z.carbs,ge.carbs),Aa("fat",Z.fat,ge.fat),Aa("fiber",Z.fiber,ge.fiber),Aa("sugar",Z.sugar,ge.sugar),Aa("sodium",Z.sodium,ge.sodium)],de=F$(me),ye=!!K.bestImageUrl,pe=ye&&(!Z.imageUrl||Z.imageUrl.includes("placeholder"));g(q=>q.map(ve=>ve.food._id===Z._id?{...ve,offResult:K,offTransformed:ge,isLoading:!1,comparison:me,hasImage:ye,hasBetterImage:pe,nutritionMatches:de>=70,nutritionScore:de}:ve))}else g(ge=>ge.map(me=>me.food._id===Z._id?{...me,offResult:K,isLoading:!1,error:"Not found in OFF"}:me))}catch(K){g(ge=>ge.map(me=>me.food._id===Z._id?{...me,isLoading:!1,error:String(K)}:me))}F++,R(Math.round(F/b.length*100))}},I=async b=>{var F;if((F=b.offResult)!=null&&F.bestImageUrl){g(Z=>Z.map(K=>K.food._id===b.food._id?{...K,isApplying:!0}:K));try{await yd(b.food,{imageUrl:b.offResult.bestImageUrl}),g(Z=>Z.map(K=>K.food._id===b.food._id?{...K,isApplying:!1,applied:"image"}:K))}catch(Z){console.error("Failed to apply image:",Z),alert(`Failed to apply image: ${Z}`),g(K=>K.map(ge=>ge.food._id===b.food._id?{...ge,isApplying:!1}:ge))}}},V=async b=>{if(b.offTransformed){g(F=>F.map(Z=>Z.food._id===b.food._id?{...Z,isApplying:!0}:Z));try{await yd(b.food,{calories:b.offTransformed.calories,protein:b.offTransformed.protein,carbs:b.offTransformed.carbs,fat:b.offTransformed.fat,saturatedFat:b.offTransformed.saturatedFat,fiber:b.offTransformed.fiber,sugar:b.offTransformed.sugar,sodium:b.offTransformed.sodium,salt:b.offTransformed.salt}),g(F=>F.map(Z=>Z.food._id===b.food._id?{...Z,isApplying:!1,applied:"nutrition"}:Z))}catch(F){console.error("Failed to apply nutrition:",F),alert(`Failed to apply nutrition: ${F}`),g(Z=>Z.map(K=>K.food._id===b.food._id?{...K,isApplying:!1}:K))}}},H=async b=>{if(!(!b.offTransformed||!b.offResult)){g(F=>F.map(Z=>Z.food._id===b.food._id?{...Z,isApplying:!0}:Z));try{await yd(b.food,{imageUrl:b.offResult.bestImageUrl||b.food.imageUrl,calories:b.offTransformed.calories,protein:b.offTransformed.protein,carbs:b.offTransformed.carbs,fat:b.offTransformed.fat,saturatedFat:b.offTransformed.saturatedFat,fiber:b.offTransformed.fiber,sugar:b.offTransformed.sugar,sodium:b.offTransformed.sodium,salt:b.offTransformed.salt,ingredientsText:b.offTransformed.ingredientsText||b.food.ingredientsText}),g(F=>F.map(Z=>Z.food._id===b.food._id?{...Z,isApplying:!1,applied:"all"}:Z))}catch(F){console.error("Failed to apply all:",F),alert(`Failed to apply changes: ${F}`),g(Z=>Z.map(K=>K.food._id===b.food._id?{...K,isApplying:!1}:K))}}},P=async b=>{var Z;const F=((Z=b.offResult)==null?void 0:Z.bestImageUrl)||b.food.imageUrl;if(F){g(K=>K.map(ge=>ge.food._id===b.food._id?{...ge,isCleaningImage:!0,cleaningProgress:0}:ge));try{const K=await W_(F,ge=>{g(me=>me.map(de=>de.food._id===b.food._id?{...de,cleaningProgress:ge}:de))});if(K.success&&K.processedUrl&&K.blob)g(ge=>ge.map(me=>me.food._id===b.food._id?{...me,isCleaningImage:!1,cleanedImageUrl:K.processedUrl,cleanedImageBlob:K.blob}:me));else throw new Error(K.error||"Failed to process image")}catch(K){console.error("Failed to clean image:",K),alert(`Failed to clean image: ${K}`),g(ge=>ge.map(me=>me.food._id===b.food._id?{...me,isCleaningImage:!1}:me))}}},N=async b=>{if(b.cleanedImageBlob){g(F=>F.map(Z=>Z.food._id===b.food._id?{...Z,isApplying:!0}:Z));try{const F=await A$(b.cleanedImageBlob);await yd(b.food,{imageUrl:F}),g(Z=>Z.map(K=>K.food._id===b.food._id?{...K,isApplying:!1,applied:"image"}:K))}catch(F){console.error("Failed to apply cleaned image:",F),alert(`Failed to apply cleaned image: ${F}`),g(Z=>Z.map(K=>K.food._id===b.food._id?{...K,isApplying:!1}:K))}}},_=E.useCallback(async()=>{if(i.trim()){o(!0),l(null);try{const b=await BR(i.trim(),"UK");l(b)}catch(b){console.error("Lookup error:",b),l({product:null,isUKProduct:!1,ukConfidenceScore:0,ukSignals:[],bestImageUrl:null,imageConfidenceScore:0,isRegionMatch:!1,error:String(b)})}finally{o(!1)}}},[i]),L=E.useCallback(async()=>{var b,F,Z;if(a!=null&&a.product){h(!0);try{const K=NC(a.product),ge=await tz({objectID:`off_${a.product.code}`,name:K.name,brandName:K.brandName,barcode:K.barcode,barcodes:[a.product.code],ingredients:((b=K.ingredientsText)==null?void 0:b.split(/,\s*/))||[],ingredientsText:K.ingredientsText,calories:K.calories,protein:K.protein,carbs:K.carbs,fat:K.fat,saturatedFat:K.saturatedFat,fiber:K.fiber,sugar:K.sugar,sodium:K.sodium,salt:K.salt,servingDescription:a.product.serving_size||null,servingSizeG:null,isPerUnit:!1,isVerified:!1,verifiedBy:null,verifiedAt:null,imageUrl:a.bestImageUrl,category:((Z=(F=a.product.categories)==null?void 0:F.split(",")[0])==null?void 0:Z.trim())||null,source:"OpenFoodFacts",createdAt:new Date,updatedAt:new Date});ge.success?(t(),e(),r(""),l(null)):alert(`Failed to import: ${ge.error}`)}catch(K){console.error("Import error:",K),alert(`Import error: ${K}`)}finally{h(!1)}}},[a,t,e]),M=E.useCallback(b=>{b.key==="Enter"&&i.trim()&&_(),b.key==="Escape"&&e()},[i,_,e]);return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"OpenFoodFacts Lookup"}),c.jsx("p",{className:"text-sm text-gray-500",children:m?`Checking ${s.length} selected item${s.length>1?"s":""} for UK products`:"Smart UK product detection"})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[s.length>0&&c.jsx("button",{onClick:()=>C(!m),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-lg hover:bg-gray-50",children:m?"Manual Search":`Back to Selected (${s.length})`}),c.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),m?c.jsxs(c.Fragment,{children:[y>0&&y<100&&c.jsx("div",{className:"px-6 py-2 bg-gray-50 border-b border-gray-100",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all",style:{width:`${y}%`}})}),c.jsxs("span",{className:"text-sm text-gray-500",children:[y,"%"]})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-gray-200",children:p.map(b=>{var F,Z,K,ge;return c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Ours"}),b.food.imageUrl?c.jsx("img",{src:b.food.imageUrl,alt:"",className:"w-16 h-16 object-cover rounded border border-gray-200"}):c.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs",children:"None"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"OFF"}),(F=b.offResult)!=null&&F.bestImageUrl?c.jsx("img",{src:b.offResult.bestImageUrl,alt:"",className:"w-16 h-16 object-cover rounded border-2 border-green-400"}):c.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs",children:b.isLoading?"...":"None"})]}),(b.cleanedImageUrl||b.isCleaningImage)&&c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs text-orange-500 mb-1 font-medium",children:"Cleaned"}),b.cleanedImageUrl?c.jsx("img",{src:b.cleanedImageUrl,alt:"Cleaned",className:"w-16 h-16 object-contain rounded border-2 border-orange-400 bg-white",style:{imageRendering:"auto"}}):c.jsx("div",{className:"w-16 h-16 bg-orange-50 rounded border-2 border-orange-200 flex items-center justify-center",children:c.jsxs("svg",{className:"w-5 h-5 animate-spin text-orange-500",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})})]})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:b.food.name}),b.food.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:b.food.brandName}),c.jsx("p",{className:"text-xs text-gray-400 font-mono mt-1",children:b.food.barcode||"No barcode"})]}),c.jsxs("div",{className:"flex flex-col items-end gap-1",children:[b.isLoading?c.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Searching"]}):b.error?c.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:b.error}):(Z=b.offResult)!=null&&Z.product?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${b.offResult.isUKProduct?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:b.offResult.isUKProduct?` UK (${b.offResult.ukConfidenceScore}%)`:` Non-UK (${b.offResult.ukConfidenceScore}%)`}),c.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${b.nutritionScore>=70?"bg-green-100 text-green-700":b.nutritionScore>=40?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:["Nutrition: ",b.nutritionScore,"% match"]}),b.hasBetterImage&&c.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:"Better image available"})]}):c.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-500 rounded-full",children:"Not in OFF"}),b.applied!=="none"&&c.jsxs("span",{className:"px-2 py-1 text-xs bg-green-500 text-white rounded-full",children:[" Applied ",b.applied]})]})]}),((K=b.offResult)==null?void 0:K.product)&&b.comparison.length>0&&c.jsxs("div",{className:"mt-3",children:[c.jsxs("button",{onClick:()=>S(x===b.food._id?null:b.food._id),className:"text-xs text-primary-600 hover:underline",children:[x===b.food._id?"Hide":"Show"," nutrition comparison"]}),x===b.food._id&&c.jsxs("div",{className:"mt-2 grid grid-cols-7 gap-1 text-xs",children:[c.jsx("div",{className:"font-medium text-gray-500"}),b.comparison.slice(0,6).map(me=>c.jsx("div",{className:"font-medium text-gray-500 text-center capitalize",children:me.field.slice(0,3)},me.field)),c.jsx("div",{className:"text-gray-500",children:"Ours"}),b.comparison.slice(0,6).map(me=>c.jsx("div",{className:"text-center text-gray-700",children:me.ours!==null?me.ours:"-"},`ours-${me.field}`)),c.jsx("div",{className:"text-gray-500",children:"OFF"}),b.comparison.slice(0,6).map(me=>c.jsx("div",{className:`text-center ${me.matches?"text-green-600":me.difference&&me.difference>20?"text-red-600 font-medium":"text-yellow-600"}`,children:me.theirs!==null?me.theirs:"-"},`theirs-${me.field}`)),c.jsx("div",{className:"text-gray-400",children:"Diff"}),b.comparison.slice(0,6).map(me=>c.jsx("div",{className:`text-center text-xs ${me.matches?"text-green-500":me.difference&&me.difference>20?"text-red-500":"text-yellow-500"}`,children:me.difference!==null?`${me.difference}%`:"-"},`diff-${me.field}`))]})]})]}),((ge=b.offResult)==null?void 0:ge.product)&&b.applied==="none"&&c.jsx("div",{className:"flex flex-col gap-2 flex-shrink-0",children:b.isApplying?c.jsx("div",{className:"flex items-center justify-center p-4",children:c.jsxs("svg",{className:"w-5 h-5 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}):c.jsxs(c.Fragment,{children:[(b.hasImage||b.food.imageUrl)&&!b.cleanedImageUrl&&c.jsx("button",{onClick:()=>P(b),disabled:b.isCleaningImage,className:"px-3 py-1.5 text-xs bg-orange-50 text-orange-700 rounded hover:bg-orange-100 whitespace-nowrap disabled:opacity-50",children:b.isCleaningImage?c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),b.cleaningProgress,"%"]}):"Clean Image"}),b.cleanedImageUrl&&c.jsx("button",{onClick:()=>N(b),className:"px-3 py-1.5 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 whitespace-nowrap font-medium",children:"Apply Cleaned"}),b.hasImage&&!b.cleanedImageUrl&&c.jsx("button",{onClick:()=>I(b),className:"px-3 py-1.5 text-xs bg-blue-50 text-blue-700 rounded hover:bg-blue-100 whitespace-nowrap",children:"Apply Original"}),c.jsx("button",{onClick:()=>V(b),className:"px-3 py-1.5 text-xs bg-purple-50 text-purple-700 rounded hover:bg-purple-100 whitespace-nowrap",children:"Apply Nutrition"}),c.jsx("button",{onClick:()=>H(b),className:"px-3 py-1.5 text-xs bg-green-600 text-white rounded hover:bg-green-700 whitespace-nowrap font-medium",children:"Apply All"})]})})]})},b.food._id)})}),c.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[c.jsxs("span",{className:"text-gray-500",children:["Found: ",c.jsx("span",{className:"font-medium text-green-600",children:p.filter(b=>{var F;return(F=b.offResult)==null?void 0:F.product}).length})]}),c.jsxs("span",{className:"text-gray-500",children:["UK: ",c.jsx("span",{className:"font-medium text-green-600",children:p.filter(b=>{var F;return(F=b.offResult)==null?void 0:F.isUKProduct}).length})]}),c.jsxs("span",{className:"text-gray-500",children:["Better Images: ",c.jsx("span",{className:"font-medium text-blue-600",children:p.filter(b=>b.hasBetterImage).length})]}),c.jsxs("span",{className:"text-gray-500",children:["Applied: ",c.jsx("span",{className:"font-medium text-green-600",children:p.filter(b=>b.applied!=="none").length})]})]}),c.jsx("div",{className:"flex gap-2",children:c.jsx("button",{onClick:()=>{t(),e()},className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Done"})})]})})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-100",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("input",{type:"text",value:i,onChange:b=>r(b.target.value),onKeyDown:M,placeholder:"Enter barcode (e.g., 5000128000000)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",autoFocus:!m}),c.jsxs("button",{onClick:_,disabled:!i.trim()||n,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[n?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c.jsx("span",{children:"Search"})]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[(a==null?void 0:a.error)&&!a.product&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:[c.jsx("p",{className:"font-medium",children:"Error"}),c.jsx("p",{className:"text-sm",children:a.error})]}),(a==null?void 0:a.product)&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex gap-6",children:[c.jsxs("div",{className:"flex-shrink-0",children:[a.bestImageUrl?c.jsx("img",{src:a.bestImageUrl,alt:a.product.product_name||"Product",className:"w-32 h-32 object-cover rounded-lg border border-gray-200"}):c.jsx("div",{className:"w-32 h-32 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400",children:c.jsx("span",{className:"text-sm",children:"No image"})}),a.imageConfidenceScore>0&&c.jsxs("div",{className:"mt-2 text-xs text-center text-gray-500",children:["Image score: ",a.imageConfidenceScore,"/10",a.isRegionMatch&&c.jsx("span",{className:"ml-1 text-green-600",children:"UK"})]})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.product.product_name_en||a.product.product_name||"Unknown Product"}),a.product.brands&&c.jsx("p",{className:"text-gray-600",children:a.product.brands}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Barcode: ",a.product.code]}),c.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[c.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${a.isUKProduct?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:a.isUKProduct?" UK Product":" Non-UK Product"}),c.jsxs("span",{className:"text-sm text-gray-500",children:[a.ukConfidenceScore,"% confidence"]})]})]})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"UK Detection Signals"]}),c.jsx("div",{className:"space-y-2",children:a.ukSignals.map((b,F)=>c.jsxs("div",{className:`flex items-start gap-3 p-2 rounded ${b.matched?"bg-green-50":"bg-white"}`,children:[c.jsx("div",{className:`mt-0.5 ${b.matched?"text-green-600":"text-gray-400"}`,children:b.matched?c.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):c.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:`text-sm font-medium ${b.matched?"text-green-800":"text-gray-600"}`,children:b.signal}),c.jsxs("span",{className:"text-xs text-gray-400",children:["Weight: ",b.weight]})]}),b.details&&c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:b.details})]})]},F))})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Nutrition (per 100g)"}),c.jsx("div",{className:"grid grid-cols-4 gap-3",children:(()=>{const b=NC(a.product);return c.jsxs(c.Fragment,{children:[c.jsx(yo,{label:"Calories",value:b.calories,unit:"kcal"}),c.jsx(yo,{label:"Protein",value:b.protein,unit:"g"}),c.jsx(yo,{label:"Carbs",value:b.carbs,unit:"g"}),c.jsx(yo,{label:"Fat",value:b.fat,unit:"g"}),c.jsx(yo,{label:"Sat. Fat",value:b.saturatedFat,unit:"g"}),c.jsx(yo,{label:"Fibre",value:b.fiber,unit:"g"}),c.jsx(yo,{label:"Sugar",value:b.sugar,unit:"g"}),c.jsx(yo,{label:"Salt",value:b.salt,unit:"g"})]})})()})]}),a.product.ingredients_text_en||a.product.ingredients_text?c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Ingredients"}),c.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:a.product.ingredients_text_en||a.product.ingredients_text})]}):null]}),!a&&!n&&c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),c.jsx("p",{children:"Enter a barcode to search OpenFoodFacts"}),c.jsx("p",{className:"text-sm mt-1",children:"UK products will be automatically detected"})]})]}),(a==null?void 0:a.product)&&c.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-gray-50",children:[c.jsx("div",{className:"text-sm text-gray-500",children:!a.isUKProduct&&c.jsx("span",{className:"text-yellow-600",children:"This may not be a UK product. Import with caution."})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100",children:"Cancel"}),c.jsxs("button",{onClick:L,disabled:u,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 flex items-center gap-2",children:[u?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),c.jsx("span",{children:"Import to Database"})]})]})]})]})]})})},yo=({label:e,value:t,unit:s})=>c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[c.jsx("p",{className:"text-xs text-gray-500",children:e}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t!==null?t.toFixed(1):"-"}),c.jsx("p",{className:"text-xs text-gray-400",children:s})]});function ro(e){return Array.isArray?Array.isArray(e):$_(e)==="[object Array]"}function N$(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function _$(e){return e==null?"":N$(e)}function Sn(e){return typeof e=="string"}function z_(e){return typeof e=="number"}function k$(e){return e===!0||e===!1||M$(e)&&$_(e)=="[object Boolean]"}function U_(e){return typeof e=="object"}function M$(e){return U_(e)&&e!==null}function tr(e){return e!=null}function HC(e){return!e.trim().length}function $_(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const L$="Incorrect 'index' type",O$=e=>`Invalid value for key ${e}`,G$=e=>`Pattern length exceeds max of ${e}.`,V$=e=>`Missing ${e} property in key`,B$=e=>`Property 'weight' in key '${e}' must be a positive integer`,vT=Object.prototype.hasOwnProperty;class H${constructor(t){this._keys=[],this._keyMap={};let s=0;t.forEach(i=>{let r=K_(i);this._keys.push(r),this._keyMap[r.id]=r,s+=r.weight}),this._keys.forEach(i=>{i.weight/=s})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function K_(e){let t=null,s=null,i=null,r=1,n=null;if(Sn(e)||ro(e))i=e,t=CT(e),s=jw(e);else{if(!vT.call(e,"name"))throw new Error(V$("name"));const o=e.name;if(i=o,vT.call(e,"weight")&&(r=e.weight,r<=0))throw new Error(B$(o));t=CT(o),s=jw(o),n=e.getFn}return{path:t,id:s,weight:r,src:i,getFn:n}}function CT(e){return ro(e)?e:e.split(".")}function jw(e){return ro(e)?e.join("."):e}function j$(e,t){let s=[],i=!1;const r=(n,o,a)=>{if(tr(n))if(!o[a])s.push(n);else{let l=o[a];const u=n[l];if(!tr(u))return;if(a===o.length-1&&(Sn(u)||z_(u)||k$(u)))s.push(_$(u));else if(ro(u)){i=!0;for(let h=0,p=u.length;h<p;h+=1)r(u[h],o,a+1)}else o.length&&r(u,o,a+1)}};return r(e,Sn(t)?t.split("."):t,0),i?s:s[0]}const W$={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},z$={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},U$={location:0,threshold:.6,distance:100},$$={useExtendedSearch:!1,getFn:j$,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var ct={...z$,...W$,...U$,...$$};const K$=/[^ ]+/g;function Y$(e=1,t=3){const s=new Map,i=Math.pow(10,t);return{get(r){const n=r.match(K$).length;if(s.has(n))return s.get(n);const o=1/Math.pow(n,.5*e),a=parseFloat(Math.round(o*i)/i);return s.set(n,a),a},clear(){s.clear()}}}class Dx{constructor({getFn:t=ct.getFn,fieldNormWeight:s=ct.fieldNormWeight}={}){this.norm=Y$(s,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((s,i)=>{this._keysMap[s.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Sn(this.docs[0])?this.docs.forEach((t,s)=>{this._addString(t,s)}):this.docs.forEach((t,s)=>{this._addObject(t,s)}),this.norm.clear())}add(t){const s=this.size();Sn(t)?this._addString(t,s):this._addObject(t,s)}removeAt(t){this.records.splice(t,1);for(let s=t,i=this.size();s<i;s+=1)this.records[s].i-=1}getValueForItemAtKeyId(t,s){return t[this._keysMap[s]]}size(){return this.records.length}_addString(t,s){if(!tr(t)||HC(t))return;let i={v:t,i:s,n:this.norm.get(t)};this.records.push(i)}_addObject(t,s){let i={i:s,$:{}};this.keys.forEach((r,n)=>{let o=r.getFn?r.getFn(t):this.getFn(t,r.path);if(tr(o)){if(ro(o)){let a=[];const l=[{nestedArrIndex:-1,value:o}];for(;l.length;){const{nestedArrIndex:u,value:h}=l.pop();if(tr(h))if(Sn(h)&&!HC(h)){let p={v:h,i:u,n:this.norm.get(h)};a.push(p)}else ro(h)&&h.forEach((p,g)=>{l.push({nestedArrIndex:g,value:p})})}i.$[n]=a}else if(Sn(o)&&!HC(o)){let a={v:o,n:this.norm.get(o)};i.$[n]=a}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function Y_(e,t,{getFn:s=ct.getFn,fieldNormWeight:i=ct.fieldNormWeight}={}){const r=new Dx({getFn:s,fieldNormWeight:i});return r.setKeys(e.map(K_)),r.setSources(t),r.create(),r}function q$(e,{getFn:t=ct.getFn,fieldNormWeight:s=ct.fieldNormWeight}={}){const{keys:i,records:r}=e,n=new Dx({getFn:t,fieldNormWeight:s});return n.setKeys(i),n.setIndexRecords(r),n}function hg(e,{errors:t=0,currentLocation:s=0,expectedLocation:i=0,distance:r=ct.distance,ignoreLocation:n=ct.ignoreLocation}={}){const o=t/e.length;if(n)return o;const a=Math.abs(i-s);return r?o+a/r:a?1:o}function Q$(e=[],t=ct.minMatchCharLength){let s=[],i=-1,r=-1,n=0;for(let o=e.length;n<o;n+=1){let a=e[n];a&&i===-1?i=n:!a&&i!==-1&&(r=n-1,r-i+1>=t&&s.push([i,r]),i=-1)}return e[n-1]&&n-i>=t&&s.push([i,n-1]),s}const Ha=32;function Z$(e,t,s,{location:i=ct.location,distance:r=ct.distance,threshold:n=ct.threshold,findAllMatches:o=ct.findAllMatches,minMatchCharLength:a=ct.minMatchCharLength,includeMatches:l=ct.includeMatches,ignoreLocation:u=ct.ignoreLocation}={}){if(t.length>Ha)throw new Error(G$(Ha));const h=t.length,p=e.length,g=Math.max(0,Math.min(i,p));let m=n,C=g;const y=a>1||l,R=y?Array(p):[];let x;for(;(x=e.indexOf(t,C))>-1;){let P=hg(t,{currentLocation:x,expectedLocation:g,distance:r,ignoreLocation:u});if(m=Math.min(P,m),C=x+h,y){let N=0;for(;N<h;)R[x+N]=1,N+=1}}C=-1;let S=[],T=1,I=h+p;const V=1<<h-1;for(let P=0;P<h;P+=1){let N=0,_=I;for(;N<_;)hg(t,{errors:P,currentLocation:g+_,expectedLocation:g,distance:r,ignoreLocation:u})<=m?N=_:I=_,_=Math.floor((I-N)/2+N);I=_;let L=Math.max(1,g-_+1),M=o?p:Math.min(g+_,p)+h,b=Array(M+2);b[M+1]=(1<<P)-1;for(let Z=M;Z>=L;Z-=1){let K=Z-1,ge=s[e.charAt(K)];if(y&&(R[K]=+!!ge),b[Z]=(b[Z+1]<<1|1)&ge,P&&(b[Z]|=(S[Z+1]|S[Z])<<1|1|S[Z+1]),b[Z]&V&&(T=hg(t,{errors:P,currentLocation:K,expectedLocation:g,distance:r,ignoreLocation:u}),T<=m)){if(m=T,C=K,C<=g)break;L=Math.max(1,2*g-C)}}if(hg(t,{errors:P+1,currentLocation:g,expectedLocation:g,distance:r,ignoreLocation:u})>m)break;S=b}const H={isMatch:C>=0,score:Math.max(.001,T)};if(y){const P=Q$(R,a);P.length?l&&(H.indices=P):H.isMatch=!1}return H}function J$(e){let t={};for(let s=0,i=e.length;s<i;s+=1){const r=e.charAt(s);t[r]=(t[r]||0)|1<<i-s-1}return t}const lm=String.prototype.normalize?e=>e.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):e=>e;class q_{constructor(t,{location:s=ct.location,threshold:i=ct.threshold,distance:r=ct.distance,includeMatches:n=ct.includeMatches,findAllMatches:o=ct.findAllMatches,minMatchCharLength:a=ct.minMatchCharLength,isCaseSensitive:l=ct.isCaseSensitive,ignoreDiacritics:u=ct.ignoreDiacritics,ignoreLocation:h=ct.ignoreLocation}={}){if(this.options={location:s,threshold:i,distance:r,includeMatches:n,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:l,ignoreDiacritics:u,ignoreLocation:h},t=l?t:t.toLowerCase(),t=u?lm(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const p=(m,C)=>{this.chunks.push({pattern:m,alphabet:J$(m),startIndex:C})},g=this.pattern.length;if(g>Ha){let m=0;const C=g%Ha,y=g-C;for(;m<y;)p(this.pattern.substr(m,Ha),m),m+=Ha;if(C){const R=g-Ha;p(this.pattern.substr(R),R)}}else p(this.pattern,0)}searchIn(t){const{isCaseSensitive:s,ignoreDiacritics:i,includeMatches:r}=this.options;if(t=s?t:t.toLowerCase(),t=i?lm(t):t,this.pattern===t){let y={isMatch:!0,score:0};return r&&(y.indices=[[0,t.length-1]]),y}const{location:n,distance:o,threshold:a,findAllMatches:l,minMatchCharLength:u,ignoreLocation:h}=this.options;let p=[],g=0,m=!1;this.chunks.forEach(({pattern:y,alphabet:R,startIndex:x})=>{const{isMatch:S,score:T,indices:I}=Z$(t,y,R,{location:n+x,distance:o,threshold:a,findAllMatches:l,minMatchCharLength:u,includeMatches:r,ignoreLocation:h});S&&(m=!0),g+=T,S&&I&&(p=[...p,...I])});let C={isMatch:m,score:m?g/this.chunks.length:1};return m&&r&&(C.indices=p),C}}class wa{constructor(t){this.pattern=t}static isMultiMatch(t){return yT(t,this.multiRegex)}static isSingleMatch(t){return yT(t,this.singleRegex)}search(){}}function yT(e,t){const s=e.match(t);return s?s[1]:null}class X$ extends wa{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const s=t===this.pattern;return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class e3 extends wa{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const i=t.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,t.length-1]}}}class t3 extends wa{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const s=t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class s3 extends wa{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const s=!t.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class i3 extends wa{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const s=t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class r3 extends wa{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const s=!t.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class Q_ extends wa{constructor(t,{location:s=ct.location,threshold:i=ct.threshold,distance:r=ct.distance,includeMatches:n=ct.includeMatches,findAllMatches:o=ct.findAllMatches,minMatchCharLength:a=ct.minMatchCharLength,isCaseSensitive:l=ct.isCaseSensitive,ignoreDiacritics:u=ct.ignoreDiacritics,ignoreLocation:h=ct.ignoreLocation}={}){super(t),this._bitapSearch=new q_(t,{location:s,threshold:i,distance:r,includeMatches:n,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:l,ignoreDiacritics:u,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class Z_ extends wa{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let s=0,i;const r=[],n=this.pattern.length;for(;(i=t.indexOf(this.pattern,s))>-1;)s=i+n,r.push([i,s-1]);const o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}const Ww=[X$,Z_,t3,s3,r3,i3,e3,Q_],wT=Ww.length,n3=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,o3="|";function a3(e,t={}){return e.split(o3).map(s=>{let i=s.trim().split(n3).filter(n=>n&&!!n.trim()),r=[];for(let n=0,o=i.length;n<o;n+=1){const a=i[n];let l=!1,u=-1;for(;!l&&++u<wT;){const h=Ww[u];let p=h.isMultiMatch(a);p&&(r.push(new h(p,t)),l=!0)}if(!l)for(u=-1;++u<wT;){const h=Ww[u];let p=h.isSingleMatch(a);if(p){r.push(new h(p,t));break}}}return r})}const l3=new Set([Q_.type,Z_.type]);class c3{constructor(t,{isCaseSensitive:s=ct.isCaseSensitive,ignoreDiacritics:i=ct.ignoreDiacritics,includeMatches:r=ct.includeMatches,minMatchCharLength:n=ct.minMatchCharLength,ignoreLocation:o=ct.ignoreLocation,findAllMatches:a=ct.findAllMatches,location:l=ct.location,threshold:u=ct.threshold,distance:h=ct.distance}={}){this.query=null,this.options={isCaseSensitive:s,ignoreDiacritics:i,includeMatches:r,minMatchCharLength:n,findAllMatches:a,ignoreLocation:o,location:l,threshold:u,distance:h},t=s?t:t.toLowerCase(),t=i?lm(t):t,this.pattern=t,this.query=a3(this.pattern,this.options)}static condition(t,s){return s.useExtendedSearch}searchIn(t){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:i,isCaseSensitive:r,ignoreDiacritics:n}=this.options;t=r?t:t.toLowerCase(),t=n?lm(t):t;let o=0,a=[],l=0;for(let u=0,h=s.length;u<h;u+=1){const p=s[u];a.length=0,o=0;for(let g=0,m=p.length;g<m;g+=1){const C=p[g],{isMatch:y,indices:R,score:x}=C.search(t);if(y){if(o+=1,l+=x,i){const S=C.constructor.type;l3.has(S)?a=[...a,...R]:a.push(R)}}else{l=0,o=0,a.length=0;break}}if(o){let g={isMatch:!0,score:l/o};return i&&(g.indices=a),g}}return{isMatch:!1,score:1}}}const zw=[];function u3(...e){zw.push(...e)}function Uw(e,t){for(let s=0,i=zw.length;s<i;s+=1){let r=zw[s];if(r.condition(e,t))return new r(e,t)}return new q_(e,t)}const cm={AND:"$and",OR:"$or"},$w={PATH:"$path",PATTERN:"$val"},Kw=e=>!!(e[cm.AND]||e[cm.OR]),d3=e=>!!e[$w.PATH],h3=e=>!ro(e)&&U_(e)&&!Kw(e),ST=e=>({[cm.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function J_(e,t,{auto:s=!0}={}){const i=r=>{let n=Object.keys(r);const o=d3(r);if(!o&&n.length>1&&!Kw(r))return i(ST(r));if(h3(r)){const l=o?r[$w.PATH]:n[0],u=o?r[$w.PATTERN]:r[l];if(!Sn(u))throw new Error(O$(l));const h={keyId:jw(l),pattern:u};return s&&(h.searcher=Uw(u,t)),h}let a={children:[],operator:n[0]};return n.forEach(l=>{const u=r[l];ro(u)&&u.forEach(h=>{a.children.push(i(h))})}),a};return Kw(e)||(e=ST(e)),i(e)}function p3(e,{ignoreFieldNorm:t=ct.ignoreFieldNorm}){e.forEach(s=>{let i=1;s.matches.forEach(({key:r,norm:n,score:o})=>{const a=r?r.weight:null;i*=Math.pow(o===0&&a?Number.EPSILON:o,(a||1)*(t?1:n))}),s.score=i})}function g3(e,t){const s=e.matches;t.matches=[],tr(s)&&s.forEach(i=>{if(!tr(i.indices)||!i.indices.length)return;const{indices:r,value:n}=i;let o={indices:r,value:n};i.key&&(o.key=i.key.src),i.idx>-1&&(o.refIndex=i.idx),t.matches.push(o)})}function f3(e,t){t.score=e.score}function m3(e,t,{includeMatches:s=ct.includeMatches,includeScore:i=ct.includeScore}={}){const r=[];return s&&r.push(g3),i&&r.push(f3),e.map(n=>{const{idx:o}=n,a={item:t[o],refIndex:o};return r.length&&r.forEach(l=>{l(n,a)}),a})}class Mu{constructor(t,s={},i){this.options={...ct,...s},this.options.useExtendedSearch,this._keyStore=new H$(this.options.keys),this.setCollection(t,i)}setCollection(t,s){if(this._docs=t,s&&!(s instanceof Dx))throw new Error(L$);this._myIndex=s||Y_(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){tr(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const s=[];for(let i=0,r=this._docs.length;i<r;i+=1){const n=this._docs[i];t(n,i)&&(this.removeAt(i),i-=1,r-=1,s.push(n))}return s}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:s=-1}={}){const{includeMatches:i,includeScore:r,shouldSort:n,sortFn:o,ignoreFieldNorm:a}=this.options;let l=Sn(t)?Sn(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return p3(l,{ignoreFieldNorm:a}),n&&l.sort(o),z_(s)&&s>-1&&(l=l.slice(0,s)),m3(l,this._docs,{includeMatches:i,includeScore:r})}_searchStringList(t){const s=Uw(t,this.options),{records:i}=this._myIndex,r=[];return i.forEach(({v:n,i:o,n:a})=>{if(!tr(n))return;const{isMatch:l,score:u,indices:h}=s.searchIn(n);l&&r.push({item:n,idx:o,matches:[{score:u,value:n,norm:a,indices:h}]})}),r}_searchLogical(t){const s=J_(t,this.options),i=(a,l,u)=>{if(!a.children){const{keyId:p,searcher:g}=a,m=this._findMatches({key:this._keyStore.get(p),value:this._myIndex.getValueForItemAtKeyId(l,p),searcher:g});return m&&m.length?[{idx:u,item:l,matches:m}]:[]}const h=[];for(let p=0,g=a.children.length;p<g;p+=1){const m=a.children[p],C=i(m,l,u);if(C.length)h.push(...C);else if(a.operator===cm.AND)return[]}return h},r=this._myIndex.records,n={},o=[];return r.forEach(({$:a,i:l})=>{if(tr(a)){let u=i(s,a,l);u.length&&(n[l]||(n[l]={idx:l,item:a,matches:[]},o.push(n[l])),u.forEach(({matches:h})=>{n[l].matches.push(...h)}))}}),o}_searchObjectList(t){const s=Uw(t,this.options),{keys:i,records:r}=this._myIndex,n=[];return r.forEach(({$:o,i:a})=>{if(!tr(o))return;let l=[];i.forEach((u,h)=>{l.push(...this._findMatches({key:u,value:o[h],searcher:s}))}),l.length&&n.push({idx:a,item:o,matches:l})}),n}_findMatches({key:t,value:s,searcher:i}){if(!tr(s))return[];let r=[];if(ro(s))s.forEach(({v:n,i:o,n:a})=>{if(!tr(n))return;const{isMatch:l,score:u,indices:h}=i.searchIn(n);l&&r.push({score:u,key:t,value:n,idx:o,norm:a,indices:h})});else{const{v:n,n:o}=s,{isMatch:a,score:l,indices:u}=i.searchIn(n);a&&r.push({score:l,key:t,value:n,norm:o,indices:u})}return r}}Mu.version="7.1.0";Mu.createIndex=Y_;Mu.parseIndex=q$;Mu.config=ct;Mu.parseQuery=J_;u3(c3);const v3=["tesco","sainsbury","sainsburys","sainsbury's","asda","morrisons","waitrose","aldi","lidl","co-op","coop","marks & spencer","m&s","iceland","ocado","booths","budgens","costcutter","spar","londis"],C3=[["colour","color"],["flavour","flavor"],["fibre","fiber"],["centre","center"],["litre","liter"],["grey","gray"],["organise","organize"],["recognise","recognize"],["favourite","favorite"],["honour","honor"]],Eo={barcodeExact:50,barcodePresent:10,nameExact:20,nameFuzzy:15,brandExact:10,ukRetailerBrand:5,ingredientOverlap:10,ukSpelling:5};function xn(e){return e.toLowerCase().trim().replace(/[^\w\s]/g," ").replace(/\s+/g," ")}function xT(e){if(!e)return!1;const t=xn(e);return v3.some(s=>t.includes(s))}function ET(e){const t=xn(e);return C3.some(([s])=>t.includes(s))}function y3(e,t){if(e.size===0&&t.size===0)return 0;const s=new Set([...e].filter(r=>t.has(r))),i=new Set([...e,...t]);return s.size/i.size}function w3(e,t){const s=new Set(e.ingredients.map(n=>xn(n)).filter(n=>n.length>2)),i=new Set(t.ingredients.map(n=>xn(n)).filter(n=>n.length>2));return y3(s,i)*Eo.ingredientOverlap}function S3(e,t){let s=0;const i=[];e.barcode&&t.barcode&&e.barcode===t.barcode&&(s+=Eo.barcodeExact,i.push(`Exact barcode match: ${e.barcode}`)),e.barcode&&t.barcode&&(s+=Eo.barcodePresent);const r=xn(e.name),n=xn(t.name);if(r===n)s+=Eo.nameExact,i.push("Exact name match");else{const u=new Mu([r],{threshold:.4,includeScore:!0}).search(n);if(u.length>0&&u[0].score!==void 0){const h=(1-u[0].score)*Eo.nameFuzzy;h>5&&(s+=h,i.push(`Fuzzy name match (${Math.round(h)} pts)`))}}if(e.brandName&&t.brandName){const l=xn(e.brandName),u=xn(t.brandName);l===u&&(s+=Eo.brandExact,i.push("Exact brand match"))}if(xT(e.brandName)&&xT(t.brandName)&&(s+=Eo.ukRetailerBrand,i.push("Both are UK retailer products")),e.ingredients.length>0&&t.ingredients.length>0){const l=w3(e,t);l>2&&(s+=l,i.push(`Ingredient overlap (${Math.round(l)} pts)`))}const o=`${e.name} ${e.ingredientsText||""}`,a=`${t.name} ${t.ingredientsText||""}`;return ET(o)&&ET(a)&&(s+=Eo.ukSpelling,i.push("Both have UK spelling")),{score:s,reasons:i}}function x3(e){const t=new Map;return e.forEach(s=>{if(s.barcode){const i=t.get(s.barcode)||[];i.push(s),t.set(s.barcode,i)}}),t}function E3(e){const t=new Map;return e.forEach(s=>{const i=xn(s.name),r=s.brandName?`${i}|${xn(s.brandName)}`:i,n=t.get(r)||[];n.push(s),t.set(r,n)}),t}function b3(e,t={}){const{minScore:s=30,maxGroups:i=500}=t,r=[],n=new Set,o=new Set,a=x3(e),l=E3(e);return a.forEach((u,h)=>{if(u.length>1){const p=`barcode-${h}`,g=[...u].sort((y,R)=>y.isVerified!==R.isVerified?y.isVerified?-1:1:R._confidenceScore-y._confidenceScore),m=g[0],C=g.slice(1).map(y=>y._id);r.push({id:p,masterFoodId:m._id,duplicateIds:C,matchScore:100,matchReasons:[`Exact barcode match: ${h}`]}),u.forEach(y=>o.add(y._id))}}),l.forEach(u=>{if(u.length>1){const h=u.filter(p=>!o.has(p._id));if(h.length>1)for(let p=0;p<h.length;p++)for(let g=p+1;g<h.length;g++){const m=h[p],C=h[g];if(m._sourceIndex===C._sourceIndex)continue;const y=[m._id,C._id].sort().join("|");if(n.has(y))continue;n.add(y);const{score:R,reasons:x}=S3(m,C);if(R>=s){const S=m._confidenceScore>=C._confidenceScore?m:C,T=S===m?C:m;r.push({id:`name-${y}`,masterFoodId:S._id,duplicateIds:[T._id],matchScore:Math.min(100,R),matchReasons:x}),o.add(m._id),o.add(C._id)}}}}),r.sort((u,h)=>h.matchScore-u.matchScore),r.slice(0,i)}function R3(e,t){const s={...e},i=new Set;if(e.barcode&&i.add(e.barcode),t.forEach(r=>{r.barcode&&i.add(r.barcode)}),s.barcodes=[...i],s.barcode=s.barcodes[0]||null,!s.imageUrl){const r=t.find(n=>n.imageUrl);r&&(s.imageUrl=r.imageUrl)}if(!s.ingredientsText||s.ingredientsText.length<20){const r=t.find(n=>{var o;return n.ingredientsText&&n.ingredientsText.length>(((o=s.ingredientsText)==null?void 0:o.length)||0)});r&&(s.ingredientsText=r.ingredientsText,s.ingredients=r.ingredients)}return s._isDirty=!0,s}const T3=({onClose:e})=>{const{duplicateGroups:t,setDuplicateGroups:s,getFoodById:i,updateFood:r}=Yo(),[n,o]=E.useState(null),[a,l]=E.useState(null),u=async g=>{const m=i(g.masterFoodId);if(!m)return;const C=g.duplicateIds.map(y=>i(y)).filter(y=>y!==void 0);if(C.length!==0){l(g.id);try{const y=R3(m,C);r(m._id,{barcodes:y.barcodes,barcode:y.barcode,imageUrl:y.imageUrl,ingredientsText:y.ingredientsText,ingredients:y.ingredients}),C.forEach(R=>{r(R._id,{_isDeleted:!0})}),s(t.filter(R=>R.id!==g.id)),console.log(`Merged ${C.length} duplicates into ${m.name}`)}catch(y){console.error("Error merging duplicates:",y),alert("Failed to merge duplicates")}finally{l(null)}}},h=g=>{s(t.filter(m=>m.id!==g.id))},p=()=>{confirm("Dismiss all duplicate groups? This cannot be undone.")&&s([])};return t.length===0?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl p-6",children:c.jsxs("div",{className:"text-center py-8",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto text-green-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Duplicates Found"}),c.jsx("p",{className:"text-gray-500 mb-6",children:"Your database looks clean!"}),c.jsx("button",{onClick:e,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Close"})]})})}):c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Duplicate Detection"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Found ",t.length," potential duplicate group",t.length!==1?"s":""]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:p,className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg",children:"Dismiss All"}),c.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-gray-200",children:t.map(g=>{const m=i(g.masterFoodId),C=g.duplicateIds.map(x=>i(x)).filter(x=>x!==void 0);if(!m)return null;const y=n===g.id,R=a===g.id;return c.jsx("div",{className:"p-4",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"flex-shrink-0",children:m.imageUrl?c.jsx("img",{src:m.imageUrl,alt:"",className:"w-16 h-16 object-cover rounded border border-gray-200"}):c.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs",children:"No img"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:m.name}),m.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:m.brandName}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded",children:["Master: ",m._sourceIndex]}),c.jsxs("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded",children:[C.length," duplicate",C.length!==1?"s":""]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:`text-lg font-bold ${g.matchScore>=80?"text-red-600":g.matchScore>=50?"text-yellow-600":"text-gray-600"}`,children:[g.matchScore,"%"]}),c.jsx("div",{className:"text-xs text-gray-400",children:"match"})]})]}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-1",children:[g.matchReasons.slice(0,y?void 0:2).map((x,S)=>c.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded",children:x},S)),!y&&g.matchReasons.length>2&&c.jsxs("span",{className:"text-xs text-gray-400",children:["+",g.matchReasons.length-2," more"]})]}),c.jsx("button",{onClick:()=>o(y?null:g.id),className:"mt-2 text-xs text-primary-600 hover:underline",children:y?"Hide details":"Show details"}),y&&c.jsxs("div",{className:"mt-3 space-y-2",children:[c.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase",children:"Duplicates:"}),C.map(x=>c.jsxs("div",{className:"flex items-center gap-3 p-2 bg-gray-50 rounded",children:[x.imageUrl?c.jsx("img",{src:x.imageUrl,alt:"",className:"w-10 h-10 object-cover rounded"}):c.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded flex items-center justify-center text-gray-400 text-xs",children:"-"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 truncate",children:x.name}),c.jsxs("p",{className:"text-xs text-gray-500",children:[x._sourceIndex,"  ",x.barcode||"No barcode"]})]})]},x._id))]})]}),c.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0",children:[c.jsx("button",{onClick:()=>u(g),disabled:R,className:"px-3 py-1.5 text-xs bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 whitespace-nowrap",children:R?c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Merging"]}):"Merge"}),c.jsx("button",{onClick:()=>h(g),className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200 whitespace-nowrap",children:"Dismiss"})]})]})},g.id)})}),c.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:[c.jsx("span",{className:"font-medium text-red-600",children:t.filter(g=>g.matchScore>=80).length})," high confidence ",c.jsx("span",{className:"font-medium text-yellow-600 ml-1",children:t.filter(g=>g.matchScore>=50&&g.matchScore<80).length})," medium ",c.jsx("span",{className:"font-medium text-gray-600 ml-1",children:t.filter(g=>g.matchScore<50).length})," low"]}),c.jsx("button",{onClick:e,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Done"})]})})]})})},bT="WK0TIF84M2",D3="577cc4ee3fed660318917bbb54abfb2e";async function P3(e,t,s){try{console.log(`[Upload] Starting upload for ${t} from ${s}`);const i=await new Promise((o,a)=>{const l=new FileReader;l.onloadend=()=>o(l.result),l.onerror=a,l.readAsDataURL(e)}),n=await(await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/uploadFoodImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:t,objectID:t,imageData:i,sourceIndex:s})})).json();return console.log(`[Upload] Result for ${t}:`,n),n}catch(i){return console.error(`[Upload] Error for ${t}:`,i),{success:!1,error:i instanceof Error?i.message:String(i)}}}const A3=({onBack:e})=>{const[t,s]=E.useState([]),[i,r]=E.useState(!1),[n,o]=E.useState(0),[a,l]=E.useState(""),[u,h]=E.useState(!1),[p,g]=E.useState(!1),[m,C]=E.useState(!1),[y,R]=E.useState("with_barcode"),[x,S]=E.useState(0),[T,I]=E.useState({total:0,withBarcode:0,completed:0,failed:0,noImage:0,processing:0,skipped:0}),[V,H]=E.useState([]),[P,N]=E.useState(new Set(Zt)),[_,L]=E.useState(!0),M=E.useRef(!1),b=E.useRef(!1),F=100,[Z,K]=E.useState(null),ge=k=>{console.log(k),H(O=>[...O.slice(-50),`${new Date().toLocaleTimeString()}: ${k}`])};E.useEffect(()=>{P$().then(k=>{C(k),ge(`Cloud rembg available: ${k}`)})},[]),E.useEffect(()=>{const k=O=>{O.key==="Escape"&&Z&&K(null)};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[Z]);const me=E.useCallback(async()=>{var le;if(P.size===0){ge("No indices selected");return}r(!0),L(!1),o(0),ge("Starting to load foods from Algolia...");const k=[],O=new Set,W=Array.from(P);try{for(let ne=0;ne<W.length;ne++){const X=W[ne];l(`Loading ${X}...`),o(Math.round(ne/W.length*100)),ge(`Loading index: ${X}`);const Q=`https://${bT}-dsn.algolia.net/1/indexes/${X}/query`;try{const re=await fetch(Q,{method:"POST",headers:{"X-Algolia-Application-Id":bT,"X-Algolia-API-Key":D3,"Content-Type":"application/json"},body:JSON.stringify({query:"",hitsPerPage:1e3,attributesToRetrieve:["objectID","name","foodName","brandName","brand","barcode","barcodes","imageUrl"]})});if(!re.ok){ge(`Error loading ${X}: ${re.status}`);continue}const Me=(await re.json()).hits||[];ge(`${X}: ${Me.length} records`);for(const Ne of Me){const Pe=Ne.barcode||((le=Ne.barcodes)==null?void 0:le[0])||null;Pe&&O.has(Pe)||(Pe&&O.add(Pe),k.push({id:`${X}:${Ne.objectID}`,objectID:Ne.objectID,name:Ne.name||Ne.foodName||"Unknown",brandName:Ne.brandName||Ne.brand||null,barcode:Pe,currentImageUrl:Ne.imageUrl||null,offImageUrl:null,processedBlob:null,status:"pending",sourceIndex:X,selected:!1}))}}catch(re){ge(`Error loading ${X}: ${re}`)}}ge(`Total foods loaded: ${k.length}`),ge(`Foods with barcodes: ${k.filter(ne=>ne.barcode).length}`),s(k),de(k),o(100),l("")}catch(ne){ge(`Error loading foods: ${ne}`)}finally{r(!1)}},[P]),de=k=>{I({total:k.length,withBarcode:k.filter(O=>O.barcode).length,completed:k.filter(O=>O.status==="completed").length,failed:k.filter(O=>O.status==="failed").length,noImage:k.filter(O=>O.status==="no_image").length,processing:k.filter(O=>["fetching_off","processing","uploading"].includes(O.status)).length,skipped:k.filter(O=>O.status==="skipped").length})},ye=k=>{s(O=>O.map(W=>W.id===k?{...W,selected:!W.selected}:W))},pe=()=>{const k=U(),O=new Set(k.map(W=>W.id));s(W=>W.map(le=>O.has(le.id)?{...le,selected:!0}:le))},q=()=>{s(k=>k.map(O=>({...O,selected:!1})))},ve=async k=>{var W,le,ne,X,Q,re,Se,Me,Ne,Pe,We,Ye,Ke,ie,Dt,Fs,$t,bt,dr,Sa,hr,Rs,Wl,ln,po,go,_r,xa;const O=[`https://uk.openfoodfacts.org/api/v0/product/${k}.json`,`https://world.openfoodfacts.org/api/v0/product/${k}.json`];for(const Ea of O)try{const ba=await fetch(Ea);if(!ba.ok)continue;const kr=await ba.json();if(kr.status===1&&kr.product){const ni=kr.product,os=((X=(ne=(le=(W=ni.images)==null?void 0:W.front)==null?void 0:le.sizes)==null?void 0:ne.full)==null?void 0:X.w)||((Me=(Se=(re=(Q=ni.images)==null?void 0:Q.front)==null?void 0:re.sizes)==null?void 0:Se["400"])==null?void 0:Me.w)||0,Ki=((Ye=(We=(Pe=(Ne=ni.images)==null?void 0:Ne.front)==null?void 0:Pe.sizes)==null?void 0:We.full)==null?void 0:Ye.h)||((Fs=(Dt=(ie=(Ke=ni.images)==null?void 0:Ke.front)==null?void 0:ie.sizes)==null?void 0:Dt["400"])==null?void 0:Fs.h)||0;if(os>0&&Ki>0){const Gs=Math.min(os,Ki),Lr=Math.max(os,Ki)/Gs;if(Gs<200){ge(`Skipping ${k}: image too small (${os}x${Ki})`);continue}if(Lr>2.5){ge(`Skipping ${k}: bad aspect ratio ${Lr.toFixed(1)} (likely cropped)`);continue}}const Mr=((dr=(bt=($t=ni.selected_images)==null?void 0:$t.front)==null?void 0:bt.display)==null?void 0:dr.en)||((Rs=(hr=(Sa=ni.selected_images)==null?void 0:Sa.front)==null?void 0:hr.display)==null?void 0:Rs.uk)||((po=(ln=(Wl=ni.selected_images)==null?void 0:Wl.front)==null?void 0:ln.url)==null?void 0:po.en)||((xa=(_r=(go=ni.selected_images)==null?void 0:go.front)==null?void 0:_r.url)==null?void 0:xa.uk)||ni.image_front_url||ni.image_url;if(Mr){try{const Gs=await fetch(Mr,{method:"HEAD"});if(!Gs.ok){ge(`Skipping ${k}: image URL returned ${Gs.status}`);continue}const Is=Gs.headers.get("content-length");if(Is&&parseInt(Is)<5e3){ge(`Skipping ${k}: image file too small (${Is} bytes)`);continue}}catch{}return ge(`Found valid OFF image for ${k} (${os}x${Ki})`),Mr}}}catch{continue}return null},$=async k=>{if(b.current)return{...k,status:"pending"};for(;M.current;)if(await new Promise(O=>setTimeout(O,100)),b.current)return{...k,status:"pending"};if(!k.barcode)return ge(`Skipping ${k.name}: no barcode`),{...k,status:"skipped",error:"No barcode"};if(k.currentImageUrl&&k.currentImageUrl.includes("storage.googleapis.com"))return ge(`Skipping ${k.name}: already has processed image`),{...k,status:"skipped",error:"Already processed"};ge(`Processing: ${k.name} (${k.barcode})`);try{s(ne=>ne.map(X=>X.id===k.id?{...X,status:"fetching_off"}:X));const O=await ve(k.barcode);if(!O)return ge(`No OFF image for ${k.barcode}`),{...k,status:"no_image",error:"No image on OpenFoodFacts"};ge(`Removing background for ${k.name}...`),s(ne=>ne.map(X=>X.id===k.id?{...X,offImageUrl:O,status:"processing"}:X));const W=await W_(O);if(!W.success||!W.blob)return ge(`Background removal failed for ${k.name}: ${W.error}`),{...k,offImageUrl:O,status:"failed",error:W.error||"Processing failed"};ge(`Background removed for ${k.name}, uploading...`),s(ne=>ne.map(X=>X.id===k.id?{...X,offImageUrl:O,processedBlob:W.blob,status:"uploading"}:X));const le=await P3(W.blob,k.objectID,k.sourceIndex);return le.success?(ge(`Completed: ${k.name}`),{...k,offImageUrl:O,processedBlob:W.blob,currentImageUrl:le.url??null,status:"completed"}):(ge(`Upload failed for ${k.name}: ${le.error}`),{...k,offImageUrl:O,processedBlob:W.blob,status:"failed",error:le.error||"Upload failed"})}catch(O){return ge(`Error processing ${k.name}: ${O}`),{...k,status:"failed",error:O instanceof Error?O.message:String(O)}}},be=async()=>{h(!0),M.current=!1,b.current=!1;const k=t.filter(W=>W.selected),O=k.length>0?k.filter(W=>W.barcode):t.filter(W=>W.status==="pending"&&W.barcode);if(ge(`Starting batch processing of ${O.length} foods`),O.length===0){ge("No foods to process!"),h(!1);return}for(let W=0;W<O.length;W++){if(b.current){ge("Processing stopped by user");break}const le=O[W];ge(`[${W+1}/${O.length}] Processing ${le.name}`);const ne=await $(le);s(X=>{const Q=X.map(re=>re.id===le.id?ne:re);return de(Q),Q}),await new Promise(X=>setTimeout(X,300))}ge("Batch processing complete"),h(!1),g(!1)},se=()=>{M.current=!0,g(!0),ge("Paused")},Ge=()=>{M.current=!1,g(!1),ge("Resumed")},Re=()=>{b.current=!0,h(!1),g(!1),ge("Stopped")},U=E.useCallback(()=>{switch(y){case"with_barcode":return t.filter(k=>k.barcode);case"no_image":return t.filter(k=>!k.currentImageUrl);case"pending":return t.filter(k=>k.status==="pending"&&k.barcode);case"selected":return t.filter(k=>k.selected);default:return t}},[t,y]),J=U(),ce=J.slice(x*F,(x+1)*F),Y=Math.ceil(J.length/F),te=t.filter(k=>k.selected).length,he=t.filter(k=>k.status==="pending"&&k.barcode).length,Ae={pending:"bg-gray-100 text-gray-600",fetching_off:"bg-blue-100 text-blue-600",processing:"bg-yellow-100 text-yellow-600",uploading:"bg-purple-100 text-purple-600",completed:"bg-green-100 text-green-600",failed:"bg-red-100 text-red-600",no_image:"bg-gray-200 text-gray-500",skipped:"bg-gray-100 text-gray-400"},fe={pending:"Pending",fetching_off:"Fetching...",processing:"Cleaning...",uploading:"Uploading...",completed:"Done",failed:"Failed",no_image:"No OFF Image",skipped:"Skipped"};return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Batch Image Processing"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Pull from OpenFoodFacts  Remove backgrounds  Upload to Firebase"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[t.length>0&&!u&&c.jsxs("button",{onClick:()=>{s([]),L(!0),I({total:0,withBarcode:0,completed:0,failed:0,noImage:0,processing:0,skipped:0})},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Change Indices"]}),c.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm ${m?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${m?"bg-green-500":"bg-yellow-500"}`}),m?"Cloud rembg":"Browser mode"]}),u?c.jsxs(c.Fragment,{children:[p?c.jsx("button",{onClick:Ge,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Resume"}):c.jsx("button",{onClick:se,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700",children:"Pause"}),c.jsx("button",{onClick:Re,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Stop"})]}):c.jsxs("button",{onClick:be,disabled:i||te===0&&he===0,className:"flex items-center gap-2 px-5 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[c.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),te>0?`Process Selected (${te})`:`Process All (${he})`]})]})]}),c.jsxs("div",{className:"space-y-3",children:[i&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${n}%`}})}),c.jsx("span",{className:"text-sm text-gray-500",children:a||`Loading... ${n}%`})]}),!i&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden flex",children:[c.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${T.completed/Math.max(T.withBarcode,1)*100}%`}}),c.jsx("div",{className:"h-full bg-red-400 transition-all",style:{width:`${T.failed/Math.max(T.withBarcode,1)*100}%`}}),c.jsx("div",{className:"h-full bg-gray-400 transition-all",style:{width:`${T.noImage/Math.max(T.withBarcode,1)*100}%`}}),c.jsx("div",{className:"h-full bg-yellow-400 animate-pulse",style:{width:`${T.processing/Math.max(T.withBarcode,1)*100}%`}})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[c.jsxs("span",{className:"text-gray-600",children:["Total: ",c.jsx("strong",{children:T.total.toLocaleString()})]}),c.jsxs("span",{className:"text-gray-600",children:["With Barcode: ",c.jsx("strong",{children:T.withBarcode.toLocaleString()})]}),c.jsxs("span",{className:"text-green-600",children:["Completed: ",c.jsx("strong",{children:T.completed.toLocaleString()})]}),c.jsxs("span",{className:"text-red-600",children:["Failed: ",c.jsx("strong",{children:T.failed.toLocaleString()})]}),c.jsxs("span",{className:"text-gray-500",children:["No OFF: ",c.jsx("strong",{children:T.noImage.toLocaleString()})]}),T.processing>0&&c.jsxs("span",{className:"text-yellow-600 animate-pulse",children:["Processing: ",c.jsx("strong",{children:T.processing})]}),te>0&&c.jsxs("span",{className:"text-primary-600",children:["Selected: ",c.jsx("strong",{children:te})]})]})]})]})]}),c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 flex items-center justify-between",children:[c.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All",count:t.length},{value:"with_barcode",label:"With Barcode",count:T.withBarcode},{value:"pending",label:"Pending",count:he},{value:"no_image",label:"No Image",count:t.filter(k=>!k.currentImageUrl).length},{value:"selected",label:"Selected",count:te}].map(k=>c.jsxs("button",{onClick:()=>{R(k.value),S(0)},className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${y===k.value?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[k.label," (",k.count.toLocaleString(),")"]},k.value))}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:pe,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Select All"}),c.jsx("button",{onClick:q,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Deselect All"})]})]}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx("div",{className:"flex-1 overflow-auto p-6",children:_&&!i&&t.length===0?c.jsx("div",{className:"max-w-3xl mx-auto",children:c.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 px-6 py-5 text-white",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Batch Image Processing"}),c.jsx("p",{className:"text-primary-100 text-sm mt-1",children:"Fetch images from OpenFoodFacts, remove backgrounds, straighten products, and upload to Firebase"})]}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"1"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Select indices to load foods from"})]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-6",children:Zt.map(k=>c.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${P.has(k)?"border-primary-500 bg-primary-50 shadow-sm":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("input",{type:"checkbox",checked:P.has(k),onChange:()=>{N(O=>{const W=new Set(O);return W.has(k)?W.delete(k):W.add(k),W})},className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"text-sm font-medium text-gray-700 truncate",children:k.replace(/_/g," ")})]},k))}),c.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-6 border-b border-gray-200",children:[c.jsx("button",{onClick:()=>N(new Set(Zt)),className:"px-3 py-1.5 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:"Select All"}),c.jsx("button",{onClick:()=>N(new Set),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear All"}),c.jsxs("span",{className:"text-sm text-gray-400",children:[P.size," of ",Zt.length," selected"]})]}),c.jsxs("button",{onClick:me,disabled:P.size===0,className:"w-full flex items-center justify-center gap-3 px-6 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 rounded-xl shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none",children:[c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Load ",P.size>0?`Foods from ${P.size} ${P.size===1?"Index":"Indices"}`:"Foods"]}),P.size===0&&c.jsx("p",{className:"text-center text-sm text-red-500 mt-3",children:"Select at least one index to continue"})]})]})}):i?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("svg",{className:"w-8 h-8 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),c.jsx("span",{className:"text-gray-500",children:a||"Loading foods..."})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid gap-2",children:ce.map(k=>c.jsxs("div",{className:`bg-white rounded-lg border p-3 flex items-center gap-3 cursor-pointer transition-colors ${k.selected?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>ye(k.id),children:[c.jsx("input",{type:"checkbox",checked:k.selected,onChange:()=>ye(k.id),onClick:O=>O.stopPropagation(),className:"w-4 h-4 text-primary-600 rounded"}),c.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[c.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-primary-400 transition-all",onClick:O=>{O.stopPropagation(),k.currentImageUrl&&K({url:k.currentImageUrl,title:`${k.name} - Current`})},children:k.currentImageUrl?c.jsx("img",{src:k.currentImageUrl,alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-[8px] text-gray-400",children:"None"})}),c.jsx("svg",{className:"w-3 h-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),c.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-blue-400 transition-all",onClick:O=>{O.stopPropagation(),k.offImageUrl&&K({url:k.offImageUrl,title:`${k.name} - OpenFoodFacts`})},children:k.offImageUrl?c.jsx("img",{src:k.offImageUrl,alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-[8px] text-gray-400",children:"OFF"})}),c.jsx("svg",{className:"w-3 h-3 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),c.jsx("div",{className:"w-10 h-10 bg-[#e8e8e8] rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-green-400 transition-all",onClick:O=>{O.stopPropagation(),k.processedBlob&&K({url:URL.createObjectURL(k.processedBlob),title:`${k.name} - Cleaned`})},children:k.processedBlob?c.jsx("img",{src:URL.createObjectURL(k.processedBlob),alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-[8px] text-gray-400",children:"Clean"})})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:k.name}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[k.barcode&&c.jsx("span",{className:"font-mono",children:k.barcode}),c.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px]",children:k.sourceIndex.replace(/_/g," ")})]})]}),c.jsxs("div",{className:"flex-shrink-0 text-right",children:[c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${Ae[k.status]}`,children:[["fetching_off","processing","uploading"].includes(k.status)&&c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),fe[k.status]]}),k.error&&c.jsx("div",{className:"text-[10px] text-red-500 mt-0.5 max-w-[100px] truncate",title:k.error,children:k.error})]})]},k.id))}),Y>1&&c.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[c.jsx("button",{onClick:()=>S(k=>Math.max(0,k-1)),disabled:x===0,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",x+1," of ",Y]}),c.jsx("button",{onClick:()=>S(k=>Math.min(Y-1,k+1)),disabled:x>=Y-1,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})]})}),c.jsxs("div",{className:"w-80 border-l border-gray-200 bg-gray-900 flex flex-col",children:[c.jsx("div",{className:"px-4 py-2 border-b border-gray-700 text-gray-400 text-xs font-medium uppercase",children:"Processing Log"}),c.jsx("div",{className:"flex-1 overflow-auto p-3 font-mono text-xs text-gray-300 space-y-1",children:V.length===0?c.jsx("div",{className:"text-gray-500",children:"No activity yet..."}):V.map((k,O)=>c.jsx("div",{className:"break-all",children:k},O))})]})]}),Z&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:()=>K(null),children:c.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] flex flex-col items-center",children:[c.jsx("button",{onClick:()=>K(null),className:"absolute -top-12 right-0 p-2 text-white/80 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsx("div",{className:"absolute -top-12 left-0 text-white font-medium",children:Z.title}),c.jsx("div",{className:"rounded-lg overflow-hidden shadow-2xl",style:{backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",backgroundColor:"#fff"},onClick:k=>k.stopPropagation(),children:c.jsx("img",{src:Z.url,alt:Z.title,className:"max-w-[85vw] max-h-[80vh] object-contain"})}),c.jsx("div",{className:"mt-4 text-white/60 text-sm",children:"Click outside or press ESC to close"})]})})]})},Yw="gRLnCJAV5rWycCc6PKrAUYHb",F3=["nestle.com","unilever.com","pepsico.com","cocacola.com","kellogs.com","kraftheinz.com","danone.com","generalmills.com","mondelez.com","mars.com","ferrero.com","heinz.com","campbells.com","kelloggs.co.uk","walkers.co.uk","cadbury.co.uk","mcvities.co.uk","weetabix.co.uk","muller.co.uk","warburtons.co.uk","hovis.co.uk","primula.co.uk"],I3=["tesco.com","sainsburys.co.uk","asda.com","morrisons.com","waitrose.com","ocado.com","amazon.co.uk","ebay.co.uk"];async function jC(e,t,s=10){let i="";t&&t.trim()?i=`${t} ${e}`:i=e,i=i.replace(/\b(zero sugar|sugar free|no sugar|caffeine free)\b/gi,"").replace(/\b\d+ml\b/gi,"").replace(/\b\d+g\b/gi,"").replace(/\bpack of \d+\b/gi,"").replace(/\bmultipack\b/gi,"").replace(/\s+/g," ").trim(),console.log(`Original: "${t} ${e}"  Cleaned: "${i}"`);try{console.log("[searchSerpApiImages] About to call searchGoogleImagesViaSearchAPI with query:",i);const r=await N3(i,s);return console.log("[searchSerpApiImages] Got results back:",r.length),r}catch(r){throw console.error("[searchSerpApiImages] SearchAPI search error:",r),r}}async function N3(e,t){var l;console.log("[searchGoogleImagesViaSearchAPI] ENTRY - query:",e,"maxResults:",t),console.log("[searchGoogleImagesViaSearchAPI] API KEY exists:",Yw.length>0);const s=new URLSearchParams({api_key:Yw,engine:"google_images",q:e,hl:"en",gl:"uk",num:String(Math.min(t,20))});console.log("[searchGoogleImagesViaSearchAPI] URL:",`https://www.searchapi.io/api/v1/search?${s}`);const i=await fetch(`https://www.searchapi.io/api/v1/search?${s}`,{method:"GET",headers:{Accept:"application/json"}});if(!i.ok){let u="SearchAPI request failed";try{const h=await i.json();console.error("SearchAPI error response:",h),u=h.error||h.message||u}catch{u=`HTTP ${i.status}: ${i.statusText}`}throw new Error(u)}const r=await i.json();console.log("SearchAPI response for query:",e),console.log("Response keys:",Object.keys(r)),console.log("Number of results:",((l=r.images)==null?void 0:l.length)||0);const n=r.images||[];return n.length===0&&console.warn("No images found in SearchAPI response:",r),n.map((u,h)=>({...u,position:h+1})).map(u=>{var y,R,x,S,T,I,V,H;const h=((y=u.original)==null?void 0:y.link)||u.thumbnail||"";let p="";try{p=((R=u.source)==null?void 0:R.name)||new URL(((x=u.source)==null?void 0:x.link)||h).hostname.replace("www.","")}catch{p=""}const g=F3.some(P=>p.includes(P)),m=I3.some(P=>p.includes(P));let C=50;return g&&(C+=30),u.position<=3&&(C+=10),((S=u.original)==null?void 0:S.width)>800&&(C+=10),((T=u.original)==null?void 0:T.height)>800&&(C+=10),{url:h,thumbnail:u.thumbnail||h,title:u.title||"",domain:p,width:(I=u.original)==null?void 0:I.width,height:(V=u.original)==null?void 0:V.height,isManufacturerSite:g,qualityScore:C,disqualified:m,disqualifyReason:m?`Retailer site (${p})`:void 0,source:(H=u.source)==null?void 0:H.name}}).sort((u,h)=>h.qualityScore-u.qualityScore)}async function WC(e,t){return new Promise((s,i)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{try{let n=function(Y,te){const he=Y[te],Ae=Y[te+1],fe=Y[te+2],k=Y[te+3];if(T++,k<200){R++;return}if(he>240&&Ae>240&&fe>240){y++;return}if(o(he,Ae,fe)){S++,x++;return}x++},o=function(Y,te,he){if(Y>te&&te>he){const Ae=Y/te,fe=Y/he;if(Ae>1.05&&Ae<1.7&&fe>1.2&&fe<2.5){const k=(Y+te+he)/3;if(k>60&&k<220)return!0}}return!1};t==null||t(20);const a=document.createElement("canvas"),l=a.getContext("2d",{willReadFrequently:!0});if(!l)throw new Error("Could not get canvas context");const u=Math.min(1,400/Math.max(r.width,r.height));a.width=r.width*u,a.height=r.height*u,l.drawImage(r,0,0,a.width,a.height),t==null||t(30);const p=l.getImageData(0,0,a.width,a.height).data,g=p.length/4,m=Math.floor(a.width*.1),C=Math.floor(a.height*.1);let y=0,R=0,x=0,S=0,T=0;for(let Y=0;Y<C;Y++)for(let te=0;te<a.width;te+=2){const he=(Y*a.width+te)*4;n(p,he)}for(let Y=a.height-C;Y<a.height;Y++)for(let te=0;te<a.width;te+=2){const he=(Y*a.width+te)*4;n(p,he)}for(let Y=C;Y<a.height-C;Y+=2){for(let te=0;te<m;te++){const he=(Y*a.width+te)*4;n(p,he)}for(let te=a.width-m;te<a.width;te++){const he=(Y*a.width+te)*4;n(p,he)}}t==null||t(50);const I=T>0?y/T:0,V=T>0?R/T:0,H=I+V,P=T>0?S/T:0,N=I>.7,_=V>.5,L=H>.75,M=P>.05;t==null||t(60);const b=[];let F=!1,Z=0;for(let Y=1;Y<a.height-1;Y+=2)for(let te=1;te<a.width-1;te+=2){const he=(Y*a.width+te)*4,Ae=(p[he]+p[he+1]+p[he+2])/3,fe=he+4,k=he+a.width*4;if(fe<p.length&&k<p.length){const O=(p[fe]+p[fe+1]+p[fe+2])/3,W=(p[k]+p[k+1]+p[k+2])/3;(Math.abs(Ae-O)>100||Math.abs(Ae-W)>100)&&Z++}}Z/(g/4)>.08&&(F=!0,b.push("Text detected")),t==null||t(75);let ge=0,me=0,de=0;for(let Y=0;Y<p.length;Y+=16){const te=p[Y],he=p[Y+1],Ae=p[Y+2],fe=Math.max(te,he,Ae),k=Math.min(te,he,Ae),O=fe>0?(fe-k)/fe:0,W=(te+he+Ae)/3;O>.5&&W>150&&(ge++,te>200&&he<100&&Ae<100&&me++,te>200&&he>180&&Ae<100&&de++)}const ye=ge/(p.length/16),pe=(me+de)/(p.length/16);ye>.1&&(F=!0,b.push("Promotional graphics")),pe>.02&&(F=!0,b.includes("Promotional banner")||b.push("Promotional banner"));let q=0,ve=0;const $=Math.floor(a.width*.2),be=Math.floor(a.width*.8),se=Math.floor(a.height*.2),Ge=Math.floor(a.height*.8);for(let Y=se;Y<Ge;Y+=3)for(let te=$;te<be;te+=3){const he=(Y*a.width+te)*4;ve++,o(p[he],p[he+1],p[he+2])&&q++}const Re=ve>0?q/ve:0,U=M||Re>.03;U&&(F=!0,b.push("Person/hand detected")),t==null||t(90);let J=0;N?J+=50:_?J+=45:L?J+=30:J+=0,F?(b.includes("Text detected")&&(J-=20),b.includes("Promotional graphics")&&(J-=15),b.includes("Promotional banner")&&(J-=15),b.includes("Person/hand detected")&&(J-=30)):J+=40,U||(J+=10),J=Math.max(0,Math.min(100,J));const ce=L&&!F&&!U;t==null||t(100),s({hasWhiteBackground:N||_,backgroundConfidence:Math.round(H*100),hasOverlay:F,overlayTypes:b,isCleanProductShot:ce,qualityScore:Math.round(J)})}catch(n){i(n)}},r.onerror=()=>{i(new Error("Failed to load image for analysis"))},r.src=e})}function _3(){return Yw.length>0}function RT(){return`To use SearchAPI Image Search, you need to:

1. Get a SearchAPI API Key:
   - Go to https://www.searchapi.io/
   - Sign up for an account
   - Copy your API key from the dashboard

2. Update .env.local:
   - Add: VITE_SEARCHAPI_KEY=your_api_key_here

Note: SearchAPI has a free tier of 100 searches/month, then paid plans starting at $20/month.`}const TT=[{us:/\bcolor\b/gi,uk:"colour"},{us:/\bflavor\b/gi,uk:"flavour"},{us:/\bfavorite\b/gi,uk:"favourite"},{us:/\bhonor\b/gi,uk:"honour"},{us:/\btheater\b/gi,uk:"theatre"},{us:/\bcenter\b/gi,uk:"centre"},{us:/\bmeter\b/gi,uk:"metre"},{us:/\bliter\b/gi,uk:"litre"},{us:/\bfiber\b/gi,uk:"fibre"},{us:/\bdefense\b/gi,uk:"defence"},{us:/\bpractice\b/gi,uk:"practise"},{us:/\banalyze\b/gi,uk:"analyse"},{us:/\borganize\b/gi,uk:"organise"},{us:/\brealize\b/gi,uk:"realise"},{us:/\bcriticize\b/gi,uk:"criticise"},{us:/\bspecialize\b/gi,uk:"specialise"},{us:/\bcandy\b/gi,uk:"sweets"},{us:/\bcookies?\b/gi,uk:"biscuits"},{us:/\bfries\b/gi,uk:"chips"},{us:/\bchips\b/gi,uk:"crisps"},{us:/\beggplant\b/gi,uk:"aubergine"},{us:/\bzucchini\b/gi,uk:"courgette"},{us:/\bcilantro\b/gi,uk:"coriander"},{us:/\barugula\b/gi,uk:"rocket"},{us:/\bbell pepper\b/gi,uk:"pepper"}],k3=["kraft singles","jell-o","cool whip","velveeta","cheez whiz","pop tarts","goldfish crackers","cheetos","doritos nacho cheese","mountain dew","dr pepper","root beer","gatorade","big red","saltines","graham crackers","hershey","reese's","butterfinger","twinkie","hostess","wonder bread","hawaiian punch","kool-aid"],M3=["tesco","sainsbury","asda","waitrose","morrisons","co-op","marks & spencer","boots","greggs","pret","costa","walkers","cadbury","mcvitie","hobnob","jaffa cake","penguin","yorkshire","tetley","pg tips","hovis","warburtons","kingsmill","heinz beans","branston","marmite","bovril","oxo","bisto","robinsons","ribena","lucozade","irn-bru","vimto","quorn","linda mccartney","richmond","birds eye","galaxy","wispa","crunchie","dairy milk","flake","curly wurly"],id={easternEuropean:/[]/gi,asian:/[\u4e00-\u9fff\u3040-\u309f\u30a0-\u30ff\uac00-\ud7af]/g,cyrillic:/[--]/g,arabic:/[\u0600-\u06FF]/g,excessiveAccents:/[]/gi};function L3(e,t,s){const i=`${t||""} ${e}`.toLowerCase(),r=[];let n=50;const o=M3.some(R=>i.includes(R.toLowerCase()));o&&(n+=40,r.push("UK brand detected"));const a=k3.some(R=>i.includes(R.toLowerCase()));a&&(n-=40,r.push("US brand detected"));let l=0;for(const R of TT){const x=i.match(R.us);x&&(l+=x.length,r.push(`US spelling: "${x[0]}" (UK: ${R.uk})`))}if(l>0&&(n-=l*15),s&&typeof s=="string"){const R=s.toLowerCase(),x=R.replace(/[,()[\].:;]/g," ").split(/\s+/).filter(I=>I.length>2);let S=0;const T=[];for(const I of TT){const V=R.match(I.us);V&&(S+=V.length,T.push(...V))}if(x.length>0){const I=S/x.length*100;I>5?(n=0,r.push(`REJECT: ${Math.round(I)}% of ingredients use US spelling (${S}/${x.length} words: ${T.join(", ")})`)):I>2?(n-=25,r.push(`Ingredients contain ${Math.round(I)}% US spelling (${S}/${x.length} words: ${T.join(", ")})`)):S>0&&(n-=10,r.push(`Some US spelling in ingredients: ${T.join(", ")}`))}}let u=0;const h=i.match(id.easternEuropean);h&&(u+=h.length,r.push(`Eastern European characters: ${h.join(", ")}`));const p=i.match(id.asian);p&&(u+=p.length*2,r.push("Asian characters detected"));const g=i.match(id.cyrillic);g&&(u+=g.length*2,r.push("Cyrillic characters detected"));const m=i.match(id.arabic);m&&(u+=m.length*2,r.push("Arabic characters detected"));const C=i.match(id.excessiveAccents);if(C){const R=C.length/i.length;R>.15?(u+=C.length,r.push(`Excessive accents (${Math.round(R*100)}% of text)`)):R>.05&&R<=.15&&(n-=10,r.push(`Some French accents (${Math.round(R*100)}% - possibly UK French product)`))}return u>0&&(n-=u*5),/\b(ml|cl|litre|gramme?s?)\b/gi.test(i)&&(n+=5),/\b(fl oz|fluid ounce|oz|ounce)\b/gi.test(i)&&(n-=10,r.push("US measurements detected")),/\b(crisps|biscuits|courgette|aubergine)\b/gi.test(i)&&(n+=10,r.push("UK terminology detected")),n=Math.max(0,Math.min(100,n)),{isLikelyUK:n>=40,confidence:n,flags:r,usSpellingCount:l,foreignCharCount:u,ukBrandMatch:o,usBrandMatch:a}}function Od(e,t=40){const s=[],i=[];for(const a of e)L3(a.name,a.brandName,a.ingredients||null).confidence>=t?s.push(a):i.push(a);const r=e.length,n=s.length,o=i.length;return{ukProducts:s,nonUkProducts:i,stats:{total:r,ukCount:n,nonUkCount:o,ukPercentage:r>0?Math.round(n/r*100):0,nonUkPercentage:r>0?Math.round(o/r*100):0}}}const DT="WK0TIF84M2",O3="577cc4ee3fed660318917bbb54abfb2e",G3=({onBack:e})=>{const[t,s]=E.useState([]),[i,r]=E.useState(!1),[n,o]=E.useState(0),[a,l]=E.useState(""),[u,h]=E.useState(!1),[p,g]=E.useState(!1),[m,C]=E.useState("pending"),[y,R]=E.useState(0),[x,S]=E.useState({total:0,completed:0,failed:0,noResults:0,processing:0}),[T,I]=E.useState([]),[V,H]=E.useState(new Set),[P,N]=E.useState(!0),[_,L]=E.useState(!1),[M,b]=E.useState(!1),[F,Z]=E.useState(!1),[K,ge]=E.useState(!1),[me,de]=E.useState(!1),[ye,pe]=E.useState(!1),[q,ve]=E.useState(!1),[$,be]=E.useState(!1),[se,Ge]=E.useState(!1),[Re,U]=E.useState(!1),[J,ce]=E.useState(null),[Y,te]=E.useState(null),[he,Ae]=E.useState(""),[fe,k]=E.useState(!1),[O,W]=E.useState(""),[le,ne]=E.useState(!1),[X,Q]=E.useState(null),re=E.useRef(!1),Se=E.useRef(!1),Me=50,Ne="nutrasafe_image_scraper_progress",Pe=E.useRef(null),We=E.useCallback(()=>{if(t.length===0)return;const B={savedAt:new Date().toISOString(),foods:t.map(oe=>({id:oe.id,objectID:oe.objectID,name:oe.name,brandName:oe.brandName,barcode:oe.barcode,currentImageUrl:oe.currentImageUrl,sourceIndex:oe.sourceIndex,status:oe.status,selectedImageUrl:oe.selectedImageUrl,confidence:oe.confidence,nutritionData:oe.nutritionData,nutritionStatus:oe.nutritionStatus,error:oe.error})),stats:x,processingLog:T.slice(-20)};try{localStorage.setItem(Ne,JSON.stringify(B)),console.log(` Progress saved: ${t.length} foods`)}catch(oe){console.warn("Failed to save progress to localStorage:",oe)}},[t,x,T]);E.useEffect(()=>{if(t.length!==0)return Pe.current&&clearTimeout(Pe.current),Pe.current=setTimeout(()=>{We()},2e3),()=>{Pe.current&&clearTimeout(Pe.current)}},[t,We]),E.useEffect(()=>{var B;try{const oe=localStorage.getItem(Ne);if(oe){const j=JSON.parse(oe),De=new Date(j.savedAt);if((Date.now()-De.getTime())/(1e3*60*60)<24&&((B=j.foods)==null?void 0:B.length)>0&&(console.log(` Found saved progress from ${De.toLocaleString()} (${j.foods.length} foods)`),window.confirm(`Found saved progress from ${De.toLocaleString()}:
 ${j.foods.length} foods loaded
 ${j.foods.filter(Te=>Te.status==="ready"||Te.status==="completed").length} ready/completed

Restore this progress?`))){const Te=j.foods.map(_e=>({..._e,selected:!1,calories:_e.calories||void 0,dontShowImage:_e.dontShowImage||!1,searchResults:[],analysis:null,analysisProgress:0}));s(Te),j.stats&&S(j.stats),j.processingLog&&I(j.processingLog),N(!1),console.log(` Restored ${Te.length} foods from saved progress`)}}}catch(oe){console.warn("Failed to load saved progress:",oe)}},[]);const Ye=E.useCallback(()=>{localStorage.removeItem(Ne),console.log(" Cleared saved progress")},[]),Ke=B=>{if(!B)return!1;const oe=B.toLowerCase();return["water","drink","juice","soda","cola","pepsi","coke","tea","coffee","latte","cappuccino","espresso","mocha","beverage","smoothie","shake","milkshake","frappuccino","lemonade","squash","cordial","pop","fizzy","sprite","fanta","irn bru","ribena","lucozade","energy drink","sports drink","vitamin water","iced tea","green tea","black tea","herbal tea","hot chocolate","cocoa drink","chocolate drink","milk drink","flavoured milk","almond milk","oat milk","soy milk","protein shake","meal replacement drink"].some(De=>oe.includes(De))},ie=B=>{console.log(B),I(oe=>[...oe.slice(-50),`${new Date().toLocaleTimeString()}: ${B}`])},Dt=async B=>{try{const oe="gRLnCJAV5rWycCc6PKrAUYHb";let j=`${B.brandName||""} ${B.name} nutrition per 100g`.trim();const De=new URLSearchParams({api_key:oe,engine:"google",q:j,hl:"en",gl:"uk",num:"3"}),ae=await fetch(`https://www.searchapi.io/api/v1/search?${De}`,{method:"GET",headers:{Accept:"application/json"}});if(!ae.ok)return console.error("SearchAPI nutrition request failed:",ae.status),null;const ze=await ae.json(),Te=ze.knowledge_graph,_e=ze.answer_box;if(Te&&Te.nutrition_facts){const et=Te.nutrition_facts;return{calories:parseFloat(et.calories)||void 0,protein:parseFloat(et.protein)||void 0,carbs:parseFloat(et.carbohydrates)||void 0,fat:parseFloat(et.fat)||void 0,saturatedFat:parseFloat(et.saturated_fat)||void 0,fiber:parseFloat(et.fiber)||void 0,sugar:parseFloat(et.sugar)||void 0,sodium:parseFloat(et.sodium)||void 0,servingSize:et.serving_size,source:"Google Knowledge Graph"}}if(_e&&_e.nutrition_info){const et=_e.nutrition_info;return{calories:parseFloat(et.calories)||void 0,protein:parseFloat(et.protein)||void 0,carbs:parseFloat(et.carbs)||void 0,fat:parseFloat(et.fat)||void 0,source:"Google Answer Box"}}const Xe=ze.organic_results||[];if(Xe.length>0){for(let jt=0;jt<Math.min(2,Xe.length);jt++){const Ra=Xe[jt].link;if(Ra)try{const Ul=`https://corsproxy.io/?${encodeURIComponent(Ra)}`;console.log(`Fetching page ${jt+1}: ${Ra}`);const Ou=await fetch(Ul,{headers:{Accept:"text/html,application/xhtml+xml,application/xml"}});if(!Ou.ok){console.log(`Page fetch failed with status ${Ou.status}`);continue}const Gu=await Ou.text();console.log(`Fetched ${Gu.length} bytes from page ${jt+1}`);const Bt=Fs(Gu);if(Bt&&Object.keys(Bt).length>2){console.log(`Successfully parsed nutrition from page ${jt+1}:`,Bt);const Di={source:new URL(Ra).hostname.replace("www.","")};return q&&(Bt.calories!==void 0&&(Di.calories=Bt.calories),Bt.protein!==void 0&&(Di.protein=Bt.protein),Bt.carbs!==void 0&&(Di.carbs=Bt.carbs),Bt.fat!==void 0&&(Di.fat=Bt.fat),Bt.saturatedFat!==void 0&&(Di.saturatedFat=Bt.saturatedFat),Bt.fiber!==void 0&&(Di.fiber=Bt.fiber),Bt.sugar!==void 0&&(Di.sugar=Bt.sugar),Bt.sodium!==void 0&&(Di.sodium=Bt.sodium),Bt.salt!==void 0&&(Di.salt=Bt.salt)),$&&Bt.servingSize&&(Di.servingSize=Bt.servingSize),se&&Bt.ingredients&&(Di.ingredients=Bt.ingredients),Di}else console.log(`Insufficient nutrition data from page ${jt+1}: ${Object.keys(Bt||{}).length} fields`)}catch(Ul){console.log(`Failed to fetch page ${jt+1}:`,Ul instanceof Error?Ul.message:"Unknown error");continue}}const et=Xe.slice(0,3).map(jt=>`${jt.snippet||""} ${jt.title||""}`).join(" "),Ct=et.match(/(\d+(?:\.\d+)?)\s*(?:calories|kcal|cal)/i),St=et.match(/(\d+(?:\.\d+)?)\s*g?\s*protein/i),pt=et.match(/(\d+(?:\.\d+)?)\s*g?\s*(?:carb(?:ohydrate)?s?|carbs)/i),Qe=et.match(/(\d+(?:\.\d+)?)\s*g?\s*(?:total\s+)?fat/i),ke=et.match(/(\d+(?:\.\d+)?)\s*g?\s*saturated\s*fat/i),Ve=et.match(/(\d+(?:\.\d+)?)\s*g?\s*(?:fiber|fibre)/i),He=et.match(/(\d+(?:\.\d+)?)\s*g?\s*sugar/i),gt=et.match(/(\d+(?:\.\d+)?)\s*(?:mg|g)?\s*sodium/i),oi=et.match(/(\d+(?:\.\d+)?)\s*g?\s*salt/i),ai=et.match(/(?:serving\s+size|per\s+serving):\s*([^.,;\n]*?\d+\s*(?:g|ml|oz|fl\s*oz|cup|tbsp|tsp|litre|liter|l)[^.,;\n]*)/i),zl=et.match(/ingredients?[:\s]+([^.]{30,500})/i);if(Ct||St||pt||Qe){const jt={source:"Google Snippets"};return q&&(Ct&&(jt.calories=parseFloat(Ct[1])),St&&(jt.protein=parseFloat(St[1])),pt&&(jt.carbs=parseFloat(pt[1])),Qe&&(jt.fat=parseFloat(Qe[1])),ke&&(jt.saturatedFat=parseFloat(ke[1])),Ve&&(jt.fiber=parseFloat(Ve[1])),He&&(jt.sugar=parseFloat(He[1])),gt&&(jt.sodium=parseFloat(gt[1])),oi&&(jt.salt=parseFloat(oi[1]))),$&&ai&&(jt.servingSize=ai[1].trim()),se&&zl&&(jt.ingredients=zl[1].trim()),jt}}return null}catch(oe){return console.error("Error scraping nutrition from Google:",oe),null}},Fs=B=>{var St;console.log(` Parsing HTML: ${B.length} bytes`);const oe=B.toLowerCase(),j={};console.log(" Step 1: Checking for JSON-LD structured data...");const De=B.matchAll(/<script[^>]*type=["']application\/ld\+json["'][^>]*>(.*?)<\/script>/gis);for(const pt of De)try{const Qe=JSON.parse(pt[1]);if(Qe.nutrition||Qe["@type"]==="NutritionInformation"){const ke=Qe.nutrition||Qe;if(ke.calories&&(j.calories=parseFloat(String(ke.calories).replace(/[^0-9.]/g,""))),ke.proteinContent&&(j.protein=parseFloat(String(ke.proteinContent).replace(/[^0-9.]/g,""))),ke.carbohydrateContent&&(j.carbs=parseFloat(String(ke.carbohydrateContent).replace(/[^0-9.]/g,""))),ke.fatContent&&(j.fat=parseFloat(String(ke.fatContent).replace(/[^0-9.]/g,""))),ke.saturatedFatContent&&(j.saturatedFat=parseFloat(String(ke.saturatedFatContent).replace(/[^0-9.]/g,""))),ke.fiberContent&&(j.fiber=parseFloat(String(ke.fiberContent).replace(/[^0-9.]/g,""))),ke.sugarContent&&(j.sugar=parseFloat(String(ke.sugarContent).replace(/[^0-9.]/g,""))),ke.sodiumContent&&(j.sodium=parseFloat(String(ke.sodiumContent).replace(/[^0-9.]/g,""))),ke.servingSize&&(j.servingSize=String(ke.servingSize)),Object.keys(j).length>=3)return console.log(` Step 1 success: Found ${Object.keys(j).length} fields from JSON-LD`),j}}catch{}console.log(` Step 1 complete: ${Object.keys(j).length} fields from JSON-LD (need 3+ for early return)`),console.log(' Step 2: Checking for "per 100g" sections...');const ae=oe.match(/(per\s*100\s*g[^<]*?(?:<[^>]+>[^<]*?){0,50}?(?:calories|kcal|energy|protein|fat|carb)[^<]*?(?:<[^>]+>[^<]*?){0,100})/gis);if(ae){const Qe=ae[0].matchAll(/(\w+)[:\s]*(\d+(?:\.\d+)?)\s*(g|mg|kcal)?/gi);for(const ke of Qe){const Ve=ke[1].toLowerCase(),He=parseFloat(ke[2]);Ve.includes("calor")||Ve.includes("kcal")||Ve.includes("energy")?j.calories=He:Ve.includes("protein")?j.protein=He:Ve.includes("carb")?j.carbs=He:Ve.includes("fat")&&!Ve.includes("saturat")?j.fat=He:Ve.includes("saturat")?j.saturatedFat=He:Ve.includes("sugar")?j.sugar=He:Ve.includes("fib")?j.fiber=He:Ve.includes("sodium")?j.sodium=He:Ve.includes("salt")&&(j.salt=He)}}console.log(` Step 2 complete: ${Object.keys(j).length} fields total`),console.log(" Step 2.5: Extracting from HTML tables...");const ze=B.matchAll(/<tr[^>]*>(.*?)<\/tr>/gis);for(const pt of ze){const Qe=pt[1],ke=Qe.toLowerCase();if(!/calor|kcal|protein|carb|fat|sugar|fib|sodium|salt/i.test(ke))continue;const He=[...Qe.matchAll(/(\d+(?:\.\d+)?)\s*(g|mg|kcal)?/gi)];if(He.length===0)continue;let gt=0;for(const oi of He){const ai=parseFloat(oi[1]);if(ai>0&&ai<1e4){gt=ai;break}}gt!==0&&(!j.calories&&/calor|kcal|energy/i.test(ke)?gt<=900&&(j.calories=gt):!j.protein&&/protein/i.test(ke)?gt<=100&&(j.protein=gt):!j.carbs&&/carb/i.test(ke)&&!/fib/i.test(ke)?gt<=100&&(j.carbs=gt):!j.fat&&/\bfat\b/i.test(ke)&&!/saturat/i.test(ke)?gt<=100&&(j.fat=gt):!j.saturatedFat&&/saturat/i.test(ke)?gt<=100&&(j.saturatedFat=gt):!j.sugar&&/sugar/i.test(ke)?gt<=100&&(j.sugar=gt):!j.fiber&&/fib/i.test(ke)?gt<=50&&(j.fiber=gt):!j.sodium&&/sodium/i.test(ke)?gt<=5e3&&(j.sodium=gt):!j.salt&&/\bsalt\b/i.test(ke)&&!/unsalt/i.test(ke)&&gt<=10&&(j.salt=gt))}if(!j.servingSize){const pt=[/serving\s+size[:\s]*(\d+(?:\.\d+)?)\s*(g|ml|oz|fl\s*oz)/gi,/pack\s+size[:\s]*(\d+(?:\.\d+)?)\s*(g|ml|oz|fl\s*oz)/gi,/net\s+(?:weight|contents?)[:\s]*(\d+(?:\.\d+)?)\s*(g|ml|oz|fl\s*oz)/gi,/per\s+(?:pack|portion|serving)[:\s]*(\d+(?:\.\d+)?)\s*(g|ml)/gi,/(?:bottle|can|pack)[:\s]*(\d+(?:\.\d+)?)\s*(g|ml|oz|fl\s*oz)/gi,/(\d+(?:\.\d+)?)\s*(g|ml|oz)\s+(?:pack|bottle|can|serving|bar|pot)/gi,/serves?\s+(\d+(?:\.\d+)?)\s*(g|ml)/gi,/weight[:\s]*(\d+(?:\.\d+)?)\s*(g|ml|oz)/gi];for(const Qe of pt){const ke=oe.matchAll(Qe);for(const Ve of ke)if(Ve[1]&&Ve[2]){const He=parseFloat(Ve[1]),gt=Ve[2].trim();if(He>=1&&He<=5e3){j.servingSize=`${He}${gt}`;break}}if(j.servingSize)break}}if(console.log(` Step 2.5 complete: ${Object.keys(j).length} fields total`),console.log(" Step 3: Aggressive pattern matching for nutrients..."),!j.calories){const pt=[/calories[:\s]*(\d+(?:\.\d+)?)/gi,/(\d+(?:\.\d+)?)\s*(?:kcal|calories|cal)(?:\s*\/?\s*100\s*g)?/gi,/energy[:\s]*(\d+(?:\.\d+)?)\s*kcal/gi,/per\s*100\s*g[:\s]*(\d+(?:\.\d+)?)\s*cal/gi,/(\d+(?:\.\d+)?)\s*kj\s*\/\s*(\d+(?:\.\d+)?)\s*kcal/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke){const He=Ve[0].match(/(\d+(?:\.\d+)?)\s*kcal/i)||Ve;if(He&&He[1]){const gt=parseFloat(He[1]);if(gt>0&&gt<=900){j.calories=gt;break}}}if(j.calories)break}}if(!j.protein){const pt=[/protein[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*protein/gi,/protein[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=100){j.protein=He;break}}if(j.protein)break}}if(!j.carbs){const pt=[/carbohydrate[s]?[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/carbs[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*carb/gi,/carbohydrate[s]?[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=100){j.carbs=He;break}}if(j.carbs)break}}if(!j.fat){const pt=[/(?:total\s+)?fat[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*(?:total\s+)?fat/gi,/(?:total\s+)?fat[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(!Ve[0].toLowerCase().includes("saturat")&&Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=100){j.fat=He;break}}if(j.fat)break}}if(!j.saturatedFat){const pt=[/saturated[s]?\s*fat[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/saturates[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/of\s*which\s*saturates[:\s]*(\d+(?:\.\d+)?)/gi,/saturated[s]?\s*fat[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=100){j.saturatedFat=He;break}}if(j.saturatedFat)break}}if(!j.sugar){const pt=[/sugar[s]?[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*sugar/gi,/of\s*which\s*sugars[:\s]*(\d+(?:\.\d+)?)/gi,/sugar[s]?[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=100){j.sugar=He;break}}if(j.sugar)break}}if(!j.fiber){const pt=[/fib[re]{2}[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*fib[re]{2}/gi,/fib[re]{2}[:\s<>]*(\d+(?:\.\d+)?)/gi,/dietary\s*fib[re]{2}[:\s]*(\d+(?:\.\d+)?)/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=50){j.fiber=He;break}}if(j.fiber)break}}if(!j.sodium){const pt=[/sodium[:\s]*(\d+(?:\.\d+)?)\s*mg/gi,/(\d+(?:\.\d+)?)\s*mg\s*sodium/gi,/sodium[:\s<>]*(\d+(?:\.\d+)?)\s*mg/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=5e3){j.sodium=He;break}}if(j.sodium)break}}if(!j.salt){const pt=[/salt[:\s]*(\d+(?:\.\d+)?)\s*g/gi,/(\d+(?:\.\d+)?)\s*g\s*salt/gi,/salt[:\s<>]*(\d+(?:\.\d+)?)/gi];for(const Qe of pt){const ke=[...oe.matchAll(Qe)];for(const Ve of ke)if(!(Ve[0].toLowerCase().includes("unsalt")||Ve[0].toLowerCase().includes("no salt"))&&Ve[1]){const He=parseFloat(Ve[1]);if(He>=0&&He<=10){j.salt=He;break}}if(j.salt)break}}if(console.log(" Step 4: Extracting ingredients..."),!j.ingredients){const pt=[/ingredients?[:\s]*([^<.]*(?:flour|sugar|water|salt|oil|milk|egg|butter|corn|wheat|soy|palm)[^<.]*)/gi,/<[^>]*>ingredients?[:\s]*<\/[^>]*>([^<]+)/gi,/(?:contains?|made with)[:\s]*([^<.]*(?:flour|sugar|water|salt|oil|milk)[^<.]*)/gi];for(const ke of pt){const Ve=[...oe.matchAll(ke)];for(const He of Ve){const gt=(St=He[1])==null?void 0:St.trim();if(gt&&gt.length>20&&gt.length<2e3){const oi=gt.replace(/<[^>]+>/g,"").replace(/&[a-z]+;/gi," ").replace(/\s+/g," ").trim();if(oi.length>20){j.ingredients=oi,console.log(` Found ingredients: ${oi.substring(0,100)}...`);break}}}if(j.ingredients)break}const Qe=B.match(/"ingredients":\s*"([^"]+)"/i);!j.ingredients&&Qe&&(j.ingredients=Qe[1].replace(/\\n/g," ").trim(),console.log(` Found ingredients from JSON: ${j.ingredients.substring(0,100)}...`))}console.log(` Step 4 complete: ${j.ingredients?"Found ingredients":"No ingredients"}`);const Te=Object.keys(j).length,_e=j.calories!==void 0,Xe=j.protein!==void 0,et=j.carbs!==void 0,Ct=j.fat!==void 0;return console.log(" Final nutrition data:",j),console.log(` Found fields (${Te}): ${Object.keys(j).join(", ")}`),_e&&(Xe||et||Ct)?(console.log(` SUCCESS: Found calories + macros (${Te} fields total)`),j):Te>=3?(console.log(` SUCCESS: Found ${Te} fields total`),j):(console.log(` INSUFFICIENT: Only ${Te} fields found, need calories+macro or 3+ fields`),null)};E.useEffect(()=>{const B=_3();L(B),ie(B?" SearchAPI configured":" SearchAPI not configured")},[]),E.useEffect(()=>{const B=oe=>{oe.key==="Escape"&&X&&Q(null)};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[X]);const $t=E.useCallback(async()=>{if(V.size===0){ie("No indices selected");return}r(!0),N(!1),o(0),ie(" Loading ALL foods from selected indices (with pagination)...");const B=[],oe=Array.from(V),j=5e3,De="https://us-central1-nutrasafe-705c7.cloudfunctions.net";try{for(let Te=0;Te<oe.length;Te++){const _e=oe[Te];ie(` Loading ${_e}...`);let Xe=0,et=!0,Ct=[],St=0;const pt=2e3;let Qe=0;for(;et&&Qe<pt;){Qe++,Qe>1&&Qe%5===0&&ie(`   ${_e}: ${Ct.length.toLocaleString()} products pulled, fetching more...`);const ke=await fetch(`${De}/browseAllIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indices:[_e],offset:Xe,pageSize:j})});if(!ke.ok){ie(` ${_e}: HTTP ${ke.status}`);break}const Ve=await ke.json();if(Ve.success&&Ve.products){const He=Ve.products||[],gt=Ve.pagination||{};if(He.length===0){ie(`   ${_e}: Reached end (0 products returned)`),et=!1;break}He.length<j&&(ie(`   ${_e}: Last page (${He.length} products)`),et=!1),Ct.push(...He),St=(gt==null?void 0:gt.total)||Ct.length;const oi=Math.floor((Te+Ct.length/Math.max(St,1))/oe.length*100);o(oi);const ai=St>0?Math.round(Ct.length/St*100):0;ie(`   Page ${Qe}: ${Ct.length.toLocaleString()} / ${St.toLocaleString()} (${ai}%)`),gt.hasMore?(et=!0,Xe+=j):(ie(`   ${_e}: Backend says no more data`),et=!1),St>0&&Ct.length>=St&&(ie(`   ${_e}: Reached total count (${Ct.length} >= ${St})`),et=!1)}else{ie(` ${_e}: ${Ve.error||"Failed"}`);break}}Qe>=pt&&ie(` ${_e}: Hit safety limit (${pt} iterations)`),ie(` ${_e}: Loaded ${Ct.length.toLocaleString()} products`);for(const ke of Ct)B.push({id:`${_e}:${ke.objectID}`,objectID:ke.objectID,name:ke.name||ke.foodName||"Unknown",brandName:ke.brandName||ke.brand||null,barcode:ke.barcode||null,currentImageUrl:ke.imageUrl||null,sourceIndex:_e,calories:ke.calories,dontShowImage:ke.dontShowImage||!1,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,nutritionData:null,nutritionStatus:"pending",status:"pending",analysisProgress:0});o(Math.round((Te+1)/oe.length*100))}ie(` Total foods loaded: ${B.length.toLocaleString()}`);let ae=B;if(M){const Te=Od(B,40);ae=Te.ukProducts,ce(Te.stats),ie(` UK filter applied: ${Te.stats.ukCount.toLocaleString()} UK products (${Te.stats.ukPercentage}%), ${Te.stats.nonUkCount.toLocaleString()} filtered out (${Te.stats.nonUkPercentage}%)`)}else ce(null);const ze=ae.length;if(F){const Te=ae.filter(Xe=>Xe.currentImageUrl),_e=ae.filter(Xe=>!Xe.currentImageUrl);te({total:ze,withImages:Te.length,withoutImages:_e.length}),ae=_e,ie(` Image filter applied: ${_e.length.toLocaleString()} without images, ${Te.length.toLocaleString()} with images hidden`)}else te(null);if(K){const Te=ae.length;ae=ae.filter(et=>{const Ct=et.calories!==void 0&&et.calories>=0&&et.calories<=5;return Ct&&me?!Ke(et.name):Ct});const _e=Te-ae.length;ie(`0 Very low calorie filter${me?" (drinks excluded)":""}: ${ae.length.toLocaleString()} with 0-5 kcal, ${_e.toLocaleString()} filtered out`)}if(ye){const Te=ae.length;ae=ae.filter(Xe=>Xe.sourceIndex==="tesco_products"?!Xe.dontShowImage:!0);const _e=Te-ae.length;_e>0&&ie(` Tesco bad images filter: ${ae.length.toLocaleString()} kept, ${_e.toLocaleString()} with bad images filtered out`)}s(ae),hr(ae),o(100),l("")}catch(ae){ie(` Error: ${ae}`)}finally{r(!1)}},[V,M,F,K,me,ye]),bt=E.useCallback(async()=>{if(!O.trim()){ie(" No search query entered");return}if(V.size===0){ie(" No indices selected");return}ne(!0),r(!0),N(!1),o(0),ie(` Searching for: ${O}`);const B=[],oe=Array.from(V);try{for(let De=0;De<oe.length;De++){const ae=oe[De];l(`Searching ${ae}...`),o(Math.round(De/oe.length*100));const ze=`https://${DT}-dsn.algolia.net/1/indexes/${ae}/query`;try{const Te=await fetch(ze,{method:"POST",headers:{"X-Algolia-Application-Id":DT,"X-Algolia-API-Key":O3,"Content-Type":"application/json"},body:JSON.stringify({query:O.trim(),hitsPerPage:1e3,attributesToRetrieve:["objectID","name","foodName","brandName","brand","barcode","imageUrl","calories","dontShowImage"]})});if(!Te.ok){ie(`Error searching ${ae}: ${Te.status}`);continue}const Xe=(await Te.json()).hits||[];ie(`${ae}: ${Xe.length} results`);for(const et of Xe)B.push({id:`${ae}:${et.objectID}`,objectID:et.objectID,name:et.name||et.foodName||"Unknown",brandName:et.brandName||et.brand||null,barcode:et.barcode||null,currentImageUrl:et.imageUrl||null,sourceIndex:ae,calories:et.calories,dontShowImage:et.dontShowImage||!1,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,nutritionData:null,nutritionStatus:"pending",status:"pending",analysisProgress:0})}catch(Te){ie(`Error searching ${ae}: ${Te}`)}}ie(` Found ${B.length} foods matching "${O}"`);let j=B;if(M){const De=Od(B,40);j=De.ukProducts,ce(De.stats),ie(` UK Filter: ${De.ukProducts.length} kept, ${De.nonUkProducts.length} filtered`)}if(F){const De=j.filter(ze=>ze.currentImageUrl),ae=j.filter(ze=>!ze.currentImageUrl);te({total:j.length,withImages:De.length,withoutImages:ae.length}),j=ae,ie(` Image Filter: ${ae.length} without images, ${De.length} with images hidden`)}else te(null);if(K){const De=j.length;j=j.filter(Te=>{const _e=Te.calories!==void 0&&Te.calories>=0&&Te.calories<=5;return _e&&me?!Ke(Te.name):_e});const ae=De-j.length;ie(`0 Very Low Cal Filter${me?" (drinks excluded)":""}: ${j.length} with 0-5 kcal, ${ae} filtered out`)}if(ye){const De=j.length;j=j.filter(ze=>ze.sourceIndex==="tesco_products"?!ze.dontShowImage:!0);const ae=De-j.length;ae>0&&ie(` Tesco Filter: ${j.length} kept, ${ae} bad images filtered`)}s(j),S({total:j.length,completed:0,failed:0,noResults:0,processing:0})}catch(j){ie(` Search failed: ${j}`)}finally{ne(!1),r(!1),o(100)}},[O,V,M,F,K,me,ye,ie]),dr=E.useCallback(async()=>{if(!he.trim()){ie(" No barcode entered");return}k(!0),r(!0),N(!1),o(0),ie(` Searching for barcode: ${he}`);try{const{foods:B}=await QN(he.trim(),Array.from(V));if(B.length===0){ie(` No foods found with barcode: ${he}`),r(!1),k(!1);return}ie(` Found ${B.length} food(s) with barcode ${he}`),ie(` Will search Google Images using barcode: ${he}`);const oe=B.map(j=>({id:j._id,objectID:j.objectID,name:j.name,brandName:j.brandName,barcode:j.barcode,currentImageUrl:j.imageUrl,sourceIndex:j._sourceIndex,calories:j.calories,dontShowImage:j.dontShowImage||!1,selected:!0,searchResults:[],selectedImageUrl:null,analysis:null,nutritionData:null,nutritionStatus:"pending",status:"pending",analysisProgress:0}));s(oe),S({total:oe.length,completed:0,failed:0,noResults:0,processing:0}),ie(` Loaded ${oe.length} food(s) for image scraping`),r(!1),k(!1),setTimeout(()=>{Sa(oe,he.trim())},500)}catch(B){ie(` Barcode search failed: ${B}`),r(!1),k(!1)}},[he,V,ie]),Sa=async(B,oe)=>{if(!_){ie(" SearchAPI not configured. Please set SERP_API_KEY in .env");return}h(!0),re.current=!1,Se.current=!1;const j=B.filter(De=>De.selected);if(j.length===0){ie("No foods selected for processing"),h(!1);return}ie(` Starting image search for ${j.length} food(s) using barcode: ${oe}`);for(const De of j){if(Se.current){ie(" Processing aborted");break}for(;re.current;)await new Promise(ae=>setTimeout(ae,500));try{Rs(De.id,"searching",0),ie(` Searching Google Images for barcode: ${oe} (${De.name})`);const ae=await jC(oe);if(ae.length===0){Rs(De.id,"no_results"),ie(` No images found for barcode: ${oe}`);continue}ie(` Found ${ae.length} images for ${oe}`),s(_e=>_e.map(Xe=>Xe.id===De.id?{...Xe,searchResults:ae,status:"analyzing"}:Xe)),Rs(De.id,"analyzing",0);const ze=[];for(let _e=0;_e<ae.length;_e++){const Xe=ae[_e],et=Math.round((_e+1)/ae.length*100);Rs(De.id,"analyzing",et);try{const Ct=await WC(Xe.url);ze.push({...Xe,analysis:Ct})}catch(Ct){console.error("Analysis error:",Ct)}}const Te=ze.map(_e=>{let Xe=0;return _e.analysis.backgroundConfidence>=95&&_e.analysis.hasWhiteBackground?Xe=95:(_e.analysis.hasWhiteBackground&&(Xe+=40),_e.analysis.hasOverlay||(Xe+=30),Xe+=Math.min(20,_e.analysis.backgroundConfidence*.2)),_e.isManufacturerSite&&(Xe+=5),{..._e,confidence:Xe}}).sort((_e,Xe)=>Xe.confidence-_e.confidence);if(Te.length>0){const _e=Te[0];s(Xe=>Xe.map(et=>et.id===De.id?{...et,searchResults:Te,selectedImageUrl:_e.confidence>=80?_e.url:null,analysis:_e.analysis,status:_e.confidence>=80?"ready":"pending",confidence:_e.confidence}:et)),_e.confidence>=80?ie(` ${De.name}: Auto-selected image (${_e.confidence}% confidence)`):ie(` ${De.name}: Manual selection needed (${_e.confidence}% confidence)`)}}catch(ae){Rs(De.id,"failed",0,String(ae)),ie(` Error processing ${De.name}: ${ae}`)}}h(!1),ie(" Processing complete")},hr=B=>{S({total:B.length,completed:B.filter(oe=>oe.status==="completed").length,failed:B.filter(oe=>oe.status==="failed").length,noResults:B.filter(oe=>oe.status==="no_results").length,processing:B.filter(oe=>["searching","analyzing","uploading"].includes(oe.status)).length})},Rs=(B,oe,j,De)=>{s(ae=>{const ze=ae.map(Te=>Te.id===B?{...Te,status:oe,analysisProgress:j!==void 0?j:Te.analysisProgress,error:De}:Te);return hr(ze),ze})},Wl=B=>{s(oe=>oe.map(j=>j.id===B?{...j,selected:!j.selected}:j))},ln=()=>{const B=os(),oe=new Set(B.map(j=>j.id));s(j=>j.map(De=>oe.has(De.id)?{...De,selected:!0}:De))},po=()=>{s(B=>B.map(oe=>({...oe,selected:!1})))},go=async B=>{if(Se.current)return{...B,status:"pending"};for(;re.current;)if(await new Promise(j=>setTimeout(j,100)),Se.current)return{...B,status:"pending"};const oe=B.brandName?`${B.brandName} ${B.name}`:B.name;ie(`Searching SearchAPI for: ${oe}`);try{s(Qe=>Qe.map(ke=>ke.id===B.id?{...ke,status:"searching"}:ke));const j=await jC(B.name,B.brandName,10);if(j.length===0)return ie(`No results for ${B.name}`),{...B,status:"no_results",searchResults:[],error:"No images found"};ie(`Found ${j.length} images for ${B.name}`);const De=j.filter(Qe=>!Qe.disqualified);if(De.length===0)return ie(`All images disqualified for ${B.name}`),{...B,status:"no_results",searchResults:j,error:"All images disqualified"};let ae=null,ze=null,Te=0;for(let Qe=0;Qe<Math.min(De.length,8);Qe++){const ke=De[Qe];ie(`Analyzing result ${Qe+1}/${De.length} for ${B.name} (${ke.domain})`),s(Ve=>Ve.map(He=>He.id===B.id?{...He,status:"analyzing",searchResults:j,selectedImageUrl:ke.url}:He));try{const Ve=await WC(ke.url,gt=>{s(oi=>oi.map(ai=>ai.id===B.id?{...ai,analysisProgress:gt}:ai))});let He=0;if(Ve.backgroundConfidence>=95&&Ve.hasWhiteBackground?He=95:(Ve.hasWhiteBackground&&(He+=40),Ve.hasOverlay||(He+=30),He+=Math.min(20,Ve.backgroundConfidence*.2)),ke.isManufacturerSite&&(He+=5),ie(`Analysis: ${B.name} - Confidence: ${Math.round(He)}% (BG: ${Ve.backgroundConfidence}%, Overlay: ${Ve.hasOverlay?"Yes":"No"})`),He>=80){ie(` High confidence (${Math.round(He)}%) - Auto-selecting`),ae=ke,ze=Ve,Te=He;break}He>Te&&(ae=ke,ze=Ve,Te=He)}catch(Ve){ie(`Failed to analyze image from ${ke.domain}: ${Ve instanceof Error?Ve.message:"CORS error"}`);continue}}if(!ae||!ze)return ie(`Could not analyze any images for ${B.name} (CORS blocked)`),{...B,searchResults:j,status:"failed",error:"All images blocked by CORS"};const _e=Math.round(Te),Xe=_e>=80?"ready":"analyzing",et=_e>=80?` High confidence (${_e}%) - Ready to use`:` Low confidence (${_e}%) - Review needed`;ie(et);const Ct=j.map(Qe=>({...Qe,isBestResult:Qe.url===ae.url}));let St=null,pt="pending";if(q||$||se){const Qe=[];q&&Qe.push("nutrition"),$&&Qe.push("serving size"),se&&Qe.push("ingredients"),ie(` Scraping ${Qe.join(", ")} for ${B.name}...`),s(ke=>ke.map(Ve=>Ve.id===B.id?{...Ve,nutritionStatus:"searching"}:Ve)),St=await Dt(B),St?(B.sourceIndex==="fast_foods_database"&&!St.servingSize&&(St.servingSize="per unit",ie(' Fast food item - defaulting to "per unit" serving size')),pt="found",ie(` Nutrition found for ${B.name} (${St.source})`)):(pt="not_found",ie(` No nutrition data found for ${B.name}`))}return{...B,searchResults:Ct,selectedImageUrl:ae.url,analysis:ze,nutritionData:St,nutritionStatus:pt,status:Xe,confidence:_e,error:_e<80?`Low confidence (${_e}%) - ${ze.overlayTypes.join(", ")||"Check image quality"}`:void 0,analysisProgress:100}}catch(j){return ie(`Error searching ${B.name}: ${j}`),{...B,status:"failed",error:j instanceof Error?j.message:String(j)}}},_r=async()=>{h(!0),re.current=!1,Se.current=!1;const B=t.filter(j=>j.selected),oe=B.length>0?B:t.filter(j=>j.status==="pending"||j.nutritionStatus==="pending");if(ie(` Starting nutrition scraping for ${oe.length} foods`),oe.length===0){ie("No foods to process!"),h(!1);return}for(let j=0;j<oe.length;j++){if(Se.current){ie("Nutrition scraping stopped by user");break}const De=oe[j];ie(`[${j+1}/${oe.length}] Scraping nutrition for ${De.name}...`),s(ze=>ze.map(Te=>Te.id===De.id?{...Te,nutritionStatus:"searching"}:Te));const ae=await Dt(De);if(ae){De.sourceIndex==="fast_foods_database"&&!ae.servingSize&&(ae.servingSize="per unit",ie(' Fast food item - defaulting to "per unit" serving size')),s(Te=>Te.map(_e=>_e.id===De.id?{..._e,nutritionData:ae,nutritionStatus:"found",status:"uploading"}:_e));const ze=[];ae.calories!==void 0&&ze.push("calories"),ae.protein!==void 0&&ze.push("protein"),ae.carbs!==void 0&&ze.push("carbs"),ae.fat!==void 0&&ze.push("fat"),ae.sugar!==void 0&&ze.push("sugar"),ae.fiber!==void 0&&ze.push("fiber"),ae.servingSize&&ze.push(`serving: ${ae.servingSize}`),ae.ingredients&&ze.push("ingredients"),ie(` ${De.name}: Found ${ze.length} fields (${ae.source}) ${ae.servingSize?"":""}${ae.ingredients?"":""}`),ae.servingSize&&ie(`   Serving size: ${ae.servingSize}`),ae.ingredients&&ie(`   Ingredients: ${ae.ingredients.substring(0,100)}...`);try{ie(` Saving nutrition for ${De.name}...`);const Te=De.sourceIndex==="fast_foods_database";let _e=null;if(Te){const Ct=De.name.toLowerCase();let St="item";if(Ct.includes("burger")?St="burger":Ct.includes("sandwich")?St="sandwich":Ct.includes("wrap")?St="wrap":Ct.includes("salad")?St="salad":Ct.includes("fries")||Ct.includes("chips")||Ct.includes("nugget")?St="serving":Ct.includes("pizza")&&(St="pizza"),ae.servingSize){const pt=typeof ae.servingSize=="number"?`${ae.servingSize}g`:ae.servingSize;_e=`${St} (${pt})`}else _e=St}const Xe=Te?{calories:ae.calories??null,protein:ae.protein??null,carbs:ae.carbs??null,fat:ae.fat??null,saturatedFat:ae.saturatedFat??null,fiber:ae.fiber??null,sugar:ae.sugar??null,sodium:ae.sodium??null,salt:ae.salt??null,servingSizeG:1,servingDescription:_e,isPerUnit:!0,ingredients:ae.ingredients??null}:{calories:ae.calories,protein:ae.protein,carbs:ae.carbs,fat:ae.fat,saturatedFat:ae.saturatedFat,fiber:ae.fiber,sugar:ae.sugar,sodium:ae.sodium,salt:ae.salt,servingSizeG:ae.servingSize,ingredients:ae.ingredients};Te&&(ie(` Fast food mode: Setting isPerUnit=true, servingSizeG=1, description="${_e}"`),ie("   Nutrition values are for FULL UNIT (not per 100g) - won't be multiplied by grams"));const et=await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/updateFoodNutrition",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:De.sourceIndex,objectID:De.objectID,nutritionData:Xe})});if(!et.ok)throw new Error(`HTTP ${et.status}`);s(Ct=>Ct.map(St=>St.id===De.id?{...St,status:"completed"}:St)),ie(` ${De.name}: Saved to database`)}catch(Te){ie(` ${De.name}: Nutrition found but save failed - ${Te}`),s(_e=>_e.map(Xe=>Xe.id===De.id?{...Xe,status:"ready",error:"Save failed"}:Xe))}}else s(ze=>ze.map(Te=>Te.id===De.id?{...Te,nutritionStatus:"not_found",status:"failed"}:Te)),ie(` ${De.name}: No nutrition data found`);await new Promise(ze=>setTimeout(ze,500))}ie(" Nutrition scraping complete"),h(!1),g(!1)},xa=async()=>{if(Re)return _r();if(!_){alert("Please configure SearchAPI first. See the console log for instructions."),ie(RT());return}h(!0),re.current=!1,Se.current=!1;const B=t.filter(j=>j.selected),oe=B.length>0?B:t.filter(j=>j.status==="pending");if(ie(`Starting batch search of ${oe.length} foods`),oe.length===0){ie("No foods to process!"),h(!1);return}for(let j=0;j<oe.length;j++){if(Se.current){ie("Search stopped by user");break}const De=oe[j];ie(`[${j+1}/${oe.length}] Processing ${De.name}`);const ae=await go(De);s(ze=>{const Te=ze.map(_e=>_e.id===De.id?ae:_e);return hr(Te),Te}),await new Promise(ze=>setTimeout(ze,1e3))}ie("Batch search complete"),h(!1),g(!1)},Ea=()=>{re.current=!0,g(!0),ie("Paused")},ba=()=>{re.current=!1,g(!1),ie("Resumed")},kr=()=>{Se.current=!0,h(!1),g(!1),ie("Stopped")},ni=E.useCallback(async()=>{if(!_){ie(" SearchAPI not configured. Please set SERP_API_KEY in .env");return}h(!0),re.current=!1,Se.current=!1;const B=t.filter(j=>j.selected),oe=B.length>0?B:t.filter(j=>j.status==="pending");if(oe.length===0){ie("No foods to process!"),h(!1);return}ie(` Starting barcode-based image search for ${oe.length} food(s)`);for(let j=0;j<oe.length;j++){if(Se.current){ie("Search stopped by user");break}const De=oe[j];if(!De.barcode){ie(`[${j+1}/${oe.length}]  ${De.name} - No barcode, skipping`),s(ae=>ae.map(ze=>ze.id===De.id?{...ze,status:"failed",error:"No barcode"}:ze));continue}ie(`[${j+1}/${oe.length}] ${De.name} - Using barcode: ${De.barcode}`),s(ae=>ae.map(ze=>ze.id===De.id?{...ze,status:"searching"}:ze));try{const ae=await jC(De.barcode,De.brandName||void 0);if(ae.length===0)ie("   No results found"),s(ze=>ze.map(Te=>Te.id===De.id?{...Te,status:"no_results"}:Te));else{ie(`   Found ${ae.length} images`),s(_e=>_e.map(Xe=>Xe.id===De.id?{...Xe,status:"analyzing",searchResults:ae}:Xe));const Te=(await Promise.all(ae.map(_e=>WC(_e.url)))).map((_e,Xe)=>({analysis:_e,result:ae[Xe]})).sort((_e,Xe)=>Xe.analysis.qualityScore-_e.analysis.qualityScore)[0];Te&&Te.analysis.qualityScore>=70?(ie(`   Best image: ${Te.analysis.qualityScore}% confidence`),s(_e=>_e.map(Xe=>Xe.id===De.id?{...Xe,status:"ready",selectedImageUrl:Te.result.url,analysis:Te.analysis,confidence:Te.analysis.qualityScore}:Xe))):(ie(`   Low quality images (best: ${(Te==null?void 0:Te.analysis.qualityScore)||0}%)`),s(_e=>_e.map(Xe=>Xe.id===De.id?{...Xe,status:"ready",analysis:(Te==null?void 0:Te.analysis)||null,confidence:(Te==null?void 0:Te.analysis.qualityScore)||0}:Xe)))}}catch(ae){ie(`   Error: ${ae instanceof Error?ae.message:"Unknown error"}`),s(ze=>ze.map(Te=>Te.id===De.id?{...Te,status:"failed",error:"Search failed"}:Te))}s(ae=>(hr(ae),ae)),await new Promise(ae=>setTimeout(ae,1e3))}ie("Barcode image search complete"),h(!1),g(!1)},[t,_,ie]),os=E.useCallback(()=>{let B=t;switch(m){case"pending":B=B.filter(oe=>oe.status==="pending");break;case"ready":B=B.filter(oe=>oe.status==="ready");break;case"selected":B=B.filter(oe=>oe.selected);break;case"nutrition_found":B=B.filter(oe=>oe.nutritionStatus==="found");break;case"nutrition_failed":B=B.filter(oe=>oe.nutritionStatus==="not_found"||oe.nutritionStatus==="failed");break}if(O.trim()){const oe=O.toLowerCase().trim();B=B.filter(j=>{var De,ae;return j.name.toLowerCase().includes(oe)||((De=j.brandName)==null?void 0:De.toLowerCase().includes(oe))||((ae=j.barcode)==null?void 0:ae.includes(oe))||j.objectID.toLowerCase().includes(oe)})}return B},[t,m,O]),Ki=os(),Mr=Ki.slice(y*Me,(y+1)*Me),Gs=Math.ceil(Ki.length/Me),Is=t.filter(B=>B.selected).length,Lr=t.filter(B=>B.status==="pending").length,pr=t.filter(B=>B.status==="ready").length,Sv=t.filter(B=>B.nutritionStatus==="found").length,xv=t.filter(B=>B.nutritionStatus==="not_found"||B.nutritionStatus==="failed").length,Lu={pending:"bg-gray-100 text-gray-600",searching:"bg-blue-100 text-blue-600",analyzing:"bg-yellow-100 text-yellow-600",ready:"bg-green-100 text-green-600",uploading:"bg-purple-100 text-purple-600",completed:"bg-green-500 text-white",failed:"bg-red-100 text-red-600",no_results:"bg-gray-200 text-gray-500"},Ev={pending:"Pending",searching:"Searching...",analyzing:"Analyzing...",ready:"Ready",uploading:"Uploading...",completed:"Done",failed:"Failed",no_results:"No Results"};return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Google Image Scraper"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Find official white background product images from manufacturer sites"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[t.length>0&&!u&&c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>{s([]),N(!0),S({total:0,completed:0,failed:0,noResults:0,processing:0})},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Change Indices"]}),c.jsxs("button",{onClick:()=>{confirm("Clear saved progress? This will remove your saved state from browser storage.")&&(Ye(),s([]),N(!0),S({total:0,completed:0,failed:0,noResults:0,processing:0}),I([]))},className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg",title:"Clear saved progress from browser storage",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear Saved"]})]}),c.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm ${_?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[c.jsx("div",{className:`w-2 h-2 rounded-full ${_?"bg-green-500":"bg-red-500"}`}),_?"API Configured":"API Not Configured"]}),u?c.jsxs(c.Fragment,{children:[p?c.jsx("button",{onClick:ba,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Resume"}):c.jsx("button",{onClick:Ea,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700",children:"Pause"}),c.jsx("button",{onClick:kr,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Stop"})]}):c.jsxs(c.Fragment,{children:[t.length>0&&c.jsxs("button",{onClick:ni,disabled:i||!_||Is===0&&Lr===0,className:"flex items-center gap-2 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",title:"Search for images using each food's barcode instead of product name",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),Is>0?`Search by Barcode (${Is})`:`Search All by Barcode (${Lr})`]}),c.jsxs("button",{onClick:xa,disabled:i||!Re&&!_||Is===0&&Lr===0,className:"flex items-center gap-2 px-5 py-2.5 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:[Re?c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Re?Is>0?`Scrape Nutrition (${Is})`:`Scrape All Nutrition (${Lr})`:Is>0?`Search Selected (${Is})`:`Search All (${Lr})`]}),pr>0&&c.jsxs("button",{onClick:async()=>{const B=t.filter(oe=>oe.status==="ready"&&oe.selectedImageUrl);ie(`Starting upload of ${B.length} ready items...`);for(const oe of B){s(j=>j.map(De=>De.id===oe.id?{...De,status:"uploading"}:De));try{ie(`Uploading ${oe.name}...`);const j=await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/uploadFoodImage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:oe.selectedImageUrl,index:oe.sourceIndex,objectID:oe.objectID})});if(!j.ok){const ae=await j.text();throw new Error(`HTTP ${j.status}: ${ae}`)}const De=await j.json();ie(` ${oe.name}`),s(ae=>ae.map(ze=>ze.id===oe.id?{...ze,status:"completed",currentImageUrl:De.imageUrl}:ze)),await new Promise(ae=>setTimeout(ae,500))}catch(j){ie(` ${oe.name}: ${j instanceof Error?j.message:"Unknown error"}`),s(De=>De.map(ae=>ae.id===oe.id?{...ae,status:"failed",error:"Upload failed"}:ae))}}ie("Upload batch complete")},className:"flex items-center gap-2 px-5 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload All Ready (",pr,")"]})]})]})]}),c.jsxs("div",{className:"space-y-3",children:[i&&c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${n}%`}})}),c.jsx("span",{className:"text-sm text-gray-500",children:a||`Loading... ${n}%`})]}),!i&&t.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden flex",children:[c.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${x.completed/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-blue-400 transition-all",style:{width:`${pr/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-red-400 transition-all",style:{width:`${x.failed/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-gray-400 transition-all",style:{width:`${x.noResults/Math.max(x.total,1)*100}%`}}),c.jsx("div",{className:"h-full bg-yellow-400 animate-pulse",style:{width:`${x.processing/Math.max(x.total,1)*100}%`}})]}),c.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[c.jsxs("span",{className:"text-gray-600",children:["Total: ",c.jsx("strong",{children:x.total.toLocaleString()})]}),c.jsxs("span",{className:"text-green-600",children:["Completed: ",c.jsx("strong",{children:x.completed.toLocaleString()})]}),c.jsxs("span",{className:"text-blue-600",children:["Ready: ",c.jsx("strong",{children:pr.toLocaleString()})]}),c.jsxs("span",{className:"text-red-600",children:["Failed: ",c.jsx("strong",{children:x.failed.toLocaleString()})]}),c.jsxs("span",{className:"text-gray-500",children:["No Results: ",c.jsx("strong",{children:x.noResults.toLocaleString()})]}),x.processing>0&&c.jsxs("span",{className:"text-yellow-600 animate-pulse",children:["Processing: ",c.jsx("strong",{children:x.processing})]}),Is>0&&c.jsxs("span",{className:"text-primary-600",children:["Selected: ",c.jsx("strong",{children:Is})]}),J&&c.jsxs("span",{className:"text-blue-600",children:[" UK Filter: ",c.jsx("strong",{children:J.ukCount})," kept (",J.ukPercentage,"%), ",c.jsx("strong",{children:J.nonUkCount})," filtered (",J.nonUkPercentage,"%)"]}),Y&&c.jsxs("span",{className:"text-purple-600",children:[" Image Filter: ",c.jsx("strong",{children:Y.withoutImages.toLocaleString()})," without images, ",c.jsx("strong",{children:Y.withImages.toLocaleString()})," with images hidden"]})]})]})]})]}),c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 flex items-center justify-between",children:[c.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All",count:t.length},{value:"pending",label:"Pending",count:Lr},{value:"ready",label:"Ready",count:pr},{value:"selected",label:"Selected",count:Is},{value:"nutrition_found",label:" Nutrition Found",count:Sv},{value:"nutrition_failed",label:" No Nutrition",count:xv}].map(B=>c.jsxs("button",{onClick:()=>{C(B.value),R(0)},className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${m===B.value?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[B.label," (",B.count.toLocaleString(),")"]},B.value))}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",placeholder:"Search foods...",value:O,onChange:B=>{W(B.target.value),R(0)},onKeyDown:B=>{B.key==="Enter"&&O.trim()&&t.length===0&&bt()},className:"w-64 px-3 py-1.5 pl-9 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),c.jsx("svg",{className:"absolute left-2.5 top-2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),O&&c.jsx("button",{onClick:()=>{W(""),R(0)},className:"absolute right-2 top-2 text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.length===0&&c.jsxs("button",{onClick:bt,disabled:!O.trim()||le||V.size===0,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[le?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Search Algolia"]}),O&&t.length>0&&c.jsxs("span",{className:"text-xs text-gray-500",children:[Ki.length," result",Ki.length!==1?"s":""," (filtered)"]}),c.jsx("button",{onClick:ln,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Select All"}),c.jsx("button",{onClick:po,className:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded",children:"Deselect All"})]})]}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx("div",{className:"flex-1 overflow-auto p-6",children:P&&!i&&t.length===0?c.jsx("div",{className:"max-w-3xl mx-auto",children:c.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden",children:[c.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 px-6 py-5 text-white",children:[c.jsx("h2",{className:"text-xl font-bold",children:"Google Image Scraper"}),c.jsx("p",{className:"text-primary-100 text-sm mt-1",children:"Search Google for official white background product images from manufacturer sites"})]}),!_&&c.jsx("div",{className:"px-6 py-4 bg-yellow-50 border-b border-yellow-100",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("svg",{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Google API Not Configured"}),c.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"You need a Google API key and Custom Search Engine ID. Check the browser console for setup instructions."}),c.jsx("button",{onClick:()=>ie(RT()),className:"mt-2 text-xs text-yellow-800 underline hover:text-yellow-900",children:"Show setup instructions in console"})]})]})}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"1"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Select indices to load foods from"})]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mb-6",children:Zt.map(B=>c.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${V.has(B)?"border-primary-500 bg-primary-50 shadow-sm":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("input",{type:"checkbox",checked:V.has(B),onChange:()=>{H(oe=>{const j=new Set(oe);return j.has(B)?j.delete(B):j.add(B),j})},className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"text-sm font-medium text-gray-700 truncate",children:B.replace(/_/g," ")})]},B))}),c.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-6 border-b border-gray-200",children:[c.jsx("button",{onClick:()=>H(new Set(Zt)),className:"px-3 py-1.5 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:"Select All"}),c.jsx("button",{onClick:()=>H(new Set),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear All"}),c.jsxs("span",{className:"text-sm text-gray-400",children:[V.size," of ",Zt.length," selected"]})]}),c.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"2"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Filter products by region"})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-blue-200 bg-blue-50 cursor-pointer hover:bg-blue-100 transition-colors",children:[c.jsx("input",{type:"checkbox",checked:M,onChange:B=>b(B.target.checked),className:"w-4 h-4 text-blue-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" UK Products Only"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-blue-700 bg-blue-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Filter out non-UK products before searching images. Detects US spelling (color vs colour), foreign languages, and non-UK brands. Allows up to 10% non-UK content to include French-named UK products (e.g., "crme frache").'})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-purple-200 bg-purple-50 cursor-pointer hover:bg-purple-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:F,onChange:B=>Z(B.target.checked),className:"w-4 h-4 text-purple-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Hide Foods With Images"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-purple-700 bg-purple-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Only show foods that are missing images. This helps you focus on products that actually need image scraping, saving time and API calls."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-orange-200 bg-orange-50 cursor-pointer hover:bg-orange-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:K,onChange:B=>ge(B.target.checked),className:"w-4 h-4 text-orange-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:"0 Very Low Calorie (0-5 kcal)"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Only show foods with 0-5 calories per 100g. Catches zero-calorie sweeteners, diet sodas, condiments, and other ultra-low calorie products (including 1-2 kcal items like sugar-free syrups)."})]})]}),K&&c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-amber-200 bg-amber-50 cursor-pointer hover:bg-amber-100 transition-colors mt-3 ml-6",children:[c.jsx("input",{type:"checkbox",checked:me,onChange:B=>de(B.target.checked),className:"w-4 h-4 text-amber-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Exclude Drinks"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"When filtering very low calorie items, exclude beverages like water, diet sodas, tea, coffee, and other drinks. Focus on actual food items only."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-red-200 bg-red-50 cursor-pointer hover:bg-red-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:ye,onChange:B=>pe(B.target.checked),className:"w-4 h-4 text-red-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Hide Tesco Bad Images"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-red-700 bg-red-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:`Hide Tesco products that are marked with "dontShowImage" flag. These have been identified as having poor quality images that shouldn't be displayed.`})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-green-200 bg-green-50 cursor-pointer hover:bg-green-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:q,onChange:B=>ve(B.target.checked),className:"w-4 h-4 text-green-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Scrape Nutrition Data"}),c.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-green-700 bg-green-200 rounded-full",children:"Recommended"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Automatically fetch nutrition information from Google during processing. Includes calories, protein, carbs, fat, fiber, sugar, and sodium."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-blue-200 bg-blue-50 cursor-pointer hover:bg-blue-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:$,onChange:B=>be(B.target.checked),className:"w-4 h-4 text-blue-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Scrape Serving Size"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Extract serving size information (e.g., "100g", "250ml", "1 slice"). Useful for standardizing portion sizes across different products.'})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-purple-200 bg-purple-50 cursor-pointer hover:bg-purple-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:se,onChange:B=>Ge(B.target.checked),className:"w-4 h-4 text-purple-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Scrape Ingredients"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Automatically extract ingredient lists from product pages. Essential for allergen detection and dietary restrictions."})]})]}),c.jsxs("label",{className:"flex items-start gap-3 p-4 rounded-lg border-2 border-teal-200 bg-teal-50 cursor-pointer hover:bg-teal-100 transition-colors mt-3",children:[c.jsx("input",{type:"checkbox",checked:Re,onChange:B=>U(B.target.checked),className:"w-4 h-4 text-teal-600 rounded mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("span",{className:"text-sm font-medium text-gray-900",children:" Nutrition Only Mode"})}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Skip image scraping entirely - only search for nutrition data. Much faster and uses fewer API calls. Great for quickly filling in missing nutrition information."})]})]})]}),c.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-gray-500",children:[c.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold",children:"3"}),c.jsx("span",{className:"font-medium text-gray-700",children:"Search by barcode or load all"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("input",{type:"text",placeholder:"Enter barcode (e.g., 5000159407236)",value:he,onChange:B=>Ae(B.target.value),onKeyDown:B=>{B.key==="Enter"&&he.trim()&&dr()},className:"w-full px-4 py-3 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})}),c.jsxs("button",{onClick:dr,disabled:!he.trim()||fe||V.size===0,className:"flex items-center gap-2 px-5 py-3 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg",children:[fe?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Search"]})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:" Search for a specific product by barcode, or load all foods from selected indices below"})]}),c.jsxs("button",{onClick:$t,disabled:V.size===0,className:"w-full flex items-center justify-center gap-3 px-6 py-4 text-lg font-semibold text-white bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 rounded-xl shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none",children:[c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Load All ",V.size>0?`Foods from ${V.size} ${V.size===1?"Index":"Indices"}`:"Foods"]}),V.size===0&&c.jsx("p",{className:"text-center text-sm text-red-500 mt-3",children:"Select at least one index to continue"})]})]})}):i?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("svg",{className:"w-8 h-8 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),c.jsx("span",{className:"text-gray-500",children:a||"Loading foods..."})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid gap-3",children:Mr.map(B=>c.jsx("div",{className:`bg-white rounded-lg border p-4 transition-colors ${B.selected?"border-primary-500 bg-primary-50":"border-gray-200"}`,children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("input",{type:"checkbox",checked:B.selected,onChange:()=>Wl(B.id),className:"w-4 h-4 text-primary-600 rounded mt-1"}),c.jsxs("div",{className:"flex-shrink-0",children:[c.jsx("div",{className:"text-xs text-gray-400 mb-1 text-center",children:B.selectedImageUrl?"Selected":"Current"}),c.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded flex items-center justify-center overflow-hidden cursor-pointer hover:ring-2 hover:ring-primary-400",onClick:()=>{const oe=B.selectedImageUrl||B.currentImageUrl;oe&&Q({url:oe,title:`${B.name}`})},children:B.selectedImageUrl?c.jsx("img",{src:B.selectedImageUrl,alt:"",className:"w-full h-full object-contain"}):B.currentImageUrl?c.jsx("img",{src:B.currentImageUrl,alt:"",className:"w-full h-full object-contain"}):c.jsx("span",{className:"text-xs text-gray-400",children:"None"})})]}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900",children:B.name}),B.brandName&&c.jsx("div",{className:"text-sm text-gray-500",children:B.brandName}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-1",children:[c.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded",children:B.sourceIndex.replace(/_/g," ")}),B.calories!==void 0&&c.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 rounded",children:[B.calories," cal"]})]}),B.nutritionData&&c.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded text-xs",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("div",{className:"font-semibold text-green-900 flex items-center gap-1",children:[" Nutrition (per 100g)",B.nutritionData.servingSize&&c.jsx("span",{className:"text-blue-600",children:""})]}),c.jsx("div",{className:"text-[10px] text-green-700",children:B.nutritionData.source})]}),B.nutritionData.servingSize&&c.jsxs("div",{className:"px-2 py-1 bg-blue-50 border border-blue-200 rounded text-[11px] text-blue-900 font-medium mb-1",children:[" Serving: ",B.nutritionData.servingSize]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 text-gray-700",children:[B.nutritionData.calories!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Cal:"})," ",B.nutritionData.calories]}),B.nutritionData.protein!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Protein:"})," ",B.nutritionData.protein,"g"]}),B.nutritionData.carbs!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Carbs:"})," ",B.nutritionData.carbs,"g"]}),B.nutritionData.fat!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Fat:"})," ",B.nutritionData.fat,"g"]}),B.nutritionData.saturatedFat!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Sat Fat:"})," ",B.nutritionData.saturatedFat,"g"]}),B.nutritionData.fiber!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Fiber:"})," ",B.nutritionData.fiber,"g"]}),B.nutritionData.sugar!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Sugar:"})," ",B.nutritionData.sugar,"g"]}),B.nutritionData.sodium!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Sodium:"})," ",B.nutritionData.sodium,"mg"]}),B.nutritionData.salt!==void 0&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Salt:"})," ",B.nutritionData.salt,"g"]})]})]}),B.nutritionStatus!=="pending"&&!B.nutritionData&&c.jsx("div",{className:"mt-2 text-xs",children:c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded ${B.nutritionStatus==="searching"?"bg-blue-100 text-blue-700":B.nutritionStatus==="not_found"?"bg-yellow-100 text-yellow-700":B.nutritionStatus==="failed"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:[B.nutritionStatus==="searching"&&" Searching nutrition...",B.nutritionStatus==="not_found"&&" No nutrition data found",B.nutritionStatus==="failed"&&" Nutrition search failed"]})}),B.searchResults.length>0&&c.jsxs("div",{className:"mt-3",children:[c.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Found ",B.searchResults.length," images",B.confidence!==void 0&&c.jsxs("span",{className:`ml-2 font-semibold ${B.confidence>=80?"text-green-600":B.confidence>=60?"text-yellow-600":"text-red-600"}`,children:[B.confidence>=80?"":""," ",B.confidence,"% confidence"]})]}),c.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:B.searchResults.slice(0,10).map((oe,j)=>c.jsxs("div",{className:"flex-shrink-0 relative group",children:[c.jsx("div",{className:`w-20 h-20 bg-gray-100 rounded overflow-hidden cursor-pointer hover:ring-2 hover:ring-blue-400 ${B.selectedImageUrl===oe.url?"ring-2 ring-primary-500":""}`,onClick:()=>{Q({url:oe.url,title:`${B.name} - Result ${j+1} (${oe.domain})`})},children:c.jsx("img",{src:oe.thumbnail,alt:"",className:"w-full h-full object-cover"})}),oe.isManufacturerSite&&c.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-green-500 rounded-full flex items-center justify-center",children:c.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),B.selectedImageUrl===oe.url&&c.jsx("div",{className:"absolute inset-0 bg-primary-500/20 rounded flex items-center justify-center",children:c.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),c.jsx("button",{onClick:De=>{De.stopPropagation(),s(ae=>ae.map(ze=>ze.id===B.id?{...ze,selectedImageUrl:oe.url,status:"ready",error:void 0}:ze)),ie(`Selected image for ${B.name} - ready for upload`)},className:"absolute bottom-0 left-0 right-0 bg-primary-600 text-white text-[9px] py-0.5 hover:bg-primary-700 opacity-0 group-hover:opacity-100 transition-opacity",children:"Select This"}),c.jsx("div",{className:"text-[8px] text-gray-400 mt-0.5 truncate w-20 text-center",children:oe.domain})]},j))})]})]}),c.jsxs("div",{className:"flex-shrink-0 text-right",children:[c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${Lu[B.status]}`,children:[["searching","analyzing","uploading"].includes(B.status)&&c.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),Ev[B.status]]}),B.status==="analyzing"&&c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[B.analysisProgress,"%"]}),B.error&&c.jsx("div",{className:"text-[10px] text-red-500 mt-1 max-w-[120px]",title:B.error,children:B.error})]})]})},B.id))}),Gs>1&&c.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[c.jsx("button",{onClick:()=>R(B=>Math.max(0,B-1)),disabled:y===0,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",y+1," of ",Gs]}),c.jsx("button",{onClick:()=>R(B=>Math.min(Gs-1,B+1)),disabled:y>=Gs-1,className:"px-3 py-1 text-sm bg-white border rounded hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})]})}),c.jsxs("div",{className:"w-80 border-l border-gray-200 bg-gray-900 flex flex-col",children:[c.jsx("div",{className:"px-4 py-2 border-b border-gray-700 text-gray-400 text-xs font-medium uppercase",children:"Processing Log"}),c.jsx("div",{className:"flex-1 overflow-auto p-3 font-mono text-xs text-gray-300 space-y-1",children:T.length===0?c.jsx("div",{className:"text-gray-500",children:"No activity yet..."}):T.map((B,oe)=>c.jsx("div",{className:"break-all",children:B},oe))})]})]}),X&&c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:()=>Q(null),children:c.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] flex flex-col items-center",children:[c.jsx("button",{onClick:()=>Q(null),className:"absolute -top-12 right-0 p-2 text-white/80 hover:text-white transition-colors",children:c.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),c.jsx("div",{className:"absolute -top-12 left-0 text-white font-medium",children:X.title}),c.jsx("div",{className:"rounded-lg overflow-hidden shadow-2xl",style:{backgroundImage:"linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 0 10px, 10px -10px, -10px 0px",backgroundColor:"#fff"},onClick:B=>B.stopPropagation(),children:c.jsx("img",{src:X.url,alt:X.title,className:"max-w-[85vw] max-h-[80vh] object-contain"})}),X.analysis&&c.jsxs("div",{className:"mt-4 bg-white/10 backdrop-blur-md rounded-lg px-4 py-3 text-white text-sm",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:["Background: ",X.analysis.hasWhiteBackground?"":""," White (",X.analysis.backgroundConfidence,"%)"]}),c.jsxs("span",{children:["Overlay: ",X.analysis.hasOverlay?" Yes":" None"]}),c.jsxs("span",{children:["Quality: ",X.analysis.qualityScore,"/100"]})]}),X.analysis.overlayTypes.length>0&&c.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Issues: ",X.analysis.overlayTypes.join(", ")]})]}),c.jsx("div",{className:"mt-4 text-white/60 text-sm",children:"Click outside or press ESC to close"})]})})]})},Fa="https://us-central1-nutrasafe-705c7.cloudfunctions.net",V3=({onBack:e})=>{var q,ve;const[t,s]=E.useState([]),[i,r]=E.useState(!0),[n,o]=E.useState("pending"),[a,l]=E.useState(null),[u,h]=E.useState(new Set),[p,g]=E.useState(null),[m,C]=E.useState(!1),[y,R]=E.useState(!1),[x,S]=E.useState(null),T=($,be)=>{S({message:$,type:be}),setTimeout(()=>S(null),3e3)},I=E.useCallback(async()=>{r(!0);try{const be=await(await fetch(`${Fa}/getUserReports`)).json();be.success?s(be.reports||[]):T("Error loading reports","error")}catch($){console.error("Error loading reports:",$),T("Error loading reports","error")}finally{r(!1)}},[]);E.useEffect(()=>{I()},[I]);const V=t.filter($=>n==="all"?!0:$.status===n),H={all:t.length,pending:t.filter($=>$.status==="pending").length,in_progress:t.filter($=>$.status==="in_progress").length,resolved:t.filter($=>$.status==="resolved").length,dismissed:t.filter($=>$.status==="dismissed").length},P=$=>{var se,Ge,Re,U,J,ce,Y,te,he;l($);const be=$.food||{};g({name:be.name||$.foodName||"",brandName:be.brand||$.brandName||"",barcode:be.barcode||$.barcode||"",servingDescription:be.servingDescription||"",servingSizeG:((se=be.servingSizeG)==null?void 0:se.toString())||"",servingUnit:be.servingUnit||"g",category:be.category||"",ingredients:Array.isArray(be.ingredients)?be.ingredients.join(", "):be.ingredients||"",calories:((Ge=be.calories)==null?void 0:Ge.toString())||"",protein:((Re=be.protein)==null?void 0:Re.toString())||"",carbs:((U=be.carbs)==null?void 0:U.toString())||"",fat:((J=be.fat)==null?void 0:J.toString())||"",fiber:((ce=be.fiber)==null?void 0:ce.toString())||"",sugar:((Y=be.sugar)==null?void 0:Y.toString())||"",salt:((te=be.salt)==null?void 0:te.toString())||"",saturatedFat:((he=be.saturatedFat)==null?void 0:he.toString())||""})},N=()=>{l(null),g(null)},_=async()=>{if(!(!a||!p)){R(!0);try{const $=p.name,be=p.brandName,Ge=await(await fetch(`${Fa}/aiAnalyzeFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:$,brand:be})})).json();if(Ge.success&&Ge.data){const{suggestions:Re,nutrition:U}=Ge.data;g(J=>J&&{...J,...(Re==null?void 0:Re.foodName)&&{name:Re.foodName},...(Re==null?void 0:Re.brandName)&&{brandName:Re.brandName},...(Re==null?void 0:Re.barcode)&&{barcode:Re.barcode},...(Re==null?void 0:Re.servingSize)&&{servingDescription:Re.servingSize},...(Re==null?void 0:Re.ingredients)&&{ingredients:Array.isArray(Re.ingredients)?Re.ingredients.join(", "):Re.ingredients},...(U==null?void 0:U.calories)!==void 0&&{calories:U.calories.toString()},...(U==null?void 0:U.protein)!==void 0&&{protein:U.protein.toString()},...(U==null?void 0:U.carbohydrates)!==void 0&&{carbs:U.carbohydrates.toString()},...(U==null?void 0:U.fat)!==void 0&&{fat:U.fat.toString()},...(U==null?void 0:U.fiber)!==void 0&&{fiber:U.fiber.toString()},...(U==null?void 0:U.sugar)!==void 0&&{sugar:U.sugar.toString()},...(U==null?void 0:U.salt)!==void 0&&{salt:U.salt.toString()},...(U==null?void 0:U.saturatedFat)!==void 0&&{saturatedFat:U.saturatedFat.toString()}}),T("AI suggestions applied","success")}else T("No AI suggestions available","info")}catch($){console.error("Error getting AI suggestions:",$),T("Error getting AI suggestions","error")}finally{R(!1)}}},L=async($=!1)=>{var be,se,Ge;if(!(!a||!p)){C(!0);try{const Re=((be=a.food)==null?void 0:be.id)||((se=a.food)==null?void 0:se.objectID)||a.foodId,U=((Ge=a.food)==null?void 0:Ge._sourceIndex)||a.sourceIndex||"uk_foods_cleaned",J={foodId:Re,indexName:U,updates:{foodName:p.name,brandName:p.brandName,barcode:p.barcode,servingSize:p.servingDescription,servingSizeG:parseFloat(p.servingSizeG)||null,servingUnit:p.servingUnit,category:p.category,ingredients:p.ingredients.split(",").map(te=>te.trim()).filter(te=>te),nutrition:{calories:parseFloat(p.calories)||null,protein:parseFloat(p.protein)||null,carbs:parseFloat(p.carbs)||null,fat:parseFloat(p.fat)||null,fiber:parseFloat(p.fiber)||null,sugar:parseFloat(p.sugar)||null,salt:parseFloat(p.salt)||null,sodium:Math.round((parseFloat(p.salt)||0)*1e3/2.5)||null,saturatedFat:parseFloat(p.saturatedFat)||null}}},Y=await(await fetch(`${Fa}/adminSaveFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)})).json();Y.success?(T("Food saved successfully","success"),$&&(await M(a.id,"resolved"),N())):T(Y.error||"Error saving food","error")}catch(Re){console.error("Error saving food:",Re),T("Error saving food","error")}finally{C(!1)}}},M=async($,be)=>{try{(await(await fetch(`${Fa}/updateUserReport`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportId:$,status:be})})).json()).success?(s(Re=>Re.map(U=>U.id===$?{...U,status:be}:U)),T("Report updated","success")):T("Error updating report","error")}catch(se){console.error("Error updating report:",se),T("Error updating report","error")}},b=async()=>{a&&(await M(a.id,"dismissed"),N())},F=async $=>{if(confirm("Delete this report? This cannot be undone."))try{(await(await fetch(`${Fa}/deleteUserReport`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportId:$})})).json()).success?(s(Ge=>Ge.filter(Re=>Re.id!==$)),(a==null?void 0:a.id)===$&&N(),T("Report deleted","success")):T("Error deleting report","error")}catch(be){console.error("Error deleting report:",be),T("Error deleting report","error")}},Z=async()=>{var $,be,se;if(a&&confirm("Delete this food from the database? This cannot be undone."))try{const Ge=(($=a.food)==null?void 0:$.id)||((be=a.food)==null?void 0:be.objectID)||a.foodId,Re=((se=a.food)==null?void 0:se._sourceIndex)||a.sourceIndex||"uk_foods_cleaned",J=await(await fetch(`${Fa}/deleteFood`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foodId:Ge,indexName:Re})})).json();J.success?(await M(a.id,"resolved"),N(),T("Food deleted and report resolved","success")):T(J.error||"Error deleting food","error")}catch(Ge){console.error("Error deleting food:",Ge),T("Error deleting food","error")}},K=$=>{h(be=>{const se=new Set(be);return se.has($)?se.delete($):se.add($),se})},ge=()=>{u.size===V.length?h(new Set):h(new Set(V.map($=>$.id)))},me=async()=>{if(u.size===0||!confirm(`Delete ${u.size} report(s)? This cannot be undone.`))return;let $=0;for(const be of u)try{(await(await fetch(`${Fa}/deleteUserReport`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportId:be})})).json()).success&&($++,s(Re=>Re.filter(U=>U.id!==be)))}catch(se){console.error("Error deleting report:",be,se)}h(new Set),T(`Deleted ${$} reports`,"success")},de=$=>new Date($).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),ye={pending:"bg-yellow-100 text-yellow-800",in_progress:"bg-blue-100 text-blue-800",resolved:"bg-green-100 text-green-800",dismissed:"bg-gray-100 text-gray-600"},pe={pending:"Pending",in_progress:"In Progress",resolved:"Resolved",dismissed:"Dismissed"};return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[x&&c.jsx("div",{className:`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg ${x.type==="success"?"bg-green-500 text-white":x.type==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,children:x.message}),c.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"User Reports"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Review and resolve user-submitted food corrections"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("button",{onClick:I,disabled:i,className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[c.jsx("svg",{className:`w-4 h-4 ${i?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),u.size>0&&c.jsxs("button",{onClick:me,className:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-red-600 hover:bg-red-700 rounded-lg",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete (",u.size,")"]})]})]})}),c.jsx("div",{className:"bg-white border-b border-gray-200 px-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex gap-1",children:["all","pending","in_progress","resolved","dismissed"].map($=>c.jsxs("button",{onClick:()=>o($),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${n===$?"border-primary-600 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[$==="all"?"All":$==="in_progress"?"In Progress":$.charAt(0).toUpperCase()+$.slice(1)," ",c.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs ${n===$?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"}`,children:H[$]})]},$))}),V.length>0&&c.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:u.size===V.length&&V.length>0,onChange:ge,className:"w-4 h-4 text-primary-600 rounded"}),"Select all"]})]})}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx("div",{className:`flex-1 overflow-auto p-6 transition-all ${a?"w-1/2":"w-full"}`,children:i?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("svg",{className:"w-8 h-8 animate-spin text-primary-600",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),c.jsx("span",{className:"text-gray-500",children:"Loading reports..."})]})}):V.length===0?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[c.jsx("svg",{className:"w-16 h-16 mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("p",{className:"text-lg font-medium",children:"No reports found"}),c.jsxs("p",{className:"text-sm",children:["No ",n==="all"?"":n," reports to display"]})]}):c.jsx("div",{className:"grid gap-3",children:V.map($=>{var be,se;return c.jsxs("div",{className:`bg-white rounded-xl border p-4 transition-all cursor-pointer hover:shadow-md ${(a==null?void 0:a.id)===$.id?"border-primary-500 ring-2 ring-primary-100":"border-gray-200"}`,onClick:()=>P($),children:[c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("input",{type:"checkbox",checked:u.has($.id),onChange:Ge=>{Ge.stopPropagation(),K($.id)},onClick:Ge=>Ge.stopPropagation(),className:"mt-1 w-4 h-4 text-primary-600 rounded"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:$.foodName||"Unknown Food"}),$.brandName&&c.jsx("p",{className:"text-sm text-gray-500",children:$.brandName})]}),c.jsx("span",{className:`flex-shrink-0 px-2.5 py-1 rounded-full text-xs font-medium ${ye[$.status]}`,children:pe[$.status]})]}),c.jsxs("div",{className:"mt-2 flex items-center gap-3 text-xs text-gray-500 flex-wrap",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),$.reportType||"General"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),de($.createdAt)]}),$.barcode&&c.jsx("span",{className:"font-mono",children:$.barcode}),(((be=$.food)==null?void 0:be._sourceIndex)||$.sourceIndex)&&c.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-50 text-blue-700 rounded font-medium",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),((se=$.food)==null?void 0:se._sourceIndex)||$.sourceIndex]})]}),c.jsx("p",{className:"mt-2 text-sm text-gray-600 line-clamp-2",children:$.description||"No description provided."})]})]}),c.jsxs("div",{className:"mt-3 flex items-center gap-2 pt-3 border-t border-gray-100",children:[c.jsx("button",{onClick:Ge=>{Ge.stopPropagation(),P($)},className:"flex-1 px-3 py-1.5 text-xs font-medium text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg transition-colors",children:"Review"}),$.status==="pending"&&c.jsx("button",{onClick:Ge=>{Ge.stopPropagation(),M($.id,"dismissed")},className:"px-3 py-1.5 text-xs font-medium text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Dismiss"}),c.jsx("button",{onClick:Ge=>{Ge.stopPropagation(),F($.id)},className:"px-3 py-1.5 text-xs font-medium text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"Delete"})]})]},$.id)})})}),a&&p&&c.jsx("div",{className:"w-1/2 border-l border-gray-200 bg-white overflow-auto",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Review Report"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Edit and verify food information"})]}),c.jsx("button",{onClick:N,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"mb-6 p-4 bg-yellow-50 rounded-xl border border-yellow-100",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("svg",{className:"w-5 h-5 text-yellow-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("p",{className:"font-medium text-yellow-800",children:a.reportType||"General Report"}),(((q=a.food)==null?void 0:q._sourceIndex)||a.sourceIndex)&&c.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})}),((ve=a.food)==null?void 0:ve._sourceIndex)||a.sourceIndex]})]}),c.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:a.description||"No description provided."}),c.jsxs("p",{className:"text-xs text-yellow-600 mt-2",children:["Reported ",de(a.createdAt)]})]})]})}),c.jsxs("button",{onClick:_,disabled:y,className:"w-full mb-6 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-xl transition-colors disabled:opacity-50",children:[y?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),y?"Analyzing...":"Apply AI Suggestions"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Food Name"}),c.jsx("input",{type:"text",value:p.name,onChange:$=>g({...p,name:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Brand Name"}),c.jsx("input",{type:"text",value:p.brandName,onChange:$=>g({...p,brandName:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Barcode"}),c.jsx("input",{type:"text",value:p.barcode,onChange:$=>g({...p,barcode:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm font-mono focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),c.jsx("input",{type:"text",value:p.category,onChange:$=>g({...p,category:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Serving Size"}),c.jsx("input",{type:"text",value:p.servingDescription,onChange:$=>g({...p,servingDescription:$.target.value}),placeholder:"e.g., 1 slice",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Size (g/ml)"}),c.jsx("input",{type:"number",value:p.servingSizeG,onChange:$=>g({...p,servingSizeG:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Unit"}),c.jsxs("select",{value:p.servingUnit,onChange:$=>g({...p,servingUnit:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[c.jsx("option",{value:"g",children:"g"}),c.jsx("option",{value:"ml",children:"ml"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Ingredients"}),c.jsx("textarea",{value:p.ingredients,onChange:$=>g({...p,ingredients:$.target.value}),rows:3,placeholder:"Enter ingredients separated by commas...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-2",children:"Nutrition (per 100g)"}),c.jsx("div",{className:"grid grid-cols-4 gap-3",children:[{key:"calories",label:"Calories",unit:"kcal"},{key:"protein",label:"Protein",unit:"g"},{key:"carbs",label:"Carbs",unit:"g"},{key:"fat",label:"Fat",unit:"g"},{key:"saturatedFat",label:"Sat Fat",unit:"g"},{key:"fiber",label:"Fibre",unit:"g"},{key:"sugar",label:"Sugar",unit:"g"},{key:"salt",label:"Salt",unit:"g"}].map(({key:$,label:be,unit:se})=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-[10px] text-gray-400 mb-1",children:be}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",step:"0.1",value:p[$],onChange:Ge=>g({...p,[$]:Ge.target.value}),className:"w-full px-2 py-1.5 pr-6 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),c.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-gray-400",children:se})]})]},$))})]})]}),c.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 space-y-3",children:[c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:()=>L(!0),disabled:m,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-xl transition-colors disabled:opacity-50",children:[m?c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save & Resolve"]}),c.jsx("button",{onClick:()=>L(!1),disabled:m,className:"px-4 py-3 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-xl transition-colors disabled:opacity-50",children:"Save Only"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:b,className:"flex-1 px-4 py-2.5 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-xl transition-colors",children:"Dismiss Report"}),c.jsx("button",{onClick:Z,className:"px-4 py-2.5 text-sm font-medium text-red-600 hover:bg-red-50 rounded-xl transition-colors",children:"Delete Food"})]})]})]})})]})]})},rd="https://us-central1-nutrasafe-705c7.cloudfunctions.net",B3=({onBack:e})=>{const[t,s]=E.useState(()=>new Set(Zt)),[i,r]=E.useState(!1),[n,o]=E.useState(!1),[a,l]=E.useState(!1),[u,h]=E.useState(!1),[p,g]=E.useState([]),[m,C]=E.useState({totalScanned:0,duplicateGroups:0,productsToMerge:0,filteredForeign:0,finalMasterCount:0,processing:!1}),[y,R]=E.useState([]),[x,S]=E.useState([]),[T,I]=E.useState(0),[V,H]=E.useState(!1),[P,N]=E.useState({}),[_,L]=E.useState(!1),[M,b]=E.useState(""),[F,Z]=E.useState(""),[K,ge]=E.useState("all"),[me,de]=E.useState(new Set),[ye,pe]=E.useState(!1),q=E.useCallback(k=>{const O=new Date().toLocaleTimeString();S(W=>[...W.slice(-100),`${O}: ${k}`]),console.log(k)},[]),ve=E.useCallback(()=>{const k=F?p.filter(W=>{const le=F.toLowerCase().trim(),ne=(W.name||W.foodName||"").toLowerCase(),X=(W.brand||W.brandName||"").toLowerCase(),Q=Array.isArray(W.barcode)?W.barcode.join(" ").toLowerCase():(W.barcode||"").toLowerCase();return K==="all"?ne.includes(le)||X.includes(le)||Q.includes(le):K==="brand"?X.includes(le):K==="name"?ne.includes(le):K==="barcode"?Q.includes(le):!1}):p,O=new Set(k.map(W=>W.objectID));de(O)},[F,K,p]),$=E.useCallback(()=>{de(new Set)},[]),be=E.useCallback(k=>{de(O=>{const W=new Set(O);return W.has(k)?W.delete(k):W.add(k),W})},[]),se=E.useCallback(async()=>{if(me.size===0){alert("No products selected");return}if(window.confirm(`Are you sure you want to DELETE ${me.size} product(s)? This action CANNOT be undone!`)){pe(!0),q(` Deleting ${me.size} selected products...`);try{const O=new Map;for(const ne of me){const X=p.find(Q=>Q.objectID===ne);if(X){const Q=X.sourceIndex;O.has(Q)||O.set(Q,[]),O.get(Q).push(ne)}}let W=0,le=0;for(const[ne,X]of O){q(`   Deleting ${X.length} products from ${ne}...`);const Q=await fetch(`${rd}/deleteFromIndex`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexName:ne,objectIDs:X})});if(Q.ok){const re=await Q.json();re.success?(W+=X.length,q(`   Deleted ${X.length} from ${ne}`)):(le+=X.length,q(`   Failed to delete from ${ne}: ${re.error}`))}else le+=X.length,q(`   Failed to delete from ${ne}: HTTP ${Q.status}`)}if(W>0){const ne=new Set(me),X=p.filter(Q=>!ne.has(Q.objectID));g(X),de(new Set),q(` Successfully deleted ${W} products`),le>0&&q(` Failed to delete ${le} products`)}else q(" No products were deleted")}catch(O){q(` Error deleting products: ${O}`),alert("Error deleting products. Check logs for details.")}finally{pe(!1)}}},[me,p,q]),Ge=(k,O)=>{try{if(!k||!O||typeof k!="string"||typeof O!="string")return Math.max((k==null?void 0:k.length)||0,(O==null?void 0:O.length)||0);const W=1e3,le=k.length>W?k.substring(0,W):k,ne=O.length>W?O.substring(0,W):O,X=[];for(let Q=0;Q<=ne.length;Q++)X[Q]=[Q];for(let Q=0;Q<=le.length;Q++)X[0][Q]=Q;for(let Q=1;Q<=ne.length;Q++)for(let re=1;re<=le.length;re++)ne.charAt(Q-1)===le.charAt(re-1)?X[Q][re]=X[Q-1][re-1]:X[Q][re]=Math.min(X[Q-1][re-1]+1,X[Q][re-1]+1,X[Q-1][re]+1);return X[ne.length][le.length]}catch{return Math.max((k==null?void 0:k.length)||0,(O==null?void 0:O.length)||0)}},Re=k=>{try{return!k||typeof k!="string"?"":k.toLowerCase().trim().replace(/[^\w\s]/g,"").replace(/\s+/g," ")}catch{return""}},U=(k,O)=>{if(!k||!O)return{score:0,reasons:["Invalid product(s)"]};let W=0;const le=[];try{const ne=typeof k.barcode=="string"?[k.barcode]:Array.isArray(k.barcode)?k.barcode.filter(re=>re&&typeof re=="string"):[],X=typeof O.barcode=="string"?[O.barcode]:Array.isArray(O.barcode)?O.barcode.filter(re=>re&&typeof re=="string"):[],Q=ne.find(re=>re&&X.includes(re));if(Q)return W=100,le.push(`Exact barcode match: ${Q}`),{score:W,reasons:le}}catch{}try{const ne=Re(k.brandName||k.brand||""),X=Re(O.brandName||O.brand||"");if(ne&&X)if(ne===X)W+=30,le.push("Exact brand match");else{const Q=Ge(ne,X),re=Math.max(ne.length,X.length);if(re>0){const Se=1-Q/re;if(Se>=.8){const Me=Math.round(Se*30);W+=Me,le.push(`Fuzzy brand match (${Math.round(Se*100)}% similar)`)}}}}catch{}try{const ne=Re(k.name||k.foodName||""),X=Re(O.name||O.foodName||"");if(ne&&X)if(ne===X)W+=40,le.push("Exact name match");else{const Q=Ge(ne,X),re=Math.max(ne.length,X.length);if(re>0){const Se=1-Q/re;if(Se>=.7){const Me=Math.round(Se*40);W+=Me,le.push(`Fuzzy name match (${Math.round(Se*100)}% similar)`)}}}}catch{}try{const ne=re=>{try{const Se=re.calories||0,Me=re.protein||0,Ne=re.carbs||0,Pe=re.fat||0;if(Se>900||Me>100||Ne>100||Pe>100)return!1;const We=Me*4+Ne*4+Pe*9,Ye=Math.abs(Se-We),Ke=Math.max(We*.2,1);return Ye<=Ke}catch{return!1}},Q=((re,Se)=>{try{const Me=[{key:"calories",tolerance:.1},{key:"protein",tolerance:.1},{key:"carbs",tolerance:.1},{key:"fat",tolerance:.1}];let Ne=0,Pe=0;for(const We of Me){const Ye=re[We.key]||0,Ke=Se[We.key]||0;if(Ye===0&&Ke===0)continue;Pe++;const ie=Math.abs(Ye-Ke),Dt=(Ye+Ke)/2;Dt>0&&ie<=Dt*We.tolerance&&Ne++}return Pe>0?Ne/Pe:0}catch{return 0}})(k,O);if(Q>=.75){const re=Math.round(Q*30);W+=re,le.push(`Macros match (${Math.round(Q*100)}% similar)`)}if(W>=50){const re=ne(k),Se=ne(O);re&&!Se?le.push("p1 has valid macros, p2 has invalid macros"):!re&&Se&&le.push("p2 has valid macros, p1 has invalid macros")}}catch{}return{score:W,reasons:le}},J=k=>{const O=k.calories||0,W=k.protein||0,le=k.carbs||0,ne=k.fat||0;if(O>900||W>100||le>100||ne>100)return!1;const X=W*4+le*4+ne*9,Q=Math.abs(O-X),re=X*.2;return Q<=re},ce=k=>{var O;try{if(!k)return 0;let W=0;try{const ne=Od([{id:k.objectID,objectID:k.objectID,name:k.name||k.foodName||"",brandName:k.brandName||k.brand||null,ingredients:k.ingredients||null,barcode:typeof k.barcode=="string"?k.barcode:((O=k.barcode)==null?void 0:O[0])||null,currentImageUrl:k.imageUrl||null,sourceIndex:k.sourceIndex,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,status:"pending",analysisProgress:0}],0).ukProducts.length>0?30:0;W+=ne}catch{}try{J(k)&&(W+=20)}catch{}try{const le=[k.ingredients,k.imageUrl,k.calories,k.protein,k.carbs,k.fat,k.fiber,k.sugar,k.sodium,k.servingSize],ne=le.filter(X=>X!=null&&X!=="").length;W+=ne/le.length*20}catch{}try{k.barcode&&(Array.isArray(k.barcode),k.barcode.length>0)&&(W+=10)}catch{}try{k.imageUrl&&typeof k.imageUrl=="string"&&k.imageUrl.trim().length>0&&(W+=10)}catch{}try{W+={verified_foods:10,uk_foods_cleaned:9,tesco_products:8,manual_foods:7,ai_enhanced:6,foods:5,user_added:4,ai_manually_added:3,fast_foods_database:2,generic_database:1}[k.sourceIndex]||0}catch{}return Math.round(W)}catch{return 0}},Y=E.useCallback(async()=>{if(_&&!M){q(" No index selected");return}if(!_&&t.size===0){q(" No indices selected");return}r(!0),I(0),g([]),R([]),q(" Starting data pull (one index at a time)..."),q(V?" TEST MODE ENABLED: Limited to 1000 products per index":" FULL SCAN MODE: Pulling ALL products from selected indices");const k=_?[M]:Array.from(t),O=[],W={};try{for(let ne=0;ne<k.length;ne++){const X=k[ne];q(` Pulling ${X}...`);let Q=0,re=!0,Se=[],Me=0;const Ne=2e3;let Pe=0;for(;re&&Pe<Ne;){Pe++,Pe>1&&Pe%5===0&&q(`   ${X}: ${Se.length.toLocaleString()} products pulled, fetching more...`);const We=await fetch(`${rd}/browseAllIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indices:[X],offset:Q,pageSize:5e3,limit:V?1e3:void 0})});if(!We.ok){q(` ${X}: HTTP ${We.status}`),W[X]={count:Me,error:`HTTP ${We.status}`};break}const Ye=await We.json();if(Ye.success&&Ye.products){const Ke=Ye.products||[],ie=Ye.pagination||{};if(console.log(`[${X}] Page ${Pe}: Got ${Ke.length} products, hasMore=${ie.hasMore}, total=${ie.total}`),Ke.length===0){q(`   ${X}: Reached end of index (0 products returned)`),re=!1;break}Ke.length<5e3&&(q(`   ${X}: Last page (${Ke.length} products)`),re=!1),Se.push(...Ke),Me=(ie==null?void 0:ie.total)||Se.length;const Dt=Math.floor((ne+Se.length/Math.max(Me,1))/k.length*100);I(Dt);const Fs=Me>0?Math.round(Se.length/Me*100):0;q(`   Page ${Pe}: ${Se.length.toLocaleString()} / ${Me.toLocaleString()} (${Fs}%) - hasMore=${ie.hasMore}`),ie.hasMore?(re=!0,Q+=5e3):(q(`   ${X}: Backend says no more data`),re=!1),Me>0&&Se.length>=Me&&(q(`   ${X}: Reached total count (${Se.length} >= ${Me})`),re=!1)}else{q(` ${X}: ${Ye.error||"Failed"}`),W[X]={count:Me,error:Ye.error||"Failed"};break}}Pe>=Ne&&q(` ${X}: Hit safety limit (${Ne} iterations), stopping pagination`),Se.length>0&&(O.push(...Se),W[X]={count:Se.length},q(` ${X}: ${Se.length.toLocaleString()} products`)),I(Math.floor((ne+1)/k.length*100))}q(` Total: ${O.length.toLocaleString()} products`),N(W),g(O),C(ne=>({...ne,totalScanned:O.length})),q(" Data pull complete! Ready to scan for duplicates.")}catch(le){const ne=le instanceof Error?le.message:String(le);q(` Error: ${ne}`)}finally{r(!1)}},[t,V,_,M,q]),te=E.useCallback(async()=>{if(p.length===0){q(" No data to scan. Pull data first.");return}o(!0),I(0),q(" Scanning for duplicates..."),q(` Analyzing ${p.length.toLocaleString()} products`);try{I(10);const k=_?p:(()=>{q(" Filtering out non-UK products (US spelling, foreign brands, foreign characters)...");const Pe=Od(p.map(Ye=>{var Ke;return{id:Ye.objectID,objectID:Ye.objectID,name:Ye.name||Ye.foodName||"",brandName:Ye.brandName||Ye.brand||null,ingredients:Ye.ingredients||null,barcode:typeof Ye.barcode=="string"?Ye.barcode:((Ke=Ye.barcode)==null?void 0:Ke[0])||null,currentImageUrl:Ye.imageUrl||null,sourceIndex:Ye.sourceIndex,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,status:"pending",analysisProgress:0}}),40),We=p.filter(Ye=>Pe.ukProducts.some(Ke=>Ke.objectID===Ye.objectID));return q(` Kept ${We.length} UK products, filtered ${p.length-We.length} foreign products`),We})();I(70),q(" OPTIMIZED duplicate detection (hash-based bucketing)..."),q("   Building barcode and name indices...");const O=new Set,W=[],le=Date.now(),ne=new Map,X=new Map;for(const Pe of k){const We=typeof Pe.barcode=="string"?[Pe.barcode]:Array.isArray(Pe.barcode)?Pe.barcode:[];for(const Ke of We)if(Ke&&typeof Ke=="string"){const ie=Ke.trim();ne.has(ie)||ne.set(ie,[]),ne.get(ie).push(Pe)}const Ye=Re(Pe.name||Pe.foodName||"");if(Ye){const Ke=Ye.substring(0,15);X.has(Ke)||X.set(Ke,[]),X.get(Ke).push(Pe)}}q(`   Barcode index: ${ne.size.toLocaleString()} unique codes`),q(`   Name index: ${X.size.toLocaleString()} buckets`),q("   Finding duplicates (compares only similar products)..."),I(75);const Q=new Set;let re=0;const Se=ne.size+X.size;for(const[Pe,We]of ne){if(We.length>1){const Ye=We.filter(Ke=>Ke&&Ke.objectID&&!O.has(Ke.objectID));if(Ye.length>1){for(const ie of Ye)O.add(ie.objectID);const Ke=Ye.map(ie=>({product:ie,score:ce(ie)}));Ke.sort((ie,Dt)=>Dt.score-ie.score),W.push({key:`barcode-${Pe}`,products:Ye,bestProduct:Ke[0].product,allBarcodes:[Pe],score:Ke[0].score})}}if(re++,re%500===0){const Ye=75+Math.round(re/Se*20);I(Ye);const Ke=(Date.now()-le)/1e3,ie=Math.round(re/Ke);q(`   ${re.toLocaleString()} / ${Se.toLocaleString()} buckets (${ie}/sec, ${W.length} groups)`),await new Promise(Dt=>setTimeout(Dt,0))}}for(const[Pe,We]of X){if(We.length>1)for(let Ye=0;Ye<We.length;Ye++){const Ke=We[Ye];if(!Ke||!Ke.objectID||O.has(Ke.objectID))continue;const ie=[Ke],Dt=[],Fs=typeof Ke.barcode=="string"?[Ke.barcode]:Array.isArray(Ke.barcode)?Ke.barcode:[];Dt.push(...Fs.filter($t=>$t&&typeof $t=="string").map($t=>$t.trim()));for(let $t=Ye+1;$t<We.length;$t++){const bt=We[$t];if(!bt||!bt.objectID||O.has(bt.objectID))continue;const dr=[Ke.objectID,bt.objectID].sort().join("|");if(Q.has(dr))continue;Q.add(dr),U(Ke,bt).score>=80&&(ie.push(bt),O.add(bt.objectID),(typeof bt.barcode=="string"?[bt.barcode]:Array.isArray(bt.barcode)?bt.barcode:[]).filter(Rs=>Rs&&typeof Rs=="string").map(Rs=>Rs.trim()).forEach(Rs=>{Dt.includes(Rs)||Dt.push(Rs)}))}if(ie.length>1){O.add(Ke.objectID);const $t=ie.map(bt=>({product:bt,score:ce(bt)}));$t.sort((bt,dr)=>dr.score-bt.score),W.push({key:`name-${Pe}-${Ye}`,products:ie,bestProduct:$t[0].product,allBarcodes:[...new Set(Dt)],score:$t[0].score})}}if(re++,re%500===0){const Ye=75+Math.round(re/Se*20);I(Ye);const Ke=(Date.now()-le)/1e3,ie=Math.round(re/Ke);q(`   ${re.toLocaleString()} / ${Se.toLocaleString()} buckets (${ie}/sec, ${W.length} groups)`),await new Promise(Dt=>setTimeout(Dt,0))}}const Me=((Date.now()-le)/1e3).toFixed(1);q(` OPTIMIZED scan: ${Me}s (vs. 16+ hours with old O(n) algorithm!)`),W.sort((Pe,We)=>We.products.length-Pe.products.length),q(` Found ${W.length} duplicate groups`);const Ne=W.reduce((Pe,We)=>Pe+We.products.length,0);q(` ${Ne} products will be merged into ${W.length} master products`),R(W),C({totalScanned:p.length,duplicateGroups:W.length,productsToMerge:Ne,filteredForeign:_?0:p.length-k.length,finalMasterCount:k.length-Ne+W.length,processing:!1}),I(100),q(" Scan complete!")}catch(k){q(` Error during scan: ${k}`)}finally{o(!1)}},[p,_,q]),he=E.useCallback(async()=>{if(!_||!M){q(" This function only works in single-index mode");return}if(y.length===0){q(" No duplicates to merge. Scan first.");return}h(!0),I(0),q(" Merging all duplicates and updating database...");try{const k=[],O=new Set,W=[];q(` Processing ${y.length} duplicate groups...`);for(let Q=0;Q<y.length;Q++){const re=y[Q],Se=re.bestProduct;re.products.forEach(Ne=>{O.add(Ne.objectID),Ne.objectID!==Se.objectID&&W.push(Ne.objectID)});const Me={...Se,objectID:Se.objectID,barcodes:re.allBarcodes,barcode:re.allBarcodes[0],mergedFrom:re.products.filter(Ne=>Ne.objectID!==Se.objectID).map(Ne=>({objectID:Ne.objectID,sourceIndex:Ne.sourceIndex})),isMerged:!0,mergedAt:new Date().toISOString(),qualityScore:re.score};k.push(Me),I(Math.round(Q/y.length*30))}q(` Created ${k.length} merged products`),q(` Marking ${W.length} duplicates for deletion`),q(" Adding non-duplicate products...");let le=0;for(const Q of p)O.has(Q.objectID)||(k.push({...Q,objectID:Q.objectID,barcodes:Q.barcode?Array.isArray(Q.barcode)?Q.barcode:[Q.barcode]:[],barcode:Array.isArray(Q.barcode)?Q.barcode[0]:Q.barcode,isMerged:!1}),le++);if(q(` Added ${le} non-duplicate products`),I(50),q(` Updating ${M} index...`),W.length>0){const re=Math.ceil(W.length/100);for(let Se=0;Se<re;Se++){const Me=Se*100,Ne=Math.min((Se+1)*100,W.length),Pe=W.slice(Me,Ne);(await fetch(`${rd}/deleteFromIndex`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexName:M,objectIDs:Pe})})).ok?q(`   Deleted batch ${Se+1}/${re}`):q(` Failed to delete batch ${Se+1}/${re}`),I(50+Math.round(Se/re*20))}}const ne=100,X=Math.ceil(k.length/ne);for(let Q=0;Q<X;Q++){const re=Q*ne,Se=Math.min((Q+1)*ne,k.length),Me=k.slice(re,Se);(await fetch(`${rd}/updateAlgoliaIndex`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indexName:M,products:Me})})).ok?q(`   Uploaded batch ${Q+1}/${X}`):q(` Failed to upload batch ${Q+1}/${X}`),I(70+Math.round(Q/X*30))}I(100),q(` Successfully merged duplicates and updated ${M}!`),q(` Final count: ${k.length.toLocaleString()} products (removed ${W.length} duplicates)`),R([])}catch(k){q(` Error merging duplicates: ${k}`)}finally{h(!1)}},[y,p,_,M,q]),Ae=E.useCallback(async()=>{if(p.length===0){q(" No products to build from. Pull data first.");return}l(!0),I(0),q(" Building master database...");try{const k=[],O=new Set;q(` Merging ${y.length} duplicate groups...`);for(let Q=0;Q<y.length;Q++){const re=y[Q],Se=re.bestProduct;re.products.forEach(Ne=>O.add(Ne.objectID));const Me={...Se,objectID:Se.objectID,barcodes:re.allBarcodes,barcode:re.allBarcodes[0],mergedFrom:re.products.map(Ne=>({objectID:Ne.objectID,sourceIndex:Ne.sourceIndex})),isMerged:!0,mergedAt:new Date().toISOString(),qualityScore:re.score};k.push(Me),I(Math.round(Q/y.length*50))}q(` Created ${k.length} merged products from duplicate groups`),q(" Adding non-duplicate products...");const W=p.filter(Q=>{var Se;return Od([{id:Q.objectID,objectID:Q.objectID,name:Q.name||Q.foodName||"",brandName:Q.brandName||Q.brand||null,ingredients:Q.ingredients||null,barcode:typeof Q.barcode=="string"?Q.barcode:((Se=Q.barcode)==null?void 0:Se[0])||null,currentImageUrl:Q.imageUrl||null,sourceIndex:Q.sourceIndex,selected:!1,searchResults:[],selectedImageUrl:null,analysis:null,status:"pending",analysisProgress:0}],40).ukProducts.length>0});let le=0;for(let Q=0;Q<W.length;Q++){const re=W[Q];O.has(re.objectID)||(k.push({...re,objectID:re.objectID,barcodes:re.barcode?Array.isArray(re.barcode)?re.barcode:[re.barcode]:[],barcode:Array.isArray(re.barcode)?re.barcode[0]:re.barcode,isMerged:!1}),le++,le%5e3===0&&I(50+Math.round(Q/W.length*30)))}q(` Added ${le} non-duplicate products`),q(" Uploading to Firestore...");const ne=100,X=Math.ceil(k.length/ne);for(let Q=0;Q<X;Q++){const re=Q*ne,Se=Math.min((Q+1)*ne,k.length),Me=k.slice(re,Se);(await fetch(`${rd}/uploadMasterDatabase`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({products:Me})})).ok?q(`   Uploaded batch ${Q+1}/${X}`):q(` Failed to upload batch ${Q+1}/${X}`),I(Math.round((Q+1)/X*100))}I(100),q(" Master database built and uploaded to Firestore!"),q(` Total products in master database: ${k.length.toLocaleString()}`)}catch(k){q(` Error building master database: ${k}`)}finally{l(!1)}},[y,p,q]),fe=Fe.useMemo(()=>{if(!F.trim())return p;const k=F.toLowerCase().trim();return p.filter(O=>{const W=(O.name||O.foodName||"").toLowerCase(),le=(O.brand||O.brandName||"").toLowerCase(),ne=Array.isArray(O.barcode)?O.barcode.join(" ").toLowerCase():(O.barcode||"").toLowerCase();switch(K){case"brand":return le.includes(k);case"name":return W.includes(k);case"barcode":return ne.includes(k);case"all":default:return W.includes(k)||le.includes(k)||ne.includes(k)}})},[p,F,K]);return c.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[c.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Master Database Builder"}),c.jsx("p",{className:"text-sm text-gray-500",children:_?"Single-Index Mode: Pull  Scan  Merge duplicates within one index":"Multi-Index Mode: Pull  Scan  Build master database from multiple indices"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-purple-50 text-purple-700 rounded-lg text-sm cursor-pointer hover:bg-purple-100 border border-purple-200",children:[c.jsx("input",{type:"checkbox",checked:_,onChange:()=>{L(!_),g([]),R([]),S([])},className:"w-4 h-4 text-purple-600 rounded"}),c.jsx("span",{className:"font-medium",children:"Single-Index Mode"})]}),c.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm cursor-pointer border-2 transition-all ${V?"bg-yellow-50 text-yellow-800 border-yellow-300 hover:bg-yellow-100":"bg-green-50 text-green-800 border-green-300 hover:bg-green-100"}`,children:[c.jsx("input",{type:"checkbox",checked:V,onChange:()=>H(!V),className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"font-medium",children:V?" Test Mode (1k/index)":" Full Scan (ALL products)"})]}),p.length>0&&!i&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsxs("select",{value:K,onChange:k=>ge(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white",children:[c.jsx("option",{value:"all",children:"All Fields"}),c.jsx("option",{value:"brand",children:"Brand"}),c.jsx("option",{value:"name",children:"Name"}),c.jsx("option",{value:"barcode",children:"Barcode"})]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",value:F,onChange:k=>Z(k.target.value),placeholder:`Search by ${K==="all"?"any field":K}...`,className:"px-3 py-2 pr-10 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-80"}),F&&c.jsx("button",{onClick:()=>Z(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsx("div",{className:"px-3 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:F?c.jsxs(c.Fragment,{children:[fe.length.toLocaleString()," / ",p.length.toLocaleString()," products"]}):c.jsxs(c.Fragment,{children:[p.length.toLocaleString()," products loaded"]})}),F&&fe.length>0&&c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:me.size===fe.length?$:ve,className:"px-3 py-2 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 rounded-lg text-sm font-medium border border-indigo-200",children:me.size===fe.length?"Deselect All":`Select All (${fe.length})`}),me.size>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"px-3 py-2 bg-purple-50 text-purple-700 rounded-lg text-sm font-medium border border-purple-200",children:[me.size," selected"]}),c.jsx("button",{onClick:se,disabled:ye,className:"px-3 py-2 bg-red-600 text-white hover:bg-red-700 disabled:opacity-50 rounded-lg text-sm font-medium flex items-center gap-2",children:ye?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Deleting..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Selected"]})})]})]})]}),c.jsxs("button",{onClick:Y,disabled:i||n||a||u||(_?!M:t.size===0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium",children:[i?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),_?"Pull Index":"Pull All Data"]}),c.jsxs("button",{onClick:te,disabled:i||n||a||u||p.length===0,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 font-medium",children:[n?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Scan for Duplicates"]}),_?c.jsxs("button",{onClick:he,disabled:i||n||a||u||y.length===0,className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 font-medium",children:[u?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Merge All Duplicates"]}):c.jsxs("button",{onClick:Ae,disabled:i||n||a||u||y.length===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:[a?c.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),"Build Master Database"]})]})]}),(i||n||a||u)&&c.jsx("div",{className:"mt-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${T}%`}})}),c.jsxs("span",{className:"text-sm text-gray-500",children:[T,"%"]})]})})]}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:_?"Select Index to Clean":"Select Indices to Scan"}),_?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("select",{value:M,onChange:k=>b(k.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none font-medium",children:[c.jsx("option",{value:"",children:"-- Select an index --"}),Zt.map(k=>c.jsx("option",{value:k,children:k.replace(/_/g," ")},k))]}),M&&c.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg text-sm text-purple-700",children:[c.jsx("strong",{children:"Selected:"})," ",M.replace(/_/g," ")]})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:Zt.map(k=>c.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${t.has(k)?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsx("input",{type:"checkbox",checked:t.has(k),onChange:()=>{s(O=>{const W=new Set(O);return W.has(k)?W.delete(k):W.add(k),W})},className:"w-4 h-4 text-primary-600 rounded"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:k.replace(/_/g," ")})]},k))}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>s(new Set(Zt)),className:"px-3 py-1.5 text-sm text-primary-700 bg-primary-50 hover:bg-primary-100 rounded-lg",children:"Select All"}),c.jsx("button",{onClick:()=>s(new Set),className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"Clear All"}),c.jsxs("span",{className:"px-3 py-1.5 text-sm text-gray-500",children:[t.size," of ",Zt.length," selected"]})]})]})]}),Object.keys(P).length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Index Pull Results"}),c.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(P).map(([k,O])=>c.jsxs("div",{className:`rounded-lg p-3 ${O.error?"bg-red-50":"bg-green-50"}`,children:[c.jsx("div",{className:`text-xl font-bold ${O.error?"text-red-900":"text-green-900"}`,children:O.error?"":O.count.toLocaleString()}),c.jsx("div",{className:`text-xs ${O.error?"text-red-700":"text-green-700"}`,children:k.replace(/_/g," ")}),O.error&&c.jsx("div",{className:"text-xs text-red-600 mt-1 truncate",title:O.error,children:O.error})]},k))})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistics"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-blue-900",children:m.totalScanned.toLocaleString()}),c.jsx("div",{className:"text-sm text-blue-700",children:"Total Scanned"})]}),c.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-red-900",children:m.filteredForeign.toLocaleString()}),c.jsx("div",{className:"text-sm text-red-700",children:"Filtered (Foreign)"})]}),c.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-yellow-900",children:m.duplicateGroups.toLocaleString()}),c.jsx("div",{className:"text-sm text-yellow-700",children:"Duplicate Groups"})]}),c.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-purple-900",children:m.productsToMerge.toLocaleString()}),c.jsx("div",{className:"text-sm text-purple-700",children:"Products to Merge"})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-4 col-span-2",children:[c.jsx("div",{className:"text-4xl font-bold text-green-900",children:m.finalMasterCount.toLocaleString()}),c.jsx("div",{className:"text-sm text-green-700",children:"Final Master Database Count"})]})]})]}),F&&fe.length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Search Results (",fe.length.toLocaleString()," products)",c.jsxs("span",{className:"ml-2 text-sm font-normal text-blue-600",children:[K==="all"?"All Fields":K.charAt(0).toUpperCase()+K.slice(1),': "',F,'"']})]}),c.jsxs("div",{className:"space-y-3 max-h-96 overflow-auto",children:[fe.slice(0,100).map((k,O)=>c.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50",children:c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900 truncate",children:k.name||k.foodName}),c.jsx("div",{className:"text-sm text-gray-600 truncate",children:k.brand||k.brandName||"No brand"}),c.jsxs("div",{className:"flex gap-3 mt-1",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Index: ",k.sourceIndex]}),k.calories&&c.jsxs("span",{className:"text-xs text-gray-500",children:[k.calories," kcal"]})]}),k.barcode&&c.jsx("div",{className:"text-xs text-gray-400 mt-1 font-mono",children:Array.isArray(k.barcode)?k.barcode.join(", "):k.barcode})]}),c.jsx("div",{className:"flex-shrink-0",children:k.imageUrl&&c.jsx("img",{src:k.imageUrl,alt:k.name||k.foodName,className:"w-16 h-16 object-cover rounded",onError:W=>{W.target.style.display="none"}})})]})},O)),fe.length>100&&c.jsxs("div",{className:"text-center text-sm text-gray-500 py-3",children:["Showing first 100 of ",fe.length.toLocaleString()," results"]})]})]}),F&&fe.length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Search Results (",fe.length," products)"]}),c.jsx("div",{className:"space-y-2 max-h-96 overflow-auto",children:fe.map(k=>c.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${me.has(k.objectID)?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[c.jsx("input",{type:"checkbox",checked:me.has(k.objectID),onChange:()=>be(k.objectID),className:"w-5 h-5 text-indigo-600 rounded mt-0.5 flex-shrink-0"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900 truncate",children:k.name||k.foodName||"Unnamed Product"}),c.jsx("div",{className:"text-sm text-gray-500 truncate",children:k.brandName||k.brand||"No brand"}),c.jsxs("div",{className:"flex gap-2 mt-1 flex-wrap",children:[c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs",children:k.sourceIndex}),(typeof k.barcode=="string"?[k.barcode]:k.barcode||[]).filter(O=>O).map((O,W)=>c.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs font-mono",children:O},W))]})]})]},k.objectID))})]}),y.length>0&&c.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Top Duplicate Groups (",y.length," total)"]}),c.jsx("div",{className:"space-y-4 max-h-96 overflow-auto",children:y.slice(0,20).map((k,O)=>{var W,le,ne,X,Q;return c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-gray-900",children:((W=k.bestProduct)==null?void 0:W.name)||((le=k.bestProduct)==null?void 0:le.foodName)}),c.jsx("div",{className:"text-sm text-gray-500",children:((ne=k.bestProduct)==null?void 0:ne.brandName)||((X=k.bestProduct)==null?void 0:X.brand)})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded",children:[k.products.length," duplicates"]}),c.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded",children:["Score: ",k.score]})]})]}),c.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[c.jsxs("div",{children:["Best from: ",(Q=k.bestProduct)==null?void 0:Q.sourceIndex]}),c.jsxs("div",{children:["All barcodes: ",k.allBarcodes.join(", ")||"None"]}),c.jsx("div",{className:"flex gap-2 flex-wrap mt-2",children:k.products.map((re,Se)=>c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs",children:re.sourceIndex},Se))})]})]},O)})})]})]}),c.jsxs("div",{className:"w-96 border-l border-gray-200 bg-gray-900 flex flex-col",children:[c.jsx("div",{className:"px-4 py-2 border-b border-gray-700 text-gray-400 text-xs font-medium uppercase",children:"Processing Log"}),c.jsx("div",{className:"flex-1 overflow-auto p-3 font-mono text-xs text-gray-300 space-y-1",children:x.length===0?c.jsx("div",{className:"text-gray-500",children:'No activity yet. Click "Scan & Detect Duplicates" to start.'}):x.map((k,O)=>c.jsx("div",{className:"break-all",children:k},O))})]})]})]})},Zo=[{id:"milk",name:"Milk & Milk Alternatives",description:"Liquid milk products and plant-based alternatives for drinking",keywords:["milk","semi-skimmed","skimmed","whole milk","oat milk","almond milk","soy milk","soya milk","lactofree"],excludeKeywords:["chocolate","milkshake","milk chocolate","milky bar","milky way","condensed","evaporated","powder","dried"],defaultServingG:200,servingSizes:[{name:"Small glass",grams:150},{name:"Medium glass",grams:200},{name:"Large glass",grams:300}],toleranceMin:100,toleranceMax:500,examples:["Whole Milk","Semi-Skimmed Milk","Oatly Oat Milk","Alpro Soya Milk","Lactofree Semi-Skimmed"],notExamples:["Cadbury Dairy Milk","Milk Chocolate Digestives","Chocolate Milkshake","Milky Bar","Milky Way"]},{id:"cheese",name:"Cheese",description:"Hard and soft cheeses",keywords:["cheese","cheddar","mozzarella","brie","camembert","stilton","parmesan","feta","halloumi","gouda","edam","red leicester","wensleydale"],excludeKeywords:["cheesecake","cheese and onion","cheese sandwich","macaroni cheese","cheese string"],defaultServingG:30,toleranceMin:15,toleranceMax:100,examples:["Cathedral City Mature Cheddar","Philadelphia Cream Cheese","Babybel","Boursin","Grated Mozzarella"],notExamples:["New York Cheesecake","Cheese and Onion Crisps","Cheese Sandwich","Mac and Cheese"]},{id:"yoghurt",name:"Yoghurt & Fromage Frais",description:"Yoghurts, fromage frais, and cultured dairy desserts",keywords:["yoghurt","yogurt","fromage frais","skyr","kefir","activia","muller","yeo valley","fage"],excludeKeywords:["yoghurt coated","yogurt raisins"],defaultServingG:125,servingSizes:[{name:"Small pot",grams:100},{name:"Standard pot",grams:125},{name:"Large pot",grams:150}],toleranceMin:50,toleranceMax:500,examples:["Muller Corner","Activia Strawberry","Fage Total 0%","Yeo Valley Organic","Petits Filous"],notExamples:["Yoghurt Coated Raisins","Yoghurt Covered Nuts"]},{id:"butter_spread",name:"Butter & Spreads",description:'Butter, margarine, spreadable fats, and butter alternatives. Includes "Creamy and Buttery" products like Elmlea which are plant-based butter substitutes.',keywords:["butter","margarine","spread","flora","lurpak","anchor","bertolli","clover","utterly butterly","elmlea","creamy and buttery","buttery salted","buttery unsalted"],excludeKeywords:["peanut butter","almond butter","chocolate spread","jam","marmalade","marmite"],defaultServingG:10,toleranceMin:5,toleranceMax:30,examples:["Lurpak Spreadable","Flora Original","Anchor Butter","Clover","Bertolli","Elmlea Creamy and Buttery Salted","Elmlea Creamy and Buttery Unsalted"],notExamples:["Peanut Butter","Nutella","Biscoff Spread","Marmite","Elmlea Double (cream alternative)","Elmlea Single (cream alternative)"]},{id:"cream",name:"Cream",description:"Single, double, whipping, and clotted cream (REAL dairy cream only)",keywords:["cream","single cream","double cream","whipping cream","clotted cream","soured cream","creme fraiche"],excludeKeywords:["ice cream","cream cheese","cream cracker","cream of","cream liqueur","cream egg","elmlea","cream alternative","plant cream","creamy"],defaultServingG:30,toleranceMin:15,toleranceMax:100,examples:["Rodda's Clotted Cream","Creme Fraiche","Soured Cream","Tesco Double Cream","Sainsbury's Single Cream"],notExamples:["Ice Cream","Cream Crackers","Cream of Tomato Soup","Cream Egg","Irish Cream Liqueur","Elmlea (cream alternative)"]},{id:"cream_alternatives",name:"Cream Alternatives",description:'Plant-based and non-dairy cream for pouring/cooking/whipping (NOT butter substitutes). Elmlea Single/Double are cream alternatives. But "Creamy and Buttery" Elmlea = butter substitute  goes in butter_spreads.',keywords:["cream alternative","plant cream","vegan cream","oat cream","soy cream","elmlea single","elmlea double","elmlea plant"],excludeKeywords:["ice cream","cream cheese","creamy and buttery","buttery salted","buttery unsalted"],defaultServingG:30,toleranceMin:15,toleranceMax:100,examples:["Elmlea Double","Elmlea Single","Elmlea Plant Double","Oatly Oat Cream","Alpro Soya Cream"],notExamples:["Tesco Double Cream","Rodda's Clotted Cream","Real dairy cream","Elmlea Creamy and Buttery (butter substitute)"]},{id:"eggs",name:"Eggs",description:"Whole eggs - chicken, duck, quail",keywords:["egg","eggs","free range","barn eggs","organic eggs"],excludeKeywords:["egg fried rice","egg sandwich","egg mayo","scotch egg","easter egg","cream egg","creme egg"],defaultServingG:60,servingSizes:[{name:"Medium egg",grams:50},{name:"Large egg",grams:60},{name:"Very large egg",grams:70}],toleranceMin:35,toleranceMax:100,examples:["Large Free Range Eggs","Organic Eggs","Clarence Court Eggs","Quail Eggs"],notExamples:["Scotch Egg","Cadbury Creme Egg","Easter Egg","Egg Fried Rice","Egg Mayo Sandwich"]},{id:"bread_sliced",name:"Sliced Bread",description:"Pre-sliced bread loaves - white, wholemeal, seeded",keywords:["bread","loaf","sliced","white bread","wholemeal bread","brown bread","warburtons","hovis","kingsmill"],excludeKeywords:["garlic bread","bread roll","bread stick","naan bread","pitta","flatbread","breadcrumbs","bread sauce"],defaultServingG:38,servingSizes:[{name:"Thin slice",grams:25},{name:"Medium slice",grams:38},{name:"Thick slice",grams:50}],toleranceMin:20,toleranceMax:80,examples:["Warburtons Toastie White","Hovis Best of Both","Kingsmill 50/50","Roberts Bakery Wholemeal"],notExamples:["Garlic Bread","Ciabatta Roll","Breadsticks","Stuffing"]},{id:"bread_rolls",name:"Bread Rolls & Buns",description:"Individual bread rolls, baps, buns, bagels",keywords:["roll","bun","bap","bagel","brioche bun","ciabatta roll","sub roll","hot dog bun","burger bun"],excludeKeywords:["sausage roll","spring roll","swiss roll","cinnamon roll","iced bun"],defaultServingG:60,servingSizes:[{name:"Small roll",grams:45},{name:"Medium roll",grams:60},{name:"Large roll/bagel",grams:85}],toleranceMin:30,toleranceMax:120,examples:["White Bread Rolls","Warburtons Sandwich Thins","New York Bagels","Brioche Burger Buns"],notExamples:["Sausage Roll","Spring Roll","Cinnamon Roll","Chelsea Bun"]},{id:"crumpets",name:"Crumpets & English Muffins",description:"Crumpets, English muffins, pikelet",keywords:["crumpet","english muffin","muffin","pikelet"],excludeKeywords:["muffin chocolate","blueberry muffin","chocolate chip muffin","breakfast muffin"],defaultServingG:55,toleranceMin:40,toleranceMax:80,examples:["Warburtons Crumpets","Kingsmill Crumpets","Warburtons English Muffins"],notExamples:["Chocolate Muffin","Blueberry Muffin","McDonalds McMuffin"]},{id:"wraps_tortillas",name:"Wraps & Tortillas",description:"Flour tortillas, wraps, flatbreads for filling",keywords:["wrap","tortilla","flatbread","naan","pitta","pita","chapati","roti"],excludeKeywords:["tortilla chips","wrap meal","chicken wrap"],defaultServingG:60,servingSizes:[{name:"Small wrap",grams:40},{name:"Medium wrap",grams:60},{name:"Large wrap",grams:80}],toleranceMin:30,toleranceMax:120,examples:["Old El Paso Flour Tortillas","Mission Deli Wraps","Warburtons Wraps","Mini Naans"],notExamples:["Doritos","Tortilla Chips","Chicken Fajita Wrap Meal"]},{id:"croissants_pastries",name:"Croissants & Pastries",description:"Croissants, pain au chocolat, danish pastries",keywords:["croissant","pain au chocolat","danish","pastry","almond croissant"],excludeKeywords:["pastry case","puff pastry","filo pastry","shortcrust"],defaultServingG:60,toleranceMin:40,toleranceMax:120,examples:["All Butter Croissant","Pain au Chocolat","Almond Croissant","Cinnamon Swirl"],notExamples:["Jus-Rol Puff Pastry","Filo Pastry Sheets","Cornish Pasty"]},{id:"cereal_cold",name:"Breakfast Cereals (Cold)",description:"Cold cereals - flakes, puffs, clusters, granola",keywords:["cereal","cornflakes","weetabix","shreddies","cheerios","special k","bran flakes","granola","muesli","crunchy nut","coco pops","frosties","rice krispies","shredded wheat"],excludeKeywords:["cereal bar"],defaultServingG:40,servingSizes:[{name:"Small bowl",grams:30},{name:"Medium bowl",grams:40},{name:"Large bowl",grams:60}],toleranceMin:20,toleranceMax:100,examples:["Kelloggs Corn Flakes","Weetabix","Nestle Shreddies","Jordans Granola","Alpen Muesli"],notExamples:["Nutri-Grain Cereal Bar","Kelloggs Crunchy Nut Bar"]},{id:"porridge_oats",name:"Porridge & Oats",description:"Oats, porridge, overnight oats, instant oats",keywords:["oats","porridge","oatmeal","oat so simple","ready brek","overnight oats","rolled oats","steel cut oats"],excludeKeywords:["oat milk","oat cake","flapjack"],defaultServingG:40,toleranceMin:25,toleranceMax:80,examples:["Quaker Oats","Oat So Simple","Ready Brek","Flahavans Porridge Oats"],notExamples:["Oatly Oat Milk","Nairns Oatcakes","Oat Flapjack"]},{id:"chicken_breast",name:"Chicken Breast",description:"Raw and cooked chicken breast fillets",keywords:["chicken breast","chicken fillet","mini fillets","chicken escalope"],excludeKeywords:["chicken kiev","chicken nugget","chicken burger","chicken pie","stuffed chicken"],defaultServingG:150,servingSizes:[{name:"Small breast",grams:120},{name:"Medium breast",grams:150},{name:"Large breast",grams:200}],toleranceMin:80,toleranceMax:300,examples:["Chicken Breast Fillets","Chargrilled Chicken Breast","Chicken Mini Fillets"],notExamples:["Chicken Kiev","Chicken Nuggets","KFC Chicken","Nandos Chicken"]},{id:"chicken_thigh_drumstick",name:"Chicken Thighs & Drumsticks",description:"Chicken thighs and drumsticks, bone-in or boneless",keywords:["chicken thigh","chicken drumstick","chicken leg","thigh fillet"],excludeKeywords:[],defaultServingG:120,toleranceMin:60,toleranceMax:200,examples:["Chicken Thigh Fillets","Chicken Drumsticks","Skin-On Chicken Thighs"],notExamples:["Chicken Breast","Whole Chicken"]},{id:"beef_mince",name:"Beef Mince",description:"Minced beef of various fat percentages",keywords:["beef mince","minced beef","ground beef","lean mince","extra lean mince","steak mince"],excludeKeywords:["bolognese","lasagne","chilli con carne","burger"],defaultServingG:125,toleranceMin:80,toleranceMax:250,examples:["Lean Beef Mince 5% Fat","Beef Steak Mince","Extra Lean Minced Beef"],notExamples:["Spaghetti Bolognese","Beef Burgers","Beef Lasagne"]},{id:"beef_steak",name:"Beef Steak",description:"Steak cuts - sirloin, ribeye, fillet, rump",keywords:["steak","sirloin","ribeye","fillet steak","rump steak","bavette","onglet"],excludeKeywords:["steak pie","steak slice","steak bake","steak mince"],defaultServingG:225,servingSizes:[{name:"Small steak",grams:170},{name:"Medium steak",grams:225},{name:"Large steak",grams:300}],toleranceMin:120,toleranceMax:450,examples:["Ribeye Steak","Sirloin Steak","Rump Steak","Fillet Steak"],notExamples:["Steak and Kidney Pie","Greggs Steak Bake","Pukka Steak Pie"]},{id:"bacon",name:"Bacon",description:"Streaky and back bacon, smoked and unsmoked",keywords:["bacon","streaky bacon","back bacon","smoked bacon","unsmoked bacon","bacon rashers","pancetta"],excludeKeywords:["bacon sandwich","bacon roll","bacon bits","bacon flavour"],defaultServingG:60,toleranceMin:25,toleranceMax:150,examples:["Smoked Back Bacon","Unsmoked Streaky Bacon","Thick Cut Bacon","Pancetta Cubes"],notExamples:["Bacon Sandwich","Bacon Flavour Crisps","Turkey Bacon"]},{id:"sausages",name:"Sausages",description:"Pork, beef, chicken, and vegetarian sausages",keywords:["sausage","sausages","cumberland","lincolnshire","chipolata","banger"],excludeKeywords:["sausage roll","sausage meat","sausage casserole","hot dog"],defaultServingG:67,servingSizes:[{name:"1 sausage",grams:67},{name:"2 sausages",grams:134},{name:"3 sausages",grams:200}],toleranceMin:40,toleranceMax:250,examples:["Cumberland Sausages","Pork Chipolatas","Richmond Thick Sausages","Linda McCartney Sausages"],notExamples:["Greggs Sausage Roll","Sausage Casserole","Toad in the Hole"]},{id:"ham_sliced",name:"Sliced Ham & Cooked Meats",description:"Sliced ham, turkey, chicken, and deli meats",keywords:["ham","sliced ham","cooked ham","turkey slices","chicken slices","pastrami","salami","chorizo slices","prosciutto"],excludeKeywords:["ham sandwich","ham and cheese","gammon"],defaultServingG:35,toleranceMin:15,toleranceMax:100,examples:["Tesco Honey Roast Ham","Wafer Thin Turkey","Sliced Chicken Breast","Parma Ham"],notExamples:["Ham and Cheese Toastie","Gammon Steak","Christmas Ham"]},{id:"fish_fillets",name:"Fish Fillets (Fresh)",description:"Fresh fish fillets - salmon, cod, haddock, sea bass",keywords:["salmon fillet","cod fillet","haddock fillet","sea bass","trout fillet","mackerel fillet","tuna steak"],excludeKeywords:["fish fingers","fish cake","fish pie","battered fish"],defaultServingG:130,toleranceMin:80,toleranceMax:250,examples:["Salmon Fillet","Cod Loin","Sea Bass Fillets","Smoked Haddock"],notExamples:["Birds Eye Fish Fingers","Fish Cakes","Chip Shop Fish"]},{id:"tinned_fish",name:"Tinned Fish",description:"Canned tuna, salmon, sardines, mackerel",keywords:["tinned","canned","tuna chunks","tuna flakes","sardines","mackerel fillets","salmon pink","salmon red"],excludeKeywords:[],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["John West Tuna Chunks","Princes Salmon","Sardines in Tomato Sauce","Mackerel in Sunflower Oil"],notExamples:["Fresh Tuna Steak","Salmon Fillet"]},{id:"prawns_seafood",name:"Prawns & Seafood",description:"Prawns, shrimp, mussels, squid",keywords:["prawn","shrimp","king prawn","tiger prawn","mussel","squid","calamari","scallop","crab","lobster"],excludeKeywords:["prawn cocktail","prawn cracker","seafood stick"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["King Prawns","Cooked Prawns","Mussels in Garlic","Squid Rings"],notExamples:["Prawn Cocktail Crisps","Prawn Crackers","Seafood Sticks"]},{id:"lasagne",name:"Lasagne",description:"Beef lasagne, vegetable lasagne ready meals",keywords:["lasagne","lasagna"],excludeKeywords:["lasagne sheets","lasagne pasta"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Beef Lasagne","Vegetable Lasagne","Tesco Finest Lasagne","M&S Lasagne"],notExamples:["Lasagne Sheets","Dried Lasagne Pasta"]},{id:"chicken_ready_meal",name:"Chicken Ready Meal",description:"Chicken-based ready meals - satay, kiev, hunter's chicken, etc.",keywords:["satay chicken","hunter's chicken","hunters chicken","chicken kiev","chicken dinner","chicken and rice","chicken with rice","roast chicken meal","chicken casserole ready meal","lemon chicken","teriyaki chicken","honey chicken","garlic chicken"],excludeKeywords:["raw chicken","chicken breast","chicken thigh","chicken drumstick"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Tesco Finest Satay Chicken With Jasmine Rice","Chicken Kiev","Hunter's Chicken","Lemon & Herb Chicken"],notExamples:["Raw Chicken Breast","Chicken Thighs","Fresh Chicken"]},{id:"curry_ready_meal",name:"Curry (Ready Meal)",description:"Indian curry ready meals - tikka masala, korma, jalfrezi",keywords:["curry","tikka masala","korma","madras","vindaloo","jalfrezi","balti","bhuna","rogan josh","butter chicken","biryani"],excludeKeywords:["curry paste","curry sauce","curry powder","curry pot noodle","curry leaves"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Chicken Tikka Masala","Lamb Rogan Josh","Vegetable Korma","M&S Chicken Jalfrezi","Chicken Biryani"],notExamples:["Patak's Curry Paste","Curry Powder","Pot Noodle Chicken Korma"]},{id:"chinese_ready_meal",name:"Chinese Ready Meal",description:"Chinese takeaway style ready meals - chow mein, sweet & sour, etc.",keywords:["chow mein","sweet and sour","sweet & sour","kung pao","crispy chilli","szechuan","cantonese","black bean","oyster sauce","egg fried rice","special fried rice","chinese chicken","chinese pork","chinese beef","char siu","hoisin"],excludeKeywords:["sauce","paste","powder","noodles dry","stir fry sauce"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Chicken Chow Mein","Sweet & Sour Chicken","Beef in Black Bean Sauce","Special Fried Rice","Crispy Chilli Beef"],notExamples:["Chow Mein Noodles Dry","Sweet & Sour Sauce","Hoisin Sauce"]},{id:"cottage_shepherds_pie",name:"Cottage Pie / Shepherd's Pie",description:"Minced meat with mashed potato topping ready meals",keywords:["cottage pie","shepherd pie","shepherds pie","shepherd's pie","beef pie mash","lamb pie mash"],excludeKeywords:[],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Cottage Pie","Shepherd's Pie","M&S Cottage Pie","Tesco Shepherd's Pie"],notExamples:[]},{id:"fish_pie",name:"Fish Pie",description:"Fish pie with mashed potato topping ready meals",keywords:["fish pie","fisherman pie","fishermans pie","fisherman's pie","ocean pie","seafood pie"],excludeKeywords:[],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Fish Pie","Fisherman's Pie","M&S Fish Pie","Charlie Bigham's Fish Pie"],notExamples:[]},{id:"pasta_bake_ready_meal",name:"Pasta Bake / Mac & Cheese",description:"Pasta bake, macaroni cheese ready meals",keywords:["pasta bake","macaroni cheese","mac and cheese","mac & cheese","mac n cheese","tuna pasta bake","chicken pasta bake","carbonara ready meal"],excludeKeywords:["pasta bake sauce","pasta bake mix"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Macaroni Cheese","Tuna Pasta Bake","Chicken Pasta Bake","M&S Mac & Cheese"],notExamples:["Pasta Bake Sauce","Dolmio Pasta Bake"]},{id:"spaghetti_bolognese_ready_meal",name:"Spaghetti Bolognese (Ready Meal)",description:"Spaghetti bolognese, meat sauce pasta ready meals",keywords:["spaghetti bolognese","spag bol","bolognaise","meat sauce pasta","beef ragu"],excludeKeywords:["bolognese sauce","ragu sauce","jar"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Spaghetti Bolognese","Spag Bol Ready Meal","Beef Ragu with Pasta"],notExamples:["Dolmio Bolognese Sauce","Ragu Sauce Jar"]},{id:"chilli_con_carne_ready_meal",name:"Chilli Con Carne (Ready Meal)",description:"Chilli con carne ready meals with rice",keywords:["chilli con carne","chili con carne","beef chilli","beef chili","chilli with rice"],excludeKeywords:["chilli sauce","chilli powder","chilli flakes"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Chilli Con Carne","Beef Chilli with Rice","M&S Chilli Con Carne"],notExamples:["Chilli Sauce","Chilli Powder","Chilli Con Carne Spice Mix"]},{id:"roast_dinner_ready_meal",name:"Roast Dinner (Ready Meal)",description:"Sunday roast style ready meals with meat and veg",keywords:["roast dinner","sunday roast","roast beef dinner","roast chicken dinner","roast pork dinner","carvery","roast lamb"],excludeKeywords:["roast potatoes only","roast chicken breast raw"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:500}],toleranceMin:300,toleranceMax:550,examples:["Roast Beef Dinner","Roast Chicken Dinner","Sunday Roast Ready Meal","Carvery Meal"],notExamples:["Roast Potatoes","Raw Roast Chicken"]},{id:"stew_casserole_ready_meal",name:"Stew / Casserole (Ready Meal)",description:"Beef stew, chicken casserole, hotpot ready meals",keywords:["stew","casserole","hotpot","hot pot","lancashire hotpot","beef stew","lamb stew","chicken casserole","irish stew"],excludeKeywords:["casserole mix","stewing steak raw","casserole dish"],defaultServingG:400,servingSizes:[{name:"Small portion",grams:300},{name:"Standard portion",grams:400},{name:"Large portion",grams:450}],toleranceMin:280,toleranceMax:500,examples:["Beef Stew","Lancashire Hotpot","Chicken Casserole","Irish Stew"],notExamples:["Stewing Steak Raw","Casserole Mix Packet"]},{id:"pizza",name:"Pizza",description:"Fresh, frozen, and takeaway pizzas",keywords:["pizza","margherita","pepperoni pizza","pizza express","goodfellas","chicago town","dr oetker"],excludeKeywords:["pizza base","pizza dough","pizza sauce","pizza flavour"],defaultServingG:200,servingSizes:[{name:"1/4 pizza",grams:150},{name:"1/3 pizza",grams:200},{name:"1/2 pizza",grams:300}],toleranceMin:80,toleranceMax:500,examples:["Pepperoni Pizza","Margherita","Chicago Town Deep Dish","Goodfellas Thin"],notExamples:["Pizza Base","Pizza Express Dough Balls","Pizza Flavour Pringles"]},{id:"pie_savoury",name:"Savoury Pies & Pasties",description:"Meat pies, pasties, quiches",keywords:["pie","pasty","pastie","quiche","pukka pie","fray bentos","steak pie","chicken pie","pork pie","cornish pasty"],excludeKeywords:["pie filling","apple pie","cherry pie","banoffee pie","pie crust"],defaultServingG:200,toleranceMin:100,toleranceMax:400,examples:["Pukka Steak Pie","Cornish Pasty","Pork Pie","Quiche Lorraine","Chicken & Mushroom Pie"],notExamples:["Apple Pie","Mr Kipling Pies","Mince Pie"]},{id:"sandwich_prepared",name:"Prepared Sandwiches",description:"Pre-made sandwiches, meal deal sandwiches",keywords:["sandwich","sarnie","blt","club sandwich","triple sandwich","sub"],excludeKeywords:["sandwich thins","sandwich spread","sandwich pickle"],defaultServingG:180,toleranceMin:100,toleranceMax:350,examples:["BLT Sandwich","Chicken & Bacon Triple","Prawn Mayo Sandwich","Tesco Meal Deal Sandwich"],notExamples:["Warburtons Sandwich Thins","Sandwich Spread","Branston Pickle"]},{id:"soup",name:"Soup",description:"Tinned, fresh, and packet soups",keywords:["soup","broth","chowder","heinz soup","baxters","covent garden"],excludeKeywords:["soup mix","soup maker"],defaultServingG:300,servingSizes:[{name:"Cup/mug",grams:200},{name:"Bowl",grams:300},{name:"Large bowl",grams:400}],toleranceMin:150,toleranceMax:500,examples:["Heinz Tomato Soup","Baxters Chicken Broth","New Covent Garden Soup"],notExamples:["Soup and Shake","Dried Soup Mix"]},{id:"pasta_dried",name:"Pasta (Dried)",description:"Dried pasta - spaghetti, penne, fusilli, etc.",keywords:["pasta","spaghetti","penne","fusilli","tagliatelle","rigatoni","farfalle","linguine","macaroni","orzo"],excludeKeywords:["pasta sauce","pasta bake","pot pasta","pasta salad","ready meal"],defaultServingG:75,servingSizes:[{name:"Small portion",grams:60},{name:"Medium portion",grams:75},{name:"Large portion",grams:100}],toleranceMin:40,toleranceMax:150,examples:["Napolina Spaghetti","De Cecco Penne","Barilla Fusilli","Own Brand Pasta"],notExamples:["Dolmio Pasta Sauce","Pot Pasta","Pasta King"]},{id:"rice_dried",name:"Rice (Dried)",description:"Dried rice - basmati, long grain, jasmine, risotto",keywords:["rice","basmati","long grain","jasmine rice","risotto rice","arborio","wild rice","brown rice"],excludeKeywords:["rice pudding","rice cake","rice cracker","microwave rice","rice krispies","fried rice"],defaultServingG:75,servingSizes:[{name:"Small portion",grams:60},{name:"Medium portion",grams:75},{name:"Large portion",grams:100}],toleranceMin:40,toleranceMax:150,examples:["Tilda Basmati Rice","Uncle Bens Long Grain","Arborio Risotto Rice"],notExamples:["Rice Pudding","Rice Cakes","Egg Fried Rice","Ben's Original Microwave Rice"]},{id:"rice_microwave",name:"Microwave Rice (Cooked)",description:"Pre-cooked microwave rice pouches",keywords:["microwave rice","uncle bens","bens original","tilda steamed","express rice"],excludeKeywords:[],defaultServingG:125,toleranceMin:100,toleranceMax:300,examples:["Ben's Original Microwave Rice","Tilda Steamed Rice","Sainsburys Microwave Rice"],notExamples:["Dried Rice","Risotto"]},{id:"noodles",name:"Noodles",description:"Dried and fresh noodles - egg noodles, rice noodles, udon",keywords:["noodle","egg noodle","rice noodle","udon","ramen","chow mein","vermicelli"],excludeKeywords:["pot noodle","noodle pot","super noodles","instant noodles"],defaultServingG:65,toleranceMin:40,toleranceMax:150,examples:["Blue Dragon Egg Noodles","Rice Noodles","Fresh Udon","Straight to Wok Noodles"],notExamples:["Pot Noodle","Super Noodles","Naked Noodle"]},{id:"instant_noodles",name:"Instant Noodles & Pot Noodles",description:"Pot noodles, super noodles, instant ramen",keywords:["pot noodle","super noodles","instant noodle","cup noodle","naked noodle","nissin","kabuto"],excludeKeywords:[],defaultServingG:90,toleranceMin:60,toleranceMax:150,examples:["Pot Noodle Chicken & Mushroom","Batchelors Super Noodles","Kabuto Ramen"],notExamples:["Fresh Noodles","Dried Egg Noodles"]},{id:"apple",name:"Apple",description:"Fresh apples - all varieties",keywords:["apple","granny smith","gala","braeburn","pink lady","jazz apple","cox"],excludeKeywords:["apple juice","apple pie","apple sauce","apple crumble","toffee apple","apple cider"],defaultServingG:150,servingSizes:[{name:"Small apple",grams:120},{name:"Medium apple",grams:150},{name:"Large apple",grams:200}],toleranceMin:80,toleranceMax:250,examples:["Pink Lady Apple","Gala Apple","Granny Smith","Braeburn"],notExamples:["Apple Juice","Apple Pie","Dried Apple"]},{id:"banana",name:"Banana",description:"Fresh bananas",keywords:["banana","fairtrade banana"],excludeKeywords:["banana bread","banana chip","dried banana","banana milkshake","banana split"],defaultServingG:120,servingSizes:[{name:"Small banana",grams:90},{name:"Medium banana",grams:120},{name:"Large banana",grams:150}],toleranceMin:60,toleranceMax:200,examples:["Loose Bananas","Fairtrade Bananas","Organic Bananas"],notExamples:["Banana Bread","Banana Chips","Banana Milkshake"]},{id:"berries",name:"Berries",description:"Strawberries, blueberries, raspberries, blackberries",keywords:["strawberry","strawberries","blueberry","blueberries","raspberry","raspberries","blackberry","blackberries","mixed berries"],excludeKeywords:["jam","compote","yoghurt","smoothie","ice cream"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Fresh Strawberries","Blueberries","Raspberries","Mixed Berry Pack"],notExamples:["Strawberry Jam","Strawberry Yoghurt","Berry Smoothie"]},{id:"citrus",name:"Citrus Fruits",description:"Oranges, lemons, limes, grapefruit, satsumas",keywords:["orange","lemon","lime","grapefruit","satsuma","clementine","tangerine","mandarin"],excludeKeywords:["juice","marmalade","squash","lemon curd","orange chocolate"],defaultServingG:130,servingSizes:[{name:"Small/satsuma",grams:70},{name:"Medium orange",grams:130},{name:"Large orange",grams:180}],toleranceMin:50,toleranceMax:250,examples:["Navel Oranges","Easy Peeler Satsumas","Lemons","Pink Grapefruit"],notExamples:["Orange Juice","Lemon Curd","Terry's Chocolate Orange"]},{id:"grapes",name:"Grapes",description:"Fresh grapes - red, green, black",keywords:["grape","grapes","seedless grapes","red grapes","green grapes","black grapes"],excludeKeywords:["grape juice","raisins","sultanas","wine"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Green Seedless Grapes","Red Grapes","Black Grapes","Cotton Candy Grapes"],notExamples:["Raisins","Sultanas","Grape Juice"]},{id:"melon",name:"Melon",description:"Watermelon, cantaloupe, honeydew, galia",keywords:["melon","watermelon","cantaloupe","honeydew","galia"],excludeKeywords:[],defaultServingG:150,toleranceMin:80,toleranceMax:300,examples:["Watermelon Slices","Cantaloupe Melon","Honeydew Melon","Galia Melon"],notExamples:[]},{id:"tropical_fruit",name:"Tropical Fruits",description:"Mango, pineapple, papaya, kiwi, passion fruit",keywords:["mango","pineapple","papaya","kiwi","passion fruit","coconut","lychee","dragon fruit"],excludeKeywords:["juice","dried","smoothie"],defaultServingG:80,toleranceMin:50,toleranceMax:200,examples:["Fresh Mango","Pineapple Chunks","Kiwi Fruit","Papaya"],notExamples:["Pineapple Juice","Dried Mango","Coconut Milk"]},{id:"dried_fruit",name:"Dried Fruit",description:"Raisins, sultanas, dates, apricots, cranberries",keywords:["dried","raisins","sultanas","currants","dates","dried apricot","dried mango","prunes","cranberries","dried fig"],excludeKeywords:["trail mix","fruit and nut"],defaultServingG:30,toleranceMin:15,toleranceMax:80,examples:["Sun-Maid Raisins","Medjool Dates","Dried Apricots","Dried Cranberries"],notExamples:["Fresh Dates","Fresh Apricots","Trail Mix"]},{id:"potato",name:"Potatoes",description:"Fresh potatoes - baking, mashing, roasting",keywords:["potato","potatoes","maris piper","king edward","jersey royal","new potato","baby potato","baking potato"],excludeKeywords:["chips","crisps","mash","wedges","roast potato","hash brown","potato waffle"],defaultServingG:175,servingSizes:[{name:"Small potato",grams:100},{name:"Medium potato",grams:175},{name:"Large baking potato",grams:300}],toleranceMin:60,toleranceMax:400,examples:["Maris Piper Potatoes","Baking Potatoes","Jersey Royals","Baby New Potatoes"],notExamples:["Oven Chips","Crisps","Mashed Potato","Potato Waffles"]},{id:"chips_frozen",name:"Chips & Wedges (Frozen/Prepared)",description:"Oven chips, frozen chips, potato wedges",keywords:["chips","oven chips","frozen chips","chunky chips","wedges","potato wedges","fries","mccain","aunt bessies"],excludeKeywords:["fish and chips","chip shop","crisps","tortilla chips"],defaultServingG:165,toleranceMin:100,toleranceMax:300,examples:["McCain Oven Chips","Aunt Bessie's Homestyle Chips","Sweet Potato Wedges"],notExamples:["Walkers Crisps","Doritos","Fish and Chips"]},{id:"carrot",name:"Carrots",description:"Fresh carrots - whole, baby, batons",keywords:["carrot","carrots","baby carrot","carrot batons","chantenay"],excludeKeywords:["carrot cake","carrot juice","carrot soup"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Loose Carrots","Baby Carrots","Chantenay Carrots","Carrot Batons"],notExamples:["Carrot Cake","Carrot and Coriander Soup"]},{id:"broccoli",name:"Broccoli",description:"Fresh and frozen broccoli",keywords:["broccoli","tenderstem","broccoli florets"],excludeKeywords:["broccoli soup","broccoli cheese"],defaultServingG:85,toleranceMin:50,toleranceMax:200,examples:["Broccoli Florets","Tenderstem Broccoli","Frozen Broccoli"],notExamples:["Broccoli and Stilton Soup","Broccoli Cheese Bake"]},{id:"onion",name:"Onions",description:"Fresh onions - white, red, spring",keywords:["onion","onions","red onion","white onion","spring onion","shallot","leek"],excludeKeywords:["onion rings","onion bhaji","onion gravy","crispy onion"],defaultServingG:80,toleranceMin:30,toleranceMax:200,examples:["Brown Onions","Red Onions","Spring Onions","Shallots"],notExamples:["Onion Rings","Onion Bhajis","Bisto Onion Gravy"]},{id:"tomato",name:"Tomatoes (Fresh)",description:"Fresh tomatoes - cherry, plum, vine",keywords:["tomato","tomatoes","cherry tomato","plum tomato","vine tomato","beef tomato"],excludeKeywords:["tomato sauce","tomato soup","tinned tomato","chopped tomato","passata","ketchup","puree"],defaultServingG:85,toleranceMin:40,toleranceMax:200,examples:["Cherry Tomatoes","Vine Ripened Tomatoes","Plum Tomatoes","Beef Tomatoes"],notExamples:["Chopped Tomatoes","Tomato Puree","Tomato Ketchup","Tomato Soup"]},{id:"tinned_tomato",name:"Tinned Tomatoes & Passata",description:"Chopped, whole, and passata tomatoes",keywords:["tinned tomato","canned tomato","chopped tomato","plum tomato tin","passata","tomato puree"],excludeKeywords:["tomato soup","tomato sauce"],defaultServingG:100,toleranceMin:50,toleranceMax:400,examples:["Napolina Chopped Tomatoes","Whole Plum Tomatoes","Passata","Tomato Puree"],notExamples:["Fresh Tomatoes","Tomato Soup","Dolmio Sauce"]},{id:"salad_leaves",name:"Salad Leaves & Lettuce",description:"Lettuce, spinach, rocket, mixed leaves",keywords:["lettuce","salad","rocket","spinach","watercress","mixed leaves","iceberg","romaine","cos","little gem"],excludeKeywords:["salad dressing","caesar salad","pasta salad","potato salad","coleslaw"],defaultServingG:35,toleranceMin:15,toleranceMax:100,examples:["Iceberg Lettuce","Baby Spinach","Rocket Salad","Mixed Salad Leaves"],notExamples:["Caesar Salad with Dressing","Pasta Salad","Coleslaw"]},{id:"beans_green",name:"Green Beans & Peas",description:"Green beans, runner beans, peas, mange tout",keywords:["green bean","runner bean","pea","garden pea","petit pois","mange tout","sugar snap","edamame"],excludeKeywords:["baked beans","bean salad","bean chilli"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Fine Beans","Garden Peas","Mange Tout","Sugar Snap Peas","Frozen Peas"],notExamples:["Heinz Baked Beans","Three Bean Salad"]},{id:"baked_beans",name:"Baked Beans",description:"Tinned baked beans in tomato sauce",keywords:["baked beans","heinz beans","branston beans"],excludeKeywords:[],defaultServingG:200,toleranceMin:100,toleranceMax:420,examples:["Heinz Baked Beans","Branston Baked Beans","Reduced Sugar Baked Beans"],notExamples:["Green Beans","Kidney Beans","Bean Salad"]},{id:"sweetcorn",name:"Sweetcorn",description:"Tinned, frozen, and fresh sweetcorn",keywords:["sweetcorn","corn on the cob","corn kernels","baby corn"],excludeKeywords:["cornflakes","corn chips","popcorn"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Green Giant Sweetcorn","Frozen Sweetcorn","Corn on the Cob","Baby Corn"],notExamples:["Popcorn","Corn Flakes","Doritos"]},{id:"mushroom",name:"Mushrooms",description:"Fresh and tinned mushrooms",keywords:["mushroom","button mushroom","chestnut mushroom","portobello","shiitake","oyster mushroom"],excludeKeywords:["mushroom soup","mushroom sauce","mushroom risotto"],defaultServingG:65,toleranceMin:30,toleranceMax:200,examples:["Button Mushrooms","Chestnut Mushrooms","Portobello Mushrooms","Sliced Mushrooms"],notExamples:["Cream of Mushroom Soup","Mushroom Stroganoff"]},{id:"pepper",name:"Peppers",description:"Bell peppers - red, green, yellow, orange",keywords:["pepper","bell pepper","red pepper","green pepper","yellow pepper","mixed pepper","romano pepper"],excludeKeywords:["pepper steak","black pepper","chilli pepper","pepper sauce"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Red Peppers","Mixed Peppers","Yellow Pepper","Romano Peppers"],notExamples:["Black Pepper","Jalapeno Peppers","Pepper Steak"]},{id:"cucumber",name:"Cucumber",description:"Fresh cucumber",keywords:["cucumber","mini cucumber"],excludeKeywords:["tzatziki","cucumber salad"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Whole Cucumber","Mini Cucumbers","Sliced Cucumber"],notExamples:["Tzatziki Dip"]},{id:"courgette",name:"Courgette & Squash",description:"Courgettes, butternut squash, aubergine",keywords:["courgette","zucchini","butternut squash","squash","aubergine","eggplant"],excludeKeywords:["courgette soup","squash soup"],defaultServingG:90,toleranceMin:50,toleranceMax:250,examples:["Courgettes","Butternut Squash","Aubergine","Diced Butternut"],notExamples:["Butternut Squash Soup","Moussaka"]},{id:"cabbage",name:"Cabbage & Kale",description:"White cabbage, red cabbage, savoy, kale",keywords:["cabbage","white cabbage","red cabbage","savoy","kale","cavolo nero","spring greens"],excludeKeywords:["coleslaw","sauerkraut"],defaultServingG:90,toleranceMin:40,toleranceMax:200,examples:["White Cabbage","Red Cabbage","Savoy Cabbage","Curly Kale"],notExamples:["Coleslaw","Sauerkraut"]},{id:"cauliflower",name:"Cauliflower",description:"Fresh and frozen cauliflower",keywords:["cauliflower","cauliflower florets","cauliflower rice"],excludeKeywords:["cauliflower cheese","cauliflower soup"],defaultServingG:85,toleranceMin:50,toleranceMax:200,examples:["Cauliflower Florets","Whole Cauliflower","Cauliflower Rice","Frozen Cauliflower"],notExamples:["Cauliflower Cheese","Cauliflower Soup"]},{id:"avocado",name:"Avocado",description:"Fresh avocados",keywords:["avocado","ripe avocado","hass avocado"],excludeKeywords:["guacamole","avocado oil"],defaultServingG:75,servingSizes:[{name:"Half avocado",grams:75},{name:"Whole avocado",grams:150}],toleranceMin:50,toleranceMax:200,examples:["Ripe Avocado","Ripen at Home Avocado","Hass Avocado"],notExamples:["Guacamole","Avocado Oil"]},{id:"crisps",name:"Crisps & Tortilla Chips",description:"Potato crisps, tortilla chips, vegetable crisps (single bag ~25g)",keywords:["crisps","walkers","pringles","kettle chips","sensations","tyrrells","doritos","tortilla chips","nachos"],excludeKeywords:["oven chips","frozen chips","fish and chips"],defaultServingG:25,toleranceMin:15,toleranceMax:50,examples:["Walkers Ready Salted","Pringles Original","Doritos","Kettle Chips","Sensations"],notExamples:["Oven Chips","McCain Chips"]},{id:"popcorn",name:"Popcorn",description:"Ready-made and microwave popcorn",keywords:["popcorn","butterkist","metcalfe","propercorn","skinny popcorn"],excludeKeywords:["popcorn chicken"],defaultServingG:25,toleranceMin:15,toleranceMax:80,examples:["Butterkist Sweet Popcorn","Propercorn","Metcalfe's Skinny Popcorn"],notExamples:["KFC Popcorn Chicken"]},{id:"nuts_plain",name:"Nuts (Plain & Roasted)",description:"Almonds, cashews, peanuts, mixed nuts",keywords:["nuts","almond","cashew","peanut","walnut","pistachio","brazil nut","macadamia","hazelnut","mixed nuts","dry roasted"],excludeKeywords:["nut butter","chocolate nuts","honey roasted","praline"],defaultServingG:30,toleranceMin:15,toleranceMax:80,examples:["KP Dry Roasted Peanuts","Whole Almonds","Cashew Nuts","Mixed Nuts"],notExamples:["Peanut Butter","Snickers","Chocolate Brazils","Honey Roasted Peanuts"]},{id:"chocolate_bar",name:"Chocolate Bars",description:"Chocolate bars, blocks, and countlines",keywords:["chocolate","dairy milk","galaxy","cadbury","mars","snickers","twix","kitkat","bounty","maltesers","milky way","milkybar","aero","wispa","crunchie","flake","yorkie","toblerone","lindt"],excludeKeywords:["chocolate milk","chocolate milkshake","hot chocolate","chocolate spread","chocolate cake","chocolate biscuit","chocolate ice cream","truffles","box"],defaultServingG:40,toleranceMin:20,toleranceMax:60,examples:["Cadbury Dairy Milk","Galaxy Smooth Milk","Mars Bar","Snickers","KitKat","Maltesers"],notExamples:["Chocolate Milk","Hot Chocolate","Chocolate Spread","Chocolate Digestive","Lindt Lindor Truffles Box"]},{id:"chocolate_sharing",name:"Chocolate (Sharing Bags)",description:"Sharing bags of small chocolates like M&Ms, Maltesers pouches",keywords:["sharing bag","pouch","m&ms","maltesers bag","minstrels","revels","peanut m&m"],excludeKeywords:["box","truffles","lindor","ferrero"],defaultServingG:40,toleranceMin:25,toleranceMax:60,examples:["M&M's Sharing Bag","Maltesers Pouch","Minstrels Bag","Revels"],notExamples:["Lindt Lindor Box","Ferrero Rocher","Celebrations Tub"]},{id:"chocolate_selection_box",name:"Chocolate Selection Boxes",description:"Selection tubs and boxes - Celebrations, Roses, Heroes, Quality Street",keywords:["celebrations","heroes","roses","quality street","selection","tub","miniatures"],excludeKeywords:["truffles","lindor","ferrero"],defaultServingG:30,toleranceMin:20,toleranceMax:50,examples:["Celebrations","Heroes","Quality Street","Cadbury Roses","Cadbury Miniatures"],notExamples:["Lindt Lindor","Ferrero Rocher","Single Bar"]},{id:"chocolate_truffles_box",name:"Boxed Chocolates & Truffles",description:"Premium boxed chocolates - Lindor, Ferrero Rocher, Belgian chocolates",keywords:["truffles","lindor","ferrero","rocher","belgian","praline","boxed chocolate","gift box","assorted chocolate"],excludeKeywords:["sharing bag","multipack"],defaultServingG:25,toleranceMin:12,toleranceMax:40,examples:["Lindt Lindor Truffles","Ferrero Rocher","Belgian Chocolate Selection","Hotel Chocolat"],notExamples:["Celebrations","Heroes","Chocolate Bar","M&Ms"]},{id:"sweets",name:"Sweets & Candy",description:"Boiled sweets, gummies, jellies, mints",keywords:["sweet","candy","gummy","haribo","jelly baby","wine gums","fruit pastille","skittles","starburst","polo","mints","toffee","fudge","chews","bonbon"],excludeKeywords:["sweet potato","sweetcorn","sweet chilli"],defaultServingG:25,toleranceMin:10,toleranceMax:50,examples:["Haribo Starmix","Bassetts Wine Gums","Rowntree's Fruit Pastilles","Skittles"],notExamples:["Sweet Potato","Chocolate Bar"]},{id:"biscuits",name:"Biscuits",description:"Sweet biscuits - digestives, bourbons, custard creams (2 biscuits typical)",keywords:["biscuit","digestive","hobnob","bourbon","custard cream","rich tea","shortbread","oreo","maryland","cookie","jammie dodger","malted milk"],excludeKeywords:["biscuit base","biscuit tin"],defaultServingG:25,toleranceMin:10,toleranceMax:40,examples:["McVitie's Digestives","Chocolate Hobnobs","Bourbon Creams","Oreos","Maryland Cookies"],notExamples:["Cheesecake Biscuit Base"]},{id:"cake",name:"Cakes & Gateaux",description:"Large cakes, sliced cakes, gateaux",keywords:["cake","sponge","victoria sponge","chocolate cake","carrot cake","cheesecake","gateau","birthday cake","coffee cake","lemon drizzle"],excludeKeywords:["cake mix","cake bar","jaffa cake","rice cake","fish cake","potato cake"],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Victoria Sponge","Chocolate Fudge Cake","Carrot Cake","New York Cheesecake"],notExamples:["Jaffa Cakes","Rice Cakes","Cake Mix"]},{id:"cake_bars",name:"Cake Bars & Individual Cakes",description:"Mr Kipling cakes, French Fancies, cake bars",keywords:["cake bar","mr kipling","french fancy","fondant fancy","mini roll","swiss roll","jaffa cake","angel slice","bakewell","brownie"],excludeKeywords:[],defaultServingG:35,toleranceMin:20,toleranceMax:100,examples:["Mr Kipling French Fancies","Cadbury Mini Rolls","Jaffa Cakes","Bakewell Tart","Brownie"],notExamples:["Whole Cake","Large Victoria Sponge"]},{id:"muffins_sweet",name:"Muffins (Sweet)",description:"Chocolate chip, blueberry, and other sweet muffins",keywords:["muffin chocolate","blueberry muffin","double chocolate muffin","banana muffin","lemon muffin"],excludeKeywords:["english muffin"],defaultServingG:100,toleranceMin:60,toleranceMax:180,examples:["Chocolate Chip Muffin","Blueberry Muffin","Starbucks Muffin","Costa Muffin"],notExamples:["English Muffin","Warburtons Muffins"]},{id:"doughnuts",name:"Doughnuts",description:"Ring doughnuts, jam doughnuts, filled doughnuts",keywords:["doughnut","donut","jam doughnut","ring doughnut","krispy kreme","dunkin"],excludeKeywords:[],defaultServingG:70,toleranceMin:40,toleranceMax:150,examples:["Krispy Kreme Original","Jam Doughnut","Ring Doughnut","Yum Yums"],notExamples:[]},{id:"soft_drinks",name:"Soft Drinks",description:"Fizzy drinks, cola, lemonade, squash",keywords:["cola","coke","pepsi","fanta","sprite","7up","lemonade","orangeade","fizzy","soda","dr pepper","irn bru","lucozade","energy drink","red bull","monster"],excludeKeywords:["diet","zero","no sugar","sugar free"],defaultServingG:330,servingSizes:[{name:"Small can",grams:250},{name:"Standard can",grams:330},{name:"Large bottle",grams:500}],toleranceMin:150,toleranceMax:750,examples:["Coca-Cola","Pepsi","Fanta Orange","Sprite","Lucozade Original","Red Bull"],notExamples:["Diet Coke","Coke Zero","Pepsi Max"]},{id:"soft_drinks_diet",name:"Diet & Zero Soft Drinks",description:"Sugar-free fizzy drinks",keywords:["diet coke","coke zero","pepsi max","diet pepsi","fanta zero","sprite zero","sugar free","no sugar","zero sugar"],excludeKeywords:[],defaultServingG:330,toleranceMin:150,toleranceMax:750,examples:["Diet Coke","Coke Zero","Pepsi Max","Fanta Zero","7Up Free"],notExamples:["Regular Coca-Cola","Full Sugar Fanta"]},{id:"fruit_juice",name:"Fruit Juice",description:"Orange juice, apple juice, fruit juices",keywords:["juice","orange juice","apple juice","tropicana","innocent","pure juice","freshly squeezed","cranberry juice","grape juice"],excludeKeywords:["squash","cordial","concentrate","juice drink"],defaultServingG:200,toleranceMin:100,toleranceMax:500,examples:["Tropicana Orange Juice","Innocent Apple Juice","Fresh Orange Juice","Cranberry Juice"],notExamples:["Robinsons Squash","Capri Sun","Um Bongo"]},{id:"smoothie",name:"Smoothies",description:"Fruit smoothies, protein smoothies",keywords:["smoothie","innocent smoothie","naked juice","protein smoothie"],excludeKeywords:[],defaultServingG:250,toleranceMin:150,toleranceMax:500,examples:["Innocent Strawberry & Banana","Naked Green Machine","M&S Super Smoothie"],notExamples:["Fruit Juice","Milkshake"]},{id:"milkshake",name:"Milkshakes",description:"Flavoured milkshakes - chocolate, strawberry, banana",keywords:["milkshake","frijj","yazoo","chocolate milk","strawberry milk","banana milkshake"],excludeKeywords:["milkshake powder","milkshake mix"],defaultServingG:400,toleranceMin:200,toleranceMax:600,examples:["Frijj Chocolate Milkshake","Yazoo Strawberry","McDonald's Milkshake"],notExamples:["Semi-Skimmed Milk","Milkshake Powder"]},{id:"hot_drinks",name:"Hot Drinks (Prepared)",description:"Coffee shop drinks - lattes, cappuccinos, hot chocolates (ready to drink)",keywords:["latte","cappuccino","americano","mocha","flat white","macchiato","starbucks","costa","nero"],excludeKeywords:["coffee beans","instant coffee","ground coffee","powder","flakes","drinking chocolate","cocoa","mix","sachet"],defaultServingG:350,toleranceMin:200,toleranceMax:500,examples:["Starbucks Latte","Costa Cappuccino","Caffe Nero Mocha","Costa Hot Chocolate RTD"],notExamples:["Nescafe Instant","Ground Coffee","Coffee Beans","Hot Chocolate Powder","Cadbury Drinking Chocolate","Galaxy Hot Chocolate Flakes"]},{id:"tea_coffee_instant",name:"Tea & Coffee (Instant/Dry)",description:"Tea bags, instant coffee, ground coffee",keywords:["tea bag","instant coffee","nescafe","kenco","pg tips","yorkshire tea","tetley","twinings","ground coffee"],excludeKeywords:[],defaultServingG:2,toleranceMin:1,toleranceMax:10,examples:["PG Tips Tea Bags","Yorkshire Tea","Nescafe Gold","Kenco Millicano"],notExamples:["Costa Latte","Starbucks Iced Coffee"]},{id:"hot_chocolate_powder",name:"Hot Chocolate Powder/Mix",description:"Hot chocolate powder, drinking chocolate, cocoa powder mixes",keywords:["hot chocolate","drinking chocolate","cocoa","chocolate flakes","chocolate powder","options","cadbury hot chocolate","galaxy hot chocolate","ovaltine"],excludeKeywords:["ready to drink","prepared","rtd","carton"],defaultServingG:25,toleranceMin:15,toleranceMax:40,examples:["Cadbury Drinking Chocolate","Galaxy Hot Chocolate","Options Hot Chocolate","Ovaltine","Green & Blacks Cocoa"],notExamples:["Costa Hot Chocolate","Starbucks Hot Chocolate","Ready Made Hot Chocolate"]},{id:"squash_cordial",name:"Squash & Cordial",description:"Concentrated squash and cordials (undiluted)",keywords:["squash","cordial","robinsons","ribena","vimto","dilute","concentrate"],excludeKeywords:["no added sugar","sugar free"],defaultServingG:50,toleranceMin:25,toleranceMax:100,examples:["Robinsons Orange Squash","Ribena","Vimto Cordial","Elderflower Cordial"],notExamples:["Ready to Drink","Carton Drink"]},{id:"alcohol_beer",name:"Beer & Lager",description:"Beer, lager, ale, cider",keywords:["beer","lager","ale","cider","stout","ipa","pilsner","guinness","stella","heineken","carling","fosters","budweiser","corona","peroni","craft beer"],excludeKeywords:["non alcoholic","alcohol free","0%"],defaultServingG:500,servingSizes:[{name:"Half pint",grams:284},{name:"Can/bottle",grams:440},{name:"Pint",grams:568}],toleranceMin:250,toleranceMax:700,examples:["Stella Artois","Heineken","Guinness","Magners Cider","BrewDog Punk IPA"],notExamples:["Heineken 0.0","Alcohol-Free Peroni"]},{id:"alcohol_wine",name:"Wine",description:"Red, white, ros, sparkling wine",keywords:["wine","red wine","white wine","rose","prosecco","champagne","sauvignon","chardonnay","merlot","pinot","rioja","malbec"],excludeKeywords:["wine gums","cooking wine","non alcoholic"],defaultServingG:175,servingSizes:[{name:"Small glass",grams:125},{name:"Medium glass",grams:175},{name:"Large glass",grams:250}],toleranceMin:100,toleranceMax:300,examples:["Sauvignon Blanc","Merlot","Prosecco","Pinot Grigio","House Red"],notExamples:["Wine Gums","Cooking Wine"]},{id:"alcohol_spirits",name:"Spirits",description:"Vodka, gin, rum, whisky, tequila",keywords:["vodka","gin","rum","whisky","whiskey","tequila","brandy","bourbon","cognac","liqueur","baileys","amaretto","sambuca"],excludeKeywords:[],defaultServingG:25,servingSizes:[{name:"Single measure",grams:25},{name:"Double measure",grams:50}],toleranceMin:20,toleranceMax:100,examples:["Smirnoff Vodka","Gordon's Gin","Captain Morgan Rum","Jack Daniel's","Baileys"],notExamples:["Rum and Coke","Cocktail"]},{id:"ketchup_sauces",name:"Ketchup & Table Sauces",description:"Ketchup, brown sauce, BBQ sauce",keywords:["ketchup","tomato ketchup","heinz","brown sauce","hp sauce","bbq sauce","burger sauce"],excludeKeywords:[],defaultServingG:15,toleranceMin:10,toleranceMax:50,examples:["Heinz Tomato Ketchup","HP Brown Sauce","Heinz BBQ Sauce","Nandos Sauce"],notExamples:["Tomato Puree","Pasta Sauce"]},{id:"mayonnaise",name:"Mayonnaise & Salad Cream",description:"Mayonnaise, salad cream, aioli",keywords:["mayonnaise","mayo","hellmanns","salad cream","aioli","garlic mayo"],excludeKeywords:["egg mayo sandwich","prawn mayo"],defaultServingG:15,toleranceMin:10,toleranceMax:50,examples:["Hellmann's Mayonnaise","Heinz Salad Cream","Garlic Aioli","Light Mayo"],notExamples:["Egg Mayo Sandwich","Coleslaw"]},{id:"mustard",name:"Mustard",description:"English mustard, Dijon, wholegrain",keywords:["mustard","english mustard","dijon","wholegrain mustard","french mustard","colmans"],excludeKeywords:["mustard powder"],defaultServingG:10,toleranceMin:5,toleranceMax:30,examples:["Colman's English Mustard","Maille Dijon","Wholegrain Mustard"],notExamples:["Mustard Powder","Honey Mustard Dressing"]},{id:"salad_dressing",name:"Salad Dressings",description:"Caesar dressing, vinaigrette, ranch",keywords:["dressing","caesar dressing","vinaigrette","ranch","thousand island","balsamic glaze","french dressing"],excludeKeywords:["salad cream"],defaultServingG:30,toleranceMin:15,toleranceMax:60,examples:["Newman's Own Caesar","Balsamic Vinaigrette","Ranch Dressing","Blue Cheese Dressing"],notExamples:["Salad Cream","Mayonnaise"]},{id:"cooking_sauce",name:"Cooking Sauces",description:"Pasta sauces, curry sauces, stir fry sauces",keywords:["pasta sauce","dolmio","ragu","curry sauce","korma sauce","tikka sauce","stir fry sauce","oyster sauce","teriyaki","pesto"],excludeKeywords:[],defaultServingG:125,toleranceMin:50,toleranceMax:250,examples:["Dolmio Bolognese Sauce","Loyd Grossman Tomato & Basil","Patak's Tikka Sauce","Blue Dragon Stir Fry"],notExamples:["Tomato Ketchup","Mayonnaise"]},{id:"oil",name:"Cooking Oils",description:"Olive oil, vegetable oil, coconut oil",keywords:["oil","olive oil","vegetable oil","sunflower oil","coconut oil","rapeseed oil","sesame oil","fry light"],excludeKeywords:["oily fish","essential oil"],defaultServingG:15,toleranceMin:5,toleranceMax:30,examples:["Filippo Berio Olive Oil","Crisp n Dry","Fry Light","Coconut Oil"],notExamples:["Fish Oil Capsules","CBD Oil"]},{id:"vinegar",name:"Vinegar",description:"Balsamic, white wine, malt vinegar",keywords:["vinegar","balsamic","white wine vinegar","red wine vinegar","malt vinegar","apple cider vinegar","rice vinegar"],excludeKeywords:[],defaultServingG:15,toleranceMin:5,toleranceMax:30,examples:["Balsamic Vinegar","Sarson's Malt Vinegar","White Wine Vinegar"],notExamples:["Balsamic Glaze","Vinaigrette"]},{id:"jam_honey",name:"Jam, Honey & Sweet Spreads",description:"Jam, marmalade, honey, Nutella, peanut butter",keywords:["jam","marmalade","honey","nutella","chocolate spread","peanut butter","almond butter","lemon curd","biscoff spread","marmite","bovril"],excludeKeywords:["jam doughnut","jammie dodger"],defaultServingG:15,toleranceMin:10,toleranceMax:40,examples:["Bonne Maman Strawberry Jam","Nutella","Sun-Pat Peanut Butter","Rowse Honey","Marmite"],notExamples:["Jam Doughnut","PB&J Sandwich"]},{id:"hummus_dips",name:"Hummus & Dips",description:"Hummus, guacamole, tzatziki, salsa",keywords:["hummus","houmous","guacamole","tzatziki","salsa","sour cream dip","taramasalata","baba ganoush"],excludeKeywords:[],defaultServingG:50,toleranceMin:25,toleranceMax:100,examples:["Sabra Hummus","Fresh Guacamole","Doritos Salsa","Tzatziki"],notExamples:["Avocado","Soured Cream"]},{id:"pickle_chutney",name:"Pickles & Chutneys",description:"Pickled onions, gherkins, mango chutney",keywords:["pickle","pickled","gherkin","chutney","branston","relish","piccalilli","sauerkraut","kimchi"],excludeKeywords:[],defaultServingG:25,toleranceMin:15,toleranceMax:60,examples:["Branston Pickle","Pickled Onions","Mango Chutney","Gherkins"],notExamples:["Fresh Cucumber","Fresh Onion"]},{id:"ice_cream",name:"Ice Cream",description:"Tubs, cones, lollies, magnums (1-2 scoops or 1 lolly)",keywords:["ice cream","gelato","magnum","ben and jerrys","haagen dazs","cornetto","twister","solero","ice lolly","fab","calippo","mini milk"],excludeKeywords:["ice cream maker","ice cream scoop"],defaultServingG:75,servingSizes:[{name:"Small scoop",grams:60},{name:"Standard scoop",grams:75},{name:"Large scoop",grams:100}],toleranceMin:40,toleranceMax:120,examples:["Ben & Jerry's Cookie Dough","Magnum Classic","Haagen-Dazs","Cornetto"],notExamples:["Frozen Yoghurt","Sorbet"]},{id:"frozen_veg",name:"Frozen Vegetables",description:"Frozen peas, sweetcorn, mixed veg",keywords:["frozen pea","frozen sweetcorn","frozen vegetable","birds eye","frozen mixed","frozen spinach","frozen broccoli"],excludeKeywords:[],defaultServingG:80,toleranceMin:40,toleranceMax:200,examples:["Birds Eye Garden Peas","Frozen Sweetcorn","Frozen Mixed Vegetables","Frozen Spinach"],notExamples:["Fresh Peas","Tinned Peas"]},{id:"frozen_fish_products",name:"Frozen Fish Products",description:"Fish fingers, fish cakes, breaded fish",keywords:["fish finger","fish cake","battered fish","breaded fish","fish fillet frozen","birds eye fish","youngs"],excludeKeywords:[],defaultServingG:100,toleranceMin:50,toleranceMax:200,examples:["Birds Eye Fish Fingers","Young's Fish Cakes","Battered Cod","Breaded Haddock"],notExamples:["Fresh Salmon Fillet","Tinned Tuna"]},{id:"frozen_chicken_products",name:"Frozen Chicken Products",description:"Chicken nuggets, chicken kievs, chicken dippers",keywords:["chicken nugget","chicken dipper","chicken kiev","chicken goujons","breaded chicken","southern fried chicken","chicken bites"],excludeKeywords:[],defaultServingG:100,toleranceMin:50,toleranceMax:200,examples:["Birds Eye Chicken Dippers","Chicken Nuggets","Chicken Kievs","Southern Fried Chicken"],notExamples:["Fresh Chicken Breast","Rotisserie Chicken"]},{id:"cereal_bar",name:"Cereal & Protein Bars",description:"Cereal bars, protein bars, flapjacks",keywords:["cereal bar","protein bar","flapjack","nutri-grain","nakd","trek","grenade","fulfil","kind bar","nature valley","belvita"],excludeKeywords:[],defaultServingG:40,toleranceMin:20,toleranceMax:80,examples:["Nature Valley Crunchy","Nakd Cocoa Orange","Grenade Carb Killa","Trek Protein Flapjack"],notExamples:["Chocolate Bar","Cereal Box"]},{id:"baby_food",name:"Baby Food",description:"Baby purees, baby cereals, toddler snacks",keywords:["baby food","baby puree","ella's kitchen","cow and gate","aptamil","hipp organic","baby cereal","baby rice"],excludeKeywords:[],defaultServingG:70,toleranceMin:40,toleranceMax:150,examples:["Ella's Kitchen Pouch","Cow & Gate Jar","Baby Rice","Organix Snacks"],notExamples:[]},{id:"supplements",name:"Supplements & Vitamins",description:"Vitamin tablets, protein powder, supplements",keywords:["vitamin","supplement","protein powder","whey","creatine","omega 3","fish oil capsule","multivitamin","centrum","berocca"],excludeKeywords:[],defaultServingG:30,toleranceMin:1,toleranceMax:100,examples:["Optimum Nutrition Whey","Centrum Multivitamins","Omega 3 Capsules","Berocca"],notExamples:["Fresh Fish","Orange Juice with Vitamins"]},{id:"tofu_meat_alternatives",name:"Tofu & Meat Alternatives",description:"Tofu, tempeh, Quorn, plant-based meat",keywords:["tofu","tempeh","quorn","beyond meat","impossible","this isn't","plant based","meat free","vegan mince","vegan burger","seitan"],excludeKeywords:[],defaultServingG:100,toleranceMin:50,toleranceMax:200,examples:["Cauldron Tofu","Quorn Mince","Beyond Burger","THIS Isn't Chicken"],notExamples:["Chicken Breast","Beef Mince"]},{id:"flour_baking",name:"Flour & Baking Ingredients",description:"Flour, sugar, baking powder, yeast",keywords:["flour","plain flour","self raising","bread flour","sugar","caster sugar","icing sugar","brown sugar","baking powder","yeast","cornflour"],excludeKeywords:["sugar free","no added sugar"],defaultServingG:30,toleranceMin:5,toleranceMax:100,examples:["Allinson Plain Flour","Tate & Lyle Caster Sugar","Baking Powder","Dried Yeast"],notExamples:["Cake","Bread","Biscuits"]},{id:"crackers_crispbreads",name:"Crackers & Crispbreads",description:"Cream crackers, rice cakes, oatcakes, Ryvita",keywords:["cracker","cream cracker","rice cake","ryvita","crispbread","oatcake","water biscuit","carr's","tuc"],excludeKeywords:["prawn cracker","christmas cracker"],defaultServingG:20,toleranceMin:10,toleranceMax:60,examples:["Jacob's Cream Crackers","Ryvita Original","Rice Cakes","Nairn's Oatcakes"],notExamples:["Prawn Crackers","Christmas Crackers"]},{id:"crisps_savoury_snacks",name:"Crisps & Savoury Snacks",description:"Crisps, nuts, pretzels, popcorn",keywords:["crisps","chips","pretzels","twiglets","mini cheddars","pork scratchings","bombay mix","wasabi peas"],excludeKeywords:[],defaultServingG:30,toleranceMin:15,toleranceMax:80,examples:["Walkers Ready Salted","Mini Cheddars","Twiglets","Pretzels"],notExamples:["Oven Chips","Potato Wedges"]},{id:"other",name:"Other / Uncategorized",description:"Foods that don't fit other categories",keywords:[],excludeKeywords:[],defaultServingG:100,toleranceMin:10,toleranceMax:500,examples:[],notExamples:[]}];function Dc(e){const t=e.match(/(\d+)\s*x\s*(\d+)\s*g\b/i);if(t)return parseInt(t[2],10);const s=e.match(/(\d+)\s*g\b/gi);if(s&&s.length>0){const i=s.map(r=>parseInt(r.replace(/[^\d]/g,""),10)).filter(r=>r>50);if(i.length>0)return Math.max(...i)}return null}function H3(){return`You are a food categorization expert for a UK nutrition app. Your job is to categorize food products into the correct category.

CRITICAL RULES:
1. Read the FULL product name carefully. "Cadbury Dairy Milk" is CHOCOLATE, not DAIRY.
2. "Milk Chocolate" means chocolate made with milk, NOT milk. Categorize as chocolate_bar.
3. "Chocolate Milkshake" is a milkshake flavored with chocolate. Categorize as milkshake.
4. Brand names matter: "Galaxy" = chocolate, "Yazoo" = milkshake, "Warburtons" = bread
5. If unsure between two categories, pick the more specific one.
6. Consider UK products and brands specifically.

CATEGORIES:
${Zo.map(t=>`
## ${t.name} (ID: ${t.id})
${t.description}
- Default serving: ${t.defaultServingG}g
- Acceptable T0 range: ${t.toleranceMin}g - ${t.toleranceMax}g
- Examples: ${t.examples.join(", ")}
- NOT this category: ${t.notExamples.join(", ")}
`).join(`
`)}

For each food, respond with JSON in this exact format:
{
  "categoryId": "the_category_id",
  "confidence": 85,
  "reasoning": "Brief explanation of why this category"
}`}function j3(e){const t=e.map((s,i)=>{const r=s.brand?` (${s.brand})`:"",n=s.servingSizeG?` [current serving: ${s.servingSizeG}g]`:"";return`${i+1}. ${s.name}${r}${n}`}).join(`
`);return`Categorize these ${e.length} food products. Return a JSON array with one object per food in the same order:

${t}

Respond with ONLY a JSON array, no other text:
[
  {"categoryId": "...", "confidence": 85, "reasoning": "..."},
  ...
]`}async function X_(e,t,s){const i=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":s,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:8e3,system:e,messages:[{role:"user",content:t}]})});if(!i.ok){const n=await i.text();throw new Error(`Claude API error: ${i.status} - ${n}`)}const r=await i.json();return{content:r.content[0].text,inputTokens:r.usage.input_tokens,outputTokens:r.usage.output_tokens}}async function ek(e,t,s){const i=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:e},{role:"user",content:t}],max_tokens:8e3,temperature:.3})});if(!i.ok){const n=await i.text();throw new Error(`OpenAI API error: ${i.status} - ${n}`)}const r=await i.json();return{content:r.choices[0].message.content,inputTokens:r.usage.prompt_tokens,outputTokens:r.usage.completion_tokens}}function W3(e,t){const s=e.match(/\[[\s\S]*\]/);if(!s)throw new Error("Could not find JSON array in response");const i=JSON.parse(s[0]);if(!Array.isArray(i)||i.length!==t.length)throw new Error(`Expected ${t.length} results, got ${i.length}`);return i.map((r,n)=>{const o=t[n],a=Zo.find(g=>g.id===r.categoryId)||Zo.find(g=>g.id==="other"),l=Dc(o.name),u=o.servingSizeG!==null&&o.servingSizeG>=a.toleranceMin&&o.servingSizeG<=a.toleranceMax;let h,p;return u&&o.servingSizeG!==null?(h=o.servingSizeG,p="validated"):l!==null&&l<a.defaultServingG&&l>=a.toleranceMin?(h=l,p="pack_size"):(h=a.defaultServingG,p="category_default"),{foodId:o.id,foodName:o.name,brand:o.brand,categoryId:a.id,categoryName:a.name,confidence:r.confidence||80,reasoning:r.reasoning||"",suggestedServingG:h,currentServingG:o.servingSizeG,servingValidated:u,packSizeG:l,servingSource:p}})}async function z3(e,t,s,i){const r=Date.now(),n=[];let o=0,a=0,l=0;const u=H3(),h=50;for(let C=0;C<e.length;C+=h){const y=e.slice(C,C+h),R=j3(y);try{const x=t==="claude-sonnet"?await X_(u,R,s):await ek(u,R,s);o+=x.inputTokens,a+=x.outputTokens;const S=W3(x.content,y);n.push(...S)}catch(x){console.error(`Batch ${C/h+1} failed:`,x),l+=y.length,y.forEach(S=>{n.push({foodId:S.id,foodName:S.name,brand:S.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:"Categorization failed",suggestedServingG:100,currentServingG:S.servingSizeG,servingValidated:!1,packSizeG:Dc(S.name),servingSource:"category_default"})})}i==null||i(Math.min(C+h,e.length),e.length),C+h<e.length&&await new Promise(x=>setTimeout(x,500))}const p=t==="claude-sonnet"?3:2.5,g=t==="claude-sonnet"?15:10,m=o/1e6*p+a/1e6*g;return{results:n,totalProcessed:e.length,totalSuccessful:e.length-l,totalFailed:l,processingTimeMs:Date.now()-r,model:t,cost:{inputTokens:o,outputTokens:a,estimatedCost:m}}}async function U3(e,t,s,i){const r=Date.now(),n=[];let o=0,a=0,l=0;const h=`You categorize UK food products. Output JSON only.

Categories: ${Zo.map(y=>y.id).join(", ")}

Rules:
- CRITICAL: Read the FULL product name carefully - it determines the category, not the brand
- Brands make multiple products: Elmlea makes cream AND butter, Lurpak makes butter AND spreads, etc.
- Product name keywords like "Butter", "Spread", "Cream", "Milk" override any brand assumptions
- Use snake_case category IDs exactly as listed
- Include typical UK serving size in grams
- Confidence 0-100 based on certainty`,p=100;for(let y=0;y<e.length;y+=p){const R=e.slice(y,y+p),x=R.map((T,I)=>{const V=T.brand?` | ${T.brand}`:"";return`${I+1}. ${T.name}${V}`}).join(`
`),S=`Categorize these ${R.length} foods. Return JSON array:
[{"id":1,"cat":"category_id","serv":30,"conf":90,"why":"brief reason"},...]

${x}`;try{const T=t==="claude-sonnet"?await X_(h,S,s):await ek(h,S,s);o+=T.inputTokens,a+=T.outputTokens;const I=$3(T.content,R);n.push(...I)}catch(T){console.error(`Smart batch ${y/p+1} failed:`,T),l+=R.length,R.forEach(I=>{n.push({foodId:I.id,foodName:I.name,brand:I.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:"Smart categorization failed",suggestedServingG:100,currentServingG:I.servingSizeG,servingValidated:!1,packSizeG:Dc(I.name),servingSource:"category_default"})})}i==null||i(Math.min(y+p,e.length),e.length),y+p<e.length&&await new Promise(T=>setTimeout(T,300))}const g=t==="claude-sonnet"?3:2.5,m=t==="claude-sonnet"?15:10,C=o/1e6*g+a/1e6*m;return{results:n,totalProcessed:e.length,totalSuccessful:e.length-l,totalFailed:l,processingTimeMs:Date.now()-r,model:t,cost:{inputTokens:o,outputTokens:a,estimatedCost:C}}}function $3(e,t){const s=[];try{const i=e.match(/\[[\s\S]*\]/);if(!i)throw new Error("No JSON array found in response");const r=JSON.parse(i[0]);for(let n=0;n<t.length;n++){const o=t[n],a=r.find(l=>l.id===n+1)||r[n];if(a){const l=Zo.find(y=>y.id===a.cat),u=l?a.cat:"other",h=(l==null?void 0:l.name)||"Other / Uncategorized";l||console.warn(` Unknown category ID from AI: "${a.cat}" for food: ${o.name}`);const p=Dc(o.name);let g=a.serv||100,m=!1,C="category_default";l&&(o.servingSizeG!==null&&o.servingSizeG>=l.toleranceMin&&o.servingSizeG<=l.toleranceMax?(g=o.servingSizeG,m=!0,C="validated"):p!=null&&p<l.defaultServingG&&p>=l.toleranceMin?(g=p,C="pack_size"):(g=a.serv||l.defaultServingG,C="category_default")),s.push({foodId:o.id,foodName:o.name,brand:o.brand,categoryId:u,categoryName:h,confidence:a.conf||50,reasoning:a.why||"AI categorization",suggestedServingG:g,currentServingG:o.servingSizeG,servingValidated:m,packSizeG:p,servingSource:C})}else s.push({foodId:o.id,foodName:o.name,brand:o.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:"No AI response",suggestedServingG:100,currentServingG:o.servingSizeG,servingValidated:!1,packSizeG:Dc(o.name),servingSource:"category_default"})}}catch(i){console.error("Failed to parse smart response:",i,e),t.forEach(r=>{s.push({foodId:r.id,foodName:r.name,brand:r.brand,categoryId:"other",categoryName:"Other / Uncategorized",confidence:0,reasoning:`Parse error: ${i}`,suggestedServingG:100,currentServingG:r.servingSizeG,servingValidated:!1,packSizeG:Dc(r.name),servingSource:"category_default"})})}return s}const PT="https://us-central1-nutrasafe-705c7.cloudfunctions.net",K3=({onBack:e})=>{const[t,s]=E.useState(localStorage.getItem("claude_api_key")||""),[i,r]=E.useState(localStorage.getItem("openai_api_key")||""),[n,o]=E.useState("claude-sonnet"),[a,l]=E.useState(new Set),[u,h]=E.useState(!1),[p,g]=E.useState([]),[m,C]=E.useState(0),[y,R]=E.useState(!1),[x,S]=E.useState({current:0,total:0}),[T,I]=E.useState([]),[V,H]=E.useState(null),[P,N]=E.useState(!0),[_,L]=E.useState(500),[M,b]=E.useState(!0),[F,Z]=E.useState(!0),[K,ge]=E.useState("all"),[me,de]=E.useState("all"),[ye,pe]=E.useState(""),[q,ve]=E.useState(0),$=50;E.useEffect(()=>{t&&localStorage.setItem("claude_api_key",t),i&&localStorage.setItem("openai_api_key",i)},[t,i]);const be=E.useCallback(async()=>{if(a.size===0)return;h(!0),C(0);const O=[];try{const W=Array.from(a),le=5e3,ne=2e3;for(let X=0;X<W.length;X++){const Q=W[X];console.log(` Loading ${Q}...`);let re=0,Se=!0,Me=[],Ne=0,Pe=0;for(;Se&&Pe<ne;){Pe++;const We=await fetch(`${PT}/browseAllIndices`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({indices:[Q],offset:re,pageSize:le})});if(!We.ok){console.error(` ${Q}: HTTP ${We.status}`);break}const Ye=await We.json();if(Ye.success&&Ye.products){const Ke=Ye.products||[],ie=Ye.pagination||{};if(Ke.length===0){console.log(`   ${Q}: Reached end (0 products returned)`),Se=!1;break}Ke.length<le&&(console.log(`   ${Q}: Last page (${Ke.length} products)`),Se=!1);const Dt=Ke.map(bt=>({objectID:bt.objectID,name:bt.name||bt.foodName||"Unknown",brand:bt.brand||void 0,brandName:bt.brandName||void 0,servingSizeG:bt.servingSizeG||void 0,serving_size_g:bt.serving_size_g||void 0,category:bt.category||void 0,foodCategory:bt.foodCategory||void 0,sourceIndex:Q}));Me.push(...Dt),Ne=(ie==null?void 0:ie.total)||Me.length;const Fs=X/W.length*100,$t=Ne>0?Me.length/Ne*100/W.length:0;C(Math.round(Fs+$t)),console.log(`   ${Q}: ${Me.length.toLocaleString()} / ${Ne.toLocaleString()}`),ie.hasMore?re+=le:Se=!1,Ne>0&&Me.length>=Ne&&(Se=!1)}else{console.error(` ${Q}: ${Ye.error||"Failed"}`);break}}Pe>=ne&&console.warn(` ${Q}: Hit safety limit`),console.log(` ${Q}: Loaded ${Me.length.toLocaleString()} products`),O.push(...Me),C(Math.round((X+1)/W.length*100))}g(O),C(100),console.log(` Total foods loaded: ${O.length.toLocaleString()}`)}catch(W){console.error("Error loading foods:",W),alert(`Error loading foods: ${W}`)}finally{h(!1)}},[a]),se=E.useCallback((O,W)=>{const le=["milk","chocolate","milkshake","dairy","cream","bread","muffin","crumpet","brioche","chicken","nugget","kiev","fruit","juice","smoothie","cake","biscuit","cookie"],ne=[],X=[];O.forEach(Se=>{const Me=Se.name.toLowerCase();le.some(Pe=>Me.includes(Pe))&&ne.length<W*.4?ne.push(Se):X.push(Se)});const Q=X.sort(()=>Math.random()-.5);return[...ne,...Q].slice(0,W)},[]),Ge=E.useCallback(async()=>{const O=n==="claude-sonnet"?t:i;if(!O){alert(`Please enter your ${n==="claude-sonnet"?"Claude":"OpenAI"} API key`);return}if(p.length===0){alert("Please load foods first");return}R(!0),I([]),H(null);try{let W=p;if(M&&(W=p.filter(Me=>!Me.category&&!Me.foodCategory),console.log(`Skipping ${p.length-W.length} already categorized foods`)),W.length===0){alert("No uncategorized foods found. All foods already have categories."),R(!1);return}const le=P?se(W,_):W;S({current:0,total:le.length});const ne=new Map(le.map(Me=>[Me.objectID,Me.sourceIndex])),X=le.map(Me=>({id:Me.objectID,name:Me.name,brand:Me.brand||Me.brandName||null,servingSizeG:Me.servingSizeG||Me.serving_size_g||null})),re=await(F?U3:z3)(X,n,O,(Me,Ne)=>S({current:Me,total:Ne})),Se=re.results.map(Me=>({...Me,reviewStatus:"pending",sourceIndex:ne.get(Me.foodId)}));console.log(" Categorization complete:",{totalResults:Se.length,sampleResults:Se.slice(0,5).map(Me=>({foodName:Me.foodName,categoryId:Me.categoryId,categoryName:Me.categoryName})),uniqueCategories:[...new Set(Se.map(Me=>Me.categoryId))]}),I(Se),H(re)}catch(W){console.error("Categorization failed:",W),alert(`Categorization failed: ${W}`)}finally{R(!1)}},[n,t,i,p,P,_,se]),Re=E.useCallback((O,W,le)=>{I(ne=>ne.map(X=>X.foodId===O?{...X,reviewStatus:W,editedCategoryId:le}:X))},[]),U=E.useCallback(()=>{const O=new Set(T.filter(W=>{var le;if(K!=="all"&&W.categoryId!==K||me!=="all"&&W.reviewStatus!==me)return!1;if(ye){const ne=ye.toLowerCase();if(!W.foodName.toLowerCase().includes(ne)&&!((le=W.brand)!=null&&le.toLowerCase().includes(ne)))return!1}return!0}).map(W=>W.foodId));I(W=>W.map(le=>O.has(le.foodId)&&le.reviewStatus==="pending"?{...le,reviewStatus:"approved"}:le))},[T,K,me,ye]),[J,ce]=E.useState(!1),Y=E.useCallback(async()=>{const O=T.filter(W=>W.reviewStatus==="approved"||W.reviewStatus==="edited");if(O.length===0){alert("No approved or edited items to save.");return}if(confirm(`Save ${O.length} categorizations to the database?

This will update:
- Category
- Serving size (validated or estimated)`)){ce(!0);try{const W=O.map(Se=>({objectID:Se.foodId,sourceIndex:Se.sourceIndex||"unknown",categoryId:Se.editedCategoryId||Se.categoryId,servingSizeG:Se.suggestedServingG,servingValidated:Se.servingValidated||!1,servingSource:Se.servingSource||"category_default"})),le=await fetch(`${PT}/batchSaveFoodCategories`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({foods:W})}),ne=await le.json();if(!le.ok)throw new Error(ne.error||"Failed to save");const X=ne.firestoreUpdated>0?`Firestore: ${ne.firestoreUpdated} ( Algolia syncs automatically)`:"",Q=ne.algoliaUpdated>0?`Algolia-only: ${ne.algoliaUpdated}`:"",re=[X,Q].filter(Boolean).join(`
`);alert(`Successfully saved ${ne.total} categorizations!

${re}`),I(Se=>Se.filter(Me=>Me.reviewStatus!=="approved"&&Me.reviewStatus!=="edited"))}catch(W){console.error("Save failed:",W),alert(`Save failed: ${W}`)}finally{ce(!1)}}},[T]),te=T.filter(O=>{var W;if(K!=="all"&&O.categoryId!==K||me!=="all"&&O.reviewStatus!==me)return!1;if(ye){const le=ye.toLowerCase();if(!O.foodName.toLowerCase().includes(le)&&!((W=O.brand)!=null&&W.toLowerCase().includes(le)))return!1}return!0}),he=Math.ceil(te.length/$),Ae=te.slice(q*$,(q+1)*$),fe={pending:T.filter(O=>O.reviewStatus==="pending").length,approved:T.filter(O=>O.reviewStatus==="approved").length,rejected:T.filter(O=>O.reviewStatus==="rejected").length,edited:T.filter(O=>O.reviewStatus==="edited").length},k=Zo.map(O=>({...O,count:T.filter(W=>W.categoryId===O.id).length})).filter(O=>O.count>0).sort((O,W)=>W.count-O.count);return c.jsxs("div",{style:{padding:"24px",maxWidth:"1600px",margin:"0 auto"},children:[c.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:c.jsxs("div",{children:[c.jsx("button",{onClick:e,style:{padding:"8px 16px",background:"#6b7280",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",marginBottom:"8px"},children:" Back"}),c.jsx("h1",{style:{margin:0,fontSize:"28px",fontWeight:"bold"},children:"Food Categorizer"}),c.jsx("p",{style:{margin:"8px 0 0",color:"#6b7280"},children:"AI-powered food categorization with tiered serving sizes"})]})}),c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("h2",{style:{margin:"0 0 16px",fontSize:"18px"},children:"Configuration"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:"AI Model"}),c.jsxs("div",{style:{display:"flex",gap:"12px"},children:[c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[c.jsx("input",{type:"radio",checked:n==="claude-sonnet",onChange:()=>o("claude-sonnet")}),"Claude 3.5 Sonnet"]}),c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[c.jsx("input",{type:"radio",checked:n==="gpt-4o",onChange:()=>o("gpt-4o")}),"GPT-4o"]})]})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:n==="claude-sonnet"?"Claude API Key":"OpenAI API Key"}),n==="claude-sonnet"?c.jsx("input",{type:"password",value:t,onChange:O=>s(O.target.value),placeholder:"sk-ant-...",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}}):c.jsx("input",{type:"password",value:i,onChange:O=>r(O.target.value),placeholder:"sk-...",style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"}})]}),c.jsxs("div",{children:[c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[c.jsx("input",{type:"checkbox",checked:P,onChange:O=>N(O.target.checked)}),c.jsx("span",{style:{fontWeight:"500"},children:"Test Mode"}),c.jsxs("span",{style:{color:"#6b7280",fontSize:"14px"},children:["(Process ",_," foods first)"]})]}),P&&c.jsx("input",{type:"number",value:_,onChange:O=>L(Math.max(50,Math.min(1e3,parseInt(O.target.value)||500))),min:50,max:1e3,style:{marginTop:"8px",width:"120px",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px"}}),c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"12px"},children:[c.jsx("input",{type:"checkbox",checked:M,onChange:O=>b(O.target.checked)}),c.jsx("span",{style:{fontWeight:"500"},children:"Skip Already Categorized"}),c.jsx("span",{style:{color:"#6b7280",fontSize:"14px"},children:"(Ignore foods with existing category)"})]}),c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",marginTop:"12px"},children:[c.jsx("input",{type:"checkbox",checked:F,onChange:O=>Z(O.target.checked)}),c.jsx("span",{style:{fontWeight:"500",color:"#059669"},children:" Smart Mode"}),c.jsx("span",{style:{color:"#6b7280",fontSize:"14px"},children:"(Minimal prompts - ~50% cheaper, lets AI use its knowledge)"})]})]})]}),c.jsxs("div",{style:{marginTop:"20px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:"Select Databases"}),c.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:Zt.map(O=>c.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",background:a.has(O)?"#dbeafe":"#f3f4f6",borderRadius:"6px",cursor:"pointer",border:a.has(O)?"1px solid #3b82f6":"1px solid transparent"},children:[c.jsx("input",{type:"checkbox",checked:a.has(O),onChange:W=>{const le=new Set(a);W.target.checked?le.add(O):le.delete(O),l(le)}}),O.replace(/_/g," ")]},O))})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"20px"},children:[c.jsx("button",{onClick:be,disabled:u||a.size===0,style:{padding:"12px 24px",background:u?"#9ca3af":"#3b82f6",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:u?"not-allowed":"pointer"},children:u?`Loading... ${m}%`:"Load Foods"}),c.jsx("button",{onClick:Ge,disabled:y||p.length===0,style:{padding:"12px 24px",background:y?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:"500",cursor:y?"not-allowed":"pointer"},children:y?`Processing... ${x.current}/${x.total}`:P?`Run Test (${_} foods)`:`Categorize All (${p.length} foods)`}),p.length>0&&c.jsxs("span",{style:{display:"flex",alignItems:"center",color:"#6b7280"},children:[p.length.toLocaleString()," foods loaded"]})]})]}),T.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Total Processed"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold"},children:T.length})]}),c.jsxs("div",{style:{background:"#fef3c7",borderRadius:"12px",padding:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#92400e"},children:"Pending Review"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#92400e"},children:fe.pending})]}),c.jsxs("div",{style:{background:"#d1fae5",borderRadius:"12px",padding:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#065f46"},children:"Approved"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#065f46"},children:fe.approved})]}),c.jsxs("div",{style:{background:"#fee2e2",borderRadius:"12px",padding:"16px"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#991b1b"},children:"Rejected"}),c.jsx("div",{style:{fontSize:"28px",fontWeight:"bold",color:"#991b1b"},children:fe.rejected})]}),V&&c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#6b7280"},children:"Estimated Cost"}),c.jsxs("div",{style:{fontSize:"28px",fontWeight:"bold"},children:["$",V.cost.estimatedCost.toFixed(2)]}),c.jsxs("div",{style:{fontSize:"12px",color:"#9ca3af"},children:[V.cost.inputTokens.toLocaleString()," in / ",V.cost.outputTokens.toLocaleString()," out"]})]})]}),c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[c.jsx("h3",{style:{margin:"0 0 16px",fontSize:"16px"},children:"Category Distribution"}),c.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:k.slice(0,20).map(O=>c.jsxs("span",{onClick:()=>ge(K===O.id?"all":O.id),style:{padding:"6px 12px",background:K===O.id?"#3b82f6":"#f3f4f6",color:K===O.id?"white":"#374151",borderRadius:"16px",fontSize:"13px",cursor:"pointer"},children:[O.name,": ",O.count]},O.id))})]}),c.jsxs("div",{style:{display:"flex",gap:"16px",marginBottom:"16px",alignItems:"center",flexWrap:"wrap"},children:[c.jsx("input",{type:"text",placeholder:"Search foods...",value:ye,onChange:O=>{pe(O.target.value),ve(0)},style:{padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:"6px",width:"250px"}}),c.jsxs("select",{value:me,onChange:O=>{de(O.target.value),ve(0)},style:{padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:"6px"},children:[c.jsx("option",{value:"all",children:"All Status"}),c.jsx("option",{value:"pending",children:"Pending"}),c.jsx("option",{value:"approved",children:"Approved"}),c.jsx("option",{value:"rejected",children:"Rejected"}),c.jsx("option",{value:"edited",children:"Edited"})]}),c.jsxs("select",{value:K,onChange:O=>{ge(O.target.value),ve(0)},style:{padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:"6px"},children:[c.jsx("option",{value:"all",children:"All Categories"}),Zo.map(O=>c.jsx("option",{value:O.id,children:O.name},O.id))]}),c.jsxs("button",{onClick:U,style:{padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:["Approve All Visible (",te.filter(O=>O.reviewStatus==="pending").length,")"]}),c.jsx("button",{onClick:Y,disabled:J||fe.approved+fe.edited===0,style:{padding:"10px 16px",background:fe.approved+fe.edited>0?"#3b82f6":"#9ca3af",color:"white",border:"none",borderRadius:"6px",cursor:fe.approved+fe.edited>0?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"8px"},children:J?c.jsx(c.Fragment,{children:"Saving..."}):c.jsxs(c.Fragment,{children:[" Save to Database (",fe.approved+fe.edited,")"]})}),c.jsxs("span",{style:{color:"#6b7280",marginLeft:"auto"},children:["Showing ",te.length," of ",T.length]})]}),c.jsx("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:[c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Food"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Category"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"center",fontWeight:"600",fontSize:"13px"},children:"Confidence"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Serving"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontWeight:"600",fontSize:"13px"},children:"Reasoning"}),c.jsx("th",{style:{padding:"12px 16px",textAlign:"center",fontWeight:"600",fontSize:"13px"},children:"Actions"})]})}),c.jsx("tbody",{children:Ae.map((O,W)=>c.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",background:O.reviewStatus==="approved"?"#f0fdf4":O.reviewStatus==="rejected"?"#fef2f2":O.reviewStatus==="edited"?"#fefce8":W%2===0?"white":"#f9fafb"},children:[c.jsxs("td",{style:{padding:"12px 16px"},children:[c.jsx("div",{style:{fontWeight:"500"},children:O.foodName}),O.brand&&c.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:O.brand})]}),c.jsx("td",{style:{padding:"12px 16px"},children:c.jsx("select",{value:O.editedCategoryId||O.categoryId,onChange:le=>{le.target.value!==O.categoryId&&Re(O.foodId,"edited",le.target.value)},style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"13px",maxWidth:"200px"},children:Zo.map(le=>c.jsx("option",{value:le.id,children:le.name},le.id))})}),c.jsx("td",{style:{padding:"12px 16px",textAlign:"center"},children:c.jsxs("span",{style:{display:"inline-block",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"500",background:O.confidence>=90?"#d1fae5":O.confidence>=70?"#fef3c7":"#fee2e2",color:O.confidence>=90?"#065f46":O.confidence>=70?"#92400e":"#991b1b"},children:[O.confidence,"%"]})}),c.jsxs("td",{style:{padding:"12px 16px",fontSize:"13px"},children:[c.jsx("div",{children:O.servingSource==="validated"?c.jsxs(c.Fragment,{children:[c.jsx("span",{style:{display:"inline-block",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:"500",background:"#d1fae5",color:"#065f46",marginRight:"6px"},children:"Validated"}),O.suggestedServingG,"g"]}):O.servingSource==="pack_size"?c.jsxs(c.Fragment,{children:[c.jsx("span",{style:{display:"inline-block",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:"500",background:"#dbeafe",color:"#1e40af",marginRight:"4px"},children:"Pack Size"}),c.jsx("span",{title:"Using pack size from product name to prevent over-portioning. The category default was higher than the actual pack size.",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",borderRadius:"50%",background:"#bfdbfe",color:"#1e40af",fontSize:"10px",fontWeight:"600",cursor:"help",marginRight:"6px"},children:"i"}),O.suggestedServingG,"g"]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{style:{display:"inline-block",padding:"2px 6px",borderRadius:"4px",fontSize:"11px",fontWeight:"500",background:"#fef3c7",color:"#92400e",marginRight:"4px"},children:"Estimated"}),c.jsx("span",{title:"We couldn't guarantee the serving size. Check on the label and edit before you add.",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",borderRadius:"50%",background:"#d1d5db",color:"#4b5563",fontSize:"10px",fontWeight:"600",cursor:"help",marginRight:"6px"},children:"i"}),O.suggestedServingG,"g"]})}),O.packSizeG&&O.servingSource!=="pack_size"&&c.jsxs("div",{style:{fontSize:"11px",color:"#6b7280"},children:["Pack: ",O.packSizeG,"g"]}),O.currentServingG&&!O.servingValidated&&c.jsxs("div",{style:{fontSize:"11px",color:"#9ca3af"},children:["DB: ",O.currentServingG,"g (out of range)"]}),!O.currentServingG&&c.jsx("div",{style:{fontSize:"11px",color:"#9ca3af"},children:"No DB serving"})]}),c.jsx("td",{style:{padding:"12px 16px",fontSize:"12px",color:"#6b7280",maxWidth:"250px"},children:O.reasoning}),c.jsx("td",{style:{padding:"12px 16px",textAlign:"center"},children:c.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>Re(O.foodId,"approved"),title:"Approve",style:{padding:"6px 10px",background:O.reviewStatus==="approved"?"#10b981":"#e5e7eb",color:O.reviewStatus==="approved"?"white":"#374151",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:""}),c.jsx("button",{onClick:()=>Re(O.foodId,"rejected"),title:"Reject",style:{padding:"6px 10px",background:O.reviewStatus==="rejected"?"#ef4444":"#e5e7eb",color:O.reviewStatus==="rejected"?"white":"#374151",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:""})]})})]},O.foodId))})]})}),he>1&&c.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",marginTop:"16px"},children:[c.jsx("button",{onClick:()=>ve(O=>Math.max(0,O-1)),disabled:q===0,style:{padding:"8px 16px",background:q===0?"#e5e7eb":"#3b82f6",color:q===0?"#9ca3af":"white",border:"none",borderRadius:"6px",cursor:q===0?"not-allowed":"pointer"},children:"Previous"}),c.jsxs("span",{style:{color:"#6b7280"},children:["Page ",q+1," of ",he]}),c.jsx("button",{onClick:()=>ve(O=>Math.min(he-1,O+1)),disabled:q>=he-1,style:{padding:"8px 16px",background:q>=he-1?"#e5e7eb":"#3b82f6",color:q>=he-1?"#9ca3af":"white",border:"none",borderRadius:"6px",cursor:q>=he-1?"not-allowed":"pointer"},children:"Next"})]})]})]})},Y3=new p1({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});ZW();const q3=()=>{const{setFoods:e,setLoading:t,setLoadingProgress:s,setStats:i,setDuplicateGroups:r,getDirtyFoods:n,clearDirty:o,foods:a,isLoading:l,loadingMessage:u,loadingProgress:h,selectedFoodIds:p,getFoodById:g,deselectAll:m,setFoodReportIds:C}=Yo(),[y,R]=E.useState(!1),[x,S]=E.useState(!1),[T,I]=E.useState(!1),[V,H]=E.useState(!1),[P,N]=E.useState(!1),[_,L]=E.useState(!1),[M,b]=E.useState("grid"),[F,Z]=E.useState(0);E.useEffect(()=>{(async()=>{try{const be=await(await fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/getUserReports")).json();if(be.success){const se=be.reports||[],Ge=se.filter(U=>U.status==="pending").length;Z(Ge);const Re=new Set;se.forEach(U=>{var ce,Y;const J=((ce=U.food)==null?void 0:ce.id)||((Y=U.food)==null?void 0:Y.objectID)||U.foodId;J&&Re.add(J)}),C(Re)}}catch($){console.error("Error loading reports count:",$)}})()},[C]);const K=Fe.useRef(!1),ge=E.useCallback(async()=>{if(!K.current){K.current=!0,t(!0,"Loading food database..."),s(0);try{console.log("Starting data load..."),t(!0,"Getting index stats...");const ve=await Kj();console.log("Index stats:",ve);let $=0;const be={};Zt.forEach(Re=>{var U;be[Re]=((U=ve[Re])==null?void 0:U.entries)||0,$+=be[Re]}),s(10),console.log(`Total foods across indices: ${$}`),t(!0,"Loading foods from indices...");const{foods:se}=await qN("",[...Zt],{hitsPerPage:10});console.log(`Loaded ${se.length} foods`),s(80);const Ge={totalFoods:$,byIndex:be,verified:se.filter(Re=>Re.isVerified).length,unverified:se.filter(Re=>!Re.isVerified).length,withIssues:se.filter(Re=>Re._reviewFlags.length>0).length,duplicateGroups:0,lastUpdated:new Date};i(Ge),e(se),s(100),console.log("Data load complete")}catch(ve){console.error("Error loading data:",ve),alert(`Error loading data: ${ve instanceof Error?ve.message:String(ve)}`)}finally{t(!1)}}},[t,s,i,e]);E.useEffect(()=>{ge()},[]);const me=E.useCallback(async()=>{const ve=n();if(ve.length!==0){R(!0);try{const $=ve.map(se=>({food:se,updates:{name:se.name,brandName:se.brandName,barcode:se.barcode,ingredientsText:se.ingredientsText,calories:se.calories,protein:se.protein,carbs:se.carbs,fat:se.fat,saturatedFat:se.saturatedFat,fiber:se.fiber,sugar:se.sugar,sodium:se.sodium,salt:se.salt,servingDescription:se.servingDescription,servingSizeG:se.servingSizeG,isPerUnit:se.isPerUnit}})),be=await XW($);be.success>0&&(o(),console.log(`Saved ${be.success} foods`)),be.failed>0&&(console.error(`Failed to save ${be.failed} foods:`,be.errors),alert(`Failed to save ${be.failed} foods. Check console for details.`))}catch($){console.error("Error saving:",$),alert("Error saving changes. Please try again.")}finally{R(!1)}}},[n,o]),de=E.useCallback(async()=>{if(!(p.length===0||!window.confirm(`Are you sure you want to delete ${p.length} food(s)? This action cannot be undone.`))){S(!0);try{const $=p.map(se=>g(se)).filter(se=>se!==void 0);if($.length===0){alert("No foods found to delete.");return}const be=await ez($);if(be.success>0){const se=new Set($.map(Re=>Re._id)),Ge=a.filter(Re=>!se.has(Re._id));e(Ge),m(),console.log(`Deleted ${be.success} foods`)}be.failed>0&&(console.error(`Failed to delete ${be.failed} foods:`,be.errors),alert(`Failed to delete ${be.failed} foods. Check console for details.`))}catch($){console.error("Error deleting:",$),alert("Error deleting foods. Please try again.")}finally{S(!1)}}},[p,g,a,e,m]),ye=E.useCallback(async ve=>{if(!(p.length===0||!window.confirm(`Move ${p.length} food(s) to ${ve}? This will remove them from their current index.`))){I(!0);try{const be=p.map(Ge=>g(Ge)).filter(Ge=>Ge!==void 0);if(be.length===0){alert("No foods found to move.");return}console.log(`Moving ${be.length} foods to ${ve}`);const se=await sz(be,ve);se.success>0&&(console.log(` Moved ${se.success} foods to ${ve}`),await ge(),m(),alert(`Successfully moved ${se.success} food(s) to ${ve}!`)),se.failed>0&&(console.error(`Failed to move ${se.failed} foods:`,se.errors),alert(`Failed to move ${se.failed} foods. Check console for details.`))}catch(be){console.error("Error moving:",be),alert("Error moving foods. Please try again.")}finally{I(!1)}}},[p,g,m,ge]),pe=E.useCallback(async()=>{H(!0);try{const ve=b3(a,{minScore:30,maxGroups:500});r(ve),console.log(`Found ${ve.length} duplicate groups`),L(!0)}catch(ve){console.error("Error detecting duplicates:",ve)}finally{H(!1)}},[a,r]),q=E.useCallback(()=>{N(!0)},[]);return M==="image-processing"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(A3,{onBack:()=>b("grid")})}):M==="google-scraper"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(G3,{onBack:()=>b("grid")})}):M==="reports"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(V3,{onBack:()=>{b("grid"),fetch("https://us-central1-nutrasafe-705c7.cloudfunctions.net/getUserReports").then(ve=>ve.json()).then(ve=>{if(ve.success){const $=ve.reports||[],be=$.filter(Ge=>Ge.status==="pending").length;Z(be);const se=new Set;$.forEach(Ge=>{var U,J;const Re=((U=Ge.food)==null?void 0:U.id)||((J=Ge.food)==null?void 0:J.objectID)||Ge.foodId;Re&&se.add(Re)}),C(se)}}).catch(()=>{})}})}):M==="master-builder"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(B3,{onBack:()=>b("grid")})}):M==="food-categorizer"?c.jsx("div",{className:"h-screen flex flex-col bg-gray-50",children:c.jsx(K3,{onBack:()=>b("grid")})}):c.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[c.jsx(Yj,{onSave:me,onRefresh:ge,onDeleteSelected:de,onMoveSelected:ye,isSaving:y,isDeleting:x,isMoving:T}),c.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[c.jsx(qj,{onDetectDuplicates:pe,onLookupOFF:q,onImageProcessing:()=>b("image-processing"),onGoogleScraper:()=>b("google-scraper"),onReports:()=>b("reports"),onMasterBuilder:()=>b("master-builder"),onFoodCategorizer:()=>b("food-categorizer"),isDetectingDuplicates:V,pendingReportsCount:F}),c.jsx("main",{className:"flex-1 overflow-hidden",children:c.jsx(Vj,{})})]}),l&&c.jsx(Qj,{message:u,progress:h}),P&&c.jsx(I$,{onClose:()=>N(!1),onImport:()=>{ge(),N(!1),console.log("Imported food from OpenFoodFacts")},selectedFoods:p.map(ve=>g(ve)).filter(ve=>ve!==void 0)}),_&&c.jsx(T3,{onClose:()=>L(!1)})]})},Q3=()=>c.jsx(f1,{client:Y3,children:c.jsx(q3,{})});zC.createRoot(document.getElementById("root")).render(c.jsx(Fe.StrictMode,{children:c.jsx(Q3,{})}));
//# sourceMappingURL=index-DMKMaFds.js.map
